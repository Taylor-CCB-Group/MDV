{"version":3,"file":"binWorker-8ctBasS-.js","sources":["../src/datastore/binWorker.js"],"sourcesContent":["//the following causes errors in jsdoc as the ] is nor parsed\n//does not seem to affect the output\n/**\n * @param {SharedArrayBuffer} e.data[0] - local filterBuffer\n * @param {SharedArrayBuffer} e.data[1] - global filterBuffer\n * @param {SharedArrayBuffer} e.data[2] - data\n * @param {Object} e.data[3]- config\n * @param {Number} e.data[3].bins - number of bins\n * @param {Number} e.data[3].min - min value\n * @param {Number} e.data[3].max - max value\n */\nconst func = function(e){\n    \n    const arrType = e.data[2][1]===\"int32\"?Int32Array:Float32Array;\n\tconst data= new arrType(e.data[2][0]);\n    const config = e.data[3];\n    const interval_size = (config.max-config.min)/(config.bins);\n    const max=config.max;\n    const min =config.min;\n    const len =data.length;\n    const  histogram = new Array(config.bins+1).fill(0);\n    const lFilter=new  Uint8Array(e.data[0]);\n    const gFilter = new  Uint8Array(e.data[1]); \n    for (let i=0;i<len;i++){\n        //if filtered out in global but not in local\n        if (gFilter[i]!==0){\n            if  (gFilter[i] !==lFilter[i]){\n                continue;\n            }           \n        }\n        let v= data[i];\n      \n        v=v>max?max:v<min?min:v;\n        histogram[Math.floor((v - min) / interval_size)]++;\n    }\n    return histogram;\n}\n\nself.onmessage= function(e){  \n    if (e.data.length === undefined || typeof e.data === \"string\") {\n        // WordCloud internal setZeroTimeout calls window.postmessage...\n        // seems ok to ignore like this, but not a very clean solution\n        // ? there could be other instances of unexpected messages\n        // console.warn(\"unexpected message to binWorker\", e.data);\n        return;\n    }\n    self.postMessage(func(e));\n}\n//export {func};\n\n"],"names":["func","e","arrType","data","config","interval_size","max","min","len","histogram","lFilter","gFilter","i","v"],"mappings":"yBAWA,MAAMA,EAAO,SAASC,EAAE,CAEpB,MAAMC,EAAUD,EAAE,KAAK,CAAC,EAAE,CAAC,IAAI,QAAQ,WAAW,aAC/CE,EAAM,IAAID,EAAQD,EAAE,KAAK,CAAC,EAAE,CAAC,CAAC,EAC3BG,EAASH,EAAE,KAAK,CAAC,EACjBI,GAAiBD,EAAO,IAAIA,EAAO,KAAMA,EAAO,KAChDE,EAAIF,EAAO,IACXG,EAAKH,EAAO,IACZI,EAAKL,EAAK,OACTM,EAAY,IAAI,MAAML,EAAO,KAAK,CAAC,EAAE,KAAK,CAAC,EAC5CM,EAAQ,IAAK,WAAWT,EAAE,KAAK,CAAC,CAAC,EACjCU,EAAU,IAAK,WAAWV,EAAE,KAAK,CAAC,CAAC,EACzC,QAASW,EAAE,EAAEA,EAAEJ,EAAII,IAAI,CAEnB,GAAID,EAAQC,CAAC,IAAI,GACRD,EAAQC,CAAC,IAAKF,EAAQE,CAAC,EACxB,SAGR,IAAIC,EAAGV,EAAKS,CAAC,EAEbC,EAAEA,EAAEP,EAAIA,EAAIO,EAAEN,EAAIA,EAAIM,EACtBJ,EAAU,KAAK,OAAOI,EAAIN,GAAOF,CAAa,CAAC,GAClD,CACD,OAAOI,CACX,EAEA,KAAK,UAAW,SAASR,EAAE,CACnBA,EAAE,KAAK,SAAW,QAAa,OAAOA,EAAE,MAAS,UAOrD,KAAK,YAAYD,EAAKC,CAAC,CAAC,CAC5B"}