(function(){"use strict";onmessage=function(c){const f=[];for(let n of c.data[3])f.push(n[1]==="int32"?new Int32Array(n[0]):new Float32Array(n[0]));const m=f.length,u=new Uint8Array(c.data[2]),r=c.data[4],h=u.length;let s=r.values.length;const v=r.scaleVals,l=new Uint8Array(c.data[0]),d=new Uint8Array(c.data[1]);if(r.method==="averages_simple"){const n=N(f,d,l,u,r);postMessage(n);return}let t=new Array(m);for(let n=0;n<m;n++){const a=new Array(s);for(let g=0;g<s;g++)a[g]=r.method==="mean"?[0,0]:[0,0,0];t[n]=a,t[n]._id=n}const e=new Array(s).fill(0);r.method==="mean"?A(t,f,h,m,d,l,u,e,s,v):w(t,f,h,m,d,l,u,e,s,v);const o=[];for(let n=0;n<s;n++)e[n]!==0&&o.push(n);for(let n=0;n<m;n++)t[n]=t[n].filter((a,g)=>e[g]!==0),t[n]._id=n;s=o.length;const i=new Array(s);for(let n=0;n<s;n++){i[n]=new Array(m),i[n]._id=o[n];for(let a=0;a<m;a++)i[n][a]=isNaN(t[a][n])?0:t[a][n]}postMessage({averages:t,transpose:i,catTotals:e})};function w(c,f,m,u,r,h,s,v,l,d){performance.now();for(let t=0;t<m;t++){if(r[t]!==0&&r[t]!==h[t])continue;let e=s[t];v[e]++;for(let o=0;o<u;o++)isNaN(f[o][t])||c[o][e][0]++}for(let t=0;t<u;t++)for(let e=0;e<l;e++)c[t][e][0]&&(c[t][e][1]=new Float32Array(c[t][e][0]));for(let t=0;t<m;t++){if(r[t]!==0&&r[t]!==h[t])continue;let e=s[t];for(let o=0;o<u;o++){if(isNaN(f[o][t]))continue;const i=c[o][e];i[1][i[2]++]=f[o][t]}}for(let t=0;t<u;t++){const e=d[t][1]-d[t][0];for(let o=0;o<l;o++){const n=c[t][o][1];if(!n){c[t][o]=NaN;continue}n.sort();let a=n[Math.floor(n.length/2)];a=(a-d[t][0])/e,c[t][o]=a<0?0:a>1?1:a}}}function A(c,f,m,u,r,h,s,v,l,d){for(let t=0;t<m;t++){if(r[t]!==0&&r[t]!==h[t])continue;let e=s[t];v[e]++;for(let o=0;o<u;o++){if(isNaN(f[o][t]))continue;const i=c[o][e];i[0]+=f[o][t],i[1]++}}for(let t=0;t<u;t++){const e=d[t][1]-d[t][0];if(e===0){for(let o=0;o<l;o++)c[t][o]=0;continue}for(let o=0;o<l;o++){let i=c[t][o],n=i[0]/i[1];n=(n-d[t][0])/e,c[t][o]=n<0?0:n>1?1:n}}}function N(c,f,m,u,r){const h=c.length,s=u.length,v=r.threshold||0,l=r.values.map((o,i)=>({id:i,count:0,values:r.columns.map((n,a)=>({id:n,total:0,count:0}))}));for(let o=0;o<s;o++){if(f[o]!==0&&f[o]!==m[o])continue;const i=u[o],n=l[i].values;l[i].count++;for(let a=0;a<h;a++){const g=c[a][o];isNaN(g)||!(g>v)||(n[a].total+=g,n[a].count++)}}let d=l[0].values[0],t=d.count==0?0:d.total/d.count,e=t;for(let o=0;o<h;o++)for(let i=0;i<r.values.length;i++){const n=l[i].values[o],a=n.count==0?0:n.total/n.count;n.frac=l[i].count==0?0:n.count/l[i].count*100,t=a>t?a:t,e=a<e?a:e,n.mean=a,n.cat_id=i}return{data:l,mean_range:[e,t]}}})();
//# sourceMappingURL=catColWorker-B0JCMmku.js.map
