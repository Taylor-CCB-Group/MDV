{"version":3,"file":"binWorker-DIC2QqPk.js","sources":["../src/datastore/binWorker.js"],"sourcesContent":["//the following causes errors in jsdoc as the ] is nor parsed\n//does not seem to affect the output\n/**\n * @param {SharedArrayBuffer} e.data[0] - local filterBuffer\n * @param {SharedArrayBuffer} e.data[1] - global filterBuffer\n * @param {SharedArrayBuffer} e.data[2] - data\n * @param {Object} e.data[3]- config\n * @param {Number} e.data[3].bins - number of bins\n * @param {Number} e.data[3].min - min value\n * @param {Number} e.data[3].max - max value\n */\nconst func = (e) => {\n    const arrType = e.data[2][1] === \"int32\" ? Int32Array : Float32Array;\n    const data = new arrType(e.data[2][0]);\n    const config = e.data[3];\n    const interval_size = (config.max - config.min) / config.bins;\n    const max = config.max;\n    const min = config.min;\n    const len = data.length;\n    const histogram = new Array(config.bins + 1).fill(0);\n    const lFilter = new Uint8Array(e.data[0]);\n    const gFilter = new Uint8Array(e.data[1]);\n    for (let i = 0; i < len; i++) {\n        //if filtered out in global but not in local\n        if (gFilter[i] !== 0) {\n            if (gFilter[i] !== lFilter[i]) {\n                continue;\n            }\n        }\n        let v = data[i];\n\n        v = v > max ? max : v < min ? min : v;\n        histogram[Math.floor((v - min) / interval_size)]++;\n    }\n    return histogram;\n};\n\nself.onmessage = (e) => {\n    if (e.data.length === undefined || typeof e.data === \"string\") {\n        // WordCloud internal setZeroTimeout calls window.postmessage...\n        // seems ok to ignore like this, but not a very clean solution\n        // ? there could be other instances of unexpected messages\n        // console.warn(\"unexpected message to binWorker\", e.data);\n        return;\n    }\n    self.postMessage(func(e));\n};\n//export {func};\n"],"names":["func","e","arrType","data","config","interval_size","max","min","len","histogram","lFilter","gFilter","i","v"],"mappings":"yBAWA,MAAMA,EAAQC,GAAM,CAChB,MAAMC,EAAUD,EAAE,KAAK,CAAC,EAAE,CAAC,IAAM,QAAU,WAAa,aAClDE,EAAO,IAAID,EAAQD,EAAE,KAAK,CAAC,EAAE,CAAC,CAAC,EAC/BG,EAASH,EAAE,KAAK,CAAC,EACjBI,GAAiBD,EAAO,IAAMA,EAAO,KAAOA,EAAO,KACnDE,EAAMF,EAAO,IACbG,EAAMH,EAAO,IACbI,EAAML,EAAK,OACXM,EAAY,IAAI,MAAML,EAAO,KAAO,CAAC,EAAE,KAAK,CAAC,EAC7CM,EAAU,IAAI,WAAWT,EAAE,KAAK,CAAC,CAAC,EAClCU,EAAU,IAAI,WAAWV,EAAE,KAAK,CAAC,CAAC,EACxC,QAASW,EAAI,EAAGA,EAAIJ,EAAKI,IAAK,CAE1B,GAAID,EAAQC,CAAC,IAAM,GACXD,EAAQC,CAAC,IAAMF,EAAQE,CAAC,EACxB,SAGR,IAAIC,EAAIV,EAAKS,CAAC,EAEdC,EAAIA,EAAIP,EAAMA,EAAMO,EAAIN,EAAMA,EAAMM,EACpCJ,EAAU,KAAK,OAAOI,EAAIN,GAAOF,CAAa,CAAC,GAClD,CACD,OAAOI,CACX,EAEA,KAAK,UAAaR,GAAM,CAChBA,EAAE,KAAK,SAAW,QAAa,OAAOA,EAAE,MAAS,UAOrD,KAAK,YAAYD,EAAKC,CAAC,CAAC,CAC5B"}