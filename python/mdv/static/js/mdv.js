/*! For license information please see mdv.js.LICENSE.txt */
(()=>{var __webpack_modules__={9863:(e,t,n)=>{"use strict";n.d(t,{Z:()=>f});var i=n(8081),r=n.n(i),o=n(3645),a=n.n(o),s=n(1667),l=n.n(s),c=new URL(n(2810),n.b),h=a()(r()),u=l()(c);h.push([e.id,":root .grid-stack-item>.ui-resizable-handle{filter:none}.grid-stack{position:relative}.grid-stack.grid-stack-rtl{direction:ltr}.grid-stack.grid-stack-rtl>.grid-stack-item{direction:rtl}.grid-stack .grid-stack-placeholder>.placeholder-content{background-color:rgba(0,0,0,.1);margin:0;position:absolute;width:auto;z-index:0!important;text-align:center}.grid-stack>.grid-stack-item{min-width:8.3333333333%;position:absolute;padding:0}.grid-stack>.grid-stack-item>.grid-stack-item-content{margin:0;position:absolute;width:auto;overflow-x:hidden;overflow-y:auto}.grid-stack>.grid-stack-item>.ui-resizable-handle{position:absolute;font-size:.1px;display:block;-ms-touch-action:none;touch-action:none}.grid-stack>.grid-stack-item.ui-resizable-autohide>.ui-resizable-handle,.grid-stack>.grid-stack-item.ui-resizable-disabled>.ui-resizable-handle{display:none}.grid-stack>.grid-stack-item>.ui-resizable-se,.grid-stack>.grid-stack-item>.ui-resizable-sw{background-image:url("+u+');background-repeat:no-repeat;background-position:center;-webkit-transform:rotate(45deg);-moz-transform:rotate(45deg);-ms-transform:rotate(45deg);-o-transform:rotate(45deg);transform:rotate(45deg)}.grid-stack>.grid-stack-item>.ui-resizable-se{-webkit-transform:rotate(-45deg);-moz-transform:rotate(-45deg);-ms-transform:rotate(-45deg);-o-transform:rotate(-45deg);transform:rotate(-45deg)}.grid-stack>.grid-stack-item>.ui-resizable-nw{cursor:nw-resize;width:20px;height:20px;top:0}.grid-stack>.grid-stack-item>.ui-resizable-n{cursor:n-resize;height:10px;top:0;left:25px;right:25px}.grid-stack>.grid-stack-item>.ui-resizable-ne{cursor:ne-resize;width:20px;height:20px;top:0}.grid-stack>.grid-stack-item>.ui-resizable-e{cursor:e-resize;width:10px;top:15px;bottom:15px}.grid-stack>.grid-stack-item>.ui-resizable-se{cursor:se-resize;width:20px;height:20px}.grid-stack>.grid-stack-item>.ui-resizable-s{cursor:s-resize;height:10px;left:25px;bottom:0;right:25px}.grid-stack>.grid-stack-item>.ui-resizable-sw{cursor:sw-resize;width:20px;height:20px}.grid-stack>.grid-stack-item>.ui-resizable-w{cursor:w-resize;width:10px;top:15px;bottom:15px}.grid-stack>.grid-stack-item.ui-draggable-dragging>.ui-resizable-handle{display:none!important}.grid-stack>.grid-stack-item[gs-w="0"]{width:0%}.grid-stack>.grid-stack-item[gs-x="0"]{left:0}.grid-stack>.grid-stack-item[gs-min-w="0"]{min-width:0}.grid-stack>.grid-stack-item[gs-max-w="0"]{max-width:0%}.grid-stack>.grid-stack-item[gs-w="1"]{width:8.3333333333%}.grid-stack>.grid-stack-item[gs-x="1"]{left:8.3333333333%}.grid-stack>.grid-stack-item[gs-min-w="1"]{min-width:8.3333333333%}.grid-stack>.grid-stack-item[gs-max-w="1"]{max-width:8.3333333333%}.grid-stack>.grid-stack-item[gs-w="2"]{width:16.6666666667%}.grid-stack>.grid-stack-item[gs-x="2"]{left:16.6666666667%}.grid-stack>.grid-stack-item[gs-min-w="2"]{min-width:16.6666666667%}.grid-stack>.grid-stack-item[gs-max-w="2"]{max-width:16.6666666667%}.grid-stack>.grid-stack-item[gs-w="3"]{width:25%}.grid-stack>.grid-stack-item[gs-x="3"]{left:25%}.grid-stack>.grid-stack-item[gs-min-w="3"]{min-width:25%}.grid-stack>.grid-stack-item[gs-max-w="3"]{max-width:25%}.grid-stack>.grid-stack-item[gs-w="4"]{width:33.3333333333%}.grid-stack>.grid-stack-item[gs-x="4"]{left:33.3333333333%}.grid-stack>.grid-stack-item[gs-min-w="4"]{min-width:33.3333333333%}.grid-stack>.grid-stack-item[gs-max-w="4"]{max-width:33.3333333333%}.grid-stack>.grid-stack-item[gs-w="5"]{width:41.6666666667%}.grid-stack>.grid-stack-item[gs-x="5"]{left:41.6666666667%}.grid-stack>.grid-stack-item[gs-min-w="5"]{min-width:41.6666666667%}.grid-stack>.grid-stack-item[gs-max-w="5"]{max-width:41.6666666667%}.grid-stack>.grid-stack-item[gs-w="6"]{width:50%}.grid-stack>.grid-stack-item[gs-x="6"]{left:50%}.grid-stack>.grid-stack-item[gs-min-w="6"]{min-width:50%}.grid-stack>.grid-stack-item[gs-max-w="6"]{max-width:50%}.grid-stack>.grid-stack-item[gs-w="7"]{width:58.3333333333%}.grid-stack>.grid-stack-item[gs-x="7"]{left:58.3333333333%}.grid-stack>.grid-stack-item[gs-min-w="7"]{min-width:58.3333333333%}.grid-stack>.grid-stack-item[gs-max-w="7"]{max-width:58.3333333333%}.grid-stack>.grid-stack-item[gs-w="8"]{width:66.6666666667%}.grid-stack>.grid-stack-item[gs-x="8"]{left:66.6666666667%}.grid-stack>.grid-stack-item[gs-min-w="8"]{min-width:66.6666666667%}.grid-stack>.grid-stack-item[gs-max-w="8"]{max-width:66.6666666667%}.grid-stack>.grid-stack-item[gs-w="9"]{width:75%}.grid-stack>.grid-stack-item[gs-x="9"]{left:75%}.grid-stack>.grid-stack-item[gs-min-w="9"]{min-width:75%}.grid-stack>.grid-stack-item[gs-max-w="9"]{max-width:75%}.grid-stack>.grid-stack-item[gs-w="10"]{width:83.3333333333%}.grid-stack>.grid-stack-item[gs-x="10"]{left:83.3333333333%}.grid-stack>.grid-stack-item[gs-min-w="10"]{min-width:83.3333333333%}.grid-stack>.grid-stack-item[gs-max-w="10"]{max-width:83.3333333333%}.grid-stack>.grid-stack-item[gs-w="11"]{width:91.6666666667%}.grid-stack>.grid-stack-item[gs-x="11"]{left:91.6666666667%}.grid-stack>.grid-stack-item[gs-min-w="11"]{min-width:91.6666666667%}.grid-stack>.grid-stack-item[gs-max-w="11"]{max-width:91.6666666667%}.grid-stack>.grid-stack-item[gs-w="12"]{width:100%}.grid-stack>.grid-stack-item[gs-x="12"]{left:100%}.grid-stack>.grid-stack-item[gs-min-w="12"]{min-width:100%}.grid-stack>.grid-stack-item[gs-max-w="12"]{max-width:100%}.grid-stack.grid-stack-1>.grid-stack-item{min-width:100%}.grid-stack.grid-stack-1>.grid-stack-item[gs-w="1"]{width:100%}.grid-stack.grid-stack-1>.grid-stack-item[gs-x="1"]{left:100%}.grid-stack.grid-stack-1>.grid-stack-item[gs-min-w="1"]{min-width:100%}.grid-stack.grid-stack-1>.grid-stack-item[gs-max-w="1"]{max-width:100%}.grid-stack.grid-stack-animate,.grid-stack.grid-stack-animate .grid-stack-item{-webkit-transition:left .3s,top .3s,height .3s,width .3s;-moz-transition:left .3s,top .3s,height .3s,width .3s;-ms-transition:left .3s,top .3s,height .3s,width .3s;-o-transition:left .3s,top .3s,height .3s,width .3s;transition:left .3s,top .3s,height .3s,width .3s}.grid-stack.grid-stack-animate .grid-stack-item.grid-stack-placeholder,.grid-stack.grid-stack-animate .grid-stack-item.ui-draggable-dragging,.grid-stack.grid-stack-animate .grid-stack-item.ui-resizable-resizing{-webkit-transition:left 0s,top 0s,height 0s,width 0s;-moz-transition:left 0s,top 0s,height 0s,width 0s;-ms-transition:left 0s,top 0s,height 0s,width 0s;-o-transition:left 0s,top 0s,height 0s,width 0s;transition:left 0s,top 0s,height 0s,width 0s}.ui-draggable-dragging,.ui-resizable-resizing{z-index:100}.ui-draggable-dragging>.grid-stack-item-content,.ui-resizable-resizing>.grid-stack-item-content{box-shadow:1px 4px 6px rgba(0,0,0,.2);opacity:.8}.ui-draggable-dragging{will-change:left,top;cursor:move}.ui-resizable-resizing{will-change:width,height}',""]);const f=h},6499:(e,t,n)=>{"use strict";n.d(t,{Z:()=>v});var i=n(8081),r=n.n(i),o=n(3645),a=n.n(o),s=n(1667),l=n.n(s),c=new URL(n(9854),n.b),h=new URL(n(1627),n.b),u=new URL(n(8260),n.b),f=new URL(n(8261),n.b),d=a()(r()),p=l()(c),g=l()(h),m=l()(u),_=l()(f);d.push([e.id,'/* -------------------------------------------------------------------\n  Microtip\n\n  Modern, lightweight css-only tooltips\n  Just 1kb minified and gzipped\n\n  @author Ghosh\n  @package Microtip\n\n----------------------------------------------------------------------\n  1. Base Styles\n  2. Direction Modifiers\n  3. Position Modifiers\n--------------------------------------------------------------------*/\n[aria-label][role~="tooltip"]{position:relative}[aria-label][role~="tooltip"]::before,[aria-label][role~="tooltip"]::after{transform:translate3d(0,0,0);-webkit-backface-visibility:hidden;backface-visibility:hidden;will-change:transform;opacity:0;pointer-events:none;transition:all var(--microtip-transition-duration,.18s) var(--microtip-transition-easing,ease-in-out) var(--microtip-transition-delay,0s);position:absolute;box-sizing:border-box;z-index:10;transform-origin:top}[aria-label][role~="tooltip"]::before{background-size:100% auto!important;content:""}[aria-label][role~="tooltip"]::after{background:rgba(17,17,17,.9);border-radius:4px;color:#fff;content:attr(aria-label);font-size:var(--microtip-font-size,13px);font-weight:var(--microtip-font-weight,normal);text-transform:var(--microtip-text-transform,none);padding:.5em 1em;white-space:nowrap;box-sizing:content-box}[aria-label][role~="tooltip"]:hover::before,[aria-label][role~="tooltip"]:hover::after,[aria-label][role~="tooltip"]:focus::before,[aria-label][role~="tooltip"]:focus::after{opacity:1;pointer-events:auto}[role~="tooltip"][data-microtip-position|="top"]::before{background:url('+p+') no-repeat;height:6px;width:18px;margin-bottom:5px}[role~="tooltip"][data-microtip-position|="top"]::after{margin-bottom:11px}[role~="tooltip"][data-microtip-position|="top"]::before{transform:translate3d(-50%,0,0);bottom:100%;left:50%}[role~="tooltip"][data-microtip-position|="top"]:hover::before{transform:translate3d(-50%,-5px,0)}[role~="tooltip"][data-microtip-position|="top"]::after{transform:translate3d(-50%,0,0);bottom:100%;left:50%}[role~="tooltip"][data-microtip-position="top"]:hover::after{transform:translate3d(-50%,-5px,0)}[role~="tooltip"][data-microtip-position="top-left"]::after{transform:translate3d(calc(-100% + 16px),0,0);bottom:100%}[role~="tooltip"][data-microtip-position="top-left"]:hover::after{transform:translate3d(calc(-100% + 16px),-5px,0)}[role~="tooltip"][data-microtip-position="top-right"]::after{transform:translate3d(calc(0% + -16px),0,0);bottom:100%}[role~="tooltip"][data-microtip-position="top-right"]:hover::after{transform:translate3d(calc(0% + -16px),-5px,0)}[role~="tooltip"][data-microtip-position|="bottom"]::before{background:url('+g+') no-repeat;height:6px;width:18px;margin-top:5px;margin-bottom:0}[role~="tooltip"][data-microtip-position|="bottom"]::after{margin-top:11px}[role~="tooltip"][data-microtip-position|="bottom"]::before{transform:translate3d(-50%,-10px,0);bottom:auto;left:50%;top:100%}[role~="tooltip"][data-microtip-position|="bottom"]:hover::before{transform:translate3d(-50%,0,0)}[role~="tooltip"][data-microtip-position|="bottom"]::after{transform:translate3d(-50%,-10px,0);top:100%;left:50%}[role~="tooltip"][data-microtip-position="bottom"]:hover::after{transform:translate3d(-50%,0,0)}[role~="tooltip"][data-microtip-position="bottom-left"]::after{transform:translate3d(calc(-100% + 16px),-10px,0);top:100%}[role~="tooltip"][data-microtip-position="bottom-left"]:hover::after{transform:translate3d(calc(-100% + 16px),0,0)}[role~="tooltip"][data-microtip-position="bottom-right"]::after{transform:translate3d(calc(0% + -16px),-10px,0);top:100%}[role~="tooltip"][data-microtip-position="bottom-right"]:hover::after{transform:translate3d(calc(0% + -16px),0,0)}[role~="tooltip"][data-microtip-position="left"]::before,[role~="tooltip"][data-microtip-position="left"]::after{bottom:auto;left:auto;right:100%;top:50%;transform:translate3d(10px,-50%,0)}[role~="tooltip"][data-microtip-position="left"]::before{background:url('+m+') no-repeat;height:18px;width:6px;margin-right:5px;margin-bottom:0}[role~="tooltip"][data-microtip-position="left"]::after{margin-right:11px}[role~="tooltip"][data-microtip-position="left"]:hover::before,[role~="tooltip"][data-microtip-position="left"]:hover::after{transform:translate3d(0,-50%,0)}[role~="tooltip"][data-microtip-position="right"]::before,[role~="tooltip"][data-microtip-position="right"]::after{bottom:auto;left:100%;top:50%;transform:translate3d(-10px,-50%,0)}[role~="tooltip"][data-microtip-position="right"]::before{background:url('+_+') no-repeat;height:18px;width:6px;margin-bottom:0;margin-left:5px}[role~="tooltip"][data-microtip-position="right"]::after{margin-left:11px}[role~="tooltip"][data-microtip-position="right"]:hover::before,[role~="tooltip"][data-microtip-position="right"]:hover::after{transform:translate3d(0,-50%,0)}[role~="tooltip"][data-microtip-size="small"]::after{white-space:initial;width:80px}[role~="tooltip"][data-microtip-size="medium"]::after{white-space:initial;width:150px}[role~="tooltip"][data-microtip-size="large"]::after{white-space:initial;width:260px}',""]);const v=d},1171:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var i=n(8081),r=n.n(i),o=n(3645),a=n.n(o)()(r());a.push([e.id,'.noUi-target,.noUi-target *{-webkit-touch-callout:none;-webkit-tap-highlight-color:transparent;-webkit-user-select:none;-ms-touch-action:none;touch-action:none;-ms-user-select:none;-moz-user-select:none;user-select:none;-moz-box-sizing:border-box;box-sizing:border-box}.noUi-target{position:relative}.noUi-base,.noUi-connects{width:100%;height:100%;position:relative;z-index:1}.noUi-connects{overflow:hidden;z-index:0}.noUi-connect,.noUi-origin{will-change:transform;position:absolute;z-index:1;top:0;right:0;height:100%;width:100%;-ms-transform-origin:0 0;-webkit-transform-origin:0 0;-webkit-transform-style:preserve-3d;transform-origin:0 0;transform-style:flat}.noUi-txt-dir-rtl.noUi-horizontal .noUi-origin{left:0;right:auto}.noUi-vertical .noUi-origin{top:-100%;width:0}.noUi-horizontal .noUi-origin{height:0}.noUi-handle{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute}.noUi-touch-area{height:100%;width:100%}.noUi-state-tap .noUi-connect,.noUi-state-tap .noUi-origin{-webkit-transition:transform .3s;transition:transform .3s}.noUi-state-drag *{cursor:inherit!important}.noUi-horizontal{height:18px}.noUi-horizontal .noUi-handle{width:34px;height:28px;right:-17px;top:-6px}.noUi-vertical{width:18px}.noUi-vertical .noUi-handle{width:28px;height:34px;right:-6px;bottom:-17px}.noUi-txt-dir-rtl.noUi-horizontal .noUi-handle{left:-17px;right:auto}.noUi-target{background:#FAFAFA;border-radius:4px;border:1px solid #D3D3D3;box-shadow:inset 0 1px 1px #F0F0F0,0 3px 6px -5px #BBB}.noUi-connects{border-radius:3px}.noUi-connect{background:#3FB8AF}.noUi-draggable{cursor:ew-resize}.noUi-vertical .noUi-draggable{cursor:ns-resize}.noUi-handle{border:1px solid #D9D9D9;border-radius:3px;background:#FFF;cursor:default;box-shadow:inset 0 0 1px #FFF,inset 0 1px 7px #EBEBEB,0 3px 6px -3px #BBB}.noUi-active{box-shadow:inset 0 0 1px #FFF,inset 0 1px 7px #DDD,0 3px 6px -3px #BBB}.noUi-handle:after,.noUi-handle:before{content:"";display:block;position:absolute;height:14px;width:1px;background:#E8E7E6;left:14px;top:6px}.noUi-handle:after{left:17px}.noUi-vertical .noUi-handle:after,.noUi-vertical .noUi-handle:before{width:14px;height:1px;left:6px;top:14px}.noUi-vertical .noUi-handle:after{top:17px}[disabled] .noUi-connect{background:#B8B8B8}[disabled] .noUi-handle,[disabled].noUi-handle,[disabled].noUi-target{cursor:not-allowed}.noUi-pips,.noUi-pips *{-moz-box-sizing:border-box;box-sizing:border-box}.noUi-pips{position:absolute;color:#999}.noUi-value{position:absolute;white-space:nowrap;text-align:center}.noUi-value-sub{color:#ccc;font-size:10px}.noUi-marker{position:absolute;background:#CCC}.noUi-marker-sub{background:#AAA}.noUi-marker-large{background:#AAA}.noUi-pips-horizontal{padding:10px 0;height:80px;top:100%;left:0;width:100%}.noUi-value-horizontal{-webkit-transform:translate(-50%,50%);transform:translate(-50%,50%)}.noUi-rtl .noUi-value-horizontal{-webkit-transform:translate(50%,50%);transform:translate(50%,50%)}.noUi-marker-horizontal.noUi-marker{margin-left:-1px;width:2px;height:5px}.noUi-marker-horizontal.noUi-marker-sub{height:10px}.noUi-marker-horizontal.noUi-marker-large{height:15px}.noUi-pips-vertical{padding:0 10px;height:100%;top:0;left:100%}.noUi-value-vertical{-webkit-transform:translate(0,-50%);transform:translate(0,-50%);padding-left:25px}.noUi-rtl .noUi-value-vertical{-webkit-transform:translate(0,50%);transform:translate(0,50%)}.noUi-marker-vertical.noUi-marker{width:5px;height:2px;margin-top:-1px}.noUi-marker-vertical.noUi-marker-sub{width:10px}.noUi-marker-vertical.noUi-marker-large{width:15px}.noUi-tooltip{display:block;position:absolute;border:1px solid #D9D9D9;border-radius:3px;background:#fff;color:#000;padding:5px;text-align:center;white-space:nowrap}.noUi-horizontal .noUi-tooltip{-webkit-transform:translate(-50%,0);transform:translate(-50%,0);left:50%;bottom:120%}.noUi-vertical .noUi-tooltip{-webkit-transform:translate(0,-50%);transform:translate(0,-50%);top:50%;right:120%}.noUi-horizontal .noUi-origin>.noUi-tooltip{-webkit-transform:translate(50%,0);transform:translate(50%,0);left:auto;bottom:10px}.noUi-vertical .noUi-origin>.noUi-tooltip{-webkit-transform:translate(0,-18px);transform:translate(0,-18px);top:auto;right:28px}',""]);const s=a},1451:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var i=n(8081),r=n.n(i),o=n(3645),a=n.n(o)()(r());a.push([e.id,".panel-track-label{\r\n    white-space: nowrap;\r\n    overflow: hidden;\r\n    text-overflow: ellipsis;\r\n    max-width:100px;\r\n    position:absolute;\r\n    right:5px;\r\n    display:none;\r\n    background-color: white;\r\n    color:black;\r\n    font-size:13px;\r\n    cursor:pointer\r\n\r\n}\r\n\r\n\r\n\r\n.panel-track-label:hover {\r\n    font-weight:bold;\r\n}\r\n\r\n\r\n.panel-loading-icon{\r\n    display:block;\r\n    position:absolute;\r\n    margin: 0;\r\n    top: 50%;\r\n    left: 50%;\r\n    transform: translate(-50%, -50%);\r\n    font-size:30px;\r\n}\r\n\r\n\r\n.panel-error-message{\r\n    display:none;\r\n    position:absolute;\r\n    margin: 0;\r\n    top: 50%;\r\n    left: 50%;\r\n    transform: translate(-50%, -50%);\r\n    font-size:20px;\r\n    color:#721c24;\r\n    background:#f8d7da;\r\n    border: 1px solid #f5c6cb;\r\n}\r\n\r\n",""]);const s=a},8520:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var i=n(8081),r=n.n(i),o=n(3645),a=n.n(o)()(r());a.push([e.id,"@media (prefers-color-scheme: dark) {\r\n    :root {\r\n        --title_bar_color: #222;\r\n        --main_panel_color: black;\r\n        --text_color: white;\r\n        --background_color: rgb(51, 51, 51);\r\n        --input_border_color: #bbb;\r\n        --menu-gradient: linear-gradient(#444, #222);\r\n    }\r\n}\r\n@media (prefers-color-scheme: light) {\r\n    :root {\r\n        --title_bar_color: white;\r\n        --main_panel_color: #f1f1f1;\r\n        --text_color: black;\r\n        --background_color: rgb(186, 186, 186);\r\n        --input_border_color: rgb(51, 51, 51);\r\n        --menu-gradient: linear-gradient(white, darkgray);\r\n    }\r\n}\r\n\r\n.Dark {\r\n    --title_bar_color: #222;\r\n    --main_panel_color: black;\r\n    --text_color: white;\r\n    --background_color: rgb(51, 51, 51);\r\n    --input_border_color: #bbb;\r\n    --menu-gradient: linear-gradient(#444, #222);\r\n}\r\n\r\n.Light {\r\n    --title_bar_color: white;\r\n    --main_panel_color: #f1f1f1;\r\n    --text_color: black;\r\n    --background_color: rgb(186, 186, 186);\r\n    --input_border_color: rgb(51, 51, 51);\r\n    --menu-gradient: linear-gradient(white, darkgray);\r\n}\r\n:root {\r\n    font-family: Inter, Avenir, Helvetica, Arial, sans-serif;\r\n    --button_color: #1266f1;\r\n}\r\n.Dark a {\r\n    color: #1266f1;\r\n}\r\nselect, input, textarea {\r\n    border: 0.1em solid var(--input_border_color);\r\n}\r\n.mdv-select{\r\n    border-radius: 3px;\r\n    font-size:0.8em;\r\n    margin:2px;\r\n}\r\n\r\n.mdv-divider{\r\n    margin-left:6px;\r\n    margin-right:6px;\r\n}\r\n\r\n.mdv-select:focus{\r\n\r\n    box-shadow:0px 0px 3px 2px #088AFF;\r\n    outline: 0 none;\r\n}\r\n\r\n.mdv-info-text{\r\n    font-size:0.9em;\r\n    opacity:0.7;\r\n    display:block;\r\n\r\n}\r\n\r\n.mdv-section{\r\n    padding:4px;\r\n}\r\n\r\n.mdv-section-header{\r\n    background-color:var(--background_color);\r\n    font-weight: bold;\r\n}\r\n.mdv-section-value{\r\n    white-space:pre-wrap;\r\n}\r\n\r\n.mdv-image-holder{\r\n    margin:5px;\r\n    border:1px solid black;\r\n    position:relative;\r\n    overflow:hidden;\r\n}\r\n\r\n\r\n.mdv-checkbox{\r\n    transform:scale(1.2);\r\n    vertical-align: middle;\r\n}\r\n\r\n\r\n.mdv-flex-dynamic{\r\n    overflow:hidden;\r\n    white-space:nowrap;\r\n    text-overflow:ellipsis;\r\n    flex-grow:1;\r\n    min-width:0;\r\n}\r\n\r\n.mdv-flex-fixed{\r\n    flex-shrink:0;\r\n    flex-grow:0;\r\n}\r\n\r\n.grid-stack  .ciview-chart-panel {\r\n    box-shadow: none;\r\n    /* nb changing box-sizing,  adjusted width in _getContentDimensions()...\r\n    otherwise VolumeView was overflowing.\r\n    Left 'overflow: hidden' for now anyway.\r\n    */\r\n    overflow: hidden;\r\n    box-sizing: border-box;\r\n    border: 4px solid var(--background_color);\r\n}\r\n.grid-stack-placeholder {\r\n    background-color: rgba(0, 0, 0, 0.3);\r\n}\r\n\r\n.grid-stack {\r\n    overflow-x: hidden !important;\r\n}\r\n\r\n.Dark .gridLock {\r\n    border-color: #101010;\r\n}\r\n.Light .gridLock {\r\n    border-color: #888;\r\n}\r\n\r\n.ciview-chart-panel{\r\n    display:flex;\r\n    flex-flow:column;\r\n    border-radius:5px;\r\n    box-shadow: 0 0 1em #888;\r\n}    \r\n\r\n.ciview-chart-titlebar{\r\n    display:flex;\r\n    padding:4px;\r\n    background: var(--title_bar_color);\r\n    color: var(--text_color);\r\n    flex:0 0 auto;\r\n    font-size:14px;\r\n}\r\n\r\n.ciview-contentDiv {\r\n    background-color: var(--background_color);\r\n}\r\n\r\n.ciview-chart-title{\r\n    flex-grow:1;\r\n    text-overflow:ellipsis;\r\n    overflow:hidden;\r\n    white-space:nowrap;\r\n    margin-left: 0.2em;\r\n}\r\n.ciview-chart-menuspace{\r\n    flex-grow:0;\r\n    white-space:nowrap;\r\n    display:flex;\r\n    flex-flow: row-reverse;\r\n    align-items: center;\r\n}\r\n\r\n/*[aria-label][role~=\"tooltip\"]::after{\r\n    background-color: #155724;\r\n}*/\r\n\r\n.ciview-chart-content{\r\n    flex:1 1 auto;\r\n    position:relative;\r\n    min-height:1px;\r\n    background-color: var(--main_panel_color);\r\n    color: var(--text_color);\r\n}\r\n\r\n.legend-container {\r\n    backdrop-filter: blur(1px);\r\n    padding: 0.4em;\r\n    transition: backdrop-filter 0.2s ease-in-out;\r\n    /* changing var(--background_color) to rgb() didn't help */\r\n    /* background-color: rgba(var(--background_color), 0.7); */\r\n}\r\n.legend-container:hover {\r\n    backdrop-filter: blur(20px);\r\n}\r\n.Dark .legend-container {\r\n    background-color: rgba(51, 51, 51, 0.3);\r\n}\r\n.Light .legend-container {\r\n    background-color: rgba(186, 186, 186, 0.3);\r\n}\r\n\r\n.row-bar{\r\n    cursor:pointer;\r\n}\r\n\r\n\r\n.pie-arc{\r\n    cursor:pointer;\r\n}\r\n\r\n.row-text{\r\n    cursor:pointer;\r\n}\r\n\r\n.ciview-button{\r\n    background: var(--button_color);\r\n    padding:5px 8px;\r\n    border-radius:5px;\r\n    cursor:pointer;\r\n    color:white;\r\n    border: 0;\r\n}\r\n\r\n.ciview-button-sm{\r\n    background: var(--button_color);\r\n    padding:3px 6px;\r\n    border-radius:5px;\r\n    cursor:pointer;\r\n    color:white;\r\n    font-size:0.8em;\r\n    margin: 0px 3px;\r\n    text-align: center;\r\n    border: 0;\r\n}\r\n\r\n\r\n\r\n.ciview-button-disabled{\r\n    background: var(--button_color);\r\n    padding:5px 8px;\r\n    border-radius:5px;\r\n    opacity:0.6;\r\n    color:white;\r\n    pointer-events:none;\r\n   \r\n}\r\n\r\n.ciview-disabled{\r\n    pointer-events:none;\r\n    opacity:0.6;\r\n}\r\n\r\n\r\n\r\n\r\n.ciview-center{\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n}\r\n\r\n\r\n\r\n\r\n\r\n.ciview-title-div{\r\n    font-size:16px;\r\n    font-weight:bold;\r\n    padding:5px;\r\n}\r\n\r\n.ciview-padded-div{\r\n    padding:4px;\r\n}\r\n\r\n.ciview-main-menu-bar{\r\n    height:30px;\r\n    color: var(--text_color);\r\n    background-color: var(--background_color);\r\n}\r\n\r\n\r\n\r\n.ciview-button:hover{\r\n    box-shadow: 0 2px 5px 0 rgb(0 0 0 / 20%);\r\n}\r\n\r\n.ciview-button-sm:hover{\r\n    box-shadow: 0 2px 5px 0 rgb(0 0 0 / 20%);\r\n}\r\n\r\n.row-bar:hover{\r\n    opacity:0.6;\r\n}\r\n\r\n.pie-arc:hover{\r\n    opacity:0.6;\r\n}\r\n\r\n\r\n.ciview-info-alert{\r\n    padding:8px;\r\n    width:250px;\r\n    position:absolute;\r\n    font-size:18px;\r\n    z-index:5;\r\n\r\n}\r\n.ttt{\r\n   float:right;\r\n}\r\n.ciview-alert-info{\r\n    color:#155724;\r\n    background:#d4edda;\r\n    border: 1px solid #c3e6cb;\r\n}\r\n\r\n.ciview-alert-danger{\r\n    color:#721c24;\r\n    background:#f8d7da;\r\n    border: 1px solid #f5c6cb;\r\n}\r\n\r\n.ciview-alert-warning{\r\n    color:#856404;\r\n    background:#fff3cd;\r\n    border: 1px solid #ffeeba;\r\n}\r\n\r\n\r\n.civ-dg-div{\r\n    padding:5px;\r\n}\r\n\r\n.ciview-info-alert-spin{\r\n    font-size:18px;\r\n    float:right\r\n\r\n}\r\n\r\n\r\n\r\n.civew-chart-resetbutton{\r\n    visibility:hidden;\r\n    \r\n}\r\n\r\n\r\n\r\n.ciview-chart-icon{\r\n    cursor:pointer;\r\n    margin: 0px 2px;\r\n}\r\n\r\n.annotationDialog h2 {\r\n    font-weight: 400;\r\n    line-height: 1.2em;\r\n}\r\n\r\n.annotationDialog ul {\r\n    list-style: none;\r\n    display: flex;\r\n    gap: 0.5em;\r\n    font-size: small;\r\n}\r\n\r\n.annotationDialog li {\r\n    padding: 0.4em;\r\n    border-radius: 0.5em;\r\n    background-color: var(--button_color);\r\n}\r\n\r\n.annotationDialog .allTagged {\r\n    \r\n}\r\n.annotationDialog .someTagged {\r\n    filter: saturate(20%);\r\n}\r\n\r\n\r\n.mdv-image-label {\r\n    position:absolute;\r\n    text-align: center;\r\n}",""]);const s=a},5175:(e,t,n)=>{"use strict";n.d(t,{Z:()=>j});var i=n(8081),r=n.n(i),o=n(3645),a=n.n(o),s=n(1667),l=n.n(s),c=new URL(n(5258),n.b),h=new URL(n(8073),n.b),u=new URL(n(1293),n.b),f=new URL(n(9710),n.b),d=new URL(n(197),n.b),p=new URL(n(848),n.b),g=new URL(n(6859),n.b),m=new URL(n(4821),n.b),_=new URL(n(5860),n.b),v=new URL(n(7094),n.b),b=new URL(n(6203),n.b),y=new URL(n(8681),n.b),w=new URL(n(1029),n.b),x=new URL(n(142),n.b),C=new URL(n(8498),n.b),k=a()(r()),S=l()(c),E=l()(c,{hash:"?#iefix"}),D=l()(h),A=l()(u),M=l()(f),R=l()(d,{hash:"#fontawesome"}),L=l()(p),T=l()(p,{hash:"?#iefix"}),P=l()(g),z=l()(m),I=l()(_),O=l()(v,{hash:"#fontawesome"}),F=l()(b),B=l()(b,{hash:"?#iefix"}),N=l()(y),H=l()(w),U=l()(x),$=l()(C,{hash:"#fontawesome"});k.push([e.id,'/*!\n * Font Awesome Free 5.15.3 by @fontawesome - https://fontawesome.com\n * License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)\n */\n.fa,.fab,.fad,.fal,.far,.fas{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;display:inline-block;font-style:normal;font-variant:normal;text-rendering:auto;line-height:1}.fa-lg{font-size:1.33333em;line-height:.75em;vertical-align:-.0667em}.fa-xs{font-size:.75em}.fa-sm{font-size:.875em}.fa-1x{font-size:1em}.fa-2x{font-size:2em}.fa-3x{font-size:3em}.fa-4x{font-size:4em}.fa-5x{font-size:5em}.fa-6x{font-size:6em}.fa-7x{font-size:7em}.fa-8x{font-size:8em}.fa-9x{font-size:9em}.fa-10x{font-size:10em}.fa-fw{text-align:center;width:1.25em}.fa-ul{list-style-type:none;margin-left:2.5em;padding-left:0}.fa-ul>li{position:relative}.fa-li{left:-2em;position:absolute;text-align:center;width:2em;line-height:inherit}.fa-border{border:.08em solid #eee;border-radius:.1em;padding:.2em .25em .15em}.fa-pull-left{float:left}.fa-pull-right{float:right}.fa.fa-pull-left,.fab.fa-pull-left,.fal.fa-pull-left,.far.fa-pull-left,.fas.fa-pull-left{margin-right:.3em}.fa.fa-pull-right,.fab.fa-pull-right,.fal.fa-pull-right,.far.fa-pull-right,.fas.fa-pull-right{margin-left:.3em}.fa-spin{-webkit-animation:fa-spin 2s linear infinite;animation:fa-spin 2s linear infinite}.fa-pulse{-webkit-animation:fa-spin 1s steps(8) infinite;animation:fa-spin 1s steps(8) infinite}@-webkit-keyframes fa-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes fa-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}.fa-rotate-90{-ms-filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation=1)";-webkit-transform:rotate(90deg);transform:rotate(90deg)}.fa-rotate-180{-ms-filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation=2)";-webkit-transform:rotate(180deg);transform:rotate(180deg)}.fa-rotate-270{-ms-filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation=3)";-webkit-transform:rotate(270deg);transform:rotate(270deg)}.fa-flip-horizontal{-ms-filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation=0, mirror=1)";-webkit-transform:scaleX(-1);transform:scaleX(-1)}.fa-flip-vertical{-webkit-transform:scaleY(-1);transform:scaleY(-1)}.fa-flip-both,.fa-flip-horizontal.fa-flip-vertical,.fa-flip-vertical{-ms-filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1)"}.fa-flip-both,.fa-flip-horizontal.fa-flip-vertical{-webkit-transform:scale(-1);transform:scale(-1)}:root .fa-flip-both,:root .fa-flip-horizontal,:root .fa-flip-vertical,:root .fa-rotate-90,:root .fa-rotate-180,:root .fa-rotate-270{-webkit-filter:none;filter:none}.fa-stack{display:inline-block;height:2em;line-height:2em;position:relative;vertical-align:middle;width:2.5em}.fa-stack-1x,.fa-stack-2x{left:0;position:absolute;text-align:center;width:100%}.fa-stack-1x{line-height:inherit}.fa-stack-2x{font-size:2em}.fa-inverse{color:#fff}.fa-500px:before{content:"\\f26e"}.fa-accessible-icon:before{content:"\\f368"}.fa-accusoft:before{content:"\\f369"}.fa-acquisitions-incorporated:before{content:"\\f6af"}.fa-ad:before{content:"\\f641"}.fa-address-book:before{content:"\\f2b9"}.fa-address-card:before{content:"\\f2bb"}.fa-adjust:before{content:"\\f042"}.fa-adn:before{content:"\\f170"}.fa-adversal:before{content:"\\f36a"}.fa-affiliatetheme:before{content:"\\f36b"}.fa-air-freshener:before{content:"\\f5d0"}.fa-airbnb:before{content:"\\f834"}.fa-algolia:before{content:"\\f36c"}.fa-align-center:before{content:"\\f037"}.fa-align-justify:before{content:"\\f039"}.fa-align-left:before{content:"\\f036"}.fa-align-right:before{content:"\\f038"}.fa-alipay:before{content:"\\f642"}.fa-allergies:before{content:"\\f461"}.fa-amazon:before{content:"\\f270"}.fa-amazon-pay:before{content:"\\f42c"}.fa-ambulance:before{content:"\\f0f9"}.fa-american-sign-language-interpreting:before{content:"\\f2a3"}.fa-amilia:before{content:"\\f36d"}.fa-anchor:before{content:"\\f13d"}.fa-android:before{content:"\\f17b"}.fa-angellist:before{content:"\\f209"}.fa-angle-double-down:before{content:"\\f103"}.fa-angle-double-left:before{content:"\\f100"}.fa-angle-double-right:before{content:"\\f101"}.fa-angle-double-up:before{content:"\\f102"}.fa-angle-down:before{content:"\\f107"}.fa-angle-left:before{content:"\\f104"}.fa-angle-right:before{content:"\\f105"}.fa-angle-up:before{content:"\\f106"}.fa-angry:before{content:"\\f556"}.fa-angrycreative:before{content:"\\f36e"}.fa-angular:before{content:"\\f420"}.fa-ankh:before{content:"\\f644"}.fa-app-store:before{content:"\\f36f"}.fa-app-store-ios:before{content:"\\f370"}.fa-apper:before{content:"\\f371"}.fa-apple:before{content:"\\f179"}.fa-apple-alt:before{content:"\\f5d1"}.fa-apple-pay:before{content:"\\f415"}.fa-archive:before{content:"\\f187"}.fa-archway:before{content:"\\f557"}.fa-arrow-alt-circle-down:before{content:"\\f358"}.fa-arrow-alt-circle-left:before{content:"\\f359"}.fa-arrow-alt-circle-right:before{content:"\\f35a"}.fa-arrow-alt-circle-up:before{content:"\\f35b"}.fa-arrow-circle-down:before{content:"\\f0ab"}.fa-arrow-circle-left:before{content:"\\f0a8"}.fa-arrow-circle-right:before{content:"\\f0a9"}.fa-arrow-circle-up:before{content:"\\f0aa"}.fa-arrow-down:before{content:"\\f063"}.fa-arrow-left:before{content:"\\f060"}.fa-arrow-right:before{content:"\\f061"}.fa-arrow-up:before{content:"\\f062"}.fa-arrows-alt:before{content:"\\f0b2"}.fa-arrows-alt-h:before{content:"\\f337"}.fa-arrows-alt-v:before{content:"\\f338"}.fa-artstation:before{content:"\\f77a"}.fa-assistive-listening-systems:before{content:"\\f2a2"}.fa-asterisk:before{content:"\\f069"}.fa-asymmetrik:before{content:"\\f372"}.fa-at:before{content:"\\f1fa"}.fa-atlas:before{content:"\\f558"}.fa-atlassian:before{content:"\\f77b"}.fa-atom:before{content:"\\f5d2"}.fa-audible:before{content:"\\f373"}.fa-audio-description:before{content:"\\f29e"}.fa-autoprefixer:before{content:"\\f41c"}.fa-avianex:before{content:"\\f374"}.fa-aviato:before{content:"\\f421"}.fa-award:before{content:"\\f559"}.fa-aws:before{content:"\\f375"}.fa-baby:before{content:"\\f77c"}.fa-baby-carriage:before{content:"\\f77d"}.fa-backspace:before{content:"\\f55a"}.fa-backward:before{content:"\\f04a"}.fa-bacon:before{content:"\\f7e5"}.fa-bacteria:before{content:"\\e059"}.fa-bacterium:before{content:"\\e05a"}.fa-bahai:before{content:"\\f666"}.fa-balance-scale:before{content:"\\f24e"}.fa-balance-scale-left:before{content:"\\f515"}.fa-balance-scale-right:before{content:"\\f516"}.fa-ban:before{content:"\\f05e"}.fa-band-aid:before{content:"\\f462"}.fa-bandcamp:before{content:"\\f2d5"}.fa-barcode:before{content:"\\f02a"}.fa-bars:before{content:"\\f0c9"}.fa-baseball-ball:before{content:"\\f433"}.fa-basketball-ball:before{content:"\\f434"}.fa-bath:before{content:"\\f2cd"}.fa-battery-empty:before{content:"\\f244"}.fa-battery-full:before{content:"\\f240"}.fa-battery-half:before{content:"\\f242"}.fa-battery-quarter:before{content:"\\f243"}.fa-battery-three-quarters:before{content:"\\f241"}.fa-battle-net:before{content:"\\f835"}.fa-bed:before{content:"\\f236"}.fa-beer:before{content:"\\f0fc"}.fa-behance:before{content:"\\f1b4"}.fa-behance-square:before{content:"\\f1b5"}.fa-bell:before{content:"\\f0f3"}.fa-bell-slash:before{content:"\\f1f6"}.fa-bezier-curve:before{content:"\\f55b"}.fa-bible:before{content:"\\f647"}.fa-bicycle:before{content:"\\f206"}.fa-biking:before{content:"\\f84a"}.fa-bimobject:before{content:"\\f378"}.fa-binoculars:before{content:"\\f1e5"}.fa-biohazard:before{content:"\\f780"}.fa-birthday-cake:before{content:"\\f1fd"}.fa-bitbucket:before{content:"\\f171"}.fa-bitcoin:before{content:"\\f379"}.fa-bity:before{content:"\\f37a"}.fa-black-tie:before{content:"\\f27e"}.fa-blackberry:before{content:"\\f37b"}.fa-blender:before{content:"\\f517"}.fa-blender-phone:before{content:"\\f6b6"}.fa-blind:before{content:"\\f29d"}.fa-blog:before{content:"\\f781"}.fa-blogger:before{content:"\\f37c"}.fa-blogger-b:before{content:"\\f37d"}.fa-bluetooth:before{content:"\\f293"}.fa-bluetooth-b:before{content:"\\f294"}.fa-bold:before{content:"\\f032"}.fa-bolt:before{content:"\\f0e7"}.fa-bomb:before{content:"\\f1e2"}.fa-bone:before{content:"\\f5d7"}.fa-bong:before{content:"\\f55c"}.fa-book:before{content:"\\f02d"}.fa-book-dead:before{content:"\\f6b7"}.fa-book-medical:before{content:"\\f7e6"}.fa-book-open:before{content:"\\f518"}.fa-book-reader:before{content:"\\f5da"}.fa-bookmark:before{content:"\\f02e"}.fa-bootstrap:before{content:"\\f836"}.fa-border-all:before{content:"\\f84c"}.fa-border-none:before{content:"\\f850"}.fa-border-style:before{content:"\\f853"}.fa-bowling-ball:before{content:"\\f436"}.fa-box:before{content:"\\f466"}.fa-box-open:before{content:"\\f49e"}.fa-box-tissue:before{content:"\\e05b"}.fa-boxes:before{content:"\\f468"}.fa-braille:before{content:"\\f2a1"}.fa-brain:before{content:"\\f5dc"}.fa-bread-slice:before{content:"\\f7ec"}.fa-briefcase:before{content:"\\f0b1"}.fa-briefcase-medical:before{content:"\\f469"}.fa-broadcast-tower:before{content:"\\f519"}.fa-broom:before{content:"\\f51a"}.fa-brush:before{content:"\\f55d"}.fa-btc:before{content:"\\f15a"}.fa-buffer:before{content:"\\f837"}.fa-bug:before{content:"\\f188"}.fa-building:before{content:"\\f1ad"}.fa-bullhorn:before{content:"\\f0a1"}.fa-bullseye:before{content:"\\f140"}.fa-burn:before{content:"\\f46a"}.fa-buromobelexperte:before{content:"\\f37f"}.fa-bus:before{content:"\\f207"}.fa-bus-alt:before{content:"\\f55e"}.fa-business-time:before{content:"\\f64a"}.fa-buy-n-large:before{content:"\\f8a6"}.fa-buysellads:before{content:"\\f20d"}.fa-calculator:before{content:"\\f1ec"}.fa-calendar:before{content:"\\f133"}.fa-calendar-alt:before{content:"\\f073"}.fa-calendar-check:before{content:"\\f274"}.fa-calendar-day:before{content:"\\f783"}.fa-calendar-minus:before{content:"\\f272"}.fa-calendar-plus:before{content:"\\f271"}.fa-calendar-times:before{content:"\\f273"}.fa-calendar-week:before{content:"\\f784"}.fa-camera:before{content:"\\f030"}.fa-camera-retro:before{content:"\\f083"}.fa-campground:before{content:"\\f6bb"}.fa-canadian-maple-leaf:before{content:"\\f785"}.fa-candy-cane:before{content:"\\f786"}.fa-cannabis:before{content:"\\f55f"}.fa-capsules:before{content:"\\f46b"}.fa-car:before{content:"\\f1b9"}.fa-car-alt:before{content:"\\f5de"}.fa-car-battery:before{content:"\\f5df"}.fa-car-crash:before{content:"\\f5e1"}.fa-car-side:before{content:"\\f5e4"}.fa-caravan:before{content:"\\f8ff"}.fa-caret-down:before{content:"\\f0d7"}.fa-caret-left:before{content:"\\f0d9"}.fa-caret-right:before{content:"\\f0da"}.fa-caret-square-down:before{content:"\\f150"}.fa-caret-square-left:before{content:"\\f191"}.fa-caret-square-right:before{content:"\\f152"}.fa-caret-square-up:before{content:"\\f151"}.fa-caret-up:before{content:"\\f0d8"}.fa-carrot:before{content:"\\f787"}.fa-cart-arrow-down:before{content:"\\f218"}.fa-cart-plus:before{content:"\\f217"}.fa-cash-register:before{content:"\\f788"}.fa-cat:before{content:"\\f6be"}.fa-cc-amazon-pay:before{content:"\\f42d"}.fa-cc-amex:before{content:"\\f1f3"}.fa-cc-apple-pay:before{content:"\\f416"}.fa-cc-diners-club:before{content:"\\f24c"}.fa-cc-discover:before{content:"\\f1f2"}.fa-cc-jcb:before{content:"\\f24b"}.fa-cc-mastercard:before{content:"\\f1f1"}.fa-cc-paypal:before{content:"\\f1f4"}.fa-cc-stripe:before{content:"\\f1f5"}.fa-cc-visa:before{content:"\\f1f0"}.fa-centercode:before{content:"\\f380"}.fa-centos:before{content:"\\f789"}.fa-certificate:before{content:"\\f0a3"}.fa-chair:before{content:"\\f6c0"}.fa-chalkboard:before{content:"\\f51b"}.fa-chalkboard-teacher:before{content:"\\f51c"}.fa-charging-station:before{content:"\\f5e7"}.fa-chart-area:before{content:"\\f1fe"}.fa-chart-bar:before{content:"\\f080"}.fa-chart-line:before{content:"\\f201"}.fa-chart-pie:before{content:"\\f200"}.fa-check:before{content:"\\f00c"}.fa-check-circle:before{content:"\\f058"}.fa-check-double:before{content:"\\f560"}.fa-check-square:before{content:"\\f14a"}.fa-cheese:before{content:"\\f7ef"}.fa-chess:before{content:"\\f439"}.fa-chess-bishop:before{content:"\\f43a"}.fa-chess-board:before{content:"\\f43c"}.fa-chess-king:before{content:"\\f43f"}.fa-chess-knight:before{content:"\\f441"}.fa-chess-pawn:before{content:"\\f443"}.fa-chess-queen:before{content:"\\f445"}.fa-chess-rook:before{content:"\\f447"}.fa-chevron-circle-down:before{content:"\\f13a"}.fa-chevron-circle-left:before{content:"\\f137"}.fa-chevron-circle-right:before{content:"\\f138"}.fa-chevron-circle-up:before{content:"\\f139"}.fa-chevron-down:before{content:"\\f078"}.fa-chevron-left:before{content:"\\f053"}.fa-chevron-right:before{content:"\\f054"}.fa-chevron-up:before{content:"\\f077"}.fa-child:before{content:"\\f1ae"}.fa-chrome:before{content:"\\f268"}.fa-chromecast:before{content:"\\f838"}.fa-church:before{content:"\\f51d"}.fa-circle:before{content:"\\f111"}.fa-circle-notch:before{content:"\\f1ce"}.fa-city:before{content:"\\f64f"}.fa-clinic-medical:before{content:"\\f7f2"}.fa-clipboard:before{content:"\\f328"}.fa-clipboard-check:before{content:"\\f46c"}.fa-clipboard-list:before{content:"\\f46d"}.fa-clock:before{content:"\\f017"}.fa-clone:before{content:"\\f24d"}.fa-closed-captioning:before{content:"\\f20a"}.fa-cloud:before{content:"\\f0c2"}.fa-cloud-download-alt:before{content:"\\f381"}.fa-cloud-meatball:before{content:"\\f73b"}.fa-cloud-moon:before{content:"\\f6c3"}.fa-cloud-moon-rain:before{content:"\\f73c"}.fa-cloud-rain:before{content:"\\f73d"}.fa-cloud-showers-heavy:before{content:"\\f740"}.fa-cloud-sun:before{content:"\\f6c4"}.fa-cloud-sun-rain:before{content:"\\f743"}.fa-cloud-upload-alt:before{content:"\\f382"}.fa-cloudflare:before{content:"\\e07d"}.fa-cloudscale:before{content:"\\f383"}.fa-cloudsmith:before{content:"\\f384"}.fa-cloudversify:before{content:"\\f385"}.fa-cocktail:before{content:"\\f561"}.fa-code:before{content:"\\f121"}.fa-code-branch:before{content:"\\f126"}.fa-codepen:before{content:"\\f1cb"}.fa-codiepie:before{content:"\\f284"}.fa-coffee:before{content:"\\f0f4"}.fa-cog:before{content:"\\f013"}.fa-cogs:before{content:"\\f085"}.fa-coins:before{content:"\\f51e"}.fa-columns:before{content:"\\f0db"}.fa-comment:before{content:"\\f075"}.fa-comment-alt:before{content:"\\f27a"}.fa-comment-dollar:before{content:"\\f651"}.fa-comment-dots:before{content:"\\f4ad"}.fa-comment-medical:before{content:"\\f7f5"}.fa-comment-slash:before{content:"\\f4b3"}.fa-comments:before{content:"\\f086"}.fa-comments-dollar:before{content:"\\f653"}.fa-compact-disc:before{content:"\\f51f"}.fa-compass:before{content:"\\f14e"}.fa-compress:before{content:"\\f066"}.fa-compress-alt:before{content:"\\f422"}.fa-compress-arrows-alt:before{content:"\\f78c"}.fa-concierge-bell:before{content:"\\f562"}.fa-confluence:before{content:"\\f78d"}.fa-connectdevelop:before{content:"\\f20e"}.fa-contao:before{content:"\\f26d"}.fa-cookie:before{content:"\\f563"}.fa-cookie-bite:before{content:"\\f564"}.fa-copy:before{content:"\\f0c5"}.fa-copyright:before{content:"\\f1f9"}.fa-cotton-bureau:before{content:"\\f89e"}.fa-couch:before{content:"\\f4b8"}.fa-cpanel:before{content:"\\f388"}.fa-creative-commons:before{content:"\\f25e"}.fa-creative-commons-by:before{content:"\\f4e7"}.fa-creative-commons-nc:before{content:"\\f4e8"}.fa-creative-commons-nc-eu:before{content:"\\f4e9"}.fa-creative-commons-nc-jp:before{content:"\\f4ea"}.fa-creative-commons-nd:before{content:"\\f4eb"}.fa-creative-commons-pd:before{content:"\\f4ec"}.fa-creative-commons-pd-alt:before{content:"\\f4ed"}.fa-creative-commons-remix:before{content:"\\f4ee"}.fa-creative-commons-sa:before{content:"\\f4ef"}.fa-creative-commons-sampling:before{content:"\\f4f0"}.fa-creative-commons-sampling-plus:before{content:"\\f4f1"}.fa-creative-commons-share:before{content:"\\f4f2"}.fa-creative-commons-zero:before{content:"\\f4f3"}.fa-credit-card:before{content:"\\f09d"}.fa-critical-role:before{content:"\\f6c9"}.fa-crop:before{content:"\\f125"}.fa-crop-alt:before{content:"\\f565"}.fa-cross:before{content:"\\f654"}.fa-crosshairs:before{content:"\\f05b"}.fa-crow:before{content:"\\f520"}.fa-crown:before{content:"\\f521"}.fa-crutch:before{content:"\\f7f7"}.fa-css3:before{content:"\\f13c"}.fa-css3-alt:before{content:"\\f38b"}.fa-cube:before{content:"\\f1b2"}.fa-cubes:before{content:"\\f1b3"}.fa-cut:before{content:"\\f0c4"}.fa-cuttlefish:before{content:"\\f38c"}.fa-d-and-d:before{content:"\\f38d"}.fa-d-and-d-beyond:before{content:"\\f6ca"}.fa-dailymotion:before{content:"\\e052"}.fa-dashcube:before{content:"\\f210"}.fa-database:before{content:"\\f1c0"}.fa-deaf:before{content:"\\f2a4"}.fa-deezer:before{content:"\\e077"}.fa-delicious:before{content:"\\f1a5"}.fa-democrat:before{content:"\\f747"}.fa-deploydog:before{content:"\\f38e"}.fa-deskpro:before{content:"\\f38f"}.fa-desktop:before{content:"\\f108"}.fa-dev:before{content:"\\f6cc"}.fa-deviantart:before{content:"\\f1bd"}.fa-dharmachakra:before{content:"\\f655"}.fa-dhl:before{content:"\\f790"}.fa-diagnoses:before{content:"\\f470"}.fa-diaspora:before{content:"\\f791"}.fa-dice:before{content:"\\f522"}.fa-dice-d20:before{content:"\\f6cf"}.fa-dice-d6:before{content:"\\f6d1"}.fa-dice-five:before{content:"\\f523"}.fa-dice-four:before{content:"\\f524"}.fa-dice-one:before{content:"\\f525"}.fa-dice-six:before{content:"\\f526"}.fa-dice-three:before{content:"\\f527"}.fa-dice-two:before{content:"\\f528"}.fa-digg:before{content:"\\f1a6"}.fa-digital-ocean:before{content:"\\f391"}.fa-digital-tachograph:before{content:"\\f566"}.fa-directions:before{content:"\\f5eb"}.fa-discord:before{content:"\\f392"}.fa-discourse:before{content:"\\f393"}.fa-disease:before{content:"\\f7fa"}.fa-divide:before{content:"\\f529"}.fa-dizzy:before{content:"\\f567"}.fa-dna:before{content:"\\f471"}.fa-dochub:before{content:"\\f394"}.fa-docker:before{content:"\\f395"}.fa-dog:before{content:"\\f6d3"}.fa-dollar-sign:before{content:"\\f155"}.fa-dolly:before{content:"\\f472"}.fa-dolly-flatbed:before{content:"\\f474"}.fa-donate:before{content:"\\f4b9"}.fa-door-closed:before{content:"\\f52a"}.fa-door-open:before{content:"\\f52b"}.fa-dot-circle:before{content:"\\f192"}.fa-dove:before{content:"\\f4ba"}.fa-download:before{content:"\\f019"}.fa-draft2digital:before{content:"\\f396"}.fa-drafting-compass:before{content:"\\f568"}.fa-dragon:before{content:"\\f6d5"}.fa-draw-polygon:before{content:"\\f5ee"}.fa-dribbble:before{content:"\\f17d"}.fa-dribbble-square:before{content:"\\f397"}.fa-dropbox:before{content:"\\f16b"}.fa-drum:before{content:"\\f569"}.fa-drum-steelpan:before{content:"\\f56a"}.fa-drumstick-bite:before{content:"\\f6d7"}.fa-drupal:before{content:"\\f1a9"}.fa-dumbbell:before{content:"\\f44b"}.fa-dumpster:before{content:"\\f793"}.fa-dumpster-fire:before{content:"\\f794"}.fa-dungeon:before{content:"\\f6d9"}.fa-dyalog:before{content:"\\f399"}.fa-earlybirds:before{content:"\\f39a"}.fa-ebay:before{content:"\\f4f4"}.fa-edge:before{content:"\\f282"}.fa-edge-legacy:before{content:"\\e078"}.fa-edit:before{content:"\\f044"}.fa-egg:before{content:"\\f7fb"}.fa-eject:before{content:"\\f052"}.fa-elementor:before{content:"\\f430"}.fa-ellipsis-h:before{content:"\\f141"}.fa-ellipsis-v:before{content:"\\f142"}.fa-ello:before{content:"\\f5f1"}.fa-ember:before{content:"\\f423"}.fa-empire:before{content:"\\f1d1"}.fa-envelope:before{content:"\\f0e0"}.fa-envelope-open:before{content:"\\f2b6"}.fa-envelope-open-text:before{content:"\\f658"}.fa-envelope-square:before{content:"\\f199"}.fa-envira:before{content:"\\f299"}.fa-equals:before{content:"\\f52c"}.fa-eraser:before{content:"\\f12d"}.fa-erlang:before{content:"\\f39d"}.fa-ethereum:before{content:"\\f42e"}.fa-ethernet:before{content:"\\f796"}.fa-etsy:before{content:"\\f2d7"}.fa-euro-sign:before{content:"\\f153"}.fa-evernote:before{content:"\\f839"}.fa-exchange-alt:before{content:"\\f362"}.fa-exclamation:before{content:"\\f12a"}.fa-exclamation-circle:before{content:"\\f06a"}.fa-exclamation-triangle:before{content:"\\f071"}.fa-expand:before{content:"\\f065"}.fa-expand-alt:before{content:"\\f424"}.fa-expand-arrows-alt:before{content:"\\f31e"}.fa-expeditedssl:before{content:"\\f23e"}.fa-external-link-alt:before{content:"\\f35d"}.fa-external-link-square-alt:before{content:"\\f360"}.fa-eye:before{content:"\\f06e"}.fa-eye-dropper:before{content:"\\f1fb"}.fa-eye-slash:before{content:"\\f070"}.fa-facebook:before{content:"\\f09a"}.fa-facebook-f:before{content:"\\f39e"}.fa-facebook-messenger:before{content:"\\f39f"}.fa-facebook-square:before{content:"\\f082"}.fa-fan:before{content:"\\f863"}.fa-fantasy-flight-games:before{content:"\\f6dc"}.fa-fast-backward:before{content:"\\f049"}.fa-fast-forward:before{content:"\\f050"}.fa-faucet:before{content:"\\e005"}.fa-fax:before{content:"\\f1ac"}.fa-feather:before{content:"\\f52d"}.fa-feather-alt:before{content:"\\f56b"}.fa-fedex:before{content:"\\f797"}.fa-fedora:before{content:"\\f798"}.fa-female:before{content:"\\f182"}.fa-fighter-jet:before{content:"\\f0fb"}.fa-figma:before{content:"\\f799"}.fa-file:before{content:"\\f15b"}.fa-file-alt:before{content:"\\f15c"}.fa-file-archive:before{content:"\\f1c6"}.fa-file-audio:before{content:"\\f1c7"}.fa-file-code:before{content:"\\f1c9"}.fa-file-contract:before{content:"\\f56c"}.fa-file-csv:before{content:"\\f6dd"}.fa-file-download:before{content:"\\f56d"}.fa-file-excel:before{content:"\\f1c3"}.fa-file-export:before{content:"\\f56e"}.fa-file-image:before{content:"\\f1c5"}.fa-file-import:before{content:"\\f56f"}.fa-file-invoice:before{content:"\\f570"}.fa-file-invoice-dollar:before{content:"\\f571"}.fa-file-medical:before{content:"\\f477"}.fa-file-medical-alt:before{content:"\\f478"}.fa-file-pdf:before{content:"\\f1c1"}.fa-file-powerpoint:before{content:"\\f1c4"}.fa-file-prescription:before{content:"\\f572"}.fa-file-signature:before{content:"\\f573"}.fa-file-upload:before{content:"\\f574"}.fa-file-video:before{content:"\\f1c8"}.fa-file-word:before{content:"\\f1c2"}.fa-fill:before{content:"\\f575"}.fa-fill-drip:before{content:"\\f576"}.fa-film:before{content:"\\f008"}.fa-filter:before{content:"\\f0b0"}.fa-fingerprint:before{content:"\\f577"}.fa-fire:before{content:"\\f06d"}.fa-fire-alt:before{content:"\\f7e4"}.fa-fire-extinguisher:before{content:"\\f134"}.fa-firefox:before{content:"\\f269"}.fa-firefox-browser:before{content:"\\e007"}.fa-first-aid:before{content:"\\f479"}.fa-first-order:before{content:"\\f2b0"}.fa-first-order-alt:before{content:"\\f50a"}.fa-firstdraft:before{content:"\\f3a1"}.fa-fish:before{content:"\\f578"}.fa-fist-raised:before{content:"\\f6de"}.fa-flag:before{content:"\\f024"}.fa-flag-checkered:before{content:"\\f11e"}.fa-flag-usa:before{content:"\\f74d"}.fa-flask:before{content:"\\f0c3"}.fa-flickr:before{content:"\\f16e"}.fa-flipboard:before{content:"\\f44d"}.fa-flushed:before{content:"\\f579"}.fa-fly:before{content:"\\f417"}.fa-folder:before{content:"\\f07b"}.fa-folder-minus:before{content:"\\f65d"}.fa-folder-open:before{content:"\\f07c"}.fa-folder-plus:before{content:"\\f65e"}.fa-font:before{content:"\\f031"}.fa-font-awesome:before{content:"\\f2b4"}.fa-font-awesome-alt:before{content:"\\f35c"}.fa-font-awesome-flag:before{content:"\\f425"}.fa-font-awesome-logo-full:before{content:"\\f4e6"}.fa-fonticons:before{content:"\\f280"}.fa-fonticons-fi:before{content:"\\f3a2"}.fa-football-ball:before{content:"\\f44e"}.fa-fort-awesome:before{content:"\\f286"}.fa-fort-awesome-alt:before{content:"\\f3a3"}.fa-forumbee:before{content:"\\f211"}.fa-forward:before{content:"\\f04e"}.fa-foursquare:before{content:"\\f180"}.fa-free-code-camp:before{content:"\\f2c5"}.fa-freebsd:before{content:"\\f3a4"}.fa-frog:before{content:"\\f52e"}.fa-frown:before{content:"\\f119"}.fa-frown-open:before{content:"\\f57a"}.fa-fulcrum:before{content:"\\f50b"}.fa-funnel-dollar:before{content:"\\f662"}.fa-futbol:before{content:"\\f1e3"}.fa-galactic-republic:before{content:"\\f50c"}.fa-galactic-senate:before{content:"\\f50d"}.fa-gamepad:before{content:"\\f11b"}.fa-gas-pump:before{content:"\\f52f"}.fa-gavel:before{content:"\\f0e3"}.fa-gem:before{content:"\\f3a5"}.fa-genderless:before{content:"\\f22d"}.fa-get-pocket:before{content:"\\f265"}.fa-gg:before{content:"\\f260"}.fa-gg-circle:before{content:"\\f261"}.fa-ghost:before{content:"\\f6e2"}.fa-gift:before{content:"\\f06b"}.fa-gifts:before{content:"\\f79c"}.fa-git:before{content:"\\f1d3"}.fa-git-alt:before{content:"\\f841"}.fa-git-square:before{content:"\\f1d2"}.fa-github:before{content:"\\f09b"}.fa-github-alt:before{content:"\\f113"}.fa-github-square:before{content:"\\f092"}.fa-gitkraken:before{content:"\\f3a6"}.fa-gitlab:before{content:"\\f296"}.fa-gitter:before{content:"\\f426"}.fa-glass-cheers:before{content:"\\f79f"}.fa-glass-martini:before{content:"\\f000"}.fa-glass-martini-alt:before{content:"\\f57b"}.fa-glass-whiskey:before{content:"\\f7a0"}.fa-glasses:before{content:"\\f530"}.fa-glide:before{content:"\\f2a5"}.fa-glide-g:before{content:"\\f2a6"}.fa-globe:before{content:"\\f0ac"}.fa-globe-africa:before{content:"\\f57c"}.fa-globe-americas:before{content:"\\f57d"}.fa-globe-asia:before{content:"\\f57e"}.fa-globe-europe:before{content:"\\f7a2"}.fa-gofore:before{content:"\\f3a7"}.fa-golf-ball:before{content:"\\f450"}.fa-goodreads:before{content:"\\f3a8"}.fa-goodreads-g:before{content:"\\f3a9"}.fa-google:before{content:"\\f1a0"}.fa-google-drive:before{content:"\\f3aa"}.fa-google-pay:before{content:"\\e079"}.fa-google-play:before{content:"\\f3ab"}.fa-google-plus:before{content:"\\f2b3"}.fa-google-plus-g:before{content:"\\f0d5"}.fa-google-plus-square:before{content:"\\f0d4"}.fa-google-wallet:before{content:"\\f1ee"}.fa-gopuram:before{content:"\\f664"}.fa-graduation-cap:before{content:"\\f19d"}.fa-gratipay:before{content:"\\f184"}.fa-grav:before{content:"\\f2d6"}.fa-greater-than:before{content:"\\f531"}.fa-greater-than-equal:before{content:"\\f532"}.fa-grimace:before{content:"\\f57f"}.fa-grin:before{content:"\\f580"}.fa-grin-alt:before{content:"\\f581"}.fa-grin-beam:before{content:"\\f582"}.fa-grin-beam-sweat:before{content:"\\f583"}.fa-grin-hearts:before{content:"\\f584"}.fa-grin-squint:before{content:"\\f585"}.fa-grin-squint-tears:before{content:"\\f586"}.fa-grin-stars:before{content:"\\f587"}.fa-grin-tears:before{content:"\\f588"}.fa-grin-tongue:before{content:"\\f589"}.fa-grin-tongue-squint:before{content:"\\f58a"}.fa-grin-tongue-wink:before{content:"\\f58b"}.fa-grin-wink:before{content:"\\f58c"}.fa-grip-horizontal:before{content:"\\f58d"}.fa-grip-lines:before{content:"\\f7a4"}.fa-grip-lines-vertical:before{content:"\\f7a5"}.fa-grip-vertical:before{content:"\\f58e"}.fa-gripfire:before{content:"\\f3ac"}.fa-grunt:before{content:"\\f3ad"}.fa-guilded:before{content:"\\e07e"}.fa-guitar:before{content:"\\f7a6"}.fa-gulp:before{content:"\\f3ae"}.fa-h-square:before{content:"\\f0fd"}.fa-hacker-news:before{content:"\\f1d4"}.fa-hacker-news-square:before{content:"\\f3af"}.fa-hackerrank:before{content:"\\f5f7"}.fa-hamburger:before{content:"\\f805"}.fa-hammer:before{content:"\\f6e3"}.fa-hamsa:before{content:"\\f665"}.fa-hand-holding:before{content:"\\f4bd"}.fa-hand-holding-heart:before{content:"\\f4be"}.fa-hand-holding-medical:before{content:"\\e05c"}.fa-hand-holding-usd:before{content:"\\f4c0"}.fa-hand-holding-water:before{content:"\\f4c1"}.fa-hand-lizard:before{content:"\\f258"}.fa-hand-middle-finger:before{content:"\\f806"}.fa-hand-paper:before{content:"\\f256"}.fa-hand-peace:before{content:"\\f25b"}.fa-hand-point-down:before{content:"\\f0a7"}.fa-hand-point-left:before{content:"\\f0a5"}.fa-hand-point-right:before{content:"\\f0a4"}.fa-hand-point-up:before{content:"\\f0a6"}.fa-hand-pointer:before{content:"\\f25a"}.fa-hand-rock:before{content:"\\f255"}.fa-hand-scissors:before{content:"\\f257"}.fa-hand-sparkles:before{content:"\\e05d"}.fa-hand-spock:before{content:"\\f259"}.fa-hands:before{content:"\\f4c2"}.fa-hands-helping:before{content:"\\f4c4"}.fa-hands-wash:before{content:"\\e05e"}.fa-handshake:before{content:"\\f2b5"}.fa-handshake-alt-slash:before{content:"\\e05f"}.fa-handshake-slash:before{content:"\\e060"}.fa-hanukiah:before{content:"\\f6e6"}.fa-hard-hat:before{content:"\\f807"}.fa-hashtag:before{content:"\\f292"}.fa-hat-cowboy:before{content:"\\f8c0"}.fa-hat-cowboy-side:before{content:"\\f8c1"}.fa-hat-wizard:before{content:"\\f6e8"}.fa-hdd:before{content:"\\f0a0"}.fa-head-side-cough:before{content:"\\e061"}.fa-head-side-cough-slash:before{content:"\\e062"}.fa-head-side-mask:before{content:"\\e063"}.fa-head-side-virus:before{content:"\\e064"}.fa-heading:before{content:"\\f1dc"}.fa-headphones:before{content:"\\f025"}.fa-headphones-alt:before{content:"\\f58f"}.fa-headset:before{content:"\\f590"}.fa-heart:before{content:"\\f004"}.fa-heart-broken:before{content:"\\f7a9"}.fa-heartbeat:before{content:"\\f21e"}.fa-helicopter:before{content:"\\f533"}.fa-highlighter:before{content:"\\f591"}.fa-hiking:before{content:"\\f6ec"}.fa-hippo:before{content:"\\f6ed"}.fa-hips:before{content:"\\f452"}.fa-hire-a-helper:before{content:"\\f3b0"}.fa-history:before{content:"\\f1da"}.fa-hive:before{content:"\\e07f"}.fa-hockey-puck:before{content:"\\f453"}.fa-holly-berry:before{content:"\\f7aa"}.fa-home:before{content:"\\f015"}.fa-hooli:before{content:"\\f427"}.fa-hornbill:before{content:"\\f592"}.fa-horse:before{content:"\\f6f0"}.fa-horse-head:before{content:"\\f7ab"}.fa-hospital:before{content:"\\f0f8"}.fa-hospital-alt:before{content:"\\f47d"}.fa-hospital-symbol:before{content:"\\f47e"}.fa-hospital-user:before{content:"\\f80d"}.fa-hot-tub:before{content:"\\f593"}.fa-hotdog:before{content:"\\f80f"}.fa-hotel:before{content:"\\f594"}.fa-hotjar:before{content:"\\f3b1"}.fa-hourglass:before{content:"\\f254"}.fa-hourglass-end:before{content:"\\f253"}.fa-hourglass-half:before{content:"\\f252"}.fa-hourglass-start:before{content:"\\f251"}.fa-house-damage:before{content:"\\f6f1"}.fa-house-user:before{content:"\\e065"}.fa-houzz:before{content:"\\f27c"}.fa-hryvnia:before{content:"\\f6f2"}.fa-html5:before{content:"\\f13b"}.fa-hubspot:before{content:"\\f3b2"}.fa-i-cursor:before{content:"\\f246"}.fa-ice-cream:before{content:"\\f810"}.fa-icicles:before{content:"\\f7ad"}.fa-icons:before{content:"\\f86d"}.fa-id-badge:before{content:"\\f2c1"}.fa-id-card:before{content:"\\f2c2"}.fa-id-card-alt:before{content:"\\f47f"}.fa-ideal:before{content:"\\e013"}.fa-igloo:before{content:"\\f7ae"}.fa-image:before{content:"\\f03e"}.fa-images:before{content:"\\f302"}.fa-imdb:before{content:"\\f2d8"}.fa-inbox:before{content:"\\f01c"}.fa-indent:before{content:"\\f03c"}.fa-industry:before{content:"\\f275"}.fa-infinity:before{content:"\\f534"}.fa-info:before{content:"\\f129"}.fa-info-circle:before{content:"\\f05a"}.fa-innosoft:before{content:"\\e080"}.fa-instagram:before{content:"\\f16d"}.fa-instagram-square:before{content:"\\e055"}.fa-instalod:before{content:"\\e081"}.fa-intercom:before{content:"\\f7af"}.fa-internet-explorer:before{content:"\\f26b"}.fa-invision:before{content:"\\f7b0"}.fa-ioxhost:before{content:"\\f208"}.fa-italic:before{content:"\\f033"}.fa-itch-io:before{content:"\\f83a"}.fa-itunes:before{content:"\\f3b4"}.fa-itunes-note:before{content:"\\f3b5"}.fa-java:before{content:"\\f4e4"}.fa-jedi:before{content:"\\f669"}.fa-jedi-order:before{content:"\\f50e"}.fa-jenkins:before{content:"\\f3b6"}.fa-jira:before{content:"\\f7b1"}.fa-joget:before{content:"\\f3b7"}.fa-joint:before{content:"\\f595"}.fa-joomla:before{content:"\\f1aa"}.fa-journal-whills:before{content:"\\f66a"}.fa-js:before{content:"\\f3b8"}.fa-js-square:before{content:"\\f3b9"}.fa-jsfiddle:before{content:"\\f1cc"}.fa-kaaba:before{content:"\\f66b"}.fa-kaggle:before{content:"\\f5fa"}.fa-key:before{content:"\\f084"}.fa-keybase:before{content:"\\f4f5"}.fa-keyboard:before{content:"\\f11c"}.fa-keycdn:before{content:"\\f3ba"}.fa-khanda:before{content:"\\f66d"}.fa-kickstarter:before{content:"\\f3bb"}.fa-kickstarter-k:before{content:"\\f3bc"}.fa-kiss:before{content:"\\f596"}.fa-kiss-beam:before{content:"\\f597"}.fa-kiss-wink-heart:before{content:"\\f598"}.fa-kiwi-bird:before{content:"\\f535"}.fa-korvue:before{content:"\\f42f"}.fa-landmark:before{content:"\\f66f"}.fa-language:before{content:"\\f1ab"}.fa-laptop:before{content:"\\f109"}.fa-laptop-code:before{content:"\\f5fc"}.fa-laptop-house:before{content:"\\e066"}.fa-laptop-medical:before{content:"\\f812"}.fa-laravel:before{content:"\\f3bd"}.fa-lastfm:before{content:"\\f202"}.fa-lastfm-square:before{content:"\\f203"}.fa-laugh:before{content:"\\f599"}.fa-laugh-beam:before{content:"\\f59a"}.fa-laugh-squint:before{content:"\\f59b"}.fa-laugh-wink:before{content:"\\f59c"}.fa-layer-group:before{content:"\\f5fd"}.fa-leaf:before{content:"\\f06c"}.fa-leanpub:before{content:"\\f212"}.fa-lemon:before{content:"\\f094"}.fa-less:before{content:"\\f41d"}.fa-less-than:before{content:"\\f536"}.fa-less-than-equal:before{content:"\\f537"}.fa-level-down-alt:before{content:"\\f3be"}.fa-level-up-alt:before{content:"\\f3bf"}.fa-life-ring:before{content:"\\f1cd"}.fa-lightbulb:before{content:"\\f0eb"}.fa-line:before{content:"\\f3c0"}.fa-link:before{content:"\\f0c1"}.fa-linkedin:before{content:"\\f08c"}.fa-linkedin-in:before{content:"\\f0e1"}.fa-linode:before{content:"\\f2b8"}.fa-linux:before{content:"\\f17c"}.fa-lira-sign:before{content:"\\f195"}.fa-list:before{content:"\\f03a"}.fa-list-alt:before{content:"\\f022"}.fa-list-ol:before{content:"\\f0cb"}.fa-list-ul:before{content:"\\f0ca"}.fa-location-arrow:before{content:"\\f124"}.fa-lock:before{content:"\\f023"}.fa-lock-open:before{content:"\\f3c1"}.fa-long-arrow-alt-down:before{content:"\\f309"}.fa-long-arrow-alt-left:before{content:"\\f30a"}.fa-long-arrow-alt-right:before{content:"\\f30b"}.fa-long-arrow-alt-up:before{content:"\\f30c"}.fa-low-vision:before{content:"\\f2a8"}.fa-luggage-cart:before{content:"\\f59d"}.fa-lungs:before{content:"\\f604"}.fa-lungs-virus:before{content:"\\e067"}.fa-lyft:before{content:"\\f3c3"}.fa-magento:before{content:"\\f3c4"}.fa-magic:before{content:"\\f0d0"}.fa-magnet:before{content:"\\f076"}.fa-mail-bulk:before{content:"\\f674"}.fa-mailchimp:before{content:"\\f59e"}.fa-male:before{content:"\\f183"}.fa-mandalorian:before{content:"\\f50f"}.fa-map:before{content:"\\f279"}.fa-map-marked:before{content:"\\f59f"}.fa-map-marked-alt:before{content:"\\f5a0"}.fa-map-marker:before{content:"\\f041"}.fa-map-marker-alt:before{content:"\\f3c5"}.fa-map-pin:before{content:"\\f276"}.fa-map-signs:before{content:"\\f277"}.fa-markdown:before{content:"\\f60f"}.fa-marker:before{content:"\\f5a1"}.fa-mars:before{content:"\\f222"}.fa-mars-double:before{content:"\\f227"}.fa-mars-stroke:before{content:"\\f229"}.fa-mars-stroke-h:before{content:"\\f22b"}.fa-mars-stroke-v:before{content:"\\f22a"}.fa-mask:before{content:"\\f6fa"}.fa-mastodon:before{content:"\\f4f6"}.fa-maxcdn:before{content:"\\f136"}.fa-mdb:before{content:"\\f8ca"}.fa-medal:before{content:"\\f5a2"}.fa-medapps:before{content:"\\f3c6"}.fa-medium:before{content:"\\f23a"}.fa-medium-m:before{content:"\\f3c7"}.fa-medkit:before{content:"\\f0fa"}.fa-medrt:before{content:"\\f3c8"}.fa-meetup:before{content:"\\f2e0"}.fa-megaport:before{content:"\\f5a3"}.fa-meh:before{content:"\\f11a"}.fa-meh-blank:before{content:"\\f5a4"}.fa-meh-rolling-eyes:before{content:"\\f5a5"}.fa-memory:before{content:"\\f538"}.fa-mendeley:before{content:"\\f7b3"}.fa-menorah:before{content:"\\f676"}.fa-mercury:before{content:"\\f223"}.fa-meteor:before{content:"\\f753"}.fa-microblog:before{content:"\\e01a"}.fa-microchip:before{content:"\\f2db"}.fa-microphone:before{content:"\\f130"}.fa-microphone-alt:before{content:"\\f3c9"}.fa-microphone-alt-slash:before{content:"\\f539"}.fa-microphone-slash:before{content:"\\f131"}.fa-microscope:before{content:"\\f610"}.fa-microsoft:before{content:"\\f3ca"}.fa-minus:before{content:"\\f068"}.fa-minus-circle:before{content:"\\f056"}.fa-minus-square:before{content:"\\f146"}.fa-mitten:before{content:"\\f7b5"}.fa-mix:before{content:"\\f3cb"}.fa-mixcloud:before{content:"\\f289"}.fa-mixer:before{content:"\\e056"}.fa-mizuni:before{content:"\\f3cc"}.fa-mobile:before{content:"\\f10b"}.fa-mobile-alt:before{content:"\\f3cd"}.fa-modx:before{content:"\\f285"}.fa-monero:before{content:"\\f3d0"}.fa-money-bill:before{content:"\\f0d6"}.fa-money-bill-alt:before{content:"\\f3d1"}.fa-money-bill-wave:before{content:"\\f53a"}.fa-money-bill-wave-alt:before{content:"\\f53b"}.fa-money-check:before{content:"\\f53c"}.fa-money-check-alt:before{content:"\\f53d"}.fa-monument:before{content:"\\f5a6"}.fa-moon:before{content:"\\f186"}.fa-mortar-pestle:before{content:"\\f5a7"}.fa-mosque:before{content:"\\f678"}.fa-motorcycle:before{content:"\\f21c"}.fa-mountain:before{content:"\\f6fc"}.fa-mouse:before{content:"\\f8cc"}.fa-mouse-pointer:before{content:"\\f245"}.fa-mug-hot:before{content:"\\f7b6"}.fa-music:before{content:"\\f001"}.fa-napster:before{content:"\\f3d2"}.fa-neos:before{content:"\\f612"}.fa-network-wired:before{content:"\\f6ff"}.fa-neuter:before{content:"\\f22c"}.fa-newspaper:before{content:"\\f1ea"}.fa-nimblr:before{content:"\\f5a8"}.fa-node:before{content:"\\f419"}.fa-node-js:before{content:"\\f3d3"}.fa-not-equal:before{content:"\\f53e"}.fa-notes-medical:before{content:"\\f481"}.fa-npm:before{content:"\\f3d4"}.fa-ns8:before{content:"\\f3d5"}.fa-nutritionix:before{content:"\\f3d6"}.fa-object-group:before{content:"\\f247"}.fa-object-ungroup:before{content:"\\f248"}.fa-octopus-deploy:before{content:"\\e082"}.fa-odnoklassniki:before{content:"\\f263"}.fa-odnoklassniki-square:before{content:"\\f264"}.fa-oil-can:before{content:"\\f613"}.fa-old-republic:before{content:"\\f510"}.fa-om:before{content:"\\f679"}.fa-opencart:before{content:"\\f23d"}.fa-openid:before{content:"\\f19b"}.fa-opera:before{content:"\\f26a"}.fa-optin-monster:before{content:"\\f23c"}.fa-orcid:before{content:"\\f8d2"}.fa-osi:before{content:"\\f41a"}.fa-otter:before{content:"\\f700"}.fa-outdent:before{content:"\\f03b"}.fa-page4:before{content:"\\f3d7"}.fa-pagelines:before{content:"\\f18c"}.fa-pager:before{content:"\\f815"}.fa-paint-brush:before{content:"\\f1fc"}.fa-paint-roller:before{content:"\\f5aa"}.fa-palette:before{content:"\\f53f"}.fa-palfed:before{content:"\\f3d8"}.fa-pallet:before{content:"\\f482"}.fa-paper-plane:before{content:"\\f1d8"}.fa-paperclip:before{content:"\\f0c6"}.fa-parachute-box:before{content:"\\f4cd"}.fa-paragraph:before{content:"\\f1dd"}.fa-parking:before{content:"\\f540"}.fa-passport:before{content:"\\f5ab"}.fa-pastafarianism:before{content:"\\f67b"}.fa-paste:before{content:"\\f0ea"}.fa-patreon:before{content:"\\f3d9"}.fa-pause:before{content:"\\f04c"}.fa-pause-circle:before{content:"\\f28b"}.fa-paw:before{content:"\\f1b0"}.fa-paypal:before{content:"\\f1ed"}.fa-peace:before{content:"\\f67c"}.fa-pen:before{content:"\\f304"}.fa-pen-alt:before{content:"\\f305"}.fa-pen-fancy:before{content:"\\f5ac"}.fa-pen-nib:before{content:"\\f5ad"}.fa-pen-square:before{content:"\\f14b"}.fa-pencil-alt:before{content:"\\f303"}.fa-pencil-ruler:before{content:"\\f5ae"}.fa-penny-arcade:before{content:"\\f704"}.fa-people-arrows:before{content:"\\e068"}.fa-people-carry:before{content:"\\f4ce"}.fa-pepper-hot:before{content:"\\f816"}.fa-perbyte:before{content:"\\e083"}.fa-percent:before{content:"\\f295"}.fa-percentage:before{content:"\\f541"}.fa-periscope:before{content:"\\f3da"}.fa-person-booth:before{content:"\\f756"}.fa-phabricator:before{content:"\\f3db"}.fa-phoenix-framework:before{content:"\\f3dc"}.fa-phoenix-squadron:before{content:"\\f511"}.fa-phone:before{content:"\\f095"}.fa-phone-alt:before{content:"\\f879"}.fa-phone-slash:before{content:"\\f3dd"}.fa-phone-square:before{content:"\\f098"}.fa-phone-square-alt:before{content:"\\f87b"}.fa-phone-volume:before{content:"\\f2a0"}.fa-photo-video:before{content:"\\f87c"}.fa-php:before{content:"\\f457"}.fa-pied-piper:before{content:"\\f2ae"}.fa-pied-piper-alt:before{content:"\\f1a8"}.fa-pied-piper-hat:before{content:"\\f4e5"}.fa-pied-piper-pp:before{content:"\\f1a7"}.fa-pied-piper-square:before{content:"\\e01e"}.fa-piggy-bank:before{content:"\\f4d3"}.fa-pills:before{content:"\\f484"}.fa-pinterest:before{content:"\\f0d2"}.fa-pinterest-p:before{content:"\\f231"}.fa-pinterest-square:before{content:"\\f0d3"}.fa-pizza-slice:before{content:"\\f818"}.fa-place-of-worship:before{content:"\\f67f"}.fa-plane:before{content:"\\f072"}.fa-plane-arrival:before{content:"\\f5af"}.fa-plane-departure:before{content:"\\f5b0"}.fa-plane-slash:before{content:"\\e069"}.fa-play:before{content:"\\f04b"}.fa-play-circle:before{content:"\\f144"}.fa-playstation:before{content:"\\f3df"}.fa-plug:before{content:"\\f1e6"}.fa-plus:before{content:"\\f067"}.fa-plus-circle:before{content:"\\f055"}.fa-plus-square:before{content:"\\f0fe"}.fa-podcast:before{content:"\\f2ce"}.fa-poll:before{content:"\\f681"}.fa-poll-h:before{content:"\\f682"}.fa-poo:before{content:"\\f2fe"}.fa-poo-storm:before{content:"\\f75a"}.fa-poop:before{content:"\\f619"}.fa-portrait:before{content:"\\f3e0"}.fa-pound-sign:before{content:"\\f154"}.fa-power-off:before{content:"\\f011"}.fa-pray:before{content:"\\f683"}.fa-praying-hands:before{content:"\\f684"}.fa-prescription:before{content:"\\f5b1"}.fa-prescription-bottle:before{content:"\\f485"}.fa-prescription-bottle-alt:before{content:"\\f486"}.fa-print:before{content:"\\f02f"}.fa-procedures:before{content:"\\f487"}.fa-product-hunt:before{content:"\\f288"}.fa-project-diagram:before{content:"\\f542"}.fa-pump-medical:before{content:"\\e06a"}.fa-pump-soap:before{content:"\\e06b"}.fa-pushed:before{content:"\\f3e1"}.fa-puzzle-piece:before{content:"\\f12e"}.fa-python:before{content:"\\f3e2"}.fa-qq:before{content:"\\f1d6"}.fa-qrcode:before{content:"\\f029"}.fa-question:before{content:"\\f128"}.fa-question-circle:before{content:"\\f059"}.fa-quidditch:before{content:"\\f458"}.fa-quinscape:before{content:"\\f459"}.fa-quora:before{content:"\\f2c4"}.fa-quote-left:before{content:"\\f10d"}.fa-quote-right:before{content:"\\f10e"}.fa-quran:before{content:"\\f687"}.fa-r-project:before{content:"\\f4f7"}.fa-radiation:before{content:"\\f7b9"}.fa-radiation-alt:before{content:"\\f7ba"}.fa-rainbow:before{content:"\\f75b"}.fa-random:before{content:"\\f074"}.fa-raspberry-pi:before{content:"\\f7bb"}.fa-ravelry:before{content:"\\f2d9"}.fa-react:before{content:"\\f41b"}.fa-reacteurope:before{content:"\\f75d"}.fa-readme:before{content:"\\f4d5"}.fa-rebel:before{content:"\\f1d0"}.fa-receipt:before{content:"\\f543"}.fa-record-vinyl:before{content:"\\f8d9"}.fa-recycle:before{content:"\\f1b8"}.fa-red-river:before{content:"\\f3e3"}.fa-reddit:before{content:"\\f1a1"}.fa-reddit-alien:before{content:"\\f281"}.fa-reddit-square:before{content:"\\f1a2"}.fa-redhat:before{content:"\\f7bc"}.fa-redo:before{content:"\\f01e"}.fa-redo-alt:before{content:"\\f2f9"}.fa-registered:before{content:"\\f25d"}.fa-remove-format:before{content:"\\f87d"}.fa-renren:before{content:"\\f18b"}.fa-reply:before{content:"\\f3e5"}.fa-reply-all:before{content:"\\f122"}.fa-replyd:before{content:"\\f3e6"}.fa-republican:before{content:"\\f75e"}.fa-researchgate:before{content:"\\f4f8"}.fa-resolving:before{content:"\\f3e7"}.fa-restroom:before{content:"\\f7bd"}.fa-retweet:before{content:"\\f079"}.fa-rev:before{content:"\\f5b2"}.fa-ribbon:before{content:"\\f4d6"}.fa-ring:before{content:"\\f70b"}.fa-road:before{content:"\\f018"}.fa-robot:before{content:"\\f544"}.fa-rocket:before{content:"\\f135"}.fa-rocketchat:before{content:"\\f3e8"}.fa-rockrms:before{content:"\\f3e9"}.fa-route:before{content:"\\f4d7"}.fa-rss:before{content:"\\f09e"}.fa-rss-square:before{content:"\\f143"}.fa-ruble-sign:before{content:"\\f158"}.fa-ruler:before{content:"\\f545"}.fa-ruler-combined:before{content:"\\f546"}.fa-ruler-horizontal:before{content:"\\f547"}.fa-ruler-vertical:before{content:"\\f548"}.fa-running:before{content:"\\f70c"}.fa-rupee-sign:before{content:"\\f156"}.fa-rust:before{content:"\\e07a"}.fa-sad-cry:before{content:"\\f5b3"}.fa-sad-tear:before{content:"\\f5b4"}.fa-safari:before{content:"\\f267"}.fa-salesforce:before{content:"\\f83b"}.fa-sass:before{content:"\\f41e"}.fa-satellite:before{content:"\\f7bf"}.fa-satellite-dish:before{content:"\\f7c0"}.fa-save:before{content:"\\f0c7"}.fa-schlix:before{content:"\\f3ea"}.fa-school:before{content:"\\f549"}.fa-screwdriver:before{content:"\\f54a"}.fa-scribd:before{content:"\\f28a"}.fa-scroll:before{content:"\\f70e"}.fa-sd-card:before{content:"\\f7c2"}.fa-search:before{content:"\\f002"}.fa-search-dollar:before{content:"\\f688"}.fa-search-location:before{content:"\\f689"}.fa-search-minus:before{content:"\\f010"}.fa-search-plus:before{content:"\\f00e"}.fa-searchengin:before{content:"\\f3eb"}.fa-seedling:before{content:"\\f4d8"}.fa-sellcast:before{content:"\\f2da"}.fa-sellsy:before{content:"\\f213"}.fa-server:before{content:"\\f233"}.fa-servicestack:before{content:"\\f3ec"}.fa-shapes:before{content:"\\f61f"}.fa-share:before{content:"\\f064"}.fa-share-alt:before{content:"\\f1e0"}.fa-share-alt-square:before{content:"\\f1e1"}.fa-share-square:before{content:"\\f14d"}.fa-shekel-sign:before{content:"\\f20b"}.fa-shield-alt:before{content:"\\f3ed"}.fa-shield-virus:before{content:"\\e06c"}.fa-ship:before{content:"\\f21a"}.fa-shipping-fast:before{content:"\\f48b"}.fa-shirtsinbulk:before{content:"\\f214"}.fa-shoe-prints:before{content:"\\f54b"}.fa-shopify:before{content:"\\e057"}.fa-shopping-bag:before{content:"\\f290"}.fa-shopping-basket:before{content:"\\f291"}.fa-shopping-cart:before{content:"\\f07a"}.fa-shopware:before{content:"\\f5b5"}.fa-shower:before{content:"\\f2cc"}.fa-shuttle-van:before{content:"\\f5b6"}.fa-sign:before{content:"\\f4d9"}.fa-sign-in-alt:before{content:"\\f2f6"}.fa-sign-language:before{content:"\\f2a7"}.fa-sign-out-alt:before{content:"\\f2f5"}.fa-signal:before{content:"\\f012"}.fa-signature:before{content:"\\f5b7"}.fa-sim-card:before{content:"\\f7c4"}.fa-simplybuilt:before{content:"\\f215"}.fa-sink:before{content:"\\e06d"}.fa-sistrix:before{content:"\\f3ee"}.fa-sitemap:before{content:"\\f0e8"}.fa-sith:before{content:"\\f512"}.fa-skating:before{content:"\\f7c5"}.fa-sketch:before{content:"\\f7c6"}.fa-skiing:before{content:"\\f7c9"}.fa-skiing-nordic:before{content:"\\f7ca"}.fa-skull:before{content:"\\f54c"}.fa-skull-crossbones:before{content:"\\f714"}.fa-skyatlas:before{content:"\\f216"}.fa-skype:before{content:"\\f17e"}.fa-slack:before{content:"\\f198"}.fa-slack-hash:before{content:"\\f3ef"}.fa-slash:before{content:"\\f715"}.fa-sleigh:before{content:"\\f7cc"}.fa-sliders-h:before{content:"\\f1de"}.fa-slideshare:before{content:"\\f1e7"}.fa-smile:before{content:"\\f118"}.fa-smile-beam:before{content:"\\f5b8"}.fa-smile-wink:before{content:"\\f4da"}.fa-smog:before{content:"\\f75f"}.fa-smoking:before{content:"\\f48d"}.fa-smoking-ban:before{content:"\\f54d"}.fa-sms:before{content:"\\f7cd"}.fa-snapchat:before{content:"\\f2ab"}.fa-snapchat-ghost:before{content:"\\f2ac"}.fa-snapchat-square:before{content:"\\f2ad"}.fa-snowboarding:before{content:"\\f7ce"}.fa-snowflake:before{content:"\\f2dc"}.fa-snowman:before{content:"\\f7d0"}.fa-snowplow:before{content:"\\f7d2"}.fa-soap:before{content:"\\e06e"}.fa-socks:before{content:"\\f696"}.fa-solar-panel:before{content:"\\f5ba"}.fa-sort:before{content:"\\f0dc"}.fa-sort-alpha-down:before{content:"\\f15d"}.fa-sort-alpha-down-alt:before{content:"\\f881"}.fa-sort-alpha-up:before{content:"\\f15e"}.fa-sort-alpha-up-alt:before{content:"\\f882"}.fa-sort-amount-down:before{content:"\\f160"}.fa-sort-amount-down-alt:before{content:"\\f884"}.fa-sort-amount-up:before{content:"\\f161"}.fa-sort-amount-up-alt:before{content:"\\f885"}.fa-sort-down:before{content:"\\f0dd"}.fa-sort-numeric-down:before{content:"\\f162"}.fa-sort-numeric-down-alt:before{content:"\\f886"}.fa-sort-numeric-up:before{content:"\\f163"}.fa-sort-numeric-up-alt:before{content:"\\f887"}.fa-sort-up:before{content:"\\f0de"}.fa-soundcloud:before{content:"\\f1be"}.fa-sourcetree:before{content:"\\f7d3"}.fa-spa:before{content:"\\f5bb"}.fa-space-shuttle:before{content:"\\f197"}.fa-speakap:before{content:"\\f3f3"}.fa-speaker-deck:before{content:"\\f83c"}.fa-spell-check:before{content:"\\f891"}.fa-spider:before{content:"\\f717"}.fa-spinner:before{content:"\\f110"}.fa-splotch:before{content:"\\f5bc"}.fa-spotify:before{content:"\\f1bc"}.fa-spray-can:before{content:"\\f5bd"}.fa-square:before{content:"\\f0c8"}.fa-square-full:before{content:"\\f45c"}.fa-square-root-alt:before{content:"\\f698"}.fa-squarespace:before{content:"\\f5be"}.fa-stack-exchange:before{content:"\\f18d"}.fa-stack-overflow:before{content:"\\f16c"}.fa-stackpath:before{content:"\\f842"}.fa-stamp:before{content:"\\f5bf"}.fa-star:before{content:"\\f005"}.fa-star-and-crescent:before{content:"\\f699"}.fa-star-half:before{content:"\\f089"}.fa-star-half-alt:before{content:"\\f5c0"}.fa-star-of-david:before{content:"\\f69a"}.fa-star-of-life:before{content:"\\f621"}.fa-staylinked:before{content:"\\f3f5"}.fa-steam:before{content:"\\f1b6"}.fa-steam-square:before{content:"\\f1b7"}.fa-steam-symbol:before{content:"\\f3f6"}.fa-step-backward:before{content:"\\f048"}.fa-step-forward:before{content:"\\f051"}.fa-stethoscope:before{content:"\\f0f1"}.fa-sticker-mule:before{content:"\\f3f7"}.fa-sticky-note:before{content:"\\f249"}.fa-stop:before{content:"\\f04d"}.fa-stop-circle:before{content:"\\f28d"}.fa-stopwatch:before{content:"\\f2f2"}.fa-stopwatch-20:before{content:"\\e06f"}.fa-store:before{content:"\\f54e"}.fa-store-alt:before{content:"\\f54f"}.fa-store-alt-slash:before{content:"\\e070"}.fa-store-slash:before{content:"\\e071"}.fa-strava:before{content:"\\f428"}.fa-stream:before{content:"\\f550"}.fa-street-view:before{content:"\\f21d"}.fa-strikethrough:before{content:"\\f0cc"}.fa-stripe:before{content:"\\f429"}.fa-stripe-s:before{content:"\\f42a"}.fa-stroopwafel:before{content:"\\f551"}.fa-studiovinari:before{content:"\\f3f8"}.fa-stumbleupon:before{content:"\\f1a4"}.fa-stumbleupon-circle:before{content:"\\f1a3"}.fa-subscript:before{content:"\\f12c"}.fa-subway:before{content:"\\f239"}.fa-suitcase:before{content:"\\f0f2"}.fa-suitcase-rolling:before{content:"\\f5c1"}.fa-sun:before{content:"\\f185"}.fa-superpowers:before{content:"\\f2dd"}.fa-superscript:before{content:"\\f12b"}.fa-supple:before{content:"\\f3f9"}.fa-surprise:before{content:"\\f5c2"}.fa-suse:before{content:"\\f7d6"}.fa-swatchbook:before{content:"\\f5c3"}.fa-swift:before{content:"\\f8e1"}.fa-swimmer:before{content:"\\f5c4"}.fa-swimming-pool:before{content:"\\f5c5"}.fa-symfony:before{content:"\\f83d"}.fa-synagogue:before{content:"\\f69b"}.fa-sync:before{content:"\\f021"}.fa-sync-alt:before{content:"\\f2f1"}.fa-syringe:before{content:"\\f48e"}.fa-table:before{content:"\\f0ce"}.fa-table-tennis:before{content:"\\f45d"}.fa-tablet:before{content:"\\f10a"}.fa-tablet-alt:before{content:"\\f3fa"}.fa-tablets:before{content:"\\f490"}.fa-tachometer-alt:before{content:"\\f3fd"}.fa-tag:before{content:"\\f02b"}.fa-tags:before{content:"\\f02c"}.fa-tape:before{content:"\\f4db"}.fa-tasks:before{content:"\\f0ae"}.fa-taxi:before{content:"\\f1ba"}.fa-teamspeak:before{content:"\\f4f9"}.fa-teeth:before{content:"\\f62e"}.fa-teeth-open:before{content:"\\f62f"}.fa-telegram:before{content:"\\f2c6"}.fa-telegram-plane:before{content:"\\f3fe"}.fa-temperature-high:before{content:"\\f769"}.fa-temperature-low:before{content:"\\f76b"}.fa-tencent-weibo:before{content:"\\f1d5"}.fa-tenge:before{content:"\\f7d7"}.fa-terminal:before{content:"\\f120"}.fa-text-height:before{content:"\\f034"}.fa-text-width:before{content:"\\f035"}.fa-th:before{content:"\\f00a"}.fa-th-large:before{content:"\\f009"}.fa-th-list:before{content:"\\f00b"}.fa-the-red-yeti:before{content:"\\f69d"}.fa-theater-masks:before{content:"\\f630"}.fa-themeco:before{content:"\\f5c6"}.fa-themeisle:before{content:"\\f2b2"}.fa-thermometer:before{content:"\\f491"}.fa-thermometer-empty:before{content:"\\f2cb"}.fa-thermometer-full:before{content:"\\f2c7"}.fa-thermometer-half:before{content:"\\f2c9"}.fa-thermometer-quarter:before{content:"\\f2ca"}.fa-thermometer-three-quarters:before{content:"\\f2c8"}.fa-think-peaks:before{content:"\\f731"}.fa-thumbs-down:before{content:"\\f165"}.fa-thumbs-up:before{content:"\\f164"}.fa-thumbtack:before{content:"\\f08d"}.fa-ticket-alt:before{content:"\\f3ff"}.fa-tiktok:before{content:"\\e07b"}.fa-times:before{content:"\\f00d"}.fa-times-circle:before{content:"\\f057"}.fa-tint:before{content:"\\f043"}.fa-tint-slash:before{content:"\\f5c7"}.fa-tired:before{content:"\\f5c8"}.fa-toggle-off:before{content:"\\f204"}.fa-toggle-on:before{content:"\\f205"}.fa-toilet:before{content:"\\f7d8"}.fa-toilet-paper:before{content:"\\f71e"}.fa-toilet-paper-slash:before{content:"\\e072"}.fa-toolbox:before{content:"\\f552"}.fa-tools:before{content:"\\f7d9"}.fa-tooth:before{content:"\\f5c9"}.fa-torah:before{content:"\\f6a0"}.fa-torii-gate:before{content:"\\f6a1"}.fa-tractor:before{content:"\\f722"}.fa-trade-federation:before{content:"\\f513"}.fa-trademark:before{content:"\\f25c"}.fa-traffic-light:before{content:"\\f637"}.fa-trailer:before{content:"\\e041"}.fa-train:before{content:"\\f238"}.fa-tram:before{content:"\\f7da"}.fa-transgender:before{content:"\\f224"}.fa-transgender-alt:before{content:"\\f225"}.fa-trash:before{content:"\\f1f8"}.fa-trash-alt:before{content:"\\f2ed"}.fa-trash-restore:before{content:"\\f829"}.fa-trash-restore-alt:before{content:"\\f82a"}.fa-tree:before{content:"\\f1bb"}.fa-trello:before{content:"\\f181"}.fa-tripadvisor:before{content:"\\f262"}.fa-trophy:before{content:"\\f091"}.fa-truck:before{content:"\\f0d1"}.fa-truck-loading:before{content:"\\f4de"}.fa-truck-monster:before{content:"\\f63b"}.fa-truck-moving:before{content:"\\f4df"}.fa-truck-pickup:before{content:"\\f63c"}.fa-tshirt:before{content:"\\f553"}.fa-tty:before{content:"\\f1e4"}.fa-tumblr:before{content:"\\f173"}.fa-tumblr-square:before{content:"\\f174"}.fa-tv:before{content:"\\f26c"}.fa-twitch:before{content:"\\f1e8"}.fa-twitter:before{content:"\\f099"}.fa-twitter-square:before{content:"\\f081"}.fa-typo3:before{content:"\\f42b"}.fa-uber:before{content:"\\f402"}.fa-ubuntu:before{content:"\\f7df"}.fa-uikit:before{content:"\\f403"}.fa-umbraco:before{content:"\\f8e8"}.fa-umbrella:before{content:"\\f0e9"}.fa-umbrella-beach:before{content:"\\f5ca"}.fa-uncharted:before{content:"\\e084"}.fa-underline:before{content:"\\f0cd"}.fa-undo:before{content:"\\f0e2"}.fa-undo-alt:before{content:"\\f2ea"}.fa-uniregistry:before{content:"\\f404"}.fa-unity:before{content:"\\e049"}.fa-universal-access:before{content:"\\f29a"}.fa-university:before{content:"\\f19c"}.fa-unlink:before{content:"\\f127"}.fa-unlock:before{content:"\\f09c"}.fa-unlock-alt:before{content:"\\f13e"}.fa-unsplash:before{content:"\\e07c"}.fa-untappd:before{content:"\\f405"}.fa-upload:before{content:"\\f093"}.fa-ups:before{content:"\\f7e0"}.fa-usb:before{content:"\\f287"}.fa-user:before{content:"\\f007"}.fa-user-alt:before{content:"\\f406"}.fa-user-alt-slash:before{content:"\\f4fa"}.fa-user-astronaut:before{content:"\\f4fb"}.fa-user-check:before{content:"\\f4fc"}.fa-user-circle:before{content:"\\f2bd"}.fa-user-clock:before{content:"\\f4fd"}.fa-user-cog:before{content:"\\f4fe"}.fa-user-edit:before{content:"\\f4ff"}.fa-user-friends:before{content:"\\f500"}.fa-user-graduate:before{content:"\\f501"}.fa-user-injured:before{content:"\\f728"}.fa-user-lock:before{content:"\\f502"}.fa-user-md:before{content:"\\f0f0"}.fa-user-minus:before{content:"\\f503"}.fa-user-ninja:before{content:"\\f504"}.fa-user-nurse:before{content:"\\f82f"}.fa-user-plus:before{content:"\\f234"}.fa-user-secret:before{content:"\\f21b"}.fa-user-shield:before{content:"\\f505"}.fa-user-slash:before{content:"\\f506"}.fa-user-tag:before{content:"\\f507"}.fa-user-tie:before{content:"\\f508"}.fa-user-times:before{content:"\\f235"}.fa-users:before{content:"\\f0c0"}.fa-users-cog:before{content:"\\f509"}.fa-users-slash:before{content:"\\e073"}.fa-usps:before{content:"\\f7e1"}.fa-ussunnah:before{content:"\\f407"}.fa-utensil-spoon:before{content:"\\f2e5"}.fa-utensils:before{content:"\\f2e7"}.fa-vaadin:before{content:"\\f408"}.fa-vector-square:before{content:"\\f5cb"}.fa-venus:before{content:"\\f221"}.fa-venus-double:before{content:"\\f226"}.fa-venus-mars:before{content:"\\f228"}.fa-vest:before{content:"\\e085"}.fa-vest-patches:before{content:"\\e086"}.fa-viacoin:before{content:"\\f237"}.fa-viadeo:before{content:"\\f2a9"}.fa-viadeo-square:before{content:"\\f2aa"}.fa-vial:before{content:"\\f492"}.fa-vials:before{content:"\\f493"}.fa-viber:before{content:"\\f409"}.fa-video:before{content:"\\f03d"}.fa-video-slash:before{content:"\\f4e2"}.fa-vihara:before{content:"\\f6a7"}.fa-vimeo:before{content:"\\f40a"}.fa-vimeo-square:before{content:"\\f194"}.fa-vimeo-v:before{content:"\\f27d"}.fa-vine:before{content:"\\f1ca"}.fa-virus:before{content:"\\e074"}.fa-virus-slash:before{content:"\\e075"}.fa-viruses:before{content:"\\e076"}.fa-vk:before{content:"\\f189"}.fa-vnv:before{content:"\\f40b"}.fa-voicemail:before{content:"\\f897"}.fa-volleyball-ball:before{content:"\\f45f"}.fa-volume-down:before{content:"\\f027"}.fa-volume-mute:before{content:"\\f6a9"}.fa-volume-off:before{content:"\\f026"}.fa-volume-up:before{content:"\\f028"}.fa-vote-yea:before{content:"\\f772"}.fa-vr-cardboard:before{content:"\\f729"}.fa-vuejs:before{content:"\\f41f"}.fa-walking:before{content:"\\f554"}.fa-wallet:before{content:"\\f555"}.fa-warehouse:before{content:"\\f494"}.fa-watchman-monitoring:before{content:"\\e087"}.fa-water:before{content:"\\f773"}.fa-wave-square:before{content:"\\f83e"}.fa-waze:before{content:"\\f83f"}.fa-weebly:before{content:"\\f5cc"}.fa-weibo:before{content:"\\f18a"}.fa-weight:before{content:"\\f496"}.fa-weight-hanging:before{content:"\\f5cd"}.fa-weixin:before{content:"\\f1d7"}.fa-whatsapp:before{content:"\\f232"}.fa-whatsapp-square:before{content:"\\f40c"}.fa-wheelchair:before{content:"\\f193"}.fa-whmcs:before{content:"\\f40d"}.fa-wifi:before{content:"\\f1eb"}.fa-wikipedia-w:before{content:"\\f266"}.fa-wind:before{content:"\\f72e"}.fa-window-close:before{content:"\\f410"}.fa-window-maximize:before{content:"\\f2d0"}.fa-window-minimize:before{content:"\\f2d1"}.fa-window-restore:before{content:"\\f2d2"}.fa-windows:before{content:"\\f17a"}.fa-wine-bottle:before{content:"\\f72f"}.fa-wine-glass:before{content:"\\f4e3"}.fa-wine-glass-alt:before{content:"\\f5ce"}.fa-wix:before{content:"\\f5cf"}.fa-wizards-of-the-coast:before{content:"\\f730"}.fa-wodu:before{content:"\\e088"}.fa-wolf-pack-battalion:before{content:"\\f514"}.fa-won-sign:before{content:"\\f159"}.fa-wordpress:before{content:"\\f19a"}.fa-wordpress-simple:before{content:"\\f411"}.fa-wpbeginner:before{content:"\\f297"}.fa-wpexplorer:before{content:"\\f2de"}.fa-wpforms:before{content:"\\f298"}.fa-wpressr:before{content:"\\f3e4"}.fa-wrench:before{content:"\\f0ad"}.fa-x-ray:before{content:"\\f497"}.fa-xbox:before{content:"\\f412"}.fa-xing:before{content:"\\f168"}.fa-xing-square:before{content:"\\f169"}.fa-y-combinator:before{content:"\\f23b"}.fa-yahoo:before{content:"\\f19e"}.fa-yammer:before{content:"\\f840"}.fa-yandex:before{content:"\\f413"}.fa-yandex-international:before{content:"\\f414"}.fa-yarn:before{content:"\\f7e3"}.fa-yelp:before{content:"\\f1e9"}.fa-yen-sign:before{content:"\\f157"}.fa-yin-yang:before{content:"\\f6ad"}.fa-yoast:before{content:"\\f2b1"}.fa-youtube:before{content:"\\f167"}.fa-youtube-square:before{content:"\\f431"}.fa-zhihu:before{content:"\\f63f"}.sr-only{border:0;clip:rect(0,0,0,0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px}.sr-only-focusable:active,.sr-only-focusable:focus{clip:auto;height:auto;margin:0;overflow:visible;position:static;width:auto}@font-face{font-family:"Font Awesome 5 Brands";font-style:normal;font-weight:400;font-display:block;src:url('+S+");src:url("+E+') format("embedded-opentype"),url('+D+') format("woff2"),url('+A+') format("woff"),url('+M+') format("truetype"),url('+R+') format("svg")}.fab{font-family:"Font Awesome 5 Brands"}@font-face{font-family:"Font Awesome 5 Free";font-style:normal;font-weight:400;font-display:block;src:url('+L+");src:url("+T+') format("embedded-opentype"),url('+P+') format("woff2"),url('+z+') format("woff"),url('+I+') format("truetype"),url('+O+') format("svg")}.fab,.far{font-weight:400}@font-face{font-family:"Font Awesome 5 Free";font-style:normal;font-weight:900;font-display:block;src:url('+F+");src:url("+B+') format("embedded-opentype"),url('+N+') format("woff2"),url('+H+') format("woff"),url('+U+') format("truetype"),url('+$+') format("svg")}.fa,.far,.fas{font-family:"Font Awesome 5 Free"}.fa,.fas{font-weight:900}',""]);const j=k},7745:(e,t,n)=>{"use strict";n.d(t,{Z:()=>E});var i=n(8081),r=n.n(i),o=n(3645),a=n.n(o),s=n(1667),l=n.n(s),c=new URL(n(4413),n.b),h=new URL(n(6912),n.b),u=new URL(n(8712),n.b),f=new URL(n(6908),n.b),d=new URL(n(996),n.b),p=new URL(n(9513),n.b),g=new URL(n(1679),n.b),m=new URL(n(6710),n.b),_=a()(r()),v=l()(c),b=l()(h),y=l()(u),w=l()(f),x=l()(d),C=l()(p),k=l()(g),S=l()(m);_.push([e.id,".header-overlay, .cell-overlay, .selection-cell-overlay\r\n{\r\n\r\n    display: block;\r\n    position: absolute;\r\n    z-index: 999;\r\n}\r\n.header-overlay {\r\n  background-color: #217346;\r\n}\r\n\r\n.cell-overlay, .selection-cell-overlay {\r\n  background-color: #217346;\r\n}\r\n\r\n.mlv-tile{\r\n  position:absolute;\r\n  box-sizing: border-box;\r\n  \r\n}\r\n\r\ninput.editor-text {\r\n  font: 11pt Calibri, 'Segoe UI',Arial,Verdana,Sans-Serif;\r\n  background: none;\r\n  border: 0 none;\r\n  margin: 0;\r\n  outline: 0 none;\r\n  padding: 0;\r\n  width: 100%;\r\n}\r\n\r\n.handle-overlay {\r\n  border: 1px solid white;\r\n  padding: 2px;\r\n  background-color: #217346;\r\n  position: absolute;\r\n  width: 1px;\r\n  z-index: 1000;\r\n  cursor: crosshair;\r\n}\r\n\r\n.overlay-handle-decorator {\r\n  border: 2px solid #217346;\r\n  z-index: 1000;\r\n}\r\n\r\n.image-table-selected {\r\n  border: 4px solid goldenrod;\r\n}\r\n\r\n\r\n\r\n/*\r\nIMPORTANT:\r\nIn order to preserve the uniform grid appearance, all cell styles need to have padding, margin and border sizes.\r\nNo built-in (selected, editable, highlight, flashing, invalid, loading, :focus) or user-specified CSS\r\nclasses should alter those!\r\n*/\r\n\r\n.slick-header.ui-state-default, .slick-headerrow.ui-state-default, .slick-footerrow.ui-state-default, .slick-top-panel-scroller.ui-state-default, .slick-group-header.ui-state-default {\r\n    width: 100%;\r\n    overflow: auto;\r\n    position: relative;\r\n    border-left: 0px !important;\r\n  }\r\n  \r\n  .slick-header.ui-state-default {\r\n    overflow: inherit;\r\n  }\r\n  \r\n  .slick-header::-webkit-scrollbar,  .slick-headerrow::-webkit-scrollbar, .slick-footerrow::-webkit-scrollbar {\r\n    display: none\r\n  }\r\n  \r\n  .slick-header-columns, .slick-headerrow-columns, .slick-footerrow-columns, .slick-group-header-columns {\r\n    position: relative;\r\n    white-space: nowrap;\r\n    cursor: default;\r\n    overflow: hidden;\r\n  }\r\n  \r\n  .slick-header-column.ui-state-default, .slick-group-header-column.ui-state-default {\r\n    position: relative;\r\n    display: inline-block;\r\n    box-sizing: content-box !important; /* this here only for Firefox! */ \r\n    overflow: hidden;\r\n    -o-text-overflow: ellipsis;\r\n    text-overflow: ellipsis;\r\n    height: 16px;\r\n    line-height: 16px;\r\n    margin: 0;\r\n    padding: 4px;\r\n    border-right: 1px solid silver;\r\n    border-left: 0px !important;\r\n    border-top: 0px !important;\r\n    border-bottom: 0px !important;\r\n    float: left;\r\n  }\r\n  \r\n  .slick-footerrow-column.ui-state-default {\r\n    -o-text-overflow: ellipsis;\r\n    text-overflow: ellipsis;\r\n    margin: 0;\r\n    padding: 4px;\r\n    border-right: 1px solid silver;\r\n    border-left: 0px;\r\n    border-top: 0px;\r\n    border-bottom: 0px;\r\n    float: left;\r\n    line-height: 20px;\r\n    vertical-align: middle;\r\n  }\r\n  \r\n  .slick-headerrow-column.ui-state-default, .slick-footerrow-column.ui-state-default {\r\n    padding: 4px;\r\n  }\r\n  \r\n  .slick-header-column-sorted {\r\n    font-style: italic;\r\n  }\r\n  \r\n  .slick-sort-indicator {\r\n    display: inline-block;\r\n    width: 8px;\r\n    height: 5px;\r\n    margin-left: 4px;\r\n    margin-top: 6px;\r\n    float: left;\r\n  }\r\n  \r\n  .slick-sort-indicator-numbered {\r\n    display: inline-block;\r\n    width: 8px;\r\n    height: 5px;\r\n    margin-left: 4px;\r\n    margin-top: 0;\r\n    line-height: 20px;\r\n    float: left;\r\n    font-family: Arial;\r\n    font-style: normal;\r\n    font-weight: bold;\r\n    color: #6190CD;\r\n  }\r\n  \r\n  .slick-sort-indicator-desc {\r\n    background: url("+v+");\r\n  }\r\n  \r\n  .slick-sort-indicator-asc {\r\n    background: url("+b+");\r\n  }\r\n  \r\n  .slick-resizable-handle {\r\n    position: absolute;\r\n    font-size: 0.1px;\r\n    display: block;\r\n    cursor: col-resize;\r\n    width: 9px;\r\n    right: -5px;\r\n    top: 0;\r\n    height: 100%;\r\n    z-index: 1;\r\n  }\r\n\r\n \r\n  .slick-sortable-placeholder {\r\n    background: silver;\r\n  }\r\n\r\n  .selected{\r\n     background:beige;\r\n  }\r\n  \r\n  .grid-canvas {\r\n    position: relative;\r\n    outline: 0;\r\n  }\r\n  \r\n  .slick-row.ui-widget-content, .slick-row.ui-state-active {\r\n    position: absolute;\r\n    border: 0px;\r\n    width: 100%;\r\n  }\r\n  \r\n  .slick-cell, .slick-headerrow-column , .slick-footerrow-column{\r\n    position: absolute;\r\n    border: 1px solid transparent;\r\n    border-right: 1px dotted silver;\r\n    border-bottom-color: silver;\r\n    overflow: hidden;\r\n    -o-text-overflow: ellipsis;\r\n    text-overflow: ellipsis;\r\n    vertical-align: middle;\r\n    z-index: 0;\r\n    padding: 1px 2px 2px 1px;\r\n    margin: 0;\r\n    white-space: nowrap;\r\n    cursor: default;\r\n  }\r\n  .slick-cell, .slick-headerrow-column{\r\n    border-bottom-color: silver;\r\n  }\r\n  .slick-footerrow-column {\r\n    border-top-color: silver;\r\n  }\r\n\r\n  \r\n  .slick-group {\r\n  }\r\n  \r\n  .slick-group-toggle {\r\n    display: inline-block;\r\n  }\r\n  \r\n  .slick-cell.highlighted {\r\n    background: lightskyblue;\r\n    background: rgba(0, 0, 255, 0.2);\r\n    -webkit-transition: all 0.5s;\r\n    -moz-transition: all 0.5s;\r\n    -o-transition: all 0.5s;\r\n    transition: all 0.5s;\r\n  }\r\n  \r\n  .slick-cell.flashing {\r\n    border: 1px solid red !important;\r\n  }\r\n  \r\n  .slick-cell.editable {\r\n    z-index: 11;\r\n    overflow: visible;\r\n    background: white;\r\n    border-color: black;\r\n    border-style: solid;\r\n  }\r\n  \r\n  .slick-cell:focus {\r\n    outline: none;\r\n  }\r\n  \r\n  .slick-reorder-proxy {\r\n    display: inline-block;\r\n    background: blue;\r\n    opacity: 0.15;\r\n    filter: alpha(opacity = 15);\r\n    cursor: move;\r\n  }\r\n  \r\n  .slick-reorder-guide {\r\n    display: inline-block;\r\n    height: 2px;\r\n    background: blue;\r\n    opacity: 0.7;\r\n    filter: alpha(opacity = 70);\r\n  }\r\n  \r\n  .slick-selection {\r\n    z-index: 10;\r\n    position: absolute;\r\n    border: 2px dashed black;\r\n  }\r\n  \r\n  .slick-pane {\r\n    position: absolute;\r\n    outline: 0;\r\n    overflow: hidden;\r\n    width: 100%;\r\n  }\r\n  \r\n  .slick-pane-header {\r\n    display: block;\r\n  }\r\n  \r\n  .slick-header {\r\n    overflow: hidden;\r\n    position: relative;\r\n  }\r\n  \r\n  .slick-headerrow {\r\n    overflow: hidden;\r\n    position: relative;\r\n  }\r\n  \r\n  .slick-top-panel-scroller {\r\n    overflow: hidden;\r\n    position: relative;\r\n  }\r\n  \r\n  .slick-top-panel {\r\n    width: 10000px\r\n  }\r\n  \r\n  .slick-viewport {\r\n    position: relative;\r\n    outline: 0;\r\n    width: 100%;\r\n  }\r\n\r\n  .slick-header{\r\n    background:lightgray;\r\n  }\r\n   .slick-header-column{\r\n     border-color:white;\r\n   }\r\n\r\n\r\n   .slick-header-columns {\r\n    background: url("+y+") repeat-x center bottom;\r\n    border-bottom: 1px solid silver;\r\n  }\r\n  \r\n  .slick-header-column {\r\n    background: url("+y+") repeat-x center bottom;\r\n    border-right: 1px solid silver;\r\n  }\r\n  \r\n  .slick-header-column:hover, .slick-header-column-active {\r\n    background: white url("+w+") repeat-x center bottom;\r\n  }\r\n  \r\n  .slick-headerrow {\r\n    background: #fafafa;\r\n  }\r\n  \r\n  .slick-headerrow-column {\r\n    background: #fafafa;\r\n    border-bottom: 0;\r\n    height: 100%;\r\n  }\r\n  \r\n  .slick-row.ui-state-active {\r\n    background: #F5F7D7;\r\n  }\r\n  \r\n  .slick-row {\r\n    position: absolute;\r\n    background: white;\r\n    border: 0px;\r\n    line-height: 20px;\r\n  }\r\n  \r\n  .slick-row.selected {\r\n    z-index: 10;\r\n    background: #DFE8F6;\r\n  }\r\n  \r\n  .slick-cell {\r\n    padding-left: 4px;\r\n    padding-right: 4px;\r\n  }\r\n  \r\n  .slick-group {\r\n    border-bottom: 2px solid silver;\r\n  }\r\n  \r\n  .slick-group-toggle {\r\n    width: 9px;\r\n    height: 9px;\r\n    margin-right: 5px;\r\n  }\r\n  \r\n  .slick-group-toggle.expanded {\r\n    background: url("+x+") no-repeat center center;\r\n  }\r\n  \r\n  .slick-group-toggle.collapsed {\r\n    background: url("+C+") no-repeat center center;\r\n  }\r\n  \r\n  .slick-group-totals {\r\n    color: gray;\r\n    background: white;\r\n  }\r\n  \r\n  .slick-group-select-checkbox {\r\n    width: 13px;\r\n    height: 13px;\r\n    margin: 3px 10px 0 0;\r\n    display: inline-block;\r\n  }\r\n  .slick-group-select-checkbox.checked {\r\n    background: url("+k+") no-repeat center center;\r\n  }\r\n  \r\n  .slick-group-select-checkbox.unchecked {\r\n    background: url("+S+") no-repeat center center;\r\n  }\r\n  \r\n  .slick-cell.selected {\r\n    background-color: beige;\r\n  }\r\n  \r\n  .slick-cell.active {\r\n    border-color: gray;\r\n    border-style: solid;\r\n  }\r\n  \r\n  .slick-sortable-placeholder {\r\n    background: silver !important;\r\n  }\r\n  \r\n  .slick-row.odd {\r\n    background: #fafafa;\r\n  }\r\n  \r\n  .slick-row.ui-state-active {\r\n    background: #F5F7D7;\r\n  }\r\n  \r\n  .slick-row.loading {\r\n    opacity: 0.5;\r\n    filter: alpha(opacity = 50);\r\n  }\r\n\r\n  /*.active{\r\n    background: beige !important;\r\n  }*/\r\n  \r\n  .slick-cell.invalid {\r\n    border-color: red;\r\n    -moz-animation-duration: 0.2s;\r\n    -webkit-animation-duration: 0.2s;\r\n    -moz-animation-name: slickgrid-invalid-hilite;\r\n    -webkit-animation-name: slickgrid-invalid-hilite;  \r\n  }\r\n  \r\n  @-moz-keyframes slickgrid-invalid-hilite {\r\n    from { box-shadow: 0 0 6px red; }\r\n    to { box-shadow: none; }\r\n  }\r\n  \r\n  @-webkit-keyframes slickgrid-invalid-hilite {\r\n    from { box-shadow: 0 0 6px red; }\r\n    to { box-shadow: none; }\r\n  }\r\n",""]);const E=_},7047:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var i=n(8081),r=n.n(i),o=n(3645),a=n.n(o)()(r());a.push([e.id,'.u-tree-list{\r\n  list-style-type: none;\r\n}\r\n\r\n.u-tree-selected{\r\n  background: #888;\r\n}\r\n\r\n.Dark .slick-row.odd{\r\n  background:#303030;\r\n}\r\n\r\n.Dark .ui-widget-content{\r\n  color:white;\r\n}\r\n\r\n.Dark .even{\r\n  background:#404040\r\n}\r\n\r\n.Dark .slick-header-column{\r\n  background:black;\r\n  color:white;\r\n}\r\n.Dark .slick-header-column:hover {\r\n  background: var(--menu-gradient);\r\n}\r\n.Dark .slick-header-columns{\r\n  background:black\r\n}\r\n.Dark .slick-header{\r\n  background:black\r\n}\r\n\r\n.Dark .slick-viewport::-webkit-scrollbar-track {\r\n  background: #585858;        /* color of the tracking area */\r\n}\r\n\r\n.Dark .slick-viewport::-webkit-scrollbar {\r\n  width: 12px;\r\n}\r\n.Dark .slick-viewport::-webkit-scrollbar-thumb {\r\n  background-color:\tblack ;\r\n\r\n}\r\n\r\n.Dark .slick-cell.selected{\r\n  background:\t#5c3434\r\n}\r\n\r\n.mdv-progress-outer{\r\n  background-color:gray;\r\n  height:16px;\r\n  border-radius:5px;\r\n  position:relative;\r\n}\r\n\r\n.mdv-progress-inner{\r\n  background-color:blue;\r\n  height:16px;\r\n  border-radius:5px; \r\n}\r\n\r\n.mdv-progress-text{\r\n \r\n  position: absolute;\r\n  top: 1px;\r\n  color:white;\r\n  width: 100%;\r\n  text-align: center;\r\n  font-size: 14px;\r\n  overflow:hidden,\r\n\r\n\r\n}\r\n\r\n.mdv-dark-mode{\r\n  background-color: black;\r\n  color:white;\r\n}\r\n\r\n\r\n\r\n\r\n.noUi-handle:after, .noUi-handle:before{\r\n    visibility:hidden;\r\n    left:-10px;\r\n   \r\n}\r\n.ciview-tooltip{\r\n  display:none;\r\n  position:absolute;\r\n  border-radius:6px;\r\n  padding:4px;\r\n  background:burlywood;\r\n  z-index:5;\r\n\r\n}\r\n\r\n.noUi-tooltip {\r\n  display: none;\r\n}\r\n.noUi-active .noUi-tooltip {\r\n  display: block;\r\n}\r\n\r\n.noUi-horizontal .noUi-handle {\r\n  /* fugly. also doubleslider behaviour is a bit broken I think. */\r\n    width: 20px;\r\n    height: 20px;\r\n    right: -10px;\r\n    top: -8px;\r\n    border-radius:20px;\r\n    background: rgba(73, 69, 78);\r\n    box-shadow: none;\r\n    transition: border-width 0.5s;\r\n}\r\n.noUi-handle:hover, .noUi-handle:active {\r\n  border-width: 0.2em;\r\n  transition: border-width 0.2s;\r\n}\r\n.noUi-horizontal {\r\n  top: 4px;\r\n  height: 6px;\r\n  margin: 6px 10px 14px 10px;\r\n}\r\n.ciview-dlg-content label {\r\n  margin-right: 1em;\r\n}\r\n.ciview-dlg-content .ciview-button {\r\n  display: inline-block;\r\n  margin: 8px;\r\n}\r\n\r\n* {\r\n  -webkit-user-select: none;\r\n  -khtml-user-select: none;\r\n  -moz-user-select: -moz-none;\r\n  -o-user-select: none;\r\n  user-select: none;\r\n}\r\n\r\n.ciview-menu-icon{\r\n  font-weight:"bold";\r\n  cursor:"pointer";\r\n  margin:2px 4px;\r\n  cursor:pointer;\r\n}\r\n\r\n\r\n.ciview-menu-bar{\r\n  flex:0 0 auto;\r\n  padding:3px 20px;\r\n  background-image: var(--menu-gradient);\r\n  color: var(--text_color);\r\n\r\n}\r\n\r\n.ciview-ctm-main{\r\n\tposition:absolute;\r\n\tz-index:1000;\r\n\tborder:1px solid black;\r\n  background:white;\r\n\r\n   }\r\n   .ciview-ctm-active{\r\n       cursor:pointer\r\n   }\r\n   .ciview-ctm-selected{\r\n       background-color:lightgray;\r\n   }\r\n   .ciview-ctm-active:hover{\r\n       background-color:lightgray;\r\n   }\r\n   .ciview-ctm-item{\r\n       padding:4px;\r\n       white-space:nowrap;\r\n\r\n     \r\n   }\r\n    .ciview-ctm-item span{\r\n        margin-right:5px;\r\n        white-space:nowrap;\r\n    }\r\n\r\n    .ciview-ctm-left-icon{\r\n   \t margin-right:5px;\r\n   }\r\n\r\n   .ciview-ctm-ghosted{\r\n   \t opacity:0.5\r\n   }\r\n\r\n   .ciview-ctm-right-icon{\r\n   \t float:right\r\n   }\r\n\r\n   .legend-body::-webkit-scrollbar-track {\r\n    background: #f1f1f1; \r\n  }\r\n   \r\n  /* Handle */\r\n  .legend-body::-webkit-scrollbar-thumb {\r\n    background: #888; \r\n  }\r\n  \r\n  /* Handle on hover */\r\n  .legend-body::-webkit-scrollbar-thumb:hover {\r\n    background: #555; \r\n  }\r\n  .legend-body::-webkit-scrollbar {\r\n    width: 8px;\r\n    height:8px;\r\n  }\r\n  \r\n   .ciview-dlg-outer {\r\n    position: absolute;\r\n    z-index: 1100;\r\n    background-color: var(--background_color);\r\n    color: var(--text_color);\r\n    border: 1px solid #d3d3d3;\r\n    overflow:auto;\r\n    display:flex;\r\n    flex-flow:column;\r\n\r\n  }\r\n  select, input, textarea {\r\n    color: var(--text_color);\r\n    background-color: var(--background_color);\r\n  }\r\n  \r\n   .gutter-horizontal{\r\n     float:left;\r\n     height:100%;\r\n     background-color:silver;\r\n     cursor:col-resize;\r\n   }\r\n\r\n   .split-horizontal{\r\n    float:left;\r\n    height:100%;\r\n   }\r\n  .ciview-dlg-close-icon{\r\n      cursor:pointer;\r\n      color:black;\r\n      font-size:20px;\r\n      margin-left:auto;\r\n      margin-bottom:8px;\r\n      position:absolute;\r\n      top:3px;\r\n      right:3px\r\n  }\r\n\r\n  .ciview-dlg-content{ \r\n        overflow-X:hidden;\r\n        overflow-Y:auto;\r\n        flex:1 1 auto;\r\n        padding:5px;\r\n  }\r\n  \r\n  .ciview-dlg-header {\r\n    padding: 6px;\r\n    cursor: move;\r\n    background-color: #2196F3;\r\n    color: #fff;\r\n    text-overflow: ellipsis;\r\n    overflow:hidden;\r\n    flex:0 0 auto;\r\n    margin-bottom: 0.2em;\r\n  }\r\n\r\n  .ciview-dlg-header-text{\r\n      white-space:nowrap;\r\n      text-overflow: ellipsis;\r\n  }\r\n\r\n\r\n  .autocomplete-items {\r\n    position: absolute;\r\n    border: 1px solid #d4d4d4;\r\n    border-bottom: none;\r\n    border-top: none;\r\n    z-index: 99;\r\n    /*position the autocomplete items to be the same width as the container:*/\r\n  }\r\n  \r\n  .autocomplete-items div {\r\n    padding: 2px;\r\n    cursor: pointer;\r\n    background-color: #fff;\r\n    border-bottom: 1px solid #d4d4d4;\r\n    font-size:0.8em;\r\n  }\r\n  .autocomplete-items div:hover {\r\n    /*when hovering an item:*/\r\n    background-color: #e9e9e9;\r\n  }\r\n  .autocomplete-active {\r\n    /*when navigating through the items using the arrow keys:*/\r\n    background-color: DodgerBlue !important;\r\n    color: #ffffff;\r\n  }\r\n\r\n  .mdv-grid-2-columns {\r\n    display:grid;\r\n    grid-template-columns:1fr 1fr;\r\n    grid-template-rows:1fr 10px;\r\n    justify-items:left;\r\n  }\r\n\r\n  .mdv-grid-footer{\r\n    grid-area:-2 / 1 / -1 /-1; \r\n  }\r\n\r\n  .mdv-section {\r\n    white-space: nowrap;\r\n    padding:5px;\r\n  }\r\n\r\n  .mdv-disabled {\r\n    pointer-events:"none";\r\n    color:gray;\r\n  }\r\n\r\n  .mdv-element-dragged {\r\n    border: 1px solid var(--text_color);\r\n  }',""]);const s=a},9719:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var i=n(8081),r=n.n(i),o=n(3645),a=n.n(o)()(r());a.push([e.id,".wgl2di-brush{\r\n    height:0px;\r\n    width:0px;\r\n    cursor:move;\r\n\tbackground-color:gray;\r\n    opacity:0.2;\r\n    position:absolute;\r\n}",""]);const s=a},3645:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",i=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),i&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),i&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,i,r,o){"string"==typeof e&&(e=[[null,e,void 0]]);var a={};if(i)for(var s=0;s<this.length;s++){var l=this[s][0];null!=l&&(a[l]=!0)}for(var c=0;c<e.length;c++){var h=[].concat(e[c]);i&&a[h[0]]||(void 0!==o&&(void 0===h[5]||(h[1]="@layer".concat(h[5].length>0?" ".concat(h[5]):""," {").concat(h[1],"}")),h[5]=o),n&&(h[2]?(h[1]="@media ".concat(h[2]," {").concat(h[1],"}"),h[2]=n):h[2]=n),r&&(h[4]?(h[1]="@supports (".concat(h[4],") {").concat(h[1],"}"),h[4]=r):h[4]="".concat(r)),t.push(h))}},t}},1667:e=>{"use strict";e.exports=function(e,t){return t||(t={}),e?(e=String(e.__esModule?e.default:e),/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),t.hash&&(e+=t.hash),/["'() \t\n]|(%20)/.test(e)||t.needQuotes?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e):e}},8081:e=>{"use strict";e.exports=function(e){return e[1]}},2921:(e,t,n)=>{"use strict";function i(e){return null===e?NaN:+e}n.d(t,{Z:()=>i})},9685:(e,t,n)=>{"use strict";n.d(t,{Ib:()=>i,WT:()=>r});var i=1e-6,r="undefined"!=typeof Float32Array?Float32Array:Array;Math.random,Math.PI,Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)})},5975:(e,t,n)=>{"use strict";n.d(t,{G3:()=>v,GH:()=>s,Iu:()=>c,Jp:()=>l,M5:()=>b,Q$:()=>g,U1:()=>u,U_:()=>a,bA:()=>h,en:()=>m,jI:()=>p,lM:()=>f,oy:()=>_,p4:()=>o,uD:()=>d,yR:()=>r,zB:()=>y});var i=n(9685);function r(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function o(e,t){if(e===t){var n=t[1],i=t[2],r=t[3],o=t[6],a=t[7],s=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=n,e[6]=t[9],e[7]=t[13],e[8]=i,e[9]=o,e[11]=t[14],e[12]=r,e[13]=a,e[14]=s}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function a(e,t){var n=t[0],i=t[1],r=t[2],o=t[3],a=t[4],s=t[5],l=t[6],c=t[7],h=t[8],u=t[9],f=t[10],d=t[11],p=t[12],g=t[13],m=t[14],_=t[15],v=n*s-i*a,b=n*l-r*a,y=n*c-o*a,w=i*l-r*s,x=i*c-o*s,C=r*c-o*l,k=h*g-u*p,S=h*m-f*p,E=h*_-d*p,D=u*m-f*g,A=u*_-d*g,M=f*_-d*m,R=v*M-b*A+y*D+w*E-x*S+C*k;return R?(R=1/R,e[0]=(s*M-l*A+c*D)*R,e[1]=(r*A-i*M-o*D)*R,e[2]=(g*C-m*x+_*w)*R,e[3]=(f*x-u*C-d*w)*R,e[4]=(l*E-a*M-c*S)*R,e[5]=(n*M-r*E+o*S)*R,e[6]=(m*y-p*C-_*b)*R,e[7]=(h*C-f*y+d*b)*R,e[8]=(a*A-s*E+c*k)*R,e[9]=(i*E-n*A-o*k)*R,e[10]=(p*x-g*y+_*v)*R,e[11]=(u*y-h*x-d*v)*R,e[12]=(s*S-a*D-l*k)*R,e[13]=(n*D-i*S+r*k)*R,e[14]=(g*b-p*w-m*v)*R,e[15]=(h*w-u*b+f*v)*R,e):null}function s(e){var t=e[0],n=e[1],i=e[2],r=e[3],o=e[4],a=e[5],s=e[6],l=e[7],c=e[8],h=e[9],u=e[10],f=e[11],d=e[12],p=e[13],g=e[14],m=e[15];return(t*a-n*o)*(u*m-f*g)-(t*s-i*o)*(h*m-f*p)+(t*l-r*o)*(h*g-u*p)+(n*s-i*a)*(c*m-f*d)-(n*l-r*a)*(c*g-u*d)+(i*l-r*s)*(c*p-h*d)}function l(e,t,n){var i=t[0],r=t[1],o=t[2],a=t[3],s=t[4],l=t[5],c=t[6],h=t[7],u=t[8],f=t[9],d=t[10],p=t[11],g=t[12],m=t[13],_=t[14],v=t[15],b=n[0],y=n[1],w=n[2],x=n[3];return e[0]=b*i+y*s+w*u+x*g,e[1]=b*r+y*l+w*f+x*m,e[2]=b*o+y*c+w*d+x*_,e[3]=b*a+y*h+w*p+x*v,b=n[4],y=n[5],w=n[6],x=n[7],e[4]=b*i+y*s+w*u+x*g,e[5]=b*r+y*l+w*f+x*m,e[6]=b*o+y*c+w*d+x*_,e[7]=b*a+y*h+w*p+x*v,b=n[8],y=n[9],w=n[10],x=n[11],e[8]=b*i+y*s+w*u+x*g,e[9]=b*r+y*l+w*f+x*m,e[10]=b*o+y*c+w*d+x*_,e[11]=b*a+y*h+w*p+x*v,b=n[12],y=n[13],w=n[14],x=n[15],e[12]=b*i+y*s+w*u+x*g,e[13]=b*r+y*l+w*f+x*m,e[14]=b*o+y*c+w*d+x*_,e[15]=b*a+y*h+w*p+x*v,e}function c(e,t,n){var i,r,o,a,s,l,c,h,u,f,d,p,g=n[0],m=n[1],_=n[2];return t===e?(e[12]=t[0]*g+t[4]*m+t[8]*_+t[12],e[13]=t[1]*g+t[5]*m+t[9]*_+t[13],e[14]=t[2]*g+t[6]*m+t[10]*_+t[14],e[15]=t[3]*g+t[7]*m+t[11]*_+t[15]):(i=t[0],r=t[1],o=t[2],a=t[3],s=t[4],l=t[5],c=t[6],h=t[7],u=t[8],f=t[9],d=t[10],p=t[11],e[0]=i,e[1]=r,e[2]=o,e[3]=a,e[4]=s,e[5]=l,e[6]=c,e[7]=h,e[8]=u,e[9]=f,e[10]=d,e[11]=p,e[12]=i*g+s*m+u*_+t[12],e[13]=r*g+l*m+f*_+t[13],e[14]=o*g+c*m+d*_+t[14],e[15]=a*g+h*m+p*_+t[15]),e}function h(e,t,n){var i=n[0],r=n[1],o=n[2];return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*o,e[9]=t[9]*o,e[10]=t[10]*o,e[11]=t[11]*o,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function u(e,t,n,r){var o,a,s,l,c,h,u,f,d,p,g,m,_,v,b,y,w,x,C,k,S,E,D,A,M=r[0],R=r[1],L=r[2],T=Math.hypot(M,R,L);return T<i.Ib?null:(M*=T=1/T,R*=T,L*=T,o=Math.sin(n),s=1-(a=Math.cos(n)),l=t[0],c=t[1],h=t[2],u=t[3],f=t[4],d=t[5],p=t[6],g=t[7],m=t[8],_=t[9],v=t[10],b=t[11],y=M*M*s+a,w=R*M*s+L*o,x=L*M*s-R*o,C=M*R*s-L*o,k=R*R*s+a,S=L*R*s+M*o,E=M*L*s+R*o,D=R*L*s-M*o,A=L*L*s+a,e[0]=l*y+f*w+m*x,e[1]=c*y+d*w+_*x,e[2]=h*y+p*w+v*x,e[3]=u*y+g*w+b*x,e[4]=l*C+f*k+m*S,e[5]=c*C+d*k+_*S,e[6]=h*C+p*k+v*S,e[7]=u*C+g*k+b*S,e[8]=l*E+f*D+m*A,e[9]=c*E+d*D+_*A,e[10]=h*E+p*D+v*A,e[11]=u*E+g*D+b*A,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function f(e,t,n){var i=Math.sin(n),r=Math.cos(n),o=t[4],a=t[5],s=t[6],l=t[7],c=t[8],h=t[9],u=t[10],f=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=o*r+c*i,e[5]=a*r+h*i,e[6]=s*r+u*i,e[7]=l*r+f*i,e[8]=c*r-o*i,e[9]=h*r-a*i,e[10]=u*r-s*i,e[11]=f*r-l*i,e}function d(e,t,n){var i=Math.sin(n),r=Math.cos(n),o=t[0],a=t[1],s=t[2],l=t[3],c=t[8],h=t[9],u=t[10],f=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*r-c*i,e[1]=a*r-h*i,e[2]=s*r-u*i,e[3]=l*r-f*i,e[8]=o*i+c*r,e[9]=a*i+h*r,e[10]=s*i+u*r,e[11]=l*i+f*r,e}function p(e,t,n){var i=Math.sin(n),r=Math.cos(n),o=t[0],a=t[1],s=t[2],l=t[3],c=t[4],h=t[5],u=t[6],f=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*r+c*i,e[1]=a*r+h*i,e[2]=s*r+u*i,e[3]=l*r+f*i,e[4]=c*r-o*i,e[5]=h*r-a*i,e[6]=u*r-s*i,e[7]=f*r-l*i,e}function g(e,t){var n=t[0],i=t[1],r=t[2],o=t[4],a=t[5],s=t[6],l=t[8],c=t[9],h=t[10];return e[0]=Math.hypot(n,i,r),e[1]=Math.hypot(o,a,s),e[2]=Math.hypot(l,c,h),e}function m(e,t){var n=t[0],i=t[1],r=t[2],o=t[3],a=n+n,s=i+i,l=r+r,c=n*a,h=i*a,u=i*s,f=r*a,d=r*s,p=r*l,g=o*a,m=o*s,_=o*l;return e[0]=1-u-p,e[1]=h+_,e[2]=f-m,e[3]=0,e[4]=h-_,e[5]=1-c-p,e[6]=d+g,e[7]=0,e[8]=f+m,e[9]=d-g,e[10]=1-c-u,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function _(e,t,n,i,r,o,a){var s=1/(n-t),l=1/(r-i),c=1/(o-a);return e[0]=2*o*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*o*l,e[6]=0,e[7]=0,e[8]=(n+t)*s,e[9]=(r+i)*l,e[10]=(a+o)*c,e[11]=-1,e[12]=0,e[13]=0,e[14]=a*o*2*c,e[15]=0,e}var v=function(e,t,n,i,r){var o,a=1/Math.tan(t/2);return e[0]=a/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=r&&r!==1/0?(o=1/(i-r),e[10]=(r+i)*o,e[14]=2*r*i*o):(e[10]=-1,e[14]=-2*i),e},b=function(e,t,n,i,r,o,a){var s=1/(t-n),l=1/(i-r),c=1/(o-a);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+n)*s,e[13]=(r+i)*l,e[14]=(a+o)*c,e[15]=1,e};function y(e,t,n,o){var a,s,l,c,h,u,f,d,p,g,m=t[0],_=t[1],v=t[2],b=o[0],y=o[1],w=o[2],x=n[0],C=n[1],k=n[2];return Math.abs(m-x)<i.Ib&&Math.abs(_-C)<i.Ib&&Math.abs(v-k)<i.Ib?r(e):(f=m-x,d=_-C,p=v-k,a=y*(p*=g=1/Math.hypot(f,d,p))-w*(d*=g),s=w*(f*=g)-b*p,l=b*d-y*f,(g=Math.hypot(a,s,l))?(a*=g=1/g,s*=g,l*=g):(a=0,s=0,l=0),c=d*l-p*s,h=p*a-f*l,u=f*s-d*a,(g=Math.hypot(c,h,u))?(c*=g=1/g,h*=g,u*=g):(c=0,h=0,u=0),e[0]=a,e[1]=c,e[2]=f,e[3]=0,e[4]=s,e[5]=h,e[6]=d,e[7]=0,e[8]=l,e[9]=u,e[10]=p,e[11]=0,e[12]=-(a*m+s*_+l*v),e[13]=-(c*m+h*_+u*v),e[14]=-(f*m+d*_+p*v),e[15]=1,e)}},249:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DDBaseImplement=void 0,t.DDBaseImplement=class{constructor(){this._eventRegister={}}get disabled(){return this._disabled}on(e,t){this._eventRegister[e]=t}off(e){delete this._eventRegister[e]}enable(){this._disabled=!1}disable(){this._disabled=!0}destroy(){delete this._eventRegister}triggerEvent(e,t){if(!this.disabled&&this._eventRegister&&this._eventRegister[e])return this._eventRegister[e](t)}}},6529:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DDDraggable=void 0;const i=n(427),r=n(9284),o=n(249),a=n(168);class s extends o.DDBaseImplement{constructor(e,t={}){super(),this.el=e,this.option=t;let n=t.handle.substring(1);this.dragEl=e.classList.contains(n)?e:e.querySelector(t.handle)||e,this._mouseDown=this._mouseDown.bind(this),this._mouseMove=this._mouseMove.bind(this),this._mouseUp=this._mouseUp.bind(this),this.enable()}on(e,t){super.on(e,t)}off(e){super.off(e)}enable(){!1!==this.disabled&&(super.enable(),this.dragEl.addEventListener("mousedown",this._mouseDown),a.isTouch&&(this.dragEl.addEventListener("touchstart",a.touchstart),this.dragEl.addEventListener("pointerdown",a.pointerdown)),this.el.classList.remove("ui-draggable-disabled"),this.el.classList.add("ui-draggable"))}disable(e=!1){!0!==this.disabled&&(super.disable(),this.dragEl.removeEventListener("mousedown",this._mouseDown),a.isTouch&&(this.dragEl.removeEventListener("touchstart",a.touchstart),this.dragEl.removeEventListener("pointerdown",a.pointerdown)),this.el.classList.remove("ui-draggable"),e||this.el.classList.add("ui-draggable-disabled"))}destroy(){this.dragTimeout&&window.clearTimeout(this.dragTimeout),delete this.dragTimeout,this.dragging&&this._mouseUp(this.mouseDownEvent),this.disable(!0),delete this.el,delete this.helper,delete this.option,super.destroy()}updateOption(e){return Object.keys(e).forEach((t=>this.option[t]=e[t])),this}_mouseDown(e){if(i.DDManager.mouseHandled)return;if(0!==e.button)return!0;const t=e.target.nodeName.toLowerCase();return["input","textarea","button","select","option"].find((e=>e===t))||e.target.closest('[contenteditable="true"]')||(this.mouseDownEvent=e,delete this.dragging,delete i.DDManager.dragElement,delete i.DDManager.dropElement,document.addEventListener("mousemove",this._mouseMove,!0),document.addEventListener("mouseup",this._mouseUp,!0),a.isTouch&&(this.dragEl.addEventListener("touchmove",a.touchmove),this.dragEl.addEventListener("touchend",a.touchend)),e.preventDefault(),document.activeElement&&document.activeElement.blur(),i.DDManager.mouseHandled=!0),!0}_callDrag(e){if(!this.dragging)return;const t=r.Utils.initEvent(e,{target:this.el,type:"drag"});this.option.drag&&this.option.drag(t,this.ui()),this.triggerEvent("drag",t)}_mouseMove(e){var t;let n=this.mouseDownEvent;if(this.dragging)if(this._dragFollow(e),i.DDManager.pauseDrag){const t=Number.isInteger(i.DDManager.pauseDrag)?i.DDManager.pauseDrag:100;this.dragTimeout&&window.clearTimeout(this.dragTimeout),this.dragTimeout=window.setTimeout((()=>this._callDrag(e)),t)}else this._callDrag(e);else if(Math.abs(e.x-n.x)+Math.abs(e.y-n.y)>3){this.dragging=!0,i.DDManager.dragElement=this;let n=null===(t=this.el.gridstackNode)||void 0===t?void 0:t.grid;n?i.DDManager.dropElement=n.el.ddElement.ddDroppable:delete i.DDManager.dropElement,this.helper=this._createHelper(e),this._setupHelperContainmentStyle(),this.dragOffset=this._getDragOffset(e,this.el,this.helperContainment);const o=r.Utils.initEvent(e,{target:this.el,type:"dragstart"});this._setupHelperStyle(e),this.option.start&&this.option.start(o,this.ui()),this.triggerEvent("dragstart",o)}return e.preventDefault(),!0}_mouseUp(e){var t;if(document.removeEventListener("mousemove",this._mouseMove,!0),document.removeEventListener("mouseup",this._mouseUp,!0),a.isTouch&&(this.dragEl.removeEventListener("touchmove",a.touchmove,!0),this.dragEl.removeEventListener("touchend",a.touchend,!0)),this.dragging){delete this.dragging,(null===(t=i.DDManager.dropElement)||void 0===t?void 0:t.el)===this.el.parentElement&&delete i.DDManager.dropElement,this.helperContainment.style.position=this.parentOriginStylePosition||null,this.helper===this.el?this._removeHelperStyle():this.helper.remove();const n=r.Utils.initEvent(e,{target:this.el,type:"dragstop"});this.option.stop&&this.option.stop(n),this.triggerEvent("dragstop",n),i.DDManager.dropElement&&i.DDManager.dropElement.drop(e)}delete this.helper,delete this.mouseDownEvent,delete i.DDManager.dragElement,delete i.DDManager.dropElement,delete i.DDManager.mouseHandled,e.preventDefault()}_createHelper(e){let t=this.el;return"function"==typeof this.option.helper?t=this.option.helper(e):"clone"===this.option.helper&&(t=r.Utils.cloneNode(this.el)),document.body.contains(t)||r.Utils.appendTo(t,"parent"===this.option.appendTo?this.el.parentNode:this.option.appendTo),t===this.el&&(this.dragElementOriginStyle=s.originStyleProp.map((e=>this.el.style[e]))),t}_setupHelperStyle(e){this.helper.classList.add("ui-draggable-dragging");const t=this.helper.style;return t.pointerEvents="none",t["min-width"]=0,t.width=this.dragOffset.width+"px",t.height=this.dragOffset.height+"px",t.willChange="left, top",t.position="fixed",this._dragFollow(e),t.transition="none",setTimeout((()=>{this.helper&&(t.transition=null)}),0),this}_removeHelperStyle(){var e;this.helper.classList.remove("ui-draggable-dragging");let t=null===(e=this.helper)||void 0===e?void 0:e.gridstackNode;if(this.dragElementOriginStyle&&(!t||!t._isAboutToRemove)){let e=this.helper,t=this.dragElementOriginStyle.transition||null;e.style.transition=this.dragElementOriginStyle.transition="none",s.originStyleProp.forEach((t=>e.style[t]=this.dragElementOriginStyle[t]||null)),setTimeout((()=>e.style.transition=t),50)}return delete this.dragElementOriginStyle,this}_dragFollow(e){const t=this.helper.style,n=this.dragOffset;t.left=e.clientX+n.offsetLeft-0+"px",t.top=e.clientY+n.offsetTop-0+"px"}_setupHelperContainmentStyle(){return this.helperContainment=this.helper.parentElement,"fixed"!==this.helper.style.position&&(this.parentOriginStylePosition=this.helperContainment.style.position,window.getComputedStyle(this.helperContainment).position.match(/static/)&&(this.helperContainment.style.position="relative")),this}_getDragOffset(e,t,n){let i=0,o=0;if(n){const e=document.createElement("div");r.Utils.addElStyles(e,{opacity:"0",position:"fixed",top:"0px",left:"0px",width:"1px",height:"1px",zIndex:"-999999"}),n.appendChild(e);const t=e.getBoundingClientRect();n.removeChild(e),i=t.left,o=t.top}const a=t.getBoundingClientRect();return{left:a.left,top:a.top,offsetLeft:-e.clientX+a.left-i,offsetTop:-e.clientY+a.top-o,width:a.width,height:a.height}}ui(){const e=this.el.parentElement.getBoundingClientRect(),t=this.helper.getBoundingClientRect();return{position:{top:t.top-e.top,left:t.left-e.left}}}}t.DDDraggable=s,s.originStyleProp=["transition","pointerEvents","position","left","top"]},2514:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DDDroppable=void 0;const i=n(427),r=n(249),o=n(9284),a=n(168);class s extends r.DDBaseImplement{constructor(e,t={}){super(),this.el=e,this.option=t,this._mouseEnter=this._mouseEnter.bind(this),this._mouseLeave=this._mouseLeave.bind(this),this.enable(),this._setupAccept()}on(e,t){super.on(e,t)}off(e){super.off(e)}enable(){!1!==this.disabled&&(super.enable(),this.el.classList.add("ui-droppable"),this.el.classList.remove("ui-droppable-disabled"),this.el.addEventListener("mouseenter",this._mouseEnter),this.el.addEventListener("mouseleave",this._mouseLeave),a.isTouch&&(this.el.addEventListener("pointerenter",a.pointerenter),this.el.addEventListener("pointerleave",a.pointerleave)))}disable(e=!1){!0!==this.disabled&&(super.disable(),this.el.classList.remove("ui-droppable"),e||this.el.classList.add("ui-droppable-disabled"),this.el.removeEventListener("mouseenter",this._mouseEnter),this.el.removeEventListener("mouseleave",this._mouseLeave),a.isTouch&&(this.el.removeEventListener("pointerenter",a.pointerenter),this.el.removeEventListener("pointerleave",a.pointerleave)))}destroy(){this.disable(!0),this.el.classList.remove("ui-droppable"),this.el.classList.remove("ui-droppable-disabled"),super.destroy()}updateOption(e){return Object.keys(e).forEach((t=>this.option[t]=e[t])),this._setupAccept(),this}_mouseEnter(e){if(!i.DDManager.dragElement)return;if(!this._canDrop(i.DDManager.dragElement.el))return;e.preventDefault(),e.stopPropagation(),i.DDManager.dropElement&&i.DDManager.dropElement!==this&&i.DDManager.dropElement._mouseLeave(e),i.DDManager.dropElement=this;const t=o.Utils.initEvent(e,{target:this.el,type:"dropover"});this.option.over&&this.option.over(t,this._ui(i.DDManager.dragElement)),this.triggerEvent("dropover",t),this.el.classList.add("ui-droppable-over")}_mouseLeave(e){var t;if(!i.DDManager.dragElement||i.DDManager.dropElement!==this)return;e.preventDefault(),e.stopPropagation();const n=o.Utils.initEvent(e,{target:this.el,type:"dropout"});if(this.option.out&&this.option.out(n,this._ui(i.DDManager.dragElement)),this.triggerEvent("dropout",n),i.DDManager.dropElement===this){let n;delete i.DDManager.dropElement;let r=this.el.parentElement;for(;!n&&r;)n=null===(t=r.ddElement)||void 0===t?void 0:t.ddDroppable,r=r.parentElement;n&&n._mouseEnter(e)}}drop(e){e.preventDefault();const t=o.Utils.initEvent(e,{target:this.el,type:"drop"});this.option.drop&&this.option.drop(t,this._ui(i.DDManager.dragElement)),this.triggerEvent("drop",t)}_canDrop(e){return e&&(!this.accept||this.accept(e))}_setupAccept(){return this.option.accept?("string"==typeof this.option.accept?this.accept=e=>e.matches(this.option.accept):this.accept=this.option.accept,this):this}_ui(e){return Object.assign({draggable:e.el},e.ui())}}t.DDDroppable=s},4474:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DDElement=void 0;const i=n(3945),r=n(6529),o=n(2514);class a{constructor(e){this.el=e}static init(e){return e.ddElement||(e.ddElement=new a(e)),e.ddElement}on(e,t){return this.ddDraggable&&["drag","dragstart","dragstop"].indexOf(e)>-1?this.ddDraggable.on(e,t):this.ddDroppable&&["drop","dropover","dropout"].indexOf(e)>-1?this.ddDroppable.on(e,t):this.ddResizable&&["resizestart","resize","resizestop"].indexOf(e)>-1&&this.ddResizable.on(e,t),this}off(e){return this.ddDraggable&&["drag","dragstart","dragstop"].indexOf(e)>-1?this.ddDraggable.off(e):this.ddDroppable&&["drop","dropover","dropout"].indexOf(e)>-1?this.ddDroppable.off(e):this.ddResizable&&["resizestart","resize","resizestop"].indexOf(e)>-1&&this.ddResizable.off(e),this}setupDraggable(e){return this.ddDraggable?this.ddDraggable.updateOption(e):this.ddDraggable=new r.DDDraggable(this.el,e),this}cleanDraggable(){return this.ddDraggable&&(this.ddDraggable.destroy(),delete this.ddDraggable),this}setupResizable(e){return this.ddResizable?this.ddResizable.updateOption(e):this.ddResizable=new i.DDResizable(this.el,e),this}cleanResizable(){return this.ddResizable&&(this.ddResizable.destroy(),delete this.ddResizable),this}setupDroppable(e){return this.ddDroppable?this.ddDroppable.updateOption(e):this.ddDroppable=new o.DDDroppable(this.el,e),this}cleanDroppable(){return this.ddDroppable&&(this.ddDroppable.destroy(),delete this.ddDroppable),this}}t.DDElement=a},6470:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DDGridStack=void 0;const i=n(7523),r=n(5929),o=n(9284),a=n(427),s=n(4474);class l{static get(){return c}resizable(e,t,n,i){return this._getDDElements(e).forEach((e=>{if("disable"===t||"enable"===t)e.ddResizable&&e.ddResizable[t]();else if("destroy"===t)e.ddResizable&&e.cleanResizable();else if("option"===t)e.setupResizable({[n]:i});else{const n=e.el.gridstackNode.grid;let i=e.el.getAttribute("gs-resize-handles")?e.el.getAttribute("gs-resize-handles"):n.opts.resizable.handles,r=!n.opts.alwaysShowResizeHandle;e.setupResizable(Object.assign(Object.assign(Object.assign({},n.opts.resizable),{handles:i,autoHide:r}),{start:t.start,stop:t.stop,resize:t.resize}))}})),this}draggable(e,t,n,i){return this._getDDElements(e).forEach((e=>{if("disable"===t||"enable"===t)e.ddDraggable&&e.ddDraggable[t]();else if("destroy"===t)e.ddDraggable&&e.cleanDraggable();else if("option"===t)e.setupDraggable({[n]:i});else{const n=e.el.gridstackNode.grid;e.setupDraggable(Object.assign(Object.assign({},n.opts.draggable),{start:t.start,stop:t.stop,drag:t.drag}))}})),this}dragIn(e,t){return this._getDDElements(e).forEach((e=>e.setupDraggable(t))),this}droppable(e,t,n,i){return"function"!=typeof t.accept||t._accept||(t._accept=t.accept,t.accept=e=>t._accept(e)),this._getDDElements(e).forEach((e=>{"disable"===t||"enable"===t?e.ddDroppable&&e.ddDroppable[t]():"destroy"===t?e.ddDroppable&&e.cleanDroppable():"option"===t?e.setupDroppable({[n]:i}):e.setupDroppable(t)})),this}isDroppable(e){return!(!(e&&e.ddElement&&e.ddElement.ddDroppable)||e.ddElement.ddDroppable.disabled)}isDraggable(e){return!(!(e&&e.ddElement&&e.ddElement.ddDraggable)||e.ddElement.ddDraggable.disabled)}isResizable(e){return!(!(e&&e.ddElement&&e.ddElement.ddResizable)||e.ddElement.ddResizable.disabled)}on(e,t,n){return this._getDDElements(e).forEach((e=>e.on(t,(e=>{n(e,a.DDManager.dragElement?a.DDManager.dragElement.el:e.target,a.DDManager.dragElement?a.DDManager.dragElement.helper:null)})))),this}off(e,t){return this._getDDElements(e).forEach((e=>e.off(t))),this}_getDDElements(e,t=!0){let n=o.Utils.getElements(e);if(!n.length)return[];let i=n.map((e=>e.ddElement||(t?s.DDElement.init(e):null)));return t||i.filter((e=>e)),i}}t.DDGridStack=l;const c=new l;function h(e,t){let n=e?e.gridstackNode:void 0;n&&n.grid&&(t?n._isAboutToRemove=!0:delete n._isAboutToRemove,t?e.classList.add("grid-stack-item-removing"):e.classList.remove("grid-stack-item-removing"))}r.GridStack.prototype._setupAcceptWidget=function(){if(this.opts.staticGrid||!this.opts.acceptWidgets&&!this.opts.removable)return c.droppable(this.el,"destroy"),this;let e,t,n=(n,i,r)=>{let a=i.gridstackNode;if(!a)return;r=r||i;let s=this.el.getBoundingClientRect(),{top:l,left:h}=r.getBoundingClientRect();h-=s.left,l-=s.top;let u={position:{top:l,left:h}};if(a._temporaryRemoved){if(a.x=Math.max(0,Math.round(h/t)),a.y=Math.max(0,Math.round(l/e)),delete a.autoPosition,this.engine.nodeBoundFix(a),!this.engine.willItFit(a)){if(a.autoPosition=!0,!this.engine.willItFit(a))return void c.off(i,"drag");a._willFitPos&&(o.Utils.copyPos(a,a._willFitPos),delete a._willFitPos)}this._onStartMoving(r,n,u,a,t,e)}else this._dragOrResize(r,n,u,a,t,e)};return c.droppable(this.el,{accept:e=>{let t=e.gridstackNode;if((null==t?void 0:t.grid)===this)return!0;if(!this.opts.acceptWidgets)return!1;let n=!0;if("function"==typeof this.opts.acceptWidgets)n=this.opts.acceptWidgets(e);else{let t=!0===this.opts.acceptWidgets?".grid-stack-item":this.opts.acceptWidgets;n=e.matches(t)}if(n&&t&&this.opts.maxRow){let e={w:t.w,h:t.h,minW:t.minW,minH:t.minH};n=this.engine.willItFit(e)}return n}}).on(this.el,"dropover",((i,r,o)=>{let a=r.gridstackNode;if((null==a?void 0:a.grid)===this&&!a._temporaryRemoved)return!1;(null==a?void 0:a.grid)&&a.grid!==this&&!a._temporaryRemoved&&a.grid._leave(r,o),t=this.cellWidth(),e=this.getCellHeight(!0),a||(a=this._readAttr(r)),a.grid||(a._isExternal=!0,r.gridstackNode=a),o=o||r;let s=a.w||Math.round(o.offsetWidth/t)||1,l=a.h||Math.round(o.offsetHeight/e)||1;return a.grid&&a.grid!==this?(r._gridstackNodeOrig||(r._gridstackNodeOrig=a),r.gridstackNode=a=Object.assign(Object.assign({},a),{w:s,h:l,grid:this}),this.engine.cleanupNode(a).nodeBoundFix(a),a._initDD=a._isExternal=a._temporaryRemoved=!0):(a.w=s,a.h=l,a._temporaryRemoved=!0),h(a.el,!1),c.on(r,"drag",n),n(i,r,o),!1})).on(this.el,"dropout",((e,t,n)=>{let i=t.gridstackNode;return!!i&&(i.grid&&i.grid!==this||(this._leave(t,n),this._isTemp&&this.removeAsSubGrid(i)),!1)})).on(this.el,"drop",((e,t,n)=>{var i,r;let a=t.gridstackNode;if((null==a?void 0:a.grid)===this&&!a._isExternal)return!1;let s=!!this.placeholder.parentElement;this.placeholder.remove();let l=t._gridstackNodeOrig;if(delete t._gridstackNodeOrig,s&&(null==l?void 0:l.grid)&&l.grid!==this){let e=l.grid;e.engine.removedNodes.push(l),e._triggerRemoveEvent(),e.parentGridItem&&!e.engine.nodes.length&&e.opts.subGridDynamic&&e.removeAsSubGrid()}if(!a)return!1;if(s&&(this.engine.cleanupNode(a),a.grid=this),c.off(t,"drag"),n!==t?(n.remove(),t.gridstackNode=l,s&&(t=t.cloneNode(!0))):(t.remove(),this._removeDD(t)),!s)return!1;t.gridstackNode=a,a.el=t;let h=null===(r=null===(i=a.subGrid)||void 0===i?void 0:i.el)||void 0===r?void 0:r.gridstack;return o.Utils.copyPos(a,this._readAttr(this.placeholder)),o.Utils.removePositioningStyles(t),this._writeAttr(t,a),this.el.appendChild(t),h&&(h.parentGridItem=a,h.opts.styleInHead||h._updateStyles(!0)),this._updateContainerHeight(),this.engine.addedNodes.push(a),this._triggerAddEvent(),this._triggerChangeEvent(),this.engine.endUpdate(),this._gsEventHandler.dropped&&this._gsEventHandler.dropped(Object.assign(Object.assign({},e),{type:"dropped"}),l&&l.grid?l:void 0,a),window.setTimeout((()=>{a.el&&a.el.parentElement?this._prepareDragDropByNode(a):this.engine.removeNode(a),delete a.grid._isTemp})),!1})),this},r.GridStack.prototype._setupRemoveDrop=function(){if(!this.opts.staticGrid&&"string"==typeof this.opts.removable){let e=document.querySelector(this.opts.removable);if(!e)return this;c.isDroppable(e)||c.droppable(e,this.opts.removableOptions).on(e,"dropover",((e,t)=>h(t,!0))).on(e,"dropout",((e,t)=>h(t,!1)))}return this},r.GridStack.setupDragIn=function(e,t){void 0!==(null==t?void 0:t.pause)&&(a.DDManager.pauseDrag=t.pause),"string"==typeof e&&(t=Object.assign(Object.assign({},i.dragInDefaultOptions),t||{}),o.Utils.getElements(e).forEach((e=>{c.isDraggable(e)||c.dragIn(e,t)})))},r.GridStack.prototype._prepareDragDropByNode=function(e){let t=e.el;const n=e.noMove||this.opts.disableDrag,i=e.noResize||this.opts.disableResize;if(this.opts.staticGrid||n&&i)return e._initDD&&(this._removeDD(t),delete e._initDD),t.classList.add("ui-draggable-disabled","ui-resizable-disabled"),this;if(!e._initDD){let n,i,r=(r,o)=>{this._gsEventHandler[r.type]&&this._gsEventHandler[r.type](r,r.target),n=this.cellWidth(),i=this.getCellHeight(!0),this._onStartMoving(t,r,o,e,n,i)},a=(r,o)=>{this._dragOrResize(t,r,o,e,n,i)},s=n=>{this.placeholder.remove(),delete e._moving,delete e._event,delete e._lastTried;let i=n.target;if(i.gridstackNode&&i.gridstackNode.grid===this){if(e.el=i,e._isAboutToRemove){let r=t.gridstackNode.grid;r._gsEventHandler[n.type]&&r._gsEventHandler[n.type](n,i),this._removeDD(t),r.engine.removedNodes.push(e),r._triggerRemoveEvent(),delete t.gridstackNode,delete e.el,t.remove()}else o.Utils.removePositioningStyles(i),e._temporaryRemoved?(o.Utils.copyPos(e,e._orig),this._writePosAttr(i,e),this.engine.addNode(e)):this._writePosAttr(i,e),this._gsEventHandler[n.type]&&this._gsEventHandler[n.type](n,i);this._extraDragRow=0,this._updateContainerHeight(),this._triggerChangeEvent(),this.engine.endUpdate()}};c.draggable(t,{start:r,stop:s,drag:a}).resizable(t,{start:r,stop:s,resize:a}),e._initDD=!0}return c.draggable(t,n?"disable":"enable").resizable(t,i?"disable":"enable"),this},r.GridStack.prototype._onStartMoving=function(e,t,n,i,r,o){this.engine.cleanNodes().beginUpdate(i),this._writePosAttr(this.placeholder,i),this.el.appendChild(this.placeholder),i.el=this.placeholder,i._lastUiPosition=n.position,i._prevYPix=n.position.top,i._moving="dragstart"===t.type,delete i._lastTried,"dropover"===t.type&&i._temporaryRemoved&&(this.engine.addNode(i),i._moving=!0),this.engine.cacheRects(r,o,this.opts.marginTop,this.opts.marginRight,this.opts.marginBottom,this.opts.marginLeft),"resizestart"===t.type&&(c.resizable(e,"option","minWidth",r*(i.minW||1)).resizable(e,"option","minHeight",o*(i.minH||1)),i.maxW&&c.resizable(e,"option","maxWidth",r*i.maxW),i.maxH&&c.resizable(e,"option","maxHeight",o*i.maxH))},r.GridStack.prototype._leave=function(e,t){let n=e.gridstackNode;n&&(c.off(e,"drag"),n._temporaryRemoved||(n._temporaryRemoved=!0,this.engine.removeNode(n),n.el=n._isExternal&&t?t:e,!0===this.opts.removable&&h(e,!0),e._gridstackNodeOrig?(e.gridstackNode=e._gridstackNodeOrig,delete e._gridstackNodeOrig):n._isExternal&&(delete n.el,delete e.gridstackNode,this.engine.restoreInitial())))},r.GridStack.prototype._dragOrResize=function(e,t,n,i,r,a){let s,l=Object.assign({},i._orig),c=this.opts.marginLeft,h=this.opts.marginRight,u=this.opts.marginTop,f=this.opts.marginBottom,d=Math.round(.1*a),p=Math.round(.1*r);if(c=Math.min(c,p),h=Math.min(h,p),u=Math.min(u,d),f=Math.min(f,d),"drag"===t.type){if(i._temporaryRemoved)return;let t=n.position.top-i._prevYPix;i._prevYPix=n.position.top,o.Utils.updateScrollPosition(e,n.position,t);let s=n.position.left+(n.position.left>i._lastUiPosition.left?-h:c),d=n.position.top+(n.position.top>i._lastUiPosition.top?-f:u);l.x=Math.round(s/r),l.y=Math.round(d/a);let p=this._extraDragRow;if(this.engine.collide(i,l)){let e=this.getRow(),t=Math.max(0,l.y+i.h-e);this.opts.maxRow&&e+t>this.opts.maxRow&&(t=Math.max(0,this.opts.maxRow-e)),this._extraDragRow=t}else this._extraDragRow=0;if(this._extraDragRow!==p&&this._updateContainerHeight(),i.x===l.x&&i.y===l.y)return}else if("resize"===t.type){if(l.x<0)return;if(o.Utils.updateScrollResize(t,e,a),l.w=Math.round((n.size.width-c)/r),l.h=Math.round((n.size.height-u)/a),i.w===l.w&&i.h===l.h)return;if(i._lastTried&&i._lastTried.w===l.w&&i._lastTried.h===l.h)return;let h=n.position.left+c,f=n.position.top+u;l.x=Math.round(h/r),l.y=Math.round(f/a),s=!0}i._event=t,i._lastTried=l;let g={x:n.position.left+c,y:n.position.top+u,w:(n.size?n.size.width:i.w*r)-c-h,h:(n.size?n.size.height:i.h*a)-u-f};if(this.engine.moveNodeCheck(i,Object.assign(Object.assign({},l),{cellWidth:r,cellHeight:a,rect:g,resizing:s}))){i._lastUiPosition=n.position,this.engine.cacheRects(r,a,u,h,f,c),delete i._skipDown,s&&i.subGrid&&i.subGrid.onParentResize(),this._extraDragRow=0,this._updateContainerHeight();let e=t.target;this._writePosAttr(e,i),this._gsEventHandler[t.type]&&this._gsEventHandler[t.type](t,e)}},r.GridStack.prototype.movable=function(e,t){return this.opts.staticGrid||r.GridStack.getElements(e).forEach((e=>{let n=e.gridstackNode;n&&(t?delete n.noMove:n.noMove=!0,this._prepareDragDropByNode(n))})),this},r.GridStack.prototype.resizable=function(e,t){return this.opts.staticGrid||r.GridStack.getElements(e).forEach((e=>{let n=e.gridstackNode;n&&(t?delete n.noResize:n.noResize=!0,this._prepareDragDropByNode(n))})),this},r.GridStack.prototype.disable=function(){if(!this.opts.staticGrid)return this.enableMove(!1),this.enableResize(!1),this._triggerEvent("disable"),this},r.GridStack.prototype.enable=function(){if(!this.opts.staticGrid)return this.enableMove(!0),this.enableResize(!0),this._triggerEvent("enable"),this},r.GridStack.prototype.enableMove=function(e){return this.opts.staticGrid||(this.opts.disableDrag=!e,this.engine.nodes.forEach((t=>this.movable(t.el,e)))),this},r.GridStack.prototype.enableResize=function(e){return this.opts.staticGrid||(this.opts.disableResize=!e,this.engine.nodes.forEach((t=>this.resizable(t.el,e)))),this},r.GridStack.prototype._removeDD=function(e){return c.draggable(e,"destroy").resizable(e,"destroy"),e.gridstackNode&&delete e.gridstackNode._initDD,delete e.ddElement,this}},427:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DDManager=void 0,t.DDManager=class{}},4952:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DDResizableHandle=void 0;const i=n(168);class r{constructor(e,t,n){this.moving=!1,this.host=e,this.dir=t,this.option=n,this._mouseDown=this._mouseDown.bind(this),this._mouseMove=this._mouseMove.bind(this),this._mouseUp=this._mouseUp.bind(this),this._init()}_init(){const e=document.createElement("div");return e.classList.add("ui-resizable-handle"),e.classList.add(`${r.prefix}${this.dir}`),e.style.zIndex="100",e.style.userSelect="none",this.el=e,this.host.appendChild(this.el),this.el.addEventListener("mousedown",this._mouseDown),i.isTouch&&(this.el.addEventListener("touchstart",i.touchstart),this.el.addEventListener("pointerdown",i.pointerdown)),this}destroy(){return this.moving&&this._mouseUp(this.mouseDownEvent),this.el.removeEventListener("mousedown",this._mouseDown),i.isTouch&&(this.el.removeEventListener("touchstart",i.touchstart),this.el.removeEventListener("pointerdown",i.pointerdown)),this.host.removeChild(this.el),delete this.el,delete this.host,this}_mouseDown(e){this.mouseDownEvent=e,document.addEventListener("mousemove",this._mouseMove,!0),document.addEventListener("mouseup",this._mouseUp,!0),i.isTouch&&(this.el.addEventListener("touchmove",i.touchmove),this.el.addEventListener("touchend",i.touchend)),e.stopPropagation(),e.preventDefault()}_mouseMove(e){let t=this.mouseDownEvent;this.moving?this._triggerEvent("move",e):Math.abs(e.x-t.x)+Math.abs(e.y-t.y)>2&&(this.moving=!0,this._triggerEvent("start",this.mouseDownEvent),this._triggerEvent("move",e)),e.stopPropagation(),e.preventDefault()}_mouseUp(e){this.moving&&this._triggerEvent("stop",e),document.removeEventListener("mousemove",this._mouseMove,!0),document.removeEventListener("mouseup",this._mouseUp,!0),i.isTouch&&(this.el.removeEventListener("touchmove",i.touchmove),this.el.removeEventListener("touchend",i.touchend)),delete this.moving,delete this.mouseDownEvent,e.stopPropagation(),e.preventDefault()}_triggerEvent(e,t){return this.option[e]&&this.option[e](t),this}}t.DDResizableHandle=r,r.prefix="ui-resizable-"},3945:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DDResizable=void 0;const i=n(4952),r=n(249),o=n(9284),a=n(427);class s extends r.DDBaseImplement{constructor(e,t={}){super(),this._ui=()=>{const e=this.el.parentElement.getBoundingClientRect(),t={width:this.originalRect.width,height:this.originalRect.height+this.scrolled,left:this.originalRect.left,top:this.originalRect.top-this.scrolled},n=this.temporalRect||t;return{position:{left:n.left-e.left,top:n.top-e.top},size:{width:n.width,height:n.height}}},this.el=e,this.option=t,this._mouseOver=this._mouseOver.bind(this),this._mouseOut=this._mouseOut.bind(this),this.enable(),this._setupAutoHide(this.option.autoHide),this._setupHandlers()}on(e,t){super.on(e,t)}off(e){super.off(e)}enable(){super.enable(),this.el.classList.add("ui-resizable"),this.el.classList.remove("ui-resizable-disabled"),this._setupAutoHide(this.option.autoHide)}disable(){super.disable(),this.el.classList.add("ui-resizable-disabled"),this.el.classList.remove("ui-resizable"),this._setupAutoHide(!1)}destroy(){this._removeHandlers(),this._setupAutoHide(!1),this.el.classList.remove("ui-resizable"),delete this.el,super.destroy()}updateOption(e){let t=e.handles&&e.handles!==this.option.handles,n=e.autoHide&&e.autoHide!==this.option.autoHide;return Object.keys(e).forEach((t=>this.option[t]=e[t])),t&&(this._removeHandlers(),this._setupHandlers()),n&&this._setupAutoHide(this.option.autoHide),this}_setupAutoHide(e){return e?(this.el.classList.add("ui-resizable-autohide"),this.el.addEventListener("mouseover",this._mouseOver),this.el.addEventListener("mouseout",this._mouseOut)):(this.el.classList.remove("ui-resizable-autohide"),this.el.removeEventListener("mouseover",this._mouseOver),this.el.removeEventListener("mouseout",this._mouseOut),a.DDManager.overResizeElement===this&&delete a.DDManager.overResizeElement),this}_mouseOver(e){a.DDManager.overResizeElement||a.DDManager.dragElement||(a.DDManager.overResizeElement=this,this.el.classList.remove("ui-resizable-autohide"))}_mouseOut(e){a.DDManager.overResizeElement===this&&(delete a.DDManager.overResizeElement,this.el.classList.add("ui-resizable-autohide"))}_setupHandlers(){let e=this.option.handles||"e,s,se";return"all"===e&&(e="n,e,s,w,se,sw,ne,nw"),this.handlers=e.split(",").map((e=>e.trim())).map((e=>new i.DDResizableHandle(this.el,e,{start:e=>{this._resizeStart(e)},stop:e=>{this._resizeStop(e)},move:t=>{this._resizing(t,e)}}))),this}_resizeStart(e){this.originalRect=this.el.getBoundingClientRect(),this.scrollEl=o.Utils.getScrollElement(this.el),this.scrollY=this.scrollEl.scrollTop,this.scrolled=0,this.startEvent=e,this._setupHelper(),this._applyChange();const t=o.Utils.initEvent(e,{type:"resizestart",target:this.el});return this.option.start&&this.option.start(t,this._ui()),this.el.classList.add("ui-resizable-resizing"),this.triggerEvent("resizestart",t),this}_resizing(e,t){this.scrolled=this.scrollEl.scrollTop-this.scrollY,this.temporalRect=this._getChange(e,t),this._applyChange();const n=o.Utils.initEvent(e,{type:"resize",target:this.el});return this.option.resize&&this.option.resize(n,this._ui()),this.triggerEvent("resize",n),this}_resizeStop(e){const t=o.Utils.initEvent(e,{type:"resizestop",target:this.el});return this.option.stop&&this.option.stop(t),this.el.classList.remove("ui-resizable-resizing"),this.triggerEvent("resizestop",t),this._cleanHelper(),delete this.startEvent,delete this.originalRect,delete this.temporalRect,delete this.scrollY,delete this.scrolled,this}_setupHelper(){return this.elOriginStyleVal=s._originStyleProp.map((e=>this.el.style[e])),this.parentOriginStylePosition=this.el.parentElement.style.position,window.getComputedStyle(this.el.parentElement).position.match(/static/)&&(this.el.parentElement.style.position="relative"),this.el.style.position="absolute",this.el.style.opacity="0.8",this}_cleanHelper(){return s._originStyleProp.forEach(((e,t)=>{this.el.style[e]=this.elOriginStyleVal[t]||null})),this.el.parentElement.style.position=this.parentOriginStylePosition||null,this}_getChange(e,t){const n=this.startEvent,i={width:this.originalRect.width,height:this.originalRect.height+this.scrolled,left:this.originalRect.left,top:this.originalRect.top-this.scrolled},r=e.clientX-n.clientX,o=e.clientY-n.clientY;t.indexOf("e")>-1?i.width+=r:t.indexOf("w")>-1&&(i.width-=r,i.left+=r),t.indexOf("s")>-1?i.height+=o:t.indexOf("n")>-1&&(i.height-=o,i.top+=o);const a=this._constrainSize(i.width,i.height);return Math.round(i.width)!==Math.round(a.width)&&(t.indexOf("w")>-1&&(i.left+=i.width-a.width),i.width=a.width),Math.round(i.height)!==Math.round(a.height)&&(t.indexOf("n")>-1&&(i.top+=i.height-a.height),i.height=a.height),i}_constrainSize(e,t){const n=this.option.maxWidth||Number.MAX_SAFE_INTEGER,i=this.option.minWidth||e,r=this.option.maxHeight||Number.MAX_SAFE_INTEGER,o=this.option.minHeight||t;return{width:Math.min(n,Math.max(i,e)),height:Math.min(r,Math.max(o,t))}}_applyChange(){let e={left:0,top:0,width:0,height:0};if("absolute"===this.el.style.position){const t=this.el.parentElement,{left:n,top:i}=t.getBoundingClientRect();e={left:n,top:i,width:0,height:0}}return this.temporalRect?(Object.keys(this.temporalRect).forEach((t=>{const n=this.temporalRect[t];this.el.style[t]=n-e[t]+"px"})),this):this}_removeHandlers(){return this.handlers.forEach((e=>e.destroy())),delete this.handlers,this}}t.DDResizable=s,s._originStyleProp=["width","height","position","left","top","opacity","zIndex"]},168:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pointerleave=t.pointerenter=t.pointerdown=t.touchend=t.touchmove=t.touchstart=t.isTouch=void 0;const i=n(427);t.isTouch="undefined"!=typeof window&&"undefined"!=typeof document&&("ontouchstart"in document||"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0);class r{}function o(e,t){if(e.touches.length>1)return;e.cancelable&&e.preventDefault();const n=e.changedTouches[0],i=document.createEvent("MouseEvents");i.initMouseEvent(t,!0,!0,window,1,n.screenX,n.screenY,n.clientX,n.clientY,!1,!1,!1,!1,0,null),e.target.dispatchEvent(i)}function a(e,t){e.cancelable&&e.preventDefault();const n=document.createEvent("MouseEvents");n.initMouseEvent(t,!0,!0,window,1,e.screenX,e.screenY,e.clientX,e.clientY,!1,!1,!1,!1,0,null),e.target.dispatchEvent(n)}t.touchstart=function(e){r.touchHandled||(r.touchHandled=!0,o(e,"mousedown"))},t.touchmove=function(e){r.touchHandled&&o(e,"mousemove")},t.touchend=function(e){if(!r.touchHandled)return;r.pointerLeaveTimeout&&(window.clearTimeout(r.pointerLeaveTimeout),delete r.pointerLeaveTimeout);const t=!!i.DDManager.dragElement;o(e,"mouseup"),t||o(e,"click"),r.touchHandled=!1},t.pointerdown=function(e){e.target.releasePointerCapture(e.pointerId)},t.pointerenter=function(e){i.DDManager.dragElement&&a(e,"mouseenter")},t.pointerleave=function(e){i.DDManager.dragElement&&(r.pointerLeaveTimeout=window.setTimeout((()=>{delete r.pointerLeaveTimeout,a(e,"mouseleave")}),10))}},6935:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GridStackEngine=void 0;const i=n(9284);class r{constructor(e={}){this.addedNodes=[],this.removedNodes=[],this.column=e.column||12,this.maxRow=e.maxRow,this._float=e.float,this.nodes=e.nodes||[],this.onChange=e.onChange}batchUpdate(e=!0){return!!this.batchMode===e||(this.batchMode=e,e?(this._prevFloat=this._float,this._float=!0,this.saveInitial()):(this._float=this._prevFloat,delete this._prevFloat,this._packNodes()._notify())),this}_useEntireRowArea(e,t){return!this.float&&!this._hasLocked&&(!e._moving||e._skipDown||t.y<=e.y)}_fixCollisions(e,t=e,n,r={}){if(this.sortNodes(-1),!(n=n||this.collide(e,t)))return!1;if(e._moving&&!r.nested&&!this.float&&this.swap(e,n))return!0;let o=t;this._useEntireRowArea(e,t)&&(o={x:0,w:this.column,y:t.y,h:t.h},n=this.collide(e,o,r.skip));let a=!1,s={nested:!0,pack:!1};for(;n=n||this.collide(e,o,r.skip);){let o;if(n.locked||e._moving&&!e._skipDown&&t.y>e.y&&!this.float&&(!this.collide(n,Object.assign(Object.assign({},n),{y:e.y}),e)||!this.collide(n,Object.assign(Object.assign({},n),{y:t.y-n.h}),e))?(e._skipDown=e._skipDown||t.y>e.y,o=this.moveNode(e,Object.assign(Object.assign(Object.assign({},t),{y:n.y+n.h}),s)),n.locked&&o?i.Utils.copyPos(t,e):!n.locked&&o&&r.pack&&(this._packNodes(),t.y=n.y+n.h,i.Utils.copyPos(e,t)),a=a||o):o=this.moveNode(n,Object.assign(Object.assign(Object.assign({},n),{y:t.y+t.h,skip:e}),s)),!o)return a;n=void 0}return a}collide(e,t=e,n){return this.nodes.find((r=>r!==e&&r!==n&&i.Utils.isIntercepted(r,t)))}collideAll(e,t=e,n){return this.nodes.filter((r=>r!==e&&r!==n&&i.Utils.isIntercepted(r,t)))}directionCollideCoverage(e,t,n){if(!t.rect||!e._rect)return;let i,r=e._rect,o=Object.assign({},t.rect);return o.y>r.y?(o.h+=o.y-r.y,o.y=r.y):o.h+=r.y-o.y,o.x>r.x?(o.w+=o.x-r.x,o.x=r.x):o.w+=r.x-o.x,n.forEach((e=>{if(e.locked||!e._rect)return;let t=e._rect,n=Number.MAX_VALUE,a=Number.MAX_VALUE,s=.5;r.y<t.y?n=(o.y+o.h-t.y)/t.h:r.y+r.h>t.y+t.h&&(n=(t.y+t.h-o.y)/t.h),r.x<t.x?a=(o.x+o.w-t.x)/t.w:r.x+r.w>t.x+t.w&&(a=(t.x+t.w-o.x)/t.w);let l=Math.min(a,n);l>s&&(s=l,i=e)})),t.collide=i,i}cacheRects(e,t,n,i,r,o){return this.nodes.forEach((a=>a._rect={y:a.y*t+n,x:a.x*e+o,w:a.w*e-o-i,h:a.h*t-n-r})),this}swap(e,t){if(!t||t.locked||!e||e.locked)return!1;function n(){let n=t.x,i=t.y;return t.x=e.x,t.y=e.y,e.h!=t.h?(e.x=n,e.y=t.y+t.h):e.w!=t.w?(e.x=t.x+t.w,e.y=i):(e.x=n,e.y=i),e._dirty=t._dirty=!0,!0}let r;if(e.w===t.w&&e.h===t.h&&(e.x===t.x||e.y===t.y)&&(r=i.Utils.isTouching(e,t)))return n();if(!1!==r){if(e.w===t.w&&e.x===t.x&&(r||(r=i.Utils.isTouching(e,t)))){if(t.y<e.y){let n=e;e=t,t=n}return n()}if(!1!==r){if(e.h===t.h&&e.y===t.y&&(r||(r=i.Utils.isTouching(e,t)))){if(t.x<e.x){let n=e;e=t,t=n}return n()}return!1}}}isAreaEmpty(e,t,n,i){let r={x:e||0,y:t||0,w:n||1,h:i||1};return!this.collide(r)}compact(){if(0===this.nodes.length)return this;this.batchUpdate().sortNodes();let e=this.nodes;return this.nodes=[],e.forEach((e=>{e.locked||(e.autoPosition=!0),this.addNode(e,!1),e._dirty=!0})),this.batchUpdate(!1)}set float(e){this._float!==e&&(this._float=e||!1,e||this._packNodes()._notify())}get float(){return this._float||!1}sortNodes(e){return this.nodes=i.Utils.sort(this.nodes,e,this.column),this}_packNodes(){return this.batchMode||(this.sortNodes(),this.float?this.nodes.forEach((e=>{if(e._updating||void 0===e._orig||e.y===e._orig.y)return;let t=e.y;for(;t>e._orig.y;)--t,this.collide(e,{x:e.x,y:t,w:e.w,h:e.h})||(e._dirty=!0,e.y=t)})):this.nodes.forEach(((e,t)=>{if(!e.locked)for(;e.y>0;){let n=0===t?0:e.y-1;if(0!==t&&this.collide(e,{x:e.x,y:n,w:e.w,h:e.h}))break;e._dirty=e.y!==n,e.y=n}}))),this}prepareNode(e,t){(e=e||{})._id=e._id||r._idSeq++,void 0!==e.x&&void 0!==e.y&&null!==e.x&&null!==e.y||(e.autoPosition=!0);let n={x:0,y:0,w:1,h:1};return i.Utils.defaults(e,n),e.autoPosition||delete e.autoPosition,e.noResize||delete e.noResize,e.noMove||delete e.noMove,"string"==typeof e.x&&(e.x=Number(e.x)),"string"==typeof e.y&&(e.y=Number(e.y)),"string"==typeof e.w&&(e.w=Number(e.w)),"string"==typeof e.h&&(e.h=Number(e.h)),isNaN(e.x)&&(e.x=n.x,e.autoPosition=!0),isNaN(e.y)&&(e.y=n.y,e.autoPosition=!0),isNaN(e.w)&&(e.w=n.w),isNaN(e.h)&&(e.h=n.h),this.nodeBoundFix(e,t)}nodeBoundFix(e,t){let n=e._orig||i.Utils.copyPos({},e);if(e.maxW&&(e.w=Math.min(e.w,e.maxW)),e.maxH&&(e.h=Math.min(e.h,e.maxH)),e.minW&&e.minW<=this.column&&(e.w=Math.max(e.w,e.minW)),e.minH&&(e.h=Math.max(e.h,e.minH)),(1===this.column||e.x+e.w>this.column)&&this.column<12&&!this._inColumnResize&&!e.autoPosition&&e._id&&-1===this.findCacheLayout(e,12)){let t=Object.assign({},e);t.x=Math.min(11,t.x),t.w=Math.min(12,t.w),this.cacheOneLayout(t,12)}return e.w>this.column?e.w=this.column:e.w<1&&(e.w=1),this.maxRow&&e.h>this.maxRow?e.h=this.maxRow:e.h<1&&(e.h=1),e.x<0&&(e.x=0),e.y<0&&(e.y=0),e.x+e.w>this.column&&(t?e.w=this.column-e.x:e.x=this.column-e.w),this.maxRow&&e.y+e.h>this.maxRow&&(t?e.h=this.maxRow-e.y:e.y=this.maxRow-e.h),i.Utils.samePos(e,n)||(e._dirty=!0),e}getDirtyNodes(e){return e?this.nodes.filter((e=>e._dirty&&!i.Utils.samePos(e,e._orig))):this.nodes.filter((e=>e._dirty))}_notify(e){if(this.batchMode||!this.onChange)return this;let t=(e||[]).concat(this.getDirtyNodes());return this.onChange(t),this}cleanNodes(){return this.batchMode||this.nodes.forEach((e=>{delete e._dirty,delete e._lastTried})),this}saveInitial(){return this.nodes.forEach((e=>{e._orig=i.Utils.copyPos({},e),delete e._dirty})),this._hasLocked=this.nodes.some((e=>e.locked)),this}restoreInitial(){return this.nodes.forEach((e=>{i.Utils.samePos(e,e._orig)||(i.Utils.copyPos(e,e._orig),e._dirty=!0)})),this._notify(),this}findEmptyPosition(e){this.sortNodes();let t=!1;for(let n=0;!t;++n){let r=n%this.column,o=Math.floor(n/this.column);if(r+e.w>this.column)continue;let a={x:r,y:o,w:e.w,h:e.h};this.nodes.find((e=>i.Utils.isIntercepted(a,e)))||(e.x=r,e.y=o,t=!0)}return t}addNode(e,t=!1){return this.nodes.find((t=>t._id===e._id))||(delete(e=this._inColumnResize?this.nodeBoundFix(e):this.prepareNode(e))._temporaryRemoved,delete e._removeDOM,e.autoPosition&&this.findEmptyPosition(e)&&delete e.autoPosition,this.nodes.push(e),t&&this.addedNodes.push(e),this._fixCollisions(e),this.batchMode||this._packNodes()._notify(),e)}removeNode(e,t=!0,n=!1){return this.nodes.find((t=>t===e))?(n&&this.removedNodes.push(e),t&&(e._removeDOM=!0),this.nodes=this.nodes.filter((t=>t!==e)),this._packNodes()._notify([e])):this}removeAll(e=!0){return delete this._layouts,0===this.nodes.length?this:(e&&this.nodes.forEach((e=>e._removeDOM=!0)),this.removedNodes=this.nodes,this.nodes=[],this._notify(this.removedNodes))}moveNodeCheck(e,t){if(!this.changedPosConstrain(e,t))return!1;if(t.pack=!0,!this.maxRow)return this.moveNode(e,t);let n,o=new r({column:this.column,float:this.float,nodes:this.nodes.map((t=>t===e?(n=Object.assign({},t),n):Object.assign({},t)))});if(!n)return!1;let a=o.moveNode(n,t)&&o.getRow()<=this.maxRow;if(!a&&!t.resizing&&t.collide){let n=t.collide.el.gridstackNode;if(this.swap(e,n))return this._notify(),!0}return!!a&&(o.nodes.filter((e=>e._dirty)).forEach((e=>{let t=this.nodes.find((t=>t._id===e._id));t&&(i.Utils.copyPos(t,e),t._dirty=!0)})),this._notify(),!0)}willItFit(e){if(delete e._willFitPos,!this.maxRow)return!0;let t=new r({column:this.column,float:this.float,nodes:this.nodes.map((e=>Object.assign({},e)))}),n=Object.assign({},e);return this.cleanupNode(n),delete n.el,delete n._id,delete n.content,delete n.grid,t.addNode(n),t.getRow()<=this.maxRow&&(e._willFitPos=i.Utils.copyPos({},n),!0)}changedPosConstrain(e,t){return t.w=t.w||e.w,t.h=t.h||e.h,e.x!==t.x||e.y!==t.y||(e.maxW&&(t.w=Math.min(t.w,e.maxW)),e.maxH&&(t.h=Math.min(t.h,e.maxH)),e.minW&&(t.w=Math.max(t.w,e.minW)),e.minH&&(t.h=Math.max(t.h,e.minH)),e.w!==t.w||e.h!==t.h)}moveNode(e,t){var n,r;if(!e||!t)return!1;let o;void 0===t.pack&&(o=t.pack=!0),"number"!=typeof t.x&&(t.x=e.x),"number"!=typeof t.y&&(t.y=e.y),"number"!=typeof t.w&&(t.w=e.w),"number"!=typeof t.h&&(t.h=e.h);let a=e.w!==t.w||e.h!==t.h,s=i.Utils.copyPos({},e,!0);if(i.Utils.copyPos(s,t),s=this.nodeBoundFix(s,a),i.Utils.copyPos(t,s),i.Utils.samePos(e,t))return!1;let l=i.Utils.copyPos({},e),c=this.collideAll(e,s,t.skip),h=!0;if(c.length){let a=e._moving&&!t.nested,l=a?this.directionCollideCoverage(e,t,c):c[0];if(a&&l&&(null===(r=null===(n=e.grid)||void 0===n?void 0:n.opts)||void 0===r?void 0:r.subGridDynamic)&&!e.grid._isTemp){let n=i.Utils.areaIntercept(t.rect,l._rect),r=i.Utils.area(t.rect),o=i.Utils.area(l._rect);n/(r<o?r:o)>.8&&(l.grid.makeSubGrid(l.el,void 0,e),l=void 0)}l?h=!this._fixCollisions(e,s,l,t):(h=!1,o&&delete t.pack)}return h&&(e._dirty=!0,i.Utils.copyPos(e,s)),t.pack&&this._packNodes()._notify(),!i.Utils.samePos(e,l)}getRow(){return this.nodes.reduce(((e,t)=>Math.max(e,t.y+t.h)),0)}beginUpdate(e){return e._updating||(e._updating=!0,delete e._skipDown,this.batchMode||this.saveInitial()),this}endUpdate(){let e=this.nodes.find((e=>e._updating));return e&&(delete e._updating,delete e._skipDown),this}save(e=!0){var t;let n=null===(t=this._layouts)||void 0===t?void 0:t.length,r=n&&this.column!==n-1?this._layouts[n-1]:null,o=[];return this.sortNodes(),this.nodes.forEach((t=>{let n=null==r?void 0:r.find((e=>e._id===t._id)),a=Object.assign({},t);n&&(a.x=n.x,a.y=n.y,a.w=n.w),i.Utils.removeInternalForSave(a,!e),o.push(a)})),o}layoutsNodesChange(e){return!this._layouts||this._inColumnResize||this._layouts.forEach(((t,n)=>{if(!t||n===this.column)return this;if(n<this.column)this._layouts[n]=void 0;else{let i=n/this.column;e.forEach((e=>{if(!e._orig)return;let n=t.find((t=>t._id===e._id));n&&(e.y!==e._orig.y&&(n.y+=e.y-e._orig.y),e.x!==e._orig.x&&(n.x=Math.round(e.x*i)),e.w!==e._orig.w&&(n.w=Math.round(e.w*i)))}))}})),this}updateNodeWidths(e,t,n,r="moveScale"){var o;if(!this.nodes.length||!t||e===t)return this;this.cacheLayout(this.nodes,e),this.batchUpdate();let a=[],s=!1;if(1===t&&(null==n?void 0:n.length)){s=!0;let e=0;n.forEach((t=>{t.x=0,t.w=1,t.y=Math.max(t.y,e),e=t.y+t.h})),a=n,n=[]}else n=i.Utils.sort(this.nodes,-1,e);let l=[];if(t>e){l=this._layouts[t]||[];let i=this._layouts.length-1;!l.length&&e!==i&&(null===(o=this._layouts[i])||void 0===o?void 0:o.length)&&(e=i,this._layouts[i].forEach((e=>{let t=n.find((t=>t._id===e._id));t&&(t.x=e.x,t.y=e.y,t.w=e.w)})))}if(l.forEach((e=>{let t=n.findIndex((t=>t._id===e._id));-1!==t&&(n[t].x=e.x,n[t].y=e.y,n[t].w=e.w,a.push(n[t]),n.splice(t,1))})),n.length)if("function"==typeof r)r(t,e,a,n);else if(!s){let i=t/e,o="move"===r||"moveScale"===r,s="scale"===r||"moveScale"===r;n.forEach((n=>{n.x=1===t?0:o?Math.round(n.x*i):Math.min(n.x,t-1),n.w=1===t||1===e?1:s?Math.round(n.w*i)||1:Math.min(n.w,t),a.push(n)})),n=[]}return s||(a=i.Utils.sort(a,-1,t)),this._inColumnResize=!0,this.nodes=[],a.forEach((e=>{this.addNode(e,!1),delete e._orig})),this.batchUpdate(!1),delete this._inColumnResize,this}cacheLayout(e,t,n=!1){let i=[];return e.forEach(((e,t)=>{e._id=e._id||r._idSeq++,i[t]={x:e.x,y:e.y,w:e.w,_id:e._id}})),this._layouts=n?[]:this._layouts||[],this._layouts[t]=i,this}cacheOneLayout(e,t){e._id=e._id||r._idSeq++;let n={x:e.x,y:e.y,w:e.w,_id:e._id};this._layouts=this._layouts||[],this._layouts[t]=this._layouts[t]||[];let i=this.findCacheLayout(e,t);return-1===i?this._layouts[t].push(n):this._layouts[t][i]=n,this}findCacheLayout(e,t){var n,i,r;return null!==(r=null===(i=null===(n=this._layouts)||void 0===n?void 0:n[t])||void 0===i?void 0:i.findIndex((t=>t._id===e._id)))&&void 0!==r?r:-1}cleanupNode(e){for(let t in e)"_"===t[0]&&"_id"!==t&&delete e[t];return this}}t.GridStackEngine=r,r._idSeq=1},5929:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.GridStack=void 0;const o=n(6935),a=n(9284),s=n(7523);r(n(7523),t),r(n(9284),t),r(n(6935),t);class l{constructor(e,t={}){var n,i;this._gsEventHandler={},this._extraDragRow=0,this.el=e,(t=t||{}).row&&(t.minRow=t.maxRow=t.row,delete t.row);let r=a.Utils.toNumber(e.getAttribute("gs-row"));"auto"===t.column&&delete t.column;let u=t;void 0!==u.minWidth&&(t.oneColumnSize=t.oneColumnSize||u.minWidth,delete u.minWidth),void 0!==t.alwaysShowResizeHandle&&(t._alwaysShowResizeHandle=t.alwaysShowResizeHandle);let f=Object.assign(Object.assign({},a.Utils.cloneDeep(s.gridDefaults)),{column:a.Utils.toNumber(e.getAttribute("gs-column"))||s.gridDefaults.column,minRow:r||a.Utils.toNumber(e.getAttribute("gs-min-row"))||s.gridDefaults.minRow,maxRow:r||a.Utils.toNumber(e.getAttribute("gs-max-row"))||s.gridDefaults.maxRow,staticGrid:a.Utils.toBool(e.getAttribute("gs-static"))||s.gridDefaults.staticGrid,draggable:{handle:(t.handleClass?"."+t.handleClass:t.handle?t.handle:"")||s.gridDefaults.draggable.handle},removableOptions:{accept:t.itemClass?"."+t.itemClass:s.gridDefaults.removableOptions.accept}});e.getAttribute("gs-animate")&&(f.animate=a.Utils.toBool(e.getAttribute("gs-animate"))),this.opts=a.Utils.defaults(t,f),t=null,this._initMargin(),1!==this.opts.column&&!this.opts.disableOneColumnMode&&this._widthOrContainer()<=this.opts.oneColumnSize&&(this._prevColumn=this.getColumn(),this.opts.column=1),"auto"===this.opts.rtl&&(this.opts.rtl="rtl"===e.style.direction),this.opts.rtl&&this.el.classList.add("grid-stack-rtl");let d=null===(n=a.Utils.closestUpByClass(this.el,s.gridDefaults.itemClass))||void 0===n?void 0:n.gridstackNode;d&&(d.subGrid=this,this.parentGridItem=d,this.el.classList.add("grid-stack-nested"),d.el.classList.add("grid-stack-sub-grid")),this._isAutoCellHeight="auto"===this.opts.cellHeight,this._isAutoCellHeight||"initial"===this.opts.cellHeight?this.cellHeight(void 0,!1):("number"==typeof this.opts.cellHeight&&this.opts.cellHeightUnit&&this.opts.cellHeightUnit!==s.gridDefaults.cellHeightUnit&&(this.opts.cellHeight=this.opts.cellHeight+this.opts.cellHeightUnit,delete this.opts.cellHeightUnit),this.cellHeight(this.opts.cellHeight,!1)),"mobile"===this.opts.alwaysShowResizeHandle&&(this.opts.alwaysShowResizeHandle=c.isTouch),this._styleSheetClass="grid-stack-instance-"+o.GridStackEngine._idSeq++,this.el.classList.add(this._styleSheetClass),this._setStaticClass();let p=this.opts.engineClass||l.engineClass||o.GridStackEngine;if(this.engine=new p({column:this.getColumn(),float:this.opts.float,maxRow:this.opts.maxRow,onChange:e=>{let t=0;this.engine.nodes.forEach((e=>{t=Math.max(t,e.y+e.h)})),e.forEach((e=>{let t=e.el;t&&(e._removeDOM?(t&&t.remove(),delete e._removeDOM):this._writePosAttr(t,e))})),this._updateStyles(!1,t)}}),this.opts.auto){this.batchUpdate();let e=[],t=this.getColumn();1===t&&this._prevColumn&&(t=this._prevColumn),this.getGridItems().forEach((n=>{let i=parseInt(n.getAttribute("gs-x")),r=parseInt(n.getAttribute("gs-y"));e.push({el:n,i:(Number.isNaN(i)?1e3:i)+(Number.isNaN(r)?1e3:r)*t})})),e.sort(((e,t)=>t.i-e.i)).forEach((e=>this._prepareElement(e.el))),this.batchUpdate(!1)}this.setAnimation(this.opts.animate),this._updateStyles(),12!=this.opts.column&&this.el.classList.add("grid-stack-"+this.opts.column),this.opts.dragIn&&l.setupDragIn(this.opts.dragIn,this.opts.dragInOptions),delete this.opts.dragIn,delete this.opts.dragInOptions,this.opts.subGridDynamic&&!h.DDManager.pauseDrag&&(h.DDManager.pauseDrag=!0),void 0!==(null===(i=this.opts.draggable)||void 0===i?void 0:i.pause)&&(h.DDManager.pauseDrag=this.opts.draggable.pause),this._setupRemoveDrop(),this._setupAcceptWidget(),this._updateWindowResizeEvent()}static init(e={},t=".grid-stack"){let n=l.getGridElement(t);return n?(n.gridstack||(n.gridstack=new l(n,a.Utils.cloneDeep(e))),n.gridstack):("string"==typeof t?console.error('GridStack.initAll() no grid was found with selector "'+t+'" - element missing or wrong selector ?\nNote: ".grid-stack" is required for proper CSS styling and drag/drop, and is the default selector.'):console.error("GridStack.init() no grid element was passed."),null)}static initAll(e={},t=".grid-stack"){let n=[];return l.getGridElements(t).forEach((t=>{t.gridstack||(t.gridstack=new l(t,a.Utils.cloneDeep(e)),delete e.dragIn,delete e.dragInOptions),n.push(t.gridstack)})),0===n.length&&console.error('GridStack.initAll() no grid was found with selector "'+t+'" - element missing or wrong selector ?\nNote: ".grid-stack" is required for proper CSS styling and drag/drop, and is the default selector.'),n}static addGrid(e,t={}){if(!e)return null;let n=e;if(!e.classList.contains("grid-stack")){let i=document.implementation.createHTMLDocument("");i.body.innerHTML=`<div class="grid-stack ${t.class||""}"></div>`,n=i.body.children[0],e.appendChild(n)}let i=l.init(t,n);if(i.opts.children){let e=i.opts.children;delete i.opts.children,i.load(e)}return i}static registerEngine(e){l.engineClass=e}get placeholder(){if(!this._placeholder){let e=document.createElement("div");e.className="placeholder-content",this.opts.placeholderText&&(e.innerHTML=this.opts.placeholderText),this._placeholder=document.createElement("div"),this._placeholder.classList.add(this.opts.placeholderClass,s.gridDefaults.itemClass,this.opts.itemClass),this.placeholder.appendChild(e)}return this._placeholder}addWidget(e,t){let n;if("string"==typeof e){let t=document.implementation.createHTMLDocument("");t.body.innerHTML=e,n=t.body.children[0]}else if(0===arguments.length||1===arguments.length&&(void 0!==(i=e).x||void 0!==i.y||void 0!==i.w||void 0!==i.h||void 0!==i.content)){let i=e&&e.content||"";t=e;let r=document.implementation.createHTMLDocument("");r.body.innerHTML=`<div class="grid-stack-item ${this.opts.itemClass||""}"><div class="grid-stack-item-content">${i}</div></div>`,n=r.body.children[0]}else n=e;var i;let r=this._readAttr(n);t=a.Utils.cloneDeep(t)||{},a.Utils.defaults(t,r);let o=this.engine.prepareNode(t);return this._writeAttr(n,t),this._insertNotAppend?this.el.prepend(n):this.el.appendChild(n),this._prepareElement(n,!0,t),this._updateContainerHeight(),o.subGrid&&this.makeSubGrid(o.el,void 0,void 0,!1),this._prevColumn&&1===this.opts.column&&(this._ignoreLayoutsNodeChange=!0),this._triggerAddEvent(),this._triggerChangeEvent(),delete this._ignoreLayoutsNodeChange,n}makeSubGrid(e,t,n,i=!0){var r;let o,s=e.gridstackNode;if(s||(s=this.makeWidget(e).gridstackNode),null===(r=s.subGrid)||void 0===r?void 0:r.el)return s.subGrid;(t=a.Utils.cloneDeep(t||s.subGrid||Object.assign(Object.assign({},this.opts.subGrid),{children:void 0}))).subGrid=a.Utils.cloneDeep(t),s.subGrid=t,"auto"===t.column&&(o=!0,t.column=Math.max(s.w||1,(null==n?void 0:n.w)||1),t.disableOneColumnMode=!0);let c,h,u=s.el.querySelector(".grid-stack-item-content");if(i){this._removeDD(s.el);let e=document.implementation.createHTMLDocument("");e.body.innerHTML='<div class="grid-stack-item"></div>',c=e.body.children[0],c.appendChild(u),h=Object.assign(Object.assign({},s),{x:0,y:0}),a.Utils.removeInternalForSave(h),delete h.subGrid,s.content&&(h.content=s.content,delete s.content),e.body.innerHTML='<div class="grid-stack-item-content"></div>',u=e.body.children[0],s.el.appendChild(u),this._prepareDragDropByNode(s)}if(n){let e=o?t.column:s.w,i=s.h+n.h,r=s.el.style;r.transition="none",this.update(s.el,{w:e,h:i}),setTimeout((()=>r.transition=null))}let f=s.subGrid=l.addGrid(u,t);return(null==n?void 0:n._moving)&&(f._isTemp=!0),o&&(f._autoColumn=!0),i&&f.addWidget(c,h),n&&(n._moving?window.setTimeout((()=>a.Utils.simulateMouseEvent(n._event,"mouseenter",f.el)),0):f.addWidget(s.el,s)),f}removeAsSubGrid(e){var t;let n=null===(t=this.parentGridItem)||void 0===t?void 0:t.grid;n&&(n.batchUpdate(),n.removeWidget(this.parentGridItem.el,!0,!0),this.engine.nodes.forEach((e=>{e.x+=this.parentGridItem.x,e.y+=this.parentGridItem.y,n.addWidget(e.el,e)})),n.batchUpdate(!1),delete this.parentGridItem,e&&window.setTimeout((()=>a.Utils.simulateMouseEvent(e._event,"mouseenter",n.el)),0))}save(e=!0,t=!1){let n=this.engine.save(e);if(n.forEach((t=>{if(e&&t.el&&!t.subGrid){let e=t.el.querySelector(".grid-stack-item-content");t.content=e?e.innerHTML:void 0,t.content||delete t.content}else e||delete t.content,t.subGrid&&(t.subGrid=t.subGrid.save(e,!0));delete t.el})),t){let e=a.Utils.cloneDeep(this.opts);e.marginBottom===e.marginTop&&e.marginRight===e.marginLeft&&e.marginTop===e.marginRight&&(e.margin=e.marginTop,delete e.marginTop,delete e.marginRight,delete e.marginBottom,delete e.marginLeft),e.rtl===("rtl"===this.el.style.direction)&&(e.rtl="auto"),this._isAutoCellHeight&&(e.cellHeight="auto"),this._autoColumn&&(e.column="auto",delete e.disableOneColumnMode);const t=e._alwaysShowResizeHandle;return delete e._alwaysShowResizeHandle,void 0!==t?e.alwaysShowResizeHandle=t:delete e.alwaysShowResizeHandle,a.Utils.removeInternalAndSame(e,s.gridDefaults),e.children=n,e}return n}load(e,t=!0){let n=l.Utils.sort([...e],-1,this._prevColumn||this.getColumn());this._insertNotAppend=!0,this._prevColumn&&this._prevColumn!==this.opts.column&&n.some((e=>e.x+e.w>this.opts.column))&&(this._ignoreLayoutsNodeChange=!0,this.engine.cacheLayout(n,this._prevColumn,!0));let i=[];return this.batchUpdate(),t&&[...this.engine.nodes].forEach((e=>{n.find((t=>e.id===t.id))||("function"==typeof t?t(this,e,!1):(i.push(e),this.removeWidget(e.el,!0,!1)))})),n.forEach((e=>{let n=e.id||0===e.id?this.engine.nodes.find((t=>t.id===e.id)):void 0;if(n){if(this.update(n.el,e),e.subGrid&&e.subGrid.children){let t=n.el.querySelector(".grid-stack");t&&t.gridstack&&(t.gridstack.load(e.subGrid.children),this._insertNotAppend=!0)}}else t&&(e="function"==typeof t?t(this,e,!0).gridstackNode:this.addWidget(e).gridstackNode)})),this.engine.removedNodes=i,this.batchUpdate(!1),delete this._ignoreLayoutsNodeChange,delete this._insertNotAppend,this}batchUpdate(e=!0){return this.engine.batchUpdate(e),e||(this._triggerRemoveEvent(),this._triggerAddEvent(),this._triggerChangeEvent()),this}getCellHeight(e=!1){if(this.opts.cellHeight&&"auto"!==this.opts.cellHeight&&(!e||!this.opts.cellHeightUnit||"px"===this.opts.cellHeightUnit))return this.opts.cellHeight;let t=this.el.querySelector("."+this.opts.itemClass);if(t){let e=a.Utils.toNumber(t.getAttribute("gs-h"));return Math.round(t.offsetHeight/e)}let n=parseInt(this.el.getAttribute("gs-current-row"));return n?Math.round(this.el.getBoundingClientRect().height/n):this.opts.cellHeight}cellHeight(e,t=!0){if(t&&void 0!==e&&this._isAutoCellHeight!==("auto"===e)&&(this._isAutoCellHeight="auto"===e,this._updateWindowResizeEvent()),"initial"!==e&&"auto"!==e||(e=void 0),void 0===e){let t=-this.opts.marginRight-this.opts.marginLeft+this.opts.marginTop+this.opts.marginBottom;e=this.cellWidth()+t}let n=a.Utils.parseHeight(e);return this.opts.cellHeightUnit===n.unit&&this.opts.cellHeight===n.h||(this.opts.cellHeightUnit=n.unit,this.opts.cellHeight=n.h,t&&this._updateStyles(!0)),this}cellWidth(){return this._widthOrContainer()/this.getColumn()}_widthOrContainer(){return this.el.clientWidth||this.el.parentElement.clientWidth||window.innerWidth}compact(){return this.engine.compact(),this._triggerChangeEvent(),this}column(e,t="moveScale"){if(e<1||this.opts.column===e)return this;let n,i=this.getColumn();return 1===e?this._prevColumn=i:delete this._prevColumn,this.el.classList.remove("grid-stack-"+i),this.el.classList.add("grid-stack-"+e),this.opts.column=this.engine.column=e,1===e&&this.opts.oneColumnModeDomSort&&(n=[],this.getGridItems().forEach((e=>{e.gridstackNode&&n.push(e.gridstackNode)})),n.length||(n=void 0)),this.engine.updateNodeWidths(i,e,n,t),this._isAutoCellHeight&&this.cellHeight(),this._ignoreLayoutsNodeChange=!0,this._triggerChangeEvent(),delete this._ignoreLayoutsNodeChange,this}getColumn(){return this.opts.column}getGridItems(){return Array.from(this.el.children).filter((e=>e.matches("."+this.opts.itemClass)&&!e.matches("."+this.opts.placeholderClass)))}destroy(e=!0){if(this.el)return this._updateWindowResizeEvent(!0),this.setStatic(!0,!1),this.setAnimation(!1),e?this.el.parentNode.removeChild(this.el):(this.removeAll(e),this.el.classList.remove(this._styleSheetClass)),this._removeStylesheet(),this.el.removeAttribute("gs-current-row"),delete this.parentGridItem,delete this.opts,delete this._placeholder,delete this.engine,delete this.el.gridstack,delete this.el,this}float(e){return this.opts.float!==e&&(this.opts.float=this.engine.float=e,this._triggerChangeEvent()),this}getFloat(){return this.engine.float}getCellFromPixel(e,t=!1){let n,i=this.el.getBoundingClientRect();n=t?{top:i.top+document.documentElement.scrollTop,left:i.left}:{top:this.el.offsetTop,left:this.el.offsetLeft};let r=e.left-n.left,o=e.top-n.top,a=i.width/this.getColumn(),s=i.height/parseInt(this.el.getAttribute("gs-current-row"));return{x:Math.floor(r/a),y:Math.floor(o/s)}}getRow(){return Math.max(this.engine.getRow(),this.opts.minRow)}isAreaEmpty(e,t,n,i){return this.engine.isAreaEmpty(e,t,n,i)}makeWidget(e){let t=l.getElement(e);return this._prepareElement(t,!0),this._updateContainerHeight(),this._triggerAddEvent(),this._triggerChangeEvent(),t}on(e,t){if(-1!==e.indexOf(" "))return e.split(" ").forEach((e=>this.on(e,t))),this;if("change"===e||"added"===e||"removed"===e||"enable"===e||"disable"===e){let n="enable"===e||"disable"===e;this._gsEventHandler[e]=n?e=>t(e):e=>t(e,e.detail),this.el.addEventListener(e,this._gsEventHandler[e])}else"drag"===e||"dragstart"===e||"dragstop"===e||"resizestart"===e||"resize"===e||"resizestop"===e||"dropped"===e?this._gsEventHandler[e]=t:console.log("GridStack.on("+e+') event not supported, but you can still use $(".grid-stack").on(...) while jquery-ui is still used internally.');return this}off(e){return-1!==e.indexOf(" ")?(e.split(" ").forEach((e=>this.off(e))),this):("change"!==e&&"added"!==e&&"removed"!==e&&"enable"!==e&&"disable"!==e||this._gsEventHandler[e]&&this.el.removeEventListener(e,this._gsEventHandler[e]),delete this._gsEventHandler[e],this)}removeWidget(e,t=!0,n=!0){return l.getElements(e).forEach((e=>{if(e.parentElement&&e.parentElement!==this.el)return;let i=e.gridstackNode;i||(i=this.engine.nodes.find((t=>e===t.el))),i&&(delete e.gridstackNode,this._removeDD(e),this.engine.removeNode(i,t,n),t&&e.parentElement&&e.remove())})),n&&(this._triggerRemoveEvent(),this._triggerChangeEvent()),this}removeAll(e=!0){return this.engine.nodes.forEach((e=>{delete e.el.gridstackNode,this._removeDD(e.el)})),this.engine.removeAll(e),this._triggerRemoveEvent(),this}setAnimation(e){return e?this.el.classList.add("grid-stack-animate"):this.el.classList.remove("grid-stack-animate"),this}setStatic(e,t=!0){return this.opts.staticGrid===e||(this.opts.staticGrid=e,this._setupRemoveDrop(),this._setupAcceptWidget(),this.engine.nodes.forEach((e=>this._prepareDragDropByNode(e))),t&&this._setStaticClass()),this}update(e,t){if(arguments.length>2){console.warn("gridstack.ts: `update(el, x, y, w, h)` is deprecated. Use `update(el, {x, w, content, ...})`. It will be removed soon");let n=arguments,i=1;return t={x:n[i++],y:n[i++],w:n[i++],h:n[i++]},this.update(e,t)}return l.getElements(e).forEach((e=>{if(!e||!e.gridstackNode)return;let n=e.gridstackNode,i=a.Utils.cloneDeep(t);delete i.autoPosition;let r,o=["x","y","w","h"];if(o.some((e=>void 0!==i[e]&&i[e]!==n[e]))&&(r={},o.forEach((e=>{r[e]=void 0!==i[e]?i[e]:n[e],delete i[e]}))),!r&&(i.minW||i.minH||i.maxW||i.maxH)&&(r={}),i.content){let t=e.querySelector(".grid-stack-item-content");t&&t.innerHTML!==i.content&&(t.innerHTML=i.content),delete i.content}let s=!1,l=!1;for(const e in i)"_"!==e[0]&&n[e]!==i[e]&&(n[e]=i[e],s=!0,l=l||!this.opts.staticGrid&&("noResize"===e||"noMove"===e||"locked"===e));r&&(this.engine.cleanNodes().beginUpdate(n).moveNode(n,r),this._updateContainerHeight(),this._triggerChangeEvent(),this.engine.endUpdate()),s&&this._writeAttr(e,n),l&&this._prepareDragDropByNode(n)})),this}margin(e){if(!("string"==typeof e&&e.split(" ").length>1)){let t=a.Utils.parseHeight(e);if(this.opts.marginUnit===t.unit&&this.opts.margin===t.h)return}return this.opts.margin=e,this.opts.marginTop=this.opts.marginBottom=this.opts.marginLeft=this.opts.marginRight=void 0,this._initMargin(),this._updateStyles(!0),this}getMargin(){return this.opts.margin}willItFit(e){if(arguments.length>1){console.warn("gridstack.ts: `willItFit(x,y,w,h,autoPosition)` is deprecated. Use `willItFit({x, y,...})`. It will be removed soon");let e=arguments,t=0,n={x:e[t++],y:e[t++],w:e[t++],h:e[t++],autoPosition:e[t++]};return this.willItFit(n)}return this.engine.willItFit(e)}_triggerChangeEvent(){if(this.engine.batchMode)return this;let e=this.engine.getDirtyNodes(!0);return e&&e.length&&(this._ignoreLayoutsNodeChange||this.engine.layoutsNodesChange(e),this._triggerEvent("change",e)),this.engine.saveInitial(),this}_triggerAddEvent(){return this.engine.batchMode||this.engine.addedNodes&&this.engine.addedNodes.length>0&&(this._ignoreLayoutsNodeChange||this.engine.layoutsNodesChange(this.engine.addedNodes),this.engine.addedNodes.forEach((e=>{delete e._dirty})),this._triggerEvent("added",this.engine.addedNodes),this.engine.addedNodes=[]),this}_triggerRemoveEvent(){return this.engine.batchMode||this.engine.removedNodes&&this.engine.removedNodes.length>0&&(this._triggerEvent("removed",this.engine.removedNodes),this.engine.removedNodes=[]),this}_triggerEvent(e,t){let n=t?new CustomEvent(e,{bubbles:!1,detail:t}):new Event(e);return this.el.dispatchEvent(n),this}_removeStylesheet(){return this._styles&&(a.Utils.removeStylesheet(this._styleSheetClass),delete this._styles),this}_updateStyles(e=!1,t){if(e&&this._removeStylesheet(),t||(t=this.getRow()),this._updateContainerHeight(),0===this.opts.cellHeight)return this;let n=this.opts.cellHeight,i=this.opts.cellHeightUnit,r=`.${this._styleSheetClass} > .${this.opts.itemClass}`;if(!this._styles){let e=this.opts.styleInHead?void 0:this.el.parentNode;if(this._styles=a.Utils.createStylesheet(this._styleSheetClass,e),!this._styles)return this;this._styles._max=0,a.Utils.addCSSRule(this._styles,r,`min-height: ${n}${i}`);let t=this.opts.marginTop+this.opts.marginUnit,o=this.opts.marginBottom+this.opts.marginUnit,s=this.opts.marginRight+this.opts.marginUnit,l=this.opts.marginLeft+this.opts.marginUnit,c=`${r} > .grid-stack-item-content`,h=`.${this._styleSheetClass} > .grid-stack-placeholder > .placeholder-content`;a.Utils.addCSSRule(this._styles,c,`top: ${t}; right: ${s}; bottom: ${o}; left: ${l};`),a.Utils.addCSSRule(this._styles,h,`top: ${t}; right: ${s}; bottom: ${o}; left: ${l};`),a.Utils.addCSSRule(this._styles,`${r} > .ui-resizable-ne`,`right: ${s}`),a.Utils.addCSSRule(this._styles,`${r} > .ui-resizable-e`,`right: ${s}`),a.Utils.addCSSRule(this._styles,`${r} > .ui-resizable-se`,`right: ${s}; bottom: ${o}`),a.Utils.addCSSRule(this._styles,`${r} > .ui-resizable-nw`,`left: ${l}`),a.Utils.addCSSRule(this._styles,`${r} > .ui-resizable-w`,`left: ${l}`),a.Utils.addCSSRule(this._styles,`${r} > .ui-resizable-sw`,`left: ${l}; bottom: ${o}`)}if((t=t||this._styles._max)>this._styles._max){let e=e=>n*e+i;for(let n=this._styles._max+1;n<=t;n++){let t=e(n);a.Utils.addCSSRule(this._styles,`${r}[gs-y="${n-1}"]`,`top: ${e(n-1)}`),a.Utils.addCSSRule(this._styles,`${r}[gs-h="${n}"]`,`height: ${t}`),a.Utils.addCSSRule(this._styles,`${r}[gs-min-h="${n}"]`,`min-height: ${t}`),a.Utils.addCSSRule(this._styles,`${r}[gs-max-h="${n}"]`,`max-height: ${t}`)}this._styles._max=t}return this}_updateContainerHeight(){if(!this.engine||this.engine.batchMode)return this;let e=this.getRow()+this._extraDragRow;if(this.el.setAttribute("gs-current-row",String(e)),0===e)return this.el.style.removeProperty("min-height"),this;let t=this.opts.cellHeight,n=this.opts.cellHeightUnit;return t?(this.el.style.minHeight=e*t+n,this):this}_prepareElement(e,t=!1,n){n||(e.classList.add(this.opts.itemClass),n=this._readAttr(e)),e.gridstackNode=n,n.el=e,n.grid=this;let i=Object.assign({},n);return n=this.engine.addNode(n,t),a.Utils.same(n,i)||this._writeAttr(e,n),this._prepareDragDropByNode(n),this}_writePosAttr(e,t){return void 0!==t.x&&null!==t.x&&e.setAttribute("gs-x",String(t.x)),void 0!==t.y&&null!==t.y&&e.setAttribute("gs-y",String(t.y)),t.w&&e.setAttribute("gs-w",String(t.w)),t.h&&e.setAttribute("gs-h",String(t.h)),this}_writeAttr(e,t){if(!t)return this;this._writePosAttr(e,t);let n={autoPosition:"gs-auto-position",minW:"gs-min-w",minH:"gs-min-h",maxW:"gs-max-w",maxH:"gs-max-h",noResize:"gs-no-resize",noMove:"gs-no-move",locked:"gs-locked",id:"gs-id",resizeHandles:"gs-resize-handles"};for(const i in n)t[i]?e.setAttribute(n[i],String(t[i])):e.removeAttribute(n[i]);return this}_readAttr(e){let t={};t.x=a.Utils.toNumber(e.getAttribute("gs-x")),t.y=a.Utils.toNumber(e.getAttribute("gs-y")),t.w=a.Utils.toNumber(e.getAttribute("gs-w")),t.h=a.Utils.toNumber(e.getAttribute("gs-h")),t.maxW=a.Utils.toNumber(e.getAttribute("gs-max-w")),t.minW=a.Utils.toNumber(e.getAttribute("gs-min-w")),t.maxH=a.Utils.toNumber(e.getAttribute("gs-max-h")),t.minH=a.Utils.toNumber(e.getAttribute("gs-min-h")),t.autoPosition=a.Utils.toBool(e.getAttribute("gs-auto-position")),t.noResize=a.Utils.toBool(e.getAttribute("gs-no-resize")),t.noMove=a.Utils.toBool(e.getAttribute("gs-no-move")),t.locked=a.Utils.toBool(e.getAttribute("gs-locked")),t.resizeHandles=e.getAttribute("gs-resize-handles"),t.id=e.getAttribute("gs-id");for(const e in t){if(!t.hasOwnProperty(e))return;t[e]||0===t[e]||delete t[e]}return t}_setStaticClass(){let e=["grid-stack-static"];return this.opts.staticGrid?(this.el.classList.add(...e),this.el.setAttribute("gs-static","true")):(this.el.classList.remove(...e),this.el.removeAttribute("gs-static")),this}onParentResize(){if(!this.el||!this.el.clientWidth)return;let e=!1;if(this._autoColumn&&this.parentGridItem)this.opts.column!==this.parentGridItem.w&&(e=!0,this.column(this.parentGridItem.w,"none"));else{let t=!this.opts.disableOneColumnMode&&this.el.clientWidth<=this.opts.oneColumnSize;1===this.opts.column!==t&&(e=!0,this.opts.animate&&this.setAnimation(!1),this.column(t?1:this._prevColumn),this.opts.animate&&this.setAnimation(!0))}return this._isAutoCellHeight&&(!e&&this.opts.cellHeightThrottle?(this._cellHeightThrottle||(this._cellHeightThrottle=a.Utils.throttle((()=>this.cellHeight()),this.opts.cellHeightThrottle)),this._cellHeightThrottle()):this.cellHeight()),this.engine.nodes.forEach((e=>{e.subGrid&&e.subGrid.onParentResize()})),this}_updateWindowResizeEvent(e=!1){const t=(this._isAutoCellHeight||!this.opts.disableOneColumnMode)&&!this.parentGridItem;return e||!t||this._windowResizeBind?!e&&t||!this._windowResizeBind||(window.removeEventListener("resize",this._windowResizeBind),delete this._windowResizeBind):(this._windowResizeBind=this.onParentResize.bind(this),window.addEventListener("resize",this._windowResizeBind)),this}static getElement(e=".grid-stack-item"){return a.Utils.getElement(e)}static getElements(e=".grid-stack-item"){return a.Utils.getElements(e)}static getGridElement(e){return l.getElement(e)}static getGridElements(e){return a.Utils.getElements(e)}_initMargin(){let e,t=0,n=[];return"string"==typeof this.opts.margin&&(n=this.opts.margin.split(" ")),2===n.length?(this.opts.marginTop=this.opts.marginBottom=n[0],this.opts.marginLeft=this.opts.marginRight=n[1]):4===n.length?(this.opts.marginTop=n[0],this.opts.marginRight=n[1],this.opts.marginBottom=n[2],this.opts.marginLeft=n[3]):(e=a.Utils.parseHeight(this.opts.margin),this.opts.marginUnit=e.unit,t=this.opts.margin=e.h),void 0===this.opts.marginTop?this.opts.marginTop=t:(e=a.Utils.parseHeight(this.opts.marginTop),this.opts.marginTop=e.h,delete this.opts.margin),void 0===this.opts.marginBottom?this.opts.marginBottom=t:(e=a.Utils.parseHeight(this.opts.marginBottom),this.opts.marginBottom=e.h,delete this.opts.margin),void 0===this.opts.marginRight?this.opts.marginRight=t:(e=a.Utils.parseHeight(this.opts.marginRight),this.opts.marginRight=e.h,delete this.opts.margin),void 0===this.opts.marginLeft?this.opts.marginLeft=t:(e=a.Utils.parseHeight(this.opts.marginLeft),this.opts.marginLeft=e.h,delete this.opts.margin),this.opts.marginUnit=e.unit,this.opts.marginTop===this.opts.marginBottom&&this.opts.marginLeft===this.opts.marginRight&&this.opts.marginTop===this.opts.marginRight&&(this.opts.margin=this.opts.marginTop),this}static setupDragIn(e,t){}movable(e,t){return this}resizable(e,t){return this}disable(){return this}enable(){return this}enableMove(e){return this}enableResize(e){return this}_removeDD(e){return this}_setupAcceptWidget(){return this}_setupRemoveDrop(){return this}_prepareDragDropByNode(e){return this}_onStartMoving(e,t,n,i,r,o){}_dragOrResize(e,t,n,i,r,o){}_leave(e,t){}commit(){return a.obsolete(this,this.batchUpdate(!1),"commit","batchUpdate","5.2"),this}}t.GridStack=l,l.Utils=a.Utils,l.Engine=o.GridStackEngine,l.GDRev="7.1.1";const c=n(168),h=n(427);r(n(6470),t)},7523:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dragInDefaultOptions=t.gridDefaults=void 0,t.gridDefaults={alwaysShowResizeHandle:"mobile",animate:!0,auto:!0,cellHeight:"auto",cellHeightThrottle:100,cellHeightUnit:"px",column:12,draggable:{handle:".grid-stack-item-content",appendTo:"body"},handle:".grid-stack-item-content",itemClass:"grid-stack-item",margin:10,marginUnit:"px",maxRow:0,minRow:0,oneColumnSize:768,placeholderClass:"grid-stack-placeholder",placeholderText:"",removableOptions:{accept:".grid-stack-item"},resizable:{handles:"se"},rtl:"auto"},t.dragInDefaultOptions={handle:".grid-stack-item-content",appendTo:"body"}},9284:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Utils=t.obsoleteAttr=t.obsoleteOptsDel=t.obsoleteOpts=t.obsolete=void 0,t.obsolete=function(e,t,n,i,r){let o=(...o)=>(console.warn("gridstack.js: Function `"+n+"` is deprecated in "+r+" and has been replaced with `"+i+"`. It will be **removed** in a future release"),t.apply(e,o));return o.prototype=t.prototype,o},t.obsoleteOpts=function(e,t,n,i){void 0!==e[t]&&(e[n]=e[t],console.warn("gridstack.js: Option `"+t+"` is deprecated in "+i+" and has been replaced with `"+n+"`. It will be **removed** in a future release"))},t.obsoleteOptsDel=function(e,t,n,i){void 0!==e[t]&&console.warn("gridstack.js: Option `"+t+"` is deprecated in "+n+i)},t.obsoleteAttr=function(e,t,n,i){let r=e.getAttribute(t);null!==r&&(e.setAttribute(n,r),console.warn("gridstack.js: attribute `"+t+"`="+r+" is deprecated on this object in "+i+" and has been replaced with `"+n+"`. It will be **removed** in a future release"))};class n{static getElements(e){if("string"==typeof e){let t=document.querySelectorAll(e);return t.length||"."===e[0]||"#"===e[0]||(t=document.querySelectorAll("."+e),t.length||(t=document.querySelectorAll("#"+e))),Array.from(t)}return[e]}static getElement(e){if("string"==typeof e){if(!e.length)return null;if("#"===e[0])return document.getElementById(e.substring(1));if("."===e[0]||"["===e[0])return document.querySelector(e);if(!isNaN(+e[0]))return document.getElementById(e);let t=document.querySelector(e);return t||(t=document.getElementById(e)),t||(t=document.querySelector("."+e)),t}return e}static isIntercepted(e,t){return!(e.y>=t.y+t.h||e.y+e.h<=t.y||e.x+e.w<=t.x||e.x>=t.x+t.w)}static isTouching(e,t){return n.isIntercepted(e,{x:t.x-.5,y:t.y-.5,w:t.w+1,h:t.h+1})}static areaIntercept(e,t){let n=e.x>t.x?e.x:t.x,i=e.x+e.w<t.x+t.w?e.x+e.w:t.x+t.w;if(i<=n)return 0;let r=e.y>t.y?e.y:t.y,o=e.y+e.h<t.y+t.h?e.y+e.h:t.y+t.h;return o<=r?0:(i-n)*(o-r)}static area(e){return e.w*e.h}static sort(e,t,n){return n=n||e.reduce(((e,t)=>Math.max(t.x+t.w,e)),0)||12,-1===t?e.sort(((e,t)=>t.x+t.y*n-(e.x+e.y*n))):e.sort(((e,t)=>e.x+e.y*n-(t.x+t.y*n)))}static createStylesheet(e,t){let n=document.createElement("style");return n.setAttribute("type","text/css"),n.setAttribute("gs-style-id",e),n.styleSheet?n.styleSheet.cssText="":n.appendChild(document.createTextNode("")),t?t.insertBefore(n,t.firstChild):(t=document.getElementsByTagName("head")[0]).appendChild(n),n.sheet}static removeStylesheet(e){let t=document.querySelector("STYLE[gs-style-id="+e+"]");t&&t.parentNode&&t.remove()}static addCSSRule(e,t,n){"function"==typeof e.addRule?e.addRule(t,n):"function"==typeof e.insertRule&&e.insertRule(`${t}{${n}}`)}static toBool(e){return"boolean"==typeof e?e:"string"==typeof e?!(""===(e=e.toLowerCase())||"no"===e||"false"===e||"0"===e):Boolean(e)}static toNumber(e){return null===e||0===e.length?void 0:Number(e)}static parseHeight(e){let t,n="px";if("string"==typeof e){let i=e.match(/^(-[0-9]+\.[0-9]+|[0-9]*\.[0-9]+|-[0-9]+|[0-9]+)(px|em|rem|vh|vw|%)?$/);if(!i)throw new Error("Invalid height");n=i[2]||"px",t=parseFloat(i[1])}else t=e;return{h:t,unit:n}}static defaults(e,...t){return t.forEach((t=>{for(const n in t){if(!t.hasOwnProperty(n))return;null===e[n]||void 0===e[n]?e[n]=t[n]:"object"==typeof t[n]&&"object"==typeof e[n]&&this.defaults(e[n],t[n])}})),e}static same(e,t){if("object"!=typeof e)return e==t;if(typeof e!=typeof t)return!1;if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}static copyPos(e,t,n=!1){return e.x=t.x,e.y=t.y,e.w=t.w,e.h=t.h,n&&(t.minW&&(e.minW=t.minW),t.minH&&(e.minH=t.minH),t.maxW&&(e.maxW=t.maxW),t.maxH&&(e.maxH=t.maxH)),e}static samePos(e,t){return e&&t&&e.x===t.x&&e.y===t.y&&e.w===t.w&&e.h===t.h}static removeInternalAndSame(e,t){if("object"==typeof e&&"object"==typeof t)for(let n in e){let i=e[n];if("_"===n[0]||i===t[n])delete e[n];else if(i&&"object"==typeof i&&void 0!==t[n]){for(let e in i)i[e]!==t[n][e]&&"_"!==e[0]||delete i[e];Object.keys(i).length||delete e[n]}}}static removeInternalForSave(e,t=!0){for(let t in e)"_"!==t[0]&&null!==e[t]&&void 0!==e[t]||delete e[t];delete e.grid,t&&delete e.el,e.autoPosition||delete e.autoPosition,e.noResize||delete e.noResize,e.noMove||delete e.noMove,e.locked||delete e.locked,1!==e.w&&e.w!==e.minW||delete e.w,1!==e.h&&e.h!==e.minH||delete e.h}static closestUpByClass(e,t){for(;e;){if(e.classList.contains(t))return e;e=e.parentElement}return null}static throttle(e,t){let n=!1;return(...i)=>{n||(n=!0,setTimeout((()=>{e(...i),n=!1}),t))}}static removePositioningStyles(e){let t=e.style;t.position&&t.removeProperty("position"),t.left&&t.removeProperty("left"),t.top&&t.removeProperty("top"),t.width&&t.removeProperty("width"),t.height&&t.removeProperty("height")}static getScrollElement(e){if(!e)return document.scrollingElement||document.documentElement;const t=getComputedStyle(e);return/(auto|scroll)/.test(t.overflow+t.overflowY)?e:this.getScrollElement(e.parentElement)}static updateScrollPosition(e,t,n){let i=e.getBoundingClientRect(),r=window.innerHeight||document.documentElement.clientHeight;if(i.top<0||i.bottom>r){let o=i.bottom-r,a=i.top,s=this.getScrollElement(e);if(null!==s){let l=s.scrollTop;i.top<0&&n<0?e.offsetHeight>r?s.scrollTop+=n:s.scrollTop+=Math.abs(a)>Math.abs(n)?n:a:n>0&&(e.offsetHeight>r?s.scrollTop+=n:s.scrollTop+=o>n?n:o),t.top+=s.scrollTop-l}}}static updateScrollResize(e,t,n){const i=this.getScrollElement(t),r=i.clientHeight,o=i===this.getScrollElement()?0:i.getBoundingClientRect().top,a=e.clientY-o,s=a>r-n;a<n?i.scrollBy({behavior:"smooth",top:a-n}):s&&i.scrollBy({behavior:"smooth",top:n-(r-a)})}static clone(e){return null==e||"object"!=typeof e?e:e instanceof Array?[...e]:Object.assign({},e)}static cloneDeep(e){const t=["parentGrid","el","grid","subGrid","engine"],i=n.clone(e);for(const r in i)i.hasOwnProperty(r)&&"object"==typeof i[r]&&"__"!==r.substring(0,2)&&!t.find((e=>e===r))&&(i[r]=n.cloneDeep(e[r]));return i}static cloneNode(e){const t=e.cloneNode(!0);return t.removeAttribute("id"),t}static appendTo(e,t){let n;n="string"==typeof t?document.querySelector(t):t,n&&n.appendChild(e)}static addElStyles(e,t){if(t instanceof Object)for(const n in t)t.hasOwnProperty(n)&&(Array.isArray(t[n])?t[n].forEach((t=>{e.style[n]=t})):e.style[n]=t[n])}static initEvent(e,t){const n={type:t.type},i={button:0,which:0,buttons:1,bubbles:!0,cancelable:!0,target:t.target?t.target:e.target};return e.dataTransfer&&(n.dataTransfer=e.dataTransfer),["altKey","ctrlKey","metaKey","shiftKey"].forEach((t=>n[t]=e[t])),["pageX","pageY","clientX","clientY","screenX","screenY"].forEach((t=>n[t]=e[t])),Object.assign(Object.assign({},n),i)}static simulateMouseEvent(e,t,n){const i=document.createEvent("MouseEvents");i.initMouseEvent(t,!0,!0,window,1,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,0,e.target),(n||e.target).dispatchEvent(i)}}t.Utils=n},9755:function(e,t){var n;!function(t,n){"use strict";"object"==typeof e.exports?e.exports=t.document?n(t,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return n(e)}:n(t)}("undefined"!=typeof window?window:this,(function(i,r){"use strict";var o=[],a=Object.getPrototypeOf,s=o.slice,l=o.flat?function(e){return o.flat.call(e)}:function(e){return o.concat.apply([],e)},c=o.push,h=o.indexOf,u={},f=u.toString,d=u.hasOwnProperty,p=d.toString,g=p.call(Object),m={},_=function(e){return"function"==typeof e&&"number"!=typeof e.nodeType&&"function"!=typeof e.item},v=function(e){return null!=e&&e===e.window},b=i.document,y={type:!0,src:!0,nonce:!0,noModule:!0};function w(e,t,n){var i,r,o=(n=n||b).createElement("script");if(o.text=e,t)for(i in y)(r=t[i]||t.getAttribute&&t.getAttribute(i))&&o.setAttribute(i,r);n.head.appendChild(o).parentNode.removeChild(o)}function x(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?u[f.call(e)]||"object":typeof e}var C="3.6.1",k=function(e,t){return new k.fn.init(e,t)};function S(e){var t=!!e&&"length"in e&&e.length,n=x(e);return!_(e)&&!v(e)&&("array"===n||0===t||"number"==typeof t&&t>0&&t-1 in e)}k.fn=k.prototype={jquery:C,constructor:k,length:0,toArray:function(){return s.call(this)},get:function(e){return null==e?s.call(this):e<0?this[e+this.length]:this[e]},pushStack:function(e){var t=k.merge(this.constructor(),e);return t.prevObject=this,t},each:function(e){return k.each(this,e)},map:function(e){return this.pushStack(k.map(this,(function(t,n){return e.call(t,n,t)})))},slice:function(){return this.pushStack(s.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(k.grep(this,(function(e,t){return(t+1)%2})))},odd:function(){return this.pushStack(k.grep(this,(function(e,t){return t%2})))},eq:function(e){var t=this.length,n=+e+(e<0?t:0);return this.pushStack(n>=0&&n<t?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:c,sort:o.sort,splice:o.splice},k.extend=k.fn.extend=function(){var e,t,n,i,r,o,a=arguments[0]||{},s=1,l=arguments.length,c=!1;for("boolean"==typeof a&&(c=a,a=arguments[s]||{},s++),"object"==typeof a||_(a)||(a={}),s===l&&(a=this,s--);s<l;s++)if(null!=(e=arguments[s]))for(t in e)i=e[t],"__proto__"!==t&&a!==i&&(c&&i&&(k.isPlainObject(i)||(r=Array.isArray(i)))?(n=a[t],o=r&&!Array.isArray(n)?[]:r||k.isPlainObject(n)?n:{},r=!1,a[t]=k.extend(c,o,i)):void 0!==i&&(a[t]=i));return a},k.extend({expando:"jQuery"+(C+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isPlainObject:function(e){var t,n;return!(!e||"[object Object]"!==f.call(e)||(t=a(e))&&("function"!=typeof(n=d.call(t,"constructor")&&t.constructor)||p.call(n)!==g))},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},globalEval:function(e,t,n){w(e,{nonce:t&&t.nonce},n)},each:function(e,t){var n,i=0;if(S(e))for(n=e.length;i<n&&!1!==t.call(e[i],i,e[i]);i++);else for(i in e)if(!1===t.call(e[i],i,e[i]))break;return e},makeArray:function(e,t){var n=t||[];return null!=e&&(S(Object(e))?k.merge(n,"string"==typeof e?[e]:e):c.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:h.call(t,e,n)},merge:function(e,t){for(var n=+t.length,i=0,r=e.length;i<n;i++)e[r++]=t[i];return e.length=r,e},grep:function(e,t,n){for(var i=[],r=0,o=e.length,a=!n;r<o;r++)!t(e[r],r)!==a&&i.push(e[r]);return i},map:function(e,t,n){var i,r,o=0,a=[];if(S(e))for(i=e.length;o<i;o++)null!=(r=t(e[o],o,n))&&a.push(r);else for(o in e)null!=(r=t(e[o],o,n))&&a.push(r);return l(a)},guid:1,support:m}),"function"==typeof Symbol&&(k.fn[Symbol.iterator]=o[Symbol.iterator]),k.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),(function(e,t){u["[object "+t+"]"]=t.toLowerCase()}));var E=function(e){var t,n,i,r,o,a,s,l,c,h,u,f,d,p,g,m,_,v,b,y="sizzle"+1*new Date,w=e.document,x=0,C=0,k=le(),S=le(),E=le(),D=le(),A=function(e,t){return e===t&&(u=!0),0},M={}.hasOwnProperty,R=[],L=R.pop,T=R.push,P=R.push,z=R.slice,I=function(e,t){for(var n=0,i=e.length;n<i;n++)if(e[n]===t)return n;return-1},O="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",F="[\\x20\\t\\r\\n\\f]",B="(?:\\\\[\\da-fA-F]{1,6}[\\x20\\t\\r\\n\\f]?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",N="\\[[\\x20\\t\\r\\n\\f]*("+B+")(?:"+F+"*([*^$|!~]?=)"+F+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+B+"))|)"+F+"*\\]",H=":("+B+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+N+")*)|.*)\\)|)",U=new RegExp(F+"+","g"),$=new RegExp("^[\\x20\\t\\r\\n\\f]+|((?:^|[^\\\\])(?:\\\\.)*)[\\x20\\t\\r\\n\\f]+$","g"),j=new RegExp("^[\\x20\\t\\r\\n\\f]*,[\\x20\\t\\r\\n\\f]*"),W=new RegExp("^[\\x20\\t\\r\\n\\f]*([>+~]|[\\x20\\t\\r\\n\\f])[\\x20\\t\\r\\n\\f]*"),q=new RegExp(F+"|>"),V=new RegExp(H),K=new RegExp("^"+B+"$"),G={ID:new RegExp("^#("+B+")"),CLASS:new RegExp("^\\.("+B+")"),TAG:new RegExp("^("+B+"|[*])"),ATTR:new RegExp("^"+N),PSEUDO:new RegExp("^"+H),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\([\\x20\\t\\r\\n\\f]*(even|odd|(([+-]|)(\\d*)n|)[\\x20\\t\\r\\n\\f]*(?:([+-]|)[\\x20\\t\\r\\n\\f]*(\\d+)|))[\\x20\\t\\r\\n\\f]*\\)|)","i"),bool:new RegExp("^(?:"+O+")$","i"),needsContext:new RegExp("^[\\x20\\t\\r\\n\\f]*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\([\\x20\\t\\r\\n\\f]*((?:-\\d)?\\d*)[\\x20\\t\\r\\n\\f]*\\)|)(?=[^-]|$)","i")},Z=/HTML$/i,X=/^(?:input|select|textarea|button)$/i,Y=/^h\d$/i,Q=/^[^{]+\{\s*\[native \w/,J=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ee=/[+~]/,te=new RegExp("\\\\[\\da-fA-F]{1,6}[\\x20\\t\\r\\n\\f]?|\\\\([^\\r\\n\\f])","g"),ne=function(e,t){var n="0x"+e.slice(1)-65536;return t||(n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320))},ie=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,re=function(e,t){return t?"\0"===e?"":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e},oe=function(){f()},ae=ye((function(e){return!0===e.disabled&&"fieldset"===e.nodeName.toLowerCase()}),{dir:"parentNode",next:"legend"});try{P.apply(R=z.call(w.childNodes),w.childNodes),R[w.childNodes.length].nodeType}catch(e){P={apply:R.length?function(e,t){T.apply(e,z.call(t))}:function(e,t){for(var n=e.length,i=0;e[n++]=t[i++];);e.length=n-1}}}function se(e,t,i,r){var o,s,c,h,u,p,_,v=t&&t.ownerDocument,w=t?t.nodeType:9;if(i=i||[],"string"!=typeof e||!e||1!==w&&9!==w&&11!==w)return i;if(!r&&(f(t),t=t||d,g)){if(11!==w&&(u=J.exec(e)))if(o=u[1]){if(9===w){if(!(c=t.getElementById(o)))return i;if(c.id===o)return i.push(c),i}else if(v&&(c=v.getElementById(o))&&b(t,c)&&c.id===o)return i.push(c),i}else{if(u[2])return P.apply(i,t.getElementsByTagName(e)),i;if((o=u[3])&&n.getElementsByClassName&&t.getElementsByClassName)return P.apply(i,t.getElementsByClassName(o)),i}if(n.qsa&&!D[e+" "]&&(!m||!m.test(e))&&(1!==w||"object"!==t.nodeName.toLowerCase())){if(_=e,v=t,1===w&&(q.test(e)||W.test(e))){for((v=ee.test(e)&&_e(t.parentNode)||t)===t&&n.scope||((h=t.getAttribute("id"))?h=h.replace(ie,re):t.setAttribute("id",h=y)),s=(p=a(e)).length;s--;)p[s]=(h?"#"+h:":scope")+" "+be(p[s]);_=p.join(",")}try{return P.apply(i,v.querySelectorAll(_)),i}catch(t){D(e,!0)}finally{h===y&&t.removeAttribute("id")}}}return l(e.replace($,"$1"),t,i,r)}function le(){var e=[];return function t(n,r){return e.push(n+" ")>i.cacheLength&&delete t[e.shift()],t[n+" "]=r}}function ce(e){return e[y]=!0,e}function he(e){var t=d.createElement("fieldset");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function ue(e,t){for(var n=e.split("|"),r=n.length;r--;)i.attrHandle[n[r]]=t}function fe(e,t){var n=t&&e,i=n&&1===e.nodeType&&1===t.nodeType&&e.sourceIndex-t.sourceIndex;if(i)return i;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function de(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}function pe(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function ge(e){return function(t){return"form"in t?t.parentNode&&!1===t.disabled?"label"in t?"label"in t.parentNode?t.parentNode.disabled===e:t.disabled===e:t.isDisabled===e||t.isDisabled!==!e&&ae(t)===e:t.disabled===e:"label"in t&&t.disabled===e}}function me(e){return ce((function(t){return t=+t,ce((function(n,i){for(var r,o=e([],n.length,t),a=o.length;a--;)n[r=o[a]]&&(n[r]=!(i[r]=n[r]))}))}))}function _e(e){return e&&void 0!==e.getElementsByTagName&&e}for(t in n=se.support={},o=se.isXML=function(e){var t=e&&e.namespaceURI,n=e&&(e.ownerDocument||e).documentElement;return!Z.test(t||n&&n.nodeName||"HTML")},f=se.setDocument=function(e){var t,r,a=e?e.ownerDocument||e:w;return a!=d&&9===a.nodeType&&a.documentElement?(p=(d=a).documentElement,g=!o(d),w!=d&&(r=d.defaultView)&&r.top!==r&&(r.addEventListener?r.addEventListener("unload",oe,!1):r.attachEvent&&r.attachEvent("onunload",oe)),n.scope=he((function(e){return p.appendChild(e).appendChild(d.createElement("div")),void 0!==e.querySelectorAll&&!e.querySelectorAll(":scope fieldset div").length})),n.attributes=he((function(e){return e.className="i",!e.getAttribute("className")})),n.getElementsByTagName=he((function(e){return e.appendChild(d.createComment("")),!e.getElementsByTagName("*").length})),n.getElementsByClassName=Q.test(d.getElementsByClassName),n.getById=he((function(e){return p.appendChild(e).id=y,!d.getElementsByName||!d.getElementsByName(y).length})),n.getById?(i.filter.ID=function(e){var t=e.replace(te,ne);return function(e){return e.getAttribute("id")===t}},i.find.ID=function(e,t){if(void 0!==t.getElementById&&g){var n=t.getElementById(e);return n?[n]:[]}}):(i.filter.ID=function(e){var t=e.replace(te,ne);return function(e){var n=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return n&&n.value===t}},i.find.ID=function(e,t){if(void 0!==t.getElementById&&g){var n,i,r,o=t.getElementById(e);if(o){if((n=o.getAttributeNode("id"))&&n.value===e)return[o];for(r=t.getElementsByName(e),i=0;o=r[i++];)if((n=o.getAttributeNode("id"))&&n.value===e)return[o]}return[]}}),i.find.TAG=n.getElementsByTagName?function(e,t){return void 0!==t.getElementsByTagName?t.getElementsByTagName(e):n.qsa?t.querySelectorAll(e):void 0}:function(e,t){var n,i=[],r=0,o=t.getElementsByTagName(e);if("*"===e){for(;n=o[r++];)1===n.nodeType&&i.push(n);return i}return o},i.find.CLASS=n.getElementsByClassName&&function(e,t){if(void 0!==t.getElementsByClassName&&g)return t.getElementsByClassName(e)},_=[],m=[],(n.qsa=Q.test(d.querySelectorAll))&&(he((function(e){var t;p.appendChild(e).innerHTML="<a id='"+y+"'></a><select id='"+y+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&m.push("[*^$]=[\\x20\\t\\r\\n\\f]*(?:''|\"\")"),e.querySelectorAll("[selected]").length||m.push("\\[[\\x20\\t\\r\\n\\f]*(?:value|"+O+")"),e.querySelectorAll("[id~="+y+"-]").length||m.push("~="),(t=d.createElement("input")).setAttribute("name",""),e.appendChild(t),e.querySelectorAll("[name='']").length||m.push("\\[[\\x20\\t\\r\\n\\f]*name[\\x20\\t\\r\\n\\f]*=[\\x20\\t\\r\\n\\f]*(?:''|\"\")"),e.querySelectorAll(":checked").length||m.push(":checked"),e.querySelectorAll("a#"+y+"+*").length||m.push(".#.+[+~]"),e.querySelectorAll("\\\f"),m.push("[\\r\\n\\f]")})),he((function(e){e.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var t=d.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&m.push("name[\\x20\\t\\r\\n\\f]*[*^$|!~]?="),2!==e.querySelectorAll(":enabled").length&&m.push(":enabled",":disabled"),p.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&m.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),m.push(",.*:")}))),(n.matchesSelector=Q.test(v=p.matches||p.webkitMatchesSelector||p.mozMatchesSelector||p.oMatchesSelector||p.msMatchesSelector))&&he((function(e){n.disconnectedMatch=v.call(e,"*"),v.call(e,"[s!='']:x"),_.push("!=",H)})),m=m.length&&new RegExp(m.join("|")),_=_.length&&new RegExp(_.join("|")),t=Q.test(p.compareDocumentPosition),b=t||Q.test(p.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,i=t&&t.parentNode;return e===i||!(!i||1!==i.nodeType||!(n.contains?n.contains(i):e.compareDocumentPosition&&16&e.compareDocumentPosition(i)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},A=t?function(e,t){if(e===t)return u=!0,0;var i=!e.compareDocumentPosition-!t.compareDocumentPosition;return i||(1&(i=(e.ownerDocument||e)==(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!n.sortDetached&&t.compareDocumentPosition(e)===i?e==d||e.ownerDocument==w&&b(w,e)?-1:t==d||t.ownerDocument==w&&b(w,t)?1:h?I(h,e)-I(h,t):0:4&i?-1:1)}:function(e,t){if(e===t)return u=!0,0;var n,i=0,r=e.parentNode,o=t.parentNode,a=[e],s=[t];if(!r||!o)return e==d?-1:t==d?1:r?-1:o?1:h?I(h,e)-I(h,t):0;if(r===o)return fe(e,t);for(n=e;n=n.parentNode;)a.unshift(n);for(n=t;n=n.parentNode;)s.unshift(n);for(;a[i]===s[i];)i++;return i?fe(a[i],s[i]):a[i]==w?-1:s[i]==w?1:0},d):d},se.matches=function(e,t){return se(e,null,null,t)},se.matchesSelector=function(e,t){if(f(e),n.matchesSelector&&g&&!D[t+" "]&&(!_||!_.test(t))&&(!m||!m.test(t)))try{var i=v.call(e,t);if(i||n.disconnectedMatch||e.document&&11!==e.document.nodeType)return i}catch(e){D(t,!0)}return se(t,d,null,[e]).length>0},se.contains=function(e,t){return(e.ownerDocument||e)!=d&&f(e),b(e,t)},se.attr=function(e,t){(e.ownerDocument||e)!=d&&f(e);var r=i.attrHandle[t.toLowerCase()],o=r&&M.call(i.attrHandle,t.toLowerCase())?r(e,t,!g):void 0;return void 0!==o?o:n.attributes||!g?e.getAttribute(t):(o=e.getAttributeNode(t))&&o.specified?o.value:null},se.escape=function(e){return(e+"").replace(ie,re)},se.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},se.uniqueSort=function(e){var t,i=[],r=0,o=0;if(u=!n.detectDuplicates,h=!n.sortStable&&e.slice(0),e.sort(A),u){for(;t=e[o++];)t===e[o]&&(r=i.push(o));for(;r--;)e.splice(i[r],1)}return h=null,e},r=se.getText=function(e){var t,n="",i=0,o=e.nodeType;if(o){if(1===o||9===o||11===o){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=r(e)}else if(3===o||4===o)return e.nodeValue}else for(;t=e[i++];)n+=r(t);return n},i=se.selectors={cacheLength:50,createPseudo:ce,match:G,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(te,ne),e[3]=(e[3]||e[4]||e[5]||"").replace(te,ne),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||se.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&se.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return G.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&V.test(n)&&(t=a(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(te,ne).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=k[e+" "];return t||(t=new RegExp("(^|[\\x20\\t\\r\\n\\f])"+e+"("+F+"|$)"))&&k(e,(function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")}))},ATTR:function(e,t,n){return function(i){var r=se.attr(i,e);return null==r?"!="===t:!t||(r+="","="===t?r===n:"!="===t?r!==n:"^="===t?n&&0===r.indexOf(n):"*="===t?n&&r.indexOf(n)>-1:"$="===t?n&&r.slice(-n.length)===n:"~="===t?(" "+r.replace(U," ")+" ").indexOf(n)>-1:"|="===t&&(r===n||r.slice(0,n.length+1)===n+"-"))}},CHILD:function(e,t,n,i,r){var o="nth"!==e.slice(0,3),a="last"!==e.slice(-4),s="of-type"===t;return 1===i&&0===r?function(e){return!!e.parentNode}:function(t,n,l){var c,h,u,f,d,p,g=o!==a?"nextSibling":"previousSibling",m=t.parentNode,_=s&&t.nodeName.toLowerCase(),v=!l&&!s,b=!1;if(m){if(o){for(;g;){for(f=t;f=f[g];)if(s?f.nodeName.toLowerCase()===_:1===f.nodeType)return!1;p=g="only"===e&&!p&&"nextSibling"}return!0}if(p=[a?m.firstChild:m.lastChild],a&&v){for(b=(d=(c=(h=(u=(f=m)[y]||(f[y]={}))[f.uniqueID]||(u[f.uniqueID]={}))[e]||[])[0]===x&&c[1])&&c[2],f=d&&m.childNodes[d];f=++d&&f&&f[g]||(b=d=0)||p.pop();)if(1===f.nodeType&&++b&&f===t){h[e]=[x,d,b];break}}else if(v&&(b=d=(c=(h=(u=(f=t)[y]||(f[y]={}))[f.uniqueID]||(u[f.uniqueID]={}))[e]||[])[0]===x&&c[1]),!1===b)for(;(f=++d&&f&&f[g]||(b=d=0)||p.pop())&&((s?f.nodeName.toLowerCase()!==_:1!==f.nodeType)||!++b||(v&&((h=(u=f[y]||(f[y]={}))[f.uniqueID]||(u[f.uniqueID]={}))[e]=[x,b]),f!==t)););return(b-=r)===i||b%i==0&&b/i>=0}}},PSEUDO:function(e,t){var n,r=i.pseudos[e]||i.setFilters[e.toLowerCase()]||se.error("unsupported pseudo: "+e);return r[y]?r(t):r.length>1?(n=[e,e,"",t],i.setFilters.hasOwnProperty(e.toLowerCase())?ce((function(e,n){for(var i,o=r(e,t),a=o.length;a--;)e[i=I(e,o[a])]=!(n[i]=o[a])})):function(e){return r(e,0,n)}):r}},pseudos:{not:ce((function(e){var t=[],n=[],i=s(e.replace($,"$1"));return i[y]?ce((function(e,t,n,r){for(var o,a=i(e,null,r,[]),s=e.length;s--;)(o=a[s])&&(e[s]=!(t[s]=o))})):function(e,r,o){return t[0]=e,i(t,null,o,n),t[0]=null,!n.pop()}})),has:ce((function(e){return function(t){return se(e,t).length>0}})),contains:ce((function(e){return e=e.replace(te,ne),function(t){return(t.textContent||r(t)).indexOf(e)>-1}})),lang:ce((function(e){return K.test(e||"")||se.error("unsupported lang: "+e),e=e.replace(te,ne).toLowerCase(),function(t){var n;do{if(n=g?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(n=n.toLowerCase())===e||0===n.indexOf(e+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}})),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===p},focus:function(e){return e===d.activeElement&&(!d.hasFocus||d.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:ge(!1),disabled:ge(!0),checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!i.pseudos.empty(e)},header:function(e){return Y.test(e.nodeName)},input:function(e){return X.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:me((function(){return[0]})),last:me((function(e,t){return[t-1]})),eq:me((function(e,t,n){return[n<0?n+t:n]})),even:me((function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e})),odd:me((function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e})),lt:me((function(e,t,n){for(var i=n<0?n+t:n>t?t:n;--i>=0;)e.push(i);return e})),gt:me((function(e,t,n){for(var i=n<0?n+t:n;++i<t;)e.push(i);return e}))}},i.pseudos.nth=i.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})i.pseudos[t]=de(t);for(t in{submit:!0,reset:!0})i.pseudos[t]=pe(t);function ve(){}function be(e){for(var t=0,n=e.length,i="";t<n;t++)i+=e[t].value;return i}function ye(e,t,n){var i=t.dir,r=t.next,o=r||i,a=n&&"parentNode"===o,s=C++;return t.first?function(t,n,r){for(;t=t[i];)if(1===t.nodeType||a)return e(t,n,r);return!1}:function(t,n,l){var c,h,u,f=[x,s];if(l){for(;t=t[i];)if((1===t.nodeType||a)&&e(t,n,l))return!0}else for(;t=t[i];)if(1===t.nodeType||a)if(h=(u=t[y]||(t[y]={}))[t.uniqueID]||(u[t.uniqueID]={}),r&&r===t.nodeName.toLowerCase())t=t[i]||t;else{if((c=h[o])&&c[0]===x&&c[1]===s)return f[2]=c[2];if(h[o]=f,f[2]=e(t,n,l))return!0}return!1}}function we(e){return e.length>1?function(t,n,i){for(var r=e.length;r--;)if(!e[r](t,n,i))return!1;return!0}:e[0]}function xe(e,t,n,i,r){for(var o,a=[],s=0,l=e.length,c=null!=t;s<l;s++)(o=e[s])&&(n&&!n(o,i,r)||(a.push(o),c&&t.push(s)));return a}function Ce(e,t,n,i,r,o){return i&&!i[y]&&(i=Ce(i)),r&&!r[y]&&(r=Ce(r,o)),ce((function(o,a,s,l){var c,h,u,f=[],d=[],p=a.length,g=o||function(e,t,n){for(var i=0,r=t.length;i<r;i++)se(e,t[i],n);return n}(t||"*",s.nodeType?[s]:s,[]),m=!e||!o&&t?g:xe(g,f,e,s,l),_=n?r||(o?e:p||i)?[]:a:m;if(n&&n(m,_,s,l),i)for(c=xe(_,d),i(c,[],s,l),h=c.length;h--;)(u=c[h])&&(_[d[h]]=!(m[d[h]]=u));if(o){if(r||e){if(r){for(c=[],h=_.length;h--;)(u=_[h])&&c.push(m[h]=u);r(null,_=[],c,l)}for(h=_.length;h--;)(u=_[h])&&(c=r?I(o,u):f[h])>-1&&(o[c]=!(a[c]=u))}}else _=xe(_===a?_.splice(p,_.length):_),r?r(null,a,_,l):P.apply(a,_)}))}function ke(e){for(var t,n,r,o=e.length,a=i.relative[e[0].type],s=a||i.relative[" "],l=a?1:0,h=ye((function(e){return e===t}),s,!0),u=ye((function(e){return I(t,e)>-1}),s,!0),f=[function(e,n,i){var r=!a&&(i||n!==c)||((t=n).nodeType?h(e,n,i):u(e,n,i));return t=null,r}];l<o;l++)if(n=i.relative[e[l].type])f=[ye(we(f),n)];else{if((n=i.filter[e[l].type].apply(null,e[l].matches))[y]){for(r=++l;r<o&&!i.relative[e[r].type];r++);return Ce(l>1&&we(f),l>1&&be(e.slice(0,l-1).concat({value:" "===e[l-2].type?"*":""})).replace($,"$1"),n,l<r&&ke(e.slice(l,r)),r<o&&ke(e=e.slice(r)),r<o&&be(e))}f.push(n)}return we(f)}return ve.prototype=i.filters=i.pseudos,i.setFilters=new ve,a=se.tokenize=function(e,t){var n,r,o,a,s,l,c,h=S[e+" "];if(h)return t?0:h.slice(0);for(s=e,l=[],c=i.preFilter;s;){for(a in n&&!(r=j.exec(s))||(r&&(s=s.slice(r[0].length)||s),l.push(o=[])),n=!1,(r=W.exec(s))&&(n=r.shift(),o.push({value:n,type:r[0].replace($," ")}),s=s.slice(n.length)),i.filter)!(r=G[a].exec(s))||c[a]&&!(r=c[a](r))||(n=r.shift(),o.push({value:n,type:a,matches:r}),s=s.slice(n.length));if(!n)break}return t?s.length:s?se.error(e):S(e,l).slice(0)},s=se.compile=function(e,t){var n,r=[],o=[],s=E[e+" "];if(!s){for(t||(t=a(e)),n=t.length;n--;)(s=ke(t[n]))[y]?r.push(s):o.push(s);s=E(e,function(e,t){var n=t.length>0,r=e.length>0,o=function(o,a,s,l,h){var u,p,m,_=0,v="0",b=o&&[],y=[],w=c,C=o||r&&i.find.TAG("*",h),k=x+=null==w?1:Math.random()||.1,S=C.length;for(h&&(c=a==d||a||h);v!==S&&null!=(u=C[v]);v++){if(r&&u){for(p=0,a||u.ownerDocument==d||(f(u),s=!g);m=e[p++];)if(m(u,a||d,s)){l.push(u);break}h&&(x=k)}n&&((u=!m&&u)&&_--,o&&b.push(u))}if(_+=v,n&&v!==_){for(p=0;m=t[p++];)m(b,y,a,s);if(o){if(_>0)for(;v--;)b[v]||y[v]||(y[v]=L.call(l));y=xe(y)}P.apply(l,y),h&&!o&&y.length>0&&_+t.length>1&&se.uniqueSort(l)}return h&&(x=k,c=w),b};return n?ce(o):o}(o,r)),s.selector=e}return s},l=se.select=function(e,t,n,r){var o,l,c,h,u,f="function"==typeof e&&e,d=!r&&a(e=f.selector||e);if(n=n||[],1===d.length){if((l=d[0]=d[0].slice(0)).length>2&&"ID"===(c=l[0]).type&&9===t.nodeType&&g&&i.relative[l[1].type]){if(!(t=(i.find.ID(c.matches[0].replace(te,ne),t)||[])[0]))return n;f&&(t=t.parentNode),e=e.slice(l.shift().value.length)}for(o=G.needsContext.test(e)?0:l.length;o--&&(c=l[o],!i.relative[h=c.type]);)if((u=i.find[h])&&(r=u(c.matches[0].replace(te,ne),ee.test(l[0].type)&&_e(t.parentNode)||t))){if(l.splice(o,1),!(e=r.length&&be(l)))return P.apply(n,r),n;break}}return(f||s(e,d))(r,t,!g,n,!t||ee.test(e)&&_e(t.parentNode)||t),n},n.sortStable=y.split("").sort(A).join("")===y,n.detectDuplicates=!!u,f(),n.sortDetached=he((function(e){return 1&e.compareDocumentPosition(d.createElement("fieldset"))})),he((function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")}))||ue("type|href|height|width",(function(e,t,n){if(!n)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)})),n.attributes&&he((function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")}))||ue("value",(function(e,t,n){if(!n&&"input"===e.nodeName.toLowerCase())return e.defaultValue})),he((function(e){return null==e.getAttribute("disabled")}))||ue(O,(function(e,t,n){var i;if(!n)return!0===e[t]?t.toLowerCase():(i=e.getAttributeNode(t))&&i.specified?i.value:null})),se}(i);k.find=E,k.expr=E.selectors,k.expr[":"]=k.expr.pseudos,k.uniqueSort=k.unique=E.uniqueSort,k.text=E.getText,k.isXMLDoc=E.isXML,k.contains=E.contains,k.escapeSelector=E.escape;var D=function(e,t,n){for(var i=[],r=void 0!==n;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(r&&k(e).is(n))break;i.push(e)}return i},A=function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n},M=k.expr.match.needsContext;function R(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}var L=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function T(e,t,n){return _(t)?k.grep(e,(function(e,i){return!!t.call(e,i,e)!==n})):t.nodeType?k.grep(e,(function(e){return e===t!==n})):"string"!=typeof t?k.grep(e,(function(e){return h.call(t,e)>-1!==n})):k.filter(t,e,n)}k.filter=function(e,t,n){var i=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===i.nodeType?k.find.matchesSelector(i,e)?[i]:[]:k.find.matches(e,k.grep(t,(function(e){return 1===e.nodeType})))},k.fn.extend({find:function(e){var t,n,i=this.length,r=this;if("string"!=typeof e)return this.pushStack(k(e).filter((function(){for(t=0;t<i;t++)if(k.contains(r[t],this))return!0})));for(n=this.pushStack([]),t=0;t<i;t++)k.find(e,r[t],n);return i>1?k.uniqueSort(n):n},filter:function(e){return this.pushStack(T(this,e||[],!1))},not:function(e){return this.pushStack(T(this,e||[],!0))},is:function(e){return!!T(this,"string"==typeof e&&M.test(e)?k(e):e||[],!1).length}});var P,z=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(k.fn.init=function(e,t,n){var i,r;if(!e)return this;if(n=n||P,"string"==typeof e){if(!(i="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:z.exec(e))||!i[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(i[1]){if(t=t instanceof k?t[0]:t,k.merge(this,k.parseHTML(i[1],t&&t.nodeType?t.ownerDocument||t:b,!0)),L.test(i[1])&&k.isPlainObject(t))for(i in t)_(this[i])?this[i](t[i]):this.attr(i,t[i]);return this}return(r=b.getElementById(i[2]))&&(this[0]=r,this.length=1),this}return e.nodeType?(this[0]=e,this.length=1,this):_(e)?void 0!==n.ready?n.ready(e):e(k):k.makeArray(e,this)}).prototype=k.fn,P=k(b);var I=/^(?:parents|prev(?:Until|All))/,O={children:!0,contents:!0,next:!0,prev:!0};function F(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}k.fn.extend({has:function(e){var t=k(e,this),n=t.length;return this.filter((function(){for(var e=0;e<n;e++)if(k.contains(this,t[e]))return!0}))},closest:function(e,t){var n,i=0,r=this.length,o=[],a="string"!=typeof e&&k(e);if(!M.test(e))for(;i<r;i++)for(n=this[i];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(a?a.index(n)>-1:1===n.nodeType&&k.find.matchesSelector(n,e))){o.push(n);break}return this.pushStack(o.length>1?k.uniqueSort(o):o)},index:function(e){return e?"string"==typeof e?h.call(k(e),this[0]):h.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(k.uniqueSort(k.merge(this.get(),k(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),k.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return D(e,"parentNode")},parentsUntil:function(e,t,n){return D(e,"parentNode",n)},next:function(e){return F(e,"nextSibling")},prev:function(e){return F(e,"previousSibling")},nextAll:function(e){return D(e,"nextSibling")},prevAll:function(e){return D(e,"previousSibling")},nextUntil:function(e,t,n){return D(e,"nextSibling",n)},prevUntil:function(e,t,n){return D(e,"previousSibling",n)},siblings:function(e){return A((e.parentNode||{}).firstChild,e)},children:function(e){return A(e.firstChild)},contents:function(e){return null!=e.contentDocument&&a(e.contentDocument)?e.contentDocument:(R(e,"template")&&(e=e.content||e),k.merge([],e.childNodes))}},(function(e,t){k.fn[e]=function(n,i){var r=k.map(this,t,n);return"Until"!==e.slice(-5)&&(i=n),i&&"string"==typeof i&&(r=k.filter(i,r)),this.length>1&&(O[e]||k.uniqueSort(r),I.test(e)&&r.reverse()),this.pushStack(r)}}));var B=/[^\x20\t\r\n\f]+/g;function N(e){return e}function H(e){throw e}function U(e,t,n,i){var r;try{e&&_(r=e.promise)?r.call(e).done(t).fail(n):e&&_(r=e.then)?r.call(e,t,n):t.apply(void 0,[e].slice(i))}catch(e){n.apply(void 0,[e])}}k.Callbacks=function(e){e="string"==typeof e?function(e){var t={};return k.each(e.match(B)||[],(function(e,n){t[n]=!0})),t}(e):k.extend({},e);var t,n,i,r,o=[],a=[],s=-1,l=function(){for(r=r||e.once,i=t=!0;a.length;s=-1)for(n=a.shift();++s<o.length;)!1===o[s].apply(n[0],n[1])&&e.stopOnFalse&&(s=o.length,n=!1);e.memory||(n=!1),t=!1,r&&(o=n?[]:"")},c={add:function(){return o&&(n&&!t&&(s=o.length-1,a.push(n)),function t(n){k.each(n,(function(n,i){_(i)?e.unique&&c.has(i)||o.push(i):i&&i.length&&"string"!==x(i)&&t(i)}))}(arguments),n&&!t&&l()),this},remove:function(){return k.each(arguments,(function(e,t){for(var n;(n=k.inArray(t,o,n))>-1;)o.splice(n,1),n<=s&&s--})),this},has:function(e){return e?k.inArray(e,o)>-1:o.length>0},empty:function(){return o&&(o=[]),this},disable:function(){return r=a=[],o=n="",this},disabled:function(){return!o},lock:function(){return r=a=[],n||t||(o=n=""),this},locked:function(){return!!r},fireWith:function(e,n){return r||(n=[e,(n=n||[]).slice?n.slice():n],a.push(n),t||l()),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!i}};return c},k.extend({Deferred:function(e){var t=[["notify","progress",k.Callbacks("memory"),k.Callbacks("memory"),2],["resolve","done",k.Callbacks("once memory"),k.Callbacks("once memory"),0,"resolved"],["reject","fail",k.Callbacks("once memory"),k.Callbacks("once memory"),1,"rejected"]],n="pending",r={state:function(){return n},always:function(){return o.done(arguments).fail(arguments),this},catch:function(e){return r.then(null,e)},pipe:function(){var e=arguments;return k.Deferred((function(n){k.each(t,(function(t,i){var r=_(e[i[4]])&&e[i[4]];o[i[1]]((function(){var e=r&&r.apply(this,arguments);e&&_(e.promise)?e.promise().progress(n.notify).done(n.resolve).fail(n.reject):n[i[0]+"With"](this,r?[e]:arguments)}))})),e=null})).promise()},then:function(e,n,r){var o=0;function a(e,t,n,r){return function(){var s=this,l=arguments,c=function(){var i,c;if(!(e<o)){if((i=n.apply(s,l))===t.promise())throw new TypeError("Thenable self-resolution");c=i&&("object"==typeof i||"function"==typeof i)&&i.then,_(c)?r?c.call(i,a(o,t,N,r),a(o,t,H,r)):(o++,c.call(i,a(o,t,N,r),a(o,t,H,r),a(o,t,N,t.notifyWith))):(n!==N&&(s=void 0,l=[i]),(r||t.resolveWith)(s,l))}},h=r?c:function(){try{c()}catch(i){k.Deferred.exceptionHook&&k.Deferred.exceptionHook(i,h.stackTrace),e+1>=o&&(n!==H&&(s=void 0,l=[i]),t.rejectWith(s,l))}};e?h():(k.Deferred.getStackHook&&(h.stackTrace=k.Deferred.getStackHook()),i.setTimeout(h))}}return k.Deferred((function(i){t[0][3].add(a(0,i,_(r)?r:N,i.notifyWith)),t[1][3].add(a(0,i,_(e)?e:N)),t[2][3].add(a(0,i,_(n)?n:H))})).promise()},promise:function(e){return null!=e?k.extend(e,r):r}},o={};return k.each(t,(function(e,i){var a=i[2],s=i[5];r[i[1]]=a.add,s&&a.add((function(){n=s}),t[3-e][2].disable,t[3-e][3].disable,t[0][2].lock,t[0][3].lock),a.add(i[3].fire),o[i[0]]=function(){return o[i[0]+"With"](this===o?void 0:this,arguments),this},o[i[0]+"With"]=a.fireWith})),r.promise(o),e&&e.call(o,o),o},when:function(e){var t=arguments.length,n=t,i=Array(n),r=s.call(arguments),o=k.Deferred(),a=function(e){return function(n){i[e]=this,r[e]=arguments.length>1?s.call(arguments):n,--t||o.resolveWith(i,r)}};if(t<=1&&(U(e,o.done(a(n)).resolve,o.reject,!t),"pending"===o.state()||_(r[n]&&r[n].then)))return o.then();for(;n--;)U(r[n],a(n),o.reject);return o.promise()}});var $=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;k.Deferred.exceptionHook=function(e,t){i.console&&i.console.warn&&e&&$.test(e.name)&&i.console.warn("jQuery.Deferred exception: "+e.message,e.stack,t)},k.readyException=function(e){i.setTimeout((function(){throw e}))};var j=k.Deferred();function W(){b.removeEventListener("DOMContentLoaded",W),i.removeEventListener("load",W),k.ready()}k.fn.ready=function(e){return j.then(e).catch((function(e){k.readyException(e)})),this},k.extend({isReady:!1,readyWait:1,ready:function(e){(!0===e?--k.readyWait:k.isReady)||(k.isReady=!0,!0!==e&&--k.readyWait>0||j.resolveWith(b,[k]))}}),k.ready.then=j.then,"complete"===b.readyState||"loading"!==b.readyState&&!b.documentElement.doScroll?i.setTimeout(k.ready):(b.addEventListener("DOMContentLoaded",W),i.addEventListener("load",W));var q=function(e,t,n,i,r,o,a){var s=0,l=e.length,c=null==n;if("object"===x(n))for(s in r=!0,n)q(e,t,s,n[s],!0,o,a);else if(void 0!==i&&(r=!0,_(i)||(a=!0),c&&(a?(t.call(e,i),t=null):(c=t,t=function(e,t,n){return c.call(k(e),n)})),t))for(;s<l;s++)t(e[s],n,a?i:i.call(e[s],s,t(e[s],n)));return r?e:c?t.call(e):l?t(e[0],n):o},V=/^-ms-/,K=/-([a-z])/g;function G(e,t){return t.toUpperCase()}function Z(e){return e.replace(V,"ms-").replace(K,G)}var X=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};function Y(){this.expando=k.expando+Y.uid++}Y.uid=1,Y.prototype={cache:function(e){var t=e[this.expando];return t||(t={},X(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,n){var i,r=this.cache(e);if("string"==typeof t)r[Z(t)]=n;else for(i in t)r[Z(i)]=t[i];return r},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][Z(t)]},access:function(e,t,n){return void 0===t||t&&"string"==typeof t&&void 0===n?this.get(e,t):(this.set(e,t,n),void 0!==n?n:t)},remove:function(e,t){var n,i=e[this.expando];if(void 0!==i){if(void 0!==t){n=(t=Array.isArray(t)?t.map(Z):(t=Z(t))in i?[t]:t.match(B)||[]).length;for(;n--;)delete i[t[n]]}(void 0===t||k.isEmptyObject(i))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return void 0!==t&&!k.isEmptyObject(t)}};var Q=new Y,J=new Y,ee=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,te=/[A-Z]/g;function ne(e,t,n){var i;if(void 0===n&&1===e.nodeType)if(i="data-"+t.replace(te,"-$&").toLowerCase(),"string"==typeof(n=e.getAttribute(i))){try{n=function(e){return"true"===e||"false"!==e&&("null"===e?null:e===+e+""?+e:ee.test(e)?JSON.parse(e):e)}(n)}catch(e){}J.set(e,t,n)}else n=void 0;return n}k.extend({hasData:function(e){return J.hasData(e)||Q.hasData(e)},data:function(e,t,n){return J.access(e,t,n)},removeData:function(e,t){J.remove(e,t)},_data:function(e,t,n){return Q.access(e,t,n)},_removeData:function(e,t){Q.remove(e,t)}}),k.fn.extend({data:function(e,t){var n,i,r,o=this[0],a=o&&o.attributes;if(void 0===e){if(this.length&&(r=J.get(o),1===o.nodeType&&!Q.get(o,"hasDataAttrs"))){for(n=a.length;n--;)a[n]&&0===(i=a[n].name).indexOf("data-")&&(i=Z(i.slice(5)),ne(o,i,r[i]));Q.set(o,"hasDataAttrs",!0)}return r}return"object"==typeof e?this.each((function(){J.set(this,e)})):q(this,(function(t){var n;if(o&&void 0===t)return void 0!==(n=J.get(o,e))||void 0!==(n=ne(o,e))?n:void 0;this.each((function(){J.set(this,e,t)}))}),null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each((function(){J.remove(this,e)}))}}),k.extend({queue:function(e,t,n){var i;if(e)return t=(t||"fx")+"queue",i=Q.get(e,t),n&&(!i||Array.isArray(n)?i=Q.access(e,t,k.makeArray(n)):i.push(n)),i||[]},dequeue:function(e,t){t=t||"fx";var n=k.queue(e,t),i=n.length,r=n.shift(),o=k._queueHooks(e,t);"inprogress"===r&&(r=n.shift(),i--),r&&("fx"===t&&n.unshift("inprogress"),delete o.stop,r.call(e,(function(){k.dequeue(e,t)}),o)),!i&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return Q.get(e,n)||Q.access(e,n,{empty:k.Callbacks("once memory").add((function(){Q.remove(e,[t+"queue",n])}))})}}),k.fn.extend({queue:function(e,t){var n=2;return"string"!=typeof e&&(t=e,e="fx",n--),arguments.length<n?k.queue(this[0],e):void 0===t?this:this.each((function(){var n=k.queue(this,e,t);k._queueHooks(this,e),"fx"===e&&"inprogress"!==n[0]&&k.dequeue(this,e)}))},dequeue:function(e){return this.each((function(){k.dequeue(this,e)}))},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,i=1,r=k.Deferred(),o=this,a=this.length,s=function(){--i||r.resolveWith(o,[o])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";a--;)(n=Q.get(o[a],e+"queueHooks"))&&n.empty&&(i++,n.empty.add(s));return s(),r.promise(t)}});var ie=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,re=new RegExp("^(?:([+-])=|)("+ie+")([a-z%]*)$","i"),oe=["Top","Right","Bottom","Left"],ae=b.documentElement,se=function(e){return k.contains(e.ownerDocument,e)},le={composed:!0};ae.getRootNode&&(se=function(e){return k.contains(e.ownerDocument,e)||e.getRootNode(le)===e.ownerDocument});var ce=function(e,t){return"none"===(e=t||e).style.display||""===e.style.display&&se(e)&&"none"===k.css(e,"display")};function he(e,t,n,i){var r,o,a=20,s=i?function(){return i.cur()}:function(){return k.css(e,t,"")},l=s(),c=n&&n[3]||(k.cssNumber[t]?"":"px"),h=e.nodeType&&(k.cssNumber[t]||"px"!==c&&+l)&&re.exec(k.css(e,t));if(h&&h[3]!==c){for(l/=2,c=c||h[3],h=+l||1;a--;)k.style(e,t,h+c),(1-o)*(1-(o=s()/l||.5))<=0&&(a=0),h/=o;h*=2,k.style(e,t,h+c),n=n||[]}return n&&(h=+h||+l||0,r=n[1]?h+(n[1]+1)*n[2]:+n[2],i&&(i.unit=c,i.start=h,i.end=r)),r}var ue={};function fe(e){var t,n=e.ownerDocument,i=e.nodeName,r=ue[i];return r||(t=n.body.appendChild(n.createElement(i)),r=k.css(t,"display"),t.parentNode.removeChild(t),"none"===r&&(r="block"),ue[i]=r,r)}function de(e,t){for(var n,i,r=[],o=0,a=e.length;o<a;o++)(i=e[o]).style&&(n=i.style.display,t?("none"===n&&(r[o]=Q.get(i,"display")||null,r[o]||(i.style.display="")),""===i.style.display&&ce(i)&&(r[o]=fe(i))):"none"!==n&&(r[o]="none",Q.set(i,"display",n)));for(o=0;o<a;o++)null!=r[o]&&(e[o].style.display=r[o]);return e}k.fn.extend({show:function(){return de(this,!0)},hide:function(){return de(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each((function(){ce(this)?k(this).show():k(this).hide()}))}});var pe,ge,me=/^(?:checkbox|radio)$/i,_e=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,ve=/^$|^module$|\/(?:java|ecma)script/i;pe=b.createDocumentFragment().appendChild(b.createElement("div")),(ge=b.createElement("input")).setAttribute("type","radio"),ge.setAttribute("checked","checked"),ge.setAttribute("name","t"),pe.appendChild(ge),m.checkClone=pe.cloneNode(!0).cloneNode(!0).lastChild.checked,pe.innerHTML="<textarea>x</textarea>",m.noCloneChecked=!!pe.cloneNode(!0).lastChild.defaultValue,pe.innerHTML="<option></option>",m.option=!!pe.lastChild;var be={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function ye(e,t){var n;return n=void 0!==e.getElementsByTagName?e.getElementsByTagName(t||"*"):void 0!==e.querySelectorAll?e.querySelectorAll(t||"*"):[],void 0===t||t&&R(e,t)?k.merge([e],n):n}function we(e,t){for(var n=0,i=e.length;n<i;n++)Q.set(e[n],"globalEval",!t||Q.get(t[n],"globalEval"))}be.tbody=be.tfoot=be.colgroup=be.caption=be.thead,be.th=be.td,m.option||(be.optgroup=be.option=[1,"<select multiple='multiple'>","</select>"]);var xe=/<|&#?\w+;/;function Ce(e,t,n,i,r){for(var o,a,s,l,c,h,u=t.createDocumentFragment(),f=[],d=0,p=e.length;d<p;d++)if((o=e[d])||0===o)if("object"===x(o))k.merge(f,o.nodeType?[o]:o);else if(xe.test(o)){for(a=a||u.appendChild(t.createElement("div")),s=(_e.exec(o)||["",""])[1].toLowerCase(),l=be[s]||be._default,a.innerHTML=l[1]+k.htmlPrefilter(o)+l[2],h=l[0];h--;)a=a.lastChild;k.merge(f,a.childNodes),(a=u.firstChild).textContent=""}else f.push(t.createTextNode(o));for(u.textContent="",d=0;o=f[d++];)if(i&&k.inArray(o,i)>-1)r&&r.push(o);else if(c=se(o),a=ye(u.appendChild(o),"script"),c&&we(a),n)for(h=0;o=a[h++];)ve.test(o.type||"")&&n.push(o);return u}var ke=/^([^.]*)(?:\.(.+)|)/;function Se(){return!0}function Ee(){return!1}function De(e,t){return e===function(){try{return b.activeElement}catch(e){}}()==("focus"===t)}function Ae(e,t,n,i,r,o){var a,s;if("object"==typeof t){for(s in"string"!=typeof n&&(i=i||n,n=void 0),t)Ae(e,s,n,i,t[s],o);return e}if(null==i&&null==r?(r=n,i=n=void 0):null==r&&("string"==typeof n?(r=i,i=void 0):(r=i,i=n,n=void 0)),!1===r)r=Ee;else if(!r)return e;return 1===o&&(a=r,r=function(e){return k().off(e),a.apply(this,arguments)},r.guid=a.guid||(a.guid=k.guid++)),e.each((function(){k.event.add(this,t,r,i,n)}))}function Me(e,t,n){n?(Q.set(e,t,!1),k.event.add(e,t,{namespace:!1,handler:function(e){var i,r,o=Q.get(this,t);if(1&e.isTrigger&&this[t]){if(o.length)(k.event.special[t]||{}).delegateType&&e.stopPropagation();else if(o=s.call(arguments),Q.set(this,t,o),i=n(this,t),this[t](),o!==(r=Q.get(this,t))||i?Q.set(this,t,!1):r={},o!==r)return e.stopImmediatePropagation(),e.preventDefault(),r&&r.value}else o.length&&(Q.set(this,t,{value:k.event.trigger(k.extend(o[0],k.Event.prototype),o.slice(1),this)}),e.stopImmediatePropagation())}})):void 0===Q.get(e,t)&&k.event.add(e,t,Se)}k.event={global:{},add:function(e,t,n,i,r){var o,a,s,l,c,h,u,f,d,p,g,m=Q.get(e);if(X(e))for(n.handler&&(n=(o=n).handler,r=o.selector),r&&k.find.matchesSelector(ae,r),n.guid||(n.guid=k.guid++),(l=m.events)||(l=m.events=Object.create(null)),(a=m.handle)||(a=m.handle=function(t){return void 0!==k&&k.event.triggered!==t.type?k.event.dispatch.apply(e,arguments):void 0}),c=(t=(t||"").match(B)||[""]).length;c--;)d=g=(s=ke.exec(t[c])||[])[1],p=(s[2]||"").split(".").sort(),d&&(u=k.event.special[d]||{},d=(r?u.delegateType:u.bindType)||d,u=k.event.special[d]||{},h=k.extend({type:d,origType:g,data:i,handler:n,guid:n.guid,selector:r,needsContext:r&&k.expr.match.needsContext.test(r),namespace:p.join(".")},o),(f=l[d])||((f=l[d]=[]).delegateCount=0,u.setup&&!1!==u.setup.call(e,i,p,a)||e.addEventListener&&e.addEventListener(d,a)),u.add&&(u.add.call(e,h),h.handler.guid||(h.handler.guid=n.guid)),r?f.splice(f.delegateCount++,0,h):f.push(h),k.event.global[d]=!0)},remove:function(e,t,n,i,r){var o,a,s,l,c,h,u,f,d,p,g,m=Q.hasData(e)&&Q.get(e);if(m&&(l=m.events)){for(c=(t=(t||"").match(B)||[""]).length;c--;)if(d=g=(s=ke.exec(t[c])||[])[1],p=(s[2]||"").split(".").sort(),d){for(u=k.event.special[d]||{},f=l[d=(i?u.delegateType:u.bindType)||d]||[],s=s[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=o=f.length;o--;)h=f[o],!r&&g!==h.origType||n&&n.guid!==h.guid||s&&!s.test(h.namespace)||i&&i!==h.selector&&("**"!==i||!h.selector)||(f.splice(o,1),h.selector&&f.delegateCount--,u.remove&&u.remove.call(e,h));a&&!f.length&&(u.teardown&&!1!==u.teardown.call(e,p,m.handle)||k.removeEvent(e,d,m.handle),delete l[d])}else for(d in l)k.event.remove(e,d+t[c],n,i,!0);k.isEmptyObject(l)&&Q.remove(e,"handle events")}},dispatch:function(e){var t,n,i,r,o,a,s=new Array(arguments.length),l=k.event.fix(e),c=(Q.get(this,"events")||Object.create(null))[l.type]||[],h=k.event.special[l.type]||{};for(s[0]=l,t=1;t<arguments.length;t++)s[t]=arguments[t];if(l.delegateTarget=this,!h.preDispatch||!1!==h.preDispatch.call(this,l)){for(a=k.event.handlers.call(this,l,c),t=0;(r=a[t++])&&!l.isPropagationStopped();)for(l.currentTarget=r.elem,n=0;(o=r.handlers[n++])&&!l.isImmediatePropagationStopped();)l.rnamespace&&!1!==o.namespace&&!l.rnamespace.test(o.namespace)||(l.handleObj=o,l.data=o.data,void 0!==(i=((k.event.special[o.origType]||{}).handle||o.handler).apply(r.elem,s))&&!1===(l.result=i)&&(l.preventDefault(),l.stopPropagation()));return h.postDispatch&&h.postDispatch.call(this,l),l.result}},handlers:function(e,t){var n,i,r,o,a,s=[],l=t.delegateCount,c=e.target;if(l&&c.nodeType&&!("click"===e.type&&e.button>=1))for(;c!==this;c=c.parentNode||this)if(1===c.nodeType&&("click"!==e.type||!0!==c.disabled)){for(o=[],a={},n=0;n<l;n++)void 0===a[r=(i=t[n]).selector+" "]&&(a[r]=i.needsContext?k(r,this).index(c)>-1:k.find(r,this,null,[c]).length),a[r]&&o.push(i);o.length&&s.push({elem:c,handlers:o})}return c=this,l<t.length&&s.push({elem:c,handlers:t.slice(l)}),s},addProp:function(e,t){Object.defineProperty(k.Event.prototype,e,{enumerable:!0,configurable:!0,get:_(t)?function(){if(this.originalEvent)return t(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[e]},set:function(t){Object.defineProperty(this,e,{enumerable:!0,configurable:!0,writable:!0,value:t})}})},fix:function(e){return e[k.expando]?e:new k.Event(e)},special:{load:{noBubble:!0},click:{setup:function(e){var t=this||e;return me.test(t.type)&&t.click&&R(t,"input")&&Me(t,"click",Se),!1},trigger:function(e){var t=this||e;return me.test(t.type)&&t.click&&R(t,"input")&&Me(t,"click"),!0},_default:function(e){var t=e.target;return me.test(t.type)&&t.click&&R(t,"input")&&Q.get(t,"click")||R(t,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},k.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n)},k.Event=function(e,t){if(!(this instanceof k.Event))return new k.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?Se:Ee,this.target=e.target&&3===e.target.nodeType?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&k.extend(this,t),this.timeStamp=e&&e.timeStamp||Date.now(),this[k.expando]=!0},k.Event.prototype={constructor:k.Event,isDefaultPrevented:Ee,isPropagationStopped:Ee,isImmediatePropagationStopped:Ee,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=Se,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=Se,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=Se,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},k.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},k.event.addProp),k.each({focus:"focusin",blur:"focusout"},(function(e,t){k.event.special[e]={setup:function(){return Me(this,e,De),!1},trigger:function(){return Me(this,e),!0},_default:function(t){return Q.get(t.target,e)},delegateType:t}})),k.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},(function(e,t){k.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,i=this,r=e.relatedTarget,o=e.handleObj;return r&&(r===i||k.contains(i,r))||(e.type=o.origType,n=o.handler.apply(this,arguments),e.type=t),n}}})),k.fn.extend({on:function(e,t,n,i){return Ae(this,e,t,n,i)},one:function(e,t,n,i){return Ae(this,e,t,n,i,1)},off:function(e,t,n){var i,r;if(e&&e.preventDefault&&e.handleObj)return i=e.handleObj,k(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==typeof e){for(r in e)this.off(r,t,e[r]);return this}return!1!==t&&"function"!=typeof t||(n=t,t=void 0),!1===n&&(n=Ee),this.each((function(){k.event.remove(this,e,n,t)}))}});var Re=/<script|<style|<link/i,Le=/checked\s*(?:[^=]|=\s*.checked.)/i,Te=/^\s*<!\[CDATA\[|\]\]>\s*$/g;function Pe(e,t){return R(e,"table")&&R(11!==t.nodeType?t:t.firstChild,"tr")&&k(e).children("tbody")[0]||e}function ze(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function Ie(e){return"true/"===(e.type||"").slice(0,5)?e.type=e.type.slice(5):e.removeAttribute("type"),e}function Oe(e,t){var n,i,r,o,a,s;if(1===t.nodeType){if(Q.hasData(e)&&(s=Q.get(e).events))for(r in Q.remove(t,"handle events"),s)for(n=0,i=s[r].length;n<i;n++)k.event.add(t,r,s[r][n]);J.hasData(e)&&(o=J.access(e),a=k.extend({},o),J.set(t,a))}}function Fe(e,t){var n=t.nodeName.toLowerCase();"input"===n&&me.test(e.type)?t.checked=e.checked:"input"!==n&&"textarea"!==n||(t.defaultValue=e.defaultValue)}function Be(e,t,n,i){t=l(t);var r,o,a,s,c,h,u=0,f=e.length,d=f-1,p=t[0],g=_(p);if(g||f>1&&"string"==typeof p&&!m.checkClone&&Le.test(p))return e.each((function(r){var o=e.eq(r);g&&(t[0]=p.call(this,r,o.html())),Be(o,t,n,i)}));if(f&&(o=(r=Ce(t,e[0].ownerDocument,!1,e,i)).firstChild,1===r.childNodes.length&&(r=o),o||i)){for(s=(a=k.map(ye(r,"script"),ze)).length;u<f;u++)c=r,u!==d&&(c=k.clone(c,!0,!0),s&&k.merge(a,ye(c,"script"))),n.call(e[u],c,u);if(s)for(h=a[a.length-1].ownerDocument,k.map(a,Ie),u=0;u<s;u++)c=a[u],ve.test(c.type||"")&&!Q.access(c,"globalEval")&&k.contains(h,c)&&(c.src&&"module"!==(c.type||"").toLowerCase()?k._evalUrl&&!c.noModule&&k._evalUrl(c.src,{nonce:c.nonce||c.getAttribute("nonce")},h):w(c.textContent.replace(Te,""),c,h))}return e}function Ne(e,t,n){for(var i,r=t?k.filter(t,e):e,o=0;null!=(i=r[o]);o++)n||1!==i.nodeType||k.cleanData(ye(i)),i.parentNode&&(n&&se(i)&&we(ye(i,"script")),i.parentNode.removeChild(i));return e}k.extend({htmlPrefilter:function(e){return e},clone:function(e,t,n){var i,r,o,a,s=e.cloneNode(!0),l=se(e);if(!(m.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||k.isXMLDoc(e)))for(a=ye(s),i=0,r=(o=ye(e)).length;i<r;i++)Fe(o[i],a[i]);if(t)if(n)for(o=o||ye(e),a=a||ye(s),i=0,r=o.length;i<r;i++)Oe(o[i],a[i]);else Oe(e,s);return(a=ye(s,"script")).length>0&&we(a,!l&&ye(e,"script")),s},cleanData:function(e){for(var t,n,i,r=k.event.special,o=0;void 0!==(n=e[o]);o++)if(X(n)){if(t=n[Q.expando]){if(t.events)for(i in t.events)r[i]?k.event.remove(n,i):k.removeEvent(n,i,t.handle);n[Q.expando]=void 0}n[J.expando]&&(n[J.expando]=void 0)}}}),k.fn.extend({detach:function(e){return Ne(this,e,!0)},remove:function(e){return Ne(this,e)},text:function(e){return q(this,(function(e){return void 0===e?k.text(this):this.empty().each((function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)}))}),null,e,arguments.length)},append:function(){return Be(this,arguments,(function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||Pe(this,e).appendChild(e)}))},prepend:function(){return Be(this,arguments,(function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=Pe(this,e);t.insertBefore(e,t.firstChild)}}))},before:function(){return Be(this,arguments,(function(e){this.parentNode&&this.parentNode.insertBefore(e,this)}))},after:function(){return Be(this,arguments,(function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)}))},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(k.cleanData(ye(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map((function(){return k.clone(this,e,t)}))},html:function(e){return q(this,(function(e){var t=this[0]||{},n=0,i=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!Re.test(e)&&!be[(_e.exec(e)||["",""])[1].toLowerCase()]){e=k.htmlPrefilter(e);try{for(;n<i;n++)1===(t=this[n]||{}).nodeType&&(k.cleanData(ye(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)}),null,e,arguments.length)},replaceWith:function(){var e=[];return Be(this,arguments,(function(t){var n=this.parentNode;k.inArray(this,e)<0&&(k.cleanData(ye(this)),n&&n.replaceChild(t,this))}),e)}}),k.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},(function(e,t){k.fn[e]=function(e){for(var n,i=[],r=k(e),o=r.length-1,a=0;a<=o;a++)n=a===o?this:this.clone(!0),k(r[a])[t](n),c.apply(i,n.get());return this.pushStack(i)}}));var He=new RegExp("^("+ie+")(?!px)[a-z%]+$","i"),Ue=/^--/,$e=function(e){var t=e.ownerDocument.defaultView;return t&&t.opener||(t=i),t.getComputedStyle(e)},je=function(e,t,n){var i,r,o={};for(r in t)o[r]=e.style[r],e.style[r]=t[r];for(r in i=n.call(e),t)e.style[r]=o[r];return i},We=new RegExp(oe.join("|"),"i"),qe=new RegExp("^[\\x20\\t\\r\\n\\f]+|((?:^|[^\\\\])(?:\\\\.)*)[\\x20\\t\\r\\n\\f]+$","g");function Ve(e,t,n){var i,r,o,a,s=Ue.test(t),l=e.style;return(n=n||$e(e))&&(a=n.getPropertyValue(t)||n[t],s&&(a=a.replace(qe,"$1")),""!==a||se(e)||(a=k.style(e,t)),!m.pixelBoxStyles()&&He.test(a)&&We.test(t)&&(i=l.width,r=l.minWidth,o=l.maxWidth,l.minWidth=l.maxWidth=l.width=a,a=n.width,l.width=i,l.minWidth=r,l.maxWidth=o)),void 0!==a?a+"":a}function Ke(e,t){return{get:function(){if(!e())return(this.get=t).apply(this,arguments);delete this.get}}}!function(){function e(){if(h){c.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",h.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",ae.appendChild(c).appendChild(h);var e=i.getComputedStyle(h);n="1%"!==e.top,l=12===t(e.marginLeft),h.style.right="60%",a=36===t(e.right),r=36===t(e.width),h.style.position="absolute",o=12===t(h.offsetWidth/3),ae.removeChild(c),h=null}}function t(e){return Math.round(parseFloat(e))}var n,r,o,a,s,l,c=b.createElement("div"),h=b.createElement("div");h.style&&(h.style.backgroundClip="content-box",h.cloneNode(!0).style.backgroundClip="",m.clearCloneStyle="content-box"===h.style.backgroundClip,k.extend(m,{boxSizingReliable:function(){return e(),r},pixelBoxStyles:function(){return e(),a},pixelPosition:function(){return e(),n},reliableMarginLeft:function(){return e(),l},scrollboxSize:function(){return e(),o},reliableTrDimensions:function(){var e,t,n,r;return null==s&&(e=b.createElement("table"),t=b.createElement("tr"),n=b.createElement("div"),e.style.cssText="position:absolute;left:-11111px;border-collapse:separate",t.style.cssText="border:1px solid",t.style.height="1px",n.style.height="9px",n.style.display="block",ae.appendChild(e).appendChild(t).appendChild(n),r=i.getComputedStyle(t),s=parseInt(r.height,10)+parseInt(r.borderTopWidth,10)+parseInt(r.borderBottomWidth,10)===t.offsetHeight,ae.removeChild(e)),s}}))}();var Ge=["Webkit","Moz","ms"],Ze=b.createElement("div").style,Xe={};function Ye(e){return k.cssProps[e]||Xe[e]||(e in Ze?e:Xe[e]=function(e){for(var t=e[0].toUpperCase()+e.slice(1),n=Ge.length;n--;)if((e=Ge[n]+t)in Ze)return e}(e)||e)}var Qe=/^(none|table(?!-c[ea]).+)/,Je={position:"absolute",visibility:"hidden",display:"block"},et={letterSpacing:"0",fontWeight:"400"};function tt(e,t,n){var i=re.exec(t);return i?Math.max(0,i[2]-(n||0))+(i[3]||"px"):t}function nt(e,t,n,i,r,o){var a="width"===t?1:0,s=0,l=0;if(n===(i?"border":"content"))return 0;for(;a<4;a+=2)"margin"===n&&(l+=k.css(e,n+oe[a],!0,r)),i?("content"===n&&(l-=k.css(e,"padding"+oe[a],!0,r)),"margin"!==n&&(l-=k.css(e,"border"+oe[a]+"Width",!0,r))):(l+=k.css(e,"padding"+oe[a],!0,r),"padding"!==n?l+=k.css(e,"border"+oe[a]+"Width",!0,r):s+=k.css(e,"border"+oe[a]+"Width",!0,r));return!i&&o>=0&&(l+=Math.max(0,Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-o-l-s-.5))||0),l}function it(e,t,n){var i=$e(e),r=(!m.boxSizingReliable()||n)&&"border-box"===k.css(e,"boxSizing",!1,i),o=r,a=Ve(e,t,i),s="offset"+t[0].toUpperCase()+t.slice(1);if(He.test(a)){if(!n)return a;a="auto"}return(!m.boxSizingReliable()&&r||!m.reliableTrDimensions()&&R(e,"tr")||"auto"===a||!parseFloat(a)&&"inline"===k.css(e,"display",!1,i))&&e.getClientRects().length&&(r="border-box"===k.css(e,"boxSizing",!1,i),(o=s in e)&&(a=e[s])),(a=parseFloat(a)||0)+nt(e,t,n||(r?"border":"content"),o,i,a)+"px"}function rt(e,t,n,i,r){return new rt.prototype.init(e,t,n,i,r)}k.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Ve(e,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(e,t,n,i){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var r,o,a,s=Z(t),l=Ue.test(t),c=e.style;if(l||(t=Ye(s)),a=k.cssHooks[t]||k.cssHooks[s],void 0===n)return a&&"get"in a&&void 0!==(r=a.get(e,!1,i))?r:c[t];"string"==(o=typeof n)&&(r=re.exec(n))&&r[1]&&(n=he(e,t,r),o="number"),null!=n&&n==n&&("number"!==o||l||(n+=r&&r[3]||(k.cssNumber[s]?"":"px")),m.clearCloneStyle||""!==n||0!==t.indexOf("background")||(c[t]="inherit"),a&&"set"in a&&void 0===(n=a.set(e,n,i))||(l?c.setProperty(t,n):c[t]=n))}},css:function(e,t,n,i){var r,o,a,s=Z(t);return Ue.test(t)||(t=Ye(s)),(a=k.cssHooks[t]||k.cssHooks[s])&&"get"in a&&(r=a.get(e,!0,n)),void 0===r&&(r=Ve(e,t,i)),"normal"===r&&t in et&&(r=et[t]),""===n||n?(o=parseFloat(r),!0===n||isFinite(o)?o||0:r):r}}),k.each(["height","width"],(function(e,t){k.cssHooks[t]={get:function(e,n,i){if(n)return!Qe.test(k.css(e,"display"))||e.getClientRects().length&&e.getBoundingClientRect().width?it(e,t,i):je(e,Je,(function(){return it(e,t,i)}))},set:function(e,n,i){var r,o=$e(e),a=!m.scrollboxSize()&&"absolute"===o.position,s=(a||i)&&"border-box"===k.css(e,"boxSizing",!1,o),l=i?nt(e,t,i,s,o):0;return s&&a&&(l-=Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-parseFloat(o[t])-nt(e,t,"border",!1,o)-.5)),l&&(r=re.exec(n))&&"px"!==(r[3]||"px")&&(e.style[t]=n,n=k.css(e,t)),tt(0,n,l)}}})),k.cssHooks.marginLeft=Ke(m.reliableMarginLeft,(function(e,t){if(t)return(parseFloat(Ve(e,"marginLeft"))||e.getBoundingClientRect().left-je(e,{marginLeft:0},(function(){return e.getBoundingClientRect().left})))+"px"})),k.each({margin:"",padding:"",border:"Width"},(function(e,t){k.cssHooks[e+t]={expand:function(n){for(var i=0,r={},o="string"==typeof n?n.split(" "):[n];i<4;i++)r[e+oe[i]+t]=o[i]||o[i-2]||o[0];return r}},"margin"!==e&&(k.cssHooks[e+t].set=tt)})),k.fn.extend({css:function(e,t){return q(this,(function(e,t,n){var i,r,o={},a=0;if(Array.isArray(t)){for(i=$e(e),r=t.length;a<r;a++)o[t[a]]=k.css(e,t[a],!1,i);return o}return void 0!==n?k.style(e,t,n):k.css(e,t)}),e,t,arguments.length>1)}}),k.Tween=rt,rt.prototype={constructor:rt,init:function(e,t,n,i,r,o){this.elem=e,this.prop=n,this.easing=r||k.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=i,this.unit=o||(k.cssNumber[n]?"":"px")},cur:function(){var e=rt.propHooks[this.prop];return e&&e.get?e.get(this):rt.propHooks._default.get(this)},run:function(e){var t,n=rt.propHooks[this.prop];return this.options.duration?this.pos=t=k.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):rt.propHooks._default.set(this),this}},rt.prototype.init.prototype=rt.prototype,rt.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=k.css(e.elem,e.prop,""))&&"auto"!==t?t:0},set:function(e){k.fx.step[e.prop]?k.fx.step[e.prop](e):1!==e.elem.nodeType||!k.cssHooks[e.prop]&&null==e.elem.style[Ye(e.prop)]?e.elem[e.prop]=e.now:k.style(e.elem,e.prop,e.now+e.unit)}}},rt.propHooks.scrollTop=rt.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},k.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},k.fx=rt.prototype.init,k.fx.step={};var ot,at,st=/^(?:toggle|show|hide)$/,lt=/queueHooks$/;function ct(){at&&(!1===b.hidden&&i.requestAnimationFrame?i.requestAnimationFrame(ct):i.setTimeout(ct,k.fx.interval),k.fx.tick())}function ht(){return i.setTimeout((function(){ot=void 0})),ot=Date.now()}function ut(e,t){var n,i=0,r={height:e};for(t=t?1:0;i<4;i+=2-t)r["margin"+(n=oe[i])]=r["padding"+n]=e;return t&&(r.opacity=r.width=e),r}function ft(e,t,n){for(var i,r=(dt.tweeners[t]||[]).concat(dt.tweeners["*"]),o=0,a=r.length;o<a;o++)if(i=r[o].call(n,t,e))return i}function dt(e,t,n){var i,r,o=0,a=dt.prefilters.length,s=k.Deferred().always((function(){delete l.elem})),l=function(){if(r)return!1;for(var t=ot||ht(),n=Math.max(0,c.startTime+c.duration-t),i=1-(n/c.duration||0),o=0,a=c.tweens.length;o<a;o++)c.tweens[o].run(i);return s.notifyWith(e,[c,i,n]),i<1&&a?n:(a||s.notifyWith(e,[c,1,0]),s.resolveWith(e,[c]),!1)},c=s.promise({elem:e,props:k.extend({},t),opts:k.extend(!0,{specialEasing:{},easing:k.easing._default},n),originalProperties:t,originalOptions:n,startTime:ot||ht(),duration:n.duration,tweens:[],createTween:function(t,n){var i=k.Tween(e,c.opts,t,n,c.opts.specialEasing[t]||c.opts.easing);return c.tweens.push(i),i},stop:function(t){var n=0,i=t?c.tweens.length:0;if(r)return this;for(r=!0;n<i;n++)c.tweens[n].run(1);return t?(s.notifyWith(e,[c,1,0]),s.resolveWith(e,[c,t])):s.rejectWith(e,[c,t]),this}}),h=c.props;for(function(e,t){var n,i,r,o,a;for(n in e)if(r=t[i=Z(n)],o=e[n],Array.isArray(o)&&(r=o[1],o=e[n]=o[0]),n!==i&&(e[i]=o,delete e[n]),(a=k.cssHooks[i])&&"expand"in a)for(n in o=a.expand(o),delete e[i],o)n in e||(e[n]=o[n],t[n]=r);else t[i]=r}(h,c.opts.specialEasing);o<a;o++)if(i=dt.prefilters[o].call(c,e,h,c.opts))return _(i.stop)&&(k._queueHooks(c.elem,c.opts.queue).stop=i.stop.bind(i)),i;return k.map(h,ft,c),_(c.opts.start)&&c.opts.start.call(e,c),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always),k.fx.timer(k.extend(l,{elem:e,anim:c,queue:c.opts.queue})),c}k.Animation=k.extend(dt,{tweeners:{"*":[function(e,t){var n=this.createTween(e,t);return he(n.elem,e,re.exec(t),n),n}]},tweener:function(e,t){_(e)?(t=e,e=["*"]):e=e.match(B);for(var n,i=0,r=e.length;i<r;i++)n=e[i],dt.tweeners[n]=dt.tweeners[n]||[],dt.tweeners[n].unshift(t)},prefilters:[function(e,t,n){var i,r,o,a,s,l,c,h,u="width"in t||"height"in t,f=this,d={},p=e.style,g=e.nodeType&&ce(e),m=Q.get(e,"fxshow");for(i in n.queue||(null==(a=k._queueHooks(e,"fx")).unqueued&&(a.unqueued=0,s=a.empty.fire,a.empty.fire=function(){a.unqueued||s()}),a.unqueued++,f.always((function(){f.always((function(){a.unqueued--,k.queue(e,"fx").length||a.empty.fire()}))}))),t)if(r=t[i],st.test(r)){if(delete t[i],o=o||"toggle"===r,r===(g?"hide":"show")){if("show"!==r||!m||void 0===m[i])continue;g=!0}d[i]=m&&m[i]||k.style(e,i)}if((l=!k.isEmptyObject(t))||!k.isEmptyObject(d))for(i in u&&1===e.nodeType&&(n.overflow=[p.overflow,p.overflowX,p.overflowY],null==(c=m&&m.display)&&(c=Q.get(e,"display")),"none"===(h=k.css(e,"display"))&&(c?h=c:(de([e],!0),c=e.style.display||c,h=k.css(e,"display"),de([e]))),("inline"===h||"inline-block"===h&&null!=c)&&"none"===k.css(e,"float")&&(l||(f.done((function(){p.display=c})),null==c&&(h=p.display,c="none"===h?"":h)),p.display="inline-block")),n.overflow&&(p.overflow="hidden",f.always((function(){p.overflow=n.overflow[0],p.overflowX=n.overflow[1],p.overflowY=n.overflow[2]}))),l=!1,d)l||(m?"hidden"in m&&(g=m.hidden):m=Q.access(e,"fxshow",{display:c}),o&&(m.hidden=!g),g&&de([e],!0),f.done((function(){for(i in g||de([e]),Q.remove(e,"fxshow"),d)k.style(e,i,d[i])}))),l=ft(g?m[i]:0,i,f),i in m||(m[i]=l.start,g&&(l.end=l.start,l.start=0))}],prefilter:function(e,t){t?dt.prefilters.unshift(e):dt.prefilters.push(e)}}),k.speed=function(e,t,n){var i=e&&"object"==typeof e?k.extend({},e):{complete:n||!n&&t||_(e)&&e,duration:e,easing:n&&t||t&&!_(t)&&t};return k.fx.off?i.duration=0:"number"!=typeof i.duration&&(i.duration in k.fx.speeds?i.duration=k.fx.speeds[i.duration]:i.duration=k.fx.speeds._default),null!=i.queue&&!0!==i.queue||(i.queue="fx"),i.old=i.complete,i.complete=function(){_(i.old)&&i.old.call(this),i.queue&&k.dequeue(this,i.queue)},i},k.fn.extend({fadeTo:function(e,t,n,i){return this.filter(ce).css("opacity",0).show().end().animate({opacity:t},e,n,i)},animate:function(e,t,n,i){var r=k.isEmptyObject(e),o=k.speed(t,n,i),a=function(){var t=dt(this,k.extend({},e),o);(r||Q.get(this,"finish"))&&t.stop(!0)};return a.finish=a,r||!1===o.queue?this.each(a):this.queue(o.queue,a)},stop:function(e,t,n){var i=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=t,t=e,e=void 0),t&&this.queue(e||"fx",[]),this.each((function(){var t=!0,r=null!=e&&e+"queueHooks",o=k.timers,a=Q.get(this);if(r)a[r]&&a[r].stop&&i(a[r]);else for(r in a)a[r]&&a[r].stop&&lt.test(r)&&i(a[r]);for(r=o.length;r--;)o[r].elem!==this||null!=e&&o[r].queue!==e||(o[r].anim.stop(n),t=!1,o.splice(r,1));!t&&n||k.dequeue(this,e)}))},finish:function(e){return!1!==e&&(e=e||"fx"),this.each((function(){var t,n=Q.get(this),i=n[e+"queue"],r=n[e+"queueHooks"],o=k.timers,a=i?i.length:0;for(n.finish=!0,k.queue(this,e,[]),r&&r.stop&&r.stop.call(this,!0),t=o.length;t--;)o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;t<a;t++)i[t]&&i[t].finish&&i[t].finish.call(this);delete n.finish}))}}),k.each(["toggle","show","hide"],(function(e,t){var n=k.fn[t];k.fn[t]=function(e,i,r){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(ut(t,!0),e,i,r)}})),k.each({slideDown:ut("show"),slideUp:ut("hide"),slideToggle:ut("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},(function(e,t){k.fn[e]=function(e,n,i){return this.animate(t,e,n,i)}})),k.timers=[],k.fx.tick=function(){var e,t=0,n=k.timers;for(ot=Date.now();t<n.length;t++)(e=n[t])()||n[t]!==e||n.splice(t--,1);n.length||k.fx.stop(),ot=void 0},k.fx.timer=function(e){k.timers.push(e),k.fx.start()},k.fx.interval=13,k.fx.start=function(){at||(at=!0,ct())},k.fx.stop=function(){at=null},k.fx.speeds={slow:600,fast:200,_default:400},k.fn.delay=function(e,t){return e=k.fx&&k.fx.speeds[e]||e,t=t||"fx",this.queue(t,(function(t,n){var r=i.setTimeout(t,e);n.stop=function(){i.clearTimeout(r)}}))},function(){var e=b.createElement("input"),t=b.createElement("select").appendChild(b.createElement("option"));e.type="checkbox",m.checkOn=""!==e.value,m.optSelected=t.selected,(e=b.createElement("input")).value="t",e.type="radio",m.radioValue="t"===e.value}();var pt,gt=k.expr.attrHandle;k.fn.extend({attr:function(e,t){return q(this,k.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each((function(){k.removeAttr(this,e)}))}}),k.extend({attr:function(e,t,n){var i,r,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return void 0===e.getAttribute?k.prop(e,t,n):(1===o&&k.isXMLDoc(e)||(r=k.attrHooks[t.toLowerCase()]||(k.expr.match.bool.test(t)?pt:void 0)),void 0!==n?null===n?void k.removeAttr(e,t):r&&"set"in r&&void 0!==(i=r.set(e,n,t))?i:(e.setAttribute(t,n+""),n):r&&"get"in r&&null!==(i=r.get(e,t))?i:null==(i=k.find.attr(e,t))?void 0:i)},attrHooks:{type:{set:function(e,t){if(!m.radioValue&&"radio"===t&&R(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},removeAttr:function(e,t){var n,i=0,r=t&&t.match(B);if(r&&1===e.nodeType)for(;n=r[i++];)e.removeAttribute(n)}}),pt={set:function(e,t,n){return!1===t?k.removeAttr(e,n):e.setAttribute(n,n),n}},k.each(k.expr.match.bool.source.match(/\w+/g),(function(e,t){var n=gt[t]||k.find.attr;gt[t]=function(e,t,i){var r,o,a=t.toLowerCase();return i||(o=gt[a],gt[a]=r,r=null!=n(e,t,i)?a:null,gt[a]=o),r}}));var mt=/^(?:input|select|textarea|button)$/i,_t=/^(?:a|area)$/i;function vt(e){return(e.match(B)||[]).join(" ")}function bt(e){return e.getAttribute&&e.getAttribute("class")||""}function yt(e){return Array.isArray(e)?e:"string"==typeof e&&e.match(B)||[]}k.fn.extend({prop:function(e,t){return q(this,k.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each((function(){delete this[k.propFix[e]||e]}))}}),k.extend({prop:function(e,t,n){var i,r,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&k.isXMLDoc(e)||(t=k.propFix[t]||t,r=k.propHooks[t]),void 0!==n?r&&"set"in r&&void 0!==(i=r.set(e,n,t))?i:e[t]=n:r&&"get"in r&&null!==(i=r.get(e,t))?i:e[t]},propHooks:{tabIndex:{get:function(e){var t=k.find.attr(e,"tabindex");return t?parseInt(t,10):mt.test(e.nodeName)||_t.test(e.nodeName)&&e.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),m.optSelected||(k.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),k.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],(function(){k.propFix[this.toLowerCase()]=this})),k.fn.extend({addClass:function(e){var t,n,i,r,o,a;return _(e)?this.each((function(t){k(this).addClass(e.call(this,t,bt(this)))})):(t=yt(e)).length?this.each((function(){if(i=bt(this),n=1===this.nodeType&&" "+vt(i)+" "){for(o=0;o<t.length;o++)r=t[o],n.indexOf(" "+r+" ")<0&&(n+=r+" ");a=vt(n),i!==a&&this.setAttribute("class",a)}})):this},removeClass:function(e){var t,n,i,r,o,a;return _(e)?this.each((function(t){k(this).removeClass(e.call(this,t,bt(this)))})):arguments.length?(t=yt(e)).length?this.each((function(){if(i=bt(this),n=1===this.nodeType&&" "+vt(i)+" "){for(o=0;o<t.length;o++)for(r=t[o];n.indexOf(" "+r+" ")>-1;)n=n.replace(" "+r+" "," ");a=vt(n),i!==a&&this.setAttribute("class",a)}})):this:this.attr("class","")},toggleClass:function(e,t){var n,i,r,o,a=typeof e,s="string"===a||Array.isArray(e);return _(e)?this.each((function(n){k(this).toggleClass(e.call(this,n,bt(this),t),t)})):"boolean"==typeof t&&s?t?this.addClass(e):this.removeClass(e):(n=yt(e),this.each((function(){if(s)for(o=k(this),r=0;r<n.length;r++)i=n[r],o.hasClass(i)?o.removeClass(i):o.addClass(i);else void 0!==e&&"boolean"!==a||((i=bt(this))&&Q.set(this,"__className__",i),this.setAttribute&&this.setAttribute("class",i||!1===e?"":Q.get(this,"__className__")||""))})))},hasClass:function(e){var t,n,i=0;for(t=" "+e+" ";n=this[i++];)if(1===n.nodeType&&(" "+vt(bt(n))+" ").indexOf(t)>-1)return!0;return!1}});var wt=/\r/g;k.fn.extend({val:function(e){var t,n,i,r=this[0];return arguments.length?(i=_(e),this.each((function(n){var r;1===this.nodeType&&(null==(r=i?e.call(this,n,k(this).val()):e)?r="":"number"==typeof r?r+="":Array.isArray(r)&&(r=k.map(r,(function(e){return null==e?"":e+""}))),(t=k.valHooks[this.type]||k.valHooks[this.nodeName.toLowerCase()])&&"set"in t&&void 0!==t.set(this,r,"value")||(this.value=r))}))):r?(t=k.valHooks[r.type]||k.valHooks[r.nodeName.toLowerCase()])&&"get"in t&&void 0!==(n=t.get(r,"value"))?n:"string"==typeof(n=r.value)?n.replace(wt,""):null==n?"":n:void 0}}),k.extend({valHooks:{option:{get:function(e){var t=k.find.attr(e,"value");return null!=t?t:vt(k.text(e))}},select:{get:function(e){var t,n,i,r=e.options,o=e.selectedIndex,a="select-one"===e.type,s=a?null:[],l=a?o+1:r.length;for(i=o<0?l:a?o:0;i<l;i++)if(((n=r[i]).selected||i===o)&&!n.disabled&&(!n.parentNode.disabled||!R(n.parentNode,"optgroup"))){if(t=k(n).val(),a)return t;s.push(t)}return s},set:function(e,t){for(var n,i,r=e.options,o=k.makeArray(t),a=r.length;a--;)((i=r[a]).selected=k.inArray(k.valHooks.option.get(i),o)>-1)&&(n=!0);return n||(e.selectedIndex=-1),o}}}}),k.each(["radio","checkbox"],(function(){k.valHooks[this]={set:function(e,t){if(Array.isArray(t))return e.checked=k.inArray(k(e).val(),t)>-1}},m.checkOn||(k.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})})),m.focusin="onfocusin"in i;var xt=/^(?:focusinfocus|focusoutblur)$/,Ct=function(e){e.stopPropagation()};k.extend(k.event,{trigger:function(e,t,n,r){var o,a,s,l,c,h,u,f,p=[n||b],g=d.call(e,"type")?e.type:e,m=d.call(e,"namespace")?e.namespace.split("."):[];if(a=f=s=n=n||b,3!==n.nodeType&&8!==n.nodeType&&!xt.test(g+k.event.triggered)&&(g.indexOf(".")>-1&&(m=g.split("."),g=m.shift(),m.sort()),c=g.indexOf(":")<0&&"on"+g,(e=e[k.expando]?e:new k.Event(g,"object"==typeof e&&e)).isTrigger=r?2:3,e.namespace=m.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=n),t=null==t?[e]:k.makeArray(t,[e]),u=k.event.special[g]||{},r||!u.trigger||!1!==u.trigger.apply(n,t))){if(!r&&!u.noBubble&&!v(n)){for(l=u.delegateType||g,xt.test(l+g)||(a=a.parentNode);a;a=a.parentNode)p.push(a),s=a;s===(n.ownerDocument||b)&&p.push(s.defaultView||s.parentWindow||i)}for(o=0;(a=p[o++])&&!e.isPropagationStopped();)f=a,e.type=o>1?l:u.bindType||g,(h=(Q.get(a,"events")||Object.create(null))[e.type]&&Q.get(a,"handle"))&&h.apply(a,t),(h=c&&a[c])&&h.apply&&X(a)&&(e.result=h.apply(a,t),!1===e.result&&e.preventDefault());return e.type=g,r||e.isDefaultPrevented()||u._default&&!1!==u._default.apply(p.pop(),t)||!X(n)||c&&_(n[g])&&!v(n)&&((s=n[c])&&(n[c]=null),k.event.triggered=g,e.isPropagationStopped()&&f.addEventListener(g,Ct),n[g](),e.isPropagationStopped()&&f.removeEventListener(g,Ct),k.event.triggered=void 0,s&&(n[c]=s)),e.result}},simulate:function(e,t,n){var i=k.extend(new k.Event,n,{type:e,isSimulated:!0});k.event.trigger(i,null,t)}}),k.fn.extend({trigger:function(e,t){return this.each((function(){k.event.trigger(e,t,this)}))},triggerHandler:function(e,t){var n=this[0];if(n)return k.event.trigger(e,t,n,!0)}}),m.focusin||k.each({focus:"focusin",blur:"focusout"},(function(e,t){var n=function(e){k.event.simulate(t,e.target,k.event.fix(e))};k.event.special[t]={setup:function(){var i=this.ownerDocument||this.document||this,r=Q.access(i,t);r||i.addEventListener(e,n,!0),Q.access(i,t,(r||0)+1)},teardown:function(){var i=this.ownerDocument||this.document||this,r=Q.access(i,t)-1;r?Q.access(i,t,r):(i.removeEventListener(e,n,!0),Q.remove(i,t))}}}));var kt=i.location,St={guid:Date.now()},Et=/\?/;k.parseXML=function(e){var t,n;if(!e||"string"!=typeof e)return null;try{t=(new i.DOMParser).parseFromString(e,"text/xml")}catch(e){}return n=t&&t.getElementsByTagName("parsererror")[0],t&&!n||k.error("Invalid XML: "+(n?k.map(n.childNodes,(function(e){return e.textContent})).join("\n"):e)),t};var Dt=/\[\]$/,At=/\r?\n/g,Mt=/^(?:submit|button|image|reset|file)$/i,Rt=/^(?:input|select|textarea|keygen)/i;function Lt(e,t,n,i){var r;if(Array.isArray(t))k.each(t,(function(t,r){n||Dt.test(e)?i(e,r):Lt(e+"["+("object"==typeof r&&null!=r?t:"")+"]",r,n,i)}));else if(n||"object"!==x(t))i(e,t);else for(r in t)Lt(e+"["+r+"]",t[r],n,i)}k.param=function(e,t){var n,i=[],r=function(e,t){var n=_(t)?t():t;i[i.length]=encodeURIComponent(e)+"="+encodeURIComponent(null==n?"":n)};if(null==e)return"";if(Array.isArray(e)||e.jquery&&!k.isPlainObject(e))k.each(e,(function(){r(this.name,this.value)}));else for(n in e)Lt(n,e[n],t,r);return i.join("&")},k.fn.extend({serialize:function(){return k.param(this.serializeArray())},serializeArray:function(){return this.map((function(){var e=k.prop(this,"elements");return e?k.makeArray(e):this})).filter((function(){var e=this.type;return this.name&&!k(this).is(":disabled")&&Rt.test(this.nodeName)&&!Mt.test(e)&&(this.checked||!me.test(e))})).map((function(e,t){var n=k(this).val();return null==n?null:Array.isArray(n)?k.map(n,(function(e){return{name:t.name,value:e.replace(At,"\r\n")}})):{name:t.name,value:n.replace(At,"\r\n")}})).get()}});var Tt=/%20/g,Pt=/#.*$/,zt=/([?&])_=[^&]*/,It=/^(.*?):[ \t]*([^\r\n]*)$/gm,Ot=/^(?:GET|HEAD)$/,Ft=/^\/\//,Bt={},Nt={},Ht="*/".concat("*"),Ut=b.createElement("a");function $t(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var i,r=0,o=t.toLowerCase().match(B)||[];if(_(n))for(;i=o[r++];)"+"===i[0]?(i=i.slice(1)||"*",(e[i]=e[i]||[]).unshift(n)):(e[i]=e[i]||[]).push(n)}}function jt(e,t,n,i){var r={},o=e===Nt;function a(s){var l;return r[s]=!0,k.each(e[s]||[],(function(e,s){var c=s(t,n,i);return"string"!=typeof c||o||r[c]?o?!(l=c):void 0:(t.dataTypes.unshift(c),a(c),!1)})),l}return a(t.dataTypes[0])||!r["*"]&&a("*")}function Wt(e,t){var n,i,r=k.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((r[n]?e:i||(i={}))[n]=t[n]);return i&&k.extend(!0,e,i),e}Ut.href=kt.href,k.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:kt.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(kt.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Ht,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":k.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?Wt(Wt(e,k.ajaxSettings),t):Wt(k.ajaxSettings,e)},ajaxPrefilter:$t(Bt),ajaxTransport:$t(Nt),ajax:function(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var n,r,o,a,s,l,c,h,u,f,d=k.ajaxSetup({},t),p=d.context||d,g=d.context&&(p.nodeType||p.jquery)?k(p):k.event,m=k.Deferred(),_=k.Callbacks("once memory"),v=d.statusCode||{},y={},w={},x="canceled",C={readyState:0,getResponseHeader:function(e){var t;if(c){if(!a)for(a={};t=It.exec(o);)a[t[1].toLowerCase()+" "]=(a[t[1].toLowerCase()+" "]||[]).concat(t[2]);t=a[e.toLowerCase()+" "]}return null==t?null:t.join(", ")},getAllResponseHeaders:function(){return c?o:null},setRequestHeader:function(e,t){return null==c&&(e=w[e.toLowerCase()]=w[e.toLowerCase()]||e,y[e]=t),this},overrideMimeType:function(e){return null==c&&(d.mimeType=e),this},statusCode:function(e){var t;if(e)if(c)C.always(e[C.status]);else for(t in e)v[t]=[v[t],e[t]];return this},abort:function(e){var t=e||x;return n&&n.abort(t),S(0,t),this}};if(m.promise(C),d.url=((e||d.url||kt.href)+"").replace(Ft,kt.protocol+"//"),d.type=t.method||t.type||d.method||d.type,d.dataTypes=(d.dataType||"*").toLowerCase().match(B)||[""],null==d.crossDomain){l=b.createElement("a");try{l.href=d.url,l.href=l.href,d.crossDomain=Ut.protocol+"//"+Ut.host!=l.protocol+"//"+l.host}catch(e){d.crossDomain=!0}}if(d.data&&d.processData&&"string"!=typeof d.data&&(d.data=k.param(d.data,d.traditional)),jt(Bt,d,t,C),c)return C;for(u in(h=k.event&&d.global)&&0==k.active++&&k.event.trigger("ajaxStart"),d.type=d.type.toUpperCase(),d.hasContent=!Ot.test(d.type),r=d.url.replace(Pt,""),d.hasContent?d.data&&d.processData&&0===(d.contentType||"").indexOf("application/x-www-form-urlencoded")&&(d.data=d.data.replace(Tt,"+")):(f=d.url.slice(r.length),d.data&&(d.processData||"string"==typeof d.data)&&(r+=(Et.test(r)?"&":"?")+d.data,delete d.data),!1===d.cache&&(r=r.replace(zt,"$1"),f=(Et.test(r)?"&":"?")+"_="+St.guid+++f),d.url=r+f),d.ifModified&&(k.lastModified[r]&&C.setRequestHeader("If-Modified-Since",k.lastModified[r]),k.etag[r]&&C.setRequestHeader("If-None-Match",k.etag[r])),(d.data&&d.hasContent&&!1!==d.contentType||t.contentType)&&C.setRequestHeader("Content-Type",d.contentType),C.setRequestHeader("Accept",d.dataTypes[0]&&d.accepts[d.dataTypes[0]]?d.accepts[d.dataTypes[0]]+("*"!==d.dataTypes[0]?", "+Ht+"; q=0.01":""):d.accepts["*"]),d.headers)C.setRequestHeader(u,d.headers[u]);if(d.beforeSend&&(!1===d.beforeSend.call(p,C,d)||c))return C.abort();if(x="abort",_.add(d.complete),C.done(d.success),C.fail(d.error),n=jt(Nt,d,t,C)){if(C.readyState=1,h&&g.trigger("ajaxSend",[C,d]),c)return C;d.async&&d.timeout>0&&(s=i.setTimeout((function(){C.abort("timeout")}),d.timeout));try{c=!1,n.send(y,S)}catch(e){if(c)throw e;S(-1,e)}}else S(-1,"No Transport");function S(e,t,a,l){var u,f,b,y,w,x=t;c||(c=!0,s&&i.clearTimeout(s),n=void 0,o=l||"",C.readyState=e>0?4:0,u=e>=200&&e<300||304===e,a&&(y=function(e,t,n){for(var i,r,o,a,s=e.contents,l=e.dataTypes;"*"===l[0];)l.shift(),void 0===i&&(i=e.mimeType||t.getResponseHeader("Content-Type"));if(i)for(r in s)if(s[r]&&s[r].test(i)){l.unshift(r);break}if(l[0]in n)o=l[0];else{for(r in n){if(!l[0]||e.converters[r+" "+l[0]]){o=r;break}a||(a=r)}o=o||a}if(o)return o!==l[0]&&l.unshift(o),n[o]}(d,C,a)),!u&&k.inArray("script",d.dataTypes)>-1&&k.inArray("json",d.dataTypes)<0&&(d.converters["text script"]=function(){}),y=function(e,t,n,i){var r,o,a,s,l,c={},h=e.dataTypes.slice();if(h[1])for(a in e.converters)c[a.toLowerCase()]=e.converters[a];for(o=h.shift();o;)if(e.responseFields[o]&&(n[e.responseFields[o]]=t),!l&&i&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l=o,o=h.shift())if("*"===o)o=l;else if("*"!==l&&l!==o){if(!(a=c[l+" "+o]||c["* "+o]))for(r in c)if((s=r.split(" "))[1]===o&&(a=c[l+" "+s[0]]||c["* "+s[0]])){!0===a?a=c[r]:!0!==c[r]&&(o=s[0],h.unshift(s[1]));break}if(!0!==a)if(a&&e.throws)t=a(t);else try{t=a(t)}catch(e){return{state:"parsererror",error:a?e:"No conversion from "+l+" to "+o}}}return{state:"success",data:t}}(d,y,C,u),u?(d.ifModified&&((w=C.getResponseHeader("Last-Modified"))&&(k.lastModified[r]=w),(w=C.getResponseHeader("etag"))&&(k.etag[r]=w)),204===e||"HEAD"===d.type?x="nocontent":304===e?x="notmodified":(x=y.state,f=y.data,u=!(b=y.error))):(b=x,!e&&x||(x="error",e<0&&(e=0))),C.status=e,C.statusText=(t||x)+"",u?m.resolveWith(p,[f,x,C]):m.rejectWith(p,[C,x,b]),C.statusCode(v),v=void 0,h&&g.trigger(u?"ajaxSuccess":"ajaxError",[C,d,u?f:b]),_.fireWith(p,[C,x]),h&&(g.trigger("ajaxComplete",[C,d]),--k.active||k.event.trigger("ajaxStop")))}return C},getJSON:function(e,t,n){return k.get(e,t,n,"json")},getScript:function(e,t){return k.get(e,void 0,t,"script")}}),k.each(["get","post"],(function(e,t){k[t]=function(e,n,i,r){return _(n)&&(r=r||i,i=n,n=void 0),k.ajax(k.extend({url:e,type:t,dataType:r,data:n,success:i},k.isPlainObject(e)&&e))}})),k.ajaxPrefilter((function(e){var t;for(t in e.headers)"content-type"===t.toLowerCase()&&(e.contentType=e.headers[t]||"")})),k._evalUrl=function(e,t,n){return k.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(e){k.globalEval(e,t,n)}})},k.fn.extend({wrapAll:function(e){var t;return this[0]&&(_(e)&&(e=e.call(this[0])),t=k(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map((function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e})).append(this)),this},wrapInner:function(e){return _(e)?this.each((function(t){k(this).wrapInner(e.call(this,t))})):this.each((function(){var t=k(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)}))},wrap:function(e){var t=_(e);return this.each((function(n){k(this).wrapAll(t?e.call(this,n):e)}))},unwrap:function(e){return this.parent(e).not("body").each((function(){k(this).replaceWith(this.childNodes)})),this}}),k.expr.pseudos.hidden=function(e){return!k.expr.pseudos.visible(e)},k.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},k.ajaxSettings.xhr=function(){try{return new i.XMLHttpRequest}catch(e){}};var qt={0:200,1223:204},Vt=k.ajaxSettings.xhr();m.cors=!!Vt&&"withCredentials"in Vt,m.ajax=Vt=!!Vt,k.ajaxTransport((function(e){var t,n;if(m.cors||Vt&&!e.crossDomain)return{send:function(r,o){var a,s=e.xhr();if(s.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(a in e.xhrFields)s[a]=e.xhrFields[a];for(a in e.mimeType&&s.overrideMimeType&&s.overrideMimeType(e.mimeType),e.crossDomain||r["X-Requested-With"]||(r["X-Requested-With"]="XMLHttpRequest"),r)s.setRequestHeader(a,r[a]);t=function(e){return function(){t&&(t=n=s.onload=s.onerror=s.onabort=s.ontimeout=s.onreadystatechange=null,"abort"===e?s.abort():"error"===e?"number"!=typeof s.status?o(0,"error"):o(s.status,s.statusText):o(qt[s.status]||s.status,s.statusText,"text"!==(s.responseType||"text")||"string"!=typeof s.responseText?{binary:s.response}:{text:s.responseText},s.getAllResponseHeaders()))}},s.onload=t(),n=s.onerror=s.ontimeout=t("error"),void 0!==s.onabort?s.onabort=n:s.onreadystatechange=function(){4===s.readyState&&i.setTimeout((function(){t&&n()}))},t=t("abort");try{s.send(e.hasContent&&e.data||null)}catch(e){if(t)throw e}},abort:function(){t&&t()}}})),k.ajaxPrefilter((function(e){e.crossDomain&&(e.contents.script=!1)})),k.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return k.globalEval(e),e}}}),k.ajaxPrefilter("script",(function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")})),k.ajaxTransport("script",(function(e){var t,n;if(e.crossDomain||e.scriptAttrs)return{send:function(i,r){t=k("<script>").attr(e.scriptAttrs||{}).prop({charset:e.scriptCharset,src:e.url}).on("load error",n=function(e){t.remove(),n=null,e&&r("error"===e.type?404:200,e.type)}),b.head.appendChild(t[0])},abort:function(){n&&n()}}}));var Kt,Gt=[],Zt=/(=)\?(?=&|$)|\?\?/;k.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Gt.pop()||k.expando+"_"+St.guid++;return this[e]=!0,e}}),k.ajaxPrefilter("json jsonp",(function(e,t,n){var r,o,a,s=!1!==e.jsonp&&(Zt.test(e.url)?"url":"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&Zt.test(e.data)&&"data");if(s||"jsonp"===e.dataTypes[0])return r=e.jsonpCallback=_(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,s?e[s]=e[s].replace(Zt,"$1"+r):!1!==e.jsonp&&(e.url+=(Et.test(e.url)?"&":"?")+e.jsonp+"="+r),e.converters["script json"]=function(){return a||k.error(r+" was not called"),a[0]},e.dataTypes[0]="json",o=i[r],i[r]=function(){a=arguments},n.always((function(){void 0===o?k(i).removeProp(r):i[r]=o,e[r]&&(e.jsonpCallback=t.jsonpCallback,Gt.push(r)),a&&_(o)&&o(a[0]),a=o=void 0})),"script"})),m.createHTMLDocument=((Kt=b.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===Kt.childNodes.length),k.parseHTML=function(e,t,n){return"string"!=typeof e?[]:("boolean"==typeof t&&(n=t,t=!1),t||(m.createHTMLDocument?((i=(t=b.implementation.createHTMLDocument("")).createElement("base")).href=b.location.href,t.head.appendChild(i)):t=b),o=!n&&[],(r=L.exec(e))?[t.createElement(r[1])]:(r=Ce([e],t,o),o&&o.length&&k(o).remove(),k.merge([],r.childNodes)));var i,r,o},k.fn.load=function(e,t,n){var i,r,o,a=this,s=e.indexOf(" ");return s>-1&&(i=vt(e.slice(s)),e=e.slice(0,s)),_(t)?(n=t,t=void 0):t&&"object"==typeof t&&(r="POST"),a.length>0&&k.ajax({url:e,type:r||"GET",dataType:"html",data:t}).done((function(e){o=arguments,a.html(i?k("<div>").append(k.parseHTML(e)).find(i):e)})).always(n&&function(e,t){a.each((function(){n.apply(this,o||[e.responseText,t,e])}))}),this},k.expr.pseudos.animated=function(e){return k.grep(k.timers,(function(t){return e===t.elem})).length},k.offset={setOffset:function(e,t,n){var i,r,o,a,s,l,c=k.css(e,"position"),h=k(e),u={};"static"===c&&(e.style.position="relative"),s=h.offset(),o=k.css(e,"top"),l=k.css(e,"left"),("absolute"===c||"fixed"===c)&&(o+l).indexOf("auto")>-1?(a=(i=h.position()).top,r=i.left):(a=parseFloat(o)||0,r=parseFloat(l)||0),_(t)&&(t=t.call(e,n,k.extend({},s))),null!=t.top&&(u.top=t.top-s.top+a),null!=t.left&&(u.left=t.left-s.left+r),"using"in t?t.using.call(e,u):h.css(u)}},k.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each((function(t){k.offset.setOffset(this,e,t)}));var t,n,i=this[0];return i?i.getClientRects().length?(t=i.getBoundingClientRect(),n=i.ownerDocument.defaultView,{top:t.top+n.pageYOffset,left:t.left+n.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var e,t,n,i=this[0],r={top:0,left:0};if("fixed"===k.css(i,"position"))t=i.getBoundingClientRect();else{for(t=this.offset(),n=i.ownerDocument,e=i.offsetParent||n.documentElement;e&&(e===n.body||e===n.documentElement)&&"static"===k.css(e,"position");)e=e.parentNode;e&&e!==i&&1===e.nodeType&&((r=k(e).offset()).top+=k.css(e,"borderTopWidth",!0),r.left+=k.css(e,"borderLeftWidth",!0))}return{top:t.top-r.top-k.css(i,"marginTop",!0),left:t.left-r.left-k.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map((function(){for(var e=this.offsetParent;e&&"static"===k.css(e,"position");)e=e.offsetParent;return e||ae}))}}),k.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},(function(e,t){var n="pageYOffset"===t;k.fn[e]=function(i){return q(this,(function(e,i,r){var o;if(v(e)?o=e:9===e.nodeType&&(o=e.defaultView),void 0===r)return o?o[t]:e[i];o?o.scrollTo(n?o.pageXOffset:r,n?r:o.pageYOffset):e[i]=r}),e,i,arguments.length)}})),k.each(["top","left"],(function(e,t){k.cssHooks[t]=Ke(m.pixelPosition,(function(e,n){if(n)return n=Ve(e,t),He.test(n)?k(e).position()[t]+"px":n}))})),k.each({Height:"height",Width:"width"},(function(e,t){k.each({padding:"inner"+e,content:t,"":"outer"+e},(function(n,i){k.fn[i]=function(r,o){var a=arguments.length&&(n||"boolean"!=typeof r),s=n||(!0===r||!0===o?"margin":"border");return q(this,(function(t,n,r){var o;return v(t)?0===i.indexOf("outer")?t["inner"+e]:t.document.documentElement["client"+e]:9===t.nodeType?(o=t.documentElement,Math.max(t.body["scroll"+e],o["scroll"+e],t.body["offset"+e],o["offset"+e],o["client"+e])):void 0===r?k.css(t,n,s):k.style(t,n,r,s)}),t,a?r:void 0,a)}}))})),k.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],(function(e,t){k.fn[t]=function(e){return this.on(t,e)}})),k.fn.extend({bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,i){return this.on(t,e,n,i)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)},hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),k.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),(function(e,t){k.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}));var Xt=/^[\s\uFEFF\xA0]+|([^\s\uFEFF\xA0])[\s\uFEFF\xA0]+$/g;k.proxy=function(e,t){var n,i,r;if("string"==typeof t&&(n=e[t],t=e,e=n),_(e))return i=s.call(arguments,2),r=function(){return e.apply(t||this,i.concat(s.call(arguments)))},r.guid=e.guid=e.guid||k.guid++,r},k.holdReady=function(e){e?k.readyWait++:k.ready(!0)},k.isArray=Array.isArray,k.parseJSON=JSON.parse,k.nodeName=R,k.isFunction=_,k.isWindow=v,k.camelCase=Z,k.type=x,k.now=Date.now,k.isNumeric=function(e){var t=k.type(e);return("number"===t||"string"===t)&&!isNaN(e-parseFloat(e))},k.trim=function(e){return null==e?"":(e+"").replace(Xt,"$1")},void 0===(n=function(){return k}.apply(t,[]))||(e.exports=n);var Yt=i.jQuery,Qt=i.$;return k.noConflict=function(e){return i.$===k&&(i.$=Qt),e&&i.jQuery===k&&(i.jQuery=Yt),k},void 0===r&&(i.jQuery=i.$=k),k}))},4211:function(e,t){!function(e){"use strict";function t(e){return"object"==typeof e&&"function"==typeof e.to}function n(e){e.parentElement.removeChild(e)}function i(e){return null!=e}function r(e){e.preventDefault()}function o(e){return"number"==typeof e&&!isNaN(e)&&isFinite(e)}function a(e,t,n){n>0&&(h(e,t),setTimeout((function(){u(e,t)}),n))}function s(e){return Math.max(Math.min(e,100),0)}function l(e){return Array.isArray(e)?e:[e]}function c(e){var t=(e=String(e)).split(".");return t.length>1?t[1].length:0}function h(e,t){e.classList&&!/\s/.test(t)?e.classList.add(t):e.className+=" "+t}function u(e,t){e.classList&&!/\s/.test(t)?e.classList.remove(t):e.className=e.className.replace(new RegExp("(^|\\b)"+t.split(" ").join("|")+"(\\b|$)","gi")," ")}function f(e){var t=void 0!==window.pageXOffset,n="CSS1Compat"===(e.compatMode||"");return{x:t?window.pageXOffset:n?e.documentElement.scrollLeft:e.body.scrollLeft,y:t?window.pageYOffset:n?e.documentElement.scrollTop:e.body.scrollTop}}function d(e,t){return 100/(t-e)}function p(e,t,n){return 100*t/(e[n+1]-e[n])}function g(e,t){for(var n=1;e>=t[n];)n+=1;return n}function m(e,t,n){if(n>=e.slice(-1)[0])return 100;var i=g(n,e),r=e[i-1],o=e[i],a=t[i-1],s=t[i];return a+function(e,t){return p(e,e[0]<0?t+Math.abs(e[0]):t-e[0],0)}([r,o],n)/d(a,s)}function _(e,t,n,i){if(100===i)return i;var r=g(i,e),o=e[r-1],a=e[r];return n?i-o>(a-o)/2?a:o:t[r-1]?e[r-1]+function(e,t){return Math.round(e/t)*t}(i-e[r-1],t[r-1]):i}var v,b;e.PipsMode=void 0,(b=e.PipsMode||(e.PipsMode={})).Range="range",b.Steps="steps",b.Positions="positions",b.Count="count",b.Values="values",e.PipsType=void 0,(v=e.PipsType||(e.PipsType={}))[v.None=-1]="None",v[v.NoValue=0]="NoValue",v[v.LargeValue=1]="LargeValue",v[v.SmallValue=2]="SmallValue";var y=function(){function e(e,t,n){var i;this.xPct=[],this.xVal=[],this.xSteps=[],this.xNumSteps=[],this.xHighestCompleteStep=[],this.xSteps=[n||!1],this.xNumSteps=[!1],this.snap=t;var r=[];for(Object.keys(e).forEach((function(t){r.push([l(e[t]),t])})),r.sort((function(e,t){return e[0][0]-t[0][0]})),i=0;i<r.length;i++)this.handleEntryPoint(r[i][1],r[i][0]);for(this.xNumSteps=this.xSteps.slice(0),i=0;i<this.xNumSteps.length;i++)this.handleStepPoint(i,this.xNumSteps[i])}return e.prototype.getDistance=function(e){for(var t=[],n=0;n<this.xNumSteps.length-1;n++)t[n]=p(this.xVal,e,n);return t},e.prototype.getAbsoluteDistance=function(e,t,n){var i,r=0;if(e<this.xPct[this.xPct.length-1])for(;e>this.xPct[r+1];)r++;else e===this.xPct[this.xPct.length-1]&&(r=this.xPct.length-2);n||e!==this.xPct[r+1]||r++,null===t&&(t=[]);var o=1,a=t[r],s=0,l=0,c=0,h=0;for(i=n?(e-this.xPct[r])/(this.xPct[r+1]-this.xPct[r]):(this.xPct[r+1]-e)/(this.xPct[r+1]-this.xPct[r]);a>0;)s=this.xPct[r+1+h]-this.xPct[r+h],t[r+h]*o+100-100*i>100?(l=s*i,o=(a-100*i)/t[r+h],i=1):(l=t[r+h]*s/100*o,o=0),n?(c-=l,this.xPct.length+h>=1&&h--):(c+=l,this.xPct.length-h>=1&&h++),a=t[r+h]*o;return e+c},e.prototype.toStepping=function(e){return m(this.xVal,this.xPct,e)},e.prototype.fromStepping=function(e){return function(e,t,n){if(n>=100)return e.slice(-1)[0];var i=g(n,t),r=e[i-1],o=e[i],a=t[i-1];return function(e,t){return t*(e[1]-e[0])/100+e[0]}([r,o],(n-a)*d(a,t[i]))}(this.xVal,this.xPct,e)},e.prototype.getStep=function(e){return _(this.xPct,this.xSteps,this.snap,e)},e.prototype.getDefaultStep=function(e,t,n){var i=g(e,this.xPct);return(100===e||t&&e===this.xPct[i-1])&&(i=Math.max(i-1,1)),(this.xVal[i]-this.xVal[i-1])/n},e.prototype.getNearbySteps=function(e){var t=g(e,this.xPct);return{stepBefore:{startValue:this.xVal[t-2],step:this.xNumSteps[t-2],highestStep:this.xHighestCompleteStep[t-2]},thisStep:{startValue:this.xVal[t-1],step:this.xNumSteps[t-1],highestStep:this.xHighestCompleteStep[t-1]},stepAfter:{startValue:this.xVal[t],step:this.xNumSteps[t],highestStep:this.xHighestCompleteStep[t]}}},e.prototype.countStepDecimals=function(){var e=this.xNumSteps.map(c);return Math.max.apply(null,e)},e.prototype.hasNoSize=function(){return this.xVal[0]===this.xVal[this.xVal.length-1]},e.prototype.convert=function(e){return this.getStep(this.toStepping(e))},e.prototype.handleEntryPoint=function(e,t){var n;if(!o(n="min"===e?0:"max"===e?100:parseFloat(e))||!o(t[0]))throw new Error("noUiSlider: 'range' value isn't numeric.");this.xPct.push(n),this.xVal.push(t[0]);var i=Number(t[1]);n?this.xSteps.push(!isNaN(i)&&i):isNaN(i)||(this.xSteps[0]=i),this.xHighestCompleteStep.push(0)},e.prototype.handleStepPoint=function(e,t){if(t)if(this.xVal[e]!==this.xVal[e+1]){this.xSteps[e]=p([this.xVal[e],this.xVal[e+1]],t,0)/d(this.xPct[e],this.xPct[e+1]);var n=(this.xVal[e+1]-this.xVal[e])/this.xNumSteps[e],i=Math.ceil(Number(n.toFixed(3))-1),r=this.xVal[e]+this.xNumSteps[e]*i;this.xHighestCompleteStep[e]=r}else this.xSteps[e]=this.xHighestCompleteStep[e]=this.xVal[e]},e}(),w={to:function(e){return void 0===e?"":e.toFixed(2)},from:Number},x={target:"target",base:"base",origin:"origin",handle:"handle",handleLower:"handle-lower",handleUpper:"handle-upper",touchArea:"touch-area",horizontal:"horizontal",vertical:"vertical",background:"background",connect:"connect",connects:"connects",ltr:"ltr",rtl:"rtl",textDirectionLtr:"txt-dir-ltr",textDirectionRtl:"txt-dir-rtl",draggable:"draggable",drag:"state-drag",tap:"state-tap",active:"active",tooltip:"tooltip",pips:"pips",pipsHorizontal:"pips-horizontal",pipsVertical:"pips-vertical",marker:"marker",markerHorizontal:"marker-horizontal",markerVertical:"marker-vertical",markerNormal:"marker-normal",markerLarge:"marker-large",markerSub:"marker-sub",value:"value",valueHorizontal:"value-horizontal",valueVertical:"value-vertical",valueNormal:"value-normal",valueLarge:"value-large",valueSub:"value-sub"},C=".__tooltips",k=".__aria";function S(e,t){if(!o(t))throw new Error("noUiSlider: 'step' is not numeric.");e.singleStep=t}function E(e,t){if(!o(t))throw new Error("noUiSlider: 'keyboardPageMultiplier' is not numeric.");e.keyboardPageMultiplier=t}function D(e,t){if(!o(t))throw new Error("noUiSlider: 'keyboardMultiplier' is not numeric.");e.keyboardMultiplier=t}function A(e,t){if(!o(t))throw new Error("noUiSlider: 'keyboardDefaultStep' is not numeric.");e.keyboardDefaultStep=t}function M(e,t){if("object"!=typeof t||Array.isArray(t))throw new Error("noUiSlider: 'range' is not an object.");if(void 0===t.min||void 0===t.max)throw new Error("noUiSlider: Missing 'min' or 'max' in 'range'.");e.spectrum=new y(t,e.snap||!1,e.singleStep)}function R(e,t){if(t=l(t),!Array.isArray(t)||!t.length)throw new Error("noUiSlider: 'start' option is incorrect.");e.handles=t.length,e.start=t}function L(e,t){if("boolean"!=typeof t)throw new Error("noUiSlider: 'snap' option must be a boolean.");e.snap=t}function T(e,t){if("boolean"!=typeof t)throw new Error("noUiSlider: 'animate' option must be a boolean.");e.animate=t}function P(e,t){if("number"!=typeof t)throw new Error("noUiSlider: 'animationDuration' option must be a number.");e.animationDuration=t}function z(e,t){var n,i=[!1];if("lower"===t?t=[!0,!1]:"upper"===t&&(t=[!1,!0]),!0===t||!1===t){for(n=1;n<e.handles;n++)i.push(t);i.push(!1)}else{if(!Array.isArray(t)||!t.length||t.length!==e.handles+1)throw new Error("noUiSlider: 'connect' option doesn't match handle count.");i=t}e.connect=i}function I(e,t){switch(t){case"horizontal":e.ort=0;break;case"vertical":e.ort=1;break;default:throw new Error("noUiSlider: 'orientation' option is invalid.")}}function O(e,t){if(!o(t))throw new Error("noUiSlider: 'margin' option must be numeric.");0!==t&&(e.margin=e.spectrum.getDistance(t))}function F(e,t){if(!o(t))throw new Error("noUiSlider: 'limit' option must be numeric.");if(e.limit=e.spectrum.getDistance(t),!e.limit||e.handles<2)throw new Error("noUiSlider: 'limit' option is only supported on linear sliders with 2 or more handles.")}function B(e,t){var n;if(!o(t)&&!Array.isArray(t))throw new Error("noUiSlider: 'padding' option must be numeric or array of exactly 2 numbers.");if(Array.isArray(t)&&2!==t.length&&!o(t[0])&&!o(t[1]))throw new Error("noUiSlider: 'padding' option must be numeric or array of exactly 2 numbers.");if(0!==t){for(Array.isArray(t)||(t=[t,t]),e.padding=[e.spectrum.getDistance(t[0]),e.spectrum.getDistance(t[1])],n=0;n<e.spectrum.xNumSteps.length-1;n++)if(e.padding[0][n]<0||e.padding[1][n]<0)throw new Error("noUiSlider: 'padding' option must be a positive number(s).");var i=t[0]+t[1],r=e.spectrum.xVal[0];if(i/(e.spectrum.xVal[e.spectrum.xVal.length-1]-r)>1)throw new Error("noUiSlider: 'padding' option must not exceed 100% of the range.")}}function N(e,t){switch(t){case"ltr":e.dir=0;break;case"rtl":e.dir=1;break;default:throw new Error("noUiSlider: 'direction' option was not recognized.")}}function H(e,t){if("string"!=typeof t)throw new Error("noUiSlider: 'behaviour' must be a string containing options.");var n=t.indexOf("tap")>=0,i=t.indexOf("drag")>=0,r=t.indexOf("fixed")>=0,o=t.indexOf("snap")>=0,a=t.indexOf("hover")>=0,s=t.indexOf("unconstrained")>=0,l=t.indexOf("drag-all")>=0,c=t.indexOf("smooth-steps")>=0;if(r){if(2!==e.handles)throw new Error("noUiSlider: 'fixed' behaviour must be used with 2 handles");O(e,e.start[1]-e.start[0])}if(s&&(e.margin||e.limit))throw new Error("noUiSlider: 'unconstrained' behaviour cannot be used with margin or limit");e.events={tap:n||o,drag:i,dragAll:l,smoothSteps:c,fixed:r,snap:o,hover:a,unconstrained:s}}function U(e,n){if(!1!==n)if(!0===n||t(n)){e.tooltips=[];for(var i=0;i<e.handles;i++)e.tooltips.push(n)}else{if((n=l(n)).length!==e.handles)throw new Error("noUiSlider: must pass a formatter for all handles.");n.forEach((function(e){if("boolean"!=typeof e&&!t(e))throw new Error("noUiSlider: 'tooltips' must be passed a formatter or 'false'.")})),e.tooltips=n}}function $(e,t){if(t.length!==e.handles)throw new Error("noUiSlider: must pass a attributes for all handles.");e.handleAttributes=t}function j(e,n){if(!t(n))throw new Error("noUiSlider: 'ariaFormat' requires 'to' method.");e.ariaFormat=n}function W(e,n){if(!function(e){return t(e)&&"function"==typeof e.from}(n))throw new Error("noUiSlider: 'format' requires 'to' and 'from' methods.");e.format=n}function q(e,t){if("boolean"!=typeof t)throw new Error("noUiSlider: 'keyboardSupport' option must be a boolean.");e.keyboardSupport=t}function V(e,t){e.documentElement=t}function K(e,t){if("string"!=typeof t&&!1!==t)throw new Error("noUiSlider: 'cssPrefix' must be a string or `false`.");e.cssPrefix=t}function G(e,t){if("object"!=typeof t)throw new Error("noUiSlider: 'cssClasses' must be an object.");"string"==typeof e.cssPrefix?(e.cssClasses={},Object.keys(t).forEach((function(n){e.cssClasses[n]=e.cssPrefix+t[n]}))):e.cssClasses=t}function Z(e){var t={margin:null,limit:null,padding:null,animate:!0,animationDuration:300,ariaFormat:w,format:w},n={step:{r:!1,t:S},keyboardPageMultiplier:{r:!1,t:E},keyboardMultiplier:{r:!1,t:D},keyboardDefaultStep:{r:!1,t:A},start:{r:!0,t:R},connect:{r:!0,t:z},direction:{r:!0,t:N},snap:{r:!1,t:L},animate:{r:!1,t:T},animationDuration:{r:!1,t:P},range:{r:!0,t:M},orientation:{r:!1,t:I},margin:{r:!1,t:O},limit:{r:!1,t:F},padding:{r:!1,t:B},behaviour:{r:!0,t:H},ariaFormat:{r:!1,t:j},format:{r:!1,t:W},tooltips:{r:!1,t:U},keyboardSupport:{r:!0,t:q},documentElement:{r:!1,t:V},cssPrefix:{r:!0,t:K},cssClasses:{r:!0,t:G},handleAttributes:{r:!1,t:$}},r={connect:!1,direction:"ltr",behaviour:"tap",orientation:"horizontal",keyboardSupport:!0,cssPrefix:"noUi-",cssClasses:x,keyboardPageMultiplier:5,keyboardMultiplier:1,keyboardDefaultStep:10};e.format&&!e.ariaFormat&&(e.ariaFormat=e.format),Object.keys(n).forEach((function(o){if(i(e[o])||void 0!==r[o])n[o].t(t,i(e[o])?e[o]:r[o]);else if(n[o].r)throw new Error("noUiSlider: '"+o+"' is required.")})),t.pips=e.pips;var o=document.createElement("div"),a=void 0!==o.style.msTransform,s=void 0!==o.style.transform;t.transformRule=s?"transform":a?"msTransform":"webkitTransform";return t.style=[["left","top"],["right","bottom"]][t.dir][t.ort],t}function X(t,o,c){var d,p,g,m,_,v,b,y=window.navigator.pointerEnabled?{start:"pointerdown",move:"pointermove",end:"pointerup"}:window.navigator.msPointerEnabled?{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}:{start:"mousedown touchstart",move:"mousemove touchmove",end:"mouseup touchend"},w=window.CSS&&CSS.supports&&CSS.supports("touch-action","none")&&function(){var e=!1;try{var t=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("test",null,t)}catch(e){}return e}(),x=t,S=o.spectrum,E=[],D=[],A=[],M=0,R={},L=t.ownerDocument,T=o.documentElement||L.documentElement,P=L.body,z="rtl"===L.dir||1===o.ort?0:100;function I(e,t){var n=L.createElement("div");return t&&h(n,t),e.appendChild(n),n}function O(e,t){var n=I(e,o.cssClasses.origin),i=I(n,o.cssClasses.handle);if(I(i,o.cssClasses.touchArea),i.setAttribute("data-handle",String(t)),o.keyboardSupport&&(i.setAttribute("tabindex","0"),i.addEventListener("keydown",(function(e){return function(e,t){if(N()||H(t))return!1;var n=["Left","Right"],i=["Down","Up"],r=["PageDown","PageUp"],a=["Home","End"];o.dir&&!o.ort?n.reverse():o.ort&&!o.dir&&(i.reverse(),r.reverse());var s,l=e.key.replace("Arrow",""),c=l===r[0],h=l===r[1],u=l===i[0]||l===n[0]||c,f=l===i[1]||l===n[1]||h,d=l===a[0],p=l===a[1];if(!(u||f||d||p))return!0;if(e.preventDefault(),f||u){var g=u?0:1,m=_e(t)[g];if(null===m)return!1;!1===m&&(m=S.getDefaultStep(D[t],u,o.keyboardDefaultStep)),m*=h||c?o.keyboardPageMultiplier:o.keyboardMultiplier,m=Math.max(m,1e-7),m*=u?-1:1,s=E[t]+m}else s=p?o.spectrum.xVal[o.spectrum.xVal.length-1]:o.spectrum.xVal[0];return fe(t,S.toStepping(s),!0,!0),ae("slide",t),ae("update",t),ae("change",t),ae("set",t),!1}(e,t)}))),void 0!==o.handleAttributes){var r=o.handleAttributes[t];Object.keys(r).forEach((function(e){i.setAttribute(e,r[e])}))}return i.setAttribute("role","slider"),i.setAttribute("aria-orientation",o.ort?"vertical":"horizontal"),0===t?h(i,o.cssClasses.handleLower):t===o.handles-1&&h(i,o.cssClasses.handleUpper),n}function F(e,t){return!!t&&I(e,o.cssClasses.connect)}function B(e,t){return!(!o.tooltips||!o.tooltips[t])&&I(e.firstChild,o.cssClasses.tooltip)}function N(){return x.hasAttribute("disabled")}function H(e){return p[e].hasAttribute("disabled")}function U(){_&&(oe("update"+C),_.forEach((function(e){e&&n(e)})),_=null)}function $(){U(),_=p.map(B),re("update"+C,(function(e,t,n){if(_&&o.tooltips&&!1!==_[t]){var i=e[t];!0!==o.tooltips[t]&&(i=o.tooltips[t].to(n[t])),_[t].innerHTML=i}}))}function j(e,t){return e.map((function(e){return S.fromStepping(t?S.getStep(e):e)}))}function W(t){var n,i=function(t){if(t.mode===e.PipsMode.Range||t.mode===e.PipsMode.Steps)return S.xVal;if(t.mode===e.PipsMode.Count){if(t.values<2)throw new Error("noUiSlider: 'values' (>= 2) required for mode 'count'.");for(var n=t.values-1,i=100/n,r=[];n--;)r[n]=n*i;return r.push(100),j(r,t.stepped)}return t.mode===e.PipsMode.Positions?j(t.values,t.stepped):t.mode===e.PipsMode.Values?t.stepped?t.values.map((function(e){return S.fromStepping(S.getStep(S.toStepping(e)))})):t.values:[]}(t),r={},o=S.xVal[0],a=S.xVal[S.xVal.length-1],s=!1,l=!1,c=0;return(n=i.slice().sort((function(e,t){return e-t})),i=n.filter((function(e){return!this[e]&&(this[e]=!0)}),{}))[0]!==o&&(i.unshift(o),s=!0),i[i.length-1]!==a&&(i.push(a),l=!0),i.forEach((function(n,o){var a,h,u,f,d,p,g,m,_,v,b=n,y=i[o+1],w=t.mode===e.PipsMode.Steps;for(w&&(a=S.xNumSteps[o]),a||(a=y-b),void 0===y&&(y=b),a=Math.max(a,1e-7),h=b;h<=y;h=Number((h+a).toFixed(7))){for(m=(d=(f=S.toStepping(h))-c)/(t.density||1),v=d/(_=Math.round(m)),u=1;u<=_;u+=1)r[(p=c+u*v).toFixed(5)]=[S.fromStepping(p),0];g=i.indexOf(h)>-1?e.PipsType.LargeValue:w?e.PipsType.SmallValue:e.PipsType.NoValue,!o&&s&&h!==y&&(g=0),h===y&&l||(r[f.toFixed(5)]=[h,g]),c=f}})),r}function q(t,n,i){var r,a,s=L.createElement("div"),l=((r={})[e.PipsType.None]="",r[e.PipsType.NoValue]=o.cssClasses.valueNormal,r[e.PipsType.LargeValue]=o.cssClasses.valueLarge,r[e.PipsType.SmallValue]=o.cssClasses.valueSub,r),c=((a={})[e.PipsType.None]="",a[e.PipsType.NoValue]=o.cssClasses.markerNormal,a[e.PipsType.LargeValue]=o.cssClasses.markerLarge,a[e.PipsType.SmallValue]=o.cssClasses.markerSub,a),u=[o.cssClasses.valueHorizontal,o.cssClasses.valueVertical],f=[o.cssClasses.markerHorizontal,o.cssClasses.markerVertical];function d(e,t){var n=t===o.cssClasses.value,i=n?l:c;return t+" "+(n?u:f)[o.ort]+" "+i[e]}return h(s,o.cssClasses.pips),h(s,0===o.ort?o.cssClasses.pipsHorizontal:o.cssClasses.pipsVertical),Object.keys(t).forEach((function(r){!function(t,r,a){if((a=n?n(r,a):a)!==e.PipsType.None){var l=I(s,!1);l.className=d(a,o.cssClasses.marker),l.style[o.style]=t+"%",a>e.PipsType.NoValue&&((l=I(s,!1)).className=d(a,o.cssClasses.value),l.setAttribute("data-value",String(r)),l.style[o.style]=t+"%",l.innerHTML=String(i.to(r)))}}(r,t[r][0],t[r][1])})),s}function V(){m&&(n(m),m=null)}function K(e){V();var t=W(e),n=e.filter,i=e.format||{to:function(e){return String(Math.round(e))}};return m=x.appendChild(q(t,n,i))}function G(){var e=d.getBoundingClientRect(),t="offset"+["Width","Height"][o.ort];return 0===o.ort?e.width||d[t]:e.height||d[t]}function X(e,t,n,i){var r=function(r){var a,s,l=function(e,t,n){var i=0===e.type.indexOf("touch"),r=0===e.type.indexOf("mouse"),o=0===e.type.indexOf("pointer"),a=0,s=0;if(0===e.type.indexOf("MSPointer")&&(o=!0),"mousedown"===e.type&&!e.buttons&&!e.touches)return!1;if(i){var l=function(t){var i=t.target;return i===n||n.contains(i)||e.composed&&e.composedPath().shift()===n};if("touchstart"===e.type){var c=Array.prototype.filter.call(e.touches,l);if(c.length>1)return!1;a=c[0].pageX,s=c[0].pageY}else{var h=Array.prototype.find.call(e.changedTouches,l);if(!h)return!1;a=h.pageX,s=h.pageY}}return t=t||f(L),(r||o)&&(a=e.clientX+t.x,s=e.clientY+t.y),e.pageOffset=t,e.points=[a,s],e.cursor=r||o,e}(r,i.pageOffset,i.target||t);return!!l&&!(N()&&!i.doNotReject)&&(a=x,s=o.cssClasses.tap,!((a.classList?a.classList.contains(s):new RegExp("\\b"+s+"\\b").test(a.className))&&!i.doNotReject))&&!(e===y.start&&void 0!==l.buttons&&l.buttons>1)&&(!i.hover||!l.buttons)&&(w||l.preventDefault(),l.calcPoint=l.points[o.ort],void n(l,i))},a=[];return e.split(" ").forEach((function(e){t.addEventListener(e,r,!!w&&{passive:!0}),a.push([e,r])})),a}function Y(e){var t,n,i,r,a,l,c=100*(e-(t=d,n=o.ort,i=t.getBoundingClientRect(),r=t.ownerDocument,a=r.documentElement,l=f(r),/webkit.*Chrome.*Mobile/i.test(navigator.userAgent)&&(l.x=0),n?i.top+l.y-a.clientTop:i.left+l.x-a.clientLeft))/G();return c=s(c),o.dir?100-c:c}function Q(e,t){"mouseout"===e.type&&"HTML"===e.target.nodeName&&null===e.relatedTarget&&ee(e,t)}function J(e,t){if(-1===navigator.appVersion.indexOf("MSIE 9")&&0===e.buttons&&0!==t.buttonsProperty)return ee(e,t);var n=(o.dir?-1:1)*(e.calcPoint-t.startCalcPoint);ce(n>0,100*n/t.baseSize,t.locations,t.handleNumbers,t.connect)}function ee(e,t){t.handle&&(u(t.handle,o.cssClasses.active),M-=1),t.listeners.forEach((function(e){T.removeEventListener(e[0],e[1])})),0===M&&(u(x,o.cssClasses.drag),ue(),e.cursor&&(P.style.cursor="",P.removeEventListener("selectstart",r))),o.events.smoothSteps&&(t.handleNumbers.forEach((function(e){fe(e,D[e],!0,!0,!1,!1)})),t.handleNumbers.forEach((function(e){ae("update",e)}))),t.handleNumbers.forEach((function(e){ae("change",e),ae("set",e),ae("end",e)}))}function te(e,t){if(!t.handleNumbers.some(H)){var n;1===t.handleNumbers.length&&(n=p[t.handleNumbers[0]].children[0],M+=1,h(n,o.cssClasses.active)),e.stopPropagation();var i=[],a=X(y.move,T,J,{target:e.target,handle:n,connect:t.connect,listeners:i,startCalcPoint:e.calcPoint,baseSize:G(),pageOffset:e.pageOffset,handleNumbers:t.handleNumbers,buttonsProperty:e.buttons,locations:D.slice()}),s=X(y.end,T,ee,{target:e.target,handle:n,listeners:i,doNotReject:!0,handleNumbers:t.handleNumbers}),l=X("mouseout",T,Q,{target:e.target,handle:n,listeners:i,doNotReject:!0,handleNumbers:t.handleNumbers});i.push.apply(i,a.concat(s,l)),e.cursor&&(P.style.cursor=getComputedStyle(e.target).cursor,p.length>1&&h(x,o.cssClasses.drag),P.addEventListener("selectstart",r,!1)),t.handleNumbers.forEach((function(e){ae("start",e)}))}}function ne(e){e.stopPropagation();var t=Y(e.calcPoint),n=function(e){var t=100,n=!1;return p.forEach((function(i,r){if(!H(r)){var o=D[r],a=Math.abs(o-e);(a<t||a<=t&&e>o||100===a&&100===t)&&(n=r,t=a)}})),n}(t);!1!==n&&(o.events.snap||a(x,o.cssClasses.tap,o.animationDuration),fe(n,t,!0,!0),ue(),ae("slide",n,!0),ae("update",n,!0),o.events.snap?te(e,{handleNumbers:[n]}):(ae("change",n,!0),ae("set",n,!0)))}function ie(e){var t=Y(e.calcPoint),n=S.getStep(t),i=S.fromStepping(n);Object.keys(R).forEach((function(e){"hover"===e.split(".")[0]&&R[e].forEach((function(e){e.call(ve,i)}))}))}function re(e,t){R[e]=R[e]||[],R[e].push(t),"update"===e.split(".")[0]&&p.forEach((function(e,t){ae("update",t)}))}function oe(e){var t=e&&e.split(".")[0],n=t?e.substring(t.length):e;Object.keys(R).forEach((function(e){var i=e.split(".")[0],r=e.substring(i.length);t&&t!==i||n&&n!==r||function(e){return e===k||e===C}(r)&&n!==r||delete R[e]}))}function ae(e,t,n){Object.keys(R).forEach((function(i){var r=i.split(".")[0];e===r&&R[i].forEach((function(e){e.call(ve,E.map(o.format.to),t,E.slice(),n||!1,D.slice(),ve)}))}))}function se(e,t,n,i,r,a,l){var c;return p.length>1&&!o.events.unconstrained&&(i&&t>0&&(c=S.getAbsoluteDistance(e[t-1],o.margin,!1),n=Math.max(n,c)),r&&t<p.length-1&&(c=S.getAbsoluteDistance(e[t+1],o.margin,!0),n=Math.min(n,c))),p.length>1&&o.limit&&(i&&t>0&&(c=S.getAbsoluteDistance(e[t-1],o.limit,!1),n=Math.min(n,c)),r&&t<p.length-1&&(c=S.getAbsoluteDistance(e[t+1],o.limit,!0),n=Math.max(n,c))),o.padding&&(0===t&&(c=S.getAbsoluteDistance(0,o.padding[0],!1),n=Math.max(n,c)),t===p.length-1&&(c=S.getAbsoluteDistance(100,o.padding[1],!0),n=Math.min(n,c))),l||(n=S.getStep(n)),!((n=s(n))===e[t]&&!a)&&n}function le(e,t){var n=o.ort;return(n?t:e)+", "+(n?e:t)}function ce(e,t,n,i,r){var a=n.slice(),s=i[0],l=o.events.smoothSteps,c=[!e,e],h=[e,!e];i=i.slice(),e&&i.reverse(),i.length>1?i.forEach((function(e,n){var i=se(a,e,a[e]+t,c[n],h[n],!1,l);!1===i?t=0:(t=i-a[e],a[e]=i)})):c=h=[!0];var u=!1;i.forEach((function(e,i){u=fe(e,n[e]+t,c[i],h[i],!1,l)||u})),u&&(i.forEach((function(e){ae("update",e),ae("slide",e)})),null!=r&&ae("drag",s))}function he(e,t){return o.dir?100-e-t:e}function ue(){A.forEach((function(e){var t=D[e]>50?-1:1,n=3+(p.length+t*e);p[e].style.zIndex=String(n)}))}function fe(e,t,n,i,r,a){return r||(t=se(D,e,t,n,i,!1,a)),!1!==t&&(function(e,t){D[e]=t,E[e]=S.fromStepping(t);var n="translate("+le(he(t,0)-z+"%","0")+")";p[e].style[o.transformRule]=n,de(e),de(e+1)}(e,t),!0)}function de(e){if(g[e]){var t=0,n=100;0!==e&&(t=D[e-1]),e!==g.length-1&&(n=D[e]);var i=n-t,r="translate("+le(he(t,i)+"%","0")+")",a="scale("+le(i/100,"1")+")";g[e].style[o.transformRule]=r+" "+a}}function pe(e,t){return null===e||!1===e||void 0===e?D[t]:("number"==typeof e&&(e=String(e)),!1!==(e=o.format.from(e))&&(e=S.toStepping(e)),!1===e||isNaN(e)?D[t]:e)}function ge(e,t,n){var i=l(e),r=void 0===D[0];t=void 0===t||t,o.animate&&!r&&a(x,o.cssClasses.tap,o.animationDuration),A.forEach((function(e){fe(e,pe(i[e],e),!0,!1,n)}));var s=1===A.length?0:1;if(r&&S.hasNoSize()&&(n=!0,D[0]=0,A.length>1)){var c=100/(A.length-1);A.forEach((function(e){D[e]=e*c}))}for(;s<A.length;++s)A.forEach((function(e){fe(e,D[e],!0,!0,n)}));ue(),A.forEach((function(e){ae("update",e),null!==i[e]&&t&&ae("set",e)}))}function me(e){if(void 0===e&&(e=!1),e)return 1===E.length?E[0]:E.slice(0);var t=E.map(o.format.to);return 1===t.length?t[0]:t}function _e(e){var t=D[e],n=S.getNearbySteps(t),i=E[e],r=n.thisStep.step,a=null;if(o.snap)return[i-n.stepBefore.startValue||null,n.stepAfter.startValue-i||null];!1!==r&&i+r>n.stepAfter.startValue&&(r=n.stepAfter.startValue-i),a=i>n.thisStep.startValue?n.thisStep.step:!1!==n.stepBefore.step&&i-n.stepBefore.highestStep,100===t?r=null:0===t&&(a=null);var s=S.countStepDecimals();return null!==r&&!1!==r&&(r=Number(r.toFixed(s))),null!==a&&!1!==a&&(a=Number(a.toFixed(s))),[a,r]}h(b=x,o.cssClasses.target),0===o.dir?h(b,o.cssClasses.ltr):h(b,o.cssClasses.rtl),0===o.ort?h(b,o.cssClasses.horizontal):h(b,o.cssClasses.vertical),h(b,"rtl"===getComputedStyle(b).direction?o.cssClasses.textDirectionRtl:o.cssClasses.textDirectionLtr),d=I(b,o.cssClasses.base),function(e,t){var n=I(t,o.cssClasses.connects);p=[],(g=[]).push(F(n,e[0]));for(var i=0;i<o.handles;i++)p.push(O(t,i)),A[i]=i,g.push(F(n,e[i+1]))}(o.connect,d),(v=o.events).fixed||p.forEach((function(e,t){X(y.start,e.children[0],te,{handleNumbers:[t]})})),v.tap&&X(y.start,d,ne,{}),v.hover&&X(y.move,d,ie,{hover:!0}),v.drag&&g.forEach((function(e,t){if(!1!==e&&0!==t&&t!==g.length-1){var n=p[t-1],i=p[t],r=[e],a=[n,i],s=[t-1,t];h(e,o.cssClasses.draggable),v.fixed&&(r.push(n.children[0]),r.push(i.children[0])),v.dragAll&&(a=p,s=A),r.forEach((function(t){X(y.start,t,te,{handles:a,handleNumbers:s,connect:e})}))}})),ge(o.start),o.pips&&K(o.pips),o.tooltips&&$(),oe("update"+k),re("update"+k,(function(e,t,n,i,r){A.forEach((function(e){var t=p[e],i=se(D,e,0,!0,!0,!0),a=se(D,e,100,!0,!0,!0),s=r[e],l=String(o.ariaFormat.to(n[e]));i=S.fromStepping(i).toFixed(1),a=S.fromStepping(a).toFixed(1),s=S.fromStepping(s).toFixed(1),t.children[0].setAttribute("aria-valuemin",i),t.children[0].setAttribute("aria-valuemax",a),t.children[0].setAttribute("aria-valuenow",s),t.children[0].setAttribute("aria-valuetext",l)}))}));var ve={destroy:function(){for(oe(k),oe(C),Object.keys(o.cssClasses).forEach((function(e){u(x,o.cssClasses[e])}));x.firstChild;)x.removeChild(x.firstChild);delete x.noUiSlider},steps:function(){return A.map(_e)},on:re,off:oe,get:me,set:ge,setHandle:function(e,t,n,i){if(!((e=Number(e))>=0&&e<A.length))throw new Error("noUiSlider: invalid handle number, got: "+e);fe(e,pe(t,e),!0,!0,i),ae("update",e),n&&ae("set",e)},reset:function(e){ge(o.start,e)},__moveHandles:function(e,t,n){ce(e,t,D,n)},options:c,updateOptions:function(e,t){var n=me(),r=["margin","limit","padding","range","animate","snap","step","format","pips","tooltips"];r.forEach((function(t){void 0!==e[t]&&(c[t]=e[t])}));var a=Z(c);r.forEach((function(t){void 0!==e[t]&&(o[t]=a[t])})),S=a.spectrum,o.margin=a.margin,o.limit=a.limit,o.padding=a.padding,o.pips?K(o.pips):V(),o.tooltips?$():U(),D=[],ge(i(e.start)?e.start:n,t)},target:x,removePips:V,removeTooltips:U,getPositions:function(){return D.slice()},getTooltips:function(){return _},getOrigins:function(){return p},pips:K};return ve}function Y(e,t){if(!e||!e.nodeName)throw new Error("noUiSlider: create requires a single element, got: "+e);if(e.noUiSlider)throw new Error("noUiSlider: Slider was already initialized.");var n=X(e,Z(t),t);return e.noUiSlider=n,n}var Q={__spectrum:y,cssClasses:x,create:Y};e.create=Y,e.cssClasses=x,e.default=Q,Object.defineProperty(e,"__esModule",{value:!0})}(t)},1550:function(e){e.exports=function(){"use strict";var e=function(e){return e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||e instanceof Float32Array||e instanceof Float64Array||e instanceof Uint8ClampedArray},t=function(e,t){for(var n=Object.keys(t),i=0;i<n.length;++i)e[n[i]]=t[n[i]];return e},n="\n";function i(e){var t=new Error("(regl) "+e);throw console.error(t),t}function r(e,t){e||i(t)}function o(e){return e?": "+e:""}function a(e,t){switch(t){case"number":return"number"==typeof e;case"object":return"object"==typeof e;case"string":return"string"==typeof e;case"boolean":return"boolean"==typeof e;case"function":return"function"==typeof e;case"undefined":return void 0===e;case"symbol":return"symbol"==typeof e}}function s(e,t,n){t.indexOf(e)<0&&i("invalid value"+o(n)+". must be one of: "+t)}var l=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function c(e,t){for(e+="";e.length<t;)e=" "+e;return e}function h(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function u(e,t){this.number=e,this.line=t,this.errors=[]}function f(e,t,n){this.file=e,this.line=t,this.message=n}function d(){var e=new Error,t=(e.stack||e).toString(),n=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(t);if(n)return n[1];var i=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(t);return i?i[1]:"unknown"}function p(){var e=new Error,t=(e.stack||e).toString(),n=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(t);if(n)return n[1];var i=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(t);return i?i[1]:"unknown"}function g(e,t){var n,i=e.split("\n"),r=1,o=0,a={unknown:new h,0:new h};a.unknown.name=a[0].name=t||d(),a.unknown.lines.push(new u(0,""));for(var s=0;s<i.length;++s){var l=i[s],c=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(l);if(c)switch(c[1]){case"line":var f=/(\d+)(\s+\d+)?/.exec(c[2]);f&&(r=0|f[1],f[2]&&((o=0|f[2])in a||(a[o]=new h)));break;case"define":var p=/SHADER_NAME(_B64)?\s+(.*)$/.exec(c[2]);p&&(a[o].name=p[1]?(n=p[2],"undefined"!=typeof atob?atob(n):"base64:"+n):p[2])}a[o].lines.push(new u(r++,l))}return Object.keys(a).forEach((function(e){var t=a[e];t.lines.forEach((function(e){t.index[e.number]=e}))})),a}function m(e){e._commandRef=d()}function _(e,t){var n=p();i(e+" in command "+(t||d())+("unknown"===n?"":" called from "+n))}function v(e,t,n,i){a(e,t)||_("invalid parameter type"+o(n)+". expected "+t+", got "+typeof e,i||d())}var b=33071,y={};function w(e,t){return 32820===e||32819===e||33635===e?2:34042===e?4:y[e]*t}function x(e){return!(e&e-1||!e)}y[5120]=y[5121]=1,y[5122]=y[5123]=y[36193]=y[33635]=y[32819]=y[32820]=2,y[5124]=y[5125]=y[5126]=y[34042]=4;var C=t(r,{optional:function(e){e()},raise:i,commandRaise:_,command:function(e,t,n){e||_(t,n||d())},parameter:function(e,t,n){e in t||i("unknown parameter ("+e+")"+o(n)+". possible values: "+Object.keys(t).join())},commandParameter:function(e,t,n,i){e in t||_("unknown parameter ("+e+")"+o(n)+". possible values: "+Object.keys(t).join(),i||d())},constructor:function(e){Object.keys(e).forEach((function(e){l.indexOf(e)<0&&i('invalid regl constructor argument "'+e+'". must be one of '+l)}))},type:function(e,t,n){a(e,t)||i("invalid parameter type"+o(n)+". expected "+t+", got "+typeof e)},commandType:v,isTypedArray:function(t,n){e(t)||i("invalid parameter type"+o(n)+". must be a typed array")},nni:function(e,t){e>=0&&(0|e)===e||i("invalid parameter type, ("+e+")"+o(t)+". must be a nonnegative integer")},oneOf:s,shaderError:function(e,t,i,o,a){if(!e.getShaderParameter(t,e.COMPILE_STATUS)){var s=e.getShaderInfoLog(t),l=o===e.FRAGMENT_SHADER?"fragment":"vertex";v(i,"string",l+" shader source must be a string",a);var h=g(i,a),u=function(e){var t=[];return e.split("\n").forEach((function(e){if(!(e.length<5)){var n=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(e);n?t.push(new f(0|n[1],0|n[2],n[3].trim())):e.length>0&&t.push(new f("unknown",0,e))}})),t}(s);(function(e,t){t.forEach((function(t){var n=e[t.file];if(n){var i=n.index[t.line];if(i)return i.errors.push(t),void(n.hasErrors=!0)}e.unknown.hasErrors=!0,e.unknown.lines[0].errors.push(t)}))})(h,u),Object.keys(h).forEach((function(e){var t=h[e];if(t.hasErrors){var i=[""],r=[""];o("file number "+e+": "+t.name+"\n","color:red;text-decoration:underline;font-weight:bold"),t.lines.forEach((function(e){if(e.errors.length>0){o(c(e.number,4)+"|  ","background-color:yellow; font-weight:bold"),o(e.line+n,"color:red; background-color:yellow; font-weight:bold");var t=0;e.errors.forEach((function(i){var r=i.message,a=/^\s*'(.*)'\s*:\s*(.*)$/.exec(r);if(a){var s=a[1];r=a[2],"assign"===s&&(s="="),t=Math.max(e.line.indexOf(s,t),0)}else t=0;o(c("| ",6)),o(c("^^^",t+3)+n,"font-weight:bold"),o(c("| ",6)),o(r+n,"font-weight:bold")})),o(c("| ",6)+n)}else o(c(e.number,4)+"|  "),o(e.line+n,"color:red")})),"undefined"==typeof document||window.chrome?console.log(i.join("")):(r[0]=i.join("%c"),console.log.apply(console,r))}function o(e,t){i.push(e),r.push(t||"")}})),r.raise("Error compiling "+l+" shader, "+h[0].name)}},linkError:function(e,t,i,o,a){if(!e.getProgramParameter(t,e.LINK_STATUS)){var s=e.getProgramInfoLog(t),l=g(i,a),c='Error linking program with vertex shader, "'+g(o,a)[0].name+'", and fragment shader "'+l[0].name+'"';"undefined"!=typeof document?console.log("%c"+c+"\n%c"+s,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(c+n+s),r.raise(c)}},callSite:p,saveCommandRef:m,saveDrawInfo:function(e,t,n,i){function r(e){return e?i.id(e):0}function o(e,t){Object.keys(t).forEach((function(t){e[i.id(t)]=!0}))}m(e),e._fragId=r(e.static.frag),e._vertId=r(e.static.vert);var a=e._uniformSet={};o(a,t.static),o(a,t.dynamic);var s=e._attributeSet={};o(s,n.static),o(s,n.dynamic),e._hasCount="count"in e.static||"count"in e.dynamic||"elements"in e.static||"elements"in e.dynamic},framebufferFormat:function(e,t,n){e.texture?s(e.texture._texture.internalformat,t,"unsupported texture format for attachment"):s(e.renderbuffer._renderbuffer.format,n,"unsupported renderbuffer format for attachment")},guessCommand:d,texture2D:function(e,t,n){var i,o=t.width,a=t.height,s=t.channels;r(o>0&&o<=n.maxTextureSize&&a>0&&a<=n.maxTextureSize,"invalid texture shape"),e.wrapS===b&&e.wrapT===b||r(x(o)&&x(a),"incompatible wrap mode for texture, both width and height must be power of 2"),1===t.mipmask?1!==o&&1!==a&&r(9984!==e.minFilter&&9986!==e.minFilter&&9985!==e.minFilter&&9987!==e.minFilter,"min filter requires mipmap"):(r(x(o)&&x(a),"texture must be a square power of 2 to support mipmapping"),r(t.mipmask===(o<<1)-1,"missing or incomplete mipmap data")),5126===t.type&&(n.extensions.indexOf("oes_texture_float_linear")<0&&r(9728===e.minFilter&&9728===e.magFilter,"filter not supported, must enable oes_texture_float_linear"),r(!e.genMipmaps,"mipmap generation not supported with float textures"));var l=t.images;for(i=0;i<16;++i)if(l[i]){var c=o>>i,h=a>>i;r(t.mipmask&1<<i,"missing mipmap data");var u=l[i];if(r(u.width===c&&u.height===h,"invalid shape for mip images"),r(u.format===t.format&&u.internalformat===t.internalformat&&u.type===t.type,"incompatible type for mip image"),u.compressed);else if(u.data){var f=Math.ceil(w(u.type,s)*c/u.unpackAlignment)*u.unpackAlignment;r(u.data.byteLength===f*h,"invalid data for image, buffer size is inconsistent with image format")}else u.element||u.copy}else e.genMipmaps||r(0==(t.mipmask&1<<i),"extra mipmap data");t.compressed&&r(!e.genMipmaps,"mipmap generation for compressed images not supported")},textureCube:function(e,t,n,i){var o=e.width,a=e.height,s=e.channels;r(o>0&&o<=i.maxTextureSize&&a>0&&a<=i.maxTextureSize,"invalid texture shape"),r(o===a,"cube map must be square"),r(t.wrapS===b&&t.wrapT===b,"wrap mode not supported by cube map");for(var l=0;l<n.length;++l){var c=n[l];r(c.width===o&&c.height===a,"inconsistent cube map face shape"),t.genMipmaps&&(r(!c.compressed,"can not generate mipmap for compressed textures"),r(1===c.mipmask,"can not specify mipmaps and generate mipmaps"));for(var h=c.images,u=0;u<16;++u){var f=h[u];if(f){var d=o>>u,p=a>>u;r(c.mipmask&1<<u,"missing mipmap data"),r(f.width===d&&f.height===p,"invalid shape for mip images"),r(f.format===e.format&&f.internalformat===e.internalformat&&f.type===e.type,"incompatible type for mip image"),f.compressed||(f.data?r(f.data.byteLength===d*p*Math.max(w(f.type,s),f.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):f.element||f.copy)}}}}}),k=0;function S(e,t){this.id=k++,this.type=e,this.data=t}function E(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function D(e){if(0===e.length)return[];var t=e.charAt(0),n=e.charAt(e.length-1);if(e.length>1&&t===n&&('"'===t||"'"===t))return['"'+E(e.substr(1,e.length-2))+'"'];var i=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(e);if(i)return D(e.substr(0,i.index)).concat(D(i[1])).concat(D(e.substr(i.index+i[0].length)));var r=e.split(".");if(1===r.length)return['"'+E(e)+'"'];for(var o=[],a=0;a<r.length;++a)o=o.concat(D(r[a]));return o}function A(e){return"["+D(e).join("][")+"]"}var M={DynamicVariable:S,define:function(e,t){return new S(e,A(t+""))},isDynamic:function(e){return"function"==typeof e&&!e._reglType||e instanceof S},unbox:function e(t,n){return"function"==typeof t?new S(0,t):"number"==typeof t||"boolean"==typeof t?new S(5,t):Array.isArray(t)?new S(6,t.map((function(t,i){return e(t,n+"["+i+"]")}))):t instanceof S?t:void C(!1,"invalid option type in uniform "+n)},accessor:A},R={next:"function"==typeof requestAnimationFrame?function(e){return requestAnimationFrame(e)}:function(e){return setTimeout(e,16)},cancel:"function"==typeof cancelAnimationFrame?function(e){return cancelAnimationFrame(e)}:clearTimeout},L="undefined"!=typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date};function T(e){return"string"==typeof e?e.split():(C(Array.isArray(e),"invalid extension array"),e)}function P(e){return"string"==typeof e?(C("undefined"!=typeof document,"not supported outside of DOM"),document.querySelector(e)):e}function z(e){var n,i,r,o,a,s=e||{},l={},c=[],h=[],u="undefined"==typeof window?1:window.devicePixelRatio,f=!1,d=function(e){e&&C.raise(e)},p=function(){};if("string"==typeof s?(C("undefined"!=typeof document,"selector queries only supported in DOM enviroments"),n=document.querySelector(s),C(n,"invalid query string for element")):"object"==typeof s?"string"==typeof(a=s).nodeName&&"function"==typeof a.appendChild&&"function"==typeof a.getBoundingClientRect?n=s:function(e){return"function"==typeof e.drawArrays||"function"==typeof e.drawElements}(s)?r=(o=s).canvas:(C.constructor(s),"gl"in s?o=s.gl:"canvas"in s?r=P(s.canvas):"container"in s&&(i=P(s.container)),"attributes"in s&&(l=s.attributes,C.type(l,"object","invalid context attributes")),"extensions"in s&&(c=T(s.extensions)),"optionalExtensions"in s&&(h=T(s.optionalExtensions)),"onDone"in s&&(C.type(s.onDone,"function","invalid or missing onDone callback"),d=s.onDone),"profile"in s&&(f=!!s.profile),"pixelRatio"in s&&(u=+s.pixelRatio,C(u>0,"invalid pixel ratio"))):C.raise("invalid arguments to regl"),n&&("canvas"===n.nodeName.toLowerCase()?r=n:i=n),!o){if(!r){C("undefined"!=typeof document,"must manually specify webgl context outside of DOM environments");var g=function(e,n,i){var r,o=document.createElement("canvas");function a(){var t=window.innerWidth,n=window.innerHeight;if(e!==document.body){var r=o.getBoundingClientRect();t=r.right-r.left,n=r.bottom-r.top}o.width=i*t,o.height=i*n}return t(o.style,{border:0,margin:0,padding:0,top:0,left:0,width:"100%",height:"100%"}),e.appendChild(o),e===document.body&&(o.style.position="absolute",t(e.style,{margin:0,padding:0})),e!==document.body&&"function"==typeof ResizeObserver?(r=new ResizeObserver((function(){setTimeout(a)}))).observe(e):window.addEventListener("resize",a,!1),a(),{canvas:o,onDestroy:function(){r?r.disconnect():window.removeEventListener("resize",a),e.removeChild(o)}}}(i||document.body,0,u);if(!g)return null;r=g.canvas,p=g.onDestroy}void 0===l.premultipliedAlpha&&(l.premultipliedAlpha=!0),o=function(e,t){function n(n){try{return e.getContext(n,t)}catch(e){return null}}return n("webgl")||n("experimental-webgl")||n("webgl-experimental")}(r,l)}return o?{gl:o,canvas:r,container:i,extensions:c,optionalExtensions:h,pixelRatio:u,profile:f,onDone:d,onDestroy:p}:(p(),d("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function I(e,t){for(var n=Array(e),i=0;i<e;++i)n[i]=t(i);return n}function O(e){var t,n;return t=(e>65535)<<4,t|=n=((e>>>=t)>255)<<3,t|=n=((e>>>=n)>15)<<2,(t|=n=((e>>>=n)>3)<<1)|(e>>>=n)>>1}function F(){var e=I(8,(function(){return[]}));function t(t){var n=function(e){for(var t=16;t<=1<<28;t*=16)if(e<=t)return t;return 0}(t),i=e[O(n)>>2];return i.length>0?i.pop():new ArrayBuffer(n)}function n(t){e[O(t.byteLength)>>2].push(t)}return{alloc:t,free:n,allocType:function(e,n){var i=null;switch(e){case 5120:i=new Int8Array(t(n),0,n);break;case 5121:i=new Uint8Array(t(n),0,n);break;case 5122:i=new Int16Array(t(2*n),0,n);break;case 5123:i=new Uint16Array(t(2*n),0,n);break;case 5124:i=new Int32Array(t(4*n),0,n);break;case 5125:i=new Uint32Array(t(4*n),0,n);break;case 5126:i=new Float32Array(t(4*n),0,n);break;default:return null}return i.length!==n?i.subarray(0,n):i},freeType:function(e){n(e.buffer)}}}var B=F();B.zero=F();var N=3553,H=6408,U=5126,$=36160;function j(t){return!!t&&"object"==typeof t&&Array.isArray(t.shape)&&Array.isArray(t.stride)&&"number"==typeof t.offset&&t.shape.length===t.stride.length&&(Array.isArray(t.data)||e(t.data))}var W=function(e){return Object.keys(e).map((function(t){return e[t]}))},q={shape:function(e){for(var t=[],n=e;n.length;n=n[0])t.push(n.length);return t},flatten:function(e,t,n,i){var r=1;if(t.length)for(var o=0;o<t.length;++o)r*=t[o];else r=0;var a=i||B.allocType(n,r);switch(t.length){case 0:break;case 1:!function(e,t,n){for(var i=0;i<t;++i)n[i]=e[i]}(e,t[0],a);break;case 2:!function(e,t,n,i){for(var r=0,o=0;o<t;++o)for(var a=e[o],s=0;s<n;++s)i[r++]=a[s]}(e,t[0],t[1],a);break;case 3:V(e,t[0],t[1],t[2],a,0);break;default:K(e,t,0,a,0)}return a}};function V(e,t,n,i,r,o){for(var a=o,s=0;s<t;++s)for(var l=e[s],c=0;c<n;++c)for(var h=l[c],u=0;u<i;++u)r[a++]=h[u]}function K(e,t,n,i,r){for(var o=1,a=n+1;a<t.length;++a)o*=t[a];var s=t[n];if(t.length-n==4){var l=t[n+1],c=t[n+2],h=t[n+3];for(a=0;a<s;++a)V(e[a],l,c,h,i,r),r+=o}else for(a=0;a<s;++a)K(e[a],t,n+1,i,r),r+=o}var G={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},Z={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,float:5126,float32:5126},X={dynamic:35048,stream:35040,static:35044},Y=q.flatten,Q=q.shape,J=5121,ee=5126,te=[];function ne(e){return 0|G[Object.prototype.toString.call(e)]}function ie(e,t){for(var n=0;n<t.length;++n)e[n]=t[n]}function re(e,t,n,i,r,o,a){for(var s=0,l=0;l<n;++l)for(var c=0;c<i;++c)e[s++]=t[r*l+o*c+a]}te[5120]=1,te[5122]=2,te[5124]=4,te[5121]=1,te[5123]=2,te[5125]=4,te[5126]=4;var oe={points:0,point:0,lines:1,line:1,triangles:4,triangle:4,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},ae=5121,se=5123,le=5125,ce=34963;var he=new Float32Array(1),ue=new Uint32Array(he.buffer);function fe(e){for(var t=B.allocType(5123,e.length),n=0;n<e.length;++n)if(isNaN(e[n]))t[n]=65535;else if(e[n]===1/0)t[n]=31744;else if(e[n]===-1/0)t[n]=64512;else{he[0]=e[n];var i=ue[0],r=i>>>31<<15,o=(i<<1>>>24)-127,a=i>>13&1023;if(o<-24)t[n]=r;else if(o<-14){var s=-14-o;t[n]=r+(a+1024>>s)}else t[n]=o>15?r+31744:r+(o+15<<10)+a}return t}function de(t){return Array.isArray(t)||e(t)}var pe=function(e){return!(e&e-1||!e)},ge=3553,me=34067,_e=34069,ve=6408,be=6406,ye=6407,we=6409,xe=6410,Ce=32855,ke=6402,Se=34041,Ee=35904,De=35906,Ae=36193,Me=33776,Re=33777,Le=33778,Te=33779,Pe=5121,ze=5123,Ie=5125,Oe=5126,Fe=33071,Be=9728,Ne=9984,He=9987,Ue=4352,$e=33984,je=[Ne,9986,9985,He],We=[0,we,xe,ye,ve],qe={};function Ve(e){return"[object "+e+"]"}qe[6409]=qe[6406]=qe[6402]=1,qe[34041]=qe[6410]=2,qe[6407]=qe[35904]=3,qe[6408]=qe[35906]=4;var Ke=Ve("HTMLCanvasElement"),Ge=Ve("OffscreenCanvas"),Ze=Ve("CanvasRenderingContext2D"),Xe=Ve("ImageBitmap"),Ye=Ve("HTMLImageElement"),Qe=Ve("HTMLVideoElement"),Je=Object.keys(G).concat([Ke,Ge,Ze,Xe,Ye,Qe]),et=[];et[5121]=1,et[5126]=4,et[36193]=2,et[5123]=2,et[5125]=4;var tt=[];function nt(e){return Array.isArray(e)&&(0===e.length||"number"==typeof e[0])}function it(e){return!!Array.isArray(e)&&!(0===e.length||!de(e[0]))}function rt(e){return Object.prototype.toString.call(e)}function ot(e){return rt(e)===Ke}function at(e){return rt(e)===Ge}function st(e){if(!e)return!1;var t=rt(e);return Je.indexOf(t)>=0||nt(e)||it(e)||j(e)}function lt(e){return 0|G[Object.prototype.toString.call(e)]}function ct(e,t){return B.allocType(e.type===Ae?Oe:e.type,t)}function ht(e,t){e.type===Ae?(e.data=fe(t),B.freeType(t)):e.data=t}function ut(e,t,n,i,r,o){var a;if(a=void 0!==tt[e]?tt[e]:qe[e]*et[t],o&&(a*=6),r){for(var s=0,l=n;l>=1;)s+=a*l*l,l/=2;return s}return a*n*i}function ft(n,i,r,o,a,s,l){var c={"don't care":Ue,"dont care":Ue,nice:4354,fast:4353},h={repeat:10497,clamp:Fe,mirror:33648},u={nearest:Be,linear:9729},f=t({mipmap:He,"nearest mipmap nearest":Ne,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":He},u),d={none:0,browser:37444},p={uint8:Pe,rgba4:32819,rgb565:33635,"rgb5 a1":32820},g={alpha:be,luminance:we,"luminance alpha":xe,rgb:ye,rgba:ve,rgba4:32854,"rgb5 a1":Ce,rgb565:36194},m={};i.ext_srgb&&(g.srgb=Ee,g.srgba=De),i.oes_texture_float&&(p.float32=p.float=Oe),i.oes_texture_half_float&&(p.float16=p["half float"]=Ae),i.webgl_depth_texture&&(t(g,{depth:ke,"depth stencil":Se}),t(p,{uint16:ze,uint32:Ie,"depth stencil":34042})),i.webgl_compressed_texture_s3tc&&t(m,{"rgb s3tc dxt1":Me,"rgba s3tc dxt1":Re,"rgba s3tc dxt3":Le,"rgba s3tc dxt5":Te}),i.webgl_compressed_texture_atc&&t(m,{"rgb atc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798}),i.webgl_compressed_texture_pvrtc&&t(m,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843}),i.webgl_compressed_texture_etc1&&(m["rgb etc1"]=36196);var _=Array.prototype.slice.call(n.getParameter(34467));Object.keys(m).forEach((function(e){var t=m[e];_.indexOf(t)>=0&&(g[e]=t)}));var v=Object.keys(g);r.textureFormats=v;var b=[];Object.keys(g).forEach((function(e){var t=g[e];b[t]=e}));var y=[];Object.keys(p).forEach((function(e){var t=p[e];y[t]=e}));var w=[];Object.keys(u).forEach((function(e){w[u[e]]=e}));var x=[];Object.keys(f).forEach((function(e){var t=f[e];x[t]=e}));var k=[];Object.keys(h).forEach((function(e){k[h[e]]=e}));var S=v.reduce((function(e,t){var n=g[t];return n===we||n===be||n===we||n===xe||n===ke||n===Se||i.ext_srgb&&(n===Ee||n===De)?e[n]=n:n===Ce||t.indexOf("rgba")>=0?e[n]=ve:e[n]=ye,e}),{});function E(){this.internalformat=ve,this.format=ve,this.type=Pe,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=37444,this.width=0,this.height=0,this.channels=0}function D(e,t){e.internalformat=t.internalformat,e.format=t.format,e.type=t.type,e.compressed=t.compressed,e.premultiplyAlpha=t.premultiplyAlpha,e.flipY=t.flipY,e.unpackAlignment=t.unpackAlignment,e.colorSpace=t.colorSpace,e.width=t.width,e.height=t.height,e.channels=t.channels}function A(e,t){if("object"==typeof t&&t){if("premultiplyAlpha"in t&&(C.type(t.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),e.premultiplyAlpha=t.premultiplyAlpha),"flipY"in t&&(C.type(t.flipY,"boolean","invalid texture flip"),e.flipY=t.flipY),"alignment"in t&&(C.oneOf(t.alignment,[1,2,4,8],"invalid texture unpack alignment"),e.unpackAlignment=t.alignment),"colorSpace"in t&&(C.parameter(t.colorSpace,d,"invalid colorSpace"),e.colorSpace=d[t.colorSpace]),"type"in t){var n=t.type;C(i.oes_texture_float||!("float"===n||"float32"===n),"you must enable the OES_texture_float extension in order to use floating point textures."),C(i.oes_texture_half_float||!("half float"===n||"float16"===n),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),C(i.webgl_depth_texture||!("uint16"===n||"uint32"===n||"depth stencil"===n),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),C.parameter(n,p,"invalid texture type"),e.type=p[n]}var o=e.width,a=e.height,s=e.channels,l=!1;"shape"in t?(C(Array.isArray(t.shape)&&t.shape.length>=2,"shape must be an array"),o=t.shape[0],a=t.shape[1],3===t.shape.length&&(s=t.shape[2],C(s>0&&s<=4,"invalid number of channels"),l=!0),C(o>=0&&o<=r.maxTextureSize,"invalid width"),C(a>=0&&a<=r.maxTextureSize,"invalid height")):("radius"in t&&(o=a=t.radius,C(o>=0&&o<=r.maxTextureSize,"invalid radius")),"width"in t&&(o=t.width,C(o>=0&&o<=r.maxTextureSize,"invalid width")),"height"in t&&(a=t.height,C(a>=0&&a<=r.maxTextureSize,"invalid height")),"channels"in t&&(s=t.channels,C(s>0&&s<=4,"invalid number of channels"),l=!0)),e.width=0|o,e.height=0|a,e.channels=0|s;var c=!1;if("format"in t){var h=t.format;C(i.webgl_depth_texture||!("depth"===h||"depth stencil"===h),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),C.parameter(h,g,"invalid texture format");var u=e.internalformat=g[h];e.format=S[u],h in p&&("type"in t||(e.type=p[h])),h in m&&(e.compressed=!0),c=!0}!l&&c?e.channels=qe[e.format]:l&&!c?e.channels!==We[e.format]&&(e.format=e.internalformat=We[e.channels]):c&&l&&C(e.channels===qe[e.format],"number of channels inconsistent with specified format")}}function M(e){n.pixelStorei(37440,e.flipY),n.pixelStorei(37441,e.premultiplyAlpha),n.pixelStorei(37443,e.colorSpace),n.pixelStorei(3317,e.unpackAlignment)}function R(){E.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function L(t,n){var i=null;if(st(n)?i=n:n&&(C.type(n,"object","invalid pixel data type"),A(t,n),"x"in n&&(t.xOffset=0|n.x),"y"in n&&(t.yOffset=0|n.y),st(n.data)&&(i=n.data)),C(!t.compressed||i instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),n.copy){C(!i,"can not specify copy and data field for the same texture");var o=a.viewportWidth,s=a.viewportHeight;t.width=t.width||o-t.xOffset,t.height=t.height||s-t.yOffset,t.needsCopy=!0,C(t.xOffset>=0&&t.xOffset<o&&t.yOffset>=0&&t.yOffset<s&&t.width>0&&t.width<=o&&t.height>0&&t.height<=s,"copy texture read out of bounds")}else if(i){if(e(i))t.channels=t.channels||4,t.data=i,"type"in n||t.type!==Pe||(t.type=lt(i));else if(nt(i))t.channels=t.channels||4,function(e,t){var n=t.length;switch(e.type){case Pe:case ze:case Ie:case Oe:var i=B.allocType(e.type,n);i.set(t),e.data=i;break;case Ae:e.data=fe(t);break;default:C.raise("unsupported texture type, must specify a typed array")}}(t,i),t.alignment=1,t.needsFree=!0;else if(j(i)){var l=i.data;Array.isArray(l)||t.type!==Pe||(t.type=lt(l));var c,h,u,f,d,p,g=i.shape,m=i.stride;3===g.length?(u=g[2],p=m[2]):(C(2===g.length,"invalid ndarray pixel data, must be 2 or 3D"),u=1,p=1),c=g[0],h=g[1],f=m[0],d=m[1],t.alignment=1,t.width=c,t.height=h,t.channels=u,t.format=t.internalformat=We[u],t.needsFree=!0,function(e,t,n,i,r,o){for(var a=e.width,s=e.height,l=e.channels,c=ct(e,a*s*l),h=0,u=0;u<s;++u)for(var f=0;f<a;++f)for(var d=0;d<l;++d)c[h++]=t[n*f+i*u+r*d+o];ht(e,c)}(t,l,f,d,p,i.offset)}else if(ot(i)||at(i)||rt(i)===Ze)ot(i)||at(i)?t.element=i:t.element=i.canvas,t.width=t.element.width,t.height=t.element.height,t.channels=4;else if(function(e){return rt(e)===Xe}(i))t.element=i,t.width=i.width,t.height=i.height,t.channels=4;else if(function(e){return rt(e)===Ye}(i))t.element=i,t.width=i.naturalWidth,t.height=i.naturalHeight,t.channels=4;else if(function(e){return rt(e)===Qe}(i))t.element=i,t.width=i.videoWidth,t.height=i.videoHeight,t.channels=4;else if(it(i)){var _=t.width||i[0].length,v=t.height||i.length,b=t.channels;b=de(i[0][0])?b||i[0][0].length:b||1;for(var y=q.shape(i),w=1,x=0;x<y.length;++x)w*=y[x];var k=ct(t,w);q.flatten(i,y,"",k),ht(t,k),t.alignment=1,t.width=_,t.height=v,t.channels=b,t.format=t.internalformat=We[b],t.needsFree=!0}}else t.width=t.width||1,t.height=t.height||1,t.channels=t.channels||4;t.type===Oe?C(r.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):t.type===Ae&&C(r.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function T(e,t,i){var r=e.element,a=e.data,s=e.internalformat,l=e.format,c=e.type,h=e.width,u=e.height;M(e),r?n.texImage2D(t,i,l,l,c,r):e.compressed?n.compressedTexImage2D(t,i,s,h,u,0,a):e.needsCopy?(o(),n.copyTexImage2D(t,i,l,e.xOffset,e.yOffset,h,u,0)):n.texImage2D(t,i,l,h,u,0,l,c,a||null)}function P(e,t,i,r,a){var s=e.element,l=e.data,c=e.internalformat,h=e.format,u=e.type,f=e.width,d=e.height;M(e),s?n.texSubImage2D(t,a,i,r,h,u,s):e.compressed?n.compressedTexSubImage2D(t,a,i,r,c,f,d,l):e.needsCopy?(o(),n.copyTexSubImage2D(t,a,i,r,e.xOffset,e.yOffset,f,d)):n.texSubImage2D(t,a,i,r,f,d,h,u,l)}var z=[];function I(){return z.pop()||new R}function O(e){e.needsFree&&B.freeType(e.data),R.call(e),z.push(e)}function F(){E.call(this),this.genMipmaps=!1,this.mipmapHint=Ue,this.mipmask=0,this.images=Array(16)}function N(e,t,n){var i=e.images[0]=I();e.mipmask=1,i.width=e.width=t,i.height=e.height=n,i.channels=e.channels=4}function H(e,t){var n=null;if(st(t))D(n=e.images[0]=I(),e),L(n,t),e.mipmask=1;else if(A(e,t),Array.isArray(t.mipmap))for(var i=t.mipmap,r=0;r<i.length;++r)D(n=e.images[r]=I(),e),n.width>>=r,n.height>>=r,L(n,i[r]),e.mipmask|=1<<r;else D(n=e.images[0]=I(),e),L(n,t),e.mipmask=1;D(e,e.images[0]),!e.compressed||e.internalformat!==Me&&e.internalformat!==Re&&e.internalformat!==Le&&e.internalformat!==Te||C(e.width%4==0&&e.height%4==0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function U(e,t){for(var n=e.images,i=0;i<n.length;++i){if(!n[i])return;T(n[i],t,i)}}var $=[];function V(){var e=$.pop()||new F;E.call(e),e.mipmask=0;for(var t=0;t<16;++t)e.images[t]=null;return e}function K(e){for(var t=e.images,n=0;n<t.length;++n)t[n]&&O(t[n]),t[n]=null;$.push(e)}function G(){this.minFilter=Be,this.magFilter=Be,this.wrapS=Fe,this.wrapT=Fe,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=Ue}function Z(e,t){if("min"in t){var n=t.min;C.parameter(n,f),e.minFilter=f[n],je.indexOf(e.minFilter)>=0&&!("faces"in t)&&(e.genMipmaps=!0)}if("mag"in t){var i=t.mag;C.parameter(i,u),e.magFilter=u[i]}var o=e.wrapS,a=e.wrapT;if("wrap"in t){var s=t.wrap;"string"==typeof s?(C.parameter(s,h),o=a=h[s]):Array.isArray(s)&&(C.parameter(s[0],h),C.parameter(s[1],h),o=h[s[0]],a=h[s[1]])}else{if("wrapS"in t){var l=t.wrapS;C.parameter(l,h),o=h[l]}if("wrapT"in t){var d=t.wrapT;C.parameter(d,h),a=h[d]}}if(e.wrapS=o,e.wrapT=a,"anisotropic"in t){var p=t.anisotropic;C("number"==typeof p&&p>=1&&p<=r.maxAnisotropic,"aniso samples must be between 1 and "),e.anisotropic=t.anisotropic}if("mipmap"in t){var g=!1;switch(typeof t.mipmap){case"string":C.parameter(t.mipmap,c,"invalid mipmap hint"),e.mipmapHint=c[t.mipmap],e.genMipmaps=!0,g=!0;break;case"boolean":g=e.genMipmaps=t.mipmap;break;case"object":C(Array.isArray(t.mipmap),"invalid mipmap type"),e.genMipmaps=!1,g=!0;break;default:C.raise("invalid mipmap type")}g&&!("min"in t)&&(e.minFilter=Ne)}}function X(e,t){n.texParameteri(t,10241,e.minFilter),n.texParameteri(t,10240,e.magFilter),n.texParameteri(t,10242,e.wrapS),n.texParameteri(t,10243,e.wrapT),i.ext_texture_filter_anisotropic&&n.texParameteri(t,34046,e.anisotropic),e.genMipmaps&&(n.hint(33170,e.mipmapHint),n.generateMipmap(t))}var Y=0,Q={},J=r.maxTextureUnits,ee=Array(J).map((function(){return null}));function te(e){E.call(this),this.mipmask=0,this.internalformat=ve,this.id=Y++,this.refCount=1,this.target=e,this.texture=n.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new G,l.profile&&(this.stats={size:0})}function ne(e){n.activeTexture($e),n.bindTexture(e.target,e.texture)}function ie(){var e=ee[0];e?n.bindTexture(e.target,e.texture):n.bindTexture(ge,null)}function re(e){var t=e.texture;C(t,"must not double destroy texture");var i=e.unit,r=e.target;i>=0&&(n.activeTexture($e+i),n.bindTexture(r,null),ee[i]=null),n.deleteTexture(t),e.texture=null,e.params=null,e.pixels=null,e.refCount=0,delete Q[e.id],s.textureCount--}return t(te.prototype,{bind:function(){var e=this;e.bindCount+=1;var t=e.unit;if(t<0){for(var i=0;i<J;++i){var r=ee[i];if(r){if(r.bindCount>0)continue;r.unit=-1}ee[i]=e,t=i;break}t>=J&&C.raise("insufficient number of texture units"),l.profile&&s.maxTextureUnits<t+1&&(s.maxTextureUnits=t+1),e.unit=t,n.activeTexture($e+t),n.bindTexture(e.target,e.texture)}return t},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&re(this)}}),l.profile&&(s.getTotalTextureSize=function(){var e=0;return Object.keys(Q).forEach((function(t){e+=Q[t].stats.size})),e}),{create2D:function(e,t){var i=new te(ge);function o(e,t){var n=i.texInfo;G.call(n);var a=V();return"number"==typeof e?N(a,0|e,"number"==typeof t?0|t:0|e):e?(C.type(e,"object","invalid arguments to regl.texture"),Z(n,e),H(a,e)):N(a,1,1),n.genMipmaps&&(a.mipmask=(a.width<<1)-1),i.mipmask=a.mipmask,D(i,a),C.texture2D(n,a,r),i.internalformat=a.internalformat,o.width=a.width,o.height=a.height,ne(i),U(a,ge),X(n,ge),ie(),K(a),l.profile&&(i.stats.size=ut(i.internalformat,i.type,a.width,a.height,n.genMipmaps,!1)),o.format=b[i.internalformat],o.type=y[i.type],o.mag=w[n.magFilter],o.min=x[n.minFilter],o.wrapS=k[n.wrapS],o.wrapT=k[n.wrapT],o}return Q[i.id]=i,s.textureCount++,o(e,t),o.subimage=function(e,t,n,r){C(!!e,"must specify image data");var a=0|t,s=0|n,l=0|r,c=I();return D(c,i),c.width=0,c.height=0,L(c,e),c.width=c.width||(i.width>>l)-a,c.height=c.height||(i.height>>l)-s,C(i.type===c.type&&i.format===c.format&&i.internalformat===c.internalformat,"incompatible format for texture.subimage"),C(a>=0&&s>=0&&a+c.width<=i.width&&s+c.height<=i.height,"texture.subimage write out of bounds"),C(i.mipmask&1<<l,"missing mipmap data"),C(c.data||c.element||c.needsCopy,"missing image data"),ne(i),P(c,ge,a,s,l),ie(),O(c),o},o.resize=function(e,t){var r=0|e,a=0|t||r;if(r===i.width&&a===i.height)return o;o.width=i.width=r,o.height=i.height=a,ne(i);for(var s=0;i.mipmask>>s;++s){var c=r>>s,h=a>>s;if(!c||!h)break;n.texImage2D(ge,s,i.format,c,h,0,i.format,i.type,null)}return ie(),l.profile&&(i.stats.size=ut(i.internalformat,i.type,r,a,!1,!1)),o},o._reglType="texture2d",o._texture=i,l.profile&&(o.stats=i.stats),o.destroy=function(){i.decRef()},o},createCube:function(e,t,i,o,a,c){var h=new te(me);Q[h.id]=h,s.cubeCount++;var u=new Array(6);function f(e,t,n,i,o,a){var s,c=h.texInfo;for(G.call(c),s=0;s<6;++s)u[s]=V();if("number"!=typeof e&&e)if("object"==typeof e)if(t)H(u[0],e),H(u[1],t),H(u[2],n),H(u[3],i),H(u[4],o),H(u[5],a);else if(Z(c,e),A(h,e),"faces"in e){var d=e.faces;for(C(Array.isArray(d)&&6===d.length,"cube faces must be a length 6 array"),s=0;s<6;++s)C("object"==typeof d[s]&&!!d[s],"invalid input for cube map face"),D(u[s],h),H(u[s],d[s])}else for(s=0;s<6;++s)H(u[s],e);else C.raise("invalid arguments to cube map");else{var p=0|e||1;for(s=0;s<6;++s)N(u[s],p,p)}for(D(h,u[0]),C.optional((function(){r.npotTextureCube||C(pe(h.width)&&pe(h.height),"your browser does not support non power or two texture dimensions")})),c.genMipmaps?h.mipmask=(u[0].width<<1)-1:h.mipmask=u[0].mipmask,C.textureCube(h,c,u,r),h.internalformat=u[0].internalformat,f.width=u[0].width,f.height=u[0].height,ne(h),s=0;s<6;++s)U(u[s],_e+s);for(X(c,me),ie(),l.profile&&(h.stats.size=ut(h.internalformat,h.type,f.width,f.height,c.genMipmaps,!0)),f.format=b[h.internalformat],f.type=y[h.type],f.mag=w[c.magFilter],f.min=x[c.minFilter],f.wrapS=k[c.wrapS],f.wrapT=k[c.wrapT],s=0;s<6;++s)K(u[s]);return f}return f(e,t,i,o,a,c),f.subimage=function(e,t,n,i,r){C(!!t,"must specify image data"),C("number"==typeof e&&e===(0|e)&&e>=0&&e<6,"invalid face");var o=0|n,a=0|i,s=0|r,l=I();return D(l,h),l.width=0,l.height=0,L(l,t),l.width=l.width||(h.width>>s)-o,l.height=l.height||(h.height>>s)-a,C(h.type===l.type&&h.format===l.format&&h.internalformat===l.internalformat,"incompatible format for texture.subimage"),C(o>=0&&a>=0&&o+l.width<=h.width&&a+l.height<=h.height,"texture.subimage write out of bounds"),C(h.mipmask&1<<s,"missing mipmap data"),C(l.data||l.element||l.needsCopy,"missing image data"),ne(h),P(l,_e+e,o,a,s),ie(),O(l),f},f.resize=function(e){var t=0|e;if(t!==h.width){f.width=h.width=t,f.height=h.height=t,ne(h);for(var i=0;i<6;++i)for(var r=0;h.mipmask>>r;++r)n.texImage2D(_e+i,r,h.format,t>>r,t>>r,0,h.format,h.type,null);return ie(),l.profile&&(h.stats.size=ut(h.internalformat,h.type,f.width,f.height,!1,!0)),f}},f._reglType="textureCube",f._texture=h,l.profile&&(f.stats=h.stats),f.destroy=function(){h.decRef()},f},clear:function(){for(var e=0;e<J;++e)n.activeTexture($e+e),n.bindTexture(ge,null),ee[e]=null;W(Q).forEach(re),s.cubeCount=0,s.textureCount=0},getTexture:function(e){return null},restore:function(){for(var e=0;e<J;++e){var t=ee[e];t&&(t.bindCount=0,t.unit=-1,ee[e]=null)}W(Q).forEach((function(e){e.texture=n.createTexture(),n.bindTexture(e.target,e.texture);for(var t=0;t<32;++t)if(0!=(e.mipmask&1<<t))if(e.target===ge)n.texImage2D(ge,t,e.internalformat,e.width>>t,e.height>>t,0,e.internalformat,e.type,null);else for(var i=0;i<6;++i)n.texImage2D(_e+i,t,e.internalformat,e.width>>t,e.height>>t,0,e.internalformat,e.type,null);X(e.texInfo,e.target)}))},refresh:function(){for(var e=0;e<J;++e){var t=ee[e];t&&(t.bindCount=0,t.unit=-1,ee[e]=null),n.activeTexture($e+e),n.bindTexture(ge,null),n.bindTexture(me,null)}}}}tt[32854]=2,tt[32855]=2,tt[36194]=2,tt[34041]=4,tt[33776]=.5,tt[33777]=.5,tt[33778]=1,tt[33779]=1,tt[35986]=.5,tt[35987]=1,tt[34798]=1,tt[35840]=.5,tt[35841]=.25,tt[35842]=.5,tt[35843]=.25,tt[36196]=.5;var dt=36161,pt=32854,gt=[];function mt(e,t,n){return gt[e]*t*n}gt[32854]=2,gt[32855]=2,gt[36194]=2,gt[33189]=2,gt[36168]=1,gt[34041]=4,gt[35907]=4,gt[34836]=16,gt[34842]=8,gt[34843]=6;var _t=36160,vt=36161,bt=3553,yt=34069,wt=[6407,6408],xt=[];xt[6408]=4,xt[6407]=3;var Ct=[];Ct[5121]=1,Ct[5126]=4,Ct[36193]=2;var kt=[32854,32855,36194,35907,34842,34843,34836],St={};St[36053]="complete",St[36054]="incomplete attachment",St[36057]="incomplete dimensions",St[36055]="incomplete, missing attachment",St[36061]="unsupported";var Et=34963,Dt=["attributes","elements","offset","count","primitive","instances"];function At(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=5126,this.offset=0,this.stride=0,this.divisor=0}var Mt=5121,Rt=5126;function Lt(t,n,i,r,o,a,s){function l(l){var c;null===n.next?(C(o.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),c=Mt):(C(null!==n.next.colorAttachments[0].texture,"You cannot read from a renderbuffer"),c=n.next.colorAttachments[0].texture._texture.type,C.optional((function(){a.oes_texture_float?(C(c===Mt||c===Rt,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),c===Rt&&C(s.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):C(c===Mt,"Reading from a framebuffer is only allowed for the type 'uint8'")})));var h=0,u=0,f=r.framebufferWidth,d=r.framebufferHeight,p=null;e(l)?p=l:l&&(C.type(l,"object","invalid arguments to regl.read()"),h=0|l.x,u=0|l.y,C(h>=0&&h<r.framebufferWidth,"invalid x offset for regl.read"),C(u>=0&&u<r.framebufferHeight,"invalid y offset for regl.read"),f=0|(l.width||r.framebufferWidth-h),d=0|(l.height||r.framebufferHeight-u),p=l.data||null),p&&(c===Mt?C(p instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):c===Rt&&C(p instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),C(f>0&&f+h<=r.framebufferWidth,"invalid width for read pixels"),C(d>0&&d+u<=r.framebufferHeight,"invalid height for read pixels"),i();var g=f*d*4;return p||(c===Mt?p=new Uint8Array(g):c===Rt&&(p=p||new Float32Array(g))),C.isTypedArray(p,"data buffer for regl.read() must be a typedarray"),C(p.byteLength>=g,"data buffer for regl.read() too small"),t.pixelStorei(3333,4),t.readPixels(h,u,f,d,6408,c,p),p}return function(e){return e&&"framebuffer"in e?function(e){var t;return n.setFBO({framebuffer:e.framebuffer},(function(){t=l(e)})),t}(e):l(e)}}function Tt(e){return Array.prototype.slice.call(e)}function Pt(e){return Tt(e).join("")}var zt="xyzw".split(""),It="dither",Ot="blend.enable",Ft="blend.color",Bt="blend.equation",Nt="blend.func",Ht="depth.enable",Ut="depth.func",$t="depth.range",jt="depth.mask",Wt="colorMask",qt="cull.enable",Vt="cull.face",Kt="frontFace",Gt="lineWidth",Zt="polygonOffset.enable",Xt="polygonOffset.offset",Yt="sample.alpha",Qt="sample.enable",Jt="sample.coverage",en="stencil.enable",tn="stencil.mask",nn="stencil.func",rn="stencil.opFront",on="stencil.opBack",an="scissor.enable",sn="scissor.box",ln="viewport",cn="profile",hn="framebuffer",un="vert",fn="frag",dn="elements",pn="primitive",gn="count",mn="offset",_n="instances",vn="vao",bn="Width",yn="Height",wn=hn+bn,xn=hn+yn,Cn="drawingBufferWidth",kn="drawingBufferHeight",Sn=[Nt,Bt,nn,rn,on,Jt,ln,sn,Xt],En=34962,Dn=34963,An=5126,Mn=35664,Rn=35665,Ln=35666,Tn=5124,Pn=35667,zn=35668,In=35669,On=35670,Fn=35671,Bn=35672,Nn=35673,Hn=35674,Un=35675,$n=35676,jn=35678,Wn=35680,qn=1028,Vn=1029,Kn=2305,Gn=7680,Zn={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},Xn=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],Yn={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},Qn={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},Jn={frag:35632,vert:35633},ei={cw:2304,ccw:Kn};function ti(t){return Array.isArray(t)||e(t)||j(t)}function ni(e){return e.sort((function(e,t){return e===ln?-1:t===ln?1:e<t?-1:1}))}function ii(e,t,n,i){this.thisDep=e,this.contextDep=t,this.propDep=n,this.append=i}function ri(e){return e&&!(e.thisDep||e.contextDep||e.propDep)}function oi(e){return new ii(!1,!1,!1,e)}function ai(e,t){var n=e.type;if(0===n){var i=e.data.length;return new ii(!0,i>=1,i>=2,t)}if(4===n){var r=e.data;return new ii(r.thisDep,r.contextDep,r.propDep,t)}if(5===n)return new ii(!1,!1,!1,t);if(6===n){for(var o=!1,a=!1,s=!1,l=0;l<e.data.length;++l){var c=e.data[l];if(1===c.type)s=!0;else if(2===c.type)a=!0;else if(3===c.type)o=!0;else if(0===c.type){o=!0;var h=c.data;h>=1&&(a=!0),h>=2&&(s=!0)}else 4===c.type&&(o=o||c.data.thisDep,a=a||c.data.contextDep,s=s||c.data.propDep)}return new ii(o,a,s,t)}return new ii(3===n,2===n,1===n,t)}var si=new ii(!1,!1,!1,(function(){}));function li(e,n,i,r,o,a,s,l,c,h,u,f,d,p,g){var m=h.Record,_={add:32774,subtract:32778,"reverse subtract":32779};i.ext_blend_minmax&&(_.min=32775,_.max=32776);var v=i.angle_instanced_arrays,b=i.webgl_draw_buffers,y=i.oes_vertex_array_object,w={dirty:!0,profile:g.profile},x={},k=[],S={},E={};function D(e){return e.replace(".","_")}function A(e,t,n){var i=D(e);k.push(e),x[i]=w[i]=!!n,S[i]=t}function R(e,t,n){var i=D(e);k.push(e),Array.isArray(n)?(w[i]=n.slice(),x[i]=n.slice()):w[i]=x[i]=n,E[i]=t}A(It,3024),A(Ot,3042),R(Ft,"blendColor",[0,0,0,0]),R(Bt,"blendEquationSeparate",[32774,32774]),R(Nt,"blendFuncSeparate",[1,0,1,0]),A(Ht,2929,!0),R(Ut,"depthFunc",513),R($t,"depthRange",[0,1]),R(jt,"depthMask",!0),R(Wt,Wt,[!0,!0,!0,!0]),A(qt,2884),R(Vt,"cullFace",Vn),R(Kt,Kt,Kn),R(Gt,Gt,1),A(Zt,32823),R(Xt,"polygonOffset",[0,0]),A(Yt,32926),A(Qt,32928),R(Jt,"sampleCoverage",[1,!1]),A(en,2960),R(tn,"stencilMask",-1),R(nn,"stencilFunc",[519,0,-1]),R(rn,"stencilOpSeparate",[qn,Gn,Gn,Gn]),R(on,"stencilOpSeparate",[Vn,Gn,Gn,Gn]),A(an,3089),R(sn,"scissor",[0,0,e.drawingBufferWidth,e.drawingBufferHeight]),R(ln,ln,[0,0,e.drawingBufferWidth,e.drawingBufferHeight]);var L={gl:e,context:d,strings:n,next:x,current:w,draw:f,elements:a,buffer:o,shader:u,attributes:h.state,vao:h,uniforms:c,framebuffer:l,extensions:i,timer:p,isBufferArgs:ti},T={primTypes:oe,compareFuncs:Yn,blendFuncs:Zn,blendEquations:_,stencilOps:Qn,glTypes:Z,orientationType:ei};C.optional((function(){L.isArrayLike=de})),b&&(T.backBuffer=[Vn],T.drawBuffer=I(r.maxDrawbuffers,(function(e){return 0===e?[0]:I(e,(function(e){return 36064+e}))})));var P=0;function z(){var e=function(){var e=0,n=[],i=[];function r(){var n=[],i=[];return t((function(){n.push.apply(n,Tt(arguments))}),{def:function(){var t="v"+e++;return i.push(t),arguments.length>0&&(n.push(t,"="),n.push.apply(n,Tt(arguments)),n.push(";")),t},toString:function(){return Pt([i.length>0?"var "+i.join(",")+";":"",Pt(n)])}})}function o(){var e=r(),n=r(),i=e.toString,o=n.toString;function a(t,i){n(t,i,"=",e.def(t,i),";")}return t((function(){e.apply(e,Tt(arguments))}),{def:e.def,entry:e,exit:n,save:a,set:function(t,n,i){a(t,n),e(t,n,"=",i,";")},toString:function(){return i()+o()}})}var a=r(),s={};return{global:a,link:function(t){for(var r=0;r<i.length;++r)if(i[r]===t)return n[r];var o="g"+e++;return n.push(o),i.push(t),o},block:r,proc:function(e,n){var i=[];function r(){var e="a"+i.length;return i.push(e),e}n=n||0;for(var a=0;a<n;++a)r();var l=o(),c=l.toString;return s[e]=t(l,{arg:r,toString:function(){return Pt(["function(",i.join(),"){",c(),"}"])}})},scope:o,cond:function(){var e=Pt(arguments),n=o(),i=o(),r=n.toString,a=i.toString;return t(n,{then:function(){return n.apply(n,Tt(arguments)),this},else:function(){return i.apply(i,Tt(arguments)),this},toString:function(){var t=a();return t&&(t="else{"+t+"}"),Pt(["if(",e,"){",r(),"}",t])}})},compile:function(){var e=['"use strict";',a,"return {"];Object.keys(s).forEach((function(t){e.push('"',t,'":',s[t].toString(),",")})),e.push("}");var t=Pt(e).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return Function.apply(null,n.concat(t)).apply(null,i)}}}(),i=e.link,r=e.global;e.id=P++,e.batchId="0";var o=i(L),a=e.shared={props:"a0"};Object.keys(L).forEach((function(e){a[e]=r.def(o,".",e)})),C.optional((function(){e.CHECK=i(C),e.commandStr=C.guessCommand(),e.command=i(e.commandStr),e.assert=function(e,t,n){e("if(!(",t,"))",this.CHECK,".commandRaise(",i(n),",",this.command,");")},T.invalidBlendCombinations=Xn}));var s=e.next={},l=e.current={};Object.keys(E).forEach((function(e){Array.isArray(w[e])&&(s[e]=r.def(a.next,".",e),l[e]=r.def(a.current,".",e))}));var c=e.constants={};Object.keys(T).forEach((function(e){c[e]=r.def(JSON.stringify(T[e]))})),e.invoke=function(t,n){switch(n.type){case 0:var r=["this",a.context,a.props,e.batchId];return t.def(i(n.data),".call(",r.slice(0,Math.max(n.data.length+1,4)),")");case 1:return t.def(a.props,n.data);case 2:return t.def(a.context,n.data);case 3:return t.def("this",n.data);case 4:return n.data.append(e,t),n.data.ref;case 5:return n.data.toString();case 6:return n.data.map((function(n){return e.invoke(t,n)}))}},e.attribCache={};var u={};return e.scopeAttrib=function(e){var t=n.id(e);if(t in u)return u[t];var r=h.scope[t];return r||(r=h.scope[t]=new m),u[t]=i(r)},e}function O(e,t,s,c,f){var d=e.static,p=e.dynamic;C.optional((function(){var e=[hn,un,fn,dn,pn,mn,gn,_n,cn,vn].concat(k);function t(t){Object.keys(t).forEach((function(t){C.command(e.indexOf(t)>=0,'unknown parameter "'+t+'"',f.commandStr)}))}t(d),t(p)}));var g=function(e,t){var n=e.static;if("string"==typeof n[fn]&&"string"==typeof n[un]){if(Object.keys(t.dynamic).length>0)return null;var i=t.static,r=Object.keys(i);if(r.length>0&&"number"==typeof i[r[0]]){for(var o=[],a=0;a<r.length;++a)C("number"==typeof i[r[a]],"must specify all vertex attribute locations when using vaos"),o.push([0|i[r[a]],r[a]]);return o}}return null}(e,t),b=function(e,t){var n=e.static,i=e.dynamic;if(hn in n){var r=n[hn];return r?(r=l.getFramebuffer(r),C.command(r,"invalid framebuffer object"),oi((function(e,t){var n=e.link(r),i=e.shared;t.set(i.framebuffer,".next",n);var o=i.context;return t.set(o,"."+wn,n+".width"),t.set(o,"."+xn,n+".height"),n}))):oi((function(e,t){var n=e.shared;t.set(n.framebuffer,".next","null");var i=n.context;return t.set(i,"."+wn,i+"."+Cn),t.set(i,"."+xn,i+"."+kn),"null"}))}if(hn in i){var o=i[hn];return ai(o,(function(e,t){var n=e.invoke(t,o),i=e.shared,r=i.framebuffer,a=t.def(r,".getFramebuffer(",n,")");C.optional((function(){e.assert(t,"!"+n+"||"+a,"invalid framebuffer object")})),t.set(r,".next",a);var s=i.context;return t.set(s,"."+wn,a+"?"+a+".width:"+s+"."+Cn),t.set(s,"."+xn,a+"?"+a+".height:"+s+"."+kn),a}))}return null}(e),y=function(e,t,n){var i=e.static,r=e.dynamic;function o(e){if(e in i){var o=i[e];C.commandType(o,"object","invalid "+e,n.commandStr);var a,s,l=!0,c=0|o.x,h=0|o.y;return"width"in o?(a=0|o.width,C.command(a>=0,"invalid "+e,n.commandStr)):l=!1,"height"in o?(s=0|o.height,C.command(s>=0,"invalid "+e,n.commandStr)):l=!1,new ii(!l&&t&&t.thisDep,!l&&t&&t.contextDep,!l&&t&&t.propDep,(function(e,t){var n=e.shared.context,i=a;"width"in o||(i=t.def(n,".",wn,"-",c));var r=s;return"height"in o||(r=t.def(n,".",xn,"-",h)),[c,h,i,r]}))}if(e in r){var u=r[e],f=ai(u,(function(t,n){var i=t.invoke(n,u);C.optional((function(){t.assert(n,i+"&&typeof "+i+'==="object"',"invalid "+e)}));var r=t.shared.context,o=n.def(i,".x|0"),a=n.def(i,".y|0"),s=n.def('"width" in ',i,"?",i,".width|0:","(",r,".",wn,"-",o,")"),l=n.def('"height" in ',i,"?",i,".height|0:","(",r,".",xn,"-",a,")");return C.optional((function(){t.assert(n,s+">=0&&"+l+">=0","invalid "+e)})),[o,a,s,l]}));return t&&(f.thisDep=f.thisDep||t.thisDep,f.contextDep=f.contextDep||t.contextDep,f.propDep=f.propDep||t.propDep),f}return t?new ii(t.thisDep,t.contextDep,t.propDep,(function(e,t){var n=e.shared.context;return[0,0,t.def(n,".",wn),t.def(n,".",xn)]})):null}var a=o(ln);if(a){var s=a;a=new ii(a.thisDep,a.contextDep,a.propDep,(function(e,t){var n=s.append(e,t),i=e.shared.context;return t.set(i,".viewportWidth",n[2]),t.set(i,".viewportHeight",n[3]),n}))}return{viewport:a,scissor_box:o(sn)}}(e,b,f),w=function(e,t){var n=e.static,i=e.dynamic,r={},o=!1,s=function(){if(vn in n){var e=n[vn];return null!==e&&null===h.getVAO(e)&&(e=h.createVAO(e)),o=!0,r.vao=e,oi((function(t){var n=h.getVAO(e);return n?t.link(n):"null"}))}if(vn in i){o=!0;var t=i[vn];return ai(t,(function(e,n){var i=e.invoke(n,t);return n.def(e.shared.vao+".getVAO("+i+")")}))}return null}(),l=!1,c=function(){if(dn in n){var e=n[dn];if(r.elements=e,ti(e)){var c=r.elements=a.create(e,!0);e=a.getElements(c),l=!0}else e&&(e=a.getElements(e),l=!0,C.command(e,"invalid elements",t.commandStr));var h=oi((function(t,n){if(e){var i=t.link(e);return t.ELEMENTS=i,i}return t.ELEMENTS=null,null}));return h.value=e,h}if(dn in i){l=!0;var u=i[dn];return ai(u,(function(e,t){var n=e.shared,i=n.isBufferArgs,r=n.elements,o=e.invoke(t,u),a=t.def("null"),s=t.def(i,"(",o,")"),l=e.cond(s).then(a,"=",r,".createStream(",o,");").else(a,"=",r,".getElements(",o,");");return C.optional((function(){e.assert(l.else,"!"+o+"||"+a,"invalid elements")})),t.entry(l),t.exit(e.cond(s).then(r,".destroyStream(",a,");")),e.ELEMENTS=a,a}))}return o?new ii(s.thisDep,s.contextDep,s.propDep,(function(e,t){return t.def(e.shared.vao+".currentVAO?"+e.shared.elements+".getElements("+e.shared.vao+".currentVAO.elements):null")})):null}();function u(e,a){if(e in n){var c=0|n[e];return a?r.offset=c:r.instances=c,C.command(!a||c>=0,"invalid "+e,t.commandStr),oi((function(e,t){return a&&(e.OFFSET=c),c}))}if(e in i){var h=i[e];return ai(h,(function(t,n){var i=t.invoke(n,h);return a&&(t.OFFSET=i,C.optional((function(){t.assert(n,i+">=0","invalid "+e)}))),i}))}if(a){if(l)return oi((function(e,t){return e.OFFSET=0,0}));if(o)return new ii(s.thisDep,s.contextDep,s.propDep,(function(e,t){return t.def(e.shared.vao+".currentVAO?"+e.shared.vao+".currentVAO.offset:0")}))}else if(o)return new ii(s.thisDep,s.contextDep,s.propDep,(function(e,t){return t.def(e.shared.vao+".currentVAO?"+e.shared.vao+".currentVAO.instances:-1")}));return null}var f=u(mn,!0),d=function(){if(pn in n){var e=n[pn];return r.primitive=e,C.commandParameter(e,oe,"invalid primitve",t.commandStr),oi((function(t,n){return oe[e]}))}if(pn in i){var a=i[pn];return ai(a,(function(e,t){var n=e.constants.primTypes,i=e.invoke(t,a);return C.optional((function(){e.assert(t,i+" in "+n,"invalid primitive, must be one of "+Object.keys(oe))})),t.def(n,"[",i,"]")}))}return l?ri(c)?c.value?oi((function(e,t){return t.def(e.ELEMENTS,".primType")})):oi((function(){return 4})):new ii(c.thisDep,c.contextDep,c.propDep,(function(e,t){var n=e.ELEMENTS;return t.def(n,"?",n,".primType:",4)})):o?new ii(s.thisDep,s.contextDep,s.propDep,(function(e,t){return t.def(e.shared.vao+".currentVAO?"+e.shared.vao+".currentVAO.primitive:4")})):null}(),p=function(){if(gn in n){var e=0|n[gn];return r.count=e,C.command("number"==typeof e&&e>=0,"invalid vertex count",t.commandStr),oi((function(){return e}))}if(gn in i){var a=i[gn];return ai(a,(function(e,t){var n=e.invoke(t,a);return C.optional((function(){e.assert(t,"typeof "+n+'==="number"&&'+n+">=0&&"+n+"===("+n+"|0)","invalid vertex count")})),n}))}if(l){if(ri(c)){if(c)return f?new ii(f.thisDep,f.contextDep,f.propDep,(function(e,t){var n=t.def(e.ELEMENTS,".vertCount-",e.OFFSET);return C.optional((function(){e.assert(t,n+">=0","invalid vertex offset/element buffer too small")})),n})):oi((function(e,t){return t.def(e.ELEMENTS,".vertCount")}));var h=oi((function(){return-1}));return C.optional((function(){h.MISSING=!0})),h}var u=new ii(c.thisDep||f.thisDep,c.contextDep||f.contextDep,c.propDep||f.propDep,(function(e,t){var n=e.ELEMENTS;return e.OFFSET?t.def(n,"?",n,".vertCount-",e.OFFSET,":-1"):t.def(n,"?",n,".vertCount:-1")}));return C.optional((function(){u.DYNAMIC=!0})),u}if(o){var d=new ii(s.thisDep,s.contextDep,s.propDep,(function(e,t){return t.def(e.shared.vao,".currentVAO?",e.shared.vao,".currentVAO.count:-1")}));return d}return null}(),g=u(_n,!1);return{elements:c,primitive:d,count:p,instances:g,offset:f,vao:s,vaoActive:o,elementsActive:l,static:r}}(e,f),x=function(e,t){var n=e.static,i=e.dynamic,o={};return k.forEach((function(e){var a=D(e);function s(t,r){if(e in n){var s=t(n[e]);o[a]=oi((function(){return s}))}else if(e in i){var l=i[e];o[a]=ai(l,(function(e,t){return r(e,t,e.invoke(t,l))}))}}switch(e){case qt:case Ot:case It:case en:case Ht:case an:case Zt:case Yt:case Qt:case jt:return s((function(n){return C.commandType(n,"boolean",e,t.commandStr),n}),(function(t,n,i){return C.optional((function(){t.assert(n,"typeof "+i+'==="boolean"',"invalid flag "+e,t.commandStr)})),i}));case Ut:return s((function(n){return C.commandParameter(n,Yn,"invalid "+e,t.commandStr),Yn[n]}),(function(t,n,i){var r=t.constants.compareFuncs;return C.optional((function(){t.assert(n,i+" in "+r,"invalid "+e+", must be one of "+Object.keys(Yn))})),n.def(r,"[",i,"]")}));case $t:return s((function(e){return C.command(de(e)&&2===e.length&&"number"==typeof e[0]&&"number"==typeof e[1]&&e[0]<=e[1],"depth range is 2d array",t.commandStr),e}),(function(e,t,n){return C.optional((function(){e.assert(t,e.shared.isArrayLike+"("+n+")&&"+n+".length===2&&typeof "+n+'[0]==="number"&&typeof '+n+'[1]==="number"&&'+n+"[0]<="+n+"[1]","depth range must be a 2d array")})),[t.def("+",n,"[0]"),t.def("+",n,"[1]")]}));case Nt:return s((function(e){C.commandType(e,"object","blend.func",t.commandStr);var n="srcRGB"in e?e.srcRGB:e.src,i="srcAlpha"in e?e.srcAlpha:e.src,r="dstRGB"in e?e.dstRGB:e.dst,o="dstAlpha"in e?e.dstAlpha:e.dst;return C.commandParameter(n,Zn,a+".srcRGB",t.commandStr),C.commandParameter(i,Zn,a+".srcAlpha",t.commandStr),C.commandParameter(r,Zn,a+".dstRGB",t.commandStr),C.commandParameter(o,Zn,a+".dstAlpha",t.commandStr),C.command(-1===Xn.indexOf(n+", "+r),"unallowed blending combination (srcRGB, dstRGB) = ("+n+", "+r+")",t.commandStr),[Zn[n],Zn[r],Zn[i],Zn[o]]}),(function(t,n,i){var r=t.constants.blendFuncs;function o(o,a){var s=n.def('"',o,a,'" in ',i,"?",i,".",o,a,":",i,".",o);return C.optional((function(){t.assert(n,s+" in "+r,"invalid "+e+"."+o+a+", must be one of "+Object.keys(Zn))})),s}C.optional((function(){t.assert(n,i+"&&typeof "+i+'==="object"',"invalid blend func, must be an object")}));var a=o("src","RGB"),s=o("dst","RGB");C.optional((function(){var e=t.constants.invalidBlendCombinations;t.assert(n,e+".indexOf("+a+'+", "+'+s+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")}));var l=n.def(r,"[",a,"]"),c=n.def(r,"[",o("src","Alpha"),"]");return[l,n.def(r,"[",s,"]"),c,n.def(r,"[",o("dst","Alpha"),"]")]}));case Bt:return s((function(n){return"string"==typeof n?(C.commandParameter(n,_,"invalid "+e,t.commandStr),[_[n],_[n]]):"object"==typeof n?(C.commandParameter(n.rgb,_,e+".rgb",t.commandStr),C.commandParameter(n.alpha,_,e+".alpha",t.commandStr),[_[n.rgb],_[n.alpha]]):void C.commandRaise("invalid blend.equation",t.commandStr)}),(function(t,n,i){var r=t.constants.blendEquations,o=n.def(),a=n.def(),s=t.cond("typeof ",i,'==="string"');return C.optional((function(){function n(e,n,i){t.assert(e,i+" in "+r,"invalid "+n+", must be one of "+Object.keys(_))}n(s.then,e,i),t.assert(s.else,i+"&&typeof "+i+'==="object"',"invalid "+e),n(s.else,e+".rgb",i+".rgb"),n(s.else,e+".alpha",i+".alpha")})),s.then(o,"=",a,"=",r,"[",i,"];"),s.else(o,"=",r,"[",i,".rgb];",a,"=",r,"[",i,".alpha];"),n(s),[o,a]}));case Ft:return s((function(e){return C.command(de(e)&&4===e.length,"blend.color must be a 4d array",t.commandStr),I(4,(function(t){return+e[t]}))}),(function(e,t,n){return C.optional((function(){e.assert(t,e.shared.isArrayLike+"("+n+")&&"+n+".length===4","blend.color must be a 4d array")})),I(4,(function(e){return t.def("+",n,"[",e,"]")}))}));case tn:return s((function(e){return C.commandType(e,"number",a,t.commandStr),0|e}),(function(e,t,n){return C.optional((function(){e.assert(t,"typeof "+n+'==="number"',"invalid stencil.mask")})),t.def(n,"|0")}));case nn:return s((function(n){C.commandType(n,"object",a,t.commandStr);var i=n.cmp||"keep",r=n.ref||0,o="mask"in n?n.mask:-1;return C.commandParameter(i,Yn,e+".cmp",t.commandStr),C.commandType(r,"number",e+".ref",t.commandStr),C.commandType(o,"number",e+".mask",t.commandStr),[Yn[i],r,o]}),(function(e,t,n){var i=e.constants.compareFuncs;return C.optional((function(){function r(){e.assert(t,Array.prototype.join.call(arguments,""),"invalid stencil.func")}r(n+"&&typeof ",n,'==="object"'),r('!("cmp" in ',n,")||(",n,".cmp in ",i,")")})),[t.def('"cmp" in ',n,"?",i,"[",n,".cmp]",":",Gn),t.def(n,".ref|0"),t.def('"mask" in ',n,"?",n,".mask|0:-1")]}));case rn:case on:return s((function(n){C.commandType(n,"object",a,t.commandStr);var i=n.fail||"keep",r=n.zfail||"keep",o=n.zpass||"keep";return C.commandParameter(i,Qn,e+".fail",t.commandStr),C.commandParameter(r,Qn,e+".zfail",t.commandStr),C.commandParameter(o,Qn,e+".zpass",t.commandStr),[e===on?Vn:qn,Qn[i],Qn[r],Qn[o]]}),(function(t,n,i){var r=t.constants.stencilOps;function o(o){return C.optional((function(){t.assert(n,'!("'+o+'" in '+i+")||("+i+"."+o+" in "+r+")","invalid "+e+"."+o+", must be one of "+Object.keys(Qn))})),n.def('"',o,'" in ',i,"?",r,"[",i,".",o,"]:",Gn)}return C.optional((function(){t.assert(n,i+"&&typeof "+i+'==="object"',"invalid "+e)})),[e===on?Vn:qn,o("fail"),o("zfail"),o("zpass")]}));case Xt:return s((function(e){C.commandType(e,"object",a,t.commandStr);var n=0|e.factor,i=0|e.units;return C.commandType(n,"number",a+".factor",t.commandStr),C.commandType(i,"number",a+".units",t.commandStr),[n,i]}),(function(t,n,i){return C.optional((function(){t.assert(n,i+"&&typeof "+i+'==="object"',"invalid "+e)})),[n.def(i,".factor|0"),n.def(i,".units|0")]}));case Vt:return s((function(e){var n=0;return"front"===e?n=qn:"back"===e&&(n=Vn),C.command(!!n,a,t.commandStr),n}),(function(e,t,n){return C.optional((function(){e.assert(t,n+'==="front"||'+n+'==="back"',"invalid cull.face")})),t.def(n,'==="front"?',qn,":",Vn)}));case Gt:return s((function(e){return C.command("number"==typeof e&&e>=r.lineWidthDims[0]&&e<=r.lineWidthDims[1],"invalid line width, must be a positive number between "+r.lineWidthDims[0]+" and "+r.lineWidthDims[1],t.commandStr),e}),(function(e,t,n){return C.optional((function(){e.assert(t,"typeof "+n+'==="number"&&'+n+">="+r.lineWidthDims[0]+"&&"+n+"<="+r.lineWidthDims[1],"invalid line width")})),n}));case Kt:return s((function(e){return C.commandParameter(e,ei,a,t.commandStr),ei[e]}),(function(e,t,n){return C.optional((function(){e.assert(t,n+'==="cw"||'+n+'==="ccw"',"invalid frontFace, must be one of cw,ccw")})),t.def(n+'==="cw"?2304:'+Kn)}));case Wt:return s((function(e){return C.command(de(e)&&4===e.length,"color.mask must be length 4 array",t.commandStr),e.map((function(e){return!!e}))}),(function(e,t,n){return C.optional((function(){e.assert(t,e.shared.isArrayLike+"("+n+")&&"+n+".length===4","invalid color.mask")})),I(4,(function(e){return"!!"+n+"["+e+"]"}))}));case Jt:return s((function(e){C.command("object"==typeof e&&e,a,t.commandStr);var n="value"in e?e.value:1,i=!!e.invert;return C.command("number"==typeof n&&n>=0&&n<=1,"sample.coverage.value must be a number between 0 and 1",t.commandStr),[n,i]}),(function(e,t,n){return C.optional((function(){e.assert(t,n+"&&typeof "+n+'==="object"',"invalid sample.coverage")})),[t.def('"value" in ',n,"?+",n,".value:1"),t.def("!!",n,".invert")]}))}})),o}(e,f),S=function(e,t,i){var r=e.static,o=e.dynamic;function a(e){if(e in r){var t=n.id(r[e]);C.optional((function(){u.shader(Jn[e],t,C.guessCommand())}));var i=oi((function(){return t}));return i.id=t,i}if(e in o){var a=o[e];return ai(a,(function(t,n){var i=t.invoke(n,a),r=n.def(t.shared.strings,".id(",i,")");return C.optional((function(){n(t.shared.shader,".shader(",Jn[e],",",r,",",t.command,");")})),r}))}return null}var s,l=a(fn),c=a(un),h=null;return ri(l)&&ri(c)?(h=u.program(c.id,l.id,null,i),s=oi((function(e,t){return e.link(h)}))):s=new ii(l&&l.thisDep||c&&c.thisDep,l&&l.contextDep||c&&c.contextDep,l&&l.propDep||c&&c.propDep,(function(e,t){var n,i=e.shared.shader;n=l?l.append(e,t):t.def(i,".",fn);var r=i+".program("+(c?c.append(e,t):t.def(i,".",un))+","+n;return C.optional((function(){r+=","+e.command})),t.def(r+")")})),{frag:l,vert:c,progVar:s,program:h}}(e,0,g);function E(e){var t=y[e];t&&(x[e]=t)}E(ln),E(D(sn));var A=Object.keys(x).length>0,M={framebuffer:b,draw:w,shader:S,state:x,dirty:A,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(M.profile=function(e){var t,n=e.static,i=e.dynamic;if(cn in n){var r=!!n[cn];(t=oi((function(e,t){return r}))).enable=r}else if(cn in i){var o=i[cn];t=ai(o,(function(e,t){return e.invoke(t,o)}))}return t}(e),M.uniforms=function(e,t){var n=e.static,i=e.dynamic,r={};return Object.keys(n).forEach((function(e){var i,o=n[e];if("number"==typeof o||"boolean"==typeof o)i=oi((function(){return o}));else if("function"==typeof o){var a=o._reglType;"texture2d"===a||"textureCube"===a?i=oi((function(e){return e.link(o)})):"framebuffer"===a||"framebufferCube"===a?(C.command(o.color.length>0,'missing color attachment for framebuffer sent to uniform "'+e+'"',t.commandStr),i=oi((function(e){return e.link(o.color[0])}))):C.commandRaise('invalid data for uniform "'+e+'"',t.commandStr)}else de(o)?i=oi((function(t){return t.global.def("[",I(o.length,(function(n){return C.command("number"==typeof o[n]||"boolean"==typeof o[n],"invalid uniform "+e,t.commandStr),o[n]})),"]")})):C.commandRaise('invalid or missing data for uniform "'+e+'"',t.commandStr);i.value=o,r[e]=i})),Object.keys(i).forEach((function(e){var t=i[e];r[e]=ai(t,(function(e,n){return e.invoke(n,t)}))})),r}(s,f),M.drawVAO=M.scopeVAO=w.vao,!M.drawVAO&&S.program&&!g&&i.angle_instanced_arrays&&w.static.elements){var R=!0,L=S.program.attributes.map((function(e){var n=t.static[e];return R=R&&!!n,n}));if(R&&L.length>0){var T=h.getVAO(h.createVAO({attributes:L,elements:w.static.elements}));M.drawVAO=new ii(null,null,null,(function(e,t){return e.link(T)})),M.useVAO=!0}}return g?M.useVAO=!0:M.attributes=function(e,t){var i=e.static,r=e.dynamic,a={};return Object.keys(i).forEach((function(e){var r=i[e],s=n.id(e),l=new m;if(ti(r))l.state=1,l.buffer=o.getBuffer(o.create(r,En,!1,!0)),l.type=0;else{var c=o.getBuffer(r);if(c)l.state=1,l.buffer=c,l.type=0;else if(C.command("object"==typeof r&&r,"invalid data for attribute "+e,t.commandStr),"constant"in r){var h=r.constant;l.buffer="null",l.state=2,"number"==typeof h?l.x=h:(C.command(de(h)&&h.length>0&&h.length<=4,"invalid constant for attribute "+e,t.commandStr),zt.forEach((function(e,t){t<h.length&&(l[e]=h[t])})))}else{c=ti(r.buffer)?o.getBuffer(o.create(r.buffer,En,!1,!0)):o.getBuffer(r.buffer),C.command(!!c,'missing buffer for attribute "'+e+'"',t.commandStr);var u=0|r.offset;C.command(u>=0,'invalid offset for attribute "'+e+'"',t.commandStr);var f=0|r.stride;C.command(f>=0&&f<256,'invalid stride for attribute "'+e+'", must be integer betweeen [0, 255]',t.commandStr);var d=0|r.size;C.command(!("size"in r)||d>0&&d<=4,'invalid size for attribute "'+e+'", must be 1,2,3,4',t.commandStr);var p=!!r.normalized,g=0;"type"in r&&(C.commandParameter(r.type,Z,"invalid type for attribute "+e,t.commandStr),g=Z[r.type]);var _=0|r.divisor;C.optional((function(){"divisor"in r&&(C.command(0===_||v,'cannot specify divisor for attribute "'+e+'", instancing not supported',t.commandStr),C.command(_>=0,'invalid divisor for attribute "'+e+'"',t.commandStr));var n=t.commandStr,i=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(r).forEach((function(t){C.command(i.indexOf(t)>=0,'unknown parameter "'+t+'" for attribute pointer "'+e+'" (valid parameters are '+i+")",n)}))})),l.buffer=c,l.state=1,l.size=d,l.normalized=p,l.type=g||c.dtype,l.offset=u,l.stride=f,l.divisor=_}}a[e]=oi((function(e,t){var n=e.attribCache;if(s in n)return n[s];var i={isStream:!1};return Object.keys(l).forEach((function(e){i[e]=l[e]})),l.buffer&&(i.buffer=e.link(l.buffer),i.type=i.type||i.buffer+".dtype"),n[s]=i,i}))})),Object.keys(r).forEach((function(e){var t=r[e];a[e]=ai(t,(function(n,i){var r=n.invoke(i,t),o=n.shared,a=n.constants,s=o.isBufferArgs,l=o.buffer;C.optional((function(){n.assert(i,r+"&&(typeof "+r+'==="object"||typeof '+r+'==="function")&&('+s+"("+r+")||"+l+".getBuffer("+r+")||"+l+".getBuffer("+r+".buffer)||"+s+"("+r+'.buffer)||("constant" in '+r+"&&(typeof "+r+'.constant==="number"||'+o.isArrayLike+"("+r+".constant))))",'invalid dynamic attribute "'+e+'"')}));var c={isStream:i.def(!1)},h=new m;h.state=1,Object.keys(h).forEach((function(e){c[e]=i.def(""+h[e])}));var u=c.buffer,f=c.type;function d(e){i(c[e],"=",r,".",e,"|0;")}return i("if(",s,"(",r,")){",c.isStream,"=true;",u,"=",l,".createStream(",En,",",r,");",f,"=",u,".dtype;","}else{",u,"=",l,".getBuffer(",r,");","if(",u,"){",f,"=",u,".dtype;",'}else if("constant" in ',r,"){",c.state,"=",2,";","if(typeof "+r+'.constant === "number"){',c[zt[0]],"=",r,".constant;",zt.slice(1).map((function(e){return c[e]})).join("="),"=0;","}else{",zt.map((function(e,t){return c[e]+"="+r+".constant.length>"+t+"?"+r+".constant["+t+"]:0;"})).join(""),"}}else{","if(",s,"(",r,".buffer)){",u,"=",l,".createStream(",En,",",r,".buffer);","}else{",u,"=",l,".getBuffer(",r,".buffer);","}",f,'="type" in ',r,"?",a.glTypes,"[",r,".type]:",u,".dtype;",c.normalized,"=!!",r,".normalized;"),d("size"),d("offset"),d("stride"),d("divisor"),i("}}"),i.exit("if(",c.isStream,"){",l,".destroyStream(",u,");","}"),c}))})),a}(t,f),M.context=function(e){var t=e.static,n=e.dynamic,i={};return Object.keys(t).forEach((function(e){var n=t[e];i[e]=oi((function(e,t){return"number"==typeof n||"boolean"==typeof n?""+n:e.link(n)}))})),Object.keys(n).forEach((function(e){var t=n[e];i[e]=ai(t,(function(e,n){return e.invoke(n,t)}))})),i}(c),M}function F(e,t,n){var i=e.shared.context,r=e.scope();Object.keys(n).forEach((function(o){t.save(i,"."+o);var a=n[o].append(e,t);Array.isArray(a)?r(i,".",o,"=[",a.join(),"];"):r(i,".",o,"=",a,";")})),t(r)}function B(e,t,n,i){var r,o=e.shared,a=o.gl,s=o.framebuffer;b&&(r=t.def(o.extensions,".webgl_draw_buffers"));var l,c=e.constants,h=c.drawBuffer,u=c.backBuffer;l=n?n.append(e,t):t.def(s,".next"),i||t("if(",l,"!==",s,".cur){"),t("if(",l,"){",a,".bindFramebuffer(",36160,",",l,".framebuffer);"),b&&t(r,".drawBuffersWEBGL(",h,"[",l,".colorAttachments.length]);"),t("}else{",a,".bindFramebuffer(",36160,",null);"),b&&t(r,".drawBuffersWEBGL(",u,");"),t("}",s,".cur=",l,";"),i||t("}")}function N(e,t,n){var i=e.shared,r=i.gl,o=e.current,a=e.next,s=i.current,l=i.next,c=e.cond(s,".dirty");k.forEach((function(t){var i,h,u=D(t);if(!(u in n.state))if(u in a){i=a[u],h=o[u];var f=I(w[u].length,(function(e){return c.def(i,"[",e,"]")}));c(e.cond(f.map((function(e,t){return e+"!=="+h+"["+t+"]"})).join("||")).then(r,".",E[u],"(",f,");",f.map((function(e,t){return h+"["+t+"]="+e})).join(";"),";"))}else{i=c.def(l,".",u);var d=e.cond(i,"!==",s,".",u);c(d),u in S?d(e.cond(i).then(r,".enable(",S[u],");").else(r,".disable(",S[u],");"),s,".",u,"=",i,";"):d(r,".",E[u],"(",i,");",s,".",u,"=",i,";")}})),0===Object.keys(n.state).length&&c(s,".dirty=false;"),t(c)}function H(e,t,n,i){var r=e.shared,o=e.current,a=r.current,s=r.gl;ni(Object.keys(n)).forEach((function(r){var l=n[r];if(!i||i(l)){var c=l.append(e,t);if(S[r]){var h=S[r];ri(l)?t(s,c?".enable(":".disable(",h,");"):t(e.cond(c).then(s,".enable(",h,");").else(s,".disable(",h,");")),t(a,".",r,"=",c,";")}else if(de(c)){var u=o[r];t(s,".",E[r],"(",c,");",c.map((function(e,t){return u+"["+t+"]="+e})).join(";"),";")}else t(s,".",E[r],"(",c,");",a,".",r,"=",c,";")}}))}function U(e,t){v&&(e.instancing=t.def(e.shared.extensions,".angle_instanced_arrays"))}function $(e,t,n,i,r){var o,a,s,l=e.shared,c=e.stats,h=l.current,u=l.timer,f=n.profile;function d(){return"undefined"==typeof performance?"Date.now()":"performance.now()"}function g(e){e(o=t.def(),"=",d(),";"),"string"==typeof r?e(c,".count+=",r,";"):e(c,".count++;"),p&&(i?e(a=t.def(),"=",u,".getNumPendingQueries();"):e(u,".beginQuery(",c,");"))}function m(e){e(c,".cpuTime+=",d(),"-",o,";"),p&&(i?e(u,".pushScopeStats(",a,",",u,".getNumPendingQueries(),",c,");"):e(u,".endQuery();"))}function _(e){var n=t.def(h,".profile");t(h,".profile=",e,";"),t.exit(h,".profile=",n,";")}if(f){if(ri(f))return void(f.enable?(g(t),m(t.exit),_("true")):_("false"));_(s=f.append(e,t))}else s=t.def(h,".profile");var v=e.block();g(v),t("if(",s,"){",v,"}");var b=e.block();m(b),t.exit("if(",s,"){",b,"}")}function j(e,t,n,i,r){var o=e.shared;i.forEach((function(i){var a,s=i.name,l=n.attributes[s];if(l){if(!r(l))return;a=l.append(e,t)}else{if(!r(si))return;var c=e.scopeAttrib(s);C.optional((function(){e.assert(t,c+".state","missing attribute "+s)})),a={},Object.keys(new m).forEach((function(e){a[e]=t.def(c,".",e)}))}!function(n,i,r){var a=o.gl,s=t.def(n,".location"),l=t.def(o.attributes,"[",s,"]"),c=r.state,h=r.buffer,u=[r.x,r.y,r.z,r.w],f=["buffer","normalized","offset","stride"];function d(){t("if(!",l,".buffer){",a,".enableVertexAttribArray(",s,");}");var n,o=r.type;if(n=r.size?t.def(r.size,"||",i):i,t("if(",l,".type!==",o,"||",l,".size!==",n,"||",f.map((function(e){return l+"."+e+"!=="+r[e]})).join("||"),"){",a,".bindBuffer(",En,",",h,".buffer);",a,".vertexAttribPointer(",[s,n,o,r.normalized,r.stride,r.offset],");",l,".type=",o,";",l,".size=",n,";",f.map((function(e){return l+"."+e+"="+r[e]+";"})).join(""),"}"),v){var c=r.divisor;t("if(",l,".divisor!==",c,"){",e.instancing,".vertexAttribDivisorANGLE(",[s,c],");",l,".divisor=",c,";}")}}function p(){t("if(",l,".buffer){",a,".disableVertexAttribArray(",s,");",l,".buffer=null;","}if(",zt.map((function(e,t){return l+"."+e+"!=="+u[t]})).join("||"),"){",a,".vertexAttrib4f(",s,",",u,");",zt.map((function(e,t){return l+"."+e+"="+u[t]+";"})).join(""),"}")}1===c?d():2===c?p():(t("if(",c,"===",1,"){"),d(),t("}else{"),p(),t("}"))}(e.link(i),function(e){switch(e){case Mn:case Pn:case Fn:return 2;case Rn:case zn:case Bn:return 3;case Ln:case In:case Nn:return 4;default:return 1}}(i.info.type),a)}))}function W(e,t,i,r,o,a){for(var s,l=e.shared,c=l.gl,h={},u=0;u<r.length;++u){var f=r[u],d=f.name,p=f.info.type,g=f.info.size,m=i.uniforms[d];if(g>1){if(!m)continue;var _=d.replace("[0]","");if(h[_])continue;h[_]=1}var v,b=e.link(f)+".location";if(m){if(!o(m))continue;if(ri(m)){var y=m.value;if(C.command(null!=y,'missing uniform "'+d+'"',e.commandStr),p===jn||p===Wn){C.command("function"==typeof y&&(p===jn&&("texture2d"===y._reglType||"framebuffer"===y._reglType)||p===Wn&&("textureCube"===y._reglType||"framebufferCube"===y._reglType)),"invalid texture for uniform "+d,e.commandStr);var w=e.link(y._texture||y.color[0]._texture);t(c,".uniform1i(",b,",",w+".bind());"),t.exit(w,".unbind();")}else if(p===Hn||p===Un||p===$n){C.optional((function(){C.command(de(y),"invalid matrix for uniform "+d,e.commandStr),C.command(p===Hn&&4===y.length||p===Un&&9===y.length||p===$n&&16===y.length,"invalid length for matrix uniform "+d,e.commandStr)}));var x=e.global.def("new Float32Array(["+Array.prototype.slice.call(y)+"])"),k=2;p===Un?k=3:p===$n&&(k=4),t(c,".uniformMatrix",k,"fv(",b,",false,",x,");")}else{switch(p){case An:1===g?C.commandType(y,"number","uniform "+d,e.commandStr):C.command(de(y)&&y.length===g,"uniform "+d,e.commandStr),s="1f";break;case Mn:C.command(de(y)&&y.length&&y.length%2==0&&y.length<=2*g,"uniform "+d,e.commandStr),s="2f";break;case Rn:C.command(de(y)&&y.length&&y.length%3==0&&y.length<=3*g,"uniform "+d,e.commandStr),s="3f";break;case Ln:C.command(de(y)&&y.length&&y.length%4==0&&y.length<=4*g,"uniform "+d,e.commandStr),s="4f";break;case On:1===g?C.commandType(y,"boolean","uniform "+d,e.commandStr):C.command(de(y)&&y.length===g,"uniform "+d,e.commandStr),s="1i";break;case Tn:1===g?C.commandType(y,"number","uniform "+d,e.commandStr):C.command(de(y)&&y.length===g,"uniform "+d,e.commandStr),s="1i";break;case Fn:case Pn:C.command(de(y)&&y.length&&y.length%2==0&&y.length<=2*g,"uniform "+d,e.commandStr),s="2i";break;case Bn:case zn:C.command(de(y)&&y.length&&y.length%3==0&&y.length<=3*g,"uniform "+d,e.commandStr),s="3i";break;case Nn:case In:C.command(de(y)&&y.length&&y.length%4==0&&y.length<=4*g,"uniform "+d,e.commandStr),s="4i"}g>1?(s+="v",y=e.global.def("["+Array.prototype.slice.call(y)+"]")):y=de(y)?Array.prototype.slice.call(y):y,t(c,".uniform",s,"(",b,",",y,");")}continue}v=m.append(e,t)}else{if(!o(si))continue;v=t.def(l.uniforms,"[",n.id(d),"]")}p===jn?(C(!Array.isArray(v),"must specify a scalar prop for textures"),t("if(",v,"&&",v,'._reglType==="framebuffer"){',v,"=",v,".color[0];","}")):p===Wn&&(C(!Array.isArray(v),"must specify a scalar prop for cube maps"),t("if(",v,"&&",v,'._reglType==="framebufferCube"){',v,"=",v,".color[0];","}")),C.optional((function(){function n(n,i){e.assert(t,n,'bad data or missing for uniform "'+d+'".  '+i)}function i(e,t){1===t&&C(!Array.isArray(v),"must not specify an array type for uniform"),n("Array.isArray("+v+") && typeof "+v+'[0]===" '+e+'" || typeof '+v+'==="'+e+'"',"invalid type, expected "+e)}function r(t,i,r){Array.isArray(v)?C(v.length&&v.length%t==0&&v.length<=t*r,"must have length of "+(1===r?"":"n * ")+t):n(l.isArrayLike+"("+v+")&&"+v+".length && "+v+".length % "+t+" === 0 && "+v+".length<="+t*r,"invalid vector, should have length of "+(1===r?"":"n * ")+t,e.commandStr)}function o(t){C(!Array.isArray(v),"must not specify a value type"),n("typeof "+v+'==="function"&&'+v+'._reglType==="texture'+(3553===t?"2d":"Cube")+'"',"invalid texture type",e.commandStr)}switch(p){case Tn:i("number",g);break;case Pn:r(2,0,g);break;case zn:r(3,0,g);break;case In:r(4,0,g);break;case An:i("number",g);break;case Mn:r(2,0,g);break;case Rn:r(3,0,g);break;case Ln:r(4,0,g);break;case On:i("boolean",g);break;case Fn:r(2,0,g);break;case Bn:r(3,0,g);break;case Nn:case Hn:r(4,0,g);break;case Un:r(9,0,g);break;case $n:r(16,0,g);break;case jn:o(3553);break;case Wn:o(34067)}}));var S=1;switch(p){case jn:case Wn:var E=t.def(v,"._texture");t(c,".uniform1i(",b,",",E,".bind());"),t.exit(E,".unbind();");continue;case Tn:case On:s="1i";break;case Pn:case Fn:s="2i",S=2;break;case zn:case Bn:s="3i",S=3;break;case In:case Nn:s="4i",S=4;break;case An:s="1f";break;case Mn:s="2f",S=2;break;case Rn:s="3f",S=3;break;case Ln:s="4f",S=4;break;case Hn:s="Matrix2fv";break;case Un:s="Matrix3fv";break;case $n:s="Matrix4fv"}if(-1===s.indexOf("Matrix")&&g>1&&(s+="v",S=1),"M"===s.charAt(0)){t(c,".uniform",s,"(",b,",");var D=Math.pow(p-Hn+2,2),A=e.global.def("new Float32Array(",D,")");Array.isArray(v)?t("false,(",I(D,(function(e){return A+"["+e+"]="+v[e]})),",",A,")"):t("false,(Array.isArray(",v,")||",v," instanceof Float32Array)?",v,":(",I(D,(function(e){return A+"["+e+"]="+v+"["+e+"]"})),",",A,")"),t(");")}else if(S>1){for(var M=[],R=[],L=0;L<S;++L)Array.isArray(v)?R.push(v[L]):R.push(t.def(v+"["+L+"]")),a&&M.push(t.def());a&&t("if(!",e.batchId,"||",M.map((function(e,t){return e+"!=="+R[t]})).join("||"),"){",M.map((function(e,t){return e+"="+R[t]+";"})).join("")),t(c,".uniform",s,"(",b,",",R.join(","),");"),a&&t("}")}else{if(C(!Array.isArray(v),"uniform value must not be an array"),a){var T=t.def();t("if(!",e.batchId,"||",T,"!==",v,"){",T,"=",v,";")}t(c,".uniform",s,"(",b,",",v,");"),a&&t("}")}}}function q(e,t,n,i){var r=e.shared,o=r.gl,a=r.draw,s=i.draw;var l=function(){var l,c=s.elements,h=t;return c?((c.contextDep&&i.contextDynamic||c.propDep)&&(h=n),l=c.append(e,h),s.elementsActive&&h("if("+l+")"+o+".bindBuffer("+"34963,"+l+".buffer.buffer);")):(l=h.def(),h(l,"=",a,".",dn,";","if(",l,"){",o,".bindBuffer(",Dn,",",l,".buffer.buffer);}","else if(",r.vao,".currentVAO){",l,"=",e.shared.elements+".getElements("+r.vao,".currentVAO.elements);",y?"":"if("+l+")"+o+".bindBuffer("+"34963,"+l+".buffer.buffer);","}")),l}();function c(r){var o=s[r];return o?o.contextDep&&i.contextDynamic||o.propDep?o.append(e,n):o.append(e,t):t.def(a,".",r)}var h,u,f=c(pn),d=c(mn),p=function(){var r,o=s.count,l=t;return o?((o.contextDep&&i.contextDynamic||o.propDep)&&(l=n),r=o.append(e,l),C.optional((function(){o.MISSING&&e.assert(t,"false","missing vertex count"),o.DYNAMIC&&e.assert(l,r+">=0","missing vertex count")}))):(r=l.def(a,".",gn),C.optional((function(){e.assert(l,r+">=0","missing vertex count")}))),r}();if("number"==typeof p){if(0===p)return}else n("if(",p,"){"),n.exit("}");v&&(h=c(_n),u=e.instancing);var g=l+".type",m=s.elements&&ri(s.elements)&&!s.vaoActive;function _(){function e(){n(u,".drawElementsInstancedANGLE(",[f,p,g,d+"<<(("+g+"-5121)>>1)",h],");")}function t(){n(u,".drawArraysInstancedANGLE(",[f,d,p,h],");")}l&&"null"!==l?m?e():(n("if(",l,"){"),e(),n("}else{"),t(),n("}")):t()}function b(){function e(){n(o+".drawElements("+[f,p,g,d+"<<(("+g+"-5121)>>1)"]+");")}function t(){n(o+".drawArrays("+[f,d,p]+");")}l&&"null"!==l?m?e():(n("if(",l,"){"),e(),n("}else{"),t(),n("}")):t()}v&&("number"!=typeof h||h>=0)?"string"==typeof h?(n("if(",h,">0){"),_(),n("}else if(",h,"<0){"),b(),n("}")):_():b()}function V(e,t,n,i,r){var o=z(),a=o.proc("body",r);return C.optional((function(){o.commandStr=t.commandStr,o.command=o.link(t.commandStr)})),v&&(o.instancing=a.def(o.shared.extensions,".angle_instanced_arrays")),e(o,a,n,i),o.compile().body}function K(e,t,n,i){U(e,t),n.useVAO?n.drawVAO?t(e.shared.vao,".setVAO(",n.drawVAO.append(e,t),");"):t(e.shared.vao,".setVAO(",e.shared.vao,".targetVAO);"):(t(e.shared.vao,".setVAO(null);"),j(e,t,n,i.attributes,(function(){return!0}))),W(e,t,n,i.uniforms,(function(){return!0}),!1),q(e,t,t,n)}function G(e,t,n,i){function r(){return!0}e.batchId="a1",U(e,t),j(e,t,n,i.attributes,r),W(e,t,n,i.uniforms,r,!1),q(e,t,t,n)}function X(e,t,n,i){U(e,t);var r=n.contextDep,o=t.def(),a=t.def();e.shared.props=a,e.batchId=o;var s=e.scope(),l=e.scope();function c(e){return e.contextDep&&r||e.propDep}function h(e){return!c(e)}if(t(s.entry,"for(",o,"=0;",o,"<","a1",";++",o,"){",a,"=","a0","[",o,"];",l,"}",s.exit),n.needsContext&&F(e,l,n.context),n.needsFramebuffer&&B(e,l,n.framebuffer),H(e,l,n.state,c),n.profile&&c(n.profile)&&$(e,l,n,!1,!0),i)n.useVAO?n.drawVAO?c(n.drawVAO)?l(e.shared.vao,".setVAO(",n.drawVAO.append(e,l),");"):s(e.shared.vao,".setVAO(",n.drawVAO.append(e,s),");"):s(e.shared.vao,".setVAO(",e.shared.vao,".targetVAO);"):(s(e.shared.vao,".setVAO(null);"),j(e,s,n,i.attributes,h),j(e,l,n,i.attributes,c)),W(e,s,n,i.uniforms,h,!1),W(e,l,n,i.uniforms,c,!0),q(e,s,l,n);else{var u=e.global.def("{}"),f=n.shader.progVar.append(e,l),d=l.def(f,".id"),p=l.def(u,"[",d,"]");l(e.shared.gl,".useProgram(",f,".program);","if(!",p,"){",p,"=",u,"[",d,"]=",e.link((function(t){return V(G,e,n,t,2)})),"(",f,");}",p,".call(this,a0[",o,"],",o,");")}}function Y(e,t,n){var i=t.static[n];if(i&&function(e){if("object"==typeof e&&!de(e)){for(var t=Object.keys(e),n=0;n<t.length;++n)if(M.isDynamic(e[t[n]]))return!0;return!1}}(i)){var r=e.global,o=Object.keys(i),a=!1,s=!1,l=!1,c=e.global.def("{}");o.forEach((function(t){var n=i[t];if(M.isDynamic(n)){"function"==typeof n&&(n=i[t]=M.unbox(n));var o=ai(n,null);a=a||o.thisDep,l=l||o.propDep,s=s||o.contextDep}else{switch(r(c,".",t,"="),typeof n){case"number":r(n);break;case"string":r('"',n,'"');break;case"object":Array.isArray(n)&&r("[",n.join(),"]");break;default:r(e.link(n))}r(";")}})),t.dynamic[n]=new M.DynamicVariable(4,{thisDep:a,contextDep:s,propDep:l,ref:c,append:function(e,t){o.forEach((function(n){var r=i[n];if(M.isDynamic(r)){var o=e.invoke(t,r);t(c,".",n,"=",o,";")}}))}}),delete t.static[n]}}return{next:x,current:w,procs:function(){var e=z(),t=e.proc("poll"),n=e.proc("refresh"),o=e.block();t(o),n(o);var a,s=e.shared,l=s.gl,c=s.next,h=s.current;o(h,".dirty=false;"),B(e,t),B(e,n,null,!0),v&&(a=e.link(v)),i.oes_vertex_array_object&&n(e.link(i.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var u=0;u<r.maxAttributes;++u){var f=n.def(s.attributes,"[",u,"]"),d=e.cond(f,".buffer");d.then(l,".enableVertexAttribArray(",u,");",l,".bindBuffer(",En,",",f,".buffer.buffer);",l,".vertexAttribPointer(",u,",",f,".size,",f,".type,",f,".normalized,",f,".stride,",f,".offset);").else(l,".disableVertexAttribArray(",u,");",l,".vertexAttrib4f(",u,",",f,".x,",f,".y,",f,".z,",f,".w);",f,".buffer=null;"),n(d),v&&n(a,".vertexAttribDivisorANGLE(",u,",",f,".divisor);")}return n(e.shared.vao,".currentVAO=null;",e.shared.vao,".setVAO(",e.shared.vao,".targetVAO);"),Object.keys(S).forEach((function(i){var r=S[i],a=o.def(c,".",i),s=e.block();s("if(",a,"){",l,".enable(",r,")}else{",l,".disable(",r,")}",h,".",i,"=",a,";"),n(s),t("if(",a,"!==",h,".",i,"){",s,"}")})),Object.keys(E).forEach((function(i){var r,a,s=E[i],u=w[i],f=e.block();if(f(l,".",s,"("),de(u)){var d=u.length;r=e.global.def(c,".",i),a=e.global.def(h,".",i),f(I(d,(function(e){return r+"["+e+"]"})),");",I(d,(function(e){return a+"["+e+"]="+r+"["+e+"];"})).join("")),t("if(",I(d,(function(e){return r+"["+e+"]!=="+a+"["+e+"]"})).join("||"),"){",f,"}")}else r=o.def(c,".",i),a=o.def(h,".",i),f(r,");",h,".",i,"=",r,";"),t("if(",r,"!==",a,"){",f,"}");n(f)})),e.compile()}(),compile:function(e,i,r,o,a){var s=z();s.stats=s.link(a),Object.keys(i.static).forEach((function(e){Y(s,i,e)})),Sn.forEach((function(t){Y(s,e,t)}));var l=O(e,i,r,o,s);return function(e,t){var n=e.proc("draw",1);U(e,n),F(e,n,t.context),B(e,n,t.framebuffer),N(e,n,t),H(e,n,t.state),$(e,n,t,!1,!0);var i=t.shader.progVar.append(e,n);if(n(e.shared.gl,".useProgram(",i,".program);"),t.shader.program)K(e,n,t,t.shader.program);else{n(e.shared.vao,".setVAO(null);");var r=e.global.def("{}"),o=n.def(i,".id"),a=n.def(r,"[",o,"]");n(e.cond(a).then(a,".call(this,a0);").else(a,"=",r,"[",o,"]=",e.link((function(n){return V(K,e,t,n,1)})),"(",i,");",a,".call(this,a0);"))}Object.keys(t.state).length>0&&n(e.shared.current,".dirty=true;"),e.shared.vao&&n(e.shared.vao,".setVAO(null);")}(s,l),function(e,t){var i=e.proc("scope",3);e.batchId="a2";var r=e.shared,o=r.current;function a(n){var o=t.shader[n];o&&i.set(r.shader,"."+n,o.append(e,i))}F(e,i,t.context),t.framebuffer&&t.framebuffer.append(e,i),ni(Object.keys(t.state)).forEach((function(n){var o=t.state[n].append(e,i);de(o)?o.forEach((function(t,r){i.set(e.next[n],"["+r+"]",t)})):i.set(r.next,"."+n,o)})),$(e,i,t,!0,!0),[dn,mn,gn,_n,pn].forEach((function(n){var o=t.draw[n];o&&i.set(r.draw,"."+n,""+o.append(e,i))})),Object.keys(t.uniforms).forEach((function(o){var a=t.uniforms[o].append(e,i);Array.isArray(a)&&(a="["+a.join()+"]"),i.set(r.uniforms,"["+n.id(o)+"]",a)})),Object.keys(t.attributes).forEach((function(n){var r=t.attributes[n].append(e,i),o=e.scopeAttrib(n);Object.keys(new m).forEach((function(e){i.set(o,"."+e,r[e])}))})),t.scopeVAO&&i.set(r.vao,".targetVAO",t.scopeVAO.append(e,i)),a(un),a(fn),Object.keys(t.state).length>0&&(i(o,".dirty=true;"),i.exit(o,".dirty=true;")),i("a1(",e.shared.context,",a0,",e.batchId,");")}(s,l),function(e,t){var n=e.proc("batch",2);e.batchId="0",U(e,n);var i=!1,r=!0;Object.keys(t.context).forEach((function(e){i=i||t.context[e].propDep})),i||(F(e,n,t.context),r=!1);var o=t.framebuffer,a=!1;function s(e){return e.contextDep&&i||e.propDep}o?(o.propDep?i=a=!0:o.contextDep&&i&&(a=!0),a||B(e,n,o)):B(e,n,null),t.state.viewport&&t.state.viewport.propDep&&(i=!0),N(e,n,t),H(e,n,t.state,(function(e){return!s(e)})),t.profile&&s(t.profile)||$(e,n,t,!1,"a1"),t.contextDep=i,t.needsContext=r,t.needsFramebuffer=a;var l=t.shader.progVar;if(l.contextDep&&i||l.propDep)X(e,n,t,null);else{var c=l.append(e,n);if(n(e.shared.gl,".useProgram(",c,".program);"),t.shader.program)X(e,n,t,t.shader.program);else{n(e.shared.vao,".setVAO(null);");var h=e.global.def("{}"),u=n.def(c,".id"),f=n.def(h,"[",u,"]");n(e.cond(f).then(f,".call(this,a0,a1);").else(f,"=",h,"[",u,"]=",e.link((function(n){return V(X,e,t,n,2)})),"(",c,");",f,".call(this,a0,a1);"))}}Object.keys(t.state).length>0&&n(e.shared.current,".dirty=true;"),e.shared.vao&&n(e.shared.vao,".setVAO(null);")}(s,l),t(s.compile(),{destroy:function(){l.shader.program.destroy()}})}}}var ci=function(e,t){if(!t.ext_disjoint_timer_query)return null;var n=[];function i(e){n.push(e)}var r=[];function o(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var a=[];function s(e){a.push(e)}var l=[];function c(e,t,n){var i=a.pop()||new o;i.startQueryIndex=e,i.endQueryIndex=t,i.sum=0,i.stats=n,l.push(i)}var h=[],u=[];return{beginQuery:function(e){var i=n.pop()||t.ext_disjoint_timer_query.createQueryEXT();t.ext_disjoint_timer_query.beginQueryEXT(35007,i),r.push(i),c(r.length-1,r.length,e)},endQuery:function(){t.ext_disjoint_timer_query.endQueryEXT(35007)},pushScopeStats:c,update:function(){var e,n,o=r.length;if(0!==o){u.length=Math.max(u.length,o+1),h.length=Math.max(h.length,o+1),h[0]=0,u[0]=0;var a=0;for(e=0,n=0;n<r.length;++n){var c=r[n];t.ext_disjoint_timer_query.getQueryObjectEXT(c,34919)?(a+=t.ext_disjoint_timer_query.getQueryObjectEXT(c,34918),i(c)):r[e++]=c,h[n+1]=a,u[n+1]=e}for(r.length=e,e=0,n=0;n<l.length;++n){var f=l[n],d=f.startQueryIndex,p=f.endQueryIndex;f.sum+=h[p]-h[d];var g=u[d],m=u[p];m===g?(f.stats.gpuTime+=f.sum/1e6,s(f)):(f.startQueryIndex=g,f.endQueryIndex=m,l[e++]=f)}l.length=e}},getNumPendingQueries:function(){return r.length},clear:function(){n.push.apply(n,r);for(var e=0;e<n.length;e++)t.ext_disjoint_timer_query.deleteQueryEXT(n[e]);r.length=0,n.length=0},restore:function(){r.length=0,n.length=0}}},hi="webglcontextlost",ui="webglcontextrestored";function fi(e,t){for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1}return function(n){var i=z(n);if(!i)return null;var r=i.gl,o=r.getContextAttributes(),a=r.isContextLost(),s=function(e,t){var n={};function i(t){C.type(t,"string","extension name must be string");var i,r=t.toLowerCase();try{i=n[r]=e.getExtension(r)}catch(e){}return!!i}for(var r=0;r<t.extensions.length;++r){var o=t.extensions[r];if(!i(o))return t.onDestroy(),t.onDone('"'+o+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return t.optionalExtensions.forEach(i),{extensions:n,restore:function(){Object.keys(n).forEach((function(e){if(n[e]&&!i(e))throw new Error("(regl): error restoring extension "+e)}))}}}(r,i);if(!s)return null;var l,c,h=(l={"":0},c=[""],{id:function(e){var t=l[e];return t||(t=l[e]=c.length,c.push(e),t)},str:function(e){return c[e]}}),u={vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0},f=s.extensions,d=ci(0,f),p=L(),g=r.drawingBufferWidth,m=r.drawingBufferHeight,_={tick:0,time:0,viewportWidth:g,viewportHeight:m,framebufferWidth:g,framebufferHeight:m,drawingBufferWidth:g,drawingBufferHeight:m,pixelRatio:i.pixelRatio},v={elements:null,primitive:4,count:-1,offset:0,instances:-1},b=function(e,t){var n=1;t.ext_texture_filter_anisotropic&&(n=e.getParameter(34047));var i=1,r=1;t.webgl_draw_buffers&&(i=e.getParameter(34852),r=e.getParameter(36063));var o=!!t.oes_texture_float;if(o){var a=e.createTexture();e.bindTexture(N,a),e.texImage2D(N,0,H,1,1,0,H,U,null);var s=e.createFramebuffer();if(e.bindFramebuffer($,s),e.framebufferTexture2D($,36064,N,a,0),e.bindTexture(N,null),36053!==e.checkFramebufferStatus($))o=!1;else{e.viewport(0,0,1,1),e.clearColor(1,0,0,1),e.clear(16384);var l=B.allocType(U,4);e.readPixels(0,0,1,1,H,U,l),e.getError()?o=!1:(e.deleteFramebuffer(s),e.deleteTexture(a),o=1===l[0]),B.freeType(l)}}var c=!0;if("undefined"==typeof navigator||!(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent))){var h=e.createTexture(),u=B.allocType(5121,36);e.activeTexture(33984),e.bindTexture(34067,h),e.texImage2D(34069,0,H,3,3,0,H,5121,u),B.freeType(u),e.bindTexture(34067,null),e.deleteTexture(h),c=!e.getError()}return{colorBits:[e.getParameter(3410),e.getParameter(3411),e.getParameter(3412),e.getParameter(3413)],depthBits:e.getParameter(3414),stencilBits:e.getParameter(3415),subpixelBits:e.getParameter(3408),extensions:Object.keys(t).filter((function(e){return!!t[e]})),maxAnisotropic:n,maxDrawbuffers:i,maxColorAttachments:r,pointSizeDims:e.getParameter(33901),lineWidthDims:e.getParameter(33902),maxViewportDims:e.getParameter(3386),maxCombinedTextureUnits:e.getParameter(35661),maxCubeMapSize:e.getParameter(34076),maxRenderbufferSize:e.getParameter(34024),maxTextureUnits:e.getParameter(34930),maxTextureSize:e.getParameter(3379),maxAttributes:e.getParameter(34921),maxVertexUniforms:e.getParameter(36347),maxVertexTextureUnits:e.getParameter(35660),maxVaryingVectors:e.getParameter(36348),maxFragmentUniforms:e.getParameter(36349),glsl:e.getParameter(35724),renderer:e.getParameter(7937),vendor:e.getParameter(7936),version:e.getParameter(7938),readFloat:o,npotTextureCube:c}}(r,f),y=function(t,n,i,r){var o=0,a={};function s(e){this.id=o++,this.buffer=t.createBuffer(),this.type=e,this.usage=35044,this.byteLength=0,this.dimension=1,this.dtype=J,this.persistentData=null,i.profile&&(this.stats={size:0})}s.prototype.bind=function(){t.bindBuffer(this.type,this.buffer)},s.prototype.destroy=function(){u(this)};var l=[];function c(e,n,i){e.byteLength=n.byteLength,t.bufferData(e.type,n,i)}function h(t,n,i,r,o,a){var s,l;if(t.usage=i,Array.isArray(n)){if(t.dtype=r||ee,n.length>0)if(Array.isArray(n[0])){s=Q(n);for(var h=1,u=1;u<s.length;++u)h*=s[u];t.dimension=h,c(t,l=Y(n,s,t.dtype),i),a?t.persistentData=l:B.freeType(l)}else if("number"==typeof n[0]){t.dimension=o;var f=B.allocType(t.dtype,n.length);ie(f,n),c(t,f,i),a?t.persistentData=f:B.freeType(f)}else e(n[0])?(t.dimension=n[0].length,t.dtype=r||ne(n[0])||ee,c(t,l=Y(n,[n.length,n[0].length],t.dtype),i),a?t.persistentData=l:B.freeType(l)):C.raise("invalid buffer data")}else if(e(n))t.dtype=r||ne(n),t.dimension=o,c(t,n,i),a&&(t.persistentData=new Uint8Array(new Uint8Array(n.buffer)));else if(j(n)){s=n.shape;var d=n.stride,p=n.offset,g=0,m=0,_=0,v=0;1===s.length?(g=s[0],m=1,_=d[0],v=0):2===s.length?(g=s[0],m=s[1],_=d[0],v=d[1]):C.raise("invalid shape"),t.dtype=r||ne(n.data)||ee,t.dimension=m;var b=B.allocType(t.dtype,g*m);re(b,n.data,g,m,_,v,p),c(t,b,i),a?t.persistentData=b:B.freeType(b)}else n instanceof ArrayBuffer?(t.dtype=J,t.dimension=o,c(t,n,i),a&&(t.persistentData=new Uint8Array(new Uint8Array(n)))):C.raise("invalid buffer data")}function u(e){n.bufferCount--,r(e);var i=e.buffer;C(i,"buffer must not be deleted already"),t.deleteBuffer(i),e.buffer=null,delete a[e.id]}return i.profile&&(n.getTotalBufferSize=function(){var e=0;return Object.keys(a).forEach((function(t){e+=a[t].stats.size})),e}),{create:function(r,o,l,c){n.bufferCount++;var f=new s(o);function d(n){var r=35044,o=null,a=0,s=0,l=1;return Array.isArray(n)||e(n)||j(n)||n instanceof ArrayBuffer?o=n:"number"==typeof n?a=0|n:n&&(C.type(n,"object","buffer arguments must be an object, a number or an array"),"data"in n&&(C(null===o||Array.isArray(o)||e(o)||j(o),"invalid data for buffer"),o=n.data),"usage"in n&&(C.parameter(n.usage,X,"invalid buffer usage"),r=X[n.usage]),"type"in n&&(C.parameter(n.type,Z,"invalid buffer type"),s=Z[n.type]),"dimension"in n&&(C.type(n.dimension,"number","invalid dimension"),l=0|n.dimension),"length"in n&&(C.nni(a,"buffer length must be a nonnegative integer"),a=0|n.length)),f.bind(),o?h(f,o,r,s,l,c):(a&&t.bufferData(f.type,a,r),f.dtype=s||J,f.usage=r,f.dimension=l,f.byteLength=a),i.profile&&(f.stats.size=f.byteLength*te[f.dtype]),d}function p(e,n){C(n+e.byteLength<=f.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+e.byteLength+" starting from offset "+n+" to a buffer of size "+f.byteLength),t.bufferSubData(f.type,n,e)}return a[f.id]=f,l||d(r),d._reglType="buffer",d._buffer=f,d.subdata=function(t,n){var i,r=0|(n||0);if(f.bind(),e(t)||t instanceof ArrayBuffer)p(t,r);else if(Array.isArray(t)){if(t.length>0)if("number"==typeof t[0]){var o=B.allocType(f.dtype,t.length);ie(o,t),p(o,r),B.freeType(o)}else if(Array.isArray(t[0])||e(t[0])){i=Q(t);var a=Y(t,i,f.dtype);p(a,r),B.freeType(a)}else C.raise("invalid buffer data")}else if(j(t)){i=t.shape;var s=t.stride,l=0,c=0,h=0,u=0;1===i.length?(l=i[0],c=1,h=s[0],u=0):2===i.length?(l=i[0],c=i[1],h=s[0],u=s[1]):C.raise("invalid shape");var g=Array.isArray(t.data)?f.dtype:ne(t.data),m=B.allocType(g,l*c);re(m,t.data,l,c,h,u,t.offset),p(m,r),B.freeType(m)}else C.raise("invalid data for buffer subdata");return d},i.profile&&(d.stats=f.stats),d.destroy=function(){u(f)},d},createStream:function(e,t){var n=l.pop();return n||(n=new s(e)),n.bind(),h(n,t,35040,0,1,!1),n},destroyStream:function(e){l.push(e)},clear:function(){W(a).forEach(u),l.forEach(u)},getBuffer:function(e){return e&&e._buffer instanceof s?e._buffer:null},restore:function(){W(a).forEach((function(e){e.buffer=t.createBuffer(),t.bindBuffer(e.type,e.buffer),t.bufferData(e.type,e.persistentData||e.byteLength,e.usage)}))},_initBuffer:h}}(r,u,i,(function(e){return x.destroyBuffer(e)})),w=function(t,n,i,r){var o={},a=0,s={uint8:ae,uint16:se};function l(e){this.id=a++,o[this.id]=this,this.buffer=e,this.primType=4,this.vertCount=0,this.type=0}n.oes_element_index_uint&&(s.uint32=le),l.prototype.bind=function(){this.buffer.bind()};var c=[];function h(r,o,a,s,l,c,h){var u;if(r.buffer.bind(),o){var f=h;h||e(o)&&(!j(o)||e(o.data))||(f=n.oes_element_index_uint?le:se),i._initBuffer(r.buffer,o,a,f,3)}else t.bufferData(ce,c,a),r.buffer.dtype=u||ae,r.buffer.usage=a,r.buffer.dimension=3,r.buffer.byteLength=c;if(u=h,!h){switch(r.buffer.dtype){case ae:case 5120:u=ae;break;case se:case 5122:u=se;break;case le:case 5124:u=le;break;default:C.raise("unsupported type for element array")}r.buffer.dtype=u}r.type=u,C(u!==le||!!n.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var d=l;d<0&&(d=r.buffer.byteLength,u===se?d>>=1:u===le&&(d>>=2)),r.vertCount=d;var p=s;if(s<0){p=4;var g=r.buffer.dimension;1===g&&(p=0),2===g&&(p=1),3===g&&(p=4)}r.primType=p}function u(e){r.elementsCount--,C(null!==e.buffer,"must not double destroy elements"),delete o[e.id],e.buffer.destroy(),e.buffer=null}return{create:function(t,n){var o=i.create(null,ce,!0),a=new l(o._buffer);function c(t){if(t)if("number"==typeof t)o(t),a.primType=4,a.vertCount=0|t,a.type=ae;else{var n=null,i=35044,r=-1,l=-1,u=0,f=0;Array.isArray(t)||e(t)||j(t)?n=t:(C.type(t,"object","invalid arguments for elements"),"data"in t&&(n=t.data,C(Array.isArray(n)||e(n)||j(n),"invalid data for element buffer")),"usage"in t&&(C.parameter(t.usage,X,"invalid element buffer usage"),i=X[t.usage]),"primitive"in t&&(C.parameter(t.primitive,oe,"invalid element buffer primitive"),r=oe[t.primitive]),"count"in t&&(C("number"==typeof t.count&&t.count>=0,"invalid vertex count for elements"),l=0|t.count),"type"in t&&(C.parameter(t.type,s,"invalid buffer type"),f=s[t.type]),"length"in t?u=0|t.length:(u=l,f===se||5122===f?u*=2:f!==le&&5124!==f||(u*=4))),h(a,n,i,r,l,u,f)}else o(),a.primType=4,a.vertCount=0,a.type=ae;return c}return r.elementsCount++,c(t),c._reglType="elements",c._elements=a,c.subdata=function(e,t){return o.subdata(e,t),c},c.destroy=function(){u(a)},c},createStream:function(e){var t=c.pop();return t||(t=new l(i.create(null,ce,!0,!1)._buffer)),h(t,e,35040,-1,-1,0,0),t},destroyStream:function(e){c.push(e)},getElements:function(e){return"function"==typeof e&&e._elements instanceof l?e._elements:null},clear:function(){W(o).forEach(u)}}}(r,f,y,u),x=function(t,n,i,r,o,a,s){for(var l=i.maxAttributes,c=new Array(l),h=0;h<l;++h)c[h]=new At;var u=0,f={},d={Record:At,scope:{},state:c,currentVAO:null,targetVAO:null,restore:p()?function(){p()&&W(f).forEach((function(e){e.refresh()}))}:function(){},createVAO:function(t){var i=new m;function s(t){var r;if(Array.isArray(t))r=t,i.elements&&i.ownsElements&&i.elements.destroy(),i.elements=null,i.ownsElements=!1,i.offset=0,i.count=0,i.instances=-1,i.primitive=4;else{if(C("object"==typeof t,"invalid arguments for create vao"),C("attributes"in t,"must specify attributes for vao"),t.elements){var c=t.elements;i.ownsElements?"function"==typeof c&&"elements"===c._reglType?(i.elements.destroy(),i.ownsElements=!1):(i.elements(c),i.ownsElements=!1):a.getElements(t.elements)?(i.elements=t.elements,i.ownsElements=!1):(i.elements=a.create(t.elements),i.ownsElements=!0)}else i.elements=null,i.ownsElements=!1;r=t.attributes,i.offset=0,i.count=-1,i.instances=-1,i.primitive=4,i.elements&&(i.count=i.elements._elements.vertCount,i.primitive=i.elements._elements.primType),"offset"in t&&(i.offset=0|t.offset),"count"in t&&(i.count=0|t.count),"instances"in t&&(i.instances=0|t.instances),"primitive"in t&&(C(t.primitive in oe,"bad primitive type: "+t.primitive),i.primitive=oe[t.primitive]),C.optional((()=>{for(var e=Object.keys(t),n=0;n<e.length;++n)C(Dt.indexOf(e[n])>=0,'invalid option for vao: "'+e[n]+'" valid options are '+Dt)})),C(Array.isArray(r),"attributes must be an array")}C(r.length<l,"too many attributes"),C(r.length>0,"must specify at least one attribute");var h={},u=i.attributes;u.length=r.length;for(var f=0;f<r.length;++f){var d,p=r[f],g=u[f]=new At,m=p.data||p;Array.isArray(m)||e(m)||j(m)?(i.buffers[f]&&(d=i.buffers[f],e(m)&&d._buffer.byteLength>=m.byteLength?d.subdata(m):(d.destroy(),i.buffers[f]=null)),i.buffers[f]||(d=i.buffers[f]=o.create(p,34962,!1,!0)),g.buffer=o.getBuffer(d),g.size=0|g.buffer.dimension,g.normalized=!1,g.type=g.buffer.dtype,g.offset=0,g.stride=0,g.divisor=0,g.state=1,h[f]=1):o.getBuffer(p)?(g.buffer=o.getBuffer(p),g.size=0|g.buffer.dimension,g.normalized=!1,g.type=g.buffer.dtype,g.offset=0,g.stride=0,g.divisor=0,g.state=1):o.getBuffer(p.buffer)?(g.buffer=o.getBuffer(p.buffer),g.size=0|(+p.size||g.buffer.dimension),g.normalized=!!p.normalized||!1,"type"in p?(C.parameter(p.type,Z,"invalid buffer type"),g.type=Z[p.type]):g.type=g.buffer.dtype,g.offset=0|(p.offset||0),g.stride=0|(p.stride||0),g.divisor=0|(p.divisor||0),g.state=1,C(g.size>=1&&g.size<=4,"size must be between 1 and 4"),C(g.offset>=0,"invalid offset"),C(g.stride>=0&&g.stride<=255,"stride must be between 0 and 255"),C(g.divisor>=0,"divisor must be positive"),C(!g.divisor||!!n.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in p?(C(f>0,"first attribute must not be a constant"),g.x=+p.x||0,g.y=+p.y||0,g.z=+p.z||0,g.w=+p.w||0,g.state=2):C(!1,"invalid attribute spec for location "+f)}for(var _=0;_<i.buffers.length;++_)!h[_]&&i.buffers[_]&&(i.buffers[_].destroy(),i.buffers[_]=null);return i.refresh(),s}return r.vaoCount+=1,s.destroy=function(){for(var e=0;e<i.buffers.length;++e)i.buffers[e]&&i.buffers[e].destroy();i.buffers.length=0,i.ownsElements&&(i.elements.destroy(),i.elements=null,i.ownsElements=!1),i.destroy()},s._vao=i,s._reglType="vao",s(t)},getVAO:function(e){return"function"==typeof e&&e._vao?e._vao:null},destroyBuffer:function(e){for(var n=0;n<c.length;++n){var i=c[n];i.buffer===e&&(t.disableVertexAttribArray(n),i.buffer=null)}},setVAO:p()?function(e){if(e!==d.currentVAO){var t=p();e?t.bindVertexArrayOES(e.vao):t.bindVertexArrayOES(null),d.currentVAO=e}}:function(e){if(e!==d.currentVAO){if(e)e.bindAttrs();else{for(var n=g(),i=0;i<c.length;++i){var r=c[i];r.buffer?(t.enableVertexAttribArray(i),r.buffer.bind(),t.vertexAttribPointer(i,r.size,r.type,r.normalized,r.stride,r.offfset),n&&r.divisor&&n.vertexAttribDivisorANGLE(i,r.divisor)):(t.disableVertexAttribArray(i),t.vertexAttrib4f(i,r.x,r.y,r.z,r.w))}s.elements?t.bindBuffer(Et,s.elements.buffer.buffer):t.bindBuffer(Et,null)}d.currentVAO=e}},clear:p()?function(){W(f).forEach((function(e){e.destroy()}))}:function(){}};function p(){return n.oes_vertex_array_object}function g(){return n.angle_instanced_arrays}function m(){this.id=++u,this.attributes=[],this.elements=null,this.ownsElements=!1,this.count=0,this.offset=0,this.instances=-1,this.primitive=4;var e=p();this.vao=e?e.createVertexArrayOES():null,f[this.id]=this,this.buffers=[]}return m.prototype.bindAttrs=function(){for(var e=g(),n=this.attributes,i=0;i<n.length;++i){var r=n[i];r.buffer?(t.enableVertexAttribArray(i),t.bindBuffer(34962,r.buffer.buffer),t.vertexAttribPointer(i,r.size,r.type,r.normalized,r.stride,r.offset),e&&r.divisor&&e.vertexAttribDivisorANGLE(i,r.divisor)):(t.disableVertexAttribArray(i),t.vertexAttrib4f(i,r.x,r.y,r.z,r.w))}for(var o=n.length;o<l;++o)t.disableVertexAttribArray(o);var s=a.getElements(this.elements);s?t.bindBuffer(Et,s.buffer.buffer):t.bindBuffer(Et,null)},m.prototype.refresh=function(){var e=p();e&&(e.bindVertexArrayOES(this.vao),this.bindAttrs(),d.currentVAO=null,e.bindVertexArrayOES(null))},m.prototype.destroy=function(){if(this.vao){var e=p();this===d.currentVAO&&(d.currentVAO=null,e.bindVertexArrayOES(null)),e.deleteVertexArrayOES(this.vao),this.vao=null}this.ownsElements&&(this.elements.destroy(),this.elements=null,this.ownsElements=!1),f[this.id]&&(delete f[this.id],r.vaoCount-=1)},d}(r,f,b,u,y,w,v),k=function(e,n,i,r){var o={},a={};function s(e,t,n,i){this.name=e,this.id=t,this.location=n,this.info=i}function l(e,t){for(var n=0;n<e.length;++n)if(e[n].id===t.id)return void(e[n].location=t.location);e.push(t)}function c(t,i,r){var s=35632===t?o:a,l=s[i];if(!l){var c=n.str(i);l=e.createShader(t),e.shaderSource(l,c),e.compileShader(l),C.shaderError(e,l,c,t,r),s[i]=l}return l}var h={},u=[],f=0;function d(e,t){this.id=f++,this.fragId=e,this.vertId=t,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,r.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function p(t,i,o){var a,h,u=c(35632,t.fragId),f=c(35633,t.vertId),d=t.program=e.createProgram();if(e.attachShader(d,u),e.attachShader(d,f),o)for(a=0;a<o.length;++a){var p=o[a];e.bindAttribLocation(d,p[0],p[1])}e.linkProgram(d),C.linkError(e,d,n.str(t.fragId),n.str(t.vertId),i);var g=e.getProgramParameter(d,35718);r.profile&&(t.stats.uniformsCount=g);var m=t.uniforms;for(a=0;a<g;++a)if(h=e.getActiveUniform(d,a)){if(h.size>1)for(var _=0;_<h.size;++_){var v=h.name.replace("[0]","["+_+"]");l(m,new s(v,n.id(v),e.getUniformLocation(d,v),h))}var b=h.name;h.size>1&&(b=b.replace("[0]","")),l(m,new s(b,n.id(b),e.getUniformLocation(d,b),h))}var y=e.getProgramParameter(d,35721);r.profile&&(t.stats.attributesCount=y);var w=t.attributes;for(a=0;a<y;++a)(h=e.getActiveAttrib(d,a))&&l(w,new s(h.name,n.id(h.name),e.getAttribLocation(d,h.name),h))}return r.profile&&(i.getMaxUniformsCount=function(){var e=0;return u.forEach((function(t){t.stats.uniformsCount>e&&(e=t.stats.uniformsCount)})),e},i.getMaxAttributesCount=function(){var e=0;return u.forEach((function(t){t.stats.attributesCount>e&&(e=t.stats.attributesCount)})),e}),{clear:function(){var t=e.deleteShader.bind(e);W(o).forEach(t),o={},W(a).forEach(t),a={},u.forEach((function(t){e.deleteProgram(t.program)})),u.length=0,h={},i.shaderCount=0},program:function(n,r,s,l){C.command(n>=0,"missing vertex shader",s),C.command(r>=0,"missing fragment shader",s);var c=h[r];c||(c=h[r]={});var f=c[n];if(f&&(f.refCount++,!l))return f;var g=new d(r,n);return i.shaderCount++,p(g,s,l),f||(c[n]=g),u.push(g),t(g,{destroy:function(){if(g.refCount--,g.refCount<=0){e.deleteProgram(g.program);var t=u.indexOf(g);u.splice(t,1),i.shaderCount--}c[g.vertId].refCount<=0&&(e.deleteShader(a[g.vertId]),delete a[g.vertId],delete h[g.fragId][g.vertId]),Object.keys(h[g.fragId]).length||(e.deleteShader(o[g.fragId]),delete o[g.fragId],delete h[g.fragId])}})},restore:function(){o={},a={};for(var e=0;e<u.length;++e)p(u[e],null,u[e].attributes.map((function(e){return[e.location,e.name]})))},shader:c,frag:-1,vert:-1}}(r,h,u,i),S=ft(r,f,b,(function(){A.procs.poll()}),_,u,i),E=function(e,t,n,i,r){var o={rgba4:pt,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};t.ext_srgb&&(o.srgba=35907),t.ext_color_buffer_half_float&&(o.rgba16f=34842,o.rgb16f=34843),t.webgl_color_buffer_float&&(o.rgba32f=34836);var a=[];Object.keys(o).forEach((function(e){var t=o[e];a[t]=e}));var s=0,l={};function c(e){this.id=s++,this.refCount=1,this.renderbuffer=e,this.format=pt,this.width=0,this.height=0,r.profile&&(this.stats={size:0})}function h(t){var n=t.renderbuffer;C(n,"must not double destroy renderbuffer"),e.bindRenderbuffer(dt,null),e.deleteRenderbuffer(n),t.renderbuffer=null,t.refCount=0,delete l[t.id],i.renderbufferCount--}return c.prototype.decRef=function(){--this.refCount<=0&&h(this)},r.profile&&(i.getTotalRenderbufferSize=function(){var e=0;return Object.keys(l).forEach((function(t){e+=l[t].stats.size})),e}),{create:function(t,s){var h=new c(e.createRenderbuffer());function u(t,i){var s=0,l=0,c=pt;if("object"==typeof t&&t){var f=t;if("shape"in f){var d=f.shape;C(Array.isArray(d)&&d.length>=2,"invalid renderbuffer shape"),s=0|d[0],l=0|d[1]}else"radius"in f&&(s=l=0|f.radius),"width"in f&&(s=0|f.width),"height"in f&&(l=0|f.height);"format"in f&&(C.parameter(f.format,o,"invalid renderbuffer format"),c=o[f.format])}else"number"==typeof t?(s=0|t,l="number"==typeof i?0|i:s):t?C.raise("invalid arguments to renderbuffer constructor"):s=l=1;if(C(s>0&&l>0&&s<=n.maxRenderbufferSize&&l<=n.maxRenderbufferSize,"invalid renderbuffer size"),s!==h.width||l!==h.height||c!==h.format)return u.width=h.width=s,u.height=h.height=l,h.format=c,e.bindRenderbuffer(dt,h.renderbuffer),e.renderbufferStorage(dt,c,s,l),C(0===e.getError(),"invalid render buffer format"),r.profile&&(h.stats.size=mt(h.format,h.width,h.height)),u.format=a[h.format],u}return l[h.id]=h,i.renderbufferCount++,u(t,s),u.resize=function(t,i){var o=0|t,a=0|i||o;return o===h.width&&a===h.height||(C(o>0&&a>0&&o<=n.maxRenderbufferSize&&a<=n.maxRenderbufferSize,"invalid renderbuffer size"),u.width=h.width=o,u.height=h.height=a,e.bindRenderbuffer(dt,h.renderbuffer),e.renderbufferStorage(dt,h.format,o,a),C(0===e.getError(),"invalid render buffer format"),r.profile&&(h.stats.size=mt(h.format,h.width,h.height))),u},u._reglType="renderbuffer",u._renderbuffer=h,r.profile&&(u.stats=h.stats),u.destroy=function(){h.decRef()},u},clear:function(){W(l).forEach(h)},restore:function(){W(l).forEach((function(t){t.renderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(dt,t.renderbuffer),e.renderbufferStorage(dt,t.format,t.width,t.height)})),e.bindRenderbuffer(dt,null)}}}(r,f,b,u,i),D=function(e,n,i,r,o,a){var s={cur:null,next:null,dirty:!1,setFBO:null},l=["rgba"],c=["rgba4","rgb565","rgb5 a1"];n.ext_srgb&&c.push("srgba"),n.ext_color_buffer_half_float&&c.push("rgba16f","rgb16f"),n.webgl_color_buffer_float&&c.push("rgba32f");var h=["uint8"];function u(e,t,n){this.target=e,this.texture=t,this.renderbuffer=n;var i=0,r=0;t?(i=t.width,r=t.height):n&&(i=n.width,r=n.height),this.width=i,this.height=r}function f(e){e&&(e.texture&&e.texture._texture.decRef(),e.renderbuffer&&e.renderbuffer._renderbuffer.decRef())}function d(e,t,n){if(e)if(e.texture){var i=e.texture._texture,r=Math.max(1,i.width),o=Math.max(1,i.height);C(r===t&&o===n,"inconsistent width/height for supplied texture"),i.refCount+=1}else{var a=e.renderbuffer._renderbuffer;C(a.width===t&&a.height===n,"inconsistent width/height for renderbuffer"),a.refCount+=1}}function p(t,n){n&&(n.texture?e.framebufferTexture2D(_t,t,n.target,n.texture._texture.texture,0):e.framebufferRenderbuffer(_t,t,vt,n.renderbuffer._renderbuffer.renderbuffer))}function g(e){var t=bt,n=null,i=null,r=e;"object"==typeof e&&(r=e.data,"target"in e&&(t=0|e.target)),C.type(r,"function","invalid attachment data");var o=r._reglType;return"texture2d"===o?(n=r,C(t===bt)):"textureCube"===o?(n=r,C(t>=yt&&t<34075,"invalid cube map target")):"renderbuffer"===o?(i=r,t=vt):C.raise("invalid regl object for attachment"),new u(t,n,i)}function m(e,t,n,i,a){if(n){var s=r.create2D({width:e,height:t,format:i,type:a});return s._texture.refCount=0,new u(bt,s,null)}var l=o.create({width:e,height:t,format:i});return l._renderbuffer.refCount=0,new u(vt,null,l)}function _(e){return e&&(e.texture||e.renderbuffer)}function v(e,t,n){e&&(e.texture?e.texture.resize(t,n):e.renderbuffer&&e.renderbuffer.resize(t,n),e.width=t,e.height=n)}n.oes_texture_half_float&&h.push("half float","float16"),n.oes_texture_float&&h.push("float","float32");var b=0,y={};function w(){this.id=b++,y[this.id]=this,this.framebuffer=e.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function x(e){e.colorAttachments.forEach(f),f(e.depthAttachment),f(e.stencilAttachment),f(e.depthStencilAttachment)}function k(t){var n=t.framebuffer;C(n,"must not double destroy framebuffer"),e.deleteFramebuffer(n),t.framebuffer=null,a.framebufferCount--,delete y[t.id]}function S(t){var n;e.bindFramebuffer(_t,t.framebuffer);var r=t.colorAttachments;for(n=0;n<r.length;++n)p(36064+n,r[n]);for(n=r.length;n<i.maxColorAttachments;++n)e.framebufferTexture2D(_t,36064+n,bt,null,0);e.framebufferTexture2D(_t,33306,bt,null,0),e.framebufferTexture2D(_t,36096,bt,null,0),e.framebufferTexture2D(_t,36128,bt,null,0),p(36096,t.depthAttachment),p(36128,t.stencilAttachment),p(33306,t.depthStencilAttachment);var o=e.checkFramebufferStatus(_t);e.isContextLost()||36053===o||C.raise("framebuffer configuration not supported, status = "+St[o]),e.bindFramebuffer(_t,s.next?s.next.framebuffer:null),s.cur=s.next,e.getError()}function E(e,r){var o=new w;function u(e,t){var r;C(s.next!==o,"can not update framebuffer which is currently in use");var a=0,f=0,p=!0,v=!0,b=null,y=!0,w="rgba",k="uint8",E=1,D=null,A=null,M=null,R=!1;if("number"==typeof e)a=0|e,f=0|t||a;else if(e){C.type(e,"object","invalid arguments for framebuffer");var L=e;if("shape"in L){var T=L.shape;C(Array.isArray(T)&&T.length>=2,"invalid shape for framebuffer"),a=T[0],f=T[1]}else"radius"in L&&(a=f=L.radius),"width"in L&&(a=L.width),"height"in L&&(f=L.height);("color"in L||"colors"in L)&&(b=L.color||L.colors,Array.isArray(b)&&C(1===b.length||n.webgl_draw_buffers,"multiple render targets not supported")),b||("colorCount"in L&&(E=0|L.colorCount,C(E>0,"invalid color buffer count")),"colorTexture"in L&&(y=!!L.colorTexture,w="rgba4"),"colorType"in L&&(k=L.colorType,y?(C(n.oes_texture_float||!("float"===k||"float32"===k),"you must enable OES_texture_float in order to use floating point framebuffer objects"),C(n.oes_texture_half_float||!("half float"===k||"float16"===k),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):"half float"===k||"float16"===k?(C(n.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),w="rgba16f"):"float"!==k&&"float32"!==k||(C(n.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),w="rgba32f"),C.oneOf(k,h,"invalid color type")),"colorFormat"in L&&(w=L.colorFormat,l.indexOf(w)>=0?y=!0:c.indexOf(w)>=0?y=!1:C.optional((function(){y?C.oneOf(L.colorFormat,l,"invalid color format for texture"):C.oneOf(L.colorFormat,c,"invalid color format for renderbuffer")})))),("depthTexture"in L||"depthStencilTexture"in L)&&(R=!(!L.depthTexture&&!L.depthStencilTexture),C(!R||n.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in L&&("boolean"==typeof L.depth?p=L.depth:(D=L.depth,v=!1)),"stencil"in L&&("boolean"==typeof L.stencil?v=L.stencil:(A=L.stencil,p=!1)),"depthStencil"in L&&("boolean"==typeof L.depthStencil?p=v=L.depthStencil:(M=L.depthStencil,p=!1,v=!1))}else a=f=1;var P=null,z=null,I=null,O=null;if(Array.isArray(b))P=b.map(g);else if(b)P=[g(b)];else for(P=new Array(E),r=0;r<E;++r)P[r]=m(a,f,y,w,k);C(n.webgl_draw_buffers||P.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),C(P.length<=i.maxColorAttachments,"too many color attachments, not supported"),a=a||P[0].width,f=f||P[0].height,D?z=g(D):p&&!v&&(z=m(a,f,R,"depth","uint32")),A?I=g(A):v&&!p&&(I=m(a,f,!1,"stencil","uint8")),M?O=g(M):!D&&!A&&v&&p&&(O=m(a,f,R,"depth stencil","depth stencil")),C(!!D+!!A+!!M<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var F=null;for(r=0;r<P.length;++r)if(d(P[r],a,f),C(!P[r]||P[r].texture&&wt.indexOf(P[r].texture._texture.format)>=0||P[r].renderbuffer&&kt.indexOf(P[r].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+r+" is invalid"),P[r]&&P[r].texture){var B=xt[P[r].texture._texture.format]*Ct[P[r].texture._texture.type];null===F?F=B:C(F===B,"all color attachments much have the same number of bits per pixel.")}return d(z,a,f),C(!z||z.texture&&6402===z.texture._texture.format||z.renderbuffer&&33189===z.renderbuffer._renderbuffer.format,"invalid depth attachment for framebuffer object"),d(I,a,f),C(!I||I.renderbuffer&&36168===I.renderbuffer._renderbuffer.format,"invalid stencil attachment for framebuffer object"),d(O,a,f),C(!O||O.texture&&34041===O.texture._texture.format||O.renderbuffer&&34041===O.renderbuffer._renderbuffer.format,"invalid depth-stencil attachment for framebuffer object"),x(o),o.width=a,o.height=f,o.colorAttachments=P,o.depthAttachment=z,o.stencilAttachment=I,o.depthStencilAttachment=O,u.color=P.map(_),u.depth=_(z),u.stencil=_(I),u.depthStencil=_(O),u.width=o.width,u.height=o.height,S(o),u}return a.framebufferCount++,u(e,r),t(u,{resize:function(e,t){C(s.next!==o,"can not resize a framebuffer which is currently in use");var n=Math.max(0|e,1),i=Math.max(0|t||n,1);if(n===o.width&&i===o.height)return u;for(var r=o.colorAttachments,a=0;a<r.length;++a)v(r[a],n,i);return v(o.depthAttachment,n,i),v(o.stencilAttachment,n,i),v(o.depthStencilAttachment,n,i),o.width=u.width=n,o.height=u.height=i,S(o),u},_reglType:"framebuffer",_framebuffer:o,destroy:function(){k(o),x(o)},use:function(e){s.setFBO({framebuffer:u},e)}})}return t(s,{getFramebuffer:function(e){if("function"==typeof e&&"framebuffer"===e._reglType){var t=e._framebuffer;if(t instanceof w)return t}return null},create:E,createCube:function(e){var o=Array(6);function a(e){var i;C(o.indexOf(s.next)<0,"can not update framebuffer which is currently in use");var c,u={color:null},f=0,d=null,p="rgba",g="uint8",m=1;if("number"==typeof e)f=0|e;else if(e){C.type(e,"object","invalid arguments for framebuffer");var _=e;if("shape"in _){var v=_.shape;C(Array.isArray(v)&&v.length>=2,"invalid shape for framebuffer"),C(v[0]===v[1],"cube framebuffer must be square"),f=v[0]}else"radius"in _&&(f=0|_.radius),"width"in _?(f=0|_.width,"height"in _&&C(_.height===f,"must be square")):"height"in _&&(f=0|_.height);("color"in _||"colors"in _)&&(d=_.color||_.colors,Array.isArray(d)&&C(1===d.length||n.webgl_draw_buffers,"multiple render targets not supported")),d||("colorCount"in _&&(m=0|_.colorCount,C(m>0,"invalid color buffer count")),"colorType"in _&&(C.oneOf(_.colorType,h,"invalid color type"),g=_.colorType),"colorFormat"in _&&(p=_.colorFormat,C.oneOf(_.colorFormat,l,"invalid color format for texture"))),"depth"in _&&(u.depth=_.depth),"stencil"in _&&(u.stencil=_.stencil),"depthStencil"in _&&(u.depthStencil=_.depthStencil)}else f=1;if(d)if(Array.isArray(d))for(c=[],i=0;i<d.length;++i)c[i]=d[i];else c=[d];else{c=Array(m);var b={radius:f,format:p,type:g};for(i=0;i<m;++i)c[i]=r.createCube(b)}for(u.color=Array(c.length),i=0;i<c.length;++i){var y=c[i];C("function"==typeof y&&"textureCube"===y._reglType,"invalid cube map"),f=f||y.width,C(y.width===f&&y.height===f,"invalid cube map shape"),u.color[i]={target:yt,data:c[i]}}for(i=0;i<6;++i){for(var w=0;w<c.length;++w)u.color[w].target=yt+i;i>0&&(u.depth=o[0].depth,u.stencil=o[0].stencil,u.depthStencil=o[0].depthStencil),o[i]?o[i](u):o[i]=E(u)}return t(a,{width:f,height:f,color:c})}return a(e),t(a,{faces:o,resize:function(e){var t,n=0|e;if(C(n>0&&n<=i.maxCubeMapSize,"invalid radius for cube fbo"),n===a.width)return a;var r=a.color;for(t=0;t<r.length;++t)r[t].resize(n);for(t=0;t<6;++t)o[t].resize(n);return a.width=a.height=n,a},_reglType:"framebufferCube",destroy:function(){o.forEach((function(e){e.destroy()}))}})},clear:function(){W(y).forEach(k)},restore:function(){s.cur=null,s.next=null,s.dirty=!0,W(y).forEach((function(t){t.framebuffer=e.createFramebuffer(),S(t)}))}})}(r,f,b,S,E,u),A=li(r,h,f,b,y,w,0,D,{},x,k,v,_,d,i),T=Lt(r,D,A.procs.poll,_,o,f,b),P=A.next,I=r.canvas,O=[],F=[],q=[],V=[i.onDestroy],K=null;function G(){if(0===O.length)return d&&d.update(),void(K=null);K=R.next(G),be();for(var e=O.length-1;e>=0;--e){var t=O[e];t&&t(_,null,0)}r.flush(),d&&d.update()}function he(){!K&&O.length>0&&(K=R.next(G))}function ue(){K&&(R.cancel(G),K=null)}function fe(e){e.preventDefault(),a=!0,ue(),F.forEach((function(e){e()}))}function de(e){r.getError(),a=!1,s.restore(),k.restore(),y.restore(),S.restore(),E.restore(),D.restore(),x.restore(),d&&d.restore(),A.procs.refresh(),he(),q.forEach((function(e){e()}))}function pe(e){function n(e,t){var n={},i={};return Object.keys(e).forEach((function(r){var o=e[r];if(M.isDynamic(o))i[r]=M.unbox(o,r);else{if(t&&Array.isArray(o))for(var a=0;a<o.length;++a)if(M.isDynamic(o[a]))return void(i[r]=M.unbox(o,r));n[r]=o}})),{dynamic:i,static:n}}C(!!e,"invalid args to regl({...})"),C.type(e,"object","invalid args to regl({...})");var i=n(e.context||{},!0),r=n(e.uniforms||{},!0),o=n(e.attributes||{},!1),s=n(function(e){var n=t({},e);function i(e){if(e in n){var t=n[e];delete n[e],Object.keys(t).forEach((function(i){n[e+"."+i]=t[i]}))}}return delete n.uniforms,delete n.attributes,delete n.context,delete n.vao,"stencil"in n&&n.stencil.op&&(n.stencil.opBack=n.stencil.opFront=n.stencil.op,delete n.stencil.op),i("blend"),i("depth"),i("cull"),i("stencil"),i("polygonOffset"),i("scissor"),i("sample"),"vao"in e&&(n.vao=e.vao),n}(e),!1),l={gpuTime:0,cpuTime:0,count:0},c=A.compile(s,o,r,i,l),h=c.draw,u=c.batch,f=c.scope,d=[];return t((function(e,t){var n;if(a&&C.raise("context lost"),"function"==typeof e)return f.call(this,null,e,0);if("function"==typeof t)if("number"==typeof e)for(n=0;n<e;++n)f.call(this,null,t,n);else{if(!Array.isArray(e))return f.call(this,e,t,0);for(n=0;n<e.length;++n)f.call(this,e[n],t,n)}else if("number"==typeof e){if(e>0)return u.call(this,function(e){for(;d.length<e;)d.push(null);return d}(0|e),0|e)}else{if(!Array.isArray(e))return h.call(this,e);if(e.length)return u.call(this,e,e.length)}}),{stats:l,destroy:function(){c.destroy()}})}I&&(I.addEventListener(hi,fe,!1),I.addEventListener(ui,de,!1));var ge=D.setFBO=pe({framebuffer:M.define.call(null,1,"framebuffer")});function me(e,t){var n=0;A.procs.poll();var i=t.color;i&&(r.clearColor(+i[0]||0,+i[1]||0,+i[2]||0,+i[3]||0),n|=16384),"depth"in t&&(r.clearDepth(+t.depth),n|=256),"stencil"in t&&(r.clearStencil(0|t.stencil),n|=1024),C(!!n,"called regl.clear with no buffer specified"),r.clear(n)}function _e(e){return C.type(e,"function","regl.frame() callback must be a function"),O.push(e),he(),{cancel:function(){var t=fi(O,e);C(t>=0,"cannot cancel a frame twice"),O[t]=function e(){var t=fi(O,e);O[t]=O[O.length-1],O.length-=1,O.length<=0&&ue()}}}}function ve(){var e=P.viewport,t=P.scissor_box;e[0]=e[1]=t[0]=t[1]=0,_.viewportWidth=_.framebufferWidth=_.drawingBufferWidth=e[2]=t[2]=r.drawingBufferWidth,_.viewportHeight=_.framebufferHeight=_.drawingBufferHeight=e[3]=t[3]=r.drawingBufferHeight}function be(){_.tick+=1,_.time=we(),ve(),A.procs.poll()}function ye(){S.refresh(),ve(),A.procs.refresh(),d&&d.update()}function we(){return(L()-p)/1e3}ye();var xe=t(pe,{clear:function(e){if(C("object"==typeof e&&e,"regl.clear() takes an object as input"),"framebuffer"in e)if(e.framebuffer&&"framebufferCube"===e.framebuffer_reglType)for(var n=0;n<6;++n)ge(t({framebuffer:e.framebuffer.faces[n]},e),me);else ge(e,me);else me(0,e)},prop:M.define.bind(null,1),context:M.define.bind(null,2),this:M.define.bind(null,3),draw:pe({}),buffer:function(e){return y.create(e,34962,!1,!1)},elements:function(e){return w.create(e,!1)},texture:S.create2D,cube:S.createCube,renderbuffer:E.create,framebuffer:D.create,framebufferCube:D.createCube,vao:x.createVAO,attributes:o,frame:_e,on:function(e,t){var n;switch(C.type(t,"function","listener callback must be a function"),e){case"frame":return _e(t);case"lost":n=F;break;case"restore":n=q;break;case"destroy":n=V;break;default:C.raise("invalid event, must be one of frame,lost,restore,destroy")}return n.push(t),{cancel:function(){for(var e=0;e<n.length;++e)if(n[e]===t)return n[e]=n[n.length-1],void n.pop()}}},limits:b,hasExtension:function(e){return b.extensions.indexOf(e.toLowerCase())>=0},read:T,destroy:function(){O.length=0,ue(),I&&(I.removeEventListener(hi,fe),I.removeEventListener(ui,de)),k.clear(),D.clear(),E.clear(),x.clear(),S.clear(),w.clear(),y.clear(),d&&d.clear(),V.forEach((function(e){e()}))},_gl:r,_refresh:ye,poll:function(){be(),d&&d.update()},now:we,stats:u});return i.onDone(null,xe),xe}}()},3379:e=>{"use strict";var t=[];function n(e){for(var n=-1,i=0;i<t.length;i++)if(t[i].identifier===e){n=i;break}return n}function i(e,i){for(var o={},a=[],s=0;s<e.length;s++){var l=e[s],c=i.base?l[0]+i.base:l[0],h=o[c]||0,u="".concat(c," ").concat(h);o[c]=h+1;var f=n(u),d={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==f)t[f].references++,t[f].updater(d);else{var p=r(d,i);i.byIndex=s,t.splice(s,0,{identifier:u,updater:p,references:1})}a.push(u)}return a}function r(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,r){var o=i(e=e||[],r=r||{});return function(e){e=e||[];for(var a=0;a<o.length;a++){var s=n(o[a]);t[s].references--}for(var l=i(e,r),c=0;c<o.length;c++){var h=n(o[c]);0===t[h].references&&(t[h].updater(),t.splice(h,1))}o=l}}},569:e=>{"use strict";var t={};e.exports=function(e,n){var i=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(n)}},9216:e=>{"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},3565:(e,t,n)=>{"use strict";e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},7795:e=>{"use strict";e.exports=function(e){var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var i="";n.supports&&(i+="@supports (".concat(n.supports,") {")),n.media&&(i+="@media ".concat(n.media," {"));var r=void 0!==n.layer;r&&(i+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),i+=n.css,r&&(i+="}"),n.media&&(i+="}"),n.supports&&(i+="}");var o=n.sourceMap;o&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),t.styleTagTransform(i,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},4589:e=>{"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},4677:(e,t,n)=>{"use strict";n.d(t,{fc:()=>y,ZP:()=>C,HT:()=>w,$W:()=>b});var i=n(8970);class r extends i.Z{constructor(e){super(e),this.worker=new Worker(new URL(n.p+n.u(661),n.b))}filterCategories(e,t){const n=e,i=this.parent,r=i.columnIndex[t[0]],o=r.data,a=i.filterArray,s=this.filterArray,l=r.values,c=new Set,h=this.parent.size;if("string"==typeof n){const e=l.indexOf(n);if("multitext"===r.datatype){const t=r.stringLength;for(let n=0;n<h;n++){const r=n*t;let l=!1;for(let n=r;n<r+t;n++)if(o[n]===e){l=!0;break}l?(1===s[n]&&0==--a[n]&&i.filterSize++,s[n]=0):(0===s[n]&&1==++a[n]&&i.filterSize--,s[n]=1)}}else for(let t=0;t<h;t++)o[t]===e?(1===s[t]&&0==--a[t]&&i.filterSize++,s[t]=0):(0===s[t]&&1==++a[t]&&i.filterSize--,s[t]=1)}else{for(let e of n)c.add(l.indexOf(e));if("multitext"===r.datatype){const e=r.stringLength;let t="and"===n.operand;for(let r=0;r<h;r++){const l=r*e;let h=!1,u=0;for(let i=l;i<l+e&&65535!==o[i];i++)if(c.has(o[i])){if(!t){h=!0;break}if(u++,u===n.length){h=!0;break}}h?(1===s[r]&&0==--a[r]&&i.filterSize++,s[r]=0):(0===s[r]&&1==++a[r]&&i.filterSize--,s[r]=1)}}else for(let e=0;e<h;e++)c.has(o[e])?(1===s[e]&&0==--a[e]&&i.filterSize++,s[e]=0):(0===s[e]&&1==++a[e]&&i.filterSize--,s[e]=1)}}filterMultipleCategories(e,t){const n=this.parent,i=[],r=[];for(let o=0;o<t.length;o++){const a=n.columnIndex[t[o]];i.push(a.data),r.push(a.values.indexOf(e[o]))}const o=n.filterArray,a=this.filterArray,s=n.size;for(let e=0;e<s;e++){let t=!0;for(let n=0;n<i.length;n++)if(i[n][e]!==r[n]){t=!1;break}t?(1===a[e]&&0==--o[e]&&n.filterSize++,a[e]=0):(0===a[e]&&1==++o[e]&&n.filterSize--,a[e]=1)}}getSankeyData(e,t,n={}){const i=this.parent.columnIndex[t[0]],r=this.parent.columnIndex[t[1]];n.values=i.values,n.values2=r.values,n.method=n.method||"sankey","proportion"===n.method&&(n.cats=null==n.category?null:this.parent.columnIndex[t[2]].buffer);const o=performance.now(),a=t=>{console.log(`calc sankey ${i.name} ${r.name} : ${performance.now()-o}`),e(t.data),this.worker.removeEventListener("message",a)};this.worker.addEventListener("message",a),this.worker.postMessage([this.filterBuffer,this.parent.filterBuffer,i.buffer,n,r.buffer])}getCategories(e,t,n={}){const i=this.parent.columnIndex[t];n.values=i.values,n.datatype=i.datatype,n.stringLength=i.stringLength,performance.now();const r=t=>{e(t.data),this.worker.removeEventListener("message",r)};this.worker.addEventListener("message",r),this.worker.postMessage([this.filterBuffer,this.parent.filterBuffer,i.buffer,n])}destroy(){super.destroy(),this.worker.terminate()}}i.Z.types.category_dimension=r;var o=n(3117);class a extends i.Z{constructor(e){super(e),this.worker=new Worker(new URL(n.p+n.u(720),n.b))}getAverages(e,t,n={}){n.method=n.method||"mean";const i=performance.now(),r=this.parent.columnIndex;this.worker.onmessage=t=>{console.log("calc averages  "+(performance.now()-i)),e(t.data)},n.values=r[t[0]].values;const o=[];for(let e=1;e<t.length;e++)o.push([r[t[e]].buffer,r[t[e]].datatype]);this.worker.postMessage([this.filterBuffer,this.parent.filterBuffer,r[t[0]].buffer,o,n])}destroy(){super.destroy(),this.worker.terminate()}}i.Z.types.catcol_dimension=a;class s extends o.Z{constructor(e,t){super(e,t),this.worker.terminate(),this.worker=new Worker(new URL(n.p+n.u(657),n.b))}getKernalDensity(e,t,n={}){const i=performance.now(),r=this.parent.columnIndex[t[0]],o=this.parent.columnIndex[t[1]];this.parent.getMinMaxForColumn(t[1]),n.type="kernal_density",n.scaletrim&&(n.scaletrim=o.quantiles[n.scaletrim]),n.values=r.values,this.worker.onmessage=t=>{console.log(`calculate violin ${r.name} : ${performance.now()-i}`),e(t.data)},this.worker.postMessage([this.filterBuffer,this.parent.filterBuffer,r.buffer,[o.buffer,o.datatype],n])}getMultiBoxPlotData(e,t,n={}){const i=this.parent.columnIndex,r=performance.now(),o=t.map((e=>[i[e].buffer,c.Index[e].datatype]));n.analysis="multi",n.cat=this.parent.getColumnValues(t[0]).indexOf(n.category),this.worker.onmessage=n=>{console.log(`calculate multiboxplot cols:${t.length} time: ${performance.now()-r}`),e(n.data)},this.worker.postMessage([this.filterBuffer,this.parent.filterBuffer,o.slice(1),o[0],n])}getBoxPlotData(e,t,n={}){const i=performance.now(),r=this.parent.columnIndex[t[0]],o=this.parent.columnIndex[t[1]];n.analysis="boxplot",n.values=r.values,this.worker.onmessage=t=>{console.log(`calculate boxplot ${r.name} : ${performance.now()-i}`),e(t.data)},this.worker.postMessage([this.filterBuffer,this.parent.filterBuffer,r.buffer,[o.buffer,o.datatype],n])}}i.Z.types.catrange_dimension=s,n(8796);var l=n(1031),h=n(1102),u=n(4182);function f(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function d(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function p(e){var t=1,n=e(f(t),d(t));return n.constant=function(n){return arguments.length?e(f(t=+n),d(t)):t},(0,l.Q)(n)}function g(){var e=p((0,h.l4)());return e.copy=function(){return(0,h.JG)(e,g()).constant(e.constant())},u.o.apply(e,arguments)}var m=n(7636),_=n(2921);function v(e,t,n=_.Z){if(i=e.length){if((t=+t)<=0||i<2)return+n(e[0],0,e);if(t>=1)return+n(e[i-1],i-1,e);var i,r=(i-1)*t,o=Math.floor(r),a=+n(e[o],o,e);return a+(+n(e[o+1],o+1,e)-a)*(r-o)}}function b(e){e=e.replace("#","");var t=parseInt(e,16);return[t>>16&255,t>>8&255,255&t]}function y(e){return"#"+e.map((e=>{const t=e.toString(16);return 1===t.length?"0"+t:t})).join("")}const w=["#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999","#1CE6FF","#FF34FF","#FF4A46","#008941","#676FA6","#A30059","#FFDBE5","#7A4900","#0000A6","#63FFAC","#B79762","#004D43","#8FB0FF","#997D87","#5A0007","#809693","#FEFFE6","#1B4400","#4FC601","#3B5DFF","#4A3B53","#FF2F80","#61615A","#BA0900","#6B7900","#00C2A0","#FFAA92","#FF90C9","#B903AA","#D16100","#DDEFFF","#000035","#7B4F4B","#A1C299","#300018","#0AA6D8","#013349","#00846F","#372101","#FFB500","#C2FFED","#A079BF","#CC0744","#C0B9B2","#C2FF99","#001E09","#00489C","#6F0062","#0CBD66","#EEC3FF","#456D75","#B77B68","#7A87A1","#788D66","#885578","#FAD09F","#FF8A9A","#D157A0","#BEC459","#456648","#0086ED","#886F4C","#34362D","#B4A8BD","#00A6AA","#452C2C","#636375","#A3C8C9","#FF913F","#938A81","#575329","#00FECF","#B05B6F","#8CD0FF","#3B9700","#04F757","#C8A1A1","#1E6E00","#7900D7","#A77500","#6367A9","#A05837","#6B002C","#772600","#D790FF","#9B9700","#549E79","#FFF69F","#201625","#72418F","#BC23FF","#99ADC0","#3A2465","#922329","#5B4534","#FDE8DC"],x=["#3288bd","#66c2a5","#abdda4","#e6f598","#fee08b","#fdae61","#f46d43","#d53e4f"],C=class{constructor(e,t={}){if(this.size=e,this.filterSize=e,this.columns=[],this.columnIndex={},this.listeners={},this.indexes={},this.filterBuffer=new SharedArrayBuffer(e),this.filterArray=new Uint8Array(this.filterBuffer),this.dimensions=[],this.name=t.name,this.textDecoder=new TextDecoder,this.columnGroups={},this.subtypeToGroup={},this.subgroups={},this.subgroupDataSources=new Set,this.accessOtherDataStore=[],this.syncColumnColors=[],this.linkColumns=[],this.columnsWithData=[],this.dirtyColumns={added:{},removed:{},data_changed:{},colors_changed:{}},this.dirtyMetadata=new Set,t.offsets&&(t.offsets.values=t.offsets.values||{},this.offsets=t.offsets),this.images=t.images,this.genome_browser=t.genome_browser,t.columns)for(let e of t.columns)this.addColumn(e,e.data);if(t.columnGroups)for(let e of t.columnGroups)this.addColumnGroup(e);if(t.large_images&&(this.large_images=t.large_images),t.links){this.links=t.links;for(let e in t.links){const n=t.links[e];if(n.rows_as_columns){const t=n.rows_as_columns.subgroups;this.subgroupDataSources.add(e);for(let i in t)this.subgroups[i]={subgroup:t[i],dataSource:e,name_column:n.rows_as_columns.name_column}}n.access_data&&this.accessOtherDataStore.push({dataSource:e,index:n.index}),n.sync_column_colors&&this.syncColumnColors.push({dataSource:e,columns:n.sync_column_colors}),n.columns&&this.linkColumns.push({dataSource:e,columns:n.columns})}}}isFiltered(){return this.filterSize!==this.size}addListener(e,t){this.listeners[e]=t}removeListener(e){delete this.listeners[e]}_callListeners(e,t){for(let n in this.listeners)this.listeners[n](e,t)}removeAllFilters(){this.filterArray.fill(0);let e=[];for(let t of this.dimensions)if(t.noclear)e.push(t);else if(t.filterArray.fill(0),t.filterMethod=null,t.bgfArray)for(let e=0;e<this.size;e++)0===t.bgfArray[e]&&(t.filterArray[e]=2);this.filterSize=this.size;for(let t of e){const e=t.filterArray;for(let t=0;t<e.length;t++)1===e[t]&&1==++this.filterArray[t]&&this.filterSize--}this._callListeners("filtered","all_removed")}dataChanged(e,t=!0){let n=!1;for(let t of this.dimensions)t.reFilterOnDataChanged(e)&&(n=!0);if(t)for(let t of e)this.setColumnIsDirty(t);n&&this._callListeners("filtered"),this._callListeners("data_changed",{columns:e,hasFiltered:n})}dataHighlighted(e,t){this.highightedData=e,this._callListeners("data_highlighted",{indexes:e,source:t})}getHighlightedData(){return this.highightedData}triggerFilter(){this._callListeners("filtered")}setColumnIsDirty(e){this.dirtyColumns.added[e]||(this.dirtyColumns.data_changed[e]=!0)}setAllColumnsClean(){this.dirtyColumns.added={},this.dirtyColumns.removed={},this.dirtyColumns.data_changed={},this.dirtyColumns.colors_changed={},this.dirtyMetadata.clear()}getFilter(){return this.filterArray}isRowFiltered(e){return 0===this.filterArray[e]}_calculateCategories(e){let t=e.values,n=e.data,i={};for(let e of t)i[e]=0;for(let e=0;e<n.length;e++)i[t[n[e]]]++}addColumn(e,t=null,n=!1){let i={name:e.name,field:e.field,datatype:e.datatype};i.field||(i.field=e.name),e.colors&&(i.colors=e.colors),e.editable&&(i.editable=!0),e.is_url&&(i.is_url=!0),e.subgroup&&(i.subgroup=e.subgroup,i.sgindex=e.sgindex,i.sgtype=e.sgtype),"text"===e.datatype||"multitext"===e.datatype?(i.stringLength=e.stringLength,i.values=e.values||[`Error: no values for '${i.name}'`]):"double"===e.datatype||"integer"===e.datatype||"int32"===e.datatype?(i.colorLogScale=e.colorLogScale,i.minMax=e.minMax,i.quantiles=e.quantiles):i.stringLength=e.stringLength,this.columns.push(i),this.columnIndex[i.field]=i,t&&this.setColumnData(e.field,t),n&&(this.dirtyColumns.added[e.field]=!0)}getSuggestedValues(e,t,n=10){const i=this.columnIndex[t],r=e.toLowerCase(),o=e.toUpperCase(),a=[];if("unique"===i.datatype){const t=new TextEncoder,s=t.encode(r),l=t.encode(o),c=e.length,h=i.data,u=i.stringLength;for(let e=0;e<h.length-c;e++){let t=!0;for(let n=0;n<c;n++)if(s[n]!=h[e+n]&&l[n]!=h[e+n]){t=!1;break}if(t){const t=Math.floor(e/u),r=this.textDecoder.decode(i.data.slice(t*u,t*u+u)).replaceAll("\0","");if(a.push({value:r,index:t}),a.length>n)break}}}else if("text"===i.datatype||"multitext"===i.datatype){const t=e.length;for(let e=0;e<i.values.length;e++){const s=i.values[e];let l=!0;for(let e=0;e<s.length-t;e++){l=!0;for(let n=0;n<t;n++){if(s[n+e]!==r[n]&&s[n+e]!==o[n]){l=!1;break}console.log("match")}if(l)break;console.log(e)}if(l&&(a.push({value:s,index:e}),a.length>n))break}}return a}addColumnFromField(e){const t=e.split("|");let n=this.subtypeToGroup[t[0]],i=null;n?i=n.subgroups[t[0]]:(n=this.subgroups[t[0]],i=n.subgroup),this.columnIndex[e]||this.addColumn({name:t[1],field:e,datatype:"double",subgroup:i.name,sgindex:t[2],sgtype:i.type})}getColumnList(e=null,t=!1){const n=[],i={},r=Object.keys(this.subgroups).map((e=>(i[e]=[],e))),o=Array.isArray(e),a=0!==r.length;for(let t in this.columnIndex){const s=this.columnIndex[t];if(e)if(o){if(-1===e.indexOf(s.datatype))continue}else if("number"===e){if("text"===s.datatype||"unique"===s.datatype||"multitext"===s.datatype)continue}else if("all"!==e&&e!==s.datatype)continue;if(a){let e=!1;for(let t of r)if(s.field.startsWith(`${t}|`)){const n=this.subgroups[t];i[t].push({name:s.name,field:s.field,datatype:s.datatype,subgroup:{dataSource:n.dataSource,name_column:n.name_column}}),e=!0;break}if(e)continue}n.push({name:s.name,field:s.field,datatype:s.datatype})}let s=n.sort(((e,t)=>e.name.localeCompare(t.name)));if(a)for(let e in i)i[e].sort(((e,t)=>e.name.localeCompare(t.name))),s=s.concat(i[e]);return t&&s.push({name:"None",field:"__none__"}),s}getDimension(e){if(!i.Z.types[e])throw`Adding non existent Dimension: ${e}`;const t=new i.Z.types[e](this);return this.dimensions.push(t),t}getRowAsObject(e,t){t||(t=this.columnsWithData);const n={};for(let i of t){const t=this.columnIndex[i];let r=t.data[e];if("text"===t.datatype)r=t.values[r];else if("double"===t.datatype||"integer"===t.datatype||"int32"===t.datatype)isNaN(r)&&(r="missing");else if("multitext"==t.datatype){const n=t.data.slice(e*t.stringLength,e*t.stringLength+t.stringLength);r=Array.from(n.filter((e=>65535!=e))).map((e=>t.values[e])).join(", ")}else r=this.textDecoder.decode(t.data.slice(e*t.stringLength,e*t.stringLength+t.stringLength)),r=r.replaceAll("\0","");n[i]=r}return n.__index__=e,n}getFirstFilteredIndex(){for(let e=0;e<this.size;e++)if(0===this.filterArray[e])return e}getFilteredValues(e){const t=new Array(this.filterSize);let n=0;for(let i=0;i<this.size;i++)0===this.filterArray[i]&&(t[n]=this.getRowText(i,e),n++);return t}getRowText(e,t){return this.getRowAsObject(e,[t])[t]}setColumnOffset(e,t){if(!this.offsets)throw new Error("Attempting to set offsets but none are specified in config");e.filter=e.filter||"all";const n=this.offsets.values;let i=n[e.filter];i||(i={},n[e.filter]=i);let r=i[e.group];r||(r={offsets:[0,0],rotation:0},i[e.group]=r),this.updateColumnOffsets(e,e.rotation,t),this.dirtyMetadata.add("offsets")}_getRotationOrigin(e,t,n){const i=this.offsets,r=this.columnIndex[e],o=r.values.indexOf(t),a=r.data,s=this.columnIndex[i.param[0]],l=this.columnIndex[i.param[1]];let c=null,h=null;i.background_filter&&(h=this.columnIndex[i.background_filter],c=h.values.indexOf(n));let u=[Number.MAX_VALUE,Number.MIN_VALUE],f=[Number.MAX_VALUE,Number.MIN_VALUE];for(let e=0;e<this.size;e++)h&&h.data[e]!==c||a[e]===o&&(u[0]=Math.min(u[0],s.originalData[e]),u[1]=Math.max(u[1],s.originalData[e]),f[0]=Math.min(f[0],l.originalData[e]),f[1]=Math.max(f[1],l.originalData[e]));const d=e=>e[0]+(e[1]-e[0])/2;return[d(u),d(f)]}initiateOffsets(){const e=this.offsets,t=this.columnIndex[e.param[0]],n=this.columnIndex[e.param[1]];t.originalData=new Float32Array(t.data),n.originalData=new Float32Array(n.data)}_getOffsetValues(e,t){const n=this.offsets;let i=null,r=null;if(n.background_filter){const e=this.columnIndex[n.background_filter];i=e.data,r=e.values}const o=this.columnIndex[n.groups],a=[];for(let s in n.values)if(!e||s===e.filter)for(let l in n.values[s]){if(e&&l!==e.group)continue;let c=n.values[s][l];const h={index:o.values.indexOf(l)};if("all"!==s&&(h.filterData=i,h.filterValue=r.indexOf(s)),t&&(c.rotation_center||(c.rotation_center=this._getRotationOrigin(n.groups,l,s)),h.rotation_center=[c.rotation_center[0]+c.offsets[0],c.rotation_center[1]+c.offsets[1]]),e?t?(h.rotation=e.rotation,c.rotation+=e.rotation):(c.offsets[0]+=e.offsets[0],c.offsets[1]+=e.offsets[1],h.offsets=e.offsets):t?h.rotation=c.rotation:h.offsets=c.offsets,t){const e=Math.PI/180*h.rotation;h.cos=Math.cos(e),h.sin=Math.sin(e)}a.push(h)}return a}resetColumnOffsets(e,t,n){e=e||"all";const i=this.offsets;if(!i)throw new Error("Attempting to reset offsets but none are specified in config");delete this.offsets.values[e][t];let r=null,o=null;"all"!==e&&(r=this.columnIndex[this.offsets.background_filter],o=r.values.indexOf(e));const a=this.getColumnValues(i.groups).indexOf(t),s=this.columnIndex[i.groups].data,l=this.columnIndex[i.param[0]],c=this.columnIndex[i.param[1]];for(let e=0;e<this.size;e++)r&&r[e]!==o||s[e]===a&&(c.data[e]=c.originalData[e],l.data[e]=l.originalData[e]);n&&this.dataChanged([i.param[0],i.param[1]],!1),this.dirtyMetadata.add("offsets")}updateColumnOffsets(e,t=!1,n=!1){const i=this.offsets,r=this.columnIndex[i.groups].data,o=this.columnIndex[i.param[0]],a=this.columnIndex[i.param[1]],s=this._getOffsetValues(e,t);for(let e=0;e<this.size;e++)for(let n of s)if((!n.filterData||n.filterData[e]===n.filterValue)&&r[e]===n.index)if(t){let t=n.rotation_center[0],i=n.rotation_center[1],r=n.cos*(o.data[e]-t)+n.sin*(a.data[e]-i)+t,s=n.cos*(a.data[e]-i)-n.sin*(o.data[e]-t)+i;o.data[e]=r,a.data[e]=s}else o.data[e]=o.data[e]+n.offsets[0],a.data[e]=a.data[e]+n.offsets[1];n&&this.dataChanged([i.param[0],i.param[1]],!1)}getColumnIndex(e){if(this.indexes[e])return this.indexes[e];const t=this.columnIndex[e],n={};if("unique"===t.datatype)for(let e=0;e<this.size;e++){let i=this.textDecoder.decode(t.data.slice(e*t.stringLength,e*t.stringLength+t.stringLength)).replaceAll("\0","");i.includes("#")&&(i=i.split("#")[1]),n[i]=e}else for(let e=0;e<this.size;e++)n[t.values[t.data[e]]]=e;return this.indexes[e]=n,n}getDataAsBlob(e,t="all",n="\t",i="\n"){let r=null;"string"!=typeof t&&(r=t);const o=[],a=[],s=["index"].concat(e);for(let t of e){const e=this.columnIndex[t];a.push(e),s.push(e.name)}const l=r?r.length:this.size;o.push(s.join(n));for(let i=0;i<l;i++){let a=i;if(r)a=r[i];else if("filtered"===t&&1===this.filterArray[i])continue;const s=this.getRowAsObject(a,e),l=[i].concat(e.map((e=>s[e])));o.push(l.join(n))}return new Blob([o.join(i)],{type:"text/plain"})}setColumnData(e,t){let n=this.columnIndex[e];if(!n)throw`column ${e} is not present in data store`;let i=null;if(i=Array.isArray(t)?this._convertColumn(n,t):t,n.buffer=i,"integer"===n.datatype||"double"==n.datatype||"int32"===n.datatype){const e=n.data="int32"===n.datatype?new Int32Array(i):new Float32Array(i);if(!n.minMax){let t=Number.MAX_VALUE,i=Number.MIN_VALUE;for(let n=0;n<e.length;n++){let r=e[n];isNaN(r)||(t=r<t?r:t,i=r>i?r:i)}n.minMax=[t,i]}if(!n.quantiles){const e=n.data.filter((e=>!isNaN(e))).sort();n.quantiles={};for(let t of[.05,.01,.001])n.quantiles[t]=[v(e,t),v(e,1-t)]}}else"multitext"===n.datatype?n.data=new Uint16Array(i):n.data=new Uint8Array(i);this.columnsWithData.push(e)}appendColumnData(e,t,n){let i=this.columnIndex[e],r=Uint8Array,o=n;"integer"===i.datatype||"double"===i.datatype?(o*=4,r=Float32Array):"int32"===i.datatype?(o*=4,r=Int32Array):"unique"===i.datatype&&(o*=i.stringLength);let a=new SharedArrayBuffer(o),s=new r(a);s.set(i.data),s.set(new r(t),i.data.length),i.data=s,i.buffer=a}addDataToStore(e,t){const n=t+this.size;for(let t of e)this.appendColumnData(t.column,t.data,n);let i=new SharedArrayBuffer(n),r=new Uint8Array(i);r.set(this.filterArray),this.filterBuffer=i,this.filterArray=r,this.size=n,this.filterSize+=t;for(let e of this.dimensions)e.updateSize();this._callListeners("data_added",this.size)}cleanColumnData(e){const t={},n=this.columnIndex[e];for(let e in n.values)t[e]=0;for(let e=0;e<this.size;e++)t[n.data[e]]++;const i=[],r={};for(let e=0;e<n.values.length;e++)0!==t[e]&&(i.push(n.values[e]),r[e]=i.length-1);for(let e=0;e<this.size;e++)n.data[e]=r[n.data[e]];n.values=i,this.setColumnIsDirty(e),this.dataChanged([e])}_convertColumn(e,t){const n=t.length;if("text"===e.datatype){const i=new SharedArrayBuffer(this.size),r={};for(let e=0;e<n;e++){const n=t[e];void 0===r[n]?r[n]=1:r[n]++}const o=[];for(let e in r)o.push([e,r[e]]);e.values=[];const a={};o.sort(((e,t)=>t[1]-e[1]));for(let t=0;t<o.length;t++)e.values.push(o[t][0]),a[o[t][0]]=t;const s=new Uint8Array(i);for(let e=0;e<n;e++)s[e]=a[t[e]];return i}if("integer"===e.datatype||"double"===e.datatype||"int32"===e.datatype){const i=new SharedArrayBuffer(4*this.size),r="int32"===e.datatype?new Int32Array(i):new Float32Array(i);for(let e=0;e<n;e++)r[e]=t[e];return i}if("multitext"===e.datatype){let i=new Set,r=0;for(let e=0;e<n;e++){const n=t[e].split(",");r=Math.max(r,n.length),n.forEach((e=>i.add(e.trim())))}i.delete("");const o=new SharedArrayBuffer(this.size*r*2),a=new Uint16Array(o);a.fill(65535);const s=new Array(i.size),l={};let c=0;for(let e of i)l[e]=c,s[c]=e,c++;for(let e=0;e<n;e++){const n=e*r,i=t[e];if(""===i)continue;const o=i.split(",");o.sort();for(let e=0;e<o.length;e++)a[n+e]=l[o[e].trim()]}return e.values=s,e.stringLength=r,o}{let i=0;for(let e=0;e<n;e++)i=Math.max(i,t[e].length);e.stringLength=i;const r=new TextEncoder,o=new SharedArrayBuffer(this.size*i);for(let e=0;e<n;e++){const n=r.encode(t[e].substring(0,i));new Uint8Array(o,e*i,i).set(n,0)}return o}}getColorFunction(e,t={}){const n=this.columnIndex[e],i=n.data,r=t.overideValues||{};let o=this.getColumnColors(e,t);if("text"===n.datatype)return e=>o[i[e]];if("integer"===n.datatype||"double"===n.datatype||"int32"===n.datatype){const e=null==r.min?n.minMax[0]:r.min,a=null==r.max?n.minMax[1]:r.max,s=t.bins||100,l=(a-e)/s,c=t.asArray?[255,255,255]:"#ffffff";return t.useValue?t=>{if(isNaN(t))return c;let n=Math.floor((t-e)/l);return n<0?n=0:n>=o.length&&(n=o.length-1),o[n]}:t=>{const n=i[t];if(isNaN(n))return c;let r=Math.floor((n-e)/l);return r<0?r=0:r>=o.length&&(r=o.length-1),o[r]}}}getColorForCategory(e,t){const n=this.columnIndex[e].values.indexOf(t);return this.getColumnColors(e)[n]}getColorLegend(e,t={}){const n=this.getColumnColors(e,t),i=this.columnIndex[e],r=t.name||i.name;if("integer"===i.datatype||"double"===i.datatype||"int32"===i.datatype){let e=i.minMaX;if(t.overideValues){const n=t.overideValues;e=[null==n.min?i.minMax[0]:n.min,null==n.max?i.minMax[1]:n.max]}return(0,m.kE)(n,{range:e,label:r})}if("text"===i.datatype)return(0,m.Ee)(n,i.values,{label:r})}getValueToColor(e){const t={},n=this.getColumnColors(e),i=this.getColumnValues(e);for(let e=0;e<i.length;e++)t[i[e]]=n[e];return t}getColumnQuantile(e,t){const n=this.columnIndex[e];return t&&"none"!==t?n.quantiles&&"NA"!==n.quantiles?[n.quantiles[t][0],n.quantiles[t][1]]:void 0:n.minMax}setColumnColors(e,t,n=!1){const i=this.columnIndex[e];if(t.length!==i.values.length)throw new Error(`${e} being set with incorrect number of columns `);i.colors=t.slice(0),this.dirtyColumns.colors_changed[e]=!0,n&&this.dataChanged([e],!1)}getColumnColors(e,t={}){const n=this.columnIndex[e],i=t.asArray;if("double"===n.datatype||"integer"===n.datatype||"int32"===n.datatype){const e=t.overideValues||{},o=e.colors||n.colors||x,a=null==e.min?n.minMax[0]:e.min,s=null==e.max?n.minMax[1]:e.max,c=function(e,t,n){for(var i=[],r=(t-e)/(n-1),o=0;o<n-1;)i.push(e+o*r),o++;return i.push(t),i}(a,s,o.length),h=(0,l.Z)().domain(c).range(o).clamp(!0),u=t.bins||100,f=(s-a)/u;let d=new Array(u+1);for(let e=0;e<u+1;e++)d[e]=h(a+e*f),i&&(d[e]=(r=d[e])?(r=r.substring(4,r.length-1).split(", ")).map((e=>parseInt(e))):[255,255,255]);let p=n.colorLogScale;if(null!=e.colorLogScale&&(p=e.colorLogScale),p){const e=g().domain([a,s]).range([0,u]).clamp(!0),t=new Array(u+1);for(let n=0;n<u+1;n++)t[n]=d[Math.floor(e(a+n*f))];d=t}return d}var r;if("text"===n.datatype||"multitext"===n.datatype){let e=n.colors;if(!e){const t=n.values.length,i=w.length;if(t<i)e=w.slice(0,t);else{e=[];const n=Math.floor(t/i);for(let t=0;t<n;t++)e=e.concat(w);e=e.concat(w.slice(0,t%i))}}return i&&(e=e.map((e=>b(e)))),e}}addColumnGroup(e){e.columns||(e.columns=[]),this.columnGroups[e.name]=e}getColumnGroup(e){const t=this.columnGroups[e];return t?t.columns:null}getRawColumn(e){return this.columnIndex[e].data}getMinMaxForColumn(e){return this.columnIndex[e].minMax}getColumnRange(e){const t=this.columnIndex[e];return t.minMax?t.minMax[1]-t.minMax[0]:(console.error("unknown minMax for column "+e),[0,50])}getColumnInfo(e){const t=this.columnIndex[e];return{name:t.name,field:t.field,datatype:t.datatype,stringLength:t.stringLength,subgroup:t.subgroup,sgindex:t.sgindex,sgtype:t.sgtype}}getLoadedColumns(){return this.columns.filter((e=>null!=e.data)).map((e=>e.field))}getAllColumns(){return this.columns.map((e=>e.field))}getColumnValues(e){return this.columnIndex[e].values}getColumnName(e){const t=this.columnIndex[e];return t?t.name:null}removeColumn(e,t=!1,n=!1){const i=this.columnIndex[e];i.data=null,i.buffer=null,this.columns=this.columns.filter((t=>t.field!==e)),delete this.columnIndex[e];const r=this.columnsWithData.indexOf(e);-1!==r&&this.columnsWithData.splice(r,1),t&&(this.dirtyColumns.added[e]?delete this.dirtyColumns.added[e]:this.dirtyColumns.removed[e]=!0),n&&this._callListeners("column_removed",e)}}},8796:(e,t,n)=>{"use strict";var i=n(3117),r=n(8970);class o extends i.Z{constructor(e){super(e),this.worker.terminate(),this.worker=new Worker(new URL(n.p+n.u(545),n.b))}getDensityContours(e,t,n={}){const i=performance.now(),r=this.parent.columnIndex;this.worker.onmessage=t=>{console.log("calc density contours  "+(performance.now()-i)),e(t.data)},this.worker.postMessage([this.filterBuffer,this.parent.filterBuffer,[r[t[0]].buffer,r[t[0]].datatype],[r[t[1]].buffer,r[t[1]].datatype],r[t[2]].buffer,n])}}r.Z.types.density_dimension=o},8970:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});class i{constructor(e){this.filterBuffer=new SharedArrayBuffer(e.size),this.parent=e,this.filterArray=new Uint8Array(this.filterBuffer),this.filterArguments=null,this.filterIndexes=null,this.filterMethod=null}removeFilter(e=!0){if(!this.filterMethod)return;const t=this.parent.filterArray,n=this.filterArray,i=this.parent,r=this.parent.size;delete this.filterArguments,delete this.filterColumns,delete this.filterMethod;for(let e=0;e<r;e++)1===n[e]&&(0==--t[e]&&i.filterSize++,n[e]=0);if(this.bgfArray)for(let e=0;e<r;e++)0===this.bgfArray[e]&&(0==--t[e]&&i.filterSize++,n[e]=2);e&&this.parent._callListeners("filtered",this)}getLocalFilter(){return this.filterArray}filterOnIndex(e){const t=this.parent.filterArray,n=this.parent.size,i=this.filterArray,r=this.parent;for(let o=0;o<n;o++)e.has(o)?(1===i[o]&&0==--t[o]&&r.filterSize++,i[o]=0):(0===i[o]&&1==++t[o]&&r.filterSize--,i[o]=1)}filter(e,t,n,i=!0){const r=performance.now();if(this.filterColumns=t,this.filterArguments=n,this.filterMethod=e,this[e](n,t),this.bgfArray){const e=this.parent.filterArray,t=this.parent.size,n=this.filterArray,i=this.parent;for(let r=0;r<t;r++)0===this.bgfArray[r]&&(1==++e[r]&&i.filterSize--,n[r]=2)}i&&this.parent._callListeners("filtered",this),console.log(`method${e}: ${performance.now()-r}`)}reFilterOnDataChanged(e){if(this.filterMethod&&this.filterColumns)for(let t of this.filterColumns)if("string"==typeof t&&-1!==e.indexOf(t))return this.filter(this.filterMethod,this.filterColumns,this.filterArguments,!1),!0;return!1}updateSize(){let e=new SharedArrayBuffer(this.parent.size),t=new Uint8Array(e);t.set(this.filterArray),this.filterBuffer=e,this.filterArray=t,this.bgfArray&&(this.bgfData,this.setBackgroundFilter(b.column.b.cat)),this.filterMethod&&this.filter(this.filterMethod,this.filterColumns,this.filterArguments,!1)}setBackgroundFilter(e,t){const n=this.parent.columnIndex[e],i=n.values.indexOf(t),r=n.data;this.bgfData={column:e,cat:t},this.bgfArray=new Uint8Array(this.parent.size);for(let e=0;e<this.parent.size;e++)r[e]===i?this.bgfArray[e]=1:this.filterArray[e]=2}clearBackGroundFilter(){this.bgfArray=null,this.bgfData=null}destroy(e=!0){this.removeFilter(e),this.filterBuffer=null,this.localFilter=null,this.parent.dimensions.splice(this.parent.dimensions.indexOf(this),1)}}i.types={base_dimension:i};const r=i},3117:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(8970);class r extends i.Z{constructor(e,t){super(e,t),this.worker=new Worker(new URL(n.p+n.u(220),n.b))}filterSquare(e,t){let n=null;n="string"!=typeof t[0]?t[0]:this.parent.columnIndex[t[0]].data;const i=this.parent.columnIndex[t[1]].data,r=this.parent.filterArray,o=this.parent,a=e.range1,s=e.range2,l=this.filterArray;for(let e=0;e<this.parent.size;e++){const t=n[e],c=i[e];t<a[0]||t>a[1]||c<s[0]||c>s[1]||isNaN(t)||isNaN(c)?(0===l[e]&&1==++r[e]&&o.filterSize--,l[e]=1):(1===l[e]&&0==--r[e]&&o.filterSize++,l[e]=0)}}filterPoly(e,t){const n=e;let i=Number.MAX_VALUE,r=Number.MAX_VALUE,o=Number.MIN_VALUE,a=Number.MIN_VALUE;for(let e of n)i=Math.min(i,e[0]),o=Math.max(o,e[0]),r=Math.min(r,e[1]),a=Math.max(a,e[1]);let s=null;s="string"!=typeof t[0]?t[0]:this.parent.columnIndex[t[0]].data;const l=this.parent.columnIndex[t[1]].data,c=this.parent.filterArray,h=this.parent,u=h.size,f=n,d=this.filterArray;for(let e=0;e<u;e++){let t=s[e],n=l[e],u=!1;if(t<i||t>o||n<r||n>a||isNaN(t)||isNaN(n))0===d[e]&&1==++c[e]&&h.filterSize--,d[e]=1;else{for(let e=0,i=f.length-1;e<f.length;i=e++){let r=f[e][0],o=f[e][1],a=f[i][0],s=f[i][1];o>n!=s>n&&t<(a-r)*(n-o)/(s-o)+r&&(u=!u)}u?(1===d[e]&&0==--c[e]&&h.filterSize++,d[e]=0):(0===d[e]&&1==++c[e]&&h.filterSize--,d[e]=1)}}}filterRange(e,t){const n=e.min,i=e.max,r=this.parent.columnIndex[t[0]].data,o=this.parent.filterArray,a=this.filterArray,s=this.parent;for(let e=0;e<this.parent.size;e++){const t=r[e];t<n||t>i||isNaN(t)?(0===a[e]&&1==++o[e]&&s.filterSize--,a[e]=1):(1===a[e]&&0==--o[e]&&s.filterSize++,a[e]=0)}}getBins(e,t,n={}){const i=this.parent.columnIndex[t];n.bins=void 0===n.bins?10:n.bins,n.min=void 0===n.min?i.minMax[0]:n.min,n.max=void 0===n.max?i.minMax[1]:n.max;const r=performance.now();this.worker.onmessage=t=>{console.log(`calculate bins ${i.name} : ${performance.now()-r}`),e(t.data)},this.worker.postMessage([this.filterBuffer,this.parent.filterBuffer,[i.buffer,i.datatype],n])}destroy(){super.destroy(),this.worker.terminate()}}i.Z.types.range_dimension=r;const o=r},2024:(e,t,n)=>{"use strict";function i(){var e=!1,t=!1;this.stopPropagation=function(){e=!0},this.isPropagationStopped=function(){return e},this.stopImmediatePropagation=function(){t=!0},this.isImmediatePropagationStopped=function(){return t}}function r(){this.__nonDataRow=!0}function o(){this.__group=!0,this.level=0,this.count=0,this.value=null,this.title=null,this.collapsed=!1,this.selectChecked=!1,this.totals=null,this.rows=[],this.groups=null,this.groupingKey=null}function a(){this.__groupTotals=!0,this.group=null,this.initialized=!1}function s(){var e=null;this.isActive=function(t){return t?e===t:null!==e},this.activate=function(t){if(t!==e){if(null!==e)throw new Error("SlickGrid.EditorLock.activate: an editController is still active, can't activate another editController");if(!t.commitCurrentEdit)throw new Error("SlickGrid.EditorLock.activate: editController must implement .commitCurrentEdit()");if(!t.cancelCurrentEdit)throw new Error("SlickGrid.EditorLock.activate: editController must implement .cancelCurrentEdit()");e=t}},this.deactivate=function(t){if(e){if(e!==t)throw new Error("SlickGrid.EditorLock.deactivate: specified editController is not the currently active one");e=null}},this.commitCurrentEdit=function(){return!e||e.commitCurrentEdit()},this.cancelCurrentEdit=function(){return!e||e.cancelCurrentEdit()}}n.d(t,{v:()=>l}),o.prototype=new r,o.prototype.equals=function(e){return this.value===e.value&&this.count===e.count&&this.collapsed===e.collapsed&&this.title===e.title},a.prototype=new r;const l={Event:function(){var e=[];this.subscribe=function(t){e.push(t)},this.unsubscribe=function(t){for(var n=e.length-1;n>=0;n--)e[n]===t&&e.splice(n,1)},this.notify=function(t,n,r){var o;n=n||new i,r=r||this;for(var a=0;a<e.length&&!n.isPropagationStopped()&&!n.isImmediatePropagationStopped();a++)o=e[a].call(r,n,t);return o}},EventData:i,EventHandler:function(){var e=[];this.subscribe=function(t,n){return e.push({event:t,handler:n}),t.subscribe(n),this},this.unsubscribe=function(t,n){for(var i=e.length;i--;)if(e[i].event===t&&e[i].handler===n)return e.splice(i,1),void t.unsubscribe(n);return this},this.unsubscribeAll=function(){for(var t=e.length;t--;)e[t].event.unsubscribe(e[t].handler);return e=[],this}},Range:function(e,t,n,i){void 0===n&&void 0===i&&(n=e,i=t),this.fromRow=Math.min(e,n),this.fromCell=Math.min(t,i),this.toRow=Math.max(e,n),this.toCell=Math.max(t,i),this.isSingleRow=function(){return this.fromRow==this.toRow},this.isSingleCell=function(){return this.fromRow==this.toRow&&this.fromCell==this.toCell},this.contains=function(e,t){return e>=this.fromRow&&e<=this.toRow&&t>=this.fromCell&&t<=this.toCell},this.toString=function(){return this.isSingleCell()?"("+this.fromRow+":"+this.fromCell+")":"("+this.fromRow+":"+this.fromCell+" - "+this.toRow+":"+this.toCell+")"}},Map:"Map"in window?window.Map:function(){var e={};this.get=function(t){return e[t]},this.set=function(t,n){e[t]=n},this.has=function(t){return t in e},this.delete=function(t){delete e[t]}},NonDataRow:r,Group:o,GroupTotals:a,EditorLock:s,GlobalEditorLock:new s,TreeColumns:function(e){var t={};function n(e,t){return e.filter((function(e){var i=t.call(e);return i&&e.columns&&(e.columns=n(e.columns,t)),i&&(!e.columns||e.columns.length)}))}function i(e,t){e.sort((function(e,n){return r(t.getColumnIndex(e.id))-r(t.getColumnIndex(n.id))})).forEach((function(e){e.columns&&i(e.columns,t)}))}function r(e){return void 0===e?-1:e}function o(e){if(!e.length)return e.columns?1+o(e.columns):1;for(var t in e)return o(e[t])}function a(e,t,n){var i=[];if(t==(n=n||0))return e.length&&e.forEach((function(e){e.columns&&(e.extractColumns=function(){return s(e)})})),e;for(var r in e)e[r].columns&&(i=i.concat(a(e[r].columns,t,n+1)));return i}function s(e){var t=[];if(e.hasOwnProperty("length"))for(var n=0;n<e.length;n++)t=t.concat(s(e[n]));else{if(!e.hasOwnProperty("columns"))return e;t=t.concat(s(e.columns))}return t}function l(){return JSON.parse(JSON.stringify(nodesArray))}(function e(n){n.forEach((function(n){t[n.id]=n,n.columns&&e(n.columns)}))})(e),this.hasDepth=function(){for(var t in e)if(e[t].hasOwnProperty("columns"))return!0;return!1},this.getTreeColumns=function(){return e},this.extractColumns=function(){return this.hasDepth()?s(e):e},this.getDepth=function(){return o(e)},this.getColumnsInDepth=function(t){return a(e,t)},this.getColumnsInGroup=function(e){return s(e)},this.visibleColumns=function(){return n(l(),(function(){return this.visible}))},this.filter=function(e){return n(l(),e)},this.reOrder=function(t){return i(e,t)},this.getById=function(e){return t[e]},this.getInIds=function(e){return e.map((function(e){return t[e]}))}},keyCode:{SPACE:8,BACKSPACE:8,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,RIGHT:39,TAB:9,UP:38,A:65},preClickClassName:"slick-edit-preclick",GridAutosizeColsMode:{None:"NOA",LegacyOff:"LOF",LegacyForceFit:"LFF",IgnoreViewport:"IGV",FitColsToViewport:"FCV",FitViewportToCols:"FVC"},ColAutosizeMode:{Locked:"LCK",Guide:"GUI",Content:"CON",ContentIntelligent:"CTI"},RowSelectionMode:{FirstRow:"FS1",FirstNRows:"FSN",AllRows:"ALL",LastRow:"LS1"},ValueFilterMode:{None:"NONE",DeDuplicate:"DEDP",GetGreatestAndSub:"GR8T",GetLongestTextAndSub:"LNSB",GetLongestText:"LNSC"},WidthEvalMode:{CanvasTextSize:"CANV",HTML:"HTML"}}},626:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A5:()=>Overlays,H4:()=>TextEditor,zn:()=>SlickGrid});var _Slick_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2024),jquery__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(9755),jquery__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(jquery__WEBPACK_IMPORTED_MODULE_1__);const jQuery=jquery__WEBPACK_IMPORTED_MODULE_1___default();var scrollbarDimensions,maxSupportedCssHeight;function SlickGrid(container,data,columns,options){var defaults={alwaysShowVerticalScroll:!1,alwaysAllowHorizontalScroll:!1,explicitInitialization:!1,rowHeight:25,defaultColumnWidth:80,enableAddRow:!1,leaveSpaceForNewRows:!1,editable:!1,autoEdit:!0,suppressActiveCellChangeOnEdit:!1,enableCellNavigation:!0,enableColumnReorder:!0,asyncEditorLoading:!1,asyncEditorLoadDelay:100,forceFitColumns:!1,enableAsyncPostRender:!1,asyncPostRenderDelay:50,enableAsyncPostRenderCleanup:!1,asyncPostRenderCleanupDelay:40,autoHeight:!1,editorLock:_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.GlobalEditorLock,showColumnHeader:!0,showHeaderRow:!1,headerRowHeight:25,createFooterRow:!1,showFooterRow:!1,footerRowHeight:25,createPreHeaderPanel:!1,showPreHeaderPanel:!1,preHeaderPanelHeight:25,showTopPanel:!1,topPanelHeight:25,formatterFactory:null,editorFactory:null,cellFlashingCssClass:"flashing",selectedCellCssClass:"selected",multiSelect:!0,enableTextSelectionOnCells:!1,dataItemColumnValueExtractor:null,frozenBottom:!1,frozenColumn:-1,frozenRow:-1,frozenRightViewportMinWidth:100,fullWidthRows:!1,multiColumnSort:!1,numberedMultiColumnSort:!1,tristateMultiColumnSort:!1,sortColNumberInSeparateSpan:!1,defaultFormatter,forceSyncScrolling:!1,addNewRowCssClass:"new-row",preserveCopiedSelectionOnPaste:!1,showCellSelection:!0,viewportClass:null,minRowBuffer:3,emulatePagingWhenScrolling:!0,editorCellNavOnLRKeys:!1,enableMouseWheelScrollHandler:!0,doPaging:!0,autosizeColsMode:_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.GridAutosizeColsMode.LegacyOff,autosizeColPaddingPx:4,autosizeTextAvgToMWidthRatio:.75,viewportSwitchToScrollModeWidthPercent:void 0,viewportMinWidthPx:void 0,viewportMaxWidthPx:void 0,suppressCssChangesOnHiddenInit:!1},columnDefaults={name:"",resizable:!0,sortable:!1,minWidth:30,maxWidth:void 0,rerenderOnResize:!1,headerCssClass:null,defaultSortAsc:!0,focusable:!0,selectable:!0},columnAutosizeDefaults={ignoreHeaderText:!1,colValueArray:void 0,allowAddlPercent:void 0,formatterOverride:void 0,autosizeMode:_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.ColAutosizeMode.ContentIntelligent,rowSelectionModeOnInit:void 0,rowSelectionMode:_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.RowSelectionMode.FirstNRows,rowSelectionCount:100,valueFilterMode:_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.ValueFilterMode.None,widthEvalMode:_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.WidthEvalMode.CanvasTextSize,sizeToRemaining:void 0,widthPx:void 0,colDataTypeOf:void 0},th,h,ph,n,cj,page=0,offset=0,vScrollDir=1,initialized=!1,$container,uid="slickgrid_"+Math.round(1e6*Math.random()),self=this,$focusSink,$focusSink2,$groupHeaders=jquery__WEBPACK_IMPORTED_MODULE_1___default()(),$headerScroller,$headers,$headerRow,$headerRowScroller,$headerRowSpacerL,$headerRowSpacerR,$footerRow,$footerRowScroller,$footerRowSpacerL,$footerRowSpacerR,$preHeaderPanel,$preHeaderPanelScroller,$preHeaderPanelSpacer,$preHeaderPanelR,$preHeaderPanelScrollerR,$preHeaderPanelSpacerR,$topPanelScroller,$topPanel,$viewport,$canvas,$style,$boundAncestors,treeColumns,stylesheet,columnCssRulesL,columnCssRulesR,viewportH,viewportW,canvasWidth,canvasWidthL,canvasWidthR,headersWidth,headersWidthL,headersWidthR,viewportHasHScroll,viewportHasVScroll,headerColumnWidthDiff=0,headerColumnHeightDiff=0,cellWidthDiff=0,cellHeightDiff=0,jQueryNewWidthBehaviour=!1,absoluteColumnMinWidth,hasFrozenRows=!1,frozenRowsHeight=0,actualFrozenRow=-1,paneTopH=0,paneBottomH=0,viewportTopH=0,viewportBottomH=0,topPanelH=0,headerRowH=0,footerRowH=0,tabbingDirection=1,$activeCanvasNode,$activeViewportNode,activePosX,activeRow,activeCell,activeCellNode=null,currentEditor=null,serializedEditorValue,editController,rowsCache={},renderedRows=0,numVisibleRows=0,prevScrollTop=0,scrollTop=0,lastRenderedScrollTop=0,lastRenderedScrollLeft=0,prevScrollLeft=0,scrollLeft=0,selectionModel,selectedRows=[],plugins=[],cellCssClasses={},columnsById={},sortColumns=[],columnPosLeft=[],columnPosRight=[],pagingActive=!1,pagingIsLastPage=!1,scrollThrottle=ActionThrottle(render,50),h_editorLoader=null,h_render=null,h_postrender=null,h_postrenderCleanup=null,postProcessedRows={},postProcessToRow=null,postProcessFromRow=null,postProcessedCleanupQueue=[],postProcessgroupId=0,counter_rows_rendered=0,counter_rows_removed=0,rowNodeFromLastMouseWheelEvent,zombieRowNodeFromLastMouseWheelEvent,zombieRowCacheFromLastMouseWheelEvent,zombieRowPostProcessedFromLastMouseWheelEvent,$paneHeaderL,$paneHeaderR,$paneTopL,$paneTopR,$paneBottomL,$paneBottomR,$headerScrollerL,$headerScrollerR,$headerL,$headerR,$groupHeadersL,$groupHeadersR,$headerRowScrollerL,$headerRowScrollerR,$footerRowScrollerL,$footerRowScrollerR,$headerRowL,$headerRowR,$footerRowL,$footerRowR,$topPanelScrollerL,$topPanelScrollerR,$topPanelL,$topPanelR,$viewportTopL,$viewportTopR,$viewportBottomL,$viewportBottomR,$canvasTopL,$canvasTopR,$canvasBottomL,$canvasBottomR,$viewportScrollContainerX,$viewportScrollContainerY,$headerScrollContainer,$headerRowScrollContainer,$footerRowScrollContainer,cssShow={position:"absolute",visibility:"hidden",display:"block"},$hiddenParents,oldProps=[],columnResizeDragging=!1,__doc__=document;function init(){if(($container=container instanceof jquery__WEBPACK_IMPORTED_MODULE_1___default()?container:jquery__WEBPACK_IMPORTED_MODULE_1___default()(container)).length<1)throw new Error("SlickGrid requires a valid container, "+container+" does not exist in the DOM.");if(options.suppressCssChangesOnHiddenInit||cacheCssForHiddenInit(),maxSupportedCssHeight=maxSupportedCssHeight||getMaxSupportedCssHeight(),options=jquery__WEBPACK_IMPORTED_MODULE_1___default().extend({},defaults,options),validateAndEnforceOptions(),columnDefaults.width=options.defaultColumnWidth,treeColumns=new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.TreeColumns(columns),columns=treeColumns.extractColumns(),updateColumnProps(),options.enableColumnReorder&&!jquery__WEBPACK_IMPORTED_MODULE_1___default().fn.sortable)throw new Error("SlickGrid's 'enableColumnReorder = true' option requires jquery-ui.sortable module to be loaded");if(editController={commitCurrentEdit,cancelCurrentEdit},$container.empty().css("overflow","hidden").css("outline",0).addClass(uid).addClass("ui-widget"),/relative|absolute|fixed/.test($container.css("position"))||$container.css("position","relative"),$focusSink=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div tabIndex='0' hideFocus style='position:fixed;width:0;height:0;top:0;left:0;outline:0;'></div>").appendTo($container),$paneHeaderL=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='slick-pane slick-pane-header slick-pane-left' tabIndex='0' />").appendTo($container),$paneHeaderR=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='slick-pane slick-pane-header slick-pane-right' tabIndex='0' />").appendTo($container),$paneTopL=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='slick-pane slick-pane-top slick-pane-left' tabIndex='0' />").appendTo($container),$paneTopR=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='slick-pane slick-pane-top slick-pane-right' tabIndex='0' />").appendTo($container),$paneBottomL=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='slick-pane slick-pane-bottom slick-pane-left' tabIndex='0' />").appendTo($container),$paneBottomR=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='slick-pane slick-pane-bottom slick-pane-right' tabIndex='0' />").appendTo($container),options.createPreHeaderPanel&&($preHeaderPanelScroller=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='slick-preheader-panel ui-state-default' style='overflow:hidden;position:relative;' />").appendTo($paneHeaderL),$preHeaderPanel=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div />").appendTo($preHeaderPanelScroller),$preHeaderPanelSpacer=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div style='display:block;height:1px;position:absolute;top:0;left:0;'></div>").appendTo($preHeaderPanelScroller),$preHeaderPanelScrollerR=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='slick-preheader-panel ui-state-default' style='overflow:hidden;position:relative;' />").appendTo($paneHeaderR),$preHeaderPanelR=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div />").appendTo($preHeaderPanelScrollerR),$preHeaderPanelSpacerR=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div style='display:block;height:1px;position:absolute;top:0;left:0;'></div>").appendTo($preHeaderPanelScrollerR),options.showPreHeaderPanel||($preHeaderPanelScroller.hide(),$preHeaderPanelScrollerR.hide())),$headerScrollerL=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='slick-header ui-state-default slick-header-left' />").appendTo($paneHeaderL),$headerScrollerR=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='slick-header ui-state-default slick-header-right' />").appendTo($paneHeaderR),$headerScroller=jquery__WEBPACK_IMPORTED_MODULE_1___default()().add($headerScrollerL).add($headerScrollerR),treeColumns.hasDepth()){$groupHeadersL=[],$groupHeadersR=[];for(var e=0;e<treeColumns.getDepth()-1;e++)$groupHeadersL[e]=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='slick-group-header-columns slick-group-header-columns-left' style='left:-1000px' />").appendTo($headerScrollerL),$groupHeadersR[e]=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='slick-group-header-columns slick-group-header-columns-right' style='left:-1000px' />").appendTo($headerScrollerR);$groupHeaders=jquery__WEBPACK_IMPORTED_MODULE_1___default()().add($groupHeadersL).add($groupHeadersR)}$headerL=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='slick-header-columns slick-header-columns-left' style='left:-1000px' />").data("__doc__",__doc__).appendTo($headerScrollerL),$headerR=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='slick-header-columns slick-header-columns-right' style='left:-1000px' />").appendTo($headerScrollerR),$headers=jquery__WEBPACK_IMPORTED_MODULE_1___default()().add($headerL).add($headerR),$headerRowScrollerL=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='slick-headerrow ui-state-default' />").appendTo($paneTopL),$headerRowScrollerR=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='slick-headerrow ui-state-default' />").appendTo($paneTopR),$headerRowScroller=jquery__WEBPACK_IMPORTED_MODULE_1___default()().add($headerRowScrollerL).add($headerRowScrollerR),$headerRowSpacerL=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div style='display:block;height:1px;position:absolute;top:0;left:0;'></div>").appendTo($headerRowScrollerL),$headerRowSpacerR=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div style='display:block;height:1px;position:absolute;top:0;left:0;'></div>").appendTo($headerRowScrollerR),$headerRowL=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='slick-headerrow-columns slick-headerrow-columns-left' />").appendTo($headerRowScrollerL),$headerRowR=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='slick-headerrow-columns slick-headerrow-columns-right' />").appendTo($headerRowScrollerR),$headerRow=jquery__WEBPACK_IMPORTED_MODULE_1___default()().add($headerRowL).add($headerRowR),$topPanelScrollerL=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='slick-top-panel-scroller ui-state-default' />").appendTo($paneTopL),$topPanelScrollerR=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='slick-top-panel-scroller ui-state-default' />").appendTo($paneTopR),$topPanelScroller=jquery__WEBPACK_IMPORTED_MODULE_1___default()().add($topPanelScrollerL).add($topPanelScrollerR),$topPanelL=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='slick-top-panel' style='width:10000px' />").appendTo($topPanelScrollerL),$topPanelR=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='slick-top-panel' style='width:10000px' />").appendTo($topPanelScrollerR),$topPanel=jquery__WEBPACK_IMPORTED_MODULE_1___default()().add($topPanelL).add($topPanelR),options.showColumnHeader||$headerScroller.hide(),options.showTopPanel||$topPanelScroller.hide(),options.showHeaderRow||$headerRowScroller.hide(),$viewportTopL=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='slick-viewport slick-viewport-top slick-viewport-left' tabIndex='0' hideFocus />").appendTo($paneTopL),$viewportTopR=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='slick-viewport slick-viewport-top slick-viewport-right' tabIndex='0' hideFocus />").appendTo($paneTopR),$viewportBottomL=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='slick-viewport slick-viewport-bottom slick-viewport-left' tabIndex='0' hideFocus />").appendTo($paneBottomL),$viewportBottomR=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='slick-viewport slick-viewport-bottom slick-viewport-right' tabIndex='0' hideFocus />").appendTo($paneBottomR),$viewport=jquery__WEBPACK_IMPORTED_MODULE_1___default()().add($viewportTopL).add($viewportTopR).add($viewportBottomL).add($viewportBottomR),$activeViewportNode=$viewportTopL,$canvasTopL=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='grid-canvas grid-canvas-top grid-canvas-left' tabIndex='0' hideFocus />").appendTo($viewportTopL),$canvasTopR=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='grid-canvas grid-canvas-top grid-canvas-right' tabIndex='0' hideFocus />").appendTo($viewportTopR),$canvasBottomL=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='grid-canvas grid-canvas-bottom grid-canvas-left' tabIndex='0' hideFocus />").appendTo($viewportBottomL),$canvasBottomR=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='grid-canvas grid-canvas-bottom grid-canvas-right' tabIndex='0' hideFocus />").appendTo($viewportBottomR),options.viewportClass&&$viewport.toggleClass(options.viewportClass,!0),$canvas=jquery__WEBPACK_IMPORTED_MODULE_1___default()().add($canvasTopL).add($canvasTopR).add($canvasBottomL).add($canvasBottomR),scrollbarDimensions=scrollbarDimensions||measureScrollbar(),$activeCanvasNode=$canvasTopL,$preHeaderPanelSpacer&&$preHeaderPanelSpacer.css("width",getCanvasWidth()+scrollbarDimensions.width+"px"),$headers.width(getHeadersWidth()),$headerRowSpacerL.css("width",getCanvasWidth()+scrollbarDimensions.width+"px"),$headerRowSpacerR.css("width",getCanvasWidth()+scrollbarDimensions.width+"px"),options.createFooterRow&&($footerRowScrollerR=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='slick-footerrow ui-state-default' />").appendTo($paneTopR),$footerRowScrollerL=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='slick-footerrow ui-state-default' />").appendTo($paneTopL),$footerRowScroller=jquery__WEBPACK_IMPORTED_MODULE_1___default()().add($footerRowScrollerL).add($footerRowScrollerR),$footerRowSpacerL=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div style='display:block;height:1px;position:absolute;top:0;left:0;'></div>").css("width",getCanvasWidth()+scrollbarDimensions.width+"px").appendTo($footerRowScrollerL),$footerRowSpacerR=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div style='display:block;height:1px;position:absolute;top:0;left:0;'></div>").css("width",getCanvasWidth()+scrollbarDimensions.width+"px").appendTo($footerRowScrollerR),$footerRowL=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='slick-footerrow-columns slick-footerrow-columns-left' />").appendTo($footerRowScrollerL),$footerRowR=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='slick-footerrow-columns slick-footerrow-columns-right' />").appendTo($footerRowScrollerR),$footerRow=jquery__WEBPACK_IMPORTED_MODULE_1___default()().add($footerRowL).add($footerRowR),options.showFooterRow||$footerRowScroller.hide()),$focusSink2=$focusSink.clone().appendTo($container),options.explicitInitialization||finishInitialization()}function finishInitialization(){initialized||(initialized=!0,getViewportWidth(),getViewportHeight(),measureCellPaddingAndBorder(),disableSelection($headers),options.enableTextSelectionOnCells||$viewport.on("selectstart.ui",(function(e){return jquery__WEBPACK_IMPORTED_MODULE_1___default()(e.target).is("input,textarea")})),setFrozenOptions(),setPaneVisibility(),setScroller(),setOverflow(),updateColumnCaches(),createColumnHeaders(),createColumnGroupHeaders(),createColumnFooter(),setupColumnSort(),createCssRules(),resizeCanvas(),bindAncestorScrollEvents(),$container.on("resize.slickgrid",resizeCanvas),$viewport.on("scroll",handleScroll),jQuery.fn.mousewheel&&options.enableMouseWheelScrollHandler&&$viewport.on("mousewheel",handleMouseWheel),$headerScroller.on("contextmenu",handleHeaderContextMenu).on("click",handleHeaderClick).on("mouseenter",".slick-header-column",handleHeaderMouseEnter).on("mouseleave",".slick-header-column",handleHeaderMouseLeave),$headerRowScroller.on("scroll",handleHeaderRowScroll),options.createFooterRow&&($footerRow.on("contextmenu",handleFooterContextMenu).on("click",handleFooterClick),$footerRowScroller.on("scroll",handleFooterRowScroll)),options.createPreHeaderPanel&&$preHeaderPanelScroller.on("scroll",handlePreHeaderPanelScroll),$focusSink.add($focusSink2).on("keydown",handleKeyDown),$canvas.on("keydown",handleKeyDown).on("click",handleClick).on("dblclick",handleDblClick).on("contextmenu",handleContextMenu).on("draginit",handleDragInit).on("dragstart",{distance:3},handleDragStart).on("drag",handleDrag).on("dragend",handleDragEnd).on("mouseenter",".slick-cell",handleMouseEnter).on("mouseleave",".slick-cell",handleMouseLeave),options.suppressCssChangesOnHiddenInit||restoreCssFromHiddenInit())}function cacheCssForHiddenInit(){($hiddenParents=$container.parents().addBack().not(":visible")).each((function(){var e={};for(var t in cssShow)e[t]=this.style[t],this.style[t]=cssShow[t];oldProps.push(e)}))}function restoreCssFromHiddenInit(){$hiddenParents.each((function(e){var t=oldProps[e];for(var n in cssShow)this.style[n]=t[n]}))}function hasFrozenColumns(){return options.frozenColumn>-1}function registerPlugin(e){plugins.unshift(e),e.init(self)}function unregisterPlugin(e){for(var t=plugins.length;t>=0;t--)if(plugins[t]===e){plugins[t].destroy&&plugins[t].destroy(),plugins.splice(t,1);break}}function getPluginByName(e){for(var t=plugins.length-1;t>=0;t--)if(plugins[t].pluginName===e)return plugins[t]}function setSelectionModel(e){selectionModel&&(selectionModel.onSelectedRangesChanged.unsubscribe(handleSelectedRangesChanged),selectionModel.destroy&&selectionModel.destroy()),(selectionModel=e)&&(selectionModel.init(self),selectionModel.onSelectedRangesChanged.subscribe(handleSelectedRangesChanged))}function getSelectionModel(){return selectionModel}function getCanvasNode(e,t){return _getContainerElement(getCanvases(),e,t)}function getActiveCanvasNode(e){return setActiveCanvasNode(e),$activeCanvasNode[0]}function getCanvases(){return $canvas}function setActiveCanvasNode(e){e&&($activeCanvasNode=jquery__WEBPACK_IMPORTED_MODULE_1___default()(e.target).closest(".grid-canvas"))}function getViewportNode(e,t){return _getContainerElement(getViewports(),e,t)}function getViewports(){return $viewport}function getActiveViewportNode(e){return setActiveViewportNode(e),$activeViewportNode[0]}function setActiveViewportNode(e){e&&($activeViewportNode=jquery__WEBPACK_IMPORTED_MODULE_1___default()(e.target).closest(".slick-viewport"))}function _getContainerElement(e,t,n){if(e){t||(t=0),n||(n=0);var i="number"==typeof t?t:getColumnIndex(t);return e[(hasFrozenRows&&n>=actualFrozenRow+(options.frozenBottom?0:1)?2:0)+(hasFrozenColumns()&&i>options.frozenColumn?1:0)]}}function measureScrollbar(){var e=jquery__WEBPACK_IMPORTED_MODULE_1___default()('<div class="'+$viewport.className+'" style="position:absolute; top:-10000px; left:-10000px; overflow:auto; width:100px; height:100px;"></div>').appendTo("body"),t=jquery__WEBPACK_IMPORTED_MODULE_1___default()('<div style="width:200px; height:200px; overflow:auto;"></div>').appendTo(e),n={width:e[0].offsetWidth-e[0].clientWidth,height:e[0].offsetHeight-e[0].clientHeight};return t.remove(),e.remove(),n}function getHeadersWidth(){headersWidth=headersWidthL=headersWidthR=0;for(var e=!options.autoHeight,t=0,n=columns.length;t<n;t++){var i=columns[t].width;options.frozenColumn>-1&&t>options.frozenColumn?headersWidthR+=i:headersWidthL+=i}return e&&(options.frozenColumn>-1&&t>options.frozenColumn?headersWidthR+=scrollbarDimensions.width:headersWidthL+=scrollbarDimensions.width),hasFrozenColumns()?(headersWidthL+=1e3,headersWidthR=Math.max(headersWidthR,viewportW)+headersWidthL,headersWidthR+=scrollbarDimensions.width):(headersWidthL+=scrollbarDimensions.width,headersWidthL=Math.max(headersWidthL,viewportW)+1e3),headersWidth=headersWidthL+headersWidthR,Math.max(headersWidth,viewportW)+1e3}function getHeadersWidthL(){return headersWidthL=0,columns.forEach((function(e,t){options.frozenColumn>-1&&t>options.frozenColumn||(headersWidthL+=e.width)})),hasFrozenColumns()?headersWidthL+=1e3:(headersWidthL+=scrollbarDimensions.width,headersWidthL=Math.max(headersWidthL,viewportW)+1e3),headersWidthL}function getHeadersWidthR(){return headersWidthR=0,columns.forEach((function(e,t){options.frozenColumn>-1&&t>options.frozenColumn&&(headersWidthR+=e.width)})),hasFrozenColumns()&&(headersWidthR=Math.max(headersWidthR,viewportW)+getHeadersWidthL(),headersWidthR+=scrollbarDimensions.width),headersWidthR}function getCanvasWidth(){var e=viewportHasVScroll?viewportW-scrollbarDimensions.width:viewportW,t=columns.length;for(canvasWidthL=canvasWidthR=0;t--;)hasFrozenColumns()&&t>options.frozenColumn?canvasWidthR+=columns[t].width:canvasWidthL+=columns[t].width;var n=canvasWidthL+canvasWidthR;return options.fullWidthRows?Math.max(n,e):n}function updateCanvasWidth(e){var t,n=canvasWidth,i=canvasWidthL,r=canvasWidthR;((t=(canvasWidth=getCanvasWidth())!==n||canvasWidthL!==i||canvasWidthR!==r)||hasFrozenColumns()||hasFrozenRows)&&($canvasTopL.width(canvasWidthL),getHeadersWidth(),$headerL.width(headersWidthL),$headerR.width(headersWidthR),hasFrozenColumns()?($canvasTopR.width(canvasWidthR),$paneHeaderL.width(canvasWidthL),$paneHeaderR.css("left",canvasWidthL),$paneHeaderR.css("width",viewportW-canvasWidthL),$paneTopL.width(canvasWidthL),$paneTopR.css("left",canvasWidthL),$paneTopR.css("width",viewportW-canvasWidthL),$headerRowScrollerL.width(canvasWidthL),$headerRowScrollerR.width(viewportW-canvasWidthL),$headerRowL.width(canvasWidthL),$headerRowR.width(canvasWidthR),options.createFooterRow&&($footerRowScrollerL.width(canvasWidthL),$footerRowScrollerR.width(viewportW-canvasWidthL),$footerRowL.width(canvasWidthL),$footerRowR.width(canvasWidthR)),options.createPreHeaderPanel&&$preHeaderPanel.width(canvasWidth),$viewportTopL.width(canvasWidthL),$viewportTopR.width(viewportW-canvasWidthL),hasFrozenRows&&($paneBottomL.width(canvasWidthL),$paneBottomR.css("left",canvasWidthL),$viewportBottomL.width(canvasWidthL),$viewportBottomR.width(viewportW-canvasWidthL),$canvasBottomL.width(canvasWidthL),$canvasBottomR.width(canvasWidthR))):($paneHeaderL.width("100%"),$paneTopL.width("100%"),$headerRowScrollerL.width("100%"),$headerRowL.width(canvasWidth),options.createFooterRow&&($footerRowScrollerL.width("100%"),$footerRowL.width(canvasWidth)),options.createPreHeaderPanel&&($preHeaderPanel.width("100%"),$preHeaderPanel.width(canvasWidth)),$viewportTopL.width("100%"),hasFrozenRows&&($viewportBottomL.width("100%"),$canvasBottomL.width(canvasWidthL))),viewportHasHScroll=canvasWidth>=viewportW-scrollbarDimensions.width),$headerRowSpacerL.width(canvasWidth+(viewportHasVScroll?scrollbarDimensions.width:0)),$headerRowSpacerR.width(canvasWidth+(viewportHasVScroll?scrollbarDimensions.width:0)),options.createFooterRow&&($footerRowSpacerL.width(canvasWidth+(viewportHasVScroll?scrollbarDimensions.width:0)),$footerRowSpacerR.width(canvasWidth+(viewportHasVScroll?scrollbarDimensions.width:0))),(t||e)&&applyColumnWidths()}function disableSelection(e){e&&e.jquery&&e.attr("unselectable","on").css("MozUserSelect","none").on("selectstart.ui",(function(){return!1}))}function getMaxSupportedCssHeight(){for(var e=1e6,t=navigator.userAgent.toLowerCase().match(/firefox/)?6e6:1e9,n=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div style='display:none' />").appendTo(__doc__.body);;){var i=2*e;if(n.css("height",i),i>t||n.height()!==i)break;e=i}return n.remove(),e}function getUID(){return uid}function getHeaderColumnWidthDiff(){return headerColumnWidthDiff}function getScrollbarDimensions(){return scrollbarDimensions}function bindAncestorScrollEvents(){for(var e=hasFrozenRows&&!options.frozenBottom?$canvasBottomL[0]:$canvasTopL[0];(e=e.parentNode)!=__doc__.body&&null!=e;)if(e==$viewportTopL[0]||e.scrollWidth!=e.clientWidth||e.scrollHeight!=e.clientHeight){var t=jquery__WEBPACK_IMPORTED_MODULE_1___default()(e);$boundAncestors=$boundAncestors?$boundAncestors.add(t):t,t.on("scroll."+uid,handleActiveCellPositionChange)}}function unbindAncestorScrollEvents(){$boundAncestors&&($boundAncestors.off("scroll."+uid),$boundAncestors=null)}function updateColumnHeader(e,t,n){if(initialized){var i=getColumnIndex(e);if(null!=i){var r=columns[i],o=$headers.children().eq(i);o&&(void 0!==t&&(columns[i].name=t),void 0!==n&&(columns[i].toolTip=n),trigger(self.onBeforeHeaderCellDestroy,{node:o[0],column:r,grid:self}),o.attr("title",n||"").children().eq(0).html(t),trigger(self.onHeaderCellRendered,{node:o[0],column:r,grid:self}))}}}function getHeader(e){if(!e)return hasFrozenColumns()?$headers:$headerL;var t=getColumnIndex(e.id);return hasFrozenColumns()?t<=options.frozenColumn?$headerL:$headerR:$headerL}function getHeaderColumn(e){var t="number"==typeof e?e:getColumnIndex(e),n=hasFrozenColumns()?t<=options.frozenColumn?$headerL:$headerR:$headerL,i=hasFrozenColumns()?t<=options.frozenColumn?t:t-options.frozenColumn-1:t,r=n.children().eq(i);return r&&r[0]}function getHeaderRow(){return hasFrozenColumns()?$headerRow:$headerRow[0]}function getFooterRow(){return hasFrozenColumns()?$footerRow:$footerRow[0]}function getPreHeaderPanel(){return $preHeaderPanel[0]}function getPreHeaderPanelRight(){return $preHeaderPanelR[0]}function getHeaderRowColumn(e){var t,n="number"==typeof e?e:getColumnIndex(e);hasFrozenColumns()?n<=options.frozenColumn?t=$headerRowL:(t=$headerRowR,n-=options.frozenColumn+1):t=$headerRowL;var i=t.children().eq(n);return i&&i[0]}function getFooterRowColumn(e){var t,n="number"==typeof e?e:getColumnIndex(e);hasFrozenColumns()?n<=options.frozenColumn?t=$footerRowL:(t=$footerRowR,n-=options.frozenColumn+1):t=$footerRowL;var i=t&&t.children().eq(n);return i&&i[0]}function createColumnFooter(){if(options.createFooterRow){$footerRow.find(".slick-footerrow-column").each((function(){var e=jquery__WEBPACK_IMPORTED_MODULE_1___default()(this).data("column");e&&trigger(self.onBeforeFooterRowCellDestroy,{node:this,column:e,grid:self})})),$footerRowL.empty(),$footerRowR.empty();for(var e=0;e<columns.length;e++){var t=columns[e],n=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='ui-state-default slick-footerrow-column l"+e+" r"+e+"'></div>").data("column",t).addClass(hasFrozenColumns()&&e<=options.frozenColumn?"frozen":"").appendTo(hasFrozenColumns()&&e>options.frozenColumn?$footerRowR:$footerRowL);trigger(self.onFooterRowCellRendered,{node:n[0],column:t,grid:self})}}}function createColumnGroupHeaders(){var e=0,t=!1;if(treeColumns.hasDepth()){for(var n=0;n<$groupHeadersL.length;n++){$groupHeadersL[n].empty(),$groupHeadersR[n].empty();var i=treeColumns.getColumnsInDepth(n);for(var r in i){var o=i[r];e+=o.extractColumns().length,hasFrozenColumns()&&0===n&&e-1===options.frozenColumn&&(t=!0),jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='ui-state-default slick-group-header-column' />").html("<span class='slick-column-name'>"+o.name+"</span>").attr("id",""+uid+o.id).attr("title",o.toolTip||"").data("column",o).addClass(o.headerCssClass||"").addClass(hasFrozenColumns()&&e-1>options.frozenColumn?"frozen":"").appendTo(hasFrozenColumns()&&e-1>options.frozenColumn?$groupHeadersR[n]:$groupHeadersL[n])}if(hasFrozenColumns()&&0===n&&!t){$groupHeadersL[n].empty(),$groupHeadersR[n].empty(),alert("All columns of group should to be grouped!");break}}applyColumnGroupHeaderWidths()}}function createColumnHeaders(){function e(){jquery__WEBPACK_IMPORTED_MODULE_1___default()(this).addClass("ui-state-hover")}function t(){jquery__WEBPACK_IMPORTED_MODULE_1___default()(this).removeClass("ui-state-hover")}$headers.find(".slick-header-column").each((function(){var e=jquery__WEBPACK_IMPORTED_MODULE_1___default()(this).data("column");e&&trigger(self.onBeforeHeaderCellDestroy,{node:this,column:e,grid:self})})),$headerL.empty(),$headerR.empty(),getHeadersWidth(),$headerL.width(headersWidthL),$headerR.width(headersWidthR),$headerRow.find(".slick-headerrow-column").each((function(){var e=jquery__WEBPACK_IMPORTED_MODULE_1___default()(this).data("column");e&&trigger(self.onBeforeHeaderRowCellDestroy,{node:this,column:e,grid:self})})),$headerRowL.empty(),$headerRowR.empty(),options.createFooterRow&&($footerRowL.find(".slick-footerrow-column").each((function(){var e=jquery__WEBPACK_IMPORTED_MODULE_1___default()(this).data("column");e&&trigger(self.onBeforeFooterRowCellDestroy,{node:this,column:e,grid:self})})),$footerRowL.empty(),hasFrozenColumns()&&($footerRowR.find(".slick-footerrow-column").each((function(){var e=jquery__WEBPACK_IMPORTED_MODULE_1___default()(this).data("column");e&&trigger(self.onBeforeFooterRowCellDestroy,{node:this,column:e,grid:self})})),$footerRowR.empty()));for(var n=0;n<columns.length;n++){var i=columns[n],r=hasFrozenColumns()?n<=options.frozenColumn?$headerL:$headerR:$headerL,o=hasFrozenColumns()?n<=options.frozenColumn?$headerRowL:$headerRowR:$headerRowL,a=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='ui-state-default slick-header-column' />").html("<span class='slick-column-name'>"+i.name+"</span>").width(i.width-headerColumnWidthDiff).attr("id",""+uid+i.id).attr("title",i.toolTip||"").data("column",i).data("__doc__",__doc__).addClass(i.headerCssClass||"").addClass(hasFrozenColumns()&&n<=options.frozenColumn?"frozen":"").appendTo(r);if((options.enableColumnReorder||i.sortable)&&a.on("mouseenter",e).on("mouseleave",t),a.on("dragstart",((e,t)=>{t.target.style.zIndex=1,t.target.style.opacity=.6})).on("drag",((e,t)=>{t.target.style.left=t.offsetX-t.originalX+1e3+"px"})).on("dragend",((e,t)=>{if(Math.abs(t.deltaX)<5)return t.target.style.opacity=1,void(t.target.style.zIndex="");const n=jquery__WEBPACK_IMPORTED_MODULE_1___default()(t.target).data("column");let i=0;const r=[];let o=0;for(let e of columns)r.push(o),e===n&&(i=o),o+=e.width;r.push(o+1e3);const a=[];let s=i+t.deltaX;s<0&&a.push(n);for(let e=0;e<columns.length;e++)columns[e]!==n&&a.push(columns[e]),s>r[e]&&s<r[e+1]&&(a.push(n),s=-1e3);setColumns(columns=a)})),i.hasOwnProperty("headerCellAttrs")&&i.headerCellAttrs instanceof Object)for(var s in i.headerCellAttrs)i.headerCellAttrs.hasOwnProperty(s)&&a.attr(s,i.headerCellAttrs[s]);if(i.sortable&&(a.addClass("slick-header-sortable"),a.append("<span class='slick-sort-indicator"+(options.numberedMultiColumnSort&&!options.sortColNumberInSeparateSpan?" slick-sort-indicator-numbered":"")+"' />"),options.numberedMultiColumnSort&&options.sortColNumberInSeparateSpan&&a.append("<span class='slick-sort-indicator-numbered' />")),trigger(self.onHeaderCellRendered,{node:a[0],column:i,grid:self}),options.showHeaderRow){var l=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='ui-state-default slick-headerrow-column l"+n+" r"+n+"'></div>").data("column",i).addClass(hasFrozenColumns()&&n<=options.frozenColumn?"frozen":"").appendTo(o);trigger(self.onHeaderRowCellRendered,{node:l[0],column:i,grid:self})}if(options.createFooterRow&&options.showFooterRow){var c=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='ui-state-default slick-footerrow-column l"+n+" r"+n+"'></div>").data("column",i).appendTo($footerRow);trigger(self.onFooterRowCellRendered,{node:c[0],column:i,grid:self})}}setSortColumns(sortColumns),setupColumnResize(),options.enableColumnReorder&&("function"==typeof options.enableColumnReorder?options.enableColumnReorder(self,$headers,headerColumnWidthDiff,setColumns,setupColumnResize,columns,getColumnIndex,uid,trigger):setupColumnReorder())}function setupColumnSort(){$headers.click((function(e){if(!columnResizeDragging&&(e.metaKey=e.metaKey||e.ctrlKey,!jquery__WEBPACK_IMPORTED_MODULE_1___default()(e.target).hasClass("slick-resizable-handle"))){var t=jquery__WEBPACK_IMPORTED_MODULE_1___default()(e.target).closest(".slick-header-column");if(t.length){var n=t.data("column");if(n.sortable){if(!getEditorLock().commitCurrentEdit())return;for(var i=null,r=0;r<sortColumns.length;r++)if(sortColumns[r].columnId==n.id){(i=sortColumns[r]).sortAsc=!i.sortAsc;break}var o=!!i;options.tristateMultiColumnSort?(i||(i={columnId:n.id,sortAsc:n.defaultSortAsc}),o&&i.sortAsc&&(sortColumns.splice(r,1),i=null),options.multiColumnSort||(sortColumns=[]),!i||o&&options.multiColumnSort||sortColumns.push(i)):e.metaKey&&options.multiColumnSort?i&&sortColumns.splice(r,1):((e.shiftKey||e.metaKey)&&options.multiColumnSort||(sortColumns=[]),i?0===sortColumns.length&&sortColumns.push(i):(i={columnId:n.id,sortAsc:n.defaultSortAsc},sortColumns.push(i))),setSortColumns(sortColumns),options.multiColumnSort?trigger(self.onSort,{multiColumnSort:!0,sortCols:jquery__WEBPACK_IMPORTED_MODULE_1___default().map(sortColumns,(function(e){return{columnId:columns[getColumnIndex(e.columnId)].id,sortCol:columns[getColumnIndex(e.columnId)],sortAsc:e.sortAsc}}))},e):trigger(self.onSort,{multiColumnSort:!1,columnId:sortColumns.length>0?n.id:null,sortCol:sortColumns.length>0?n:null,sortAsc:!(sortColumns.length>0)||sortColumns[0].sortAsc},e)}}}}))}function currentPositionInHeader(e){var t=0;return $headers.find(".slick-header-column").each((function(n){if(this.id==e)return t=n,!1})),t}function limitPositionInGroup(e){var t,n=0,i=0;return treeColumns.getColumnsInDepth($groupHeadersL.length-1).some((function(r){return n=i,i+=r.columns.length,r.columns.some((function(n){return n.id===e&&(t=r),t})),t})),i--,{start:n,end:i,group:t}}function remove(e,t){var n=e.lastIndexOf(t);n>-1&&(e.splice(n,1),remove(e,t))}function columnPositionValidInGroup(e){var t=currentPositionInHeader(e[0].id),n=limitPositionInGroup(e.data("column").id),i=n.start<=t&&t<=n.end;return{limit:n,valid:i,message:i?"":'Column "'.concat(e.text(),'" can be reordered only within the "',n.group.name,'" group!')}}function setupColumnReorder(){$headers.filter(":ui-sortable").sortable("destroy");var e,t=null;function n(){$viewportScrollContainerX[0].scrollLeft=$viewportScrollContainerX[0].scrollLeft+10}function i(){$viewportScrollContainerX[0].scrollLeft=$viewportScrollContainerX[0].scrollLeft-10}$headers.sortable({containment:"parent",distance:3,axis:"x",cursor:"default",tolerance:"intersection",helper:"clone",placeholder:"slick-sortable-placeholder ui-state-default slick-header-column",start:function(t,n){n.placeholder.width(n.helper.outerWidth()-headerColumnWidthDiff),e=!hasFrozenColumns()||n.placeholder.offset().left+n.placeholder.width()>$viewportScrollContainerX.offset().left,jquery__WEBPACK_IMPORTED_MODULE_1___default()(n.helper).addClass("slick-header-column-active")},beforeStop:function(e,t){jquery__WEBPACK_IMPORTED_MODULE_1___default()(t.helper).removeClass("slick-header-column-active")},sort:function(r,o){e&&r.originalEvent.pageX>$container[0].clientWidth?t||(t=setInterval(n,100)):e&&r.originalEvent.pageX<$viewportScrollContainerX.offset().left?t||(t=setInterval(i,100)):(clearInterval(t),t=null)},stop:function(e,n){var i=!1;clearInterval(t),t=null;var r=null;if(treeColumns.hasDepth()){var o=columnPositionValidInGroup(n.item);r=o.limit,(i=!o.valid)&&alert(o.message)}if(!i&&getEditorLock().commitCurrentEdit()){var a=$headerL.sortable("toArray");a=a.concat($headerR.sortable("toArray"));for(var s=[],l=0;l<a.length;l++)s.push(columns[getColumnIndex(a[l].replace(uid,""))]);setColumns(s),trigger(self.onColumnsReordered,{impactedColumns:getImpactedColumns(r)}),e.stopPropagation(),setupColumnResize()}else jquery__WEBPACK_IMPORTED_MODULE_1___default()(this).sortable("cancel")}})}function getImpactedColumns(e){var t=[];if(e)for(var n=e.start;n<=e.end;n++)t.push(columns[n]);else t=columns;return t}function setupColumnResize(){var e,t,n,i,r,o,a,s,l,c=0;(r=$headers.children()).find(".slick-resizable-handle").remove(),r.each((function(e,t){e>=columns.length||columns[e].resizable&&(void 0===s&&(s=e),l=e)})),void 0!==s&&r.each((function(h,u){h>=columns.length||h<s||options.forceFitColumns&&h>=l||(jquery__WEBPACK_IMPORTED_MODULE_1___default()(u),jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='slick-resizable-handle' />").data("__doc__",__doc__).appendTo(u).on("dragstart",(function(t,s){if(!getEditorLock().commitCurrentEdit())return!1;i=t.pageX,c=0,jquery__WEBPACK_IMPORTED_MODULE_1___default()(this).parent().addClass("slick-header-column-active");var l=null,u=null;if(r.each((function(e,t){e>=columns.length||(columns[e].previousWidth=jquery__WEBPACK_IMPORTED_MODULE_1___default()(t).outerWidth())})),options.forceFitColumns)for(l=0,u=0,e=h+1;e<columns.length;e++)(n=columns[e]).resizable&&(null!==u&&(n.maxWidth?u+=n.maxWidth-n.previousWidth:u=null),l+=n.previousWidth-Math.max(n.minWidth||0,absoluteColumnMinWidth));var f=0,d=0;for(e=0;e<=h;e++)(n=columns[e]).resizable&&(null!==d&&(n.maxWidth?d+=n.maxWidth-n.previousWidth:d=null),f+=n.previousWidth-Math.max(n.minWidth||0,absoluteColumnMinWidth));null===l&&(l=1e5),null===f&&(f=1e5),null===u&&(u=1e5),null===d&&(d=1e5),a=i+Math.min(l,d),o=i-Math.min(f,u)})).on("drag",(function(r,s){columnResizeDragging=!0;var l,u,f=Math.min(a,Math.max(o,r.pageX))-i,d=0,p=viewportHasVScroll?viewportW-scrollbarDimensions.width:viewportW;if(f<0){for(u=f,e=h;e>=0;e--)(n=columns[e]).resizable&&(l=Math.max(n.minWidth||0,absoluteColumnMinWidth),u&&n.previousWidth+u<l?(u+=n.previousWidth-l,n.width=l):(n.width=n.previousWidth+u,u=0));for(t=0;t<=h;t++)n=columns[t],hasFrozenColumns()&&t>options.frozenColumn?n.width:d+=n.width;if(options.forceFitColumns)for(u=-f,e=h+1;e<columns.length;e++)(n=columns[e]).resizable&&(u&&n.maxWidth&&n.maxWidth-n.previousWidth<u?(u-=n.maxWidth-n.previousWidth,n.width=n.maxWidth):(n.width=n.previousWidth+u,u=0),hasFrozenColumns()&&e>options.frozenColumn?n.width:d+=n.width);else for(e=h+1;e<columns.length;e++)n=columns[e],hasFrozenColumns()&&e>options.frozenColumn?n.width:d+=n.width;if(options.forceFitColumns)for(u=-f,e=h+1;e<columns.length;e++)(n=columns[e]).resizable&&(u&&n.maxWidth&&n.maxWidth-n.previousWidth<u?(u-=n.maxWidth-n.previousWidth,n.width=n.maxWidth):(n.width=n.previousWidth+u,u=0))}else{for(u=f,d=0,e=h;e>=0;e--)if((n=columns[e]).resizable)if(u&&n.maxWidth&&n.maxWidth-n.previousWidth<u)u-=n.maxWidth-n.previousWidth,n.width=n.maxWidth;else{var g=n.previousWidth+u,m=canvasWidthL+u;hasFrozenColumns()&&e<=options.frozenColumn?(g>c&&m<p-options.frozenRightViewportMinWidth&&(c=g),n.width=m+options.frozenRightViewportMinWidth>p?c:g):n.width=g,u=0}for(t=0;t<=h;t++)n=columns[t],hasFrozenColumns()&&t>options.frozenColumn?n.width:d+=n.width;if(options.forceFitColumns)for(u=-f,e=h+1;e<columns.length;e++)(n=columns[e]).resizable&&(l=Math.max(n.minWidth||0,absoluteColumnMinWidth),u&&n.previousWidth+u<l?(u+=n.previousWidth-l,n.width=l):(n.width=n.previousWidth+u,u=0),hasFrozenColumns()&&e>options.frozenColumn?n.width:d+=n.width);else for(e=h+1;e<columns.length;e++)n=columns[e],hasFrozenColumns()&&e>options.frozenColumn?n.width:d+=n.width}hasFrozenColumns()&&d!=canvasWidthL&&($headerL.width(d+1e3),$paneHeaderR.css("left",d)),applyColumnHeaderWidths(),applyColumnGroupHeaderWidths(),options.syncColumnCellResize&&applyColumnWidths(),trigger(self.onColumnsDrag,{triggeredByColumn:jquery__WEBPACK_IMPORTED_MODULE_1___default()(this).parent().attr("id").replace(uid,""),resizeHandle:jquery__WEBPACK_IMPORTED_MODULE_1___default()(this)})})).on("dragend",(function(t,i){jquery__WEBPACK_IMPORTED_MODULE_1___default()(this).parent().removeClass("slick-header-column-active");var o,a=jquery__WEBPACK_IMPORTED_MODULE_1___default()(this).parent().attr("id").replace(uid,"");for(!0===trigger(self.onBeforeColumnsResize,{triggeredByColumn:a})&&(applyColumnHeaderWidths(),applyColumnGroupHeaderWidths()),e=0;e<columns.length;e++)n=columns[e],o=jquery__WEBPACK_IMPORTED_MODULE_1___default()(r[e]).outerWidth(),n.previousWidth!==o&&n.rerenderOnResize&&invalidateAllRows();updateCanvasWidth(!0),render(),trigger(self.onColumnsResized,{triggeredByColumn:a}),setTimeout((function(){columnResizeDragging=!1}),300)})).on("dblclick",(function(){var e=jquery__WEBPACK_IMPORTED_MODULE_1___default()(this).parent().attr("id").replace(uid,"");trigger(self.onColumnsResizeDblClick,{triggeredByColumn:e})})))}))}function getVBoxDelta(e){var t=0;return e&&"function"==typeof e.css&&jquery__WEBPACK_IMPORTED_MODULE_1___default().each(["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],(function(n,i){t+=parseFloat(e.css(i))||0})),t}function setFrozenOptions(){options.frozenColumn=options.frozenColumn>=0&&options.frozenColumn<columns.length?parseInt(options.frozenColumn):-1,options.frozenRow>-1?(hasFrozenRows=!0,frozenRowsHeight=options.frozenRow*options.rowHeight,getDataLength(),actualFrozenRow=options.frozenBottom?dataLength-options.frozenRow:options.frozenRow):hasFrozenRows=!1}function setPaneVisibility(){hasFrozenColumns()?($paneHeaderR.show(),$paneTopR.show(),hasFrozenRows?($paneBottomL.show(),$paneBottomR.show()):($paneBottomR.hide(),$paneBottomL.hide())):($paneHeaderR.hide(),$paneTopR.hide(),$paneBottomR.hide(),hasFrozenRows?$paneBottomL.show():($paneBottomR.hide(),$paneBottomL.hide()))}function setOverflow(){$viewportTopL.css({"overflow-x":hasFrozenColumns()?hasFrozenRows&&!options.alwaysAllowHorizontalScroll?"hidden":"scroll":hasFrozenRows&&!options.alwaysAllowHorizontalScroll?"hidden":"auto","overflow-y":!hasFrozenColumns()&&options.alwaysShowVerticalScroll?"scroll":hasFrozenColumns()?"hidden":hasFrozenRows?"scroll":"auto"}),$viewportTopR.css({"overflow-x":hasFrozenColumns()?hasFrozenRows&&!options.alwaysAllowHorizontalScroll?"hidden":"scroll":hasFrozenRows&&!options.alwaysAllowHorizontalScroll?"hidden":"auto","overflow-y":options.alwaysShowVerticalScroll?"scroll":(hasFrozenColumns(),hasFrozenRows?"scroll":"auto")}),$viewportBottomL.css({"overflow-x":hasFrozenColumns()?hasFrozenRows&&!options.alwaysAllowHorizontalScroll?"scroll":"auto":(hasFrozenRows&&options.alwaysAllowHorizontalScroll,"auto"),"overflow-y":!hasFrozenColumns()&&options.alwaysShowVerticalScroll?"scroll":hasFrozenColumns()?"hidden":hasFrozenRows?"scroll":"auto"}),$viewportBottomR.css({"overflow-x":hasFrozenColumns()?hasFrozenRows&&!options.alwaysAllowHorizontalScroll?"scroll":"auto":(hasFrozenRows&&options.alwaysAllowHorizontalScroll,"auto"),"overflow-y":options.alwaysShowVerticalScroll?"scroll":(hasFrozenColumns(),"auto")}),options.viewportClass&&($viewportTopL.toggleClass(options.viewportClass,!0),$viewportTopR.toggleClass(options.viewportClass,!0),$viewportBottomL.toggleClass(options.viewportClass,!0),$viewportBottomR.toggleClass(options.viewportClass,!0))}function setScroller(){hasFrozenColumns()?($headerScrollContainer=$headerScrollerR,$headerRowScrollContainer=$headerRowScrollerR,$footerRowScrollContainer=$footerRowScrollerR,hasFrozenRows?options.frozenBottom?($viewportScrollContainerX=$viewportBottomR,$viewportScrollContainerY=$viewportTopR):$viewportScrollContainerX=$viewportScrollContainerY=$viewportBottomR:$viewportScrollContainerX=$viewportScrollContainerY=$viewportTopR):($headerScrollContainer=$headerScrollerL,$headerRowScrollContainer=$headerRowScrollerL,$footerRowScrollContainer=$footerRowScrollerL,hasFrozenRows?options.frozenBottom?($viewportScrollContainerX=$viewportBottomL,$viewportScrollContainerY=$viewportTopL):$viewportScrollContainerX=$viewportScrollContainerY=$viewportBottomL:$viewportScrollContainerX=$viewportScrollContainerY=$viewportTopL)}function measureCellPaddingAndBorder(){var e,t=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],n=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],i=jquery__WEBPACK_IMPORTED_MODULE_1___default().fn.jquery.split(".");jQueryNewWidthBehaviour=1==i[0]&&i[1]>=8||i[0]>=2,e=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='ui-state-default slick-header-column' style='visibility:hidden'>-</div>").appendTo($headers),headerColumnWidthDiff=headerColumnHeightDiff=0,"border-box"!=e.css("box-sizing")&&"border-box"!=e.css("-moz-box-sizing")&&"border-box"!=e.css("-webkit-box-sizing")&&(jquery__WEBPACK_IMPORTED_MODULE_1___default().each(t,(function(t,n){headerColumnWidthDiff+=parseFloat(e.css(n))||0})),jquery__WEBPACK_IMPORTED_MODULE_1___default().each(n,(function(t,n){headerColumnHeightDiff+=parseFloat(e.css(n))||0}))),e.remove();var r=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='slick-row' />").appendTo($canvas);e=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='slick-cell' id='' style='visibility:hidden'>-</div>").appendTo(r),cellWidthDiff=cellHeightDiff=0,"border-box"!=e.css("box-sizing")&&"border-box"!=e.css("-moz-box-sizing")&&"border-box"!=e.css("-webkit-box-sizing")&&(jquery__WEBPACK_IMPORTED_MODULE_1___default().each(t,(function(t,n){cellWidthDiff+=parseFloat(e.css(n))||0})),jquery__WEBPACK_IMPORTED_MODULE_1___default().each(n,(function(t,n){cellHeightDiff+=parseFloat(e.css(n))||0}))),r.remove(),absoluteColumnMinWidth=Math.max(headerColumnWidthDiff,cellWidthDiff)}function createCssRules(){$style=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<style type='text/css' rel='stylesheet'/>").appendTo(__doc__.head);for(var e=options.rowHeight-cellHeightDiff,t=["."+uid+" .slick-group-header-column { left: 1000px; }","."+uid+" .slick-header-column { left: 1000px; }","."+uid+" .slick-top-panel { height:"+options.topPanelHeight+"px; }","."+uid+" .slick-preheader-panel { height:"+options.preHeaderPanelHeight+"px; }","."+uid+" .slick-headerrow-columns { height:"+options.headerRowHeight+"px; }","."+uid+" .slick-footerrow-columns { height:"+options.footerRowHeight+"px; }","."+uid+" .slick-cell { height:"+e+"px; }","."+uid+" .slick-row { height:"+options.rowHeight+"px; }"],n=0;n<columns.length;n++)t.push("."+uid+" .l"+n+" { }"),t.push("."+uid+" .r"+n+" { }");$style[0].styleSheet?$style[0].styleSheet.cssText=t.join(" "):$style[0].appendChild(__doc__.createTextNode(t.join(" ")))}function getColumnCssRules(e){var t;if(!stylesheet){var n=__doc__.styleSheets;for(let e=0;e<n.length;e++){if((n[e].ownerNode||n[e].owningElement)==$style[0]){stylesheet=n[e];break}if(n[e].rules[0].selectorText&&n[e].rules[0].selectorText.includes(uid)){stylesheet=n[e];break}}if(!stylesheet)throw new Error("SlickGrid Cannot find stylesheet.");columnCssRulesL=[],columnCssRulesR=[];var i,r,o=stylesheet.cssRules||stylesheet.rules;for(t=0;t<o.length;t++){var a=o[t].selectorText;(i=/\.l\d+/.exec(a))?(r=parseInt(i[0].substr(2,i[0].length-2),10),columnCssRulesL[r]=o[t]):(i=/\.r\d+/.exec(a))&&(r=parseInt(i[0].substr(2,i[0].length-2),10),columnCssRulesR[r]=o[t])}}return{left:columnCssRulesL[e],right:columnCssRulesR[e]}}function removeCssRules(){$style.remove(),stylesheet=null}function destroy(e){getEditorLock().cancelCurrentEdit(),trigger(self.onBeforeDestroy,{});for(var t=plugins.length;t--;)unregisterPlugin(plugins[t]);options.enableColumnReorder&&$headers.filter(":ui-sortable").sortable("destroy"),unbindAncestorScrollEvents(),$container.off(".slickgrid"),removeCssRules(),$canvas.off(),$viewport.off(),$headerScroller.off(),$headerRowScroller.off(),$footerRow&&$footerRow.off(),$footerRowScroller&&$footerRowScroller.off(),$preHeaderPanelScroller&&$preHeaderPanelScroller.off(),$focusSink.off(),jquery__WEBPACK_IMPORTED_MODULE_1___default()(".slick-resizable-handle").off(),jquery__WEBPACK_IMPORTED_MODULE_1___default()(".slick-header-column").off(),$container.empty().removeClass(uid),e&&destroyAllElements()}function destroyAllElements(){$activeCanvasNode=null,$activeViewportNode=null,$boundAncestors=null,$canvas=null,$canvasTopL=null,$canvasTopR=null,$canvasBottomL=null,$canvasBottomR=null,$container=null,$focusSink=null,$focusSink2=null,$groupHeaders=null,$groupHeadersL=null,$groupHeadersR=null,$headerL=null,$headerR=null,$headers=null,$headerRow=null,$headerRowL=null,$headerRowR=null,$headerRowSpacerL=null,$headerRowSpacerR=null,$headerRowScrollContainer=null,$headerRowScroller=null,$headerRowScrollerL=null,$headerRowScrollerR=null,$headerScrollContainer=null,$headerScroller=null,$headerScrollerL=null,$headerScrollerR=null,$hiddenParents=null,$footerRow=null,$footerRowL=null,$footerRowR=null,$footerRowSpacerL=null,$footerRowSpacerR=null,$footerRowScroller=null,$footerRowScrollerL=null,$footerRowScrollerR=null,$footerRowScrollContainer=null,$preHeaderPanel=null,$preHeaderPanelR=null,$preHeaderPanelScroller=null,$preHeaderPanelScrollerR=null,$preHeaderPanelSpacer=null,$preHeaderPanelSpacerR=null,$topPanel=null,$topPanelScroller=null,$style=null,$topPanelScrollerL=null,$topPanelScrollerR=null,$topPanelL=null,$topPanelR=null,$paneHeaderL=null,$paneHeaderR=null,$paneTopL=null,$paneTopR=null,$paneBottomL=null,$paneBottomR=null,$viewport=null,$viewportTopL=null,$viewportTopR=null,$viewportBottomL=null,$viewportBottomR=null,$viewportScrollContainerX=null,$viewportScrollContainerY=null}var canvas=null,canvas_context=null;function autosizeColumn(e,t){var n=e;if("number"==typeof e)n=columns[e];else if("string"==typeof e)for(var i=0;i<columns.length;i++)columns[i].Id===e&&(n=columns[i]);getColAutosizeWidth(n,jquery__WEBPACK_IMPORTED_MODULE_1___default()(getCanvasNode(0,0)),t)}function autosizeColumns(e,t){if((e=e||options.autosizeColsMode)!==_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.GridAutosizeColsMode.LegacyForceFit&&e!==_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.GridAutosizeColsMode.LegacyOff){if(e!==_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.GridAutosizeColsMode.None){(canvas=__doc__.createElement("canvas"))&&canvas.getContext&&(canvas_context=canvas.getContext("2d"));var n,i,r,o,a=jquery__WEBPACK_IMPORTED_MODULE_1___default()(getCanvasNode(0,0)),s=viewportHasVScroll?viewportW-scrollbarDimensions.width:viewportW,l=0,c=0,h=0,u=0,f=0;for(n=0;n<columns.length;n++)getColAutosizeWidth(i=columns[n],a,t),f+=i.autoSize.autosizeMode===_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.ColAutosizeMode.Locked?i.width:0,u+=i.autoSize.autosizeMode===_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.ColAutosizeMode.Locked?i.width:i.minWidth,l+=i.autoSize.widthPx,c+=i.autoSize.sizeToRemaining?0:i.autoSize.widthPx,h+=i.autoSize.sizeToRemaining&&i.minWidth||0;var d=l-c;if(e===_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.GridAutosizeColsMode.FitViewportToCols){var p=l+scrollbarDimensions.width;e=_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.GridAutosizeColsMode.IgnoreViewport,options.viewportMaxWidthPx&&p>options.viewportMaxWidthPx?(p=options.viewportMaxWidthPx,e=_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.GridAutosizeColsMode.FitColsToViewport):options.viewportMinWidthPx&&p<options.viewportMinWidthPx&&(p=options.viewportMinWidthPx,e=_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.GridAutosizeColsMode.FitColsToViewport),$container.width(p)}if(e===_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.GridAutosizeColsMode.FitColsToViewport)if(d>0&&c<s-h)for(n=0;n<columns.length;n++){var g=s-c;r=(i=columns[n]).autoSize.sizeToRemaining?g*i.autoSize.widthPx/d:i.autoSize.widthPx,i.rerenderOnResize&&i.width!=r&&(o=!0),i.width=r}else if(options.viewportSwitchToScrollModeWidthPercent&&c+h>s*options.viewportSwitchToScrollModeWidthPercent/100||u>s)e=_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.GridAutosizeColsMode.IgnoreViewport;else{var m=c-f,_=s-f-h;for(n=0;n<columns.length;n++)r=(i=columns[n]).width,i.autoSize.autosizeMode!==_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.ColAutosizeMode.Locked&&(i.autoSize.sizeToRemaining?r=i.minWidth:((r=_/m*i.autoSize.widthPx)<i.minWidth&&(r=i.minWidth),m-=i.autoSize.widthPx,_-=r)),i.rerenderOnResize&&i.width!=r&&(o=!0),i.width=r}if(e===_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.GridAutosizeColsMode.IgnoreViewport)for(n=0;n<columns.length;n++)r=columns[n].autoSize.widthPx,columns[n].rerenderOnResize&&columns[n].width!=r&&(o=!0),columns[n].width=r;reRenderColumns(o)}}else legacyAutosizeColumns()}function LogColWidths(){for(var e="Col Widths:",t=0;t<columns.length;t++)e+=" "+columns[t].width;console.log(e)}function getColAutosizeWidth(e,t,n){var i=e.autoSize;if(i.widthPx=e.width,i.autosizeMode!==_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.ColAutosizeMode.Locked&&i.autosizeMode!==_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.ColAutosizeMode.Guide){var r=getDataLength();if(i.autosizeMode===_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.ColAutosizeMode.ContentIntelligent){var o,a=i.colDataTypeOf;if(r>0){var s=getDataItem(0);s&&"object"==(a=typeof(o=s[e.field]))&&(o instanceof Date&&(a="date"),"undefined"!=typeof moment&&o instanceof moment&&(a="moment"))}"boolean"===a&&(i.colValueArray=[!0,!1]),"number"===a&&(i.valueFilterMode=_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.ValueFilterMode.GetGreatestAndSub,i.rowSelectionMode=_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.RowSelectionMode.AllRows),"string"===a&&(i.valueFilterMode=_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.ValueFilterMode.GetLongestText,i.rowSelectionMode=_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.RowSelectionMode.AllRows,i.allowAddlPercent=5),"date"===a&&(i.colValueArray=[new Date(2009,8,30,12,20,20)]),"moment"===a&&"undefined"!=typeof moment&&(i.colValueArray=[moment([2009,8,30,12,20,20])])}var l=getColContentSize(e,t,n);l=l*(i.allowAddlPercent?1+i.allowAddlPercent/100:1)+options.autosizeColPaddingPx,e.minWidth&&l<e.minWidth&&(l=e.minWidth),e.maxWidth&&l>e.maxWidth&&(l=e.maxWidth),i.widthPx=l}}function getColContentSize(e,t,n){var i,r=e.autoSize,o=1,a=0,s=0;if(r.ignoreHeaderText||(s=getColHeaderWidth(e)),r.colValueArray)return a=getColWidth(e,t,r.colValueArray),Math.max(s,a);var l=getData();l.getItems&&(l=l.getItems());var c=(n?r.rowSelectionModeOnInit:void 0)||r.rowSelectionMode;if(c===_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.RowSelectionMode.FirstRow&&(l=l.slice(0,1)),c===_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.RowSelectionMode.LastRow&&(l=l.slice(l.length-1,l.length)),c===_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.RowSelectionMode.FirstNRows&&(l=l.slice(0,r.rowSelectionCount)),r.valueFilterMode===_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.ValueFilterMode.DeDuplicate){var h={};for(u=0,i=l.length;u<i;u++)h[l[u][e.field]]=!0;if(Object.keys)l=Object.keys(h);else for(var u in l=[],h)l.push(u)}if(r.valueFilterMode===_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.ValueFilterMode.GetGreatestAndSub){var f,d=0;for(u=0,i=l.length;u<i;u++)g=l[u][e.field],Math.abs(g)>d&&(f=g,d=Math.abs(g));f=""+f,l=[f=+(f=Array(f.length+1).join("9"))]}if(r.valueFilterMode===_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.ValueFilterMode.GetLongestTextAndSub){var p=0;for(u=0,i=l.length;u<i;u++)((g=l[u][e.field])||"").length>p&&(p=g.length);g=Array(p+1).join("m"),o=options.autosizeTextAvgToMWidthRatio,l=[g]}if(r.valueFilterMode===_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.ValueFilterMode.GetLongestText){p=0;var g,m=0;for(u=0,i=l.length;u<i;u++)((g=l[u][e.field])||"").length>p&&(p=g.length,m=u);l=[g=l[m][e.field]]}return a=getColWidth(e,t,l)*o,Math.max(s,a)}function getColWidth(e,t,n){var i=getColumnIndex(e.id),r=jquery__WEBPACK_IMPORTED_MODULE_1___default()('<div class="slick-row ui-widget-content"></div>'),o=jquery__WEBPACK_IMPORTED_MODULE_1___default()('<div class="slick-cell"></div>');o.css({position:"absolute",visibility:"hidden","text-overflow":"initial","white-space":"nowrap"}),r.append(o),t.append(r);var a,s,l,c,h=0;return canvas_context&&e.autoSize.widthEvalMode===_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.WidthEvalMode.CanvasTextSize?(canvas_context.font=o.css("font-size")+" "+o.css("font-family"),jquery__WEBPACK_IMPORTED_MODULE_1___default()(n).each((function(t,n){c=Array.isArray(n)?n[e.field]:n,(a=(s=""+c)?canvas_context.measureText(s).width:0)>h&&(h=a,l=s)})),o.html(l),a=o.outerWidth(),r.remove(),o=null,a):(jquery__WEBPACK_IMPORTED_MODULE_1___default()(n).each((function(t,n){c=Array.isArray(n)?n[e.field]:n,applyFormatResultToCellNode(e.formatterOverride?e.formatterOverride(t,i,c,e,n,self):e.formatter?e.formatter(t,i,c,e,n,self):""+c,o[0]),(a=o.outerWidth())>h&&(h=a)})),r.remove(),o=null,h)}function getColHeaderWidth(e){var t=0,n=getUID()+e.id,i=__doc__.getElementById(n),r=n+"_";if(i){var o=i.cloneNode(!0);o.id=r,o.style.cssText="position: absolute; visibility: hidden;right: auto;text-overflow: initial;white-space: nowrap;",i.parentNode.insertBefore(o,i),t=o.offsetWidth,o.parentNode.removeChild(o)}else{var a=getHeader(e);t=(i=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='ui-state-default slick-header-column' />").html("<span class='slick-column-name'>"+e.name+"</span>").attr("id",r).css({position:"absolute",visibility:"hidden",right:"auto","text-overflow:":"initial","white-space":"nowrap"}).addClass(e.headerCssClass||"").appendTo(a))[0].offsetWidth,a[0].removeChild(i[0])}return t}function legacyAutosizeColumns(){var e,t,n,i=[],r=0,o=0,a=viewportHasVScroll?viewportW-scrollbarDimensions.width:viewportW;for(e=0;e<columns.length;e++)t=columns[e],i.push(t.width),o+=t.width,t.resizable&&(r+=t.width-Math.max(t.minWidth,absoluteColumnMinWidth));for(n=o;o>a&&r;){var s=(o-a)/r;for(e=0;e<columns.length&&o>a;e++){t=columns[e];var l=i[e];if(!(!t.resizable||l<=t.minWidth||l<=absoluteColumnMinWidth)){var c=Math.max(t.minWidth,absoluteColumnMinWidth),h=Math.floor(s*(l-c))||1;o-=h=Math.min(h,l-c),r-=h,i[e]-=h}}if(n<=o)break;n=o}for(n=o;o<a;){var u=a/o;for(e=0;e<columns.length&&o<a;e++){t=columns[e];var f,d=i[e];o+=f=!t.resizable||t.maxWidth<=d?0:Math.min(Math.floor(u*d)-d,t.maxWidth-d||1e6)||1,i[e]+=o<=a?f:0}if(n>=o)break;n=o}var p=!1;for(e=0;e<columns.length;e++)columns[e].rerenderOnResize&&columns[e].width!=i[e]&&(p=!0),columns[e].width=i[e];reRenderColumns(p)}function reRenderColumns(e){applyColumnHeaderWidths(),applyColumnGroupHeaderWidths(),updateCanvasWidth(!0),trigger(self.onAutosizeColumns,{columns}),e&&(invalidateAllRows(),render())}function trigger(e,t,n){return n=n||new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.EventData,(t=t||{}).grid=self,e.notify(t,n,self)}function getEditorLock(){return options.editorLock}function getEditController(){return editController}function getColumnIndex(e){return columnsById[e]}function applyColumnGroupHeaderWidths(){if(treeColumns.hasDepth())for(var e=$groupHeadersL.length-1;e>=0;e--)treeColumns.getColumnsInDepth(e),jquery__WEBPACK_IMPORTED_MODULE_1___default()().add($groupHeadersL[e]).add($groupHeadersR[e]).each((function(e){var t=jquery__WEBPACK_IMPORTED_MODULE_1___default()(this),n=0;t.width(0===e?getHeadersWidthL():getHeadersWidthR()),t.children().each((function(){var e=jquery__WEBPACK_IMPORTED_MODULE_1___default()(this),i=jquery__WEBPACK_IMPORTED_MODULE_1___default()(this).data("column");i.width=0,i.columns.forEach((function(){var e=t.next().children(":eq("+n+++")");i.width+=e.outerWidth()})),e.width(i.width-headerColumnWidthDiff)}))}))}function applyColumnHeaderWidths(){if(initialized){for(var e,t=0,n=$headers.children(),i=columns.length;t<i;t++)e=jquery__WEBPACK_IMPORTED_MODULE_1___default()(n[t]),jQueryNewWidthBehaviour?e.outerWidth()!==columns[t].width&&e.outerWidth(columns[t].width):e.width()!==columns[t].width-headerColumnWidthDiff&&e.width(columns[t].width-headerColumnWidthDiff);updateColumnCaches()}}function applyColumnWidths(){for(var e,t,n=0,i=0;i<columns.length;i++)e=columns[i].width,(t=getColumnCssRules(i)).left.style.left=n+"px",t.right.style.right=(-1!=options.frozenColumn&&i>options.frozenColumn?canvasWidthR:canvasWidthL)-n-e+"px",options.frozenColumn==i?n=0:n+=columns[i].width}function setSortColumn(e,t){setSortColumns([{columnId:e,sortAsc:t}])}function setSortColumns(e){sortColumns=e;var t=options.numberedMultiColumnSort&&sortColumns.length>1,n=$headers.children();n.removeClass("slick-header-column-sorted").find(".slick-sort-indicator").removeClass("slick-sort-indicator-asc slick-sort-indicator-desc"),n.find(".slick-sort-indicator-numbered").text(""),jquery__WEBPACK_IMPORTED_MODULE_1___default().each(sortColumns,(function(e,i){null==i.sortAsc&&(i.sortAsc=!0);var r=getColumnIndex(i.columnId);null!=r&&(n.eq(r).addClass("slick-header-column-sorted").find(".slick-sort-indicator").addClass(i.sortAsc?"slick-sort-indicator-asc":"slick-sort-indicator-desc"),t&&n.eq(r).find(".slick-sort-indicator-numbered").text(e+1))}))}function getSortColumns(){return sortColumns}function handleSelectedRangesChanged(e,t){var n=selectedRows.slice(0);selectedRows=[];for(var i={},r=0;r<t.length;r++)for(var o=t[r].fromRow;o<=t[r].toRow;o++){i[o]||(selectedRows.push(o),i[o]={});for(var a=t[r].fromCell;a<=t[r].toCell;a++)canCellBeSelected(o,a)&&(i[o][columns[a].id]=options.selectedCellCssClass)}setCellCssStyles(options.selectedCellCssClass,i),simpleArrayEquals(n,selectedRows)&&trigger(self.onSelectedRowsChanged,{rows:getSelectedRows(),previousSelectedRows:n},e)}function simpleArrayEquals(e,t){return Array.isArray(e)&&Array.isArray(t)&&t.sort().toString()!==e.sort().toString()}function getColumns(){return columns}function updateColumnCaches(){columnPosLeft=[],columnPosRight=[];for(var e=0,t=0,n=columns.length;t<n;t++)columnPosLeft[t]=e,columnPosRight[t]=e+columns[t].width,options.frozenColumn==t?e=0:e+=columns[t].width}function updateColumnProps(){columnsById={};for(var e=0;e<columns.length;e++){columns[e].width&&(columns[e].widthRequest=columns[e].width);var t=columns[e]=jquery__WEBPACK_IMPORTED_MODULE_1___default().extend({},columnDefaults,columns[e]);t.autoSize=jquery__WEBPACK_IMPORTED_MODULE_1___default().extend({},columnAutosizeDefaults,t.autoSize),columnsById[t.id]=e,t.minWidth&&t.width<t.minWidth&&(t.width=t.minWidth),t.maxWidth&&t.width>t.maxWidth&&(t.width=t.maxWidth),t.resizable}}function setColumns(e){var t=new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.TreeColumns(e);columns=t.hasDepth()?(treeColumns=t).extractColumns():e,updateColumnProps(),updateColumnCaches(),initialized&&(setPaneVisibility(),setOverflow(),invalidateAllRows(),createColumnHeaders(),createColumnGroupHeaders(),createColumnFooter(),removeCssRules(),createCssRules(),resizeCanvas(),updateCanvasWidth(),applyColumnHeaderWidths(),applyColumnWidths(),handleScroll())}function getOptions(){return options}function setOptions(e,t,n,i){if(getEditorLock().commitCurrentEdit()){makeActiveCellNormal(),void 0!==e.showColumnHeader&&setColumnHeaderVisibility(e.showColumnHeader),options.enableAddRow!==e.enableAddRow&&invalidateRow(getDataLength());var r=jquery__WEBPACK_IMPORTED_MODULE_1___default().extend(!0,{},options);if(options=jquery__WEBPACK_IMPORTED_MODULE_1___default().extend(options,e),trigger(self.onSetOptions,{optionsBefore:r,optionsAfter:options}),validateAndEnforceOptions(),$viewport.css("overflow-y",options.autoHeight?"hidden":"auto"),t||render(),setFrozenOptions(),setScroller(),i||setOverflow(),zombieRowNodeFromLastMouseWheelEvent=null,n||setColumns(treeColumns.extractColumns()),options.enableMouseWheelScrollHandler&&$viewport&&jQuery.fn.mousewheel){var o=jquery__WEBPACK_IMPORTED_MODULE_1___default()._data($viewport[0],"events");o&&o.mousewheel||$viewport.on("mousewheel",handleMouseWheel)}else!1===options.enableMouseWheelScrollHandler&&$viewport.off("mousewheel")}}function validateAndEnforceOptions(){options.autoHeight&&(options.leaveSpaceForNewRows=!1),options.forceFitColumns&&(options.autosizeColsMode=_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.GridAutosizeColsMode.LegacyForceFit,console.log("forceFitColumns option is deprecated - use autosizeColsMode"))}function setData(e,t){data=e,invalidateAllRows(),updateRowCount(),t&&scrollTo(0)}function getData(){return data}function getDataLength(){return data.getLength?data.getLength():data&&data.length||0}function getDataLengthIncludingAddNew(){return getDataLength()+(!options.enableAddRow||pagingActive&&!pagingIsLastPage?0:1)}function getDataItem(e){return data.getItem?data.getItem(e):data[e]}function getTopPanel(){return $topPanel[0]}function setTopPanelVisibility(e,t){var n=!1!==t;options.showTopPanel!=e&&(options.showTopPanel=e,e?n?$topPanelScroller.slideDown("fast",resizeCanvas):($topPanelScroller.show(),resizeCanvas()):n?$topPanelScroller.slideUp("fast",resizeCanvas):($topPanelScroller.hide(),resizeCanvas()))}function setHeaderRowVisibility(e,t){var n=!1!==t;options.showHeaderRow!=e&&(options.showHeaderRow=e,e?n?$headerRowScroller.slideDown("fast",resizeCanvas):($headerRowScroller.show(),resizeCanvas()):n?$headerRowScroller.slideUp("fast",resizeCanvas):($headerRowScroller.hide(),resizeCanvas()))}function setColumnHeaderVisibility(e,t){options.showColumnHeader!=e&&(options.showColumnHeader=e,e?t?$headerScroller.slideDown("fast",resizeCanvas):($headerScroller.show(),resizeCanvas()):t?$headerScroller.slideUp("fast",resizeCanvas):($headerScroller.hide(),resizeCanvas()))}function setFooterRowVisibility(e,t){var n=!1!==t;options.showFooterRow!=e&&(options.showFooterRow=e,e?n?$footerRowScroller.slideDown("fast",resizeCanvas):($footerRowScroller.show(),resizeCanvas()):n?$footerRowScroller.slideUp("fast",resizeCanvas):($footerRowScroller.hide(),resizeCanvas()))}function setPreHeaderPanelVisibility(e,t){var n=!1!==t;options.showPreHeaderPanel!=e&&(options.showPreHeaderPanel=e,e?n?($preHeaderPanelScroller.slideDown("fast",resizeCanvas),$preHeaderPanelScrollerR.slideDown("fast",resizeCanvas)):($preHeaderPanelScroller.show(),$preHeaderPanelScrollerR.show(),resizeCanvas()):n?($preHeaderPanelScroller.slideUp("fast",resizeCanvas),$preHeaderPanelScrollerR.slideUp("fast",resizeCanvas)):($preHeaderPanelScroller.hide(),$preHeaderPanelScrollerR.hide(),resizeCanvas()))}function getContainerNode(){return $container.get(0)}function getRowTop(e){return options.rowHeight*e-offset}function getRowFromPosition(e){return Math.floor((e+offset)/options.rowHeight)}function scrollTo(e){e=Math.max(e,0),e=Math.min(e,th-$viewportScrollContainerY.height()+(viewportHasHScroll||hasFrozenColumns()?scrollbarDimensions.height:0));var t=offset;page=Math.min(n-1,Math.floor(e/ph));var i=e-(offset=Math.round(page*cj));offset!=t&&(cleanupRows(getVisibleRange(i)),updateRowPositions()),prevScrollTop!=i&&(vScrollDir=prevScrollTop+t<i+offset?1:-1,lastRenderedScrollTop=scrollTop=prevScrollTop=i,hasFrozenColumns()&&($viewportTopL[0].scrollTop=i),hasFrozenRows&&($viewportBottomL[0].scrollTop=$viewportBottomR[0].scrollTop=i),$viewportScrollContainerY[0].scrollTop=i,trigger(self.onViewportChanged,{}))}function defaultFormatter(e,t,n,i,r,o){return null==n?"":(n+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function getFormatter(e,t){var n=data.getItemMetadata&&data.getItemMetadata(e),i=n&&n.columns&&(n.columns[t.id]||n.columns[getColumnIndex(t.id)]);return i&&i.formatter||n&&n.formatter||t.formatter||options.formatterFactory&&options.formatterFactory.getFormatter(t)||options.defaultFormatter}function getEditor(e,t){var n=columns[t],i=data.getItemMetadata&&data.getItemMetadata(e),r=i&&i.columns;return r&&r[n.id]&&void 0!==r[n.id].editor?r[n.id].editor:r&&r[t]&&void 0!==r[t].editor?r[t].editor:n.editor||options.editorFactory&&options.editorFactory.getEditor(n)}function getDataItemValueForColumn(e,t){return options.dataItemColumnValueExtractor?options.dataItemColumnValueExtractor(e,t):e[t.field]}function appendRowHtml(e,t,n,i,r){var o=getDataItem(n),a=n<r&&!o,s="slick-row"+(hasFrozenRows&&n<=options.frozenRow?" frozen":"")+(a?" loading":"")+(n===activeRow&&options.showCellSelection?" active":"")+(n%2==1?" odd":" even");o||(s+=" "+options.addNewRowCssClass);var l=data.getItemMetadata&&data.getItemMetadata(n);l&&l.cssClasses&&(s+=" "+l.cssClasses);var c,h,u=getFrozenRowOffset(n),f="<div class='ui-widget-content "+s+"' style='top:"+(getRowTop(n)-u)+"px'>";e.push(f),hasFrozenColumns()&&t.push(f);for(var d=0,p=columns.length;d<p;d++){if(h=columns[d],c=1,l&&l.columns){var g=l.columns[h.id]||l.columns[d];"*"===(c=g&&g.colspan||1)&&(c=p-d)}if(columnPosRight[Math.min(p-1,d+c-1)]>i.leftPx){if(!h.alwaysRenderColumn&&columnPosLeft[d]>i.rightPx)break;hasFrozenColumns()&&d>options.frozenColumn?appendCellHtml(t,n,d,c,o):appendCellHtml(e,n,d,c,o)}else(h.alwaysRenderColumn||hasFrozenColumns()&&d<=options.frozenColumn)&&appendCellHtml(e,n,d,c,o);c>1&&(d+=c-1)}e.push("</div>"),hasFrozenColumns()&&t.push("</div>")}function appendCellHtml(e,t,n,i,r){var o=columns[n],a="slick-cell l"+n+" r"+Math.min(columns.length-1,n+i-1)+(o.cssClass?" "+o.cssClass:"");for(var s in hasFrozenColumns()&&n<=options.frozenColumn&&(a+=" frozen"),t===activeRow&&n===activeCell&&options.showCellSelection&&(a+=" active"),cellCssClasses)cellCssClasses[s][t]&&cellCssClasses[s][t][o.id]&&(a+=" "+cellCssClasses[s][t][o.id]);var l=null,c="";r&&(l=getDataItemValueForColumn(r,o),null==(c=getFormatter(t,o)(t,n,l,o,r,self))&&(c=""));var h=trigger(self.onBeforeAppendCell,{row:t,cell:n,value:l,dataContext:r})||"";h+=c&&c.addClasses?(h?" ":"")+c.addClasses:"";var u=c&&c.toolTip?"title='"+c.toolTip+"'":"",f="";if(o.hasOwnProperty("cellAttrs")&&o.cellAttrs instanceof Object)for(var s in o.cellAttrs)o.cellAttrs.hasOwnProperty(s)&&(f+=" "+s+'="'+o.cellAttrs[s]+'" ');e.push("<div class='"+a+(h?" "+h:"")+"' "+u+f+">"),r&&e.push("[object Object]"!==Object.prototype.toString.call(c)?c:c.text),e.push("</div>"),rowsCache[t].cellRenderQueue.push(n),rowsCache[t].cellColSpans[n]=i}function cleanupRows(e){for(var t in rowsCache){var n=!0;hasFrozenRows&&(options.frozenBottom&&t>=actualFrozenRow||!options.frozenBottom&&t<=actualFrozenRow)&&(n=!1),(t=parseInt(t,10))!==activeRow&&(t<e.top||t>e.bottom)&&n&&removeRowFromCache(t)}options.enableAsyncPostRenderCleanup&&startPostProcessingCleanup()}function invalidate(){updateRowCount(),invalidateAllRows(),render()}function invalidateAllRows(){for(var e in currentEditor&&makeActiveCellNormal(),rowsCache)removeRowFromCache(e);options.enableAsyncPostRenderCleanup&&startPostProcessingCleanup()}function queuePostProcessedRowForCleanup(e,t,n){for(var i in postProcessgroupId++,t)t.hasOwnProperty(i)&&postProcessedCleanupQueue.push({actionType:"C",groupId:postProcessgroupId,node:e.cellNodesByColumnIdx[0|i],columnIdx:0|i,rowIdx:n});postProcessedCleanupQueue.push({actionType:"R",groupId:postProcessgroupId,node:e.rowNode}),jquery__WEBPACK_IMPORTED_MODULE_1___default()(e.rowNode).detach()}function queuePostProcessedCellForCleanup(e,t,n){postProcessedCleanupQueue.push({actionType:"C",groupId:postProcessgroupId,node:e,columnIdx:t,rowIdx:n}),jquery__WEBPACK_IMPORTED_MODULE_1___default()(e).detach()}function removeRowFromCache(e){var t=rowsCache[e];t&&(rowNodeFromLastMouseWheelEvent==t.rowNode[0]||hasFrozenColumns()&&rowNodeFromLastMouseWheelEvent==t.rowNode[1]?(t.rowNode.hide(),zombieRowNodeFromLastMouseWheelEvent=t.rowNode):t.rowNode.each((function(){this.parentElement.removeChild(this)})),delete rowsCache[e],delete postProcessedRows[e],renderedRows--,counter_rows_removed++)}function invalidateRows(e){var t,n;if(e&&e.length){for(vScrollDir=0,n=e.length,t=0;t<n;t++)currentEditor&&activeRow===e[t]&&makeActiveCellNormal(),rowsCache[e[t]]&&removeRowFromCache(e[t]);options.enableAsyncPostRenderCleanup&&startPostProcessingCleanup()}}function invalidateRow(e){(e||0===e)&&invalidateRows([e])}function applyFormatResultToCellNode(e,t,n){null==e&&(e=""),"[object Object]"===Object.prototype.toString.call(e)?(t.innerHTML=e.text,e.removeClasses&&!n&&jquery__WEBPACK_IMPORTED_MODULE_1___default()(t).removeClass(e.removeClasses),e.addClasses&&jquery__WEBPACK_IMPORTED_MODULE_1___default()(t).addClass(e.addClasses),e.toolTip&&jquery__WEBPACK_IMPORTED_MODULE_1___default()(t).attr("title",e.toolTip)):t.innerHTML=e}function updateCell(e,t){var n=getCellNode(e,t);if(n){var i=columns[t],r=getDataItem(e);currentEditor&&activeRow===e&&activeCell===t?currentEditor.loadValue(r):(applyFormatResultToCellNode(r?getFormatter(e,i)(e,t,getDataItemValueForColumn(r,i),i,r,self):"",n),invalidatePostProcessingResults(e))}}function updateRow(e){var t=rowsCache[e];if(t){ensureCellNodesInRowsCache(e);var n=getDataItem(e);for(var i in t.cellNodesByColumnIdx)if(t.cellNodesByColumnIdx.hasOwnProperty(i)){var r=columns[i|=0],o=t.cellNodesByColumnIdx[i][0];e===activeRow&&i===activeCell&&currentEditor?currentEditor.loadValue(n):n?applyFormatResultToCellNode(getFormatter(e,r)(e,i,getDataItemValueForColumn(n,r),r,n,self),o):o.innerHTML=""}invalidatePostProcessingResults(e)}}function getViewportHeight(){if(options.autoHeight&&-1==options.frozenColumn||(topPanelH=options.showTopPanel?options.topPanelHeight+getVBoxDelta($topPanelScroller):0,headerRowH=options.showHeaderRow?options.headerRowHeight+getVBoxDelta($headerRowScroller):0,footerRowH=options.showFooterRow?options.footerRowHeight+getVBoxDelta($footerRowScroller):0),options.autoHeight){var e=$paneHeaderL.outerHeight();e+=options.showHeaderRow?options.headerRowHeight+getVBoxDelta($headerRowScroller):0,e+=options.showFooterRow?options.footerRowHeight+getVBoxDelta($footerRowScroller):0,e+=getCanvasWidth()>viewportW?scrollbarDimensions.height:0,viewportH=options.rowHeight*getDataLengthIncludingAddNew()+(-1==options.frozenColumn?e:0)}else{var t=options.showColumnHeader?parseFloat(jquery__WEBPACK_IMPORTED_MODULE_1___default().css($headerScroller[0],"height"))+getVBoxDelta($headerScroller):0,n=options.createPreHeaderPanel&&options.showPreHeaderPanel?options.preHeaderPanelHeight+getVBoxDelta($preHeaderPanelScroller):0;viewportH=parseFloat(jquery__WEBPACK_IMPORTED_MODULE_1___default().css($container[0],"height",!0))-parseFloat(jquery__WEBPACK_IMPORTED_MODULE_1___default().css($container[0],"paddingTop",!0))-parseFloat(jquery__WEBPACK_IMPORTED_MODULE_1___default().css($container[0],"paddingBottom",!0))-t-topPanelH-headerRowH-footerRowH-n}return numVisibleRows=Math.ceil(viewportH/options.rowHeight),viewportH}function getViewportWidth(){viewportW=parseFloat($container.width())}function resizeCanvas(){if(initialized){paneTopH=0,paneBottomH=0,viewportTopH=0,viewportBottomH=0,getViewportWidth(),getViewportHeight(),hasFrozenRows?options.frozenBottom?(paneTopH=viewportH-frozenRowsHeight-scrollbarDimensions.height,paneBottomH=frozenRowsHeight+scrollbarDimensions.height):(paneTopH=frozenRowsHeight,paneBottomH=viewportH-frozenRowsHeight):paneTopH=viewportH,paneTopH+=topPanelH+headerRowH+footerRowH,hasFrozenColumns()&&options.autoHeight&&(paneTopH+=scrollbarDimensions.height),viewportTopH=paneTopH-topPanelH-headerRowH-footerRowH,options.autoHeight&&(hasFrozenColumns()&&$container.height(paneTopH+parseFloat(jquery__WEBPACK_IMPORTED_MODULE_1___default().css($headerScrollerL[0],"height"))),$paneTopL.css("position","relative")),$paneTopL.css({top:$paneHeaderL.height()||(options.showHeaderRow?options.headerRowHeight:0)+(options.showPreHeaderPanel?options.preHeaderPanelHeight:0),height:paneTopH});var e=$paneTopL.position().top+paneTopH;options.autoHeight||$viewportTopL.height(viewportTopH),hasFrozenColumns()?($paneTopR.css({top:$paneHeaderL.height(),height:paneTopH}),$viewportTopR.height(viewportTopH),hasFrozenRows&&($paneBottomL.css({top:e,height:paneBottomH}),$paneBottomR.css({top:e,height:paneBottomH}),$viewportBottomR.height(paneBottomH))):hasFrozenRows&&($paneBottomL.css({width:"100%",height:paneBottomH}),$paneBottomL.css("top",e)),hasFrozenRows?($viewportBottomL.height(paneBottomH),options.frozenBottom?($canvasBottomL.height(frozenRowsHeight),hasFrozenColumns()&&$canvasBottomR.height(frozenRowsHeight)):($canvasTopL.height(frozenRowsHeight),hasFrozenColumns()&&$canvasTopR.height(frozenRowsHeight))):$viewportTopR.height(viewportTopH),scrollbarDimensions&&scrollbarDimensions.width||(scrollbarDimensions=measureScrollbar()),options.autosizeColsMode===_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.GridAutosizeColsMode.LegacyForceFit&&autosizeColumns(),updateRowCount(),handleScroll(),lastRenderedScrollLeft=-1,render()}}function updatePagingStatusFromView(e){pagingActive=0!==e.pageSize,pagingIsLastPage=e.pageNum==e.totalPages-1}function updateRowCount(){if(initialized){var e=getDataLength(),t=getDataLengthIncludingAddNew(),i=0,r=hasFrozenRows&&!options.frozenBottom?$canvasBottomL.height():$canvasTopL.height();i=hasFrozenRows?getDataLength()-options.frozenRow:t+(options.leaveSpaceForNewRows?numVisibleRows-1:0);var o=$viewportScrollContainerY.height(),a=viewportHasVScroll;viewportHasVScroll=options.alwaysShowVerticalScroll||!options.autoHeight&&i*options.rowHeight>o,makeActiveCellNormal();var s=e-1;for(var l in rowsCache)l>s&&removeRowFromCache(l);options.enableAsyncPostRenderCleanup&&startPostProcessingCleanup(),activeCellNode&&activeRow>s&&resetActiveCell(),r=h,options.autoHeight?h=options.rowHeight*i:(th=Math.max(options.rowHeight*i,o-scrollbarDimensions.height))<maxSupportedCssHeight?(h=ph=th,n=1,cj=0):(ph=(h=maxSupportedCssHeight)/100,n=Math.floor(th/ph),cj=(th-h)/(n-1)),h!==r&&(hasFrozenRows&&!options.frozenBottom?($canvasBottomL.css("height",h),hasFrozenColumns()&&$canvasBottomR.css("height",h)):($canvasTopL.css("height",h),$canvasTopR.css("height",h)),scrollTop=$viewportScrollContainerY[0].scrollTop);var c=scrollTop+offset<=th-o;0==th||0==scrollTop?page=offset=0:scrollTo(c?scrollTop+offset:th-o),h!=r&&options.autoHeight&&resizeCanvas(),options.autosizeColsMode===_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.GridAutosizeColsMode.LegacyForceFit&&a!=viewportHasVScroll&&autosizeColumns(),updateCanvasWidth(!1)}}function getVisibleRange(e,t){return null==e&&(e=scrollTop),null==t&&(t=scrollLeft),{top:getRowFromPosition(e),bottom:getRowFromPosition(e+viewportH)+1,leftPx:t,rightPx:t+viewportW}}function getRenderedRange(e,t){var n=getVisibleRange(e,t),i=Math.round(viewportH/options.rowHeight),r=options.minRowBuffer;return-1==vScrollDir?(n.top-=i,n.bottom+=r):1==vScrollDir?(n.top-=r,n.bottom+=i):(n.top-=r,n.bottom+=r),n.top=Math.max(0,n.top),n.bottom=Math.min(getDataLengthIncludingAddNew()-1,n.bottom),n.leftPx-=viewportW,n.rightPx+=viewportW,n.leftPx=Math.max(0,n.leftPx),n.rightPx=Math.min(canvasWidth,n.rightPx),n}function ensureCellNodesInRowsCache(e){var t=rowsCache[e];if(t&&t.cellRenderQueue.length)for(var n=t.rowNode.children().last();t.cellRenderQueue.length;){var i=t.cellRenderQueue.pop();t.cellNodesByColumnIdx[i]=n,0===(n=n.prev()).length&&(n=jquery__WEBPACK_IMPORTED_MODULE_1___default()(t.rowNode[0]).children().last())}}function cleanUpCells(e,t){if(!hasFrozenRows||!(options.frozenBottom&&t>actualFrozenRow||t<=actualFrozenRow)){var n,i=rowsCache[t],r=[];for(var o in i.cellNodesByColumnIdx)if(i.cellNodesByColumnIdx.hasOwnProperty(o)&&!((o|=0)<=options.frozenColumn||Array.isArray(columns)&&columns[o]&&columns[o].alwaysRenderColumn)){var a=i.cellColSpans[o];(columnPosLeft[o]>e.rightPx||columnPosRight[Math.min(columns.length-1,o+a-1)]<e.leftPx)&&(t==activeRow&&o==activeCell||r.push(o))}for(;null!=(n=r.pop());)i.cellNodesByColumnIdx[n][0].parentElement.removeChild(i.cellNodesByColumnIdx[n][0]),delete i.cellColSpans[n],delete i.cellNodesByColumnIdx[n],postProcessedRows[t]&&delete postProcessedRows[t][n]}}function cleanUpAndRenderCells(e){for(var t,n,i,r=[],o=[],a=e.top,s=e.bottom;a<=s;a++)if(t=rowsCache[a]){ensureCellNodesInRowsCache(a),cleanUpCells(e,a),n=0;var l=data.getItemMetadata&&data.getItemMetadata(a);l=l&&l.columns;for(var c=getDataItem(a),h=0,u=columns.length;h<u&&!(columnPosLeft[h]>e.rightPx);h++)if(null==(i=t.cellColSpans[h])){if(i=1,l){var f=l[columns[h].id]||l[h];"*"===(i=f&&f.colspan||1)&&(i=u-h)}columnPosRight[Math.min(u-1,h+i-1)]>e.leftPx&&(appendCellHtml(r,a,h,i,c),n++),h+=i>1?i-1:0}else h+=i>1?i-1:0;n&&o.push(a)}if(r.length){var d,p,g=__doc__.createElement("div");for(g.innerHTML=r.join("");null!=(d=o.pop());){var m;for(t=rowsCache[d];null!=(m=t.cellRenderQueue.pop());)p=g.lastChild,hasFrozenColumns()&&m>options.frozenColumn?t.rowNode[1].appendChild(p):t.rowNode[0].appendChild(p),t.cellNodesByColumnIdx[m]=jquery__WEBPACK_IMPORTED_MODULE_1___default()(p)}}}function renderRows(e){for(var t=[],n=[],i=[],r=!1,o=getDataLength(),a=e.top,s=e.bottom;a<=s;a++)rowsCache[a]||hasFrozenRows&&options.frozenBottom&&a==getDataLength()||(renderedRows++,i.push(a),rowsCache[a]={rowNode:null,cellColSpans:[],cellNodesByColumnIdx:[],cellRenderQueue:[]},appendRowHtml(t,n,a,e,o),activeCellNode&&activeRow===a&&(r=!0),counter_rows_rendered++);if(i.length){var l=__doc__.createElement("div"),c=__doc__.createElement("div");for(l.innerHTML=t.join(""),c.innerHTML=n.join(""),a=0,s=i.length;a<s;a++)hasFrozenRows&&i[a]>=actualFrozenRow?hasFrozenColumns()?rowsCache[i[a]].rowNode=jquery__WEBPACK_IMPORTED_MODULE_1___default()().add(jquery__WEBPACK_IMPORTED_MODULE_1___default()(l.firstChild).appendTo($canvasBottomL)).add(jquery__WEBPACK_IMPORTED_MODULE_1___default()(c.firstChild).appendTo($canvasBottomR)):rowsCache[i[a]].rowNode=jquery__WEBPACK_IMPORTED_MODULE_1___default()().add(jquery__WEBPACK_IMPORTED_MODULE_1___default()(l.firstChild).appendTo($canvasBottomL)):hasFrozenColumns()?rowsCache[i[a]].rowNode=jquery__WEBPACK_IMPORTED_MODULE_1___default()().add(jquery__WEBPACK_IMPORTED_MODULE_1___default()(l.firstChild).appendTo($canvasTopL)).add(jquery__WEBPACK_IMPORTED_MODULE_1___default()(c.firstChild).appendTo($canvasTopR)):rowsCache[i[a]].rowNode=jquery__WEBPACK_IMPORTED_MODULE_1___default()().add(jquery__WEBPACK_IMPORTED_MODULE_1___default()(l.firstChild).appendTo($canvasTopL));r&&(activeCellNode=getCellNode(activeRow,activeCell))}}function startPostProcessing(){options.enableAsyncPostRender&&(clearTimeout(h_postrender),h_postrender=setTimeout(asyncPostProcessRows,options.asyncPostRenderDelay))}function startPostProcessingCleanup(){options.enableAsyncPostRenderCleanup&&(clearTimeout(h_postrenderCleanup),h_postrenderCleanup=setTimeout(asyncPostProcessCleanupRows,options.asyncPostRenderCleanupDelay))}function invalidatePostProcessingResults(e){for(var t in postProcessedRows[e])postProcessedRows[e].hasOwnProperty(t)&&(postProcessedRows[e][t]="C");postProcessFromRow=Math.min(postProcessFromRow,e),postProcessToRow=Math.max(postProcessToRow,e),startPostProcessing()}function updateRowPositions(){for(var e in rowsCache){var t=e?parseInt(e):0;rowsCache[t].rowNode[0].style.top=getRowTop(t)+"px"}}function render(){if(initialized){scrollThrottle.dequeue();var e=getVisibleRange(),t=getRenderedRange();if(cleanupRows(t),lastRenderedScrollLeft!=scrollLeft){if(hasFrozenRows){var n=jQuery.extend(!0,{},t);options.frozenBottom?(n.top=actualFrozenRow,n.bottom=getDataLength()):(n.top=0,n.bottom=options.frozenRow),cleanUpAndRenderCells(n)}cleanUpAndRenderCells(t)}renderRows(t),hasFrozenRows&&(options.frozenBottom?renderRows({top:actualFrozenRow,bottom:getDataLength()-1,leftPx:t.leftPx,rightPx:t.rightPx}):renderRows({top:0,bottom:options.frozenRow-1,leftPx:t.leftPx,rightPx:t.rightPx})),postProcessFromRow=e.top,postProcessToRow=Math.min(getDataLengthIncludingAddNew()-1,e.bottom),startPostProcessing(),lastRenderedScrollTop=scrollTop,lastRenderedScrollLeft=scrollLeft,h_render=null,trigger(self.onRendered,{startRow:e.top,endRow:e.bottom,grid:self})}}function handleHeaderScroll(){handleElementScroll($headerScrollContainer[0])}function handleHeaderRowScroll(){var e=$headerRowScrollContainer[0].scrollLeft;e!=$viewportScrollContainerX[0].scrollLeft&&($viewportScrollContainerX[0].scrollLeft=e)}function handleFooterRowScroll(){var e=$footerRowScrollContainer[0].scrollLeft;e!=$viewportScrollContainerX[0].scrollLeft&&($viewportScrollContainerX[0].scrollLeft=e)}function handlePreHeaderPanelScroll(){handleElementScroll($preHeaderPanelScroller[0])}function handleElementScroll(e){var t=e.scrollLeft;t!=$viewportScrollContainerX[0].scrollLeft&&($viewportScrollContainerX[0].scrollLeft=t)}function handleScroll(){return scrollTop=$viewportScrollContainerY[0].scrollTop,scrollLeft=$viewportScrollContainerX[0].scrollLeft,_handleScroll(!1)}function _handleScroll(e){var t=$viewportScrollContainerY[0].scrollHeight-$viewportScrollContainerY[0].clientHeight,i=$viewportScrollContainerY[0].scrollWidth-$viewportScrollContainerY[0].clientWidth;t=Math.max(0,t),i=Math.max(0,i),scrollTop>t&&(scrollTop=t),scrollLeft>i&&(scrollLeft=i);var r=Math.abs(scrollTop-prevScrollTop),o=Math.abs(scrollLeft-prevScrollLeft);if(o&&(prevScrollLeft=scrollLeft,$viewportScrollContainerX[0].scrollLeft=scrollLeft,$headerScrollContainer[0].scrollLeft=scrollLeft,$topPanelScroller[0].scrollLeft=scrollLeft,$headerRowScrollContainer[0].scrollLeft=scrollLeft,options.createFooterRow&&($footerRowScrollContainer[0].scrollLeft=scrollLeft),options.createPreHeaderPanel&&(hasFrozenColumns()?$preHeaderPanelScrollerR[0].scrollLeft=scrollLeft:$preHeaderPanelScroller[0].scrollLeft=scrollLeft),hasFrozenColumns()?hasFrozenRows&&($viewportTopR[0].scrollLeft=scrollLeft):hasFrozenRows&&($viewportTopL[0].scrollLeft=scrollLeft)),r)if(vScrollDir=prevScrollTop<scrollTop?1:-1,prevScrollTop=scrollTop,e&&($viewportScrollContainerY[0].scrollTop=scrollTop),hasFrozenColumns()&&(hasFrozenRows&&!options.frozenBottom?$viewportBottomL[0].scrollTop=scrollTop:$viewportTopL[0].scrollTop=scrollTop),r<viewportH)scrollTo(scrollTop+offset);else{var a=offset;page=h==viewportH?0:Math.min(n-1,Math.floor(scrollTop*((th-viewportH)/(h-viewportH))*(1/ph))),a!=(offset=Math.round(page*cj))&&invalidateAllRows()}if(o||r){var s=Math.abs(lastRenderedScrollLeft-scrollLeft),l=Math.abs(lastRenderedScrollTop-scrollTop);(s>20||l>20)&&(options.forceSyncScrolling||l<viewportH&&s<viewportW?render():scrollThrottle.enqueue(),trigger(self.onViewportChanged,{}))}return trigger(self.onScroll,{scrollLeft,scrollTop}),!(!o&&!r)}function ActionThrottle(e,t){var n=!1,i=!1;function r(){i=!1}function o(){n=!0,setTimeout(a,t),e()}function a(){i?(r(),o()):n=!1}return{enqueue:function(){n?i=!0:o()},dequeue:r}}function asyncPostProcessRows(){for(var e=getDataLength();postProcessFromRow<=postProcessToRow;){var t=vScrollDir>=0?postProcessFromRow++:postProcessToRow--,n=rowsCache[t];if(n&&!(t>=e)){for(var i in postProcessedRows[t]||(postProcessedRows[t]={}),ensureCellNodesInRowsCache(t),n.cellNodesByColumnIdx)if(n.cellNodesByColumnIdx.hasOwnProperty(i)){var r=columns[i|=0],o=postProcessedRows[t][i];if(r.asyncPostRender&&"R"!==o){var a=n.cellNodesByColumnIdx[i];a&&r.asyncPostRender(a,t,getDataItem(t),r,"C"===o),postProcessedRows[t][i]="R"}}return void(h_postrender=setTimeout(asyncPostProcessRows,options.asyncPostRenderDelay))}}}function asyncPostProcessCleanupRows(){if(postProcessedCleanupQueue.length>0){for(var e=postProcessedCleanupQueue[0].groupId;postProcessedCleanupQueue.length>0&&postProcessedCleanupQueue[0].groupId==e;){var t=postProcessedCleanupQueue.shift();if("R"==t.actionType&&jquery__WEBPACK_IMPORTED_MODULE_1___default()(t.node).remove(),"C"==t.actionType){var n=columns[t.columnIdx];n.asyncPostRenderCleanup&&t.node&&n.asyncPostRenderCleanup(t.node,t.rowIdx,n)}}h_postrenderCleanup=setTimeout(asyncPostProcessCleanupRows,options.asyncPostRenderCleanupDelay)}}function updateCellCssStylesOnRenderedRows(e,t){var n,i,r,o;for(var a in rowsCache){if(o=t&&t[a],r=e&&e[a],o)for(i in o)r&&o[i]==r[i]||(n=getCellNode(a,getColumnIndex(i)))&&jquery__WEBPACK_IMPORTED_MODULE_1___default()(n).removeClass(o[i]);if(r)for(i in r)o&&o[i]==r[i]||(n=getCellNode(a,getColumnIndex(i)))&&jquery__WEBPACK_IMPORTED_MODULE_1___default()(n).addClass(r[i])}}function addCellCssStyles(e,t){if(cellCssClasses[e])throw new Error("SlickGrid addCellCssStyles: cell CSS hash with key '"+e+"' already exists.");cellCssClasses[e]=t,updateCellCssStylesOnRenderedRows(t,null),trigger(self.onCellCssStylesChanged,{key:e,hash:t,grid:self})}function removeCellCssStyles(e){cellCssClasses[e]&&(updateCellCssStylesOnRenderedRows(null,cellCssClasses[e]),delete cellCssClasses[e],trigger(self.onCellCssStylesChanged,{key:e,hash:null,grid:self}))}function setCellCssStyles(e,t){var n=cellCssClasses[e];cellCssClasses[e]=t,updateCellCssStylesOnRenderedRows(t,n),trigger(self.onCellCssStylesChanged,{key:e,hash:t,grid:self})}function getCellCssStyles(e){return cellCssClasses[e]}function flashCell(e,t,n){n=n||100,rowsCache[e]&&function e(t,i){i&&setTimeout((function(){t.queue((function(){t.toggleClass(options.cellFlashingCssClass).dequeue(),e(t,i-1)}))}),n)}(jquery__WEBPACK_IMPORTED_MODULE_1___default()(getCellNode(e,t)),4)}function handleMouseWheel(e,t,n,i){var r=jquery__WEBPACK_IMPORTED_MODULE_1___default()(e.target).closest(".slick-row"),o=r[0];if(o!=rowNodeFromLastMouseWheelEvent){var a=r.parents(".grid-canvas").hasClass("grid-canvas-left");if(zombieRowNodeFromLastMouseWheelEvent&&zombieRowNodeFromLastMouseWheelEvent[a?0:1]!=o){var s=zombieRowNodeFromLastMouseWheelEvent[a||1==zombieRowNodeFromLastMouseWheelEvent.length?0:1];s.parentElement.removeChild(s),zombieRowNodeFromLastMouseWheelEvent=null}rowNodeFromLastMouseWheelEvent=o}scrollTop=Math.max(0,$viewportScrollContainerY[0].scrollTop-i*options.rowHeight),scrollLeft=$viewportScrollContainerX[0].scrollLeft+10*n,_handleScroll(!0)&&e.preventDefault()}function handleDragInit(e,t){var n=getCellFromEvent(e);if(!n||!cellExists(n.row,n.cell))return!1;var i=trigger(self.onDragInit,t,e);return!!e.isImmediatePropagationStopped()&&i}function handleDragStart(e,t){var n=getCellFromEvent(e);if(!n||!cellExists(n.row,n.cell))return!1;var i=trigger(self.onDragStart,t,e);return!!e.isImmediatePropagationStopped()&&i}function handleDrag(e,t){return trigger(self.onDrag,t,e)}function handleDragEnd(e,t){trigger(self.onDragEnd,t,e)}function handleKeyDown(e){trigger(self.onKeyDown,{row:activeRow,cell:activeCell},e);var t=e.isImmediatePropagationStopped(),n=_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.keyCode;if(!t&&!e.shiftKey&&!e.altKey){if(options.editable&&currentEditor&&currentEditor.keyCaptureList&&currentEditor.keyCaptureList.indexOf(e.which)>-1)return;e.which==n.HOME?t=e.ctrlKey?navigateTop():navigateRowStart():e.which==n.END&&(t=e.ctrlKey?navigateBottom():navigateRowEnd())}if(!t)if(e.shiftKey||e.altKey||e.ctrlKey)e.which!=n.TAB||!e.shiftKey||e.ctrlKey||e.altKey||(t=navigatePrev());else{if(options.editable&&currentEditor&&currentEditor.keyCaptureList&&currentEditor.keyCaptureList.indexOf(e.which)>-1)return;if(e.which==n.ESCAPE){if(!getEditorLock().isActive())return;cancelEditAndSetFocus()}else e.which==n.PAGE_DOWN?(navigatePageDown(),t=!0):e.which==n.PAGE_UP?(navigatePageUp(),t=!0):e.which==n.LEFT?t=navigateLeft():e.which==n.RIGHT?t=navigateRight():e.which==n.UP?t=navigateUp():e.which==n.DOWN?t=navigateDown():e.which==n.TAB?t=navigateNext():e.which==n.ENTER&&(options.editable&&(currentEditor?activeRow===getDataLength()?navigateDown():commitEditAndSetFocus():getEditorLock().commitCurrentEdit()&&makeActiveCellEditable(void 0,void 0,e)),t=!0)}if(t){e.stopPropagation(),e.preventDefault();try{e.originalEvent.keyCode=0}catch(e){}}}function handleClick(e){currentEditor||(e.target!=__doc__.activeElement||jquery__WEBPACK_IMPORTED_MODULE_1___default()(e.target).hasClass("slick-cell"))&&setFocus();var t=getCellFromEvent(e);if(t&&(null===currentEditor||activeRow!=t.row||activeCell!=t.cell)&&(trigger(self.onClick,{row:t.row,cell:t.cell},e),!e.isImmediatePropagationStopped()&&canCellBeActive(t.row,t.cell)&&(!getEditorLock().isActive()||getEditorLock().commitCurrentEdit()))){scrollRowIntoView(t.row,!1);var n=e.target&&e.target.className===_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.preClickClassName,i=columns[t.cell],r=!!(options.editable&&i&&i.editor&&options.suppressActiveCellChangeOnEdit);setActiveCellInternal(getCellNode(t.row,t.cell),null,n,r,e)}}function handleContextMenu(e){var t=jquery__WEBPACK_IMPORTED_MODULE_1___default()(e.target).closest(".slick-cell",$canvas);0!==t.length&&(activeCellNode===t[0]&&null!==currentEditor||trigger(self.onContextMenu,{},e))}function handleDblClick(e){var t=getCellFromEvent(e);!t||null!==currentEditor&&activeRow==t.row&&activeCell==t.cell||(trigger(self.onDblClick,{row:t.row,cell:t.cell},e),e.isImmediatePropagationStopped()||options.editable&&gotoCell(t.row,t.cell,!0,e))}function handleHeaderMouseEnter(e){trigger(self.onHeaderMouseEnter,{column:jquery__WEBPACK_IMPORTED_MODULE_1___default()(this).data("column"),grid:self},e)}function handleHeaderMouseLeave(e){trigger(self.onHeaderMouseLeave,{column:jquery__WEBPACK_IMPORTED_MODULE_1___default()(this).data("column"),grid:self},e)}function handleHeaderContextMenu(e){var t=jquery__WEBPACK_IMPORTED_MODULE_1___default()(e.target).closest(".slick-header-column",".slick-header-columns"),n=t&&t.data("column");trigger(self.onHeaderContextMenu,{column:n},e)}function handleHeaderClick(e){if(!columnResizeDragging){var t=jquery__WEBPACK_IMPORTED_MODULE_1___default()(e.target).closest(".slick-header-column",".slick-header-columns"),n=t&&t.data("column");n&&trigger(self.onHeaderClick,{column:n},e)}}function handleFooterContextMenu(e){var t=jquery__WEBPACK_IMPORTED_MODULE_1___default()(e.target).closest(".slick-footerrow-column",".slick-footerrow-columns"),n=t&&t.data("column");trigger(self.onFooterContextMenu,{column:n},e)}function handleFooterClick(e){var t=jquery__WEBPACK_IMPORTED_MODULE_1___default()(e.target).closest(".slick-footerrow-column",".slick-footerrow-columns"),n=t&&t.data("column");trigger(self.onFooterClick,{column:n},e)}function handleMouseEnter(e){trigger(self.onMouseEnter,{},e)}function handleMouseLeave(e){trigger(self.onMouseLeave,{},e)}function cellExists(e,t){return!(e<0||e>=getDataLength()||t<0||t>=columns.length)}function getCellFromPoint(e,t){for(var n=getRowFromPosition(t),i=0,r=0,o=0;o<columns.length&&r<e;o++)r+=columns[o].width,i++;return i<0&&(i=0),{row:n,cell:i-1}}function getCellFromNode(e){var t=/l\d+/.exec(e.className);if(!t)throw new Error("SlickGrid getCellFromNode: cannot get cell - "+e.className);return parseInt(t[0].substr(1,t[0].length-1),10)}function getRowFromNode(e){for(var t in rowsCache)for(var n in rowsCache[t].rowNode)if(rowsCache[t].rowNode[n]===e)return t?parseInt(t):0;return null}function getFrozenRowOffset(e){return hasFrozenRows?options.frozenBottom?e>=actualFrozenRow?h<viewportTopH?actualFrozenRow*options.rowHeight:h:0:e>=actualFrozenRow?frozenRowsHeight:0:0}function getCellFromEvent(e){var t,n,i=jquery__WEBPACK_IMPORTED_MODULE_1___default()(e.target).closest(".slick-cell",$canvas);if(!i.length)return null;if(t=getRowFromNode(i[0].parentNode),hasFrozenRows){var r=i.parents(".grid-canvas").offset(),o=0;i.parents(".grid-canvas-bottom").length&&(o=options.frozenBottom?$canvasTopL.height():frozenRowsHeight),t=getCellFromPoint(e.clientX-r.left,e.clientY-r.top+o+jquery__WEBPACK_IMPORTED_MODULE_1___default()(__doc__).scrollTop()).row}return n=getCellFromNode(i[0]),null==t||null==n?null:{row:t,cell:n}}function getCellNodeBox(e,t){if(!cellExists(e,t))return null;for(var n=getFrozenRowOffset(e),i=getRowTop(e)-n,r=i+options.rowHeight-1,o=0,a=0;a<t;a++)o+=columns[a].width,options.frozenColumn==a&&(o=0);return{top:i,left:o,bottom:r,right:o+columns[t].width}}function resetActiveCell(){setActiveCellInternal(null,!1)}function setFocus(){-1==tabbingDirection?$focusSink[0].focus():$focusSink2[0].focus()}function scrollCellIntoView(e,t,n){if(scrollRowIntoView(e,n),!(t<=options.frozenColumn)){var i=getColspan(e,t);internalScrollColumnIntoView(columnPosLeft[t],columnPosRight[t+(i>1?i-1:0)])}}function internalScrollColumnIntoView(e,t){var n=scrollLeft+$viewportScrollContainerX.width();e<scrollLeft?($viewportScrollContainerX.scrollLeft(e),handleScroll(),render()):t>n&&($viewportScrollContainerX.scrollLeft(Math.min(e,t-$viewportScrollContainerX[0].clientWidth)),handleScroll(),render())}function scrollColumnIntoView(e){internalScrollColumnIntoView(columnPosLeft[e],columnPosRight[e])}function setActiveCellInternal(e,t,n,i,r){if(null!==activeCellNode&&(makeActiveCellNormal(),jquery__WEBPACK_IMPORTED_MODULE_1___default()(activeCellNode).removeClass("active"),rowsCache[activeRow]&&jquery__WEBPACK_IMPORTED_MODULE_1___default()(rowsCache[activeRow].rowNode).removeClass("active")),null!=(activeCellNode=e)){var o=jquery__WEBPACK_IMPORTED_MODULE_1___default()(activeCellNode),a=o.offset(),s=Math.floor(o.parents(".grid-canvas").offset().top),l=o.parents(".grid-canvas-bottom").length;hasFrozenRows&&l&&(s-=options.frozenBottom?$canvasTopL.height():frozenRowsHeight);var c=getCellFromPoint(a.left,Math.ceil(a.top)-s);activeRow=c.row,activeCell=activePosX=activeCell=activePosX=getCellFromNode(activeCellNode),null==t&&(t=activeRow==getDataLength()||options.autoEdit),options.showCellSelection&&(o.addClass("active"),rowsCache[activeRow]&&jquery__WEBPACK_IMPORTED_MODULE_1___default()(rowsCache[activeRow].rowNode).addClass("active")),options.editable&&t&&isCellPotentiallyEditable(activeRow,activeCell)&&(clearTimeout(h_editorLoader),options.asyncEditorLoading?h_editorLoader=setTimeout((function(){makeActiveCellEditable(void 0,n,r)}),options.asyncEditorLoadDelay):makeActiveCellEditable(void 0,n,r))}else activeRow=activeCell=null;i||trigger(self.onActiveCellChanged,getActiveCell())}function clearTextSelection(){if(__doc__.selection&&__doc__.selection.empty)try{__doc__.selection.empty()}catch(e){}else if(window.getSelection){var e=window.getSelection();e&&e.removeAllRanges&&e.removeAllRanges()}}function isCellPotentiallyEditable(e,t){var n=getDataLength();return!(e<n&&!getDataItem(e)||columns[t].cannotTriggerInsert&&e>=n||!getEditor(e,t))}function makeActiveCellNormal(){if(currentEditor){if(trigger(self.onBeforeCellEditorDestroy,{editor:currentEditor}),currentEditor.destroy(),currentEditor=null,activeCellNode){var e=getDataItem(activeRow);if(jquery__WEBPACK_IMPORTED_MODULE_1___default()(activeCellNode).removeClass("editable invalid"),e){var t=columns[activeCell];applyFormatResultToCellNode(getFormatter(activeRow,t)(activeRow,activeCell,getDataItemValueForColumn(e,t),t,e,self),activeCellNode),invalidatePostProcessingResults(activeRow)}}navigator.userAgent.toLowerCase().match(/msie/)&&clearTextSelection(),getEditorLock().deactivate(editController)}}function makeActiveCellEditable(e,t,n){if(activeCellNode){if(!options.editable)throw new Error("SlickGrid makeActiveCellEditable : should never get called when options.editable is false");if(clearTimeout(h_editorLoader),isCellPotentiallyEditable(activeRow,activeCell)){var i=columns[activeCell],r=getDataItem(activeRow);if(!1!==trigger(self.onBeforeEditCell,{row:activeRow,cell:activeCell,item:r,column:i,target:"grid"})){getEditorLock().activate(editController),jquery__WEBPACK_IMPORTED_MODULE_1___default()(activeCellNode).addClass("editable");var o=e||getEditor(activeRow,activeCell);e||o.suppressClearOnEdit||(activeCellNode.innerHTML="");var a=data.getItemMetadata&&data.getItemMetadata(activeRow),s=(a=a&&a.columns)&&(a[i.id]||a[activeCell]);currentEditor=new o({grid:self,gridPosition:absBox($container[0]),position:absBox(activeCellNode),container:activeCellNode,column:i,columnMetaData:s,item:r||{},event:n,commitChanges:commitEditAndSetFocus,cancelChanges:cancelEditAndSetFocus}),r&&(currentEditor.loadValue(r),t&&currentEditor.preClick&&currentEditor.preClick()),serializedEditorValue=currentEditor.serializeValue(),currentEditor.position&&handleActiveCellPositionChange()}else setFocus()}}}function commitEditAndSetFocus(){getEditorLock().commitCurrentEdit()&&(setFocus(),options.autoEdit&&navigateDown())}function cancelEditAndSetFocus(){getEditorLock().cancelCurrentEdit()&&setFocus()}function absBox(e){var t={top:e.offsetTop,left:e.offsetLeft,bottom:0,right:0,width:jquery__WEBPACK_IMPORTED_MODULE_1___default()(e).outerWidth(),height:jquery__WEBPACK_IMPORTED_MODULE_1___default()(e).outerHeight(),visible:!0};t.bottom=t.top+t.height,t.right=t.left+t.width;for(var n=e.offsetParent;(e=e.parentNode)!=__doc__.body&&null!=e;)t.visible&&e.scrollHeight!=e.offsetHeight&&"visible"!=jquery__WEBPACK_IMPORTED_MODULE_1___default()(e).css("overflowY")&&(t.visible=t.bottom>e.scrollTop&&t.top<e.scrollTop+e.clientHeight),t.visible&&e.scrollWidth!=e.offsetWidth&&"visible"!=jquery__WEBPACK_IMPORTED_MODULE_1___default()(e).css("overflowX")&&(t.visible=t.right>e.scrollLeft&&t.left<e.scrollLeft+e.clientWidth),t.left-=e.scrollLeft,t.top-=e.scrollTop,e===n&&(t.left+=e.offsetLeft,t.top+=e.offsetTop,n=e.offsetParent),t.bottom=t.top+t.height,t.right=t.left+t.width;return t}function getActiveCellPosition(){return absBox(activeCellNode)}function getGridPosition(){return absBox($container[0])}function handleActiveCellPositionChange(){if(activeCellNode&&(trigger(self.onActiveCellPositionChanged,{}),currentEditor)){var e=getActiveCellPosition();currentEditor.show&&currentEditor.hide&&(e.visible?currentEditor.show():currentEditor.hide()),currentEditor.position&&currentEditor.position(e)}}function getCellEditor(){return currentEditor}function getActiveCell(){return activeCellNode?{row:activeRow,cell:activeCell}:null}function getActiveCellNode(){return activeCellNode}function scrollRowIntoView(e,t){if(!hasFrozenRows||!options.frozenBottom&&e>actualFrozenRow-1||options.frozenBottom&&e<actualFrozenRow-1){var n=$viewportScrollContainerY.height(),i=hasFrozenRows&&!options.frozenBottom?e-options.frozenRow:e,r=i*options.rowHeight,o=(i+1)*options.rowHeight-n+(viewportHasHScroll?scrollbarDimensions.height:0);(i+1)*options.rowHeight>scrollTop+n+offset?(scrollTo(t?r:o),render()):i*options.rowHeight<scrollTop+offset&&(scrollTo(t?o:r),render())}}function scrollRowToTop(e){scrollTo(e*options.rowHeight),render()}function scrollPage(e){var t=e*numVisibleRows;if(scrollTo((getRowFromPosition(scrollTop+options.rowHeight-1)+t)*options.rowHeight),render(),options.enableCellNavigation&&null!=activeRow){var n=activeRow+t,i=getDataLengthIncludingAddNew();n>=i&&(n=i-1),n<0&&(n=0);for(var r=0,o=null,a=activePosX;r<=activePosX;)canCellBeActive(n,r)&&(o=r),r+=getColspan(n,r);null!==o?(setActiveCellInternal(getCellNode(n,o)),activePosX=a):resetActiveCell()}}function navigatePageDown(){scrollPage(1)}function navigatePageUp(){scrollPage(-1)}function navigateTop(){navigateToRow(0)}function navigateBottom(){navigateToRow(getDataLength()-1)}function navigateToRow(e){var t=getDataLength();if(!t)return!0;if(e<0?e=0:e>=t&&(e=t-1),scrollCellIntoView(e,0,!0),options.enableCellNavigation&&null!=activeRow){for(var n=0,i=null,r=activePosX;n<=activePosX;)canCellBeActive(e,n)&&(i=n),n+=getColspan(e,n);null!==i?(setActiveCellInternal(getCellNode(e,i)),activePosX=r):resetActiveCell()}return!0}function getColspan(e,t){var n=data.getItemMetadata&&data.getItemMetadata(e);if(!n||!n.columns)return 1;var i=n.columns[columns[t].id]||n.columns[t],r=i&&i.colspan;return"*"===r?columns.length-t:r||1}function findFirstFocusableCell(e){for(var t=0;t<columns.length;){if(canCellBeActive(e,t))return t;t+=getColspan(e,t)}return null}function findLastFocusableCell(e){for(var t=0,n=null;t<columns.length;)canCellBeActive(e,t)&&(n=t),t+=getColspan(e,t);return n}function gotoRight(e,t,n){if(t>=columns.length)return null;do{t+=getColspan(e,t)}while(t<columns.length&&!canCellBeActive(e,t));return t<columns.length?{row:e,cell:t,posX:t}:null}function gotoLeft(e,t,n){if(t<=0)return null;var i=findFirstFocusableCell(e);if(null===i||i>=t)return null;for(var r,o={row:e,cell:i,posX:i};;){if(!(r=gotoRight(o.row,o.cell,o.posX)))return null;if(r.cell>=t)return o;o=r}}function gotoDown(e,t,n){for(var i,r=getDataLengthIncludingAddNew();;){if(++e>=r)return null;for(i=t=0;t<=n;)i=t,t+=getColspan(e,t);if(canCellBeActive(e,i))return{row:e,cell:i,posX:n}}}function gotoUp(e,t,n){for(var i;;){if(--e<0)return null;for(i=t=0;t<=n;)i=t,t+=getColspan(e,t);if(canCellBeActive(e,i))return{row:e,cell:i,posX:n}}}function gotoNext(e,t,n){if(null==e&&null==t&&canCellBeActive(e=t=n=0,t))return{row:e,cell:t,posX:t};var i=gotoRight(e,t,n);if(i)return i;var r=null,o=getDataLengthIncludingAddNew();for(e===o-1&&e--;++e<o;)if(null!==(r=findFirstFocusableCell(e)))return{row:e,cell:r,posX:r};return null}function gotoPrev(e,t,n){if(null==e&&null==t&&canCellBeActive(e=getDataLengthIncludingAddNew()-1,t=n=columns.length-1))return{row:e,cell:t,posX:t};for(var i,r;!i&&!(i=gotoLeft(e,t,n));){if(--e<0)return null;t=0,null!==(r=findLastFocusableCell(e))&&(i={row:e,cell:r,posX:r})}return i}function gotoRowStart(e,t,n){var i=findFirstFocusableCell(e);return null===i?null:{row:e,cell:i,posX:i}}function gotoRowEnd(e,t,n){var i=findLastFocusableCell(e);return null===i?null:{row:e,cell:i,posX:i}}function navigateRight(){return navigate("right")}function navigateLeft(){return navigate("left")}function navigateDown(){return navigate("down")}function navigateUp(){return navigate("up")}function navigateNext(){return navigate("next")}function navigatePrev(){return navigate("prev")}function navigateRowStart(){return navigate("home")}function navigateRowEnd(){return navigate("end")}function navigate(e){if(!options.enableCellNavigation)return!1;if(!activeCellNode&&"prev"!=e&&"next"!=e)return!1;if(!getEditorLock().commitCurrentEdit())return!0;setFocus(),tabbingDirection={up:-1,down:1,left:-1,right:1,prev:-1,next:1,home:-1,end:1}[e];var t=(0,{up:gotoUp,down:gotoDown,left:gotoLeft,right:gotoRight,prev:gotoPrev,next:gotoNext,home:gotoRowStart,end:gotoRowEnd}[e])(activeRow,activeCell,activePosX);if(t){if(hasFrozenRows&&options.frozenBottom&t.row==getDataLength())return;var n=t.row==getDataLength();return(!options.frozenBottom&&t.row>=actualFrozenRow||options.frozenBottom&&t.row<actualFrozenRow)&&scrollCellIntoView(t.row,t.cell,!n&&options.emulatePagingWhenScrolling),setActiveCellInternal(getCellNode(t.row,t.cell)),activePosX=t.posX,!0}return setActiveCellInternal(getCellNode(activeRow,activeCell)),!1}function getCellNode(e,t){if(rowsCache[e]){ensureCellNodesInRowsCache(e);try{return rowsCache[e].cellNodesByColumnIdx.length>t?rowsCache[e].cellNodesByColumnIdx[t][0]:null}catch(n){return rowsCache[e].cellNodesByColumnIdx[t]}}return null}function setActiveCell(e,t,n,i,r){initialized&&(e>getDataLength()||e<0||t>=columns.length||t<0||options.enableCellNavigation&&(scrollCellIntoView(e,t,!1),setActiveCellInternal(getCellNode(e,t),n,i,r)))}function setActiveRow(e,t,n){initialized&&(e>getDataLength()||e<0||t>=columns.length||t<0||(activeRow=e,n||scrollCellIntoView(e,t||0,!1)))}function canCellBeActive(e,t){if(!options.enableCellNavigation||e>=getDataLengthIncludingAddNew()||e<0||t>=columns.length||t<0)return!1;var n=data.getItemMetadata&&data.getItemMetadata(e);if(n&&void 0!==n.focusable)return!!n.focusable;var i=n&&n.columns;return i&&i[columns[t].id]&&void 0!==i[columns[t].id].focusable?!!i[columns[t].id].focusable:i&&i[t]&&void 0!==i[t].focusable?!!i[t].focusable:!!columns[t].focusable}function canCellBeSelected(e,t){if(e>=getDataLength()||e<0||t>=columns.length||t<0)return!1;var n=data.getItemMetadata&&data.getItemMetadata(e);if(n&&void 0!==n.selectable)return!!n.selectable;var i=n&&n.columns&&(n.columns[columns[t].id]||n.columns[t]);return i&&void 0!==i.selectable?!!i.selectable:!!columns[t].selectable}function gotoCell(e,t,n,i){if(initialized&&canCellBeActive(e,t)&&getEditorLock().commitCurrentEdit()){scrollCellIntoView(e,t,!1);var r=getCellNode(e,t),o=columns[t],a=!!(options.editable&&o&&o.editor&&options.suppressActiveCellChangeOnEdit);setActiveCellInternal(r,n||e===getDataLength()||options.autoEdit,null,a,i),currentEditor||setFocus()}}function commitCurrentEdit(){var e=getDataItem(activeRow),t=columns[activeCell];if(currentEditor){if(currentEditor.isValueChanged()){var n=currentEditor.validate();if(n.valid){if(activeRow<getDataLength()){var i={row:activeRow,cell:activeCell,editor:currentEditor,serializedValue:currentEditor.serializeValue(),prevSerializedValue:serializedEditorValue,execute:function(){this.editor.applyValue(e,this.serializedValue),updateRow(this.row),trigger(self.onCellChange,{row:this.row,cell:this.cell,item:e,column:t})},undo:function(){this.editor.applyValue(e,this.prevSerializedValue),updateRow(this.row),trigger(self.onCellChange,{row:this.row,cell:this.cell,item:e,column:t})}};options.editCommandHandler?(makeActiveCellNormal(),options.editCommandHandler(e,t,i)):(i.execute(),makeActiveCellNormal())}else{var r={};currentEditor.applyValue(r,currentEditor.serializeValue()),makeActiveCellNormal(),trigger(self.onAddNewRow,{item:r,column:t})}return!getEditorLock().isActive()}return jquery__WEBPACK_IMPORTED_MODULE_1___default()(activeCellNode).removeClass("invalid"),jquery__WEBPACK_IMPORTED_MODULE_1___default()(activeCellNode).width(),jquery__WEBPACK_IMPORTED_MODULE_1___default()(activeCellNode).addClass("invalid"),trigger(self.onValidationError,{editor:currentEditor,cellNode:activeCellNode,validationResults:n,row:activeRow,cell:activeCell,column:t}),currentEditor.focus(),!1}makeActiveCellNormal()}return!0}function cancelCurrentEdit(){return makeActiveCellNormal(),!0}function rowsToRanges(e){for(var t=[],n=columns.length-1,i=0;i<e.length;i++)t.push(new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Range(e[i],0,e[i],n));return t}function getSelectedRows(){if(!selectionModel)throw new Error("SlickGrid Selection model is not set");return selectedRows.slice(0)}function setSelectedRows(e){if(!selectionModel)throw new Error("SlickGrid Selection model is not set");self&&self.getEditorLock&&!self.getEditorLock().isActive()&&selectionModel.setSelectedRanges(rowsToRanges(e))}function getBaseDocument(){return __doc__}function setBaseDocument(e){stylesheet=null;var t=(__doc__=e).styleSheets;for(let e=0;e<t.length;e++)if(t[e].rules[0].selectorText&&t[e].rules[0].selectorText.includes(uid)){stylesheet=t[e];break}$style=jquery__WEBPACK_IMPORTED_MODULE_1___default()(stylesheet.ownerNode),removeCssRules(),createCssRules(),setColumns(columns)}this.debug=function(){var e="";e+="\ncounter_rows_rendered:  "+counter_rows_rendered,e+="\ncounter_rows_removed:  "+counter_rows_removed,e+="\nrenderedRows:  "+renderedRows,e+="\nnumVisibleRows:  "+numVisibleRows,e+="\nmaxSupportedCssHeight:  "+maxSupportedCssHeight,e+="\nn(umber of pages):  "+n,e+="\n(current) page:  "+page,e+="\npage height (ph):  "+ph,e+="\nvScrollDir:  "+vScrollDir,alert(e)},this.eval=function(expr){return eval(expr)},jquery__WEBPACK_IMPORTED_MODULE_1___default().extend(this,{slickGridVersion:"2.4.38",onScroll:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onSort:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onHeaderMouseEnter:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onHeaderMouseLeave:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onHeaderContextMenu:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onHeaderClick:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onHeaderCellRendered:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onBeforeHeaderCellDestroy:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onHeaderRowCellRendered:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onFooterRowCellRendered:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onFooterContextMenu:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onFooterClick:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onBeforeHeaderRowCellDestroy:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onBeforeFooterRowCellDestroy:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onMouseEnter:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onMouseLeave:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onClick:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onDblClick:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onContextMenu:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onKeyDown:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onAddNewRow:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onBeforeAppendCell:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onValidationError:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onViewportChanged:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onColumnsReordered:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onColumnsDrag:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onColumnsResized:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onColumnsResizeDblClick:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onBeforeColumnsResize:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onCellChange:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onCompositeEditorChange:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onBeforeEditCell:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onBeforeCellEditorDestroy:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onBeforeDestroy:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onActiveCellChanged:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onActiveCellPositionChanged:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onDragInit:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onDragStart:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onDrag:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onDragEnd:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onSelectedRowsChanged:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onCellCssStylesChanged:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onAutosizeColumns:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onRendered:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onSetOptions:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,registerPlugin,unregisterPlugin,getPluginByName,getColumns,setColumns,getColumnIndex,updateColumnHeader,setSortColumn,setSortColumns,getSortColumns,autosizeColumns,autosizeColumn,getOptions,setOptions,getData,getDataLength,getDataItem,setData,getSelectionModel,setSelectionModel,getSelectedRows,setSelectedRows,getContainerNode,updatePagingStatusFromView,applyFormatResultToCellNode,render,reRenderColumns,invalidate,invalidateRow,invalidateRows,invalidateAllRows,updateCell,updateRow,getViewport:getVisibleRange,getRenderedRange,resizeCanvas,updateRowCount,scrollRowIntoView,scrollRowToTop,scrollCellIntoView,scrollColumnIntoView,getCanvasNode,getUID,getHeaderColumnWidthDiff,getScrollbarDimensions,getHeadersWidth,getCanvasWidth,getCanvases,getActiveCanvasNode,setActiveCanvasNode,getViewportNode,getViewports,getActiveViewportNode,setActiveViewportNode,focus:setFocus,scrollTo,cacheCssForHiddenInit,restoreCssFromHiddenInit,getCellFromPoint,getCellFromEvent,getActiveCell,setActiveCell,setActiveRow,getActiveCellNode,getActiveCellPosition,resetActiveCell,editActiveCell:makeActiveCellEditable,getCellEditor,getCellNode,getCellNodeBox,canCellBeSelected,canCellBeActive,navigatePrev,navigateNext,navigateUp,navigateDown,navigateLeft,navigateRight,navigatePageUp,navigatePageDown,navigateTop,navigateBottom,navigateRowStart,navigateRowEnd,gotoCell,getTopPanel,setTopPanelVisibility,getPreHeaderPanel,getPreHeaderPanelLeft:getPreHeaderPanel,getPreHeaderPanelRight,setPreHeaderPanelVisibility,getHeader,getHeaderColumn,setHeaderRowVisibility,getHeaderRow,getHeaderRowColumn,setFooterRowVisibility,getFooterRow,getFooterRowColumn,getGridPosition,flashCell,addCellCssStyles,setCellCssStyles,removeCellCssStyles,getCellCssStyles,getFrozenRowOffset,setColumnHeaderVisibility,init:finishInitialization,destroy,getEditorLock,getEditController,applyColumnWidths,setBaseDocument,getBaseDocument}),init()}function TextEditor(e){var t,n;this.init=function(){t=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<INPUT type=text class='editor-text' />").appendTo(e.container).on("keyup",(e=>{const n=e.which;37!==n&&39!==n&&8!==n?this.autoCorrect(t.val()):e.stopImmediatePropagation()}))},this.autoCorrect=function(n){const i=e.grid.getData().getValueSuggestion(n,e.column.field);i&&t.val(i)},this.destroy=function(){t.remove()},this.focus=function(){t.focus()},this.getValue=function(){return t.val()},this.setValue=function(e){t.val(e)},this.loadValue=function(i){n=i[e.column.field]||"",t.val(n),t[0].defaultValue=n,t.select()},this.serializeValue=function(){return t.val()},this.applyValue=function(t,n,i=!0){e.grid.getData().updateValue(n,t.__index__,e.column.field,i)},this.isValueChanged=function(){return!(""==t.val()&&null==n)&&t.val()!=n},this.validate=function(){if(e.column.validator){var n=e.column.validator(t.val());if(!n.valid)return n}return{valid:!0,msg:null}},this.init()}function Overlays(e){var t,n,i,r,o,a=this,s=new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.EventHandler,l={buttonCssClass:null,buttonImage:"../images/down.gif",decoratorWidth:2};function c(e,t){o.hide(),f()}function h(e,t){f()}function u(e,t){f()}function f(e,n){var i=r.getActiveCell();if(i){var o=r.getColumns()[i.cell];t.toggle(!0),t.$handle.toggle(void 0!==o.editor);var a=r.getCellNodeBox(i.row,i.cell);a.height=a.bottom-a.top,a.width=a.right-a.left,t.$left.css({left:a.left-2,top:a.top,width:2,height:a.height}),t.$right.css({left:a.left+a.width-1,top:a.top,width:2,height:a.height}),t.$top.css({left:a.left-2,top:a.top-2,width:a.width+3,height:2}),t.$bottom.css({left:a.left-2,top:a.top+a.height-1,width:a.width+3,height:2}),t.$handle.css({left:a.left+a.width-4,top:a.top+a.height-4,width:1,height:1})}else t.toggle(!1)}function d(e,t){var a=r.getActiveCell();if(r.canCellBeSelected(a.row,a.cell)&&(i=!0,e.stopImmediatePropagation()),!i)return null;const s=r.getCellEditor();return s&&s.applyValue(r.getDataItem(a.row),s.getValue(),!1),r.focus(),n=a.row,t.range={start:a,end:{}},jquery__WEBPACK_IMPORTED_MODULE_1___default()(this).css({"background-color":"transparent","border-color":"transparent"}),o.show(new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Range(a.row,a.cell))}function p(e,t){if(!i)return;var n=r.getCanvasNode();e.stopImmediatePropagation();var a=r.getCellFromPoint(e.pageX-jquery__WEBPACK_IMPORTED_MODULE_1___default()(n).offset().left,e.pageY-jquery__WEBPACK_IMPORTED_MODULE_1___default()(n).offset().top);if(!r.canCellBeSelected(a.row,a.cell))return;t.range.end=a,o.show(new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Range(t.range.start.row,t.range.start.cell,a.row,t.range.start.cell));const s=r.getViewport();s.bottom===a.row&&r.scrollRowIntoView(a.row+7),s.top===a.row&&r.scrollRowIntoView(s.top-7)}function g(e,t){if(!i)return;i=!1,jquery__WEBPACK_IMPORTED_MODULE_1___default()(this).css({"background-color":"","border-color":""}),o.hideHandle();const s=o.getSelectedRange(),l=n<s.toRow?"+":"-";a.onFillUpDown.notify({dir:l,grid:r,range:s},e,a),o.hide(),e.preventDefault(),e.stopPropagation()}function m(e,t){var n=(t||"")+"cell-overlay";this.$left=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div>").addClass(n).addClass("left").appendTo(e),this.$right=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div>").addClass(n).addClass("right").appendTo(e),this.$top=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div>").addClass(n).addClass("top").appendTo(e),this.$bottom=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div>").addClass(n).addClass("bottom").appendTo(e),this.$handle=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div>").addClass("handle-overlay").data("__doc__",r.getBaseDocument()).appendTo(e),this.toggle=function(e){this.$left.toggle(e),this.$right.toggle(e),this.$top.toggle(e),this.$bottom.toggle(e),this.$handle.toggle(e)},this.remove=function(){this.$left.remove(),this.$right.remove(),this.$top.remove(),this.$bottom.remove(),this.$handle.remove()}}function _(t){var n,i;return{hide:function(){n&&(n.toggle(!1),n=null)},hideHandle:function(){n.$handle.hide()},show:function(o){i=o,n||(n=new m(r.getCanvasNode(),"selection-"));var a=t.getCellNodeBox(o.fromRow,o.fromCell),s=t.getCellNodeBox(o.toRow,o.toCell);return n.$left.css({top:a.top-2,left:a.left-2,height:s.bottom-a.top+2,width:e.decoratorWidth}),n.$right.css({top:a.top-2,left:s.right-1,height:s.bottom-a.top+2,width:e.decoratorWidth}),n.$top.css({top:a.top-2,left:s.left-1,height:e.decoratorWidth,width:s.right-a.left+2}),n.$bottom.css({top:s.bottom-1,left:a.left-2,height:e.decoratorWidth,width:s.right-a.left+3}),n.$handle.css({top:s.bottom-3,left:a.right-4,height:1,width:1}),n},getSelectedRange:function(){return i}}}jquery__WEBPACK_IMPORTED_MODULE_1___default().extend(this,{init:function(n){var i;e=jquery__WEBPACK_IMPORTED_MODULE_1___default().extend(!0,{},l,e),o=new _(r=n),(i=new m(r.getCanvasNode())).$handle.bind("dragstart",d).bind("drag",p).bind("dragend",g),t=i,s.subscribe(r.onActiveCellChanged,c).subscribe(r.onColumnsResized,h).subscribe(r.onScroll,u)},destroy:function(){s.unsubscribeAll(),t.$handle.unbind("dragstart",d).unbind("drag",p).unbind("dragend",g),t.remove()},onFillUpDown:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event})}!function(e){e.fn.drag=function(t,n,i){var r="string"==typeof t?t:"",o=e.isFunction(t)?t:e.isFunction(n)?n:null;return 0!==r.indexOf("drag")&&(r="drag"+r),i=(t==o?n:i)||{},o?this.on(r,i,o):this.trigger(r)};var t=e.event,n=t.special,i=n.drag={defaults:{which:1,distance:0,not:":input",handle:null,relative:!1,drop:!0,click:!1},datakey:"dragdata",noBubble:!0,add:function(t){var n=e.data(this,i.datakey),r=t.data||{};n.related+=1,e.each(i.defaults,(function(e,t){void 0!==r[e]&&(n[e]=r[e])}))},remove:function(){e.data(this,i.datakey).related-=1},setup:function(){if(!e.data(this,i.datakey)){var n=e.extend({related:0},i.defaults);e.data(this,i.datakey,n),t.add(this,"touchstart mousedown",i.init,n),this.attachEvent&&this.attachEvent("ondragstart",i.dontstart)}},teardown:function(){(e.data(this,i.datakey)||{}).related||(e.removeData(this,i.datakey),t.remove(this,"touchstart mousedown",i.init),i.textselect(!0),this.detachEvent&&this.detachEvent("ondragstart",i.dontstart))},init:function(r,o){if(i.touched)return;var a,s=r.data;if(0!=r.which&&s.which>0&&r.which!=s.which)return;if(e(r.target).is(s.not))return;if(s.handle&&!e(r.target).closest(s.handle,r.currentTarget).length)return;if(i.touched="touchstart"==r.type?this:null,s.propagates=1,s.mousedown=this,s.interactions=[i.interaction(this,s)],s.target=r.target,s.pageX=r.pageX,s.pageY=r.pageY,s.dragging=null,a=i.hijack(r,"draginit",s),!s.propagates)return;(a=i.flatten(a))&&a.length&&(s.interactions=[],e.each(a,(function(){s.interactions.push(i.interaction(this,s))}))),s.propagates=s.interactions.length,!1!==s.drop&&n.drop&&n.drop.handler(r,s),i.textselect(!1);let l=e(r.currentTarget).data("__doc__")||document;return i.touched?t.add(i.touched,"touchmove touchend",i.handler,s):t.add(l,"mousemove mouseup",i.handler,s),!(!i.touched||s.live)&&void 0},interaction:function(t,n){var r=t&&t.ownerDocument&&e(t)[n.relative?"position":"offset"]()||{top:0,left:0};return{drag:t,callback:new i.callback,droppable:[],offset:r}},handler:function(r){var o=r.data;switch(r.type){case!o.dragging&&"touchmove":r.preventDefault();case!o.dragging&&"mousemove":if(Math.pow(r.pageX-o.pageX,2)+Math.pow(r.pageY-o.pageY,2)<Math.pow(o.distance,2))break;r.target=o.target,i.hijack(r,"dragstart",o),o.propagates&&(o.dragging=!0);case"touchmove":r.preventDefault();case"mousemove":if(o.dragging){if(i.hijack(r,"drag",o),o.propagates){!1!==o.drop&&n.drop&&n.drop.handler(r,o);break}r.type="mouseup"}default:let a=e(o.target).data("__doc__")||r.currentTarget||document;i.touched?t.remove(i.touched,"touchmove touchend",i.handler):t.remove(a,"mousemove mouseup",i.handler),o.dragging&&(!1!==o.drop&&n.drop&&n.drop.handler(r,o),i.hijack(r,"dragend",o)),i.textselect(!0),!1===o.click&&o.dragging&&e.data(o.mousedown,"suppress.click",(new Date).getTime()+5),o.dragging=i.touched=!1}},hijack:function(n,r,o,a,s){if(o){var l,c,h,u={event:n.originalEvent,type:n.type},f=r.indexOf("drop")?"drag":"drop",d=a||0,p=isNaN(a)?o.interactions.length:a;n.type=r;var g=function(){};n.originalEvent=new jQuery.Event(u.event,{preventDefault:g,stopPropagation:g,stopImmediatePropagation:g}),o.results=[];do{if(c=o.interactions[d]){if("dragend"!==r&&c.cancelled)continue;h=i.properties(n,o,c),c.results=[],e(s||c[f]||o.droppable).each((function(a,s){if(h.target=s,n.isPropagationStopped=function(){return!1},!1===(l=s?t.dispatch.call(s,n,h):null)?("drag"==f&&(c.cancelled=!0,o.propagates-=1),"drop"==r&&(c[f][a]=null)):"dropinit"==r&&c.droppable.push(i.element(l)||s),"dragstart"==r&&(c.proxy=e(i.element(l)||c.drag)[0]),c.results.push(l),delete n.result,"dropinit"!==r)return l})),o.results[d]=i.flatten(c.results),"dropinit"==r&&(c.droppable=i.flatten(c.droppable)),"dragstart"!=r||c.cancelled||h.update()}}while(++d<p);return n.type=u.type,n.originalEvent=u.event,i.flatten(o.results)}},properties:function(e,t,n){var r=n.callback;return r.drag=n.drag,r.proxy=n.proxy||n.drag,r.startX=t.pageX,r.startY=t.pageY,r.deltaX=e.pageX-t.pageX,r.deltaY=e.pageY-t.pageY,r.originalX=n.offset.left,r.originalY=n.offset.top,r.offsetX=r.originalX+r.deltaX,r.offsetY=r.originalY+r.deltaY,r.drop=i.flatten((n.drop||[]).slice()),r.available=i.flatten((n.droppable||[]).slice()),r},element:function(e){if(e&&(e.jquery||1==e.nodeType))return e},flatten:function(t){return e.map(t,(function(t){return t&&t.jquery?e.makeArray(t):t&&t.length?i.flatten(t):t}))},textselect:function(t){e(document)[t?"off":"on"]("selectstart",i.dontstart).css("MozUserSelect",t?"":"none"),document.unselectable=t?"off":"on"},dontstart:function(){return!1},callback:function(){}};i.callback.prototype={update:function(){n.drop&&this.available.length&&e.each(this.available,(function(e){n.drop.locate(this,e)}))}};var r=t.dispatch;t.dispatch=function(t){if(!(e.data(this,"suppress."+t.type)-(new Date).getTime()>0))return r.apply(this,arguments);e.removeData(this,"suppress."+t.type)},n.draginit=n.dragstart=n.dragend=i}(jquery__WEBPACK_IMPORTED_MODULE_1___default())},7636:(e,t,n)=>{"use strict";n.d(t,{Ee:()=>c,JW:()=>l,kE:()=>h});var i=n(1445),r=n(3838),o=n(1031),a=n(4752),s=n(8503);function l(e,t={}){const n=e.ticks(t.ticks||4);return c(n.map((t=>e(t))),n,t)}function c(e,t,n={}){const o=e.length,a=n.type||"color",s="circle"===a?20:12,l=o*s+2*(o+2),c=(0,i.ut)("div",{styles:{width:"120px",height:(l>215?215:l)+35+"px",position:"absolute",border:"0.5px solid black"},classes:["legend-container"]});(0,i.ut)("div",{styles:{height:"20px",whiteSpace:"nowrap"},classes:["legend-title"],text:n.label},c);const h=(0,i.ut)("div",{styles:{overflowY:"auto",overflowX:"hidden",height:"calc(100% - 10px)",width:"100%"},classes:["legend-body"]},c),u=(0,i.dl)("svg",{height:l,width:180,styles:{position:"relative"}},h),f=(0,i.dl)("g",{},u),d="color"===a?14:"line"===a?20:30;for(let n=0;n<o;n++){"color"===a?(0,i.dl)("rect",{y:2*(n+1)+n*s,x:2,height:"10",width:"10",styles:{fill:e[n]}},f):"line"===a?(0,i.dl)("rect",{y:2*(n+1)+n*s,x:2,height:"10",width:e[n],styles:{fill:"gray"}},f):"circle"===a&&(0,i.dl)("circle",{cy:2*(n+1)+n*s+4,cx:15,r:e[n],styles:{fill:"gray"}},f);const o=(0,i.dl)("text",{y:2*(n+1)+n*s+6+3,x:d,"alignment-baseline":"center",styles:{"font-size":"12px",fill:"currentcolor"},text:""===t[n]?"none":t[n]},f);(0,r.Z)(o).style("fill","currentcolor")}return(0,i.$q)(c,{handle:".legend-body"}),(0,i.n2)(c),c}function h(e,t={}){const n=t,l=e.length,c=e.map(((e,t)=>[Math.floor(t/l*100)+"%",e])),h=n.width||120,u=n.height||45,f=(0,i.dl)("svg",{height:u,width:h,styles:{position:"relative"}}),d=(0,r.Z)(f).append("g"),p=(0,s.zO)();n.label&&d.append("text").text(n.label).attr("x",10).style("fill","currentColor").attr("alignment-baseline","hanging").style("font-size","12px");const g=d.append("defs").append("linearGradient").attr("id",p).attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","0%").attr("spreadMethod","pad");let m=u;if(n.label&&(m-=10),n.range&&(m-=25),d.append("rect").attr("x",n.range?10:0).attr("y",n.label?10:0).attr("width",n.range?h-20:20).attr("height",m).style("fill",`url(#${p})`),c.forEach((e=>{g.append("stop").attr("offset",e[0]).attr("stop-color",e[1]).attr("stop-opacity",1)})),n.range){const e=(0,o.Z)().domain([n.range[0],n.range[1]]).range([0,h-20]),t=(0,a.LL)(e).tickFormat(((e,t)=>e>=1e4?Number.parseFloat(e).toPrecision(2):e)).ticks(Math.ceil(h/20));d.append("g").call(t).attr("transform",`translate(10,${u-25})`).selectAll("text").style("text-anchor","end").attr("dx","-.4em").attr("dy",".4em").attr("transform","rotate(-45)")}const _=(0,i.ut)("div",{height:u,width:h,styles:{position:"absolute"},classes:["legend-container"]});return _.append(f),(0,i.$q)(_),_}},1445:(e,t,n)=>{"use strict";n.d(t,{Vq:()=>S,ut:()=>_,Eo:()=>y,dl:()=>v,qT:()=>D,$q:()=>E,n2:()=>x,Ng:()=>w,EA:()=>k,P_:()=>C,Ni:()=>b});var i="undefined"!=typeof window?window:null,r=null===i,o=r?void 0:i.document,a="horizontal",s=function(){return!1},l=r?"calc":["","-webkit-","-moz-","-o-"].filter((function(e){var t=o.createElement("div");return t.style.cssText="width:"+e+"calc(9px)",!!t.style.length})).shift()+"calc",c=function(e){return"string"==typeof e||e instanceof String},h=function(e){if(c(e)){var t=o.querySelector(e);if(!t)throw new Error("Selector "+e+" did not match a DOM element");return t}return e},u=function(e,t,n){var i=e[t];return void 0!==i?i:n},f=function(e,t,n,i){if(t){if("end"===i)return 0;if("center"===i)return e/2}else if(n){if("start"===i)return 0;if("center"===i)return e/2}return e},d=function(e,t){var n=o.createElement("div");return n.className="gutter gutter-"+t,n},p=function(e,t,n){var i={};return c(t)?i[e]=t:i[e]=l+"("+t+"% - "+n+"px)",i},g=function(e,t){var n;return(n={})[e]=t+"px",n};const m=function(e,t){if(void 0===t&&(t={}),r)return{};var n,l,c,m,_,v,b=e;Array.from&&(b=Array.from(b));var y=h(b[0]).parentNode,w=getComputedStyle?getComputedStyle(y):null,x=w?w.flexDirection:null,C=u(t,"sizes")||b.map((function(){return 100/b.length})),k=u(t,"minSize",100),S=Array.isArray(k)?k:b.map((function(){return k})),E=u(t,"maxSize",1/0),D=Array.isArray(E)?E:b.map((function(){return E})),A=u(t,"expandToMin",!1),M=u(t,"gutterSize",10),R=u(t,"gutterAlign","center"),L=u(t,"snapOffset",30),T=Array.isArray(L)?L:b.map((function(){return L})),P=u(t,"dragInterval",1),z=u(t,"direction",a),I=u(t,"cursor",z===a?"col-resize":"row-resize"),O=u(t,"gutter",d),F=u(t,"elementStyle",p),B=u(t,"gutterStyle",g);function N(e,t,i,r){var o=F(n,t,i,r);Object.keys(o).forEach((function(t){e.style[t]=o[t]}))}function H(){return v.map((function(e){return e.size}))}function U(e){return"touches"in e?e.touches[0][l]:e[l]}function $(e){var t=v[this.a],n=v[this.b],i=t.size+n.size;t.size=e/this.size*i,n.size=i-e/this.size*i,N(t.element,t.size,this._b,t.i),N(n.element,n.size,this._c,n.i)}function j(e){var n,i=v[this.a],r=v[this.b];this.dragging&&(n=U(e)-this.start+(this._b-this.dragOffset),P>1&&(n=Math.round(n/P)*P),n<=i.minSize+i.snapOffset+this._b?n=i.minSize+this._b:n>=this.size-(r.minSize+r.snapOffset+this._c)&&(n=this.size-(r.minSize+this._c)),n>=i.maxSize-i.snapOffset+this._b?n=i.maxSize+this._b:n<=this.size-(r.maxSize-r.snapOffset+this._c)&&(n=this.size-(r.maxSize+this._c)),$.call(this,n),u(t,"onDrag",s)(H()))}function W(){var e=v[this.a].element,t=v[this.b].element,i=e.getBoundingClientRect(),r=t.getBoundingClientRect();this.size=i[n]+r[n]+this._b+this._c,this.start=i[c],this.end=i[m]}function q(e){var t=function(e){if(!getComputedStyle)return null;var t=getComputedStyle(e);if(!t)return null;var n=e[_];return 0===n?null:n-=z===a?parseFloat(t.paddingLeft)+parseFloat(t.paddingRight):parseFloat(t.paddingTop)+parseFloat(t.paddingBottom)}(y);if(null===t)return e;if(S.reduce((function(e,t){return e+t}),0)>t)return e;var n=0,i=[],r=e.map((function(r,o){var a=t*r/100,s=f(M,0===o,o===e.length-1,R),l=S[o]+s;return a<l?(n+=l-a,i.push(0),l):(i.push(a-l),a)}));return 0===n?e:r.map((function(e,r){var o=e;if(n>0&&i[r]-n>0){var a=Math.min(n,i[r]-n);n-=a,o=e-a}return o/t*100}))}function V(){var e=this,n=v[e.a].element,r=v[e.b].element;e.dragging&&u(t,"onDragEnd",s)(H()),e.dragging=!1,i.removeEventListener("mouseup",e.stop),i.removeEventListener("touchend",e.stop),i.removeEventListener("touchcancel",e.stop),i.removeEventListener("mousemove",e.move),i.removeEventListener("touchmove",e.move),e.stop=null,e.move=null,n.removeEventListener("selectstart",s),n.removeEventListener("dragstart",s),r.removeEventListener("selectstart",s),r.removeEventListener("dragstart",s),n.style.userSelect="",n.style.webkitUserSelect="",n.style.MozUserSelect="",n.style.pointerEvents="",r.style.userSelect="",r.style.webkitUserSelect="",r.style.MozUserSelect="",r.style.pointerEvents="",e.gutter.style.cursor="",e.parent.style.cursor="",o.body.style.cursor=""}function K(e){if(!("button"in e)||0===e.button){var n=this,r=v[n.a].element,a=v[n.b].element;n.dragging||u(t,"onDragStart",s)(H()),e.preventDefault(),n.dragging=!0,n.move=j.bind(n),n.stop=V.bind(n),i.addEventListener("mouseup",n.stop),i.addEventListener("touchend",n.stop),i.addEventListener("touchcancel",n.stop),i.addEventListener("mousemove",n.move),i.addEventListener("touchmove",n.move),r.addEventListener("selectstart",s),r.addEventListener("dragstart",s),a.addEventListener("selectstart",s),a.addEventListener("dragstart",s),r.style.userSelect="none",r.style.webkitUserSelect="none",r.style.MozUserSelect="none",r.style.pointerEvents="none",a.style.userSelect="none",a.style.webkitUserSelect="none",a.style.MozUserSelect="none",a.style.pointerEvents="none",n.gutter.style.cursor=I,n.parent.style.cursor=I,o.body.style.cursor=I,W.call(n),n.dragOffset=U(e)-n.end}}z===a?(n="width",l="clientX",c="left",m="right",_="clientWidth"):"vertical"===z&&(n="height",l="clientY",c="top",m="bottom",_="clientHeight"),C=q(C);var G=[];function Z(e){var t=e.i===G.length,n=t?G[e.i-1]:G[e.i];W.call(n);var i=t?n.size-e.minSize-n._c:e.minSize+n._b;$.call(n,i)}return(v=b.map((function(e,t){var i,r={element:h(e),size:C[t],minSize:S[t],maxSize:D[t],snapOffset:T[t],i:t};if(t>0&&((i={a:t-1,b:t,dragging:!1,direction:z,parent:y})._b=f(M,t-1==0,!1,R),i._c=f(M,!1,t===b.length-1,R),"row-reverse"===x||"column-reverse"===x)){var o=i.a;i.a=i.b,i.b=o}if(t>0){var a=O(t,z,r.element);!function(e,t,i){var r=B(n,t,i);Object.keys(r).forEach((function(t){e.style[t]=r[t]}))}(a,M,t),i._a=K.bind(i),a.addEventListener("mousedown",i._a),a.addEventListener("touchstart",i._a),y.insertBefore(a,r.element),i.gutter=a}return N(r.element,r.size,f(M,0===t,t===b.length-1,R),t),t>0&&G.push(i),r}))).forEach((function(e){var t=e.element.getBoundingClientRect()[n];t<e.minSize&&(A?Z(e):e.minSize=t)})),{setSizes:function(e){var t=q(e);t.forEach((function(e,n){if(n>0){var i=G[n-1],r=v[i.a],o=v[i.b];r.size=t[n-1],o.size=e,N(r.element,r.size,i._b,r.i),N(o.element,o.size,i._c,o.i)}}))},getSizes:H,collapse:function(e){Z(v[e])},destroy:function(e,t){G.forEach((function(i){if(!0!==t?i.parent.removeChild(i.gutter):(i.gutter.removeEventListener("mousedown",i._a),i.gutter.removeEventListener("touchstart",i._a)),!0!==e){var r=F(n,i.a.size,i._b);Object.keys(r).forEach((function(e){v[i.a].element.style[e]="",v[i.b].element.style[e]=""}))}}))},parent:y,pairs:G}};function _(e,t,n){const i=document.createElement(e);return t&&function(e,t){for(var n in t)if("styles"!==n&&"style"!==n||"object"!=typeof t[n])if("text"===n)e.textContent=t[n];else if("classes"===n)for(var i of t[n])e.classList.add(i);else e.setAttribute(n,t[n]);else for(var r in t[n])e.style[r]=t[n][r]}(i,t),n&&n.append(i),i}function v(e,t,n){const i=document.createElementNS("http://www.w3.org/2000/svg",e);if(t)for(var r in t)if("styles"!==r&&"style"!==r||"object"!=typeof t[r])if("text"===r)i.textContent=t[r];else if("classes"===r)for(var o of t[r])i.classList.add(o);else i.setAttributeNS(null,r,t[r]);else for(var a in t[r])i.style[a]=t[r][a];return n&&n.append(i),i}function b(e,t={}){const n=t.direction||"horizontal",i=t.number||2,r=[],o="horizontal"===n?["split-horizontal"]:["split-vertical"];for(let t=0;t<i;t++)r.push(_("div",{classes:o},e));return m(r,{direction:n,gutterSize:5,cursor:"pointer",sizes:t.sizes,onDragEnd:()=>window.dispatchEvent(new Event("resize"))}),r}function y(e,t,n){const i={},r=t.tooltip;r&&Object.assign(i,{"aria-label":r.text,role:"tooltip","data-microtip-size":r.size||"small","data-microtip-position":r.position||"bottom-left"});const o=_("span",i);return _("i",{classes:["ciview-menu-icon"].concat(e.split(" ")),styles:{fontSize:t.size||"18px"}},o),t.func&&o.addEventListener("click",(e=>t.func(e))),n&&n.append(o),o}function w(e,t={}){let n=null,i=!1;function r(e){return this.after(n),e.preventDefault(),!1}function o(r){i=!1,n.classList.remove("mdv-element-dragged"),t.sortEnded&&t.sortEnded(Array.from(e.children).slice(1))}function a(e){i=!t.handle||!!e.target.classList.contains(t.handle)}function s(e){if(!i)return e.preventDefault(),!1;n=this,this.classList.add("mdv-element-dragged"),e.dataTransfer.setDragImage(_("div",{}),0,0)}let l=_("div",{styles:{height:"5px"}});e.prepend(l),l.addEventListener("dragover",r);for(let t=0;t<e.children.length;t++){const n=e.children[t];n.draggable=!0,n.addEventListener("dragover",r),n.addEventListener("dragstart",s),n.addEventListener("dragend",o),n.addEventListener("mousedown",a)}}function x(e,t={}){if(e.__resizeinfo__)return;const n={resize:e.style.resize,overflow:e.style.overflow};e.style.resize="both",e.style.overflow="hidden",t.onresizeend&&(n.onresize=function(e,n,i){let r=e.getBoundingClientRect(),o=r.width,a=r.height;const s=n=>{let i=e.getBoundingClientRect();var r,s;i.width===o&&i.height===a||(r=i.width,s=i.height,t.onresizeend(r,s)),o=i.width,a=i.height};return i&&e.addEventListener("mousedown",i),e.addEventListener("mouseup",s),s}(e,0,t.onResizeStart)),e.__resizeinfo__=n}function C(e){if(!e.__resizeinfo__)return;const t=e.__resizeinfo__;e.style.resize=t.resize,e.style.overflow=t.overflow,t.onresize&&e.removeEventListener("mouseup",t.onresize),delete e.__resizeinfo__}function k(e){const t=e.__draginfo__;t&&(t.handle.style.cursor=t.cursor,e.style.position=t.position,t.handle.onmousedown=null,delete e.__draginfo__)}class S{constructor(e,t){this.el=e,this.max=t.max||100,e.classList.add("mdv-progress-outer"),this.bar=_("div",{classes:["mdv-progress-inner"]},e),this.text=_("div",{classes:["mdv-progress-text"]},e),this.setText(t.text||""),this.setValue(t.value||0)}setText(e){this.text.textContent=e}setValue(e){this.bar.style.width=`${Math.round(e/this.max*100)}%`}}function E(e,t={}){t.doc||(t.doc=document);let n=0,i=0,r=0,o=0,a=t.handle?e.querySelector(t.handle):e,s=null;function l(a){(a=a||window.event).preventDefault(),a.stopPropagation(),n=r-a.clientX,i=o-a.clientY,r=a.clientX,o=a.clientY;let l=e.offsetTop-i,c=e.offsetLeft-n;if(s){if(l<0||l+s.c_bb.height>s.p_bb.height&&"topleft"!==s.dir)return;if(c<0||c+s.c_bb.width>s.p_bb.width&&"topleft"!==s.dir)return}t.y_axis||(e.style.top=l+"px"),e.style.left=c+"px"}function c(){t.ondragend&&t.ondragend(),e.__doc__.onmouseup=null,e.__doc__.onmousemove=null}t.contain&&(s={dir:t.contain}),a.onmousedown=function(n){(n=n||window.event).preventDefault(),r=n.clientX,o=n.clientY,t.ondragstart&&t.ondragstart(e),s&&(s.p_bb=e.parentElement.getBoundingClientRect(),s.c_bb=e.getBoundingClientRect()),e.__doc__.onmouseup=c,e.__doc__.onmousemove=l},e.__draginfo__={handle:a,cursor:a.style.cursor,position:e.style.position},a.style.cursor="move",e.style.position="absolute",e.style.margin="0px 0px 0px 0px",e.__doc__=t.doc}function D(e){var t=e.getBoundingClientRect(),n=window.pageXOffset||document.documentElement.scrollLeft,i=window.pageYOffset||document.documentElement.scrollTop;return{top:t.top+i,left:t.left+n,height:t.height,width:t.width}}},8503:(e,t,n)=>{"use strict";function i(e=6,t){e||(e=6);let n="",i=0,r="a"==(t=t&&t.toLowerCase())?10:0,o="n"==t?10:62;for(;i++<e;){let e=Math.random()*(o-r)+r<<0;n+=String.fromCharCode(e+=e>9?e<36?55:61:48)}return n}function r(e,t){let n;return(...i)=>{clearTimeout(n),n=setTimeout((()=>{e.apply(this,i)}),t)}}n.d(t,{Ds:()=>r,zO:()=>i})},2810:e=>{"use strict";e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/Pgo8IS0tIEdlbmVyYXRvcjogQWRvYmUgSWxsdXN0cmF0b3IgMTYuMC4wLCBTVkcgRXhwb3J0IFBsdWctSW4gLiBTVkcgVmVyc2lvbjogNi4wMCBCdWlsZCAwKSAgLS0+CjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+CjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiBpZD0iQ2FwYV8xIiB4PSIwcHgiIHk9IjBweCIgd2lkdGg9IjE2cHgiIGhlaWdodD0iMTZweCIgdmlld0JveD0iMCAwIDUxMS42MjYgNTExLjYyNyIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgNTExLjYyNiA1MTEuNjI3OyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+CjxnPgoJPHBhdGggZD0iTTMyOC45MDYsNDAxLjk5NGgtMzYuNTUzVjEwOS42MzZoMzYuNTUzYzQuOTQ4LDAsOS4yMzYtMS44MDksMTIuODQ3LTUuNDI2YzMuNjEzLTMuNjE1LDUuNDIxLTcuODk4LDUuNDIxLTEyLjg0NSAgIGMwLTQuOTQ5LTEuODAxLTkuMjMxLTUuNDI4LTEyLjg1MWwtNzMuMDg3LTczLjA5QzI2NS4wNDQsMS44MDksMjYwLjc2LDAsMjU1LjgxMywwYy00Ljk0OCwwLTkuMjI5LDEuODA5LTEyLjg0Nyw1LjQyNCAgIGwtNzMuMDg4LDczLjA5Yy0zLjYxOCwzLjYxOS01LjQyNCw3LjkwMi01LjQyNCwxMi44NTFjMCw0Ljk0NiwxLjgwNyw5LjIyOSw1LjQyNCwxMi44NDVjMy42MTksMy42MTcsNy45MDEsNS40MjYsMTIuODUsNS40MjYgICBoMzYuNTQ1djI5Mi4zNThoLTM2LjU0MmMtNC45NTIsMC05LjIzNSwxLjgwOC0xMi44NSw1LjQyMWMtMy42MTcsMy42MjEtNS40MjQsNy45MDUtNS40MjQsMTIuODU0ICAgYzAsNC45NDUsMS44MDcsOS4yMjcsNS40MjQsMTIuODQ3bDczLjA4OSw3My4wODhjMy42MTcsMy42MTcsNy44OTgsNS40MjQsMTIuODQ3LDUuNDI0YzQuOTUsMCw5LjIzNC0xLjgwNywxMi44NDktNS40MjQgICBsNzMuMDg3LTczLjA4OGMzLjYxMy0zLjYyLDUuNDIxLTcuOTAxLDUuNDIxLTEyLjg0N2MwLTQuOTQ4LTEuODA4LTkuMjMyLTUuNDIxLTEyLjg1NCAgIEMzMzguMTQyLDQwMy44MDIsMzMzLjg1Nyw0MDEuOTk0LDMyOC45MDYsNDAxLjk5NHoiIGZpbGw9IiM2NjY2NjYiLz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8L3N2Zz4K"},8260:e=>{"use strict";e.exports="data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2212px%22%20height%3D%2236px%22%3E%3Cpath%20fill%3D%22rgba%2817,%2017,%2017,%200.9%29%22%20transform%3D%22rotate%28-90%2018%2018%29%22%20d%3D%22M2.658,0.000%20C-13.615,0.000%2050.938,0.000%2034.662,0.000%20C28.662,0.000%2023.035,12.002%2018.660,12.002%20C14.285,12.002%208.594,0.000%202.658,0.000%20Z%22/%3E%3C/svg%3E"},8261:e=>{"use strict";e.exports="data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2212px%22%20height%3D%2236px%22%3E%3Cpath%20fill%3D%22rgba%2817,%2017,%2017,%200.9%29%22%20transform%3D%22rotate%2890%206%206%29%22%20d%3D%22M2.658,0.000%20C-13.615,0.000%2050.938,0.000%2034.662,0.000%20C28.662,0.000%2023.035,12.002%2018.660,12.002%20C14.285,12.002%208.594,0.000%202.658,0.000%20Z%22/%3E%3C/svg%3E"},9854:e=>{"use strict";e.exports="data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2236px%22%20height%3D%2212px%22%3E%3Cpath%20fill%3D%22rgba%2817,%2017,%2017,%200.9%29%22%20transform%3D%22rotate%280%29%22%20d%3D%22M2.658,0.000%20C-13.615,0.000%2050.938,0.000%2034.662,0.000%20C28.662,0.000%2023.035,12.002%2018.660,12.002%20C14.285,12.002%208.594,0.000%202.658,0.000%20Z%22/%3E%3C/svg%3E"},1627:e=>{"use strict";e.exports="data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2236px%22%20height%3D%2212px%22%3E%3Cpath%20fill%3D%22rgba%2817,%2017,%2017,%200.9%29%22%20transform%3D%22rotate%28180%2018%206%29%22%20d%3D%22M2.658,0.000%20C-13.615,0.000%2050.938,0.000%2034.662,0.000%20C28.662,0.000%2023.035,12.002%2018.660,12.002%20C14.285,12.002%208.594,0.000%202.658,0.000%20Z%22/%3E%3C/svg%3E"},5258:e=>{"use strict";e.exports="static/img/../img/fa-brands-400.eot"},197:e=>{"use strict";e.exports="static/img/../img/fa-brands-400.svg"},9710:e=>{"use strict";e.exports="static/img/../img/fa-brands-400.ttf"},1293:e=>{"use strict";e.exports="static/img/../img/fa-brands-400.woff"},8073:e=>{"use strict";e.exports="static/img/../img/fa-brands-400.woff2"},848:e=>{"use strict";e.exports="static/img/../img/fa-regular-400.eot"},7094:e=>{"use strict";e.exports="static/img/../img/fa-regular-400.svg"},5860:e=>{"use strict";e.exports="static/img/../img/fa-regular-400.ttf"},4821:e=>{"use strict";e.exports="static/img/../img/fa-regular-400.woff"},6859:e=>{"use strict";e.exports="static/img/../img/fa-regular-400.woff2"},6203:e=>{"use strict";e.exports="static/img/../img/fa-solid-900.eot"},8498:e=>{"use strict";e.exports="static/img/../img/fa-solid-900.svg"},142:e=>{"use strict";e.exports="static/img/../img/fa-solid-900.ttf"},1029:e=>{"use strict";e.exports="static/img/../img/fa-solid-900.woff"},8681:e=>{"use strict";e.exports="static/img/../img/fa-solid-900.woff2"},6710:e=>{"use strict";e.exports="static/img/../img/GrpCheckboxN.png"},1679:e=>{"use strict";e.exports="static/img/../img/GrpCheckboxY.png"},996:e=>{"use strict";e.exports="static/img/../img/collapse.gif"},9513:e=>{"use strict";e.exports="static/img/../img/expand.gif"},8712:e=>{"use strict";e.exports="static/img/../img/header-columns-bg.gif"},6908:e=>{"use strict";e.exports="static/img/../img/header-columns-over-bg.gif"},6912:e=>{"use strict";e.exports="static/img/../img/sort-asc.gif"},4413:e=>{"use strict";e.exports="static/img/../img/sort-desc.gif"},4752:(e,t,n)=>{"use strict";function i(e){return e}n.d(t,{LL:()=>u,y4:()=>f});var r=1e-6;function o(e){return"translate("+e+",0)"}function a(e){return"translate(0,"+e+")"}function s(e){return t=>+e(t)}function l(e,t){return t=Math.max(0,e.bandwidth()-2*t)/2,e.round()&&(t=Math.round(t)),n=>+e(n)+t}function c(){return!this.__axis}function h(e,t){var n=[],h=null,u=null,f=6,d=6,p=3,g="undefined"!=typeof window&&window.devicePixelRatio>1?0:.5,m=1===e||4===e?-1:1,_=4===e||2===e?"x":"y",v=1===e||3===e?o:a;function b(o){var a=null==h?t.ticks?t.ticks.apply(t,n):t.domain():h,b=null==u?t.tickFormat?t.tickFormat.apply(t,n):i:u,y=Math.max(f,0)+p,w=t.range(),x=+w[0]+g,C=+w[w.length-1]+g,k=(t.bandwidth?l:s)(t.copy(),g),S=o.selection?o.selection():o,E=S.selectAll(".domain").data([null]),D=S.selectAll(".tick").data(a,t).order(),A=D.exit(),M=D.enter().append("g").attr("class","tick"),R=D.select("line"),L=D.select("text");E=E.merge(E.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),D=D.merge(M),R=R.merge(M.append("line").attr("stroke","currentColor").attr(_+"2",m*f)),L=L.merge(M.append("text").attr("fill","currentColor").attr(_,m*y).attr("dy",1===e?"0em":3===e?"0.71em":"0.32em")),o!==S&&(E=E.transition(o),D=D.transition(o),R=R.transition(o),L=L.transition(o),A=A.transition(o).attr("opacity",r).attr("transform",(function(e){return isFinite(e=k(e))?v(e+g):this.getAttribute("transform")})),M.attr("opacity",r).attr("transform",(function(e){var t=this.parentNode.__axis;return v((t&&isFinite(t=t(e))?t:k(e))+g)}))),A.remove(),E.attr("d",4===e||2===e?d?"M"+m*d+","+x+"H"+g+"V"+C+"H"+m*d:"M"+g+","+x+"V"+C:d?"M"+x+","+m*d+"V"+g+"H"+C+"V"+m*d:"M"+x+","+g+"H"+C),D.attr("opacity",1).attr("transform",(function(e){return v(k(e)+g)})),R.attr(_+"2",m*f),L.attr(_,m*y).text(b),S.filter(c).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",2===e?"start":4===e?"end":"middle"),S.each((function(){this.__axis=k}))}return b.scale=function(e){return arguments.length?(t=e,b):t},b.ticks=function(){return n=Array.from(arguments),b},b.tickArguments=function(e){return arguments.length?(n=null==e?[]:Array.from(e),b):n.slice()},b.tickValues=function(e){return arguments.length?(h=null==e?null:Array.from(e),b):h&&h.slice()},b.tickFormat=function(e){return arguments.length?(u=e,b):u},b.tickSize=function(e){return arguments.length?(f=d=+e,b):f},b.tickSizeInner=function(e){return arguments.length?(f=+e,b):f},b.tickSizeOuter=function(e){return arguments.length?(d=+e,b):d},b.tickPadding=function(e){return arguments.length?(p=+e,b):p},b.offset=function(e){return arguments.length?(g=+e,b):g},b}function u(e){return h(3,e)}function f(e){return h(4,e)}},8849:(e,t,n)=>{"use strict";function i(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function r(e,t){var n=Object.create(e.prototype);for(var i in t)n[i]=t[i];return n}function o(){}n.d(t,{ZP:()=>w,B8:()=>S});var a=.7,s=1/a,l="\\s*([+-]?\\d+)\\s*",c="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",h="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",u=/^#([0-9a-f]{3,8})$/,f=new RegExp(`^rgb\\(${l},${l},${l}\\)$`),d=new RegExp(`^rgb\\(${h},${h},${h}\\)$`),p=new RegExp(`^rgba\\(${l},${l},${l},${c}\\)$`),g=new RegExp(`^rgba\\(${h},${h},${h},${c}\\)$`),m=new RegExp(`^hsl\\(${c},${h},${h}\\)$`),_=new RegExp(`^hsla\\(${c},${h},${h},${c}\\)$`),v={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function b(){return this.rgb().formatHex()}function y(){return this.rgb().formatRgb()}function w(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=u.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?x(t):3===n?new E(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?C(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?C(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=f.exec(e))?new E(t[1],t[2],t[3],1):(t=d.exec(e))?new E(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=p.exec(e))?C(t[1],t[2],t[3],t[4]):(t=g.exec(e))?C(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=m.exec(e))?T(t[1],t[2]/100,t[3]/100,1):(t=_.exec(e))?T(t[1],t[2]/100,t[3]/100,t[4]):v.hasOwnProperty(e)?x(v[e]):"transparent"===e?new E(NaN,NaN,NaN,0):null}function x(e){return new E(e>>16&255,e>>8&255,255&e,1)}function C(e,t,n,i){return i<=0&&(e=t=n=NaN),new E(e,t,n,i)}function k(e){return e instanceof o||(e=w(e)),e?new E((e=e.rgb()).r,e.g,e.b,e.opacity):new E}function S(e,t,n,i){return 1===arguments.length?k(e):new E(e,t,n,null==i?1:i)}function E(e,t,n,i){this.r=+e,this.g=+t,this.b=+n,this.opacity=+i}function D(){return`#${L(this.r)}${L(this.g)}${L(this.b)}`}function A(){const e=M(this.opacity);return`${1===e?"rgb(":"rgba("}${R(this.r)}, ${R(this.g)}, ${R(this.b)}${1===e?")":`, ${e})`}`}function M(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function R(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function L(e){return((e=R(e))<16?"0":"")+e.toString(16)}function T(e,t,n,i){return i<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new z(e,t,n,i)}function P(e){if(e instanceof z)return new z(e.h,e.s,e.l,e.opacity);if(e instanceof o||(e=w(e)),!e)return new z;if(e instanceof z)return e;var t=(e=e.rgb()).r/255,n=e.g/255,i=e.b/255,r=Math.min(t,n,i),a=Math.max(t,n,i),s=NaN,l=a-r,c=(a+r)/2;return l?(s=t===a?(n-i)/l+6*(n<i):n===a?(i-t)/l+2:(t-n)/l+4,l/=c<.5?a+r:2-a-r,s*=60):l=c>0&&c<1?0:s,new z(s,l,c,e.opacity)}function z(e,t,n,i){this.h=+e,this.s=+t,this.l=+n,this.opacity=+i}function I(e){return(e=(e||0)%360)<0?e+360:e}function O(e){return Math.max(0,Math.min(1,e||0))}function F(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}i(o,w,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:b,formatHex:b,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return P(this).formatHsl()},formatRgb:y,toString:y}),i(E,S,r(o,{brighter(e){return e=null==e?s:Math.pow(s,e),new E(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=null==e?a:Math.pow(a,e),new E(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new E(R(this.r),R(this.g),R(this.b),M(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:D,formatHex:D,formatHex8:function(){return`#${L(this.r)}${L(this.g)}${L(this.b)}${L(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:A,toString:A})),i(z,(function(e,t,n,i){return 1===arguments.length?P(e):new z(e,t,n,null==i?1:i)}),r(o,{brighter(e){return e=null==e?s:Math.pow(s,e),new z(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?a:Math.pow(a,e),new z(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*t,r=2*n-i;return new E(F(e>=240?e-240:e+120,r,i),F(e,r,i),F(e<120?e+240:e-120,r,i),this.opacity)},clamp(){return new z(I(this.h),O(this.s),O(this.l),M(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=M(this.opacity);return`${1===e?"hsl(":"hsla("}${I(this.h)}, ${100*O(this.s)}%, ${100*O(this.l)}%${1===e?")":`, ${e})`}`}}))},2954:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i=e=>()=>e},8063:(e,t,n)=>{"use strict";function i(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}n.d(t,{Z:()=>i})},187:(e,t,n)=>{"use strict";n.d(t,{ZP:()=>s,hD:()=>c});var i=n(8849);function r(e,t,n,i,r){var o=e*e,a=o*e;return((1-3*e+3*o-a)*t+(4-6*o+3*a)*n+(1+3*e+3*o-3*a)*i+a*r)/6}var o=n(2954);function a(e,t){var n=t-e;return n?function(e,t){return function(n){return e+n*t}}(e,n):(0,o.Z)(isNaN(e)?t:e)}const s=function e(t){var n=function(e){return 1==(e=+e)?a:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(i){return Math.pow(e+i*t,n)}}(t,n,e):(0,o.Z)(isNaN(t)?n:t)}}(t);function r(e,t){var r=n((e=(0,i.B8)(e)).r,(t=(0,i.B8)(t)).r),o=n(e.g,t.g),s=n(e.b,t.b),l=a(e.opacity,t.opacity);return function(t){return e.r=r(t),e.g=o(t),e.b=s(t),e.opacity=l(t),e+""}}return r.gamma=e,r}(1);function l(e){return function(t){var n,r,o=t.length,a=new Array(o),s=new Array(o),l=new Array(o);for(n=0;n<o;++n)r=(0,i.B8)(t[n]),a[n]=r.r||0,s[n]=r.g||0,l[n]=r.b||0;return a=e(a),s=e(s),l=e(l),r.opacity=1,function(e){return r.r=a(e),r.g=s(e),r.b=l(e),r+""}}}var c=l((function(e){var t=e.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),o=e[i],a=e[i+1],s=i>0?e[i-1]:2*o-a,l=i<t-1?e[i+2]:2*a-o;return r((n-i/t)*t,s,o,a,l)}}));l((function(e){var t=e.length;return function(n){var i=Math.floor(((n%=1)<0?++n:n)*t),o=e[(i+t-1)%t],a=e[i%t],s=e[(i+1)%t],l=e[(i+2)%t];return r((n-i/t)*t,o,a,s,l)}}))},6773:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(8063),r=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,o=new RegExp(r.source,"g");function a(e,t){var n,a,s,l=r.lastIndex=o.lastIndex=0,c=-1,h=[],u=[];for(e+="",t+="";(n=r.exec(e))&&(a=o.exec(t));)(s=a.index)>l&&(s=t.slice(l,s),h[c]?h[c]+=s:h[++c]=s),(n=n[0])===(a=a[0])?h[c]?h[c]+=a:h[++c]=a:(h[++c]=null,u.push({i:c,x:(0,i.Z)(n,a)})),l=o.lastIndex;return l<t.length&&(s=t.slice(l),h[c]?h[c]+=s:h[++c]=s),h.length<2?u[0]?function(e){return function(t){return e(t)+""}}(u[0].x):function(e){return function(){return e}}(t):(t=u.length,function(e){for(var n,i=0;i<t;++i)h[(n=u[i]).i]=n.x(e);return h.join("")})}},9487:(e,t,n)=>{"use strict";n.d(t,{Z:()=>f});var i=n(8849),r=n(187);function o(e,t){var n,i=t?t.length:0,r=e?Math.min(i,e.length):0,o=new Array(r),a=new Array(i);for(n=0;n<r;++n)o[n]=f(e[n],t[n]);for(;n<i;++n)a[n]=t[n];return function(e){for(n=0;n<r;++n)a[n]=o[n](e);return a}}function a(e,t){var n=new Date;return e=+e,t=+t,function(i){return n.setTime(e*(1-i)+t*i),n}}var s=n(8063);function l(e,t){var n,i={},r={};for(n in null!==e&&"object"==typeof e||(e={}),null!==t&&"object"==typeof t||(t={}),t)n in e?i[n]=f(e[n],t[n]):r[n]=t[n];return function(e){for(n in i)r[n]=i[n](e);return r}}var c=n(6773),h=n(2954);function u(e,t){t||(t=[]);var n,i=e?Math.min(t.length,e.length):0,r=t.slice();return function(o){for(n=0;n<i;++n)r[n]=e[n]*(1-o)+t[n]*o;return r}}function f(e,t){var n,f,d=typeof t;return null==t||"boolean"===d?(0,h.Z)(t):("number"===d?s.Z:"string"===d?(n=(0,i.ZP)(t))?(t=n,r.ZP):c.Z:t instanceof i.ZP?r.ZP:t instanceof Date?a:(f=t,!ArrayBuffer.isView(f)||f instanceof DataView?Array.isArray(t)?o:"function"!=typeof t.valueOf&&"function"!=typeof t.toString||isNaN(t)?l:s.Z:u))(e,t)}},1102:(e,t,n)=>{"use strict";function i(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function r(e){let t=e,n=e;function r(e,t,i,r){for(null==i&&(i=0),null==r&&(r=e.length);i<r;){const o=i+r>>>1;n(e[o],t)<0?i=o+1:r=o}return i}return 1===e.length&&(t=(t,n)=>e(t)-n,n=function(e){return(t,n)=>i(e(t),n)}(e)),{left:r,center:function(e,n,i,o){null==i&&(i=0),null==o&&(o=e.length);const a=r(e,n,i,o-1);return a>i&&t(e[a-1],n)>-t(e[a],n)?a-1:a},right:function(e,t,i,r){for(null==i&&(i=0),null==r&&(r=e.length);i<r;){const o=i+r>>>1;n(e[o],t)>0?r=o:i=o+1}return i}}}n.d(t,{JG:()=>v,ZP:()=>y,yR:()=>p,l4:()=>b});var o=n(2921);const a=r(i),s=a.right,l=(a.left,r(o.Z).center,s);var c=n(9487),h=n(8063);function u(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function f(e){return+e}var d=[0,1];function p(e){return e}function g(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:(n=isNaN(t)?NaN:.5,function(){return n});var n}function m(e,t,n){var i=e[0],r=e[1],o=t[0],a=t[1];return r<i?(i=g(r,i),o=n(a,o)):(i=g(i,r),o=n(o,a)),function(e){return o(i(e))}}function _(e,t,n){var i=Math.min(e.length,t.length)-1,r=new Array(i),o=new Array(i),a=-1;for(e[i]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++a<i;)r[a]=g(e[a],e[a+1]),o[a]=n(t[a],t[a+1]);return function(t){var n=l(e,t,1,i)-1;return o[n](r[n](t))}}function v(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function b(){var e,t,n,i,r,o,a=d,s=d,l=c.Z,g=p;function v(){var e=Math.min(a.length,s.length);return g!==p&&(g=function(e,t){var n;return e>t&&(n=e,e=t,t=n),function(n){return Math.max(e,Math.min(t,n))}}(a[0],a[e-1])),i=e>2?_:m,r=o=null,b}function b(t){return null==t||isNaN(t=+t)?n:(r||(r=i(a.map(e),s,l)))(e(g(t)))}return b.invert=function(n){return g(t((o||(o=i(s,a.map(e),h.Z)))(n)))},b.domain=function(e){return arguments.length?(a=Array.from(e,f),v()):a.slice()},b.range=function(e){return arguments.length?(s=Array.from(e),v()):s.slice()},b.rangeRound=function(e){return s=Array.from(e),l=u,v()},b.clamp=function(e){return arguments.length?(g=!!e||p,v()):g!==p},b.interpolate=function(e){return arguments.length?(l=e,v()):l},b.unknown=function(e){return arguments.length?(n=e,b):n},function(n,i){return e=n,t=i,v()}}function y(){return b()(p,p)}},4182:(e,t,n)=>{"use strict";function i(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}n.d(t,{o:()=>i})},1031:(e,t,n)=>{"use strict";n.d(t,{Z:()=>k,Q:()=>C});var i=Math.sqrt(50),r=Math.sqrt(10),o=Math.sqrt(2);function a(e,t,n){var a=(t-e)/Math.max(0,n),s=Math.floor(Math.log(a)/Math.LN10),l=a/Math.pow(10,s);return s>=0?(l>=i?10:l>=r?5:l>=o?2:1)*Math.pow(10,s):-Math.pow(10,-s)/(l>=i?10:l>=r?5:l>=o?2:1)}var s,l=n(1102),c=n(4182),h=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function u(e){if(!(t=h.exec(e)))throw new Error("invalid format: "+e);var t;return new f({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function f(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function d(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,i=e.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+e.slice(n+1)]}function p(e){return(e=d(Math.abs(e)))?e[1]:NaN}function g(e,t){var n=d(e,t);if(!n)return e+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}u.prototype=f.prototype,f.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const m={"%":(e,t)=>(100*e).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>g(100*e,t),r:g,s:function(e,t){var n=d(e,t);if(!n)return e+"";var i=n[0],r=n[1],o=r-(s=3*Math.max(-8,Math.min(8,Math.floor(r/3))))+1,a=i.length;return o===a?i:o>a?i+new Array(o-a+1).join("0"):o>0?i.slice(0,o)+"."+i.slice(o):"0."+new Array(1-o).join("0")+d(e,Math.max(0,t+o-1))[0]},X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function _(e){return e}var v,b,y,w=Array.prototype.map,x=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function C(e){var t=e.domain;return e.ticks=function(e){var n=t();return function(e,t,n){var i,r,o,s,l=-1;if(n=+n,(e=+e)==(t=+t)&&n>0)return[e];if((i=t<e)&&(r=e,e=t,t=r),0===(s=a(e,t,n))||!isFinite(s))return[];if(s>0){let n=Math.round(e/s),i=Math.round(t/s);for(n*s<e&&++n,i*s>t&&--i,o=new Array(r=i-n+1);++l<r;)o[l]=(n+l)*s}else{s=-s;let n=Math.round(e*s),i=Math.round(t*s);for(n/s<e&&++n,i/s>t&&--i,o=new Array(r=i-n+1);++l<r;)o[l]=(n+l)/s}return i&&o.reverse(),o}(n[0],n[n.length-1],null==e?10:e)},e.tickFormat=function(e,n){var a=t();return function(e,t,n,a){var s,l=function(e,t,n){var a=Math.abs(t-e)/Math.max(0,n),s=Math.pow(10,Math.floor(Math.log(a)/Math.LN10)),l=a/s;return l>=i?s*=10:l>=r?s*=5:l>=o&&(s*=2),t<e?-s:s}(e,t,n);switch((a=u(null==a?",f":a)).type){case"s":var c=Math.max(Math.abs(e),Math.abs(t));return null!=a.precision||isNaN(s=function(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(p(t)/3)))-p(Math.abs(e)))}(l,c))||(a.precision=s),y(a,c);case"":case"e":case"g":case"p":case"r":null!=a.precision||isNaN(s=function(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,p(t)-p(e))+1}(l,Math.max(Math.abs(e),Math.abs(t))))||(a.precision=s-("e"===a.type));break;case"f":case"%":null!=a.precision||isNaN(s=function(e){return Math.max(0,-p(Math.abs(e)))}(l))||(a.precision=s-2*("%"===a.type))}return b(a)}(a[0],a[a.length-1],null==e?10:e,n)},e.nice=function(n){null==n&&(n=10);var i,r,o=t(),s=0,l=o.length-1,c=o[s],h=o[l],u=10;for(h<c&&(r=c,c=h,h=r,r=s,s=l,l=r);u-- >0;){if((r=a(c,h,n))===i)return o[s]=c,o[l]=h,t(o);if(r>0)c=Math.floor(c/r)*r,h=Math.ceil(h/r)*r;else{if(!(r<0))break;c=Math.ceil(c*r)/r,h=Math.floor(h*r)/r}i=r}return e},e}function k(){var e=(0,l.ZP)();return e.copy=function(){return(0,l.JG)(e,k())},c.o.apply(e,arguments),C(e)}v=function(e){var t,n,i=void 0===e.grouping||void 0===e.thousands?_:(t=w.call(e.grouping,Number),n=e.thousands+"",function(e,i){for(var r=e.length,o=[],a=0,s=t[0],l=0;r>0&&s>0&&(l+s+1>i&&(s=Math.max(1,i-l)),o.push(e.substring(r-=s,r+s)),!((l+=s+1)>i));)s=t[a=(a+1)%t.length];return o.reverse().join(n)}),r=void 0===e.currency?"":e.currency[0]+"",o=void 0===e.currency?"":e.currency[1]+"",a=void 0===e.decimal?".":e.decimal+"",l=void 0===e.numerals?_:function(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}(w.call(e.numerals,String)),c=void 0===e.percent?"%":e.percent+"",h=void 0===e.minus?"":e.minus+"",f=void 0===e.nan?"NaN":e.nan+"";function d(e){var t=(e=u(e)).fill,n=e.align,d=e.sign,p=e.symbol,g=e.zero,_=e.width,v=e.comma,b=e.precision,y=e.trim,w=e.type;"n"===w?(v=!0,w="g"):m[w]||(void 0===b&&(b=12),y=!0,w="g"),(g||"0"===t&&"="===n)&&(g=!0,t="0",n="=");var C="$"===p?r:"#"===p&&/[boxX]/.test(w)?"0"+w.toLowerCase():"",k="$"===p?o:/[%p]/.test(w)?c:"",S=m[w],E=/[defgprs%]/.test(w);function D(e){var r,o,c,u=C,p=k;if("c"===w)p=S(e)+p,e="";else{var m=(e=+e)<0||1/e<0;if(e=isNaN(e)?f:S(Math.abs(e),b),y&&(e=function(e){e:for(var t,n=e.length,i=1,r=-1;i<n;++i)switch(e[i]){case".":r=t=i;break;case"0":0===r&&(r=i),t=i;break;default:if(!+e[i])break e;r>0&&(r=0)}return r>0?e.slice(0,r)+e.slice(t+1):e}(e)),m&&0==+e&&"+"!==d&&(m=!1),u=(m?"("===d?d:h:"-"===d||"("===d?"":d)+u,p=("s"===w?x[8+s/3]:"")+p+(m&&"("===d?")":""),E)for(r=-1,o=e.length;++r<o;)if(48>(c=e.charCodeAt(r))||c>57){p=(46===c?a+e.slice(r+1):e.slice(r))+p,e=e.slice(0,r);break}}v&&!g&&(e=i(e,1/0));var D=u.length+e.length+p.length,A=D<_?new Array(_-D+1).join(t):"";switch(v&&g&&(e=i(A+e,A.length?_-p.length:1/0),A=""),n){case"<":e=u+e+p+A;break;case"=":e=u+A+e+p;break;case"^":e=A.slice(0,D=A.length>>1)+u+e+p+A.slice(D);break;default:e=A+u+e+p}return l(e)}return b=void 0===b?6:/[gprs]/.test(w)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b)),D.toString=function(){return e+""},D}return{format:d,formatPrefix:function(e,t){var n=d(((e=u(e)).type="f",e)),i=3*Math.max(-8,Math.min(8,Math.floor(p(t)/3))),r=Math.pow(10,-i),o=x[8+i/3];return function(e){return n(r*e)+o}}}}({thousands:",",grouping:[3],currency:["$",""]}),b=v.format,y=v.formatPrefix},4421:(e,t,n)=>{"use strict";function i(e){return function(){return this.matches(e)}}function r(e){return function(t){return t.matches(e)}}n.d(t,{P:()=>r,Z:()=>i})},1663:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(1226);function r(e){var t=e+="",n=t.indexOf(":");return n>=0&&"xmlns"!==(t=e.slice(0,n))&&(e=e.slice(n+1)),i.Z.hasOwnProperty(t)?{space:i.Z[t],local:e}:e}},1226:(e,t,n)=>{"use strict";n.d(t,{P:()=>i,Z:()=>r});var i="http://www.w3.org/1999/xhtml";const r={svg:"http://www.w3.org/2000/svg",xhtml:i,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"}},3838:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(2533);function r(e){return"string"==typeof e?new i.Y1([[document.querySelector(e)]],[document.documentElement]):new i.Y1([[e]],i.Jz)}},2533:(e,t,n)=>{"use strict";n.d(t,{Y1:()=>le,ZP:()=>he,Jz:()=>se});var i=n(3010);function r(e){return null==e?[]:Array.isArray(e)?e:Array.from(e)}var o=n(9701),a=n(4421),s=Array.prototype.find;function l(){return this.firstElementChild}var c=Array.prototype.filter;function h(){return Array.from(this.children)}function u(e){return new Array(e.length)}function f(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}function d(e){return function(){return e}}function p(e,t,n,i,r,o){for(var a,s=0,l=t.length,c=o.length;s<c;++s)(a=t[s])?(a.__data__=o[s],i[s]=a):n[s]=new f(e,o[s]);for(;s<l;++s)(a=t[s])&&(r[s]=a)}function g(e,t,n,i,r,o,a){var s,l,c,h=new Map,u=t.length,d=o.length,p=new Array(u);for(s=0;s<u;++s)(l=t[s])&&(p[s]=c=a.call(l,l.__data__,s,t)+"",h.has(c)?r[s]=l:h.set(c,l));for(s=0;s<d;++s)c=a.call(e,o[s],s,o)+"",(l=h.get(c))?(i[s]=l,l.__data__=o[s],h.delete(c)):n[s]=new f(e,o[s]);for(s=0;s<u;++s)(l=t[s])&&h.get(p[s])===l&&(r[s]=l)}function m(e){return e.__data__}function _(e){return"object"==typeof e&&"length"in e?e:Array.from(e)}function v(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}f.prototype={constructor:f,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};var b=n(1663);function y(e){return function(){this.removeAttribute(e)}}function w(e){return function(){this.removeAttributeNS(e.space,e.local)}}function x(e,t){return function(){this.setAttribute(e,t)}}function C(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function k(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttribute(e):this.setAttribute(e,n)}}function S(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}var E=n(2627);function D(e){return function(){delete this[e]}}function A(e,t){return function(){this[e]=t}}function M(e,t){return function(){var n=t.apply(this,arguments);null==n?delete this[e]:this[e]=n}}function R(e){return e.trim().split(/^|\s+/)}function L(e){return e.classList||new T(e)}function T(e){this._node=e,this._names=R(e.getAttribute("class")||"")}function P(e,t){for(var n=L(e),i=-1,r=t.length;++i<r;)n.add(t[i])}function z(e,t){for(var n=L(e),i=-1,r=t.length;++i<r;)n.remove(t[i])}function I(e){return function(){P(this,e)}}function O(e){return function(){z(this,e)}}function F(e,t){return function(){(t.apply(this,arguments)?P:z)(this,e)}}function B(){this.textContent=""}function N(e){return function(){this.textContent=e}}function H(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}function U(){this.innerHTML=""}function $(e){return function(){this.innerHTML=e}}function j(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}function W(){this.nextSibling&&this.parentNode.appendChild(this)}function q(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}T.prototype={add:function(e){this._names.indexOf(e)<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};var V=n(1226);function K(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===V.P&&t.documentElement.namespaceURI===V.P?t.createElement(e):t.createElementNS(n,e)}}function G(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Z(e){var t=(0,b.Z)(e);return(t.local?G:K)(t)}function X(){return null}function Y(){var e=this.parentNode;e&&e.removeChild(this)}function Q(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function J(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function ee(e){return e.trim().split(/^|\s+/).map((function(e){var t="",n=e.indexOf(".");return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}}))}function te(e){return function(){var t=this.__on;if(t){for(var n,i=0,r=-1,o=t.length;i<o;++i)n=t[i],e.type&&n.type!==e.type||n.name!==e.name?t[++r]=n:this.removeEventListener(n.type,n.listener,n.options);++r?t.length=r:delete this.__on}}}function ne(e,t,n){return function(){var i,r=this.__on,o=function(e){return function(t){e.call(this,t,this.__data__)}}(t);if(r)for(var a=0,s=r.length;a<s;++a)if((i=r[a]).type===e.type&&i.name===e.name)return this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=o,i.options=n),void(i.value=t);this.addEventListener(e.type,o,n),i={type:e.type,name:e.name,value:t,listener:o,options:n},r?r.push(i):this.__on=[i]}}var ie=n(9920);function re(e,t,n){var i=(0,ie.Z)(e),r=i.CustomEvent;"function"==typeof r?r=new r(t,n):(r=i.document.createEvent("Event"),n?(r.initEvent(t,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(t,!1,!1)),e.dispatchEvent(r)}function oe(e,t){return function(){return re(this,e,t)}}function ae(e,t){return function(){return re(this,e,t.apply(this,arguments))}}var se=[null];function le(e,t){this._groups=e,this._parents=t}function ce(){return new le([[document.documentElement]],se)}le.prototype=ce.prototype={constructor:le,select:function(e){"function"!=typeof e&&(e=(0,i.Z)(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var a,s,l=t[o],c=l.length,h=r[o]=new Array(c),u=0;u<c;++u)(a=l[u])&&(s=e.call(a,a.__data__,u,l))&&("__data__"in a&&(s.__data__=a.__data__),h[u]=s);return new le(r,this._parents)},selectAll:function(e){e="function"==typeof e?function(e){return function(){return r(e.apply(this,arguments))}}(e):(0,o.Z)(e);for(var t=this._groups,n=t.length,i=[],a=[],s=0;s<n;++s)for(var l,c=t[s],h=c.length,u=0;u<h;++u)(l=c[u])&&(i.push(e.call(l,l.__data__,u,c)),a.push(l));return new le(i,a)},selectChild:function(e){return this.select(null==e?l:function(e){return function(){return s.call(this.children,e)}}("function"==typeof e?e:(0,a.P)(e)))},selectChildren:function(e){return this.selectAll(null==e?h:function(e){return function(){return c.call(this.children,e)}}("function"==typeof e?e:(0,a.P)(e)))},filter:function(e){"function"!=typeof e&&(e=(0,a.Z)(e));for(var t=this._groups,n=t.length,i=new Array(n),r=0;r<n;++r)for(var o,s=t[r],l=s.length,c=i[r]=[],h=0;h<l;++h)(o=s[h])&&e.call(o,o.__data__,h,s)&&c.push(o);return new le(i,this._parents)},data:function(e,t){if(!arguments.length)return Array.from(this,m);var n=t?g:p,i=this._parents,r=this._groups;"function"!=typeof e&&(e=d(e));for(var o=r.length,a=new Array(o),s=new Array(o),l=new Array(o),c=0;c<o;++c){var h=i[c],u=r[c],f=u.length,v=_(e.call(h,h&&h.__data__,c,i)),b=v.length,y=s[c]=new Array(b),w=a[c]=new Array(b),x=l[c]=new Array(f);n(h,u,y,w,x,v,t);for(var C,k,S=0,E=0;S<b;++S)if(C=y[S]){for(S>=E&&(E=S+1);!(k=w[E])&&++E<b;);C._next=k||null}}return(a=new le(a,i))._enter=s,a._exit=l,a},enter:function(){return new le(this._enter||this._groups.map(u),this._parents)},exit:function(){return new le(this._exit||this._groups.map(u),this._parents)},join:function(e,t,n){var i=this.enter(),r=this,o=this.exit();return"function"==typeof e?(i=e(i))&&(i=i.selection()):i=i.append(e+""),null!=t&&(r=t(r))&&(r=r.selection()),null==n?o.remove():n(o),i&&r?i.merge(r).order():r},merge:function(e){for(var t=e.selection?e.selection():e,n=this._groups,i=t._groups,r=n.length,o=i.length,a=Math.min(r,o),s=new Array(r),l=0;l<a;++l)for(var c,h=n[l],u=i[l],f=h.length,d=s[l]=new Array(f),p=0;p<f;++p)(c=h[p]||u[p])&&(d[p]=c);for(;l<r;++l)s[l]=n[l];return new le(s,this._parents)},selection:function(){return this},order:function(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var i,r=e[t],o=r.length-1,a=r[o];--o>=0;)(i=r[o])&&(a&&4^i.compareDocumentPosition(a)&&a.parentNode.insertBefore(i,a),a=i);return this},sort:function(e){function t(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}e||(e=v);for(var n=this._groups,i=n.length,r=new Array(i),o=0;o<i;++o){for(var a,s=n[o],l=s.length,c=r[o]=new Array(l),h=0;h<l;++h)(a=s[h])&&(c[h]=a);c.sort(t)}return new le(r,this._parents).order()},call:function(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var i=e[t],r=0,o=i.length;r<o;++r){var a=i[r];if(a)return a}return null},size:function(){let e=0;for(const t of this)++e;return e},empty:function(){return!this.node()},each:function(e){for(var t=this._groups,n=0,i=t.length;n<i;++n)for(var r,o=t[n],a=0,s=o.length;a<s;++a)(r=o[a])&&e.call(r,r.__data__,a,o);return this},attr:function(e,t){var n=(0,b.Z)(e);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((null==t?n.local?w:y:"function"==typeof t?n.local?S:k:n.local?C:x)(n,t))},style:E.Z,property:function(e,t){return arguments.length>1?this.each((null==t?D:"function"==typeof t?M:A)(e,t)):this.node()[e]},classed:function(e,t){var n=R(e+"");if(arguments.length<2){for(var i=L(this.node()),r=-1,o=n.length;++r<o;)if(!i.contains(n[r]))return!1;return!0}return this.each(("function"==typeof t?F:t?I:O)(n,t))},text:function(e){return arguments.length?this.each(null==e?B:("function"==typeof e?H:N)(e)):this.node().textContent},html:function(e){return arguments.length?this.each(null==e?U:("function"==typeof e?j:$)(e)):this.node().innerHTML},raise:function(){return this.each(W)},lower:function(){return this.each(q)},append:function(e){var t="function"==typeof e?e:Z(e);return this.select((function(){return this.appendChild(t.apply(this,arguments))}))},insert:function(e,t){var n="function"==typeof e?e:Z(e),r=null==t?X:"function"==typeof t?t:(0,i.Z)(t);return this.select((function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(Y)},clone:function(e){return this.select(e?J:Q)},datum:function(e){return arguments.length?this.property("__data__",e):this.node().__data__},on:function(e,t,n){var i,r,o=ee(e+""),a=o.length;if(!(arguments.length<2)){for(s=t?ne:te,i=0;i<a;++i)this.each(s(o[i],t,n));return this}var s=this.node().__on;if(s)for(var l,c=0,h=s.length;c<h;++c)for(i=0,l=s[c];i<a;++i)if((r=o[i]).type===l.type&&r.name===l.name)return l.value},dispatch:function(e,t){return this.each(("function"==typeof t?ae:oe)(e,t))},[Symbol.iterator]:function*(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var i,r=e[t],o=0,a=r.length;o<a;++o)(i=r[o])&&(yield i)}};const he=ce},2627:(e,t,n)=>{"use strict";n.d(t,{S:()=>l,Z:()=>s});var i=n(9920);function r(e){return function(){this.style.removeProperty(e)}}function o(e,t,n){return function(){this.style.setProperty(e,t,n)}}function a(e,t,n){return function(){var i=t.apply(this,arguments);null==i?this.style.removeProperty(e):this.style.setProperty(e,i,n)}}function s(e,t,n){return arguments.length>1?this.each((null==t?r:"function"==typeof t?a:o)(e,t,null==n?"":n)):l(this.node(),e)}function l(e,t){return e.style.getPropertyValue(t)||(0,i.Z)(e).getComputedStyle(e,null).getPropertyValue(t)}},3010:(e,t,n)=>{"use strict";function i(){}function r(e){return null==e?i:function(){return this.querySelector(e)}}n.d(t,{Z:()=>r})},9701:(e,t,n)=>{"use strict";function i(){return[]}function r(e){return null==e?i:function(){return this.querySelectorAll(e)}}n.d(t,{Z:()=>r})},9920:(e,t,n)=>{"use strict";function i(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}n.d(t,{Z:()=>i})}},__webpack_module_cache__={},inProgress,dataWebpackPrefix;function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var n=__webpack_module_cache__[e]={id:e,exports:{}};return __webpack_modules__[e].call(n.exports,n,n.exports,__webpack_require__),n.exports}__webpack_require__.m=__webpack_modules__,__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=(e,t)=>{for(var n in t)__webpack_require__.o(t,n)&&!__webpack_require__.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},__webpack_require__.f={},__webpack_require__.e=e=>Promise.all(Object.keys(__webpack_require__.f).reduce(((t,n)=>(__webpack_require__.f[n](e,t),t)),[])),__webpack_require__.u=e=>e+".mdv.js",__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),inProgress={},dataWebpackPrefix="ciview2:",__webpack_require__.l=(e,t,n,i)=>{if(inProgress[e])inProgress[e].push(t);else{var r,o;if(void 0!==n)for(var a=document.getElementsByTagName("script"),s=0;s<a.length;s++){var l=a[s];if(l.getAttribute("src")==e||l.getAttribute("data-webpack")==dataWebpackPrefix+n){r=l;break}}r||(o=!0,(r=document.createElement("script")).charset="utf-8",r.timeout=120,__webpack_require__.nc&&r.setAttribute("nonce",__webpack_require__.nc),r.setAttribute("data-webpack",dataWebpackPrefix+n),r.src=e),inProgress[e]=[t];var c=(t,n)=>{r.onerror=r.onload=null,clearTimeout(h);var i=inProgress[e];if(delete inProgress[e],r.parentNode&&r.parentNode.removeChild(r),i&&i.forEach((e=>e(n))),t)return t(n)},h=setTimeout(c.bind(null,void 0,{type:"timeout",target:r}),12e4);r.onerror=c.bind(null,r.onerror),r.onload=c.bind(null,r.onload),o&&document.head.appendChild(r)}},__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;__webpack_require__.g.importScripts&&(e=__webpack_require__.g.location+"");var t=__webpack_require__.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");n.length&&(e=n[n.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),__webpack_require__.p=e})(),(()=>{__webpack_require__.b=document.baseURI||self.location.href;var e={179:0};__webpack_require__.f.j=(t,n)=>{var i=__webpack_require__.o(e,t)?e[t]:void 0;if(0!==i)if(i)n.push(i[2]);else{var r=new Promise(((n,r)=>i=e[t]=[n,r]));n.push(i[2]=r);var o=__webpack_require__.p+__webpack_require__.u(t),a=new Error;__webpack_require__.l(o,(n=>{if(__webpack_require__.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var r=n&&("load"===n.type?"missing":n.type),o=n&&n.target&&n.target.src;a.message="Loading chunk "+t+" failed.\n("+r+": "+o+")",a.name="ChunkLoadError",a.type=r,a.request=o,i[1](a)}}),"chunk-"+t,t)}};var t=(t,n)=>{var i,r,[o,a,s]=n,l=0;if(o.some((t=>0!==e[t]))){for(i in a)__webpack_require__.o(a,i)&&(__webpack_require__.m[i]=a[i]);s&&s(__webpack_require__)}for(t&&t(n);l<o.length;l++)r=o[l],__webpack_require__.o(e,r)&&e[r]&&e[r][0](),e[r]=0},n=self.webpackChunkciview2=self.webpackChunkciview2||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),__webpack_require__.nc=void 0;var __webpack_exports__={};(()=>{"use strict";var e=__webpack_require__(3379),t=__webpack_require__.n(e),n=__webpack_require__(7795),i=__webpack_require__.n(n),r=__webpack_require__(569),o=__webpack_require__.n(r),a=__webpack_require__(3565),s=__webpack_require__.n(a),l=__webpack_require__(9216),c=__webpack_require__.n(l),h=__webpack_require__(4589),u=__webpack_require__.n(h),f=__webpack_require__(6499),d={};d.styleTagTransform=u(),d.setAttributes=s(),d.insert=o().bind(null,"head"),d.domAPI=i(),d.insertStyleElement=c(),t()(f.Z,d),f.Z&&f.Z.locals&&f.Z.locals;var p=__webpack_require__(1171),g={};g.styleTagTransform=u(),g.setAttributes=s(),g.insert=o().bind(null,"head"),g.domAPI=i(),g.insertStyleElement=c(),t()(p.Z,g),p.Z&&p.Z.locals&&p.Z.locals;var m=__webpack_require__(7047),_={};_.styleTagTransform=u(),_.setAttributes=s(),_.insert=o().bind(null,"head"),_.domAPI=i(),_.insertStyleElement=c(),t()(m.Z,_),m.Z&&m.Z.locals&&m.Z.locals;var v=__webpack_require__(8520),b={};b.styleTagTransform=u(),b.setAttributes=s(),b.insert=o().bind(null,"head"),b.domAPI=i(),b.insertStyleElement=c(),t()(v.Z,b),v.Z&&v.Z.locals&&v.Z.locals;var y=__webpack_require__(5175),w={};w.styleTagTransform=u(),w.setAttributes=s(),w.insert=o().bind(null,"head"),w.domAPI=i(),w.insertStyleElement=c(),t()(y.Z,w),y.Z&&y.Z.locals&&y.Z.locals;var x=__webpack_require__(9719),C={};C.styleTagTransform=u(),C.setAttributes=s(),C.insert=o().bind(null,"head"),C.domAPI=i(),C.insertStyleElement=c(),t()(x.Z,C),x.Z&&x.Z.locals&&x.Z.locals;var k=__webpack_require__(7745),S={};S.styleTagTransform=u(),S.setAttributes=s(),S.insert=o().bind(null,"head"),S.domAPI=i(),S.insertStyleElement=c(),t()(k.Z,S),k.Z&&k.Z.locals&&k.Z.locals;var E=__webpack_require__(8503);class D{constructor(e){this.setItemFunction=e,this.menus=[]}show(e,t){this.menus.length>0&&this.remove();const n=this.setItemFunction(t);this._addMenu(n,e.pageX,e.pageY),console.log(e.clientY),e.stopPropagation(),this.removeFunc=()=>{this.remove()},this._getDocument().body.addEventListener("click",this.removeFunc)}remove(){for(let e of this.menus)e.remove();this.menus=[],this.removeFunc&&this._getDocument().body.removeEventListener("click",this.removeFunc)}_addMenu(e,t,n){let i=document.createElement("div");const r=this._getDocument();let o=this.menus.length;i.classList.add("ciview-ctm-main");for(let t of e)this._addItem(i,t,o);r.body.append(i);const a=i.getBoundingClientRect();t+a.width>r.body.clientWidth&&(t=r.body.clientWidth-a.width-3),i.style.left=t+"px",i.style.top=n+"px",this.menus.push(i)}_getDocument(){return this.__doc__?this.__doc__:document}_showSubmenu(e,t,n){for(let e=n+1;e<this.menus.length;e++)this.menus[e].remove();this.menus=this.menus.slice(0,n+1);const i=e.getBoundingClientRect();this._addMenu(t,i.left+i.width+1,i.top)}_addItem(e,t,n){const i=document.createElement("div");if(i.classList.add("ciview-ctm-item"),t.ghosted?i.classList.add("ciview-ctm-ghosted"):i.classList.add("ciview-ctm-active"),t.icon){const e=document.createElement("i");for(let n of t.icon.split(" "))e.classList.add(n);e.classList.add("ciview-ctm-left-icon"),i.appendChild(e)}const r=document.createElement("span");if(r.appendChild(document.createTextNode(t.text)),i.append(r),t.subitems){const e=document.createElement("i");e.classList.add("fas","fa-caret-right","ciview-ctm-right-icon"),i.appendChild(e)}i.addEventListener("click",(r=>{if(t.func&&!t.ghosted&&t.func(r),t.subitems){this._showSubmenu(i,t.subitems,n);for(let t of e.children)t.classList.remove("ciview-ctm-selected");i.classList.add("ciview-ctm-selected")}else this.remove();r.stopPropagation()})),e.append(i)}}var A=__webpack_require__(1445);class M{constructor(e={},t){e.doc=e.doc||document,this.config=e,this.buttons={};const n=e.width?e.width+"px":"",i=e.height?e.height+"px":"";if(this.outer=(0,A.ut)("div",{classes:["ciview-dlg-outer"],styles:{width:n,height:i}}),this.header=(0,A.ut)("div",{classes:["ciview-dlg-header"]},this.outer),(0,A.ut)("span",{classes:["ciview-dlg-header-text"],text:e.title},this.header),(0,A.ut)("i",{classes:["fas","fa-times","ciview-dlg-close-icon"]},this.header).addEventListener("click",(()=>{this.close()})),this.dialog=(0,A.ut)("div",{classes:["ciview-dlg-content"]},this.outer),(0,A.n2)(this.outer,{onresizeend:(e,t)=>{this.onResize(e,t)}}),(0,A.$q)(this.outer,{doc:e.doc,handle:".ciview-dlg-header"}),e.columns&&this._createColumns(e.columns),e.footer&&this._addFooter(),e.buttons){this.footer||this._addFooter();for(let t of e.buttons)this._addButton(t)}this.init(t),e.doc.body.append(this.outer);const r=e.doc.body.getBoundingClientRect(),o=this.outer.getBoundingClientRect();e.maxHeight&&o.height>e.maxHeight&&(o.height=e.maxHeight,this.outer.style.height=e.maxHeight+"px");let a=this.config.position;if(a||(a=[r.width/2-o.width/2,r.height/2-o.height/2]),a[0]+o.width>r.width){let e=r.width-o.width;a[0]=e<0?0:e}if(a[1]+o.height>r.height){let e=r.height-o.height;a[1]=e<0?0:e}this.outer.style.left=a[0]+"px",this.outer.style.top=a[1]+"px"}_addFooter(){this.footer=(0,A.ut)("div",{styles:{flex:"0 0 auto",padding:"5px",justifyContent:"center",display:"flex",gap:"1em"}},this.outer)}_addButton(e){const t=(0,A.ut)("button",{text:e.text,classes:["ciview-button"]},this.footer);t.addEventListener("click",(()=>this[e.method]())),e.id&&(this.buttons[e.id]=t)}disableButton(e,t){t?this.buttons[e].classList.add("ciview-disabled"):this.buttons[e].classList.remove("ciview-disabled")}_createColumns(e){this.dialog.style.display="flex",this.dialog.style.flexDirection="row",this.columns=[];for(let t=0;t<e;t++)this.columns.push((0,A.ut)("div",{styles:{height:"100%",flexBasis:"0",flexGrow:"1",padding:"0px 4px"}},this.dialog))}close(){this.config.onclose&&this.config.onclose(),this.outer.remove()}init(){}onResize(e,t){}}var R=__webpack_require__(4211),L=__webpack_require__.n(R);self.onmessage=function(e){self.postMessage(function(e){const t=new("int32"===e.data[2][1]?Int32Array:Float32Array)(e.data[2][0]),n=e.data[3],i=(n.max-n.min)/n.bins,r=n.max,o=n.min,a=t.length,s=new Array(n.bins+1).fill(0),l=new Uint8Array(e.data[0]),c=new Uint8Array(e.data[1]);for(let e=0;e<a;e++){if(0!==c[e]&&c[e]!==l[e])continue;let n=t[e];n=n>r?r:n<o?o:n,s[Math.floor((n-o)/i)]++}return s}(e))};const T=class extends M{constructor(e,t){super(e,t)}init(e){this.controls=[];for(let t of e){let e=(0,A.ut)("div",{styles:{padding:"5px"}},this.dialog);"button"!==t.type&&(0,A.ut)("label",{text:t.label},e),t.info&&this.addInfoIcon(t.info,e),this[t.type]?this.controls[t.label]=this[t.type](t,e):console.warn(`SettingsDialog doesn't have a method '${t.type}'`)}}folder(e,t){}spinner(e,t){let n=(0,A.ut)("input",{type:"number",value:e.current_value,max:e.max||null,min:e.min||0,step:e.step||1},t);n.addEventListener("change",(t=>{e.func(parseInt(n.value))}))}radiobuttons(e,t){const n=(0,A.ut)("div",{},t);for(let t of e.choices){(0,A.ut)("span",{text:t[0]},n);const i=(0,A.ut)("input",{type:"radio",name:e.label,value:t[1]},n);i.checked=e.current_value===t[1],i.addEventListener("click",(t=>{e.func(t.currentTarget.value)}))}}button(e,t){t.style.textAlign="center",(0,A.ut)("button",{classes:["ciview-button"],text:e.label},t).addEventListener("click",(t=>{e.func()}))}slider(e,t){const n=(0,A.ut)("div",{},t);L().create(n,{start:[e.current_value],range:{min:[e.min],max:[e.max]},step:e.step||null,tooltips:!0,documentElement:e.doc||this.config.doc});const i=t=>{e.func(parseFloat(t[0]))};return n.noUiSlider.on("end",i),e.continuous&&(console.log("adding update listener for ",e.label),n.noUiSlider.on("update",i)),n}check(e,t){const n=(0,A.ut)("input",{type:"checkbox"},t);n.checked=e.current_value,n.addEventListener("click",(t=>{e.func(n.checked)}))}multidropdown(e,t){const n=(0,A.ut)("select",{multiple:!0,styles:{maxWidth:"200px",height:"100px"}});(0,A.ut)("br",{},t);for(let t of e.values[0]){const i=t[e.values[2]],r={text:t[e.values[1]],value:i};-1!==e.current_value.indexOf(i)&&(r.selected=!0),(0,A.ut)("option",r,n)}return t.append(n),(0,A.ut)("br",{},t),(0,A.ut)("button",{classes:["ciview-button-sm"],text:"Change"},t).addEventListener("click",(t=>{e.func(Array.from(n.selectedOptions).map((e=>e.value)))})),n}dropdown(e,t){const n=(0,A.ut)("select",{styles:{maxWidth:"200px"}});(0,A.ut)("br",{},t);for(let t of e.values[0])(0,A.ut)("option",{text:t[e.values[1]],value:t[e.values[2]]},n);return t.append(n),n.value=e.current_value,n.addEventListener("change",(t=>{e.func(n.value),e.onchange&&e.onchange(this.controls,n.value)})),n}doubleslider(e,t){const n=(0,A.ut)("div",{styles:{}},t);L().create(n,{tooltips:!0,start:[e.current_value[0],e.current_value[1]],range:{min:[e.min],max:[e.max]},documentElement:e.doc});const i=t=>{e.func(parseFloat(t[0]),parseFloat(t[1]))};return n.noUiSlider.on("end",i),e.continuous&&n.noUiSlider.on("update",i),n}text(e,t){t.style.display="flex",t.style.alignItems="center";const n=(0,A.ut)("input",{value:e.current_value,styles:{flex:2}},t);n.addEventListener("keyup",(t=>{e.only_update_on_enter?"Enter"===t.key&&e.func(n.value):e.func(n.value)}))}textbox(e,t){const n=(0,A.ut)("textarea",{styles:{width:"100%"}},t);n.value=e.current_value,n.addEventListener("input",(t=>{e.func(n.value)})),n.addEventListener("blur",(t=>{e.func(n.value)}))}addInfoIcon(e,t){const n=(0,A.ut)("span",{"aria-label":e.text,role:"tooltip","data-microtip-size":"medium","data-microtip-position":e.position,styles:{marginLeft:"5px"},classes:["ttt"]},t);return(0,A.ut)("i",{classes:["fas","fa-info"]},n),n}};class P{constructor(e,t,n){n.color_by&&n.color_by.column&&(n.color_by=n.color_by.column.field),this.config=JSON.parse(JSON.stringify(n)),this.config.id||(this.config.id=(0,E.zO)()),this.__doc__=document,this.dataStore=e,this.listeners={},this.div="string"==typeof t?document.getElementById(t):t,this.div.classList.add("ciview-chart-panel"),this.titleBar=(0,A.ut)("div",{classes:["ciview-chart-titlebar"]}),this.title=(0,A.ut)("div",{classes:["ciview-chart-title"],text:n.title},this.titleBar),this.menuSpace=(0,A.ut)("div",{classes:["ciview-chart-menuspace"]},this.titleBar),this.contentDiv=(0,A.ut)("div",{classes:["ciview-chart-content"]}),n.title_color&&(this.titleBar.style.backgroundColor=n.title_color),this.resetButton=this.addMenuIcon("fas fa-sync","remove filter"),this.resetButton.style.display="none",this.resetButton.addEventListener("click",(()=>{this.removeFilter(),this.resetButton.style.display="none"})),this.dataStore.addListener(this.config.id,((e,t)=>{"filtered"===e?this.onDataFiltered(t):"data_changed"===e?this.onDataChanged(t):"data_added"===e?this.onDataAdded(t):"data_highlighted"===e&&this.onDataHighlighted&&this.onDataHighlighted(t)})),this.contextMenu=new D((e=>this.getContextMenu(e))),this.addMenuIcon("fas fa-bars","more").addEventListener("click",(e=>this.contextMenu.show(e))),this.addMenuIcon("fas fa-cog","settings").addEventListener("click",(e=>this._openSettingsDialog(e))),this.legendIcon=this.addMenuIcon("fas fa-info",n.legend||"No description",{size:"medium"}),this.div.append(this.titleBar),this.div.append(this.contentDiv),this.listeners={},this._setDimensions()}_getContentDimensions(){return{top:5,left:5,height:this.height,width:this.width-5}}getFilter(){}setFilter(){}addListener(e,t){this.listeners[e]=t}removeListener(e){delete this.listeners[e]}_callListeners(e,t){for(let n in this.listeners)this.listeners[n](e,t)}addMenuIcon(e,t,n={}){const i=(0,A.ut)("span",{"aria-label":t,"data-microtip-color":"red",role:"tooltip","data-microtip-size":n.size||"small","data-microtip-position":n.position||"bottom-left",styles:{margin:"0px 1px"}},this.menuSpace);return(0,A.ut)("i",{classes:["ciview-chart-icon"].concat(e.split(" "))},i),n.func&&i.addEventListener("click",(e=>n.func(e))),i}removeFilter(){}onDataFiltered(){}onDataChanged(e){const t=e.columns;if(!e.hasFiltered){let e=this.config.param,n=!1;"string"==typeof this.config.param&&(e=[this.config.param]);for(let i of e)if(-1!==t.indexOf(i)){n=!0;break}n&&this.onDataFiltered()}-1!==t.indexOf(this.config.color_by)&&this.colorByColumn(this.config.color_by)}getColorLegend(){const e={overideValues:{colorLogScale:this.config.log_color_scale}};return this._addTrimmedColor(this.config.color_by,e),this.dataStore.getColorLegend(this.config.color_by,e)}getQunatile;_addTrimmedColor(e,t){const n=this.config.trim_color_scale,i=this.dataStore.columnIndex[e];n&&"none"!==n&&i.quantiles&&"NA"!==i.quantiles&&(t.overideValues.min=i.quantiles[n][0],t.overideValues.max=i.quantiles[n][1])}setColorLegend(){if(!this.config.color_legend.display)return void(this.legend&&(this.config.color_legend.pos=[this.legend.offsetLeft,this.legend.offsetTop],this.legend.remove(),delete this.legend));const e=this._getContentDimensions();let t=0,n=0;if(this.legend)n=this.legend.style.left,t=this.legend.style.top,this.legend.remove();else{const i=this.config.color_legend;i.pos||(i.pos=[e.left,e.top]),n=i.pos[0]+"px",t=i.pos[1]+"px"}this.legend=this.getColorLegend(),this.legend?(this.contentDiv.append(this.legend),this.legend.style.left=n,this.legend.style.top=t,this.legend.__doc__=this.__doc__):console.warn("no color legend")}getColorFunction(e,t){this.config.color_by=e;const n={asArray:t,overideValues:{colorLogScale:this.config.log_color_scale}};this._addTrimmedColor(e,n);const i=this.dataStore.getColorFunction(e,n);return this.config.color_legend||(this.config.color_legend={display:!0}),this.setColorLegend(),i}onColumnRemoved(e){let t=this.config.param,n=!1;"string"==typeof this.config.param&&(t=[this.config.param]);for(let i of t)if(e===i){n=!0;break}return n?(this.remove(!1),!0):(this.colorByColumn&&this.config.color_by===e&&(delete this.config.color_by,this.colorByDefault()),!1)}onDataAdded(e){this.onDataFiltered()}addToolTip(){this._tooltip=(0,A.ut)("div",{classes:["ciview-tooltip"],stlyles:{display:"none",position:"absolute"}},this.__doc__.body)}showToolTip(e,t){this._tooltip.innerHTML=t,this._tooltip.style.display="inline-block",this._tooltip.style.left=3+e.clientX+"px",this._tooltip.style.top=3+e.clientY+"px"}hideToolTip(){this._tooltip.style.display="none"}remove(){this.titleBar.remove(),this.contentDiv.remove(),this.dataStore.removeListener(this.config.id),this._tooltip&&this._tooltip.remove()}getSettings(){const e=this.config;let t=[{type:"text",label:"Chart Name",current_value:e.title,func:e=>{this.setTitle(e)}}];const n=this.getColorOptions();if(n.colorby){const i="all"===n.colorby?["int32","text","integer","double"]:n.colorby,r=this.dataStore.getColumnList(i);r.push({name:"None",field:"_none"}),t.push({label:"Color By",type:"dropdown",values:[r,"name","field"],current_value:e.color_by||"_none",func:t=>{"_none"===t?(delete e.color_by,this.colorByDefault()):(e.color_by=t,this.colorByColumn(t))}}),t.push({label:"Show Color Legend",type:"check",current_value:!e.color_legend||e.color_legend.display,func:t=>{e.color_by&&(e.color_legend.display=t,this.setColorLegend())}}),t.push({label:"SymLog Color Scale",type:"check",current_value:e.log_color_scale,func:t=>{e.log_color_scale=t,e.color_by&&this.colorByColumn(e.color_by)}}),t.push({type:"radiobuttons",label:"Trim Color Scale to Percentile",current_value:e.trim_color_scale||"none",choices:[["No Trim","none"],["0.001","0.001"],["0.01","0.01"],["0.05","0.05"]],func:t=>{e.trim_color_scale=t,e.color_by&&this.colorByColumn(e.color_by)}})}return t}_addUnpinIcon(){this.unpinIcon=this.addMenuIcon("fas fa-thumbtack","unpin chart"),this.unpinIcon.addEventListener("click",(e=>{this.unpinIcon.remove(),this.unpinChart()}))}_openSettingsDialog(e){this.settingsDialog||(this.settingsDialog=new T({maxHeight:400,doc:this.__doc__||document,width:300,title:"Settings",position:[e.pageX,e.pageY],onclose:()=>this.settingsDialog=null},this.getSettings()))}getContextMenu(e){let t=[];return this.getImage&&(t=t.concat([{text:"create svg image",icon:"far fa-image",func:()=>this.downloadImage("svg")},{text:"create png image",icon:"far fa-image",func:()=>this.downloadImage("png")}])),this.pinChart&&!this.isPinned&&t.push({text:"pin chart",icon:"fas fa-thumbtack",func:()=>{this.pinChart(),this._addUnpinIcon()}}),this.addToContextMenu&&(t=t.concat(this.addToContextMenu())),t}getDiv(){return this.div}changeBaseDocument(e){this.contextMenu.__doc__=e,this.__doc__=e,this.settingsDialog&&this.settingsDialog.close(),this.legend&&(this.legend.__doc__=e),this._tooltip&&(this._tooltip.remove(),this.addToolTip())}_setConfigValue(e,t,n){return void 0===e[t]&&(e[t]=n),e[t]}drawChart(){}getConfig(){return this.legend&&(this.config.color_legend={display:!0,pos:[this.legend.offsetLeft,this.legend.offsetTop]}),JSON.parse(JSON.stringify(this.config))}getColorOptions(){return{}}setSize(e,t){e&&(this.div.style.height=t+"px",this.div.style.width=e+"px"),this._setDimensions()}_setDimensions(){const e=this.div.getBoundingClientRect(),t=Math.round(e.height),n=Math.round(e.width);this.config.size=[n,t];const i=this.contentDiv.getBoundingClientRect();this.height=Math.round(i.height),this.width=n}downloadImage(e){const t=this.contentDiv.style.color;this.contentDiv.style.color="black",this.getImage((n=>{let i=document.createElement("a"),r=this.config.title||"image";if(i.download=r+"."+e,"svg"===e)i.href="data:image/svg+xml,"+encodeURIComponent(n);else{let e=n.toDataURL("image/png");e=e.replace(/^data:image\/png/,"data:application/octet-stream"),i.href=e}i.click(),i.remove(),this.contentDiv.style.color=t}),e)}setTitle(e){this.title.textContent=e,this.config.title=e}getImageFromSVG(e,t){var n=e.cloneNode(!0);z(n,e);var i=document.createElement("canvas");n.style.top="0px",i.width=e.width.baseVal.value,i.height=e.height.baseVal.value;var r=i.getContext("2d");r.clearRect(0,0,i.width,i.height);var o=(new XMLSerializer).serializeToString(n),a=window.URL||window.webkitURL||window,s=new Image,l=new Blob([o],{type:"image/svg+xml;charset=utf-8"}),c=a.createObjectURL(l);s.src=c,s.onload=function(){r.drawImage(s,0,0),t(i,r)}}}function z(e,t){for(var n=["svg","g"],i=0;i<e.childNodes.length;i++){var r=e.childNodes[i];if(-1==n.indexOf(r.tagName)){var o=t.childNodes[i].currentStyle||window.getComputedStyle(t.childNodes[i]);if("undefined"!=o&&null!=o)for(var a=0;a<o.length;a++)r.style.setProperty(o[a],o.getPropertyValue(o[a]))}else z(r,t.childNodes[i])}}P.types={};const I=P;var O=__webpack_require__(3838);function F(e,t,n){e=+e,t=+t,n=(r=arguments.length)<2?(t=e,e=0,1):r<3?1:+n;for(var i=-1,r=0|Math.max(0,Math.ceil((t-e)/n)),o=new Array(r);++i<r;)o[i]=e+i*n;return o}var B=__webpack_require__(4182);class N extends Map{constructor(e,t=q){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),null!=e)for(const[t,n]of e)this.set(t,n)}get(e){return super.get(U(this,e))}has(e){return super.has(U(this,e))}set(e,t){return super.set(j(this,e),t)}delete(e){return super.delete(W(this,e))}}class H extends Set{constructor(e,t=q){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),null!=e)for(const t of e)this.add(t)}has(e){return super.has(U(this,e))}add(e){return super.add(j(this,e))}delete(e){return super.delete(W(this,e))}}function U({_intern:e,_key:t},n){const i=t(n);return e.has(i)?e.get(i):n}function j({_intern:e,_key:t},n){const i=t(n);return e.has(i)?e.get(i):(e.set(i,n),n)}function W({_intern:e,_key:t},n){const i=t(n);return e.has(i)&&(n=e.get(n),e.delete(i)),n}function q(e){return null!==e&&"object"==typeof e?e.valueOf():e}const V=Symbol("implicit");function K(){var e=new N,t=[],n=[],i=V;function r(r){let o=e.get(r);if(void 0===o){if(i!==V)return i;e.set(r,o=t.push(r)-1)}return n[o%n.length]}return r.domain=function(n){if(!arguments.length)return t.slice();t=[],e=new N;for(const i of n)e.has(i)||e.set(i,t.push(i)-1);return r},r.range=function(e){return arguments.length?(n=Array.from(e),r):n.slice()},r.unknown=function(e){return arguments.length?(i=e,r):i},r.copy=function(){return K(t,n).unknown(i)},B.o.apply(r,arguments),r}function G(){var e,t,n=K().unknown(void 0),i=n.domain,r=n.range,o=0,a=1,s=!1,l=0,c=0,h=.5;function u(){var n=i().length,u=a<o,f=u?a:o,d=u?o:a;e=(d-f)/Math.max(1,n-l+2*c),s&&(e=Math.floor(e)),f+=(d-f-e*(n-l))*h,t=e*(1-l),s&&(f=Math.round(f),t=Math.round(t));var p=F(n).map((function(t){return f+e*t}));return r(u?p.reverse():p)}return delete n.unknown,n.domain=function(e){return arguments.length?(i(e),u()):i()},n.range=function(e){return arguments.length?([o,a]=e,o=+o,a=+a,u()):[o,a]},n.rangeRound=function(e){return[o,a]=e,o=+o,a=+a,s=!0,u()},n.bandwidth=function(){return t},n.step=function(){return e},n.round=function(e){return arguments.length?(s=!!e,u()):s},n.padding=function(e){return arguments.length?(l=Math.min(1,c=+e),u()):l},n.paddingInner=function(e){return arguments.length?(l=Math.min(1,e),u()):l},n.paddingOuter=function(e){return arguments.length?(c=+e,u()):c},n.align=function(e){return arguments.length?(h=Math.max(0,Math.min(1,e)),u()):h},n.copy=function(){return G(i(),[o,a]).round(s).paddingInner(l).paddingOuter(c).align(h)},B.o.apply(u(),arguments)}var Z=__webpack_require__(1031),X=__webpack_require__(2533),Y={value:()=>{}};function Q(){for(var e,t=0,n=arguments.length,i={};t<n;++t){if(!(e=arguments[t]+"")||e in i||/[\s.]/.test(e))throw new Error("illegal type: "+e);i[e]=[]}return new J(i)}function J(e){this._=e}function ee(e,t){return e.trim().split(/^|\s+/).map((function(e){var n="",i=e.indexOf(".");if(i>=0&&(n=e.slice(i+1),e=e.slice(0,i)),e&&!t.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:n}}))}function te(e,t){for(var n,i=0,r=e.length;i<r;++i)if((n=e[i]).name===t)return n.value}function ne(e,t,n){for(var i=0,r=e.length;i<r;++i)if(e[i].name===t){e[i]=Y,e=e.slice(0,i).concat(e.slice(i+1));break}return null!=n&&e.push({name:t,value:n}),e}J.prototype=Q.prototype={constructor:J,on:function(e,t){var n,i=this._,r=ee(e+"",i),o=-1,a=r.length;if(!(arguments.length<2)){if(null!=t&&"function"!=typeof t)throw new Error("invalid callback: "+t);for(;++o<a;)if(n=(e=r[o]).type)i[n]=ne(i[n],e.name,t);else if(null==t)for(n in i)i[n]=ne(i[n],e.name,null);return this}for(;++o<a;)if((n=(e=r[o]).type)&&(n=te(i[n],e.name)))return n},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new J(e)},call:function(e,t){if((n=arguments.length-2)>0)for(var n,i,r=new Array(n),o=0;o<n;++o)r[o]=arguments[o+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=0,n=(i=this._[e]).length;o<n;++o)i[o].value.apply(t,r)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var i=this._[e],r=0,o=i.length;r<o;++r)i[r].value.apply(t,n)}};const ie=Q;var re,oe,ae=0,se=0,le=0,ce=0,he=0,ue=0,fe="object"==typeof performance&&performance.now?performance:Date,de="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function pe(){return he||(de(ge),he=fe.now()+ue)}function ge(){he=0}function me(){this._call=this._time=this._next=null}function _e(e,t,n){var i=new me;return i.restart(e,t,n),i}function ve(){he=(ce=fe.now())+ue,ae=se=0;try{!function(){pe(),++ae;for(var e,t=re;t;)(e=he-t._time)>=0&&t._call.call(void 0,e),t=t._next;--ae}()}finally{ae=0,function(){for(var e,t,n=re,i=1/0;n;)n._call?(i>n._time&&(i=n._time),e=n,n=n._next):(t=n._next,n._next=null,n=e?e._next=t:re=t);oe=e,ye(i)}(),he=0}}function be(){var e=fe.now(),t=e-ce;t>1e3&&(ue-=t,ce=e)}function ye(e){ae||(se&&(se=clearTimeout(se)),e-he>24?(e<1/0&&(se=setTimeout(ve,e-fe.now()-ue)),le&&(le=clearInterval(le))):(le||(ce=fe.now(),le=setInterval(be,1e3)),ae=1,de(ve)))}function we(e,t,n){var i=new me;return t=null==t?0:+t,i.restart((n=>{i.stop(),e(n+t)}),t,n),i}me.prototype=_e.prototype={constructor:me,restart:function(e,t,n){if("function"!=typeof e)throw new TypeError("callback is not a function");n=(null==n?pe():+n)+(null==t?0:+t),this._next||oe===this||(oe?oe._next=this:re=this,oe=this),this._call=e,this._time=n,ye()},stop:function(){this._call&&(this._call=null,this._time=1/0,ye())}};var xe=ie("start","end","cancel","interrupt"),Ce=[];function ke(e,t,n,i,r,o){var a=e.__transition;if(a){if(n in a)return}else e.__transition={};!function(e,t,n){var i,r=e.__transition;function o(l){var c,h,u,f;if(1!==n.state)return s();for(c in r)if((f=r[c]).name===n.name){if(3===f.state)return we(o);4===f.state?(f.state=6,f.timer.stop(),f.on.call("interrupt",e,e.__data__,f.index,f.group),delete r[c]):+c<t&&(f.state=6,f.timer.stop(),f.on.call("cancel",e,e.__data__,f.index,f.group),delete r[c])}if(we((function(){3===n.state&&(n.state=4,n.timer.restart(a,n.delay,n.time),a(l))})),n.state=2,n.on.call("start",e,e.__data__,n.index,n.group),2===n.state){for(n.state=3,i=new Array(u=n.tween.length),c=0,h=-1;c<u;++c)(f=n.tween[c].value.call(e,e.__data__,n.index,n.group))&&(i[++h]=f);i.length=h+1}}function a(t){for(var r=t<n.duration?n.ease.call(null,t/n.duration):(n.timer.restart(s),n.state=5,1),o=-1,a=i.length;++o<a;)i[o].call(e,r);5===n.state&&(n.on.call("end",e,e.__data__,n.index,n.group),s())}function s(){for(var i in n.state=6,n.timer.stop(),delete r[t],r)return;delete e.__transition}r[t]=n,n.timer=_e((function(e){n.state=1,n.timer.restart(o,n.delay,n.time),n.delay<=e&&o(e-n.delay)}),0,n.time)}(e,n,{name:t,index:i,group:r,on:xe,tween:Ce,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:0})}function Se(e,t){var n=De(e,t);if(n.state>0)throw new Error("too late; already scheduled");return n}function Ee(e,t){var n=De(e,t);if(n.state>3)throw new Error("too late; already running");return n}function De(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function Ae(e,t){var n,i,r,o=e.__transition,a=!0;if(o){for(r in t=null==t?null:t+"",o)(n=o[r]).name===t?(i=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(i?"interrupt":"cancel",e,e.__data__,n.index,n.group),delete o[r]):a=!1;a&&delete e.__transition}}var Me,Re=__webpack_require__(8063),Le=180/Math.PI,Te={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Pe(e,t,n,i,r,o){var a,s,l;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(l=e*n+t*i)&&(n-=e*l,i-=t*l),(s=Math.sqrt(n*n+i*i))&&(n/=s,i/=s,l/=s),e*i<t*n&&(e=-e,t=-t,l=-l,a=-a),{translateX:r,translateY:o,rotate:Math.atan2(t,e)*Le,skewX:Math.atan(l)*Le,scaleX:a,scaleY:s}}function ze(e,t,n,i){function r(e){return e.length?e.pop()+" ":""}return function(o,a){var s=[],l=[];return o=e(o),a=e(a),function(e,i,r,o,a,s){if(e!==r||i!==o){var l=a.push("translate(",null,t,null,n);s.push({i:l-4,x:(0,Re.Z)(e,r)},{i:l-2,x:(0,Re.Z)(i,o)})}else(r||o)&&a.push("translate("+r+t+o+n)}(o.translateX,o.translateY,a.translateX,a.translateY,s,l),function(e,t,n,o){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),o.push({i:n.push(r(n)+"rotate(",null,i)-2,x:(0,Re.Z)(e,t)})):t&&n.push(r(n)+"rotate("+t+i)}(o.rotate,a.rotate,s,l),function(e,t,n,o){e!==t?o.push({i:n.push(r(n)+"skewX(",null,i)-2,x:(0,Re.Z)(e,t)}):t&&n.push(r(n)+"skewX("+t+i)}(o.skewX,a.skewX,s,l),function(e,t,n,i,o,a){if(e!==n||t!==i){var s=o.push(r(o)+"scale(",null,",",null,")");a.push({i:s-4,x:(0,Re.Z)(e,n)},{i:s-2,x:(0,Re.Z)(t,i)})}else 1===n&&1===i||o.push(r(o)+"scale("+n+","+i+")")}(o.scaleX,o.scaleY,a.scaleX,a.scaleY,s,l),o=a=null,function(e){for(var t,n=-1,i=l.length;++n<i;)s[(t=l[n]).i]=t.x(e);return s.join("")}}}var Ie=ze((function(e){const t=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Te:Pe(t.a,t.b,t.c,t.d,t.e,t.f)}),"px, ","px)","deg)"),Oe=ze((function(e){return null==e?Te:(Me||(Me=document.createElementNS("http://www.w3.org/2000/svg","g")),Me.setAttribute("transform",e),(e=Me.transform.baseVal.consolidate())?Pe((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):Te)}),", ",")",")"),Fe=__webpack_require__(1663);function Be(e,t){var n,i;return function(){var r=Ee(this,e),o=r.tween;if(o!==n)for(var a=0,s=(i=n=o).length;a<s;++a)if(i[a].name===t){(i=i.slice()).splice(a,1);break}r.tween=i}}function Ne(e,t,n){var i,r;if("function"!=typeof n)throw new Error;return function(){var o=Ee(this,e),a=o.tween;if(a!==i){r=(i=a).slice();for(var s={name:t,value:n},l=0,c=r.length;l<c;++l)if(r[l].name===t){r[l]=s;break}l===c&&r.push(s)}o.tween=r}}function He(e,t,n){var i=e._id;return e.each((function(){var e=Ee(this,i);(e.value||(e.value={}))[t]=n.apply(this,arguments)})),function(e){return De(e,i).value[t]}}var Ue=__webpack_require__(8849),$e=__webpack_require__(187),je=__webpack_require__(6773);function We(e,t){var n;return("number"==typeof t?Re.Z:t instanceof Ue.ZP?$e.ZP:(n=(0,Ue.ZP)(t))?(t=n,$e.ZP):je.Z)(e,t)}function qe(e){return function(){this.removeAttribute(e)}}function Ve(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Ke(e,t,n){var i,r,o=n+"";return function(){var a=this.getAttribute(e);return a===o?null:a===i?r:r=t(i=a,n)}}function Ge(e,t,n){var i,r,o=n+"";return function(){var a=this.getAttributeNS(e.space,e.local);return a===o?null:a===i?r:r=t(i=a,n)}}function Ze(e,t,n){var i,r,o;return function(){var a,s,l=n(this);if(null!=l)return(a=this.getAttribute(e))===(s=l+"")?null:a===i&&s===r?o:(r=s,o=t(i=a,l));this.removeAttribute(e)}}function Xe(e,t,n){var i,r,o;return function(){var a,s,l=n(this);if(null!=l)return(a=this.getAttributeNS(e.space,e.local))===(s=l+"")?null:a===i&&s===r?o:(r=s,o=t(i=a,l));this.removeAttributeNS(e.space,e.local)}}function Ye(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function Qe(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function Je(e,t){var n,i;function r(){var r=t.apply(this,arguments);return r!==i&&(n=(i=r)&&Qe(e,r)),n}return r._value=t,r}function et(e,t){var n,i;function r(){var r=t.apply(this,arguments);return r!==i&&(n=(i=r)&&Ye(e,r)),n}return r._value=t,r}function tt(e,t){return function(){Se(this,e).delay=+t.apply(this,arguments)}}function nt(e,t){return t=+t,function(){Se(this,e).delay=t}}function it(e,t){return function(){Ee(this,e).duration=+t.apply(this,arguments)}}function rt(e,t){return t=+t,function(){Ee(this,e).duration=t}}function ot(e,t){if("function"!=typeof t)throw new Error;return function(){Ee(this,e).ease=t}}var at=__webpack_require__(4421);function st(e,t,n){var i,r,o=function(e){return(e+"").trim().split(/^|\s+/).every((function(e){var t=e.indexOf(".");return t>=0&&(e=e.slice(0,t)),!e||"start"===e}))}(t)?Se:Ee;return function(){var a=o(this,e),s=a.on;s!==i&&(r=(i=s).copy()).on(t,n),a.on=r}}var lt=__webpack_require__(3010),ct=__webpack_require__(9701),ht=X.ZP.prototype.constructor,ut=__webpack_require__(2627);function ft(e){return function(){this.style.removeProperty(e)}}function dt(e,t,n){return function(i){this.style.setProperty(e,t.call(this,i),n)}}function pt(e,t,n){var i,r;function o(){var o=t.apply(this,arguments);return o!==r&&(i=(r=o)&&dt(e,o,n)),i}return o._value=t,o}function gt(e){return function(t){this.textContent=e.call(this,t)}}function mt(e){var t,n;function i(){var i=e.apply(this,arguments);return i!==n&&(t=(n=i)&&gt(i)),t}return i._value=e,i}var _t=0;function vt(e,t,n,i){this._groups=e,this._parents=t,this._name=n,this._id=i}function bt(){return++_t}var yt=X.ZP.prototype;vt.prototype=function(e){return(0,X.ZP)().transition(e)}.prototype={constructor:vt,select:function(e){var t=this._name,n=this._id;"function"!=typeof e&&(e=(0,lt.Z)(e));for(var i=this._groups,r=i.length,o=new Array(r),a=0;a<r;++a)for(var s,l,c=i[a],h=c.length,u=o[a]=new Array(h),f=0;f<h;++f)(s=c[f])&&(l=e.call(s,s.__data__,f,c))&&("__data__"in s&&(l.__data__=s.__data__),u[f]=l,ke(u[f],t,n,f,u,De(s,n)));return new vt(o,this._parents,t,n)},selectAll:function(e){var t=this._name,n=this._id;"function"!=typeof e&&(e=(0,ct.Z)(e));for(var i=this._groups,r=i.length,o=[],a=[],s=0;s<r;++s)for(var l,c=i[s],h=c.length,u=0;u<h;++u)if(l=c[u]){for(var f,d=e.call(l,l.__data__,u,c),p=De(l,n),g=0,m=d.length;g<m;++g)(f=d[g])&&ke(f,t,n,g,d,p);o.push(d),a.push(l)}return new vt(o,a,t,n)},selectChild:yt.selectChild,selectChildren:yt.selectChildren,filter:function(e){"function"!=typeof e&&(e=(0,at.Z)(e));for(var t=this._groups,n=t.length,i=new Array(n),r=0;r<n;++r)for(var o,a=t[r],s=a.length,l=i[r]=[],c=0;c<s;++c)(o=a[c])&&e.call(o,o.__data__,c,a)&&l.push(o);return new vt(i,this._parents,this._name,this._id)},merge:function(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,i=t.length,r=n.length,o=Math.min(i,r),a=new Array(i),s=0;s<o;++s)for(var l,c=t[s],h=n[s],u=c.length,f=a[s]=new Array(u),d=0;d<u;++d)(l=c[d]||h[d])&&(f[d]=l);for(;s<i;++s)a[s]=t[s];return new vt(a,this._parents,this._name,this._id)},selection:function(){return new ht(this._groups,this._parents)},transition:function(){for(var e=this._name,t=this._id,n=bt(),i=this._groups,r=i.length,o=0;o<r;++o)for(var a,s=i[o],l=s.length,c=0;c<l;++c)if(a=s[c]){var h=De(a,t);ke(a,e,n,c,s,{time:h.time+h.delay+h.duration,delay:0,duration:h.duration,ease:h.ease})}return new vt(i,this._parents,e,n)},call:yt.call,nodes:yt.nodes,node:yt.node,size:yt.size,empty:yt.empty,each:yt.each,on:function(e,t){var n=this._id;return arguments.length<2?De(this.node(),n).on.on(e):this.each(st(n,e,t))},attr:function(e,t){var n=(0,Fe.Z)(e),i="transform"===n?Oe:We;return this.attrTween(e,"function"==typeof t?(n.local?Xe:Ze)(n,i,He(this,"attr."+e,t)):null==t?(n.local?Ve:qe)(n):(n.local?Ge:Ke)(n,i,t))},attrTween:function(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==t)return this.tween(n,null);if("function"!=typeof t)throw new Error;var i=(0,Fe.Z)(e);return this.tween(n,(i.local?Je:et)(i,t))},style:function(e,t,n){var i="transform"==(e+="")?Ie:We;return null==t?this.styleTween(e,function(e,t){var n,i,r;return function(){var o=(0,ut.S)(this,e),a=(this.style.removeProperty(e),(0,ut.S)(this,e));return o===a?null:o===n&&a===i?r:r=t(n=o,i=a)}}(e,i)).on("end.style."+e,ft(e)):"function"==typeof t?this.styleTween(e,function(e,t,n){var i,r,o;return function(){var a=(0,ut.S)(this,e),s=n(this),l=s+"";return null==s&&(this.style.removeProperty(e),l=s=(0,ut.S)(this,e)),a===l?null:a===i&&l===r?o:(r=l,o=t(i=a,s))}}(e,i,He(this,"style."+e,t))).each(function(e,t){var n,i,r,o,a="style."+t,s="end."+a;return function(){var l=Ee(this,e),c=l.on,h=null==l.value[a]?o||(o=ft(t)):void 0;c===n&&r===h||(i=(n=c).copy()).on(s,r=h),l.on=i}}(this._id,e)):this.styleTween(e,function(e,t,n){var i,r,o=n+"";return function(){var a=(0,ut.S)(this,e);return a===o?null:a===i?r:r=t(i=a,n)}}(e,i,t),n).on("end.style."+e,null)},styleTween:function(e,t,n){var i="style."+(e+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(null==t)return this.tween(i,null);if("function"!=typeof t)throw new Error;return this.tween(i,pt(e,t,null==n?"":n))},text:function(e){return this.tween("text","function"==typeof e?function(e){return function(){var t=e(this);this.textContent=null==t?"":t}}(He(this,"text",e)):function(e){return function(){this.textContent=e}}(null==e?"":e+""))},textTween:function(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(null==e)return this.tween(t,null);if("function"!=typeof e)throw new Error;return this.tween(t,mt(e))},remove:function(){return this.on("end.remove",function(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}(this._id))},tween:function(e,t){var n=this._id;if(e+="",arguments.length<2){for(var i,r=De(this.node(),n).tween,o=0,a=r.length;o<a;++o)if((i=r[o]).name===e)return i.value;return null}return this.each((null==t?Be:Ne)(n,e,t))},delay:function(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?tt:nt)(t,e)):De(this.node(),t).delay},duration:function(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?it:rt)(t,e)):De(this.node(),t).duration},ease:function(e){var t=this._id;return arguments.length?this.each(ot(t,e)):De(this.node(),t).ease},easeVarying:function(e){if("function"!=typeof e)throw new Error;return this.each(function(e,t){return function(){var n=t.apply(this,arguments);if("function"!=typeof n)throw new Error;Ee(this,e).ease=n}}(this._id,e))},end:function(){var e,t,n=this,i=n._id,r=n.size();return new Promise((function(o,a){var s={value:a},l={value:function(){0==--r&&o()}};n.each((function(){var n=Ee(this,i),r=n.on;r!==e&&((t=(e=r).copy())._.cancel.push(s),t._.interrupt.push(s),t._.end.push(l)),n.on=t})),0===r&&o()}))},[Symbol.iterator]:yt[Symbol.iterator]};var wt={time:null,delay:0,duration:250,ease:function(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}};function xt(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}X.ZP.prototype.interrupt=function(e){return this.each((function(){Ae(this,e)}))},X.ZP.prototype.transition=function(e){var t,n;e instanceof vt?(t=e._id,e=e._name):(t=bt(),(n=wt).time=pe(),e=null==e?null:e+"");for(var i=this._groups,r=i.length,o=0;o<r;++o)for(var a,s=i[o],l=s.length,c=0;c<l;++c)(a=s[c])&&ke(a,e,t,c,s,n||xt(a,t));return new vt(i,this._parents,e,t)};const Ct=e=>+e;var kt=__webpack_require__(4752);function St(e,t){return e.parent===t.parent?1:2}function Et(e,t){return e+t.x}function Dt(e,t){return Math.max(e,t.y)}function At(){var e=St,t=1,n=1,i=!1;function r(r){var o,a=0;r.eachAfter((function(t){var n=t.children;n?(t.x=function(e){return e.reduce(Et,0)/e.length}(n),t.y=function(e){return 1+e.reduce(Dt,0)}(n)):(t.x=o?a+=e(t,o):0,t.y=0,o=t)}));var s=function(e){for(var t;t=e.children;)e=t[0];return e}(r),l=function(e){for(var t;t=e.children;)e=t[t.length-1];return e}(r),c=s.x-e(s,l)/2,h=l.x+e(l,s)/2;return r.eachAfter(i?function(e){e.x=(e.x-r.x)*t,e.y=(r.y-e.y)*n}:function(e){e.x=(e.x-c)/(h-c)*t,e.y=(1-(r.y?e.y/r.y:1))*n})}return r.separation=function(t){return arguments.length?(e=t,r):e},r.size=function(e){return arguments.length?(i=!1,t=+e[0],n=+e[1],r):i?null:[t,n]},r.nodeSize=function(e){return arguments.length?(i=!0,t=+e[0],n=+e[1],r):i?[t,n]:null},r}const Mt=class extends I{constructor(e,t,n,i){super(e,t,n),this.svg=(0,O.Z)(this.contentDiv).append("svg").attr("width",this.width).attr("height",this.height),this.config.axis=this.config.axis||{};const r=this.config.axis;function o(e,t,n){null==e[t]&&(e[t]=n)}for(let e of[["x",25],["y",40],["ry",25],["tx",25]]){const t=i[e[0]];if(t){r[e[0]]=r[e[0]]||{};const n=r[e[0]];o(n,"textSize",13),o(n,"label",""),o(n,"size",t.size||e[1]),o(n,"tickfont",10)}}this._setMargins(),this.graph_area=this.svg.append("g").attr("transform",`translate(${this.margins.left},${this.margins.top})`),this.ry_axis_svg=this.svg.append("g"),this.tx_axis_svg=this.svg.append("g"),this.x_axis_svg=this.svg.append("g"),this.y_axis_svg=this.svg.append("g");const a=i.x;a&&(a.custom||(this.x_scale="band"===a.type?G():(0,Z.Z)(),this.x_axis_call=(0,kt.LL)(this.x_scale)),this.x_axis_label=this.x_axis_svg.append("text").style("text-anchor","middle").style("fill","black").attr("alignment-baseline","auto"));const s=i.y;s&&(s.custom||(this.y_scale="band"===s.type?G():(0,Z.Z)(),this.y_axis_call=(0,kt.y4)(this.y_scale)),this.y_axis_label=this.y_axis_svg.append("text").attr("text-anchor","middle").style("fill","black").attr("alignment-baseline","auto"));const l=i.ry;l&&l.label&&(this.ry_axis_label=this.ry_axis_svg.append("text").attr("text-anchor","middle").style("fill","black").attr("alignment-baseline","text-top"))}_setMargins(){const e=this.config.axis;this.margins={top:e.tx?e.tx.size:10,right:e.ry?e.ry.size:10,bottom:e.x?e.x.size:10,left:e.y?e.y.size:10}}_getContentDimensions(){return{top:this.margins.top,left:this.margins.left,height:this.height-this.margins.bottom-this.margins.top,width:this.width-this.margins.left-this.margins.right}}setAxisSize(e,t){switch(e){case"tx":this.margins.top=t;break;case"y":this.config.axis.y.size=t,this.margins.left=t;break;case"x":this.config.axis.x.size=t,this.margins.bottom=t}this.graph_area.attr("transform",`translate(${this.margins.left},${this.margins.top})`)}updateAxis(){const e=this._getContentDimensions(),t=this.config.axis;if(this.ry_axis_svg.attr("transform",`translate(${e.left+e.width},${e.top})`),this.tx_axis_svg.attr("transform",`translate(${e.left},0)`),this.x_axis_svg.attr("transform",`translate(${e.left},${this.height-this.margins.bottom})`),this.y_axis_svg.attr("transform",`translate(${e.left},${e.top})`),t.x&&(this.x_scale&&(this.x_scale.range([0,e.width]),this.x_axis_svg.selectAll(".tick text").attr("font-family","Helvetica"),this.x_axis_svg.transition().call(this.x_axis_call),t.x.rotate_labels?this.x_axis_svg.selectAll(".tick text").style("text-anchor","end").attr("dx","-.8em").attr("dy",".10em").attr("transform","rotate(-45)"):this.x_axis_svg.selectAll(".tick text").style("text-anchor",null).attr("dx",null).attr("dy",".71em").attr("transform",null),this.x_axis_svg.selectAll(".tick text").attr("font-size",t.x.tickfont)),this.x_axis_label.attr("x",e.width/2).attr("y",this.margins.bottom-4).text(this.config.axis.x.label).attr("font-size",this.config.axis.x.textsize+"px").attr("font-family","Helvetica")),t.y){if(this.y_scale){if(this.y_scale.range([0,e.height]),e.height/this.y_scale.domain().length<8){const t=Math.round(this.y_scale.domain().length/(e.height/10));this.y_axis_call.tickFormat(((e,n)=>n%t==0?e:""))}else this.y_axis_call.tickFormat(null);this.y_axis_svg.transition().call(this.y_axis_call),t.y.rotate_labels?this.y_axis_svg.selectAll(".tick text").style("text-anchor","end").attr("dy","1em").attr("transform","rotate(+45)"):this.y_axis_svg.selectAll(".tick text").style("text-anchor",null).attr("dx",null).attr("dy","0.32em").attr("transform",null),this.y_axis_svg.selectAll(".tick text").attr("font-size",t.y.tickfont).attr("font-family","Helvetica")}this.y_axis_label.attr("x",-e.height/2).attr("y",10-e.left).attr("transform","rotate(-90)").text(this.config.axis.y.label).attr("font-size",this.config.axis.y.textsize+"px").attr("font-family","Helvetica")}this.ry_axis_label&&this.ry_axis_label.attr("x",e.height/2).attr("y",15-this.margins.right).attr("transform","rotate(90)").text(this.config.axis.ry.label).attr("font-size",this.config.axis.ry.textsize+"px")}setSize(e,t){super.setSize(e,t),this.svg&&this.svg.attr("width",this.width).attr("height",this.height)}drawXTree(e,t,n,i){(0,O.Z)(this.contentDiv).transition().duration(400).ease(Ct);const r=this._getContentDimensions(),o=At().size([r.width,n])(e).descendants(),a=r.width/t;for(let e of o)e.children||(e.x=a/2+a*e.data.order);for(let e of o)if(!e.children){let t=e.parent;for(;t;)t.x=t.children[0].x+(t.children[1].x-t.children[0].x)/2,t=t.parent}this.tx_axis_svg.selectAll(".tree-link").data(o.slice(1)).join("path").attr("class","tree-link").style("stroke","currentColor").style("fill","none").style("stroke-width","1px").transition("trans").attr("d",(e=>{let t=e.x;return e.children||(t=a/2+a*e.data.order),`M ${t} ${e.y+i} L${t} ${e.parent.y+i} L${e.parent.x} ${e.parent.y+i}`}))}drawYTree(e,t){(0,O.Z)(this.contentDiv).transition().duration(400).ease(Ct);const n=this._getContentDimensions(),i=this.margins.right,r=At().size([n.height,i])(e).descendants(),o=n.height/t;for(let e of r)e.children||(e.x=o/2+o*e.data.order);for(let e of r)if(!e.children){let t=e.parent;for(;t;)t.x=t.children[0].x+(t.children[1].x-t.children[0].x)/2,t=t.parent}this.ry_axis_svg.selectAll(".tree-link").data(r.slice(1)).join("path").attr("class","tree-link").style("stroke","currentColor").style("fill","none").style("stroke-width","1px").transition("trans").attr("d",(e=>{let t=e.x;return e.children||(t=o/2+o*e.data.order),`M ${i-e.y} ${t} L${i-e.parent.y} ${t} L${i-e.parent.y} ${e.parent.x}`}))}getSettings(){const e=super.getSettings(),t=this.config;let n=[];return this.config.axis.y&&(n=n.concat([{type:"check",current_value:t.axis.y.rotate_labels,label:"Rotate Y axis labels",func:e=>{t.axis.y.rotate_labels=e,this.setSize()}},{type:"slider",max:20,min:4,step:1,doc:this.__doc__,current_value:t.axis.y.tickfont,label:"Y axis text size",func:e=>{t.axis.y.tickfont=e,this.setSize()}},{type:"slider",max:200,min:20,step:1,doc:this.__doc__,current_value:t.axis.y.size,label:"Y axis width",func:e=>{this.setAxisSize("y",e),this.setSize()}}])),this.config.axis.x&&(n=n.concat([{type:"check",current_value:t.axis.x.rotate_labels,label:"Rotate X axis labels",func:e=>{t.axis.x.rotate_labels=e,this.updateAxis()}},{type:"slider",max:20,min:4,step:1,doc:this.__doc__,current_value:t.axis.x.tickfont,label:"X axis text size",func:e=>{t.axis.x.tickfont=e,this.setSize()}},{type:"slider",max:200,min:20,step:1,doc:this.__doc__,current_value:t.axis.x.size,label:"X axis Height",func:e=>{this.setAxisSize("x",e),this.setSize()}}])),e.concat(n)}_addLegendToSVG(e){const t=this[e];if(!t)return;const n=[t.offsetLeft,t.offsetTop];t._leg=t.querySelector("g"),t._leg_g=(0,O.Z)(t._leg).attr("transform",`translate(${n[0]},${n[1]})`),this.svg.node().append(t._leg_g.node())}_removeLegendFromSVG(e){const t=this[e];t&&(t._leg_g.attr("transform","translate(0,0)"),this.legend.querySelector("svg").append(t._leg),delete this.legend._leg,delete this.legend._leg_g)}getImage(e,t){this.addToImage&&this.addToImage(),this._addLegendToSVG("legend"),this.extra_legends&&this.extra_legends.forEach((e=>this._addLegendToSVG(e)));const n=(new XMLSerializer).serializeToString(this.svg.node());"png"===t?this.getImageFromSVG(this.svg.node(),(t=>{e(t),this.removeFromImage&&this.removeFromImage(),this._removeLegendFromSVG("legend"),this.extra_legends&&this.extra_legends.forEach((e=>this._removeLegendFromSVG(e)))})):(e(n),this.removeFromImage&&this.removeFromImage(),this._removeLegendFromSVG("legend"),this.extra_legends&&this.extra_legends.forEach((e=>this._removeLegendFromSVG(e))))}};I.types.custom_box_plot={name:"Custom Box Plot",allow_user_add:!1,class:class extends Mt{constructor(e,t,n){super(e,t,n,{x:{type:"band"},y:{}});const i=this.config.param,r=this.dataStore.getColumnValues(i[0]);this.x_scale.domain(r.slice(0)),this.config,this.addToolTip(),this.dim=this.dataStore.getDimension("category_dimension"),this.addDenominators(),this.onDataFiltered()}onDataFiltered(){const e=this.config.param;let t=null;3===e.length&&(t=this.dataStore.getColumnValues(this.config.param[2]).indexOf(this.config.category)),this.dim.getSankeyData((e=>{this.data=e,this.drawChart()}),e,{method:"proportion",category:t,denominators:this.denom})}remove(e=!0){this.dim.destroy(e),super.remove()}setSize(e,t){super.setSize(e,t),this.drawChart()}addDenominators(){const e=this.config.denominators;if(this.denom=null,e){this.denom=[];const t=this.dataStore.getColumnValues(this.config.param[1]);for(let n=0;n<t.length;n++)this.denom.push(e[t[n]]||100)}}drawChart(){const e=(0,O.Z)(this.contentDiv).transition().duration(200).ease(Ct),t=this.config.param;this.y_scale.domain([this.data.max+this.data.max/10,0]),this.updateAxis();const n=this.dataStore.getColumnColors(t[0]),i=this.dataStore.getColumnValues(t[0]),r=this.dataStore.getColumnValues(t[1]),o=this._getContentDimensions().width/i.length,a=this,s=o/5,l=o/10,c=o/4,h=o/5;this.graph_area.selectAll(".cbp-col").data(this.data).join("g").attr("transform",((e,t)=>`translate(${t*o},0)`)).attr("class","cbp-col").selectAll(".cbp-circle").data((e=>e)).join("circle").attr("class","cbp-circle").on("mouseover mousemove",((e,t)=>{const n=`${i[t[1]]}<br>${r[t[2]]}`;a.showToolTip(e,n)})).on("mouseleave",(()=>{a.hideToolTip()})).transition(e).attr("cy",((e,t)=>a.y_scale(e[0]))).attr("fill",((e,t)=>n[e[1]])).attr("r",5).attr("cx",(e=>s+l*e[3])),this.graph_area.selectAll(".cbp-rect").data(this.data).join("path").attr("d",((e,t)=>{const n=t*o+o/2,i=a.y_scale(e.av);let r=e.av+e.std;r=a.y_scale(r>e.max?e.max:r);let s=e.av-e.std;return s=a.y_scale(s<e.min?e.min:s),`M${n} ${r} L${n} ${s}\n                    M${n-c} ${i} L${n+c} ${i} \n                    M${n-h} ${r} L${n+h} ${r}     \n                    M${n-h} ${s} L${n+h} ${s}      `})).style("fill","none").style("stroke","currentColor").attr("stroke-width",1).attr("class","cbp-rect")}}};var Rt=__webpack_require__(4677);I.types.multi_box_plot={name:"Multi BoxPlot",class:class extends Mt{constructor(e,t,n){super(e,t,n,{x:{type:"band"},y:{}});const i=this.config;i.type="multi_box_plot";const r=[];this.dim=this.dataStore.getDimension("catrange_dimension");for(let e=1;e<i.param.length;e++)r.push(this.dataStore.getColumnName(i.param[e]));this.x_scale.domain(r),this.names=r,this.y_scale.domain([1,0]),this.addToolTip(),this.onDataFiltered()}onDataFiltered(e){const t={analysis:"multi",scaleVals:[],category:this.config.category},n=this.config.param;let i=this.config.percentile_trim;for(let e=1;e<n.length;e++){const r=this.dataStore.columnIndex[n[e]];t.scaleVals.push([i?r.quantiles[i][0]:r.minMax[0],i?r.quantiles[i][1]:r.minMax[1]])}this.dim.getMultiBoxPlotData((e=>{this.data=e,this.drawChart()}),this.config.param,t)}setSize(e,t){super.setSize(e,t),this.drawChart()}remove(e=!0){this.dim.destroy(e),super.remove()}getSettings(){const e=super.getSettings(),t=this.config;return e.push({type:"radiobuttons",label:"Trim  to Percentile",current_value:t.percentile_trim||"none",choices:[["No Trim","none"],["0.001","0.001"],["0.01","0.01"],["0.05","0.05"]],func:e=>{"none"===e?delete t.percentile_trim:t.percentile_trim=e,this.onDataFiltered()}}),e}drawChart(){this.y_scale.domain([this.data.max,this.data.min]),this.updateAxis();const e=this,t=(0,O.Z)(this.contentDiv).transition().duration(400).ease(Ct),n=this.y_scale,i=this._getContentDimensions().width/(this.config.param.length-1),r=Rt.HT;this.graph_area.selectAll(".boxplot-rect").data(this.data).join("rect").attr("class","boxplot-rect").on("mouseover mousemove",((t,n)=>{const i=`${e.names[n.id]}`;e.showToolTip(t,i)})).on("mouseleave",(()=>{e.hideToolTip()})).transition(t).attr("x",((e,t)=>t*(i-3)+3*(t+1))).attr("y",(e=>n(e.Q3))).attr("width",i-6>1?i-6:1).attr("height",(e=>{const t=n(e.Q1)-n(e.Q3);return isNaN(t)?0:t})).attr("fill","none").attr("stroke",((e,t)=>r[t])).attr("stroke-width",3),this.graph_area.selectAll(".boxplot-whisker").data(this.data).join("path").attr("class","boxplot-whisker").transition(t).attr("stroke",((e,t)=>r[t])).attr("fill","none").attr("stroke-width",3).attr("d",((e,t)=>{if(isNaN(e.med))return"";const r=t*(i-6)+6*(t+1),o=t*(i-3)+3*(t+1),a=t*i+.5*i,s=n(e.max),l=n(e.min);return null==s||null==l?"":`\n             M${r} ${s} L${r+i-12} ${s}\n             M${a} ${s} L${a} ${n(e.Q3)}\n             M${o} ${n(e.med)} L${o+i-6} ${n(e.med)}\n             M${a} ${l} L${a} ${n(e.Q1)}\n             M${r} ${l} L${r+i-12} ${l}`}))}},allow_user_add:!1,params:[{type:"_multi_column:number",name:"Fields"}]};class Lt{constructor(e,t={}){this.dataStore=e,this.data=new Int32Array(0);for(let e=0;e<0;e++)this.data[e]=e;this.size=0,null!=t.autoupdate&&!0!==t.autoupdate||e.addListener("sss",(e=>{"filtered"===e&&this.updateModel()})),this.listeners={}}getLength(){return this.size}addListener(e,t){this.listeners[e]=t}setColumns(e){this.columns=e}sort(e,t){const n=this.dataStore.getRawColumn(e),i=this.dataStore.columnIndex[e];if("unique"===i.datatype){const e={},r=new TextDecoder,o=i.stringLength,a="desc"===t?1:-1;for(let t=0;t<this.data.length;t++){const i=this.data[t];e[i]=r.decode(n.slice(i*o,i*o+o))}this.data.sort(((t,n)=>e[t].localeCompare(e[n])*a))}else"desc"===t?this.data.sort(((e,t)=>{let i=n[e],r=n[t];return i=isNaN(i)?Number.MAX_VALUE:i,r=isNaN(r)?Number.MAX_VALUE:r,i-r})):this.data.sort(((e,t)=>{let i=n[e],r=n[t];return i=isNaN(i)?Number.MIN_VALUE:i,r=isNaN(r)?Number.MIN_VALUE:r,r-i}))}createColumn(e,t){const n={name:e,field:e,datatype:"text",values:[""]},i=new SharedArrayBuffer(this.dataStore.size);if(t){const e=this.dataStore.getRawColumn(t);new Uint8Array(i).set(e),n.values=this.dataStore.getColumnValues(t).slice(0)}this.dataStore.addColumn(n,i,!0)}removeColumn(e){this.dataStore.removeColumn(e,!0,!0)}getDataAsBlob(e="\t",t="\n"){return this.dataStore.getDataAsBlob(this.columns,this.data,e,t)}getValueSuggestion(e,t){const n=this.dataStore.getColumnValues(t);for(let t of n){if(t===e)return t;if(t.startsWith(e))return t}return null}_getValueIndex(e,t){let n=t.values.indexOf(e);if(-1===n){if(t.values.push(e),t.values.length>256)throw new Error(`text column '${t.name}' exceeded 256 values when adding '${e}'`);n=t.values.length-1}return n}updateValue(e,t,n,i=!0){const r=this.dataStore.columnIndex[n];let o=this._getValueIndex(e,r);r.data[t]=o,i&&this.dataStore.dataChanged([n])}updateRange(e,t,n,i){const r=this.dataStore.getRawColumn(e),o="+"===i?r[this.data[t]]:r[this.data[n]];let a="+"===i?t:n,s="+"===i?1:-1,l="+"===i?n+1:t-1;for(;a!==l;a+=s)r[this.data[a]]=o;this.dataStore.dataChanged([e])}replaceValues(e,t,n,i=!0){const r=this.dataStore.columnIndex[n];let o=this._getValueIndex(e,r);if("_all_"===t)for(let e=0;e<this.data.length;e++)r.data[this.data[e]]=o;else if("_blank_"===t){let t=r.values.indexOf(e);if(-1===t)return;for(let e=0;e<this.data.length;e++){const n=this.data[e];r.data[n]===t&&(r.data[this.data[e]]=o)}}else{if("_delete_"==t)return void this.dataStore.cleanColumnData(n);{let e=this._getValueIndex(t,r);for(let t=0;t<this.data.length;t++){const n=this.data[t];r.data[n]===o&&(r.data[this.data[t]]=e)}}}i&&this.dataStore.dataChanged([n])}updateModel(){const e=this.dataStore.filterArray;this.data=new Int32Array(this.dataStore.filterSize);const t=this.data,n=this.dataStore.size;let i=0;for(let r=0;r<n;r++)0===e[r]&&(t[i++]=r);this.size=this.dataStore.filterSize;for(let e in this.listeners)this.listeners[e]()}getId(e){return this.data[e]}getItemField(e,t){return this.dataStore.getRowAsObject(this.data[e],[t])[t]}getItem(e){return this.dataStore.getRowAsObject(this.data[e],this.columns)}}I.types.image_table_chart={class:class extends I{constructor(e,t,n){super(e,t,n),this.dataModel=new Lt(e,{autoupdate:!1}),this.dataModel.setColumns(this.config.param),this.dataModel.updateModel();const i=this.config;i.margins=i.margins||{top_bottom:10,left_right:10},this.grid=new class{constructor(e,t,n){"string"==typeof e&&(e=document.getElementById("#"+e)),n||(n={}),this.domId=this._getRandomString(),this.row_first=0,this.row_last=139,this.tile_height=205,this.tile_width=205;let i=this;this.__doc__=document,this.display_columns=[],this.selection_mode=!0,this.imageFunc=n.imageFunc,this.base_url=n.base_url,this.parent=e,this.selected_tiles={},this.cache_size=5;const r=this.parent.getBoundingClientRect();this.config=n,n.background_color,this.view_port=(0,A.ut)("div",{styles:{height:r.height+"px",width:r.width+"px",overflow:"auto"}},this.parent),this.canvas=(0,A.ut)("div",{styles:{position:"relative"}},this.view_port),this.canvas.addEventListener("click",(e=>{this.imageClicked(e,e.srcElement)})),this.canvas.addEventListener("mouseover",(e=>{this.mouseOver(e,e.srcElement)})),this.canvas.addEventListener("keydown",(e=>{this.keyPressed(e)})),this.data_view=t,this._setCanvasHeight(),this.view_port.addEventListener("scroll",(e=>this._hasScrolled(e))),this.parent.append(this.view_port),this.resize_timeout=null,this.resize_timeout_length=50,this.listeners={image_clicked:new Map,image_over:new Map,image_out:new Map,data_changed:new Map,image_selected:new Map},this.highlightcolors=null,this.tag_color_palletes={},this.image_suffix=n.image_suffix?n.image_suffix:".png",n.columns&&this.setColumns(n.columns);let o=new Image;o.onload=function(e){i.originalDimensions=[o.width,o.height],i.preferred_width=i.img_width=o.width,i.preferred_height=i.img_height=o.height,n.initial_image_width&&(i.preferred_width=n.initial_image_width,i.preferred_height=Math.round(i.preferred_width/i.img_width*i.img_height)),i._resize()};const a=this.config.base_url,s=this.config.image_type,l=this.data_view.getItemField(1,this.config.image_key);o.src=`${a}${l}.${s}`}mouseOver(e,t){if(t.id){let n=t.id.split("-"),i=parseInt(n[1]),r=this.data_view.getItem(i);if(!r)return;if(this.image_over){if(r.id===this.image_over.id)return;this.listeners.image_out.forEach((t=>{t(e,this.image_over[0],self.image_over[1])}))}this.listeners.image_over.forEach((n=>{n(e,r,t)})),this.image_over=t}else this.image_over&&this.listeners.image_out.forEach((t=>{t(e,self.image_over[0],self.image_over[1])})),this.image_over=null}imageClicked(e,t){let n=t.id;if(n||(n=t.parentElement.id),!n)return;let i=n.split("-");if("mlvtile"===i[0]){let n=null,r=parseInt(i[2]);if(e.shiftKey&&null!=self.last_img_clicked){const e=this.last_img_clicked.index;range=[],n=[];let t=e+1,i=r+1;-1==(r-e<0?-1:1)&&(t=r,i=e);for(let e=t;e<i;e++){let t=this.data_view.getId(e);n.push(t)}n.push(this.data_view.getId(e))}const o=this.data_view.getId(r);this.listeners.image_clicked.forEach((n=>{n(e,o,t)})),this.last_index_clicked=r,this.selection_mode&&this.setSelectedTiles([r],e.ctrlKey,!0)}}keyPressed(e){if(39===e.which||40===e.which){if(this.last_index_clicked===this.data_view.getFilteredItems().length-1)return;(this.last_index_clicked||0===this.last_index_clicked)&&(this.last_index_clicked++,this.setSelectedTiles([this.data_view.getItem(this.last_index_clicked).id],!1,!0),this.last_index_clicked>this.getLastTileInView()&&this.show(this.last_index_clicked))}else if(37===e.which||38===e.which){if(0===this.last_index_clicked)return;this.last_index_clicked&&(this.last_index_clicked--,this.setSelectedTiles([this.data_view.getItem(this.last_index_clicked).id],!1,!0),this.last_index_clicked<this.getFirstTileInView()&&this.show(this.last_index_clicked))}}addListener(e,t,n){let i=this.listeners[e];return i?(n||(n=this._getRandomString()),i.set(n,t),n):null}removeListener(e,t){let n=this.listeners[e];return!!n&&n.delete(t)}setImageWidth(e,t){this.setImageDimensions([e,Math.round(e/this.img_width*this.img_height)],t)}setImageLabel(e){this.config.image_label=e;const t=this.getFirstTileInView();this.setImageDimensions(),this.show(t)}setImageDimensions(e,t){this.lrm=this.config.margins.left_right,this.tbm=this.config.margins.top_bottom;let n=this.getFirstTileInView();e?(this.preferred_width=e[0],this.preferred_height=e[1]):e=[this.preferred_width,this.preferred_height],this.width<this.preferred_width+2*this.lrm&&0!==this.width?(e[0]=this.width-3*this.lrm,this.num_per_row=1):(this.num_per_row=Math.ceil((this.width-this.lrm)/(this.preferred_width+this.lrm)),e[0]=Math.floor((this.width-2*this.lrm)/this.num_per_row)-this.lrm),e[1]=Math.round(e[0]/this.preferred_width*this.preferred_height),this.config.image_label&&(this.label_size=Math.round(e[1]/12),this.label_size=Math.max(this.label_size,12),this.tbm=this.tbm<this.label_size+4?this.label_size+4:this.tbm),this.tile_width=parseInt(e[0])+this.lrm,this.tile_height=parseInt(e[1])+this.tbm,this.t_width=parseInt(e[0]),this.t_height=parseInt(e[1]);let i=Math.floor((this.height+this.cache_size*this.tile_height)/this.tile_height);this.max_difference=i+this.cache_size,t&&this.show(n)}resize(){let e=this;clearTimeout(this.resize_timeout),e.resize_timeout=setTimeout((()=>{e._resize()}),e.resize_timeout_length)}getFirstTileInView(){let e=this.view_port.scrollTop;return Math.floor(e/this.tile_height)*this.num_per_row}getLastTileInView(){let e=this.view_port.scrollTop+this.view_port.height();return Math.floor(e/this.tile_height)*this.num_per_row}setColumns(e){this.columns=e}setColorBy(e){this.color_by=e}_setCanvasHeight(){let e=Math.ceil(this.data_view.getLength()/this.num_per_row)*this.tile_height+this.tbm;this.canvas.style.height=e+"px"}_hasScrolled(){clearTimeout(this.scroll_timeout);let e=this.view_port.scrollTop,t=Math.floor((e-this.cache_size*this.tile_height)/this.tile_height),n=Math.floor((e+this.height+this.cache_size*this.tile_height)/this.tile_height);t<0&&(t=0);let i=10;Math.abs(t-this.row_displayed_first)>this.max_difference&&(i=50),this.scroll_timeout=setTimeout((()=>{Math.abs(t-this.row_displayed_first)>this.max_difference?this.render(t,n,!0):this.render(t,n)}),i)}_removeByClass(e){document.querySelectorAll(e).forEach((e=>e.remove()))}render(e,t,n){if(n){this.canvas.innerHTML="";for(let n=e;n<t;n++)this._addRow(n)}else{if(e===this.row_displayed_first&&0!==e)return;if(e<this.row_displayed_first){for(let t=e;t<this.row_displayed_first;t++)this._addRow(t);for(let e=t;e<this.row_displayed_last;e++)this._removeByClass(`.mlv-tile-${this.domId}-${e}`)}else{for(let e=this.row_displayed_last;e<t;e++)this._addRow(e);for(let t=this.row_displayed_first;t<e;t++)this._removeByClass(`.mlv-tile-${this.domId}-${t}`)}}this.row_displayed_first=e,this.row_displayed_last=t}_resize(e){e||(e=this.getFirstTileInView());const t=this.parent.getBoundingClientRect();this.width=Math.round(t.width),this.height=Math.round(t.height),this.view_port.style.height=this.height+"px",this.view_port.style.width=this.width+"px",this.setImageDimensions(),this.show(e)}_calculateTopBottomRow(e){e||(e=0);let t=0;t=e||0===e?Math.floor(e/this.num_per_row)*this.tile_height:this.view_port.scrollTop;let n=this.view_port.getBoundingClientRect().height,i=Math.floor((t-this.cache_size*this.tile_height)/this.tile_height);return i<0&&(i=0),{top:i,bottom:Math.floor((t+n+this.cache_size*this.tile_height)/this.tile_height),scroll_top:t}}setSelectedTiles(e,t,n){if(!t){for(let e in this.selected_tiles){let t=this.__doc__.getElementById(`mlvtile-${this.domId}-${e}`);t&&(t.style.border=this.selected_tiles[e])}this.selected_tiles={}}for(let t of e){let e=this.__doc__.getElementById(`mlvtile-${this.domId}-${t}`);e&&(this.selected_tiles[t]=e.style.border,e.style.border="4px solid goldenrod",console.log(e.style.border))}n&&this.listeners.image_selected.forEach((t=>{t(e)}))}scrollToTile(e,t){const n=this.data_view.data.indexOf(e);let i=this._calculateTopBottomRow(n);Math.abs(i.top-this.row_displayed_first)>this.max_difference?this.render(i.top,i.bottom,!0):this.render(i.top,i.bottom),this.view_port.scrollTop=i.scroll_top,t&&this.setSelectedTiles([n])}_getRandomString(e,t){e||(e=6);let n="",i=0,r="a"==(t=t&&t.toLowerCase())?10:0,o="n"==t?10:62;for(;i++<e;){let e=Math.random()*(o-r)+r<<0;n+=String.fromCharCode(e+=e>9?e<36?55:61:48)}return n}show(e){e||(e=0),this._setCanvasHeight();let t=this._calculateTopBottomRow(e);this.render(t.top,t.bottom,!0),this.view_port.scrollTop=t.scroll_top}_addRow(e){const t=this.config.image_label;let n=e*this.num_per_row,i=n+this.num_per_row,r=e*this.tile_height+this.tbm,o=0;const a=this.t_width+"px",s=this.t_height+"px",l=this.config.base_url,c=this.config.image_type;for(let h=n;h<i;h++){const n=this.data_view.getId(h);if(null==n)return;const i=this.data_view.getItemField(h,this.config.image_key);let u=o*this.tile_width+this.lrm;o++;let f="";this.color_by&&(f="4px solid "+this.color_by(n));let d=[];this.selected_tiles[n]&&(f="4px solid goldenrod"),(0,A.ut)("img",{src:`${l}${i}.${c}`,id:`mlvtile-${this.domId}-${h}`,styles:{border:f,height:s,width:a,left:u+"px",top:r+"px"},classes:["mlv-tile",`mlv-tile-${this.domId}`,`mlv-tile-${this.domId}-${e}`].concat(d)},this.canvas),t&&(0,A.ut)("div",{text:this.data_view.getItemField(h,t),classes:["mdv-image-label"],styles:{width:a,fontSize:`${this.label_size}px`,top:r-this.label_size+"px",left:u+"px"}},this.canvas)}}}(this.contentDiv,this.dataModel,{base_url:i.images.base_url,image_type:i.images.type,image_key:i.param[0],initial_image_width:i.image_width,image_label:i.image_label,margins:i.margins}),this.grid.addListener("image_clicked",((e,t)=>{this.dataStore.dataHighlighted([t],this)}),i.id),this.sortBy(i.sortBy,i.sortOrder)}setSize(e,t){super.setSize(e,t),this.grid.resize()}onDataFiltered(){this.dataModel.updateModel(),this.grid.show()}getColorOptions(){return{colorby:"all"}}onDataHighlighted(e){if(e.source===this)return;const t=e.indexes[0];this.grid.scrollToTile(t,!0)}setImageLabel(e){this.config.image_label=e,this.grid.setImageLabel(e)}colorByColumn(e){this.grid.setColorBy(this.getColorFunction(e,!1));const t=this.grid.getFirstTileInView();this.grid.show(t)}colorByDefault(){this.grid.setColorBy(null);const e=this.grid.getFirstTileInView();this.grid.show(e)}sortBy(e,t=!0){this.config.sortBy=e,this.config.sortOrder=t,this.dataModel.sort(e,t?"asc":"desc");const n=this.grid.getFirstTileInView();this.grid.show(n)}getSettings(){const e=this.grid.originalDimensions,t=this.config,n=super.getSettings(),i=this.dataStore.getColumnList("all",!0);return n.concat([{type:"slider",max:4*e[1],min:10,doc:this.__doc__,label:"Image Size",current_value:t.image_width||e[0],func:e=>{t.image_width=e,this.grid.setImageWidth(e,!0)}},{label:"Label",type:"dropdown",values:[i,"name","field"],current_value:t.image_label||"__none__",func:e=>{this.setImageLabel("__none__"===e?null:e)}},{label:"Sort By",type:"dropdown",values:[i,"name","field"],current_value:t.sortBy||"__none__",func:e=>{this.sortBy("__none__"===e?null:e)}},{label:"Sort Ascending?",type:"check",current_value:t.sortOrder||!0,func:e=>{this.sortBy(t.sortBy,e)}}])}changeBaseDocument(e){super.changeBaseDocument(e),this.grid.__doc__=e}},name:"Image Table",required:["images"],methodsUsingColumns:["setImageLabel"],configEntriesUsingColumns:["image_label"],init:(e,t,n)=>{const i=t.images[n.image_set];e.param=[i.key_column],e.images={base_url:i.base_url,type:i.type},e.sortBy=n.sort_by,e.sortOrder=n.sort_order},extra_controls:e=>{const t=[];for(let n in e.images)t.push({name:n,value:n});return[{type:"dropdown",name:"image_set",label:"Image Set",values:t},{type:"dropdown",name:"sort_by",label:"Sort By",values:e.getLoadedColumns().map((e=>({name:e,value:e})))},{type:"check",name:"sort_order",label:"Sort Ascending",value:!0}]}};function Tt(e){return"object"==typeof e&&"length"in e?e:Array.from(e)}function Pt(e){return function(){return e}}function zt(e,t){return t<e?-1:t>e?1:t>=e?0:NaN}function It(e){return e}I.types.single_heat_map={name:"Single Heat Map",allow_user_add:!1,class:class extends Mt{constructor(e,t,n){super(e,t,n,{x:{type:"band"},y:{type:"band"}}),n.title||this._setTitle();const i=this.config.param;let r=this.dataStore.getColumnValues(i[0]);this.y_scale.domain(r.slice(0)),r=this.dataStore.getColumnValues(i[1]),this.x_scale.domain(r.slice(0));const o=this.config;o.color_scale=o.color_scale||{log:!1},o.color_legend||(o.color_legend={display:!0}),this.setColorFunction(),this.initialSetUp(),this.addToolTip(),this.drawChart()}remove(e=!0){super.remove()}onDataHighlighted(e){const t=e.indexes[0],n=this.graph_area.selectAll("rect");n.attr("stroke","white").style("stroke-width","0px"),n.filter((e=>!(!e||e[3]!==t))).attr("stroke","black").style("stroke-width","4px"),this.highlight=t}_setTitle(){const e=this.config.category,t=this.dataStore.getColumnName(this.config.param[2]);this.setTitle(`${e}-${t}`)}changeCategory(e){this.config.category=e,this.initialSetUp(),this.drawChart(),this._setTitle()}onDataFiltered(e){this.drawChart()}changeValues(e){this.config.param[2]=e,this.setColorFunction(),this.initialSetUp(),this.drawChart(),this._setTitle()}initialSetUp(){const e=this.config,t=e.param,n=this.dataStore.columnIndex[t[0]],i=n.data,r=this.dataStore.columnIndex[t[1]],o=r.data;let a=null,s=null,l=n.values.length,c=r.values.length;const h=e.specific_only;h&&(a=h[0].map((e=>n.values.indexOf(e))),s=h[1].map((e=>r.values.indexOf(e))),l=h[0].length,c=h[1].length,this.y_scale.domain(h[0].slice(0)),this.x_scale.domain(h[1].slice(0)));const u=this.dataStore.columnIndex,f=u[t[3]].data,d=u[t[2]].data,p=this.dataStore.size,g=new Array;for(let e=0;e<l;e++)g[e]=new Array(c);const m=this.dataStore.columnIndex[t[3]].values.indexOf(e.category);let _=null,v=null;e.show_group_interactions&&(_=this.dataStore.getRawColumn(t[4]),v=this.dataStore.getRawColumn(t[5]));for(let e=0;e<p;e++)if(f[e]===m){let t=i[e],n=o[e];if(h&&(n=a.indexOf(n),t=s.indexOf(t),-1===n||-1===t))continue;let r=g[n][t];r?(r[2]+=d[e],r[4]++):(g[n][t]=[i[e],o[e],d[e],e,1],_&&g[n][t].push(`${_[e]}-${v[e]}`))}for(let e=0;e<l;e++)for(let t=0;t<c;t++){const n=g[e][t];n[2]/=n[4]}this.data=g}drawChart(e=300){const t=(0,O.Z)(this.contentDiv).transition().duration(e).ease(Ct),n=this.config.param,i=this.dataStore.getColumnValues(this.config.param[0]),r=this.dataStore.getColumnValues(this.config.param[1]),o=this.config.specific_only,a=o?o[0].length:i.length,s=o?o[1].length:r.length,l=this._getContentDimensions(),c=l.width/s,h=this,u=l.height/a,f=this.dataStore.filterArray,d="#E0E0E0";let p=null;if(this.config.show_group_interactions){p={};const e=this.dataStore.getColumnValues(n[4]),t=this.dataStore.getColumnValues(n[5]);for(let n in e)for(let e in t)p[`${n}-${e}`]=0}if(this.graph_area.selectAll(".heatmap-row").data(this.data).join("g").attr("transform",((e,t)=>`translate(0,${t*u})`)).attr("class","heatmap-row").selectAll(".heatmap-rect").data((e=>e)).join("rect").attr("class","heatmap-rect").attr("x",((e,t)=>t*c+1)).attr("height",u-2).attr("width",c-2).on("click",((e,t)=>{h.dataStore.dataHighlighted([t[3]],h)})).on("mouseover mousemove",((e,t)=>{const n=r[t[0]],o=i[t[1]];h.showToolTip(e,`${n}<br>${o}<br>${t[2].toPrecision(3)}`)})).on("mouseleave",(()=>{h.hideToolTip()})).transition(t).attr("fill",((e,t)=>e?isNaN(e[2])||f[e[3]]>0?d:(p&&p[e[5]]++,h.colorFunction(e[2])):d)),p){const e=this.dataStore.getColumnValues(n[4]),t=this.dataStore.getColumnValues(n[5]),i=[];for(let n in p){const r=n.split("-");i.push(`${e[r[0]]}-${t[r[1]]}:${p[n]}`),this.legendIcon.setAttribute("aria-label",i.join(", "))}}this.updateAxis()}setSize(e,t){super.setSize(e,t),this.drawChart()}getColorLegend(){const e={overideValues:{colorLogScale:this.config.color_scale.log,colors:["#313695","#4575B4","#74ADD1","#ABD9E9","#E0F3F8","#E0F3F8","#FFFFBF","#FEE090","#FDAE61","#F46D43","#D73027","#A50026"]},name:"Scale"},t=this.config.color_scale.min_max;return t&&(e.overideValues.min=t[0],e.overideValues.max=t[1]),this.dataStore.getColorLegend(this.config.param[2],e)}getSettings(){const e=super.getSettings(),t=this.config,n=this.dataStore.getColumnValues(t.param[3]).map((e=>({t:e,v:e})));e.push({label:"Change Category",type:"dropdown",values:[n,"t","v"],current_value:t.category,func:e=>{this.changeCategory(e)}});const i=this.dataStore.getColumnList("number");return e.push({label:"Change Values",type:"dropdown",values:[i,"name","field"],current_value:t.param[2],func:e=>{this.changeValues(e)}}),e}setColorFunction(){const e=this.config.param,t={useValue:!0,overideValues:{colorLogScale:this.config.color_scale.log,colors:["#313695","#4575B4","#74ADD1","#ABD9E9","#E0F3F8","#E0F3F8","#FFFFBF","#FEE090","#FDAE61","#F46D43","#D73027","#A50026"]}},n=this.config.color_scale.min_max;n&&(t.overideValues.min=n[0],t.overideValues.max=n[1]),this.colorFunction=this.dataStore.getColorFunction(e[2],t),this.setColorLegend()}},params:[{type:"text",name:"Categories on y-axis"},{type:"text",name:"categories on x-axis"},{type:"number",name:"Value to display"},{type:"text",name:"group to display"},{type:"text",name:"group1"},{type:"text",name:"group2"}]},Array.prototype.slice;const Ot=Math.abs,Ft=Math.atan2,Bt=Math.cos,Nt=Math.max,Ht=Math.min,Ut=Math.sin,$t=Math.sqrt,jt=1e-12,Wt=Math.PI,qt=Wt/2,Vt=2*Wt;function Kt(e){return e>1?0:e<-1?Wt:Math.acos(e)}function Gt(e){return e>=1?qt:e<=-1?-qt:Math.asin(e)}function Zt(){var e=It,t=zt,n=null,i=Pt(0),r=Pt(Vt),o=Pt(0);function a(a){var s,l,c,h,u,f=(a=Tt(a)).length,d=0,p=new Array(f),g=new Array(f),m=+i.apply(this,arguments),_=Math.min(Vt,Math.max(-Vt,r.apply(this,arguments)-m)),v=Math.min(Math.abs(_)/f,o.apply(this,arguments)),b=v*(_<0?-1:1);for(s=0;s<f;++s)(u=g[p[s]=s]=+e(a[s],s,a))>0&&(d+=u);for(null!=t?p.sort((function(e,n){return t(g[e],g[n])})):null!=n&&p.sort((function(e,t){return n(a[e],a[t])})),s=0,c=d?(_-f*b)/d:0;s<f;++s,m=h)l=p[s],h=m+((u=g[l])>0?u*c:0)+b,g[l]={data:a[l],index:s,value:u,startAngle:m,endAngle:h,padAngle:v};return g}return a.value=function(t){return arguments.length?(e="function"==typeof t?t:Pt(+t),a):e},a.sortValues=function(e){return arguments.length?(t=e,n=null,a):t},a.sort=function(e){return arguments.length?(n=e,t=null,a):n},a.startAngle=function(e){return arguments.length?(i="function"==typeof e?e:Pt(+e),a):i},a.endAngle=function(e){return arguments.length?(r="function"==typeof e?e:Pt(+e),a):r},a.padAngle=function(e){return arguments.length?(o="function"==typeof e?e:Pt(+e),a):o},a}const Xt=Math.PI,Yt=2*Xt,Qt=1e-6,Jt=Yt-Qt;function en(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function tn(){return new en}en.prototype=tn.prototype={constructor:en,moveTo:function(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function(e,t,n,i){this._+="Q"+ +e+","+ +t+","+(this._x1=+n)+","+(this._y1=+i)},bezierCurveTo:function(e,t,n,i,r,o){this._+="C"+ +e+","+ +t+","+ +n+","+ +i+","+(this._x1=+r)+","+(this._y1=+o)},arcTo:function(e,t,n,i,r){e=+e,t=+t,n=+n,i=+i,r=+r;var o=this._x1,a=this._y1,s=n-e,l=i-t,c=o-e,h=a-t,u=c*c+h*h;if(r<0)throw new Error("negative radius: "+r);if(null===this._x1)this._+="M"+(this._x1=e)+","+(this._y1=t);else if(u>Qt)if(Math.abs(h*s-l*c)>Qt&&r){var f=n-o,d=i-a,p=s*s+l*l,g=f*f+d*d,m=Math.sqrt(p),_=Math.sqrt(u),v=r*Math.tan((Xt-Math.acos((p+u-g)/(2*m*_)))/2),b=v/_,y=v/m;Math.abs(b-1)>Qt&&(this._+="L"+(e+b*c)+","+(t+b*h)),this._+="A"+r+","+r+",0,0,"+ +(h*f>c*d)+","+(this._x1=e+y*s)+","+(this._y1=t+y*l)}else this._+="L"+(this._x1=e)+","+(this._y1=t)},arc:function(e,t,n,i,r,o){e=+e,t=+t,o=!!o;var a=(n=+n)*Math.cos(i),s=n*Math.sin(i),l=e+a,c=t+s,h=1^o,u=o?i-r:r-i;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+l+","+c:(Math.abs(this._x1-l)>Qt||Math.abs(this._y1-c)>Qt)&&(this._+="L"+l+","+c),n&&(u<0&&(u=u%Yt+Yt),u>Jt?this._+="A"+n+","+n+",0,1,"+h+","+(e-a)+","+(t-s)+"A"+n+","+n+",0,1,"+h+","+(this._x1=l)+","+(this._y1=c):u>Qt&&(this._+="A"+n+","+n+",0,"+ +(u>=Xt)+","+h+","+(this._x1=e+n*Math.cos(r))+","+(this._y1=t+n*Math.sin(r))))},rect:function(e,t,n,i){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +n+"v"+ +i+"h"+-n+"Z"},toString:function(){return this._}};const nn=tn;function rn(e){return e.innerRadius}function on(e){return e.outerRadius}function an(e){return e.startAngle}function sn(e){return e.endAngle}function ln(e){return e&&e.padAngle}function cn(e,t,n,i,r,o,a,s){var l=n-e,c=i-t,h=a-r,u=s-o,f=u*l-h*c;if(!(f*f<jt))return[e+(f=(h*(t-o)-u*(e-r))/f)*l,t+f*c]}function hn(e,t,n,i,r,o,a){var s=e-n,l=t-i,c=(a?o:-o)/$t(s*s+l*l),h=c*l,u=-c*s,f=e+h,d=t+u,p=n+h,g=i+u,m=(f+p)/2,_=(d+g)/2,v=p-f,b=g-d,y=v*v+b*b,w=r-o,x=f*g-p*d,C=(b<0?-1:1)*$t(Nt(0,w*w*y-x*x)),k=(x*b-v*C)/y,S=(-x*v-b*C)/y,E=(x*b+v*C)/y,D=(-x*v+b*C)/y,A=k-m,M=S-_,R=E-m,L=D-_;return A*A+M*M>R*R+L*L&&(k=E,S=D),{cx:k,cy:S,x01:-h,y01:-u,x11:k*(r/w-1),y11:S*(r/w-1)}}function un(){var e=rn,t=on,n=Pt(0),i=null,r=an,o=sn,a=ln,s=null;function l(){var l,c,h=+e.apply(this,arguments),u=+t.apply(this,arguments),f=r.apply(this,arguments)-qt,d=o.apply(this,arguments)-qt,p=Ot(d-f),g=d>f;if(s||(s=l=nn()),u<h&&(c=u,u=h,h=c),u>jt)if(p>Vt-jt)s.moveTo(u*Bt(f),u*Ut(f)),s.arc(0,0,u,f,d,!g),h>jt&&(s.moveTo(h*Bt(d),h*Ut(d)),s.arc(0,0,h,d,f,g));else{var m,_,v=f,b=d,y=f,w=d,x=p,C=p,k=a.apply(this,arguments)/2,S=k>jt&&(i?+i.apply(this,arguments):$t(h*h+u*u)),E=Ht(Ot(u-h)/2,+n.apply(this,arguments)),D=E,A=E;if(S>jt){var M=Gt(S/h*Ut(k)),R=Gt(S/u*Ut(k));(x-=2*M)>jt?(y+=M*=g?1:-1,w-=M):(x=0,y=w=(f+d)/2),(C-=2*R)>jt?(v+=R*=g?1:-1,b-=R):(C=0,v=b=(f+d)/2)}var L=u*Bt(v),T=u*Ut(v),P=h*Bt(w),z=h*Ut(w);if(E>jt){var I,O=u*Bt(b),F=u*Ut(b),B=h*Bt(y),N=h*Ut(y);if(p<Wt&&(I=cn(L,T,B,N,O,F,P,z))){var H=L-I[0],U=T-I[1],$=O-I[0],j=F-I[1],W=1/Ut(Kt((H*$+U*j)/($t(H*H+U*U)*$t($*$+j*j)))/2),q=$t(I[0]*I[0]+I[1]*I[1]);D=Ht(E,(h-q)/(W-1)),A=Ht(E,(u-q)/(W+1))}}C>jt?A>jt?(m=hn(B,N,L,T,u,A,g),_=hn(O,F,P,z,u,A,g),s.moveTo(m.cx+m.x01,m.cy+m.y01),A<E?s.arc(m.cx,m.cy,A,Ft(m.y01,m.x01),Ft(_.y01,_.x01),!g):(s.arc(m.cx,m.cy,A,Ft(m.y01,m.x01),Ft(m.y11,m.x11),!g),s.arc(0,0,u,Ft(m.cy+m.y11,m.cx+m.x11),Ft(_.cy+_.y11,_.cx+_.x11),!g),s.arc(_.cx,_.cy,A,Ft(_.y11,_.x11),Ft(_.y01,_.x01),!g))):(s.moveTo(L,T),s.arc(0,0,u,v,b,!g)):s.moveTo(L,T),h>jt&&x>jt?D>jt?(m=hn(P,z,O,F,h,-D,g),_=hn(L,T,B,N,h,-D,g),s.lineTo(m.cx+m.x01,m.cy+m.y01),D<E?s.arc(m.cx,m.cy,D,Ft(m.y01,m.x01),Ft(_.y01,_.x01),!g):(s.arc(m.cx,m.cy,D,Ft(m.y01,m.x01),Ft(m.y11,m.x11),!g),s.arc(0,0,h,Ft(m.cy+m.y11,m.cx+m.x11),Ft(_.cy+_.y11,_.cx+_.x11),g),s.arc(_.cx,_.cy,D,Ft(_.y11,_.x11),Ft(_.y01,_.x01),!g))):s.arc(0,0,h,w,y,g):s.lineTo(P,z)}else s.moveTo(0,0);if(s.closePath(),l)return s=null,l+""||null}return l.centroid=function(){var n=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,i=(+r.apply(this,arguments)+ +o.apply(this,arguments))/2-Wt/2;return[Bt(i)*n,Ut(i)*n]},l.innerRadius=function(t){return arguments.length?(e="function"==typeof t?t:Pt(+t),l):e},l.outerRadius=function(e){return arguments.length?(t="function"==typeof e?e:Pt(+e),l):t},l.cornerRadius=function(e){return arguments.length?(n="function"==typeof e?e:Pt(+e),l):n},l.padRadius=function(e){return arguments.length?(i=null==e?null:"function"==typeof e?e:Pt(+e),l):i},l.startAngle=function(e){return arguments.length?(r="function"==typeof e?e:Pt(+e),l):r},l.endAngle=function(e){return arguments.length?(o="function"==typeof e?e:Pt(+e),l):o},l.padAngle=function(e){return arguments.length?(a="function"==typeof e?e:Pt(+e),l):a},l.context=function(e){return arguments.length?(s=null==e?null:e,l):s},l}I.types.multi_pie_chart={name:"Multi Pie Chart",allow_user_add:!1,class:class extends Mt{constructor(e,t,n){super(e,t,n,{}),this.config.type="multi_pie_chart",this.pie=Zt().sort(null).value((e=>e[2])),this.arc=un(),this.initialSetUp(),this.drawChart(),this.addToolTip()}initialSetUp(){const e=this.config.param,t=this.config.specific_only,n=this.dataStore.columnIndex[e[0]],i=n.data,r=this.dataStore.columnIndex[e[1]],o=r.data,a=n.values,s=this.dataStore.columnIndex[e[3]].data,l=this.dataStore.columnIndex[e[2]].data,c=this.dataStore.size;let h=new Array(a.length);for(let e=0;e<n.values.length;e++)h[e]={data:new Array(r.values.length),name:a[e],index:e};const u=this.dataStore.columnIndex[e[3]].values.indexOf(this.config.category);for(let e=0;e<c;e++)if(s[e]===u){const t=h[i[e]].data;let n=t[o[e]];null==n?t[o[e]]=[i[e],o[e],l[e],e,1]:(n[2]+=l[e],n[4]++)}for(let e=0;e<n.values.length;e++){let t=h[e].data;this.config.hide_self_interaction&&t.splice(e,1);let n=0;for(let e of t)isNaN(e[2])?e[2]=0:e[2]=e[2]/e[4],n+=e[2];h[e].sum=n}if(t){h=h.filter((e=>-1!==t[0].indexOf(e.name)));const e=new Set(t[1].map((e=>r.values.indexOf(e))));for(let t=0;t<h.length;t++)h[t].data=h[t].data.filter((t=>e.has(t[1]))),h[t].sum=h[t].data.reduce(((e,t)=>e+t[2]),0)}this.data=h}setSize(e,t){super.setSize(e,t),this.drawChart()}onDataHighlighted(e){const t=e.indexes[0],n=this.graph_area.selectAll("path");n.attr("stroke","white").style("stroke-width","2px"),n.filter((e=>e.data[3]===t)).attr("stroke","black").style("stroke-width","4px"),this.highlight=t}drawChart(e=1e3){(0,O.Z)(this.contentDiv).transition().duration(e).ease(Ct);const t=this._getContentDimensions(),n=(t.width,t.height,Math.ceil(Math.sqrt(this.data.length))),i=t.width/n,r=t.height/n;let o=i;r/1.2<i&&(o=r/1.2),o/=2,this.arc.innerRadius(.5*o).outerRadius(.9*o);let a=Math.floor(i/10);a=a>12?12:a;const s=this.dataStore.getColumnValues(this.config.param[0]),l=this.dataStore.getColumnColors(this.config.param[0]),c=this.dataStore.getColumnValues(this.config.param[1]),h=this.dataStore.getColumnColors(this.config.param[1]),u=this,f=this.graph_area.selectAll(".pie-area").data(this.data).join("g").attr("transform",((e,t)=>{const o=Math.floor(t/n)*r;return`translate(${t%n*i+i/2},${o+r/2})`})).attr("class","pie-area");f.selectAll(".pie-inner").data(((e,t)=>[e.index])).join("circle").attr("class","pie-inner").attr("r",.4*o).style("fill",((e,t)=>l[e])),f.selectAll(".pie-text-header").data(((e,t)=>[e.name])).join("text").attr("text-anchor","middle").attr("class","pie-text-header").attr("y",-r/2+r/10).attr("font-size",a+"px").attr("dominant-baseline","bottom").text((e=>e)),f.selectAll(".pie-outer").data((e=>{const t=u.pie(e.data.filter((e=>e[2]>0)));for(let n of t)n.sum=e.sum;return t})).join("path").attr("class","pie-outer").attr("stroke",(e=>e.data[3]===u.highlight?"black":"white")).attr("d",this.arc).on("click",((e,t)=>{u.dataStore.dataHighlighted([t.data[3]],u)})).on("mouseover mousemove",((e,t)=>{const n=s[t.data[0]],i=c[t.data[1]],r=(t.data[2]/t.sum*100).toFixed(2);u.showToolTip(e,`${n}<br>${i}<br>${t.data[2].toFixed(2)}<br>${r}%`)})).on("mouseleave",(()=>{u.hideToolTip()})).style("stroke-width",(e=>e.data[3]===u.highlight?"4px":"2px")).style("fill",((e,t)=>h[e.data[1]]))}getSettings(){const e=super.getSettings(),t=this.config;return e.concat({type:"check",label:"Hide self intearction",current_value:t.hide_self_interaction,func:e=>{t.hide_self_interaction=e,this.initialSetUp(),this.drawChart()}})}},params:[{type:"text",name:"first cat"},{type:"text",name:"second cat"},{type:"number",name:"Value to display in each chart"},{type:"text",name:"column to filter"}]};I.types.single_series_chart={name:"Single Series Chart",allow_user_add:!1,class:class extends Mt{constructor(e,t,n){super(e,t,n,{x:{type:"band"},y:{}}),n.title||this._setTitle();const i=this.config.param;this.config;let r=this.dataStore.getColumnValues(i[0]);this.x_scale.domain(r.slice(0)),this.initialSetUp(),this.drawChart(),this.addToolTip()}remove(e=!0){super.remove()}onDataHighlighted(e){const t=e.indexes[0],n=this.graph_area.selectAll("rect");n.attr("stroke","white").style("stroke-width","0px"),n.filter((e=>!(!e||e[3]!==t))).attr("stroke","black").style("stroke-width","4px"),this.highlight=t}_setTitle(){const e=this.config.categories;this.setTitle(`${e[0]} x ${e[1]}`)}changeCategory(e){this.config.category=e,this.initialSetUp(),this.drawChart(),this._setTitle()}changeValues(e){this.config.param[2]=e,this.setColorFunction(),this.initialSetUp(),this.drawChart(),this._setTitle()}initialSetUp(){const e=this.config.param,t=this.dataStore.columnIndex[e[1]].data,n=this.dataStore.columnIndex[e[2]].data,i=this.dataStore.columnIndex[e[0]].data,r=this.dataStore.columnIndex[e[3]].data,o=this.dataStore.columnIndex[e[0]].values.map((e=>({values:[],totals:0}))),a=this.dataStore.columnIndex[e[4]].data,s=this.dataStore.size,l=[],c=this.config.scale[1],h=this.dataStore.columnIndex[e[1]].values.indexOf(this.config.categories[0]),u=this.dataStore.columnIndex[e[2]].values.indexOf(this.config.categories[1]);for(let e=0;e<s;e++)if(t[e]===h&&n[e]===u){l.push([a[e],i[e],r[e],e,Math.floor(6*Math.random())+1]);const t=o[i[e]];a[e]>c||a[e],t.values.push(a[e]),t.totals+=a[e]}for(let e of o){e.mean=e.totals/e.values.length;let t=e.values.length-1;t=0===t?1:t,e.std=e.values.reduce(((t,n)=>t+Math.pow(n-e.mean,2)),0),e.std=Math.sqrt(e.std/t),delete e.values}this.errorBars=o,this.data=l}drawChart(e=300){const t=this.config.param;this.y_scale.domain([this.config.scale[1],this.config.scale[0]]).clamp(!0),this.updateAxis();const n=(0,O.Z)(this.contentDiv).transition().duration(e).ease(Ct),i=this.dataStore.getColumnValues(t[0]),r=this.dataStore.getColumnValues(t[3]),o=this._getContentDimensions().width/i.length,a=this,s=this.dataStore.getColumnColors(t[0]),l=o/4,c=o/5;this.graph_area.selectAll("circle").data(this.data).join("circle").on("mouseover mousemove",((e,t)=>{const n=i[t[1]],o=r[t[2]];a.showToolTip(e,`${n}<br>${o}<br>${t[0]}`)})).on("mouseleave",(()=>{a.hideToolTip()})).on("click",((e,t)=>{a.dataStore.dataHighlighted([t[3]],a)})).transition(n).attr("cx",(e=>o/8+o*(e[4]/8)+e[1]*o)).attr("cy",(e=>a.y_scale(e[0]))).attr("r",5).attr("fill",(e=>s[e[1]])),this.graph_area.selectAll(".cbp-rect").data(this.errorBars).join("path").attr("d",((e,t)=>{const n=t*o+o/2,i=a.y_scale(e.mean);let r=a.y_scale(e.mean+e.std),s=a.y_scale(e.mean-e.std);return`M${n} ${r} L${n} ${s}\n                  M${n-l} ${i} L${n+l} ${i} \n                  M${n-c} ${r} L${n+c} ${r}     \n                  M${n-c} ${s} L${n+c} ${s}      `})).style("fill","none").style("stroke","black").attr("stroke-width",1).attr("class","cbp-rect")}setSize(e,t){super.setSize(e,t),this.drawChart()}getColorLegend(){const e={overideValues:{colorLogScale:this.config.color_scale.log,colors:["#313695","#4575B4","#74ADD1","#ABD9E9","#E0F3F8","#E0F3F8","#FFFFBF","#FEE090","#FDAE61","#F46D43","#D73027","#A50026"]},name:"Scale"},t=this.config.color_scale.min_max;return t&&(e.overideValues.min=t[0],e.overideValues.max=t[1]),this.dataStore.getColorLegend(this.config.param[2],e)}setColorFunction(){const e=this.config.param,t={useValue:!0,overideValues:{colorLogScale:this.config.color_scale.log,colors:["#313695","#4575B4","#74ADD1","#ABD9E9","#E0F3F8","#E0F3F8","#FFFFBF","#FEE090","#FDAE61","#F46D43","#D73027","#A50026"]}},n=this.config.color_scale.min_max;n&&(t.overideValues.min=n[0],t.overideValues.max=n[1]),this.colorFunction=this.dataStore.getColorFunction(e[2],t),this.setColorLegend()}},params:[{type:"text",name:"Categories on y-axis"},{type:"text",name:"categories on x-axis"},{type:"number",name:"Value to display"},{type:"text",name:"column to filter"}]};const fn={passive:!1},dn={capture:!0,passive:!1};function pn(e){e.stopImmediatePropagation()}function gn(e){e.preventDefault(),e.stopImmediatePropagation()}function mn(e){var t=e.document.documentElement,n=(0,O.Z)(e).on("dragstart.drag",gn,dn);"onselectstart"in t?n.on("selectstart.drag",gn,dn):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function _n(e,t){var n=e.document.documentElement,i=(0,O.Z)(e).on("dragstart.drag",null);t&&(i.on("click.drag",gn,dn),setTimeout((function(){i.on("click.drag",null)}),0)),"onselectstart"in n?i.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}var vn=__webpack_require__(9487);function bn(e,t){if(e=function(e){let t;for(;t=e.sourceEvent;)e=t;return e}(e),void 0===t&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var i=n.createSVGPoint();return i.x=e.clientX,i.y=e.clientY,[(i=i.matrixTransform(t.getScreenCTM().inverse())).x,i.y]}if(t.getBoundingClientRect){var r=t.getBoundingClientRect();return[e.clientX-r.left-t.clientLeft,e.clientY-r.top-t.clientTop]}}return[e.pageX,e.pageY]}const yn=e=>()=>e;function wn(e,{sourceEvent:t,target:n,selection:i,mode:r,dispatch:o}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},selection:{value:i,enumerable:!0,configurable:!0},mode:{value:r,enumerable:!0,configurable:!0},_:{value:o}})}function xn(e){e.stopImmediatePropagation()}function Cn(e){e.preventDefault(),e.stopImmediatePropagation()}var kn={name:"drag"},Sn={name:"space"},En={name:"handle"},Dn={name:"center"};const{abs:An,max:Mn,min:Rn}=Math;function Ln(e){return[+e[0],+e[1]]}function Tn(e){return[Ln(e[0]),Ln(e[1])]}var Pn={name:"x",handles:["w","e"].map(Hn),input:function(e,t){return null==e?null:[[+e[0],t[0][1]],[+e[1],t[1][1]]]},output:function(e){return e&&[e[0][0],e[1][0]]}},zn={name:"y",handles:["n","s"].map(Hn),input:function(e,t){return null==e?null:[[t[0][0],+e[0]],[t[1][0],+e[1]]]},output:function(e){return e&&[e[0][1],e[1][1]]}},In=(["n","w","e","s","nw","ne","sw","se"].map(Hn),{overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"}),On={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},Fn={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},Bn={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},Nn={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1};function Hn(e){return{type:e}}function Un(e){return!e.ctrlKey&&!e.button}function $n(){var e=this.ownerSVGElement||this;return e.hasAttribute("viewBox")?[[(e=e.viewBox.baseVal).x,e.y],[e.x+e.width,e.y+e.height]]:[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]}function jn(){return navigator.maxTouchPoints||"ontouchstart"in this}function Wn(e){for(;!e.__brush;)if(!(e=e.parentNode))return;return e.__brush}function qn(e){return e[0][0]===e[1][0]||e[0][1]===e[1][1]}const Vn=e=>()=>e;function Kn(e,{sourceEvent:t,subject:n,target:i,identifier:r,active:o,x:a,y:s,dx:l,dy:c,dispatch:h}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:i,enumerable:!0,configurable:!0},identifier:{value:r,enumerable:!0,configurable:!0},active:{value:o,enumerable:!0,configurable:!0},x:{value:a,enumerable:!0,configurable:!0},y:{value:s,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:c,enumerable:!0,configurable:!0},_:{value:h}})}function Gn(e){return!e.ctrlKey&&!e.button}function Zn(){return this.parentNode}function Xn(e,t){return null==t?{x:e.x,y:e.y}:t}function Yn(){return navigator.maxTouchPoints||"ontouchstart"in this}function Qn(e,t){var n,i=1;function r(){var r,o,a=n.length,s=0,l=0;for(r=0;r<a;++r)s+=(o=n[r]).x,l+=o.y;for(s=(s/a-e)*i,l=(l/a-t)*i,r=0;r<a;++r)(o=n[r]).x-=s,o.y-=l}return null==e&&(e=0),null==t&&(t=0),r.initialize=function(e){n=e},r.x=function(t){return arguments.length?(e=+t,r):e},r.y=function(e){return arguments.length?(t=+e,r):t},r.strength=function(e){return arguments.length?(i=+e,r):i},r}function Jn(e){return function(){return e}}function ei(e){return 1e-6*(e()-.5)}function ti(e){return e.index}function ni(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}function ii(e,t,n,i){if(isNaN(t)||isNaN(n))return e;var r,o,a,s,l,c,h,u,f,d=e._root,p={data:i},g=e._x0,m=e._y0,_=e._x1,v=e._y1;if(!d)return e._root=p,e;for(;d.length;)if((c=t>=(o=(g+_)/2))?g=o:_=o,(h=n>=(a=(m+v)/2))?m=a:v=a,r=d,!(d=d[u=h<<1|c]))return r[u]=p,e;if(s=+e._x.call(null,d.data),l=+e._y.call(null,d.data),t===s&&n===l)return p.next=d,r?r[u]=p:e._root=p,e;do{r=r?r[u]=new Array(4):e._root=new Array(4),(c=t>=(o=(g+_)/2))?g=o:_=o,(h=n>=(a=(m+v)/2))?m=a:v=a}while((u=h<<1|c)==(f=(l>=a)<<1|s>=o));return r[f]=d,r[u]=p,e}function ri(e,t,n,i,r){this.node=e,this.x0=t,this.y0=n,this.x1=i,this.y1=r}function oi(e){return e[0]}function ai(e){return e[1]}function si(e,t,n){var i=new li(null==t?oi:t,null==n?ai:n,NaN,NaN,NaN,NaN);return null==e?i:i.addAll(e)}function li(e,t,n,i,r,o){this._x=e,this._y=t,this._x0=n,this._y0=i,this._x1=r,this._y1=o,this._root=void 0}function ci(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}Kn.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};var hi=si.prototype=li.prototype;hi.copy=function(){var e,t,n=new li(this._x,this._y,this._x0,this._y0,this._x1,this._y1),i=this._root;if(!i)return n;if(!i.length)return n._root=ci(i),n;for(e=[{source:i,target:n._root=new Array(4)}];i=e.pop();)for(var r=0;r<4;++r)(t=i.source[r])&&(t.length?e.push({source:t,target:i.target[r]=new Array(4)}):i.target[r]=ci(t));return n},hi.add=function(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return ii(this.cover(t,n),t,n,e)},hi.addAll=function(e){var t,n,i,r,o=e.length,a=new Array(o),s=new Array(o),l=1/0,c=1/0,h=-1/0,u=-1/0;for(n=0;n<o;++n)isNaN(i=+this._x.call(null,t=e[n]))||isNaN(r=+this._y.call(null,t))||(a[n]=i,s[n]=r,i<l&&(l=i),i>h&&(h=i),r<c&&(c=r),r>u&&(u=r));if(l>h||c>u)return this;for(this.cover(l,c).cover(h,u),n=0;n<o;++n)ii(this,a[n],s[n],e[n]);return this},hi.cover=function(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,i=this._y0,r=this._x1,o=this._y1;if(isNaN(n))r=(n=Math.floor(e))+1,o=(i=Math.floor(t))+1;else{for(var a,s,l=r-n||1,c=this._root;n>e||e>=r||i>t||t>=o;)switch(s=(t<i)<<1|e<n,(a=new Array(4))[s]=c,c=a,l*=2,s){case 0:r=n+l,o=i+l;break;case 1:n=r-l,o=i+l;break;case 2:r=n+l,i=o-l;break;case 3:n=r-l,i=o-l}this._root&&this._root.length&&(this._root=c)}return this._x0=n,this._y0=i,this._x1=r,this._y1=o,this},hi.data=function(){var e=[];return this.visit((function(t){if(!t.length)do{e.push(t.data)}while(t=t.next)})),e},hi.extent=function(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},hi.find=function(e,t,n){var i,r,o,a,s,l,c,h=this._x0,u=this._y0,f=this._x1,d=this._y1,p=[],g=this._root;for(g&&p.push(new ri(g,h,u,f,d)),null==n?n=1/0:(h=e-n,u=t-n,f=e+n,d=t+n,n*=n);l=p.pop();)if(!(!(g=l.node)||(r=l.x0)>f||(o=l.y0)>d||(a=l.x1)<h||(s=l.y1)<u))if(g.length){var m=(r+a)/2,_=(o+s)/2;p.push(new ri(g[3],m,_,a,s),new ri(g[2],r,_,m,s),new ri(g[1],m,o,a,_),new ri(g[0],r,o,m,_)),(c=(t>=_)<<1|e>=m)&&(l=p[p.length-1],p[p.length-1]=p[p.length-1-c],p[p.length-1-c]=l)}else{var v=e-+this._x.call(null,g.data),b=t-+this._y.call(null,g.data),y=v*v+b*b;if(y<n){var w=Math.sqrt(n=y);h=e-w,u=t-w,f=e+w,d=t+w,i=g.data}}return i},hi.remove=function(e){if(isNaN(o=+this._x.call(null,e))||isNaN(a=+this._y.call(null,e)))return this;var t,n,i,r,o,a,s,l,c,h,u,f,d=this._root,p=this._x0,g=this._y0,m=this._x1,_=this._y1;if(!d)return this;if(d.length)for(;;){if((c=o>=(s=(p+m)/2))?p=s:m=s,(h=a>=(l=(g+_)/2))?g=l:_=l,t=d,!(d=d[u=h<<1|c]))return this;if(!d.length)break;(t[u+1&3]||t[u+2&3]||t[u+3&3])&&(n=t,f=u)}for(;d.data!==e;)if(i=d,!(d=d.next))return this;return(r=d.next)&&delete d.next,i?(r?i.next=r:delete i.next,this):t?(r?t[u]=r:delete t[u],(d=t[0]||t[1]||t[2]||t[3])&&d===(t[3]||t[2]||t[1]||t[0])&&!d.length&&(n?n[f]=d:this._root=d),this):(this._root=r,this)},hi.removeAll=function(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this},hi.root=function(){return this._root},hi.size=function(){var e=0;return this.visit((function(t){if(!t.length)do{++e}while(t=t.next)})),e},hi.visit=function(e){var t,n,i,r,o,a,s=[],l=this._root;for(l&&s.push(new ri(l,this._x0,this._y0,this._x1,this._y1));t=s.pop();)if(!e(l=t.node,i=t.x0,r=t.y0,o=t.x1,a=t.y1)&&l.length){var c=(i+o)/2,h=(r+a)/2;(n=l[3])&&s.push(new ri(n,c,h,o,a)),(n=l[2])&&s.push(new ri(n,i,h,c,a)),(n=l[1])&&s.push(new ri(n,c,r,o,h)),(n=l[0])&&s.push(new ri(n,i,r,c,h))}return this},hi.visitAfter=function(e){var t,n=[],i=[];for(this._root&&n.push(new ri(this._root,this._x0,this._y0,this._x1,this._y1));t=n.pop();){var r=t.node;if(r.length){var o,a=t.x0,s=t.y0,l=t.x1,c=t.y1,h=(a+l)/2,u=(s+c)/2;(o=r[0])&&n.push(new ri(o,a,s,h,u)),(o=r[1])&&n.push(new ri(o,h,s,l,u)),(o=r[2])&&n.push(new ri(o,a,u,h,c)),(o=r[3])&&n.push(new ri(o,h,u,l,c))}i.push(t)}for(;t=i.pop();)e(t.node,t.x0,t.y0,t.x1,t.y1);return this},hi.x=function(e){return arguments.length?(this._x=e,this):this._x},hi.y=function(e){return arguments.length?(this._y=e,this):this._y};const ui=4294967296;function fi(e){return e.x}function di(e){return e.y}var pi=Math.PI*(3-Math.sqrt(5));function gi(e){return null==e?null:function(e){if("function"!=typeof e)throw new Error;return e}(e)}function mi(e){var t=0,n=e.children,i=n&&n.length;if(i)for(;--i>=0;)t+=n[i].value;else t=1;e.value=t}function _i(e,t){e instanceof Map?(e=[void 0,e],void 0===t&&(t=bi)):void 0===t&&(t=vi);for(var n,i,r,o,a,s=new xi(e),l=[s];n=l.pop();)if((r=t(n.data))&&(a=(r=Array.from(r)).length))for(n.children=r,o=a-1;o>=0;--o)l.push(i=r[o]=new xi(r[o])),i.parent=n,i.depth=n.depth+1;return s.eachBefore(wi)}function vi(e){return e.children}function bi(e){return Array.isArray(e)?e[1]:null}function yi(e){void 0!==e.data.value&&(e.value=e.data.value),e.data=e.data.data}function wi(e){var t=0;do{e.height=t}while((e=e.parent)&&e.height<++t)}function xi(e){this.data=e,this.depth=this.height=0,this.parent=null}xi.prototype=_i.prototype={constructor:xi,count:function(){return this.eachAfter(mi)},each:function(e,t){let n=-1;for(const i of this)e.call(t,i,++n,this);return this},eachAfter:function(e,t){for(var n,i,r,o=this,a=[o],s=[],l=-1;o=a.pop();)if(s.push(o),n=o.children)for(i=0,r=n.length;i<r;++i)a.push(n[i]);for(;o=s.pop();)e.call(t,o,++l,this);return this},eachBefore:function(e,t){for(var n,i,r=this,o=[r],a=-1;r=o.pop();)if(e.call(t,r,++a,this),n=r.children)for(i=n.length-1;i>=0;--i)o.push(n[i]);return this},find:function(e,t){let n=-1;for(const i of this)if(e.call(t,i,++n,this))return i},sum:function(e){return this.eachAfter((function(t){for(var n=+e(t.data)||0,i=t.children,r=i&&i.length;--r>=0;)n+=i[r].value;t.value=n}))},sort:function(e){return this.eachBefore((function(t){t.children&&t.children.sort(e)}))},path:function(e){for(var t=this,n=function(e,t){if(e===t)return e;var n=e.ancestors(),i=t.ancestors(),r=null;for(e=n.pop(),t=i.pop();e===t;)r=e,e=n.pop(),t=i.pop();return r}(t,e),i=[t];t!==n;)t=t.parent,i.push(t);for(var r=i.length;e!==n;)i.splice(r,0,e),e=e.parent;return i},ancestors:function(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t},descendants:function(){return Array.from(this)},leaves:function(){var e=[];return this.eachBefore((function(t){t.children||e.push(t)})),e},links:function(){var e=this,t=[];return e.each((function(n){n!==e&&t.push({source:n.parent,target:n})})),t},copy:function(){return _i(this).eachBefore(yi)},[Symbol.iterator]:function*(){var e,t,n,i,r=this,o=[r];do{for(e=o.reverse(),o=[];r=e.pop();)if(yield r,t=r.children)for(n=0,i=t.length;n<i;++n)o.push(t[n])}while(o.length)}};var Ci={depth:-1},ki={},Si={};function Ei(e){return e.id}function Di(e){return e.parentId}function Ai(e){let t=e.length;if(t<2)return"";for(;--t>1&&!Mi(e,t););return e.slice(0,t)}function Mi(e,t){if("/"===e[t]){let n=0;for(;t>0&&"\\"===e[--t];)++n;if(0==(1&n))return!0}return!1}function Ri(e,t){return e.parent===t.parent?1:2}function Li(e){var t=e.children;return t?t[0]:e.t}function Ti(e){var t=e.children;return t?t[t.length-1]:e.t}function Pi(e,t,n){var i=n/(t.i-e.i);t.c-=i,t.s+=n,e.c+=i,t.z+=n,t.m+=n}function zi(e,t,n){return e.a.parent===t.parent?e.a:n}function Ii(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}Ii.prototype=Object.create(xi.prototype);var Oi=__webpack_require__(1102);function Fi(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function Bi(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function Ni(e){return e<0?-e*e:e*e}function Hi(e){var t=e(Oi.yR,Oi.yR),n=1;function i(){return 1===n?e(Oi.yR,Oi.yR):.5===n?e(Bi,Ni):e(Fi(n),Fi(1/n))}return t.exponent=function(e){return arguments.length?(n=+e,i()):n},(0,Z.Q)(t)}function Ui(){var e=Hi((0,Oi.l4)());return e.copy=function(){return(0,Oi.JG)(e,Ui()).exponent(e.exponent())},B.o.apply(e,arguments),e}function $i(){return Ui.apply(null,arguments).exponent(.5)}var ji=new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map((function(e){for(var t=e.length/6|0,n=new Array(t),i=0;i<t;)n[i]="#"+e.slice(6*i,6*++i);return n}));function Wi(e,t,n){this.k=e,this.x=t,this.y=n}(e=>{(0,$e.hD)(e[e.length-1])})(ji),Wi.prototype={constructor:Wi,scale:function(e){return 1===e?this:new Wi(this.k*e,this.x,this.y)},translate:function(e,t){return 0===e&0===t?this:new Wi(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}},new Wi(1,0,0),Wi.prototype;I.types.image_box={class:class extends I{constructor(e,t,n){super(e,t,n);const i=this.config;this.contentDiv.style.overflowY="auto",i.images_per_row=i.images_per_row||2,i.images=i.images||[],this.refreshImages()}refreshImages(){this.contentDiv.innerHTML="",this.divs=[],this.images=[];for(let e=0;e<this.config.images.length;e++){const t=this.config.images[e],n=(0,A.ut)("div",{style:{display:"inline-block"}},this.contentDiv);(0,A.ut)("div",{style:{height:"20px",fontSize:"14px"},text:t[1]||""},n);const i=(0,A.ut)("img",{src:t[0]},n);this.divs.push(n),this.images.push(i),e===this.config.images.length-1&&(i.onload=()=>{this.ratio=i.width/i.height,this.setImageSizes()})}}setSingleImage(e,t){this.divs=[],this.images=[],this.contentDiv.innerHTML="",this.config.images_per_row=1,this.config.images=[[e,t]],this._createImages(),this.images[0].onload=()=>{const e=this.images[0];this.ratio=e.width/e.height,this.setImageSizes()}}setImageSizes(){const e=Math.round(this.width/this.config.images_per_row-20),t=Math.round(e/this.ratio);for(let n of this.divs)n.style.height=t+"px",n.style.width=e+"px";for(let n of this.images)n.style.height=t-10+"px",n.style.width=e+"px"}setSize(e,t){super.setSize(e,t),this.setImageSizes()}},name:"Image Box",params:[],allow_user_add:!1};I.types.selection_dialog={name:"Selection Dialog",class:class extends I{constructor(e,t,n){super(e,t,n);const i=this.config,r=i.param;this.dims={},this.textFilters={},this.numberFilters={},i.filters=i.filters||{},this.hasFiltred=!1,this.contentDiv.style.overflowY="auto";for(let t of r){const n=e.columnIndex[t],i=(0,A.ut)("div",{styles:{padding:"5px"}},this.contentDiv);i.__fcol__=n.field,(0,A.ut)("div",{text:n.name,classes:["i-title"],styles:{fontWeight:"bold"}},i),"text"===n.datatype?this.addTextFilter(n,i):"multitext"===n.datatype?this.addMultiTextFilter(n,i):"integer"!==n.datatype&&"double"!==n.datatype||this.addNumberFilter(n,i)}(0,A.Ng)(this.contentDiv,{handle:"i-title",sortEnded:e=>{this.config.param=e.map((e=>e.__fcol__))}}),this.hasFiltered&&setTimeout((()=>this.dataStore.triggerFilter()),0)}removeFilter(){const e=this.config.filters;for(let t in this.textFilters){const n=this.textFilters[t],i=e[t].operand;i?n[1].innerHTML="":(n[0].value="__none__",n[1].checked=!1),e[t].category=i?[]:"__none__",e[t].exclude=!1}for(let t in this.numberFilters){const n=this.dataStore.getMinMaxForColumn(t);this.numberFilters[t].noUiSlider.set([n[0],n[1]]),e[t]=null}this.resetButton.style.display="none";for(let e in this.dims)this.dims[e].removeFilter(!1);this.dataStore.triggerFilter()}onDataFiltered(e){}addNumberFilter(e,t){const n=(0,A.ut)("div",{styles:{margin:"10px 10px"}},t),i=(0,A.ut)("div",{styles:{padding:"3px 10px",overflow:"hidden"}},t);(0,A.ut)("span",{text:">",styles:{float:"left",fontWeight:"bold"}},i);const r=(0,A.ut)("input",{styles:{width:"70px",float:"left"}},i);(0,A.ut)("span",{text:"<",styles:{float:"right",fontWeight:"bold"}},i);const o=(0,A.ut)("input",{styles:{width:"70px",float:"right"}},i),a=this.config,s=this.dataStore.getDimension("range_dimension");s.noclear=!0,this.dims[e.field]=s;const l=this.dataStore.getMinMaxForColumn(e.field),c=a.filters[e.field];let h=[l[0],l[1]];c&&(h=[c[0],c[1]]),L().create(n,{start:[h[0],h[1]],range:{min:l[0],max:l[1]},tooltips:!0,documentElement:this.__doc__}),n.noUiSlider.on("set",(t=>{const n=parseFloat(t[0]),i=parseFloat(t[1]);n<=l[0]&&i>=l[1]?a.filters[e.field]=null:a.filters[e.field]=[n,i],o.value=i,r.value=n,this.filterCategories(e.field)})),o.value=h[1],r.value=h[0],r.addEventListener("blur",(e=>{let t=parseFloat(r.value);const i=n.noUiSlider.get();isNaN(t)||t>i[1]||(t=t<l[0]?l[0]:t,n.noUiSlider.set([t,i[1]],!0,!0))})),r.addEventListener("keypress",(e=>{"Enter"===e.key&&r.blur()})),o.addEventListener("blur",(e=>{let t=parseFloat(o.value);const i=n.noUiSlider.get();isNaN(t)||t<i[0]||(t=t>l[1]?l[1]:t,n.noUiSlider.set([i[0],t],!0,!0))})),o.addEventListener("keypress",(e=>{"Enter"===e.key&&o.blur()})),c&&(this.filterCategories(e.field,!1),this.hasFiltered=!0),this.numberFilters[e.field]=n}filterCategories(e,t=!0){const n=this.config.filters[e],i=this.dataStore.columnIndex[e].datatype;if("text"===i)if("__none__"===n.category)this.dims[e].removeFilter();else{let i=[n.category];n.exclude&&(i=this.dataStore.getColumnValues(e).filter((e=>e!==n.category))),this.resetButton.style.display="inline",this.dims[e].filter("filterCategories",[e],i,t)}else if("multitext"===i)if(0===n.category.length)this.dims[e].removeFilter();else{this.resetButton.style.display="inline";const i=n.category.slice(0);i.operand=n.operand,this.dims[e].filter("filterCategories",[e],i,t)}else n?(this.resetButton.style.display="inline",this.dims[e].filter("filterRange",[e],{min:n[0],max:n[1]},t)):this.dims[e].removeFilter()}createTag(e,t,n,i=!0){i&&this.config.filters[t.field].category.push(n);const r=(0,A.ut)("div",{},e);(0,A.ut)("span",{text:n},r),(0,A.ut)("i",{classes:["fas","fa-times"]},r).addEventListener("click",(e=>{this.config.filters[t.field].category=this.config.filters[t.field].category.filter((e=>e!==n)),console.log(this.config.filters[t.field].category),r.remove(),this.filterCategories(t.field)}))}addMultiTextFilter(e,t){let n=(0,A.ut)("div",{style:{whiteSpace:"nowrap"}},t);const i=this.config,r=this.dataStore.getDimension("category_dimension");r.noclear=!0,this.dims[e.field]=r,i.filters[e.field]?(this.filterCategories(e.field,!1),this.hasFiltered=!0):i.filters[e.field]={operand:"or",category:[]};const o=i.filters[e.field],a=(0,A.ut)("select",{classes:["mdv-select"],styles:{maxWidth:"200px"}});for(let t of e.values.slice(0).sort())(0,A.ut)("option",{text:t,value:t},a);n.append(a);const s=(0,A.ut)("span",{classes:["ciview-button-sm"],text:"Add"},n),l=(0,A.ut)("div",{},n);s.addEventListener("click",(t=>{-1===o.category.indexOf(a.value)&&(this.createTag(l,e,a.value),this.filterCategories(e.field))})),n=(0,A.ut)("div",{},t);const c=(0,E.zO)();(0,A.ut)("span",{text:"and"},n);const h=(0,A.ut)("input",{type:"radio",name:c,value:"and"},n);h.checked="and"===o.operand,h.addEventListener("click",(t=>{o.operand="and",this.filterCategories(e.field)})),(0,A.ut)("span",{text:"or"},n);const u=(0,A.ut)("input",{type:"radio",name:c,value:"or"},n);u.checked="or"===o.operand,u.addEventListener("click",(t=>{o.operand="or",this.filterCategories(e.field)}));for(let t of o.category)this.createTag(l,e,t,!1);this.textFilters[e.field]=[a,l]}addTextFilter(e,t){t.style.whiteSpace="nowrap";const n=this.config,i=this.dataStore.getDimension("category_dimension");i.noclear=!0,this.dims[e.field]=i,n.filters[e.field]?(this.filterCategories(e.field,!1),this.hasFiltered=!0):n.filters[e.field]={exclude:!1,category:"__none__"};const r=n.filters[e.field],o=(0,A.ut)("select",{classes:["mdv-select"],styles:{maxWidth:"200px"}});(0,A.ut)("option",{text:"None",value:"__none__"},o);for(let t of e.values)(0,A.ut)("option",{text:t,value:t},o);t.append(o),o.value=r.category,o.addEventListener("change",(t=>{r.category=o.value,this.filterCategories(e.field)}));const a=(0,A.ut)("input",{classes:["mdv-checkbox"],type:"checkbox"},t);a.checked=r.exclude,a.addEventListener("click",(t=>{r.exclude=a.checked,this.filterCategories(e.field)})),(0,A.ut)("span",{text:"exclude",style:{fontSize:"11px",verticalAlign:"middle"}},t),this.textFilters[e.field]=[o,a]}remove(e=!0){for(let e in this.dims)this.dims[e].destroy(!1);e&&this.dataStore.triggerFilter(),super.remove()}},params:[{type:"_multi_column:all",name:"Columns To filter"}]};I.types.single_heat_map_group={name:"Single Heat Map",allow_user_add:!1,class:class extends Mt{constructor(e,t,n){super(e,t,n,{x:{type:"band"},y:{type:"band"},tx:{size:50}}),n.title||this._setTitle();const i=this.config;i.color_scale=i.color_scale||{log:!1},i.color_legend||(i.color_legend={display:!0}),this.setColorFunction(),this.initialSetUp(),this.drawChart()}remove(e=!0){super.remove()}onDataHighlighted(e){const t=e.indexes[0],n=this.graph_area.selectAll("rect");n.attr("stroke","white").style("stroke-width","0px"),n.filter((e=>!(!e||e[3]!==t))).attr("stroke","black").style("stroke-width","4px"),this.highlight=t}_setTitle(){const e=this.config.category,t=this.dataStore.getColumnName(this.config.param[2]);this.setTitle(`${e}-${t}`)}changeCategory(e){this.config.category=e,this.initialSetUp(),this.drawChart(),this._setTitle()}changeValues(e){this.config.param[2]=e,this.setColorFunction(),this.initialSetUp(),this.drawChart(),this._setTitle()}initialSetUp(){const e=this.config,t=e.param,n=this.dataStore.columnIndex[t[0]],i=n.data,r=this.dataStore.columnIndex[t[1]],o=r.data,a=this.dataStore.columnIndex[t[3]];let s=null,l=null,c=n.values.length,h=r.values.length,u=a.values.length;const f=e.specific_only;f&&(s=f[0].map((e=>n.values.indexOf(e))),l=f[1].map((e=>r.values.indexOf(e))),c=f[0].length,h=f[1].length),this.y_scale.domain(f?f[0].slice(0):n.values.slice(0)),this.x_scale.domain(f?f[1].slice(0):r.values.slice(0));const d=a.data,p=this.dataStore.columnIndex[t[2]].data,g=this.dataStore.size,m=new Array(c);for(let e=0;e<c;e++){m[e]=new Array(h);for(let t=0;t<h;t++)m[e][t]=new Array(u)}for(let e=0;e<g;e++){let t=i[e],n=o[e];if(f&&(n=s.indexOf(n),t=l.indexOf(t),-1===n||-1===t))continue;let r=m[n][t][d[e]];r?(r[2]+=p[e],r[4]++):m[n][t][d[e]]=[i[e],o[e],p[e],e,1,d[e]]}for(let e=0;e<c;e++){const t=[];for(let n=0;n<h;n++)for(let i=0;i<u;i++){let r=m[e][n][i];r?r[2]/=r[4]:r=[0,0,0,0,0,0],t.push(r)}m[e]=t}this.data=m}drawChart(e=300){const t=(0,O.Z)(this.contentDiv).transition().duration(e).ease(Ct),n=this.dataStore.getColumnValues(this.config.param[0]),i=this.dataStore.getColumnValues(this.config.param[1]),r=this.dataStore.getColumnValues(this.config.param[3]),o=this.config.specific_only,a=o?o[0].length:n.length,s=r.length,l=o?o[1].length:i.length,c=l*r.length,h=this._getContentDimensions(),u=h.width/c,f=h.width/l,d=(f-4)/s,p=this,g=h.height/a;this.graph_area.selectAll(".heatmap-row").data(this.data).join("g").attr("transform",((e,t)=>`translate(0,${t*g})`)).attr("class","heatmap-row").selectAll(".heatmap-rect").data((e=>e)).join("rect").attr("class","heatmap-rect").attr("x",((e,t)=>{let n=Math.floor(t/s)*f+2;return n+=t%s*d,n})).attr("height",g).attr("width",d).on("click",((e,t)=>{p.dataStore.dataHighlighted([t[3]],p)})).transition(t).attr("fill",((e,t)=>e?isNaN(e[2])?"#f4f0ec":p.colorFunction(e[2]):"#f4f0ec")),this.updateAxis(),this.tx_axis_svg.selectAll(".tx-text").data(this.data[0]).join("text").attr("class","tx-text").attr("font-size","10px").text(((e,t)=>r[t%r.length])).style("text-anchor","end").attr("transform",((e,t)=>` translate(${t*u+u/2},${h.top}) rotate(60)`))}setSize(e,t){super.setSize(e,t),this.drawChart()}getColorLegend(){const e={overideValues:{colorLogScale:this.config.color_scale.log,colors:["#313695","#4575B4","#74ADD1","#ABD9E9","#E0F3F8","#E0F3F8","#FFFFBF","#FEE090","#FDAE61","#F46D43","#D73027","#A50026"]},name:"Scale"},t=this.config.color_scale.min_max;return t&&(e.overideValues.min=t[0],e.overideValues.max=t[1]),this.dataStore.getColorLegend(this.config.param[2],e)}getSettings(){const e=super.getSettings(),t=this.config,n=this.dataStore.getColumnValues(t.param[3]).map((e=>({t:e,v:e})));e.push({label:"Change Category",type:"dropdown",values:[n,"t","v"],current_value:t.category,func:e=>{this.changeCategory(e)}});const i=this.dataStore.getColumnList("number");return e.push({label:"Change Values",type:"dropdown",values:[i,"name","field"],current_value:t.param[2],func:e=>{this.changeValues(e)}}),e}setColorFunction(){const e=this.config.param,t={useValue:!0,overideValues:{colorLogScale:this.config.color_scale.log,colors:["#313695","#4575B4","#74ADD1","#ABD9E9","#E0F3F8","#E0F3F8","#FFFFBF","#FEE090","#FDAE61","#F46D43","#D73027","#A50026"]}},n=this.config.color_scale.min_max;n&&(t.overideValues.min=n[0],t.overideValues.max=n[1]),this.colorFunction=this.dataStore.getColorFunction(e[2],t),this.setColorLegend()}},params:[{type:"text",name:"Categories on y-axis"},{type:"text",name:"categories on x-axis"},{type:"number",name:"Value to display"},{type:"text",name:"column to filter"}]};var qi=__webpack_require__(1550),Vi=__webpack_require__.n(qi),Ki=__webpack_require__(5975);function Gi(e){var t=.9*e;return Math.abs(t)<.1?0:t}function Zi(e,t,n){return Math.min(Math.max(e,t),n)}class Xi{constructor(e={}){this.cameraState={view:Ki.yR(new Float32Array(16)),projection:Ki.yR(new Float32Array(16)),center:e.center||[0,0,0],theta:e.theta||0,phi:e.phi||0,distance:Math.log(e.distance||1e3),eye:new Float32Array(3),up:new Float32Array(e.up||[0,1,0])},this.right=new Float32Array([1,0,0]),this.front=new Float32Array([0,0,1]),this.minDistance=Math.log("minDistance"in e?e.minDistance:.5),this.maxDistance=Math.log("maxDistance"in e?e.maxDistance:1e14),this.dtheta=0,this.dphi=0,this.ddistance=0,this.updateCamera()}mouseChange(e,t){var n=Math.max(this.cameraState.distance,.5);this.dtheta+=n*e,this.dphi+=n*t,this.updateCamera()}getProjection(){return{projection:this.cameraState.projection,view:this.cameraState.view,distance:this.cameraState.distance,eye:this.cameraState.eye}}mouseWheel(e,t){this.ddistance+=t/window.innerHeight,this.updateCamera()}updateCamera(){var e=this.cameraState.center,t=this.cameraState.eye,n=this.cameraState.up;this.cameraState.theta+=this.dtheta,this.cameraState.phi=Zi(this.cameraState.phi+this.dphi,-Math.PI/2,Math.PI/2),this.cameraState.distance=Zi(this.cameraState.distance+this.ddistance,this.minDistance,this.maxDistance),this.dtheta=Gi(this.dtheta),this.dphi=Gi(this.dphi),this.ddistance=Gi(this.ddistance);for(var i=this.cameraState.theta,r=this.cameraState.phi,o=Math.exp(this.cameraState.distance),a=o*Math.sin(i)*Math.cos(r),s=o*Math.cos(i)*Math.cos(r),l=o*Math.sin(r),c=0;c<3;++c)t[c]=e[c]+a*this.front[c]+s*this.right[c]+l*n[c];Math.cos(.01),Math.sin(.01),Ki.zB(this.cameraState.view,t,e,n)}}class Yi{constructor(e,t){var n=this;for(var i in t||(t={}),this.config=t,t.offset||(t.offset=[0,0,0,0]),this.mode=t.mode||"2d",this.movingImage=0,this.__doc__=document,this.config.brush=this.config.brush||"default",this.draw_options=t.draw_options?t.draw_options:{depth:{enable:!1},blend:{enable:!0,func:{srcRGB:"src alpha",srcAlpha:"src alpha",dstRGB:"one minus src alpha",dstAlpha:"one minus src alpha"}}},this.regl=null,this.pick_buffer=null,this.hideOnFilter=!0,this.pointOpacity=.8,this.pointRadius=10,this.isFiltered=!1,this.x_scale=1,this.y_scale=1,this.offset=[0,0],this.div_container="string"==typeof e?document.getElementById(e):e,this._setUpDocument(t.width,t.height),this.handlers={object_clicked:{},object_over:{},object_out:{},brush_stopped:{},zoom_stopped:{},panning_stopped:{},pan_or_zoom:{}},this.draw_labels=!1,this.object_types=[],this.pointScale=0,this.circle_properties={x_pos:1,y_pos:1,color:1,pick_color:1,localFilter:1,globalFilter:1},this.circles={},this.circle_properties)this.circles[i]=[];for(var i in this.circles.count=0,this.object_types.push({data:this.circles,properties:this.circle_properties,vertices:1,primitive:"points"}),this.line_properties={position:2,color:2,opacity:2},this.lines={},this.line_properties)this.lines[i]=[];for(var i in this.lines.count=0,this.object_types.push({data:this.lines,properties:this.line_properties,vertices:2,primitive:"lines"}),this.image_properties={position:2,color:2,opacity:2},this.images={},this.image_properties)this.images[i]=[];for(var i in this.images.count=0,this.images.props={x_y:[],w_h:[],text:[]},this.object_types.push({data:this.images,properties:this.image_properties,vertices:6,primitive:"triangles"}),"3d"===this.mode&&(this.circle_properties.z_pos=1,this.camera=new Xi({center:t.cameraCenter,distance:t.cameraDistance||500,theta:.75,phi:.5}),this.axisScales=[1,1,1]),this.square_properties={x_pos:1,y_pos:1,color:1,pick_color:1,localFilter:1,globalFilter:1},this.squares={},this.square_properties)this.squares[i]=[];this.squares.count=0,this.object_types.push({data:this.squares,properties:this.square_properties,vertices:1,primitive:"points"}),this.mouse_position=null,this.object_clicked=null,this.dragging=!1,this.object_mouse_over=null,this.zoom_amount=0,this.draw_order=(this.mode,[2,0,1,3]),Vi()({onDone:function(e,t){n.regl=t,t._refresh(),n.pickbuffer=t.framebuffer({colorFormat:"rgba",height:n.height,width:n.width}),n._initDrawMethods(),"3d"===n.mode&&(n.object_types[0].method=n.__draw3DCircles,n.object_types[1].method=n.__draw3DLines),n._addHandlers()},canvas:n.canvas,attributes:{antialias:!1}})}setBackGroundColor(e){e=e||"",this.div_container.style.background=e}_setUpDocument(e,t){if(this.config.brush&&(this.div_container.style.cursor="crosshair"),t)this.height=t,this.width=e,this.div_container.style.height=t+"px",this.div_container.style.width=e+"px";else{const n=this.div_container.getBoundingClientRect();this.height=t=Math.round(n.height),this.width=e=Math.round(n.width)}const n={height:t,width:e,styles:{position:"absolute",left:"0px",top:"0px"}};this.canvas=(0,A.ut)("canvas",n),this.label_canvas=(0,A.ut)("canvas",n),this.label_context=this.label_canvas.getContext("2d"),this.div_container.append(this.canvas),this.div_container.append(this.label_canvas)}colorPoints(e){const t=this.circles.count,n=this.circles.color;for(let i=0;i<t;i++){const t=e(i),r=3*i;n[r]=t[0],n[r+1]=t[1],n[r+2]=t[2]}if(this.highlightPoints){const e=this.highlightPoints;for(let t=0;t<e.length;t++){const n=3*e.indexes[t],i=3*t;e.color[i]=this.circles.color[n],e.color[i+1]=this.circles.color[n+1],e.color[i+2]=this.circles.color[n+2]}}}remove(){this.pickbuffer.destroy(),this.regl.destroy(),this.canvas.remove(),this.label_canvas.remove()}setSize(e,t,n=null){if(this.height===t&&this.width===e)return;let i=this;if(e=Math.round(e),t=Math.round(t),n){const i=n(e,t);this.x_scale=i[0],this.y_scale=i[1]}else{let n=e/this.width,i=t/this.height;this.x_scale=this.x_scale*n,this.y_scale=this.y_scale*i}this.height=t,this.width=e,this.div_container.style.height=t+"px",this.div_container.style.width=e+"px",this.canvas.setAttribute("height",t),this.canvas.setAttribute("width",e),this.label_canvas.setAttribute("height",t),this.label_canvas.setAttribute("width",e),this.pickbuffer.destroy(),this.pickbuffer=this.regl.framebuffer({colorFormat:"rgba",height:t,width:e});let r=this.regl.frame((function(){}));setTimeout((()=>{i.refresh(),r.cancel()}),200)}_getMousePosition(e){var t=this.canvas.getBoundingClientRect();return[e.clientX-t.left,e.clientY-t.top]}_getActualPosition(e){return[e[0]/this.x_scale-this.offset[0],e[1]/this.y_scale-this.offset[1]]}_getCanvasCoords(e){return[(e[0]+this.offset[0])*this.x_scale,(e[1]+this.offset[1])*this.y_scale]}getRange(){let e=this._getActualPosition([0,0]),t=this._getActualPosition([this.width,this.height]);return{x_range:[e[0],t[0]],y_range:[e[1],t[1]],offset:[this.offset[0],this.offset[1]],scale:[this.x_scale,this.y_scale]}}setHighlightPoints(e){if(null==e)return void(this.highlightPoints=null);const t={x_pos:[],y_pos:[],color:[],length:e.length,indexes:e};"3d"===this.mode&&(t.z_pos=[]);for(let n of e){t.x_pos.push(this.circles.x_pos[n]),t.y_pos.push(this.circles.y_pos[n]),"3d"===this.mode&&t.z_pos.push(this.circles.z_pos[n]);const e=3*n;t.color.push(this.circles.color[e]),t.color.push(this.circles.color[e+1]),t.color.push(this.circles.color[e+2])}this.highlightPoints=t}setPointRadius(e){e&&!isNaN(e)||(e=0),this.pointRadius=e}setFilter(e){this.isFiltered=e}setHideOnFilter(e){this.hideOnFilter=e}setPointOpacity(e){e=(e=e>1?1:e)<0?0:e,this.pointOpacity=e}getPointOpacity(){return this.pointOpacity}getPointRadius(){return this.pointRadius}addLine(e,t,n=[0,0,0],i=1){return this.lines.position=this.lines.position.concat(e,t),this.lines.color=this.lines.color.concat(n,n),this.lines.opacity=this.lines.opacity.concat([i,i]),this.lines.count++,this.lines.count-1}changeImage(e,t,n){this.images.props.text[n]=this.regl.texture({data:e,min:"linear"}),this.resizeImage([t.width,t.height],n),this.setImagePosition(t.position[0],t.position[1],n)}changeImageOpacity(e,t){const n=6*e,i=n+6;for(let e=n;e<i;e++)this.images.opacity[e]=t}moveImage(e,t){const n=6*this.movingImage,i=n+6;for(let r=n;r<i;r++){const n=this.images.position[r];n[0]+=e,n[1]+=t}const r=this.images.props.x_y[this.movingImage];r[0]+=e,r[1]+=t}setImagePosition(e,t,n){const i=this.images.position,r=6*n,o=this.images.props.w_h[n][0],a=this.images.props.w_h[n][1];t=-t-a,this.images.props.x_y[n]=[e,t],i[r]=[e,t],i[r+1]=[e,t+a],i[r+2]=[e+o,t+a],i[r+3]=[e+o,t+a],i[r+4]=[e+o,t],i[r+5]=[e,t]}getImageDetails(e){const t=this.images.props.w_h[e],n=this.images.props.x_y[e];return{width:t[0],height:t[1],position:[n[0],n[1]],index:e}}resizeImage(e,t){const n=this.images.props.w_h[t],i=this.images.props.x_y[t];let r,o=null;Array.isArray(e)?(r=e[0],o=e[1],n[0]=r,n[1]=o):(r=n[0]*=e,o=n[1]*=e);const a=i[0],s=i[1];this.images.position[1]=[a,s+o],this.images.position[2]=[a+r,s+o],this.images.position[3]=[a+r,s+o],this.images.position[4]=[a+r,s]}addImage(e,t){const n=t;let i=n.position[0],r=-n.position[1];const o=n.height,a=n.width;r-=o,this.images.position.length,this.images.position.push([i,r]),this.images.position.push([i,r+o]),this.images.position.push([i+a,r+o]),this.images.position.push([i+a,r+o]),this.images.position.push([i+a,r]),this.images.position.push([i,r]),this.image_position=[[-1,1],[-1,0],[0,0],[0,0],[0,1],[-1]];const s=null==n.opacity?1:n.opacity;for(var l=0;l<6;l++)this.images.color.push([1,1,1]),this.images.opacity.push(s);return this.images.count++,this.images.props.x_y.push([i,r]),this.images.props.w_h.push([a,o]),this.images.props.text.push(this.regl.texture({data:e,min:"linear"})),this.images.count-1}removeImages(){this.images.position=[],this.images.color=[],this.images.opacity=[],this.images.props.x_y=[],this.images.props.w_h=[],this.images.props.text=[],this.images.count=0}addSquares(e){this.squares.x_pos=e.x,this.squares.y_pos=e.y;const t=e.x.length;this.squares.localFilter=e.localFilter,this.squares.globalFilter=e.globalFilter,this.squares.pick_color=new Uint8Array(3*t),this.squares.color=new Uint8Array(3*t);for(let n=0;n<t;n++){let t=3*n;const i=e.colorFunc(n);this.squares.color[t]=i[0],this.squares.color[t+1]=i[1],this.squares.color[t+2]=i[2];let r=this._getRGBFromIndex(n+1);this.squares.pick_color[t]=r[0],this.squares.pick_color[t+1]=r[1],this.squares.pick_color[t+2]=r[2]}this.squares.count=t}addCircles(e){this.circles.x_pos=e.x,this.circles.y_pos=e.y,"3d"===this.mode&&(this.circles.z_pos=e.z);const t=e.x.length;this.circles.localFilter=e.localFilter,this.circles.globalFilter=e.globalFilter,this.circles.pick_color=new Uint8Array(3*t),this.circles.color=new Uint8Array(3*t);for(let n=0;n<t;n++){let t=3*n;const i=e.colorFunc(n);this.circles.color[t]=i[0],this.circles.color[t+1]=i[1],this.circles.color[t+2]=i[2];let r=this._getRGBFromIndex(n+1);this.circles.pick_color[t]=r[0],this.circles.pick_color[t+1]=r[1],this.circles.pick_color[t+2]=r[2]}this.circles.count=t}updateSize(e,t){this.circles.x_pos=t.x,this.circles.y_pos=t.y,"3d"===this.mode&&(this.circles.z_pos=t.z),this.circles.localFilter=t.localFilter,this.circles.globalFilter=t.globalFilter;let n=new Uint8Array(3*e),i=new Uint8Array(3*e);i.set(this.circles.color),n.set(this.circles.pick_color),this.circles.color=i,this.circles.pick_color=n;for(let n=this.circles.count;n<e;n++){let e=3*n;const i=t.colorFunc(n);this.circles.color[e]=i[0],this.circles.color[e+1]=i[1],this.circles.color[e+2]=i[2];let r=this._getRGBFromIndex(n+1);this.circles.pick_color[e]=r[0],this.circles.pick_color[e+1]=r[1],this.circles.pick_color[e+2]=r[2]}this.circles.count=e}_getRGBFromIndex(e){var t=Math.floor(e/65536),n=e%65536;return[n%256,Math.floor(n/256),t]}_getIndexFromRGB(e){return 65536*e[2]+256*e[1]+e[0]}_drawPickBuffer(){this.regl.clear({color:[0,0,0,0],depth:1,framebuffer:this.pickbuffer}),this._drawObjects(!0)}refresh(){this.regl.clear({color:[0,0,0,0],depth:1}),this._drawObjects(!1),this._drawPickBuffer(),this.label_context.font="30px Arial"}setCamera(e,t,n){if("3d"!==this.mode)return;const i=this.camera.cameraState;i.distance=Math.log(e),i.theta=t,i.phi=n,this.camera.updateCamera()}getCameraSettings(){if("3d"!==this.mode)return;const e=this.camera.cameraState;return{distance:Math.pow(Math.E,e.distance),theta:e.theta,phi:e.phi}}zoom(e){this.x_scale*=e,this.y_scale*=e,this._drawObjects(!1)}setFilterAction(e){this.hideOnFilter="grey"!==e}_drawObjects(e){let t=null;if("3d"===this.mode){const e=this.camera.getProjection();t={cameraProjection:e.projection,cameraView:e.view,cameraDistance:e.distance,axisScales:this.axisScales,cameraEye:e.eye}}else t={x_scale:this.x_scale,y_scale:this.y_scale,offset:this.offset};t.point_scale=this.pointScale?(this.x_scale+this.y_scale)/2/this.pointScale:1,t.point_radius=this.pointRadius,t.is_filtered=this.isFiltered?1:0,t.point_opacity=this.pointOpacity,t.hide_on_filter=this.hideOnFilter?1:0;for(let r of this.draw_order){var n=this.object_types[r];if(n.data.count){if(e){if(!n.properties.pick_color)continue;e=this.pickbuffer}else e=null;if(t.buffer=e,t.count=n.data.count*n.vertices,t.primitive=n.primitive,t.is_buffer=e?1:0,2!==r){if(3===r){if(e)continue;this.x_scale>=this.y_scale?(t.side_length=20*this.x_scale,t.bottom_clip=this.y_scale/this.x_scale,t.right_clip=1):(t.side_length=20*this.y_scale,t.right_clip=this.x_scale/this.y_scale,t.bottom_clip=1)}for(var i in n.properties)if(e){if("pick_color"===i){t.color=n.data[i];continue}if("color"===i)continue;t[i]=n.data[i]}else{if("pick_color"===i)continue;t[i]=n.data[i]}n.method(t)}else for(let e=0;e<n.data.count;e++){for(let i in n.properties)t[i]=n.data[i].slice(6*e,6*e+6);for(let n in this.images.props)t[n]=this.images.props[n][e];n.method(t)}}}this.highlightPoints&&!e&&(t.x_pos=this.highlightPoints.x_pos,t.y_pos=this.highlightPoints.y_pos,t.color=this.highlightPoints.color,t.primitive="points",t.count=this.highlightPoints.length,"3d"===this.mode?(t.z_pos=this.highlightPoints.z_pos,this.__draw3DHighlights(t)):this.__drawHighlights(t))}getObjectsInRange(e,t,n,i){console.log(`${e},${t},${n},${i}`);const r=n*i*4;var o=this.regl.read({x:e,y:this.height-t-i,width:n,height:i,framebuffer:this.pickbuffer});const a=new Set;for(let e=0;e<r;e+=4){const t=this._getIndexFromRGB([o[e],o[e+1],o[e+2]]);null!==t&&a.add(t-1)}return a}_getObjectAtPosition(e){if(!(e[1]<=0||e[0]<=0)){try{var t=this.regl.read({x:e[0],y:this.height-e[1],width:1,height:1,framebuffer:this.pickbuffer})}catch(t){console.log(e)}if(0===t[0]&&0===t[1]&&0===t[2])return null;var n=this._getIndexFromRGB(t);return n>0?n-1:null}}addHandler(e,t,n){var i=this.handlers[e];if(!i)throw"Handler Not Supported";return n||(n=Object.keys(i).length),i[n]=t,n}removeHandler(e,t){var n=this.handlers[e];if(!n)throw"Handler Not Supported";delete n.name}_setUpBrush(e){let t=(0,A.ut)("div",{classes:["wgl2di-brush"],styles:{top:e[1]+"px",left:e[0]+"px"}},this.div_container);(0,A.$q)(t,{contain:!0,ondragstart:()=>this.brush_moving=!0,ondragend:()=>this._brushingStopped(),doc:this.__doc__}),this.brush={origin:e,div:t,resizing:!0}}_setUpPolyBrush(e){this.poly_brush={points:[e],active:!0};let t=this.label_context;t.strokeStyle=getComputedStyle(this.canvas).getPropertyValue("color"),t.beginPath(),t.moveTo(e[0],e[1])}_extendPolyBrush(e,t=15){const n=this.label_context;if(this.poly_brush.points.length){const n=this.poly_brush.points[this.poly_brush.points.length-1],i=n[0]-e[0],r=n[1]-e[1];if(Math.sqrt(i**2+r**2)<t)return}n.lineTo(e[0],e[1]),n.stroke(),this.poly_brush?.points.push(e)}_finishPolyBrush(){if(this.poly_brush.points.length<3)return void this.clearBrush();let e=this.label_context;const t=this.poly_brush.points[0];e.lineTo(t[0],t[1]),e.stroke(),e.closePath(),e.fillStyle="lightgray",e.globalAlpha=.2,e.fill(),e.globalAlpha=1;let n=[];this.poly_brush.active=!1;for(let e of this.poly_brush.points)n.push(this._getActualPosition(e));for(var i in this.handlers.brush_stopped)setTimeout((()=>this.handlers.brush_stopped[i](n,!0)),0)}clearBrush(){this.brush&&(this.brush.div.remove(),this.brush=null),this.poly_brush&&(this.label_context.clearRect(0,0,this.width,this.height),this.poly_brush=null)}_brushingStopped(){if(!this.brush)return;this.brush.resizing=!1;const e=this.brush.div,t=e.offsetTop,n=e.offsetLeft,i=e.offsetWidth,r=e.offsetHeight;if(i<2)this.clearBrush();else if("3d"===this.mode){const e=this.getObjectsInRange(n,t,i,r);for(var o in this.handlers.brush_stopped)this.handlers.brush_stopped[o](e)}else{let e=this._getActualPosition([n,t]),a=this._getActualPosition([n+i,t+r]),s={x_min:e[0],x_max:a[0],y_max:-e[1],y_min:-a[1]};for(var o in this.handlers.brush_stopped)this.handlers.brush_stopped[o](s)}}setGlobalFilter(e){this.circles.globalFilter=e}_addHandlers(){var e=this;this.div_container.addEventListener("mousemove",(function(t){if(e.brush){if(e.brush.resizing){let n=e.brush.origin,i=e._getMousePosition(t),r=Math.round(n[0]<i[0]?n[0]:i[0])+"px",o=Math.round(n[1]<i[1]?n[1]:i[1])+"px",a=Math.abs(n[0]-i[0])+"px",s=Math.abs(n[1]-i[1])+"px";return e.brush.div.style.top=o,e.brush.div.style.left=r,e.brush.div.style.width=a,void(e.brush.div.style.height=s)}if(e.brush.moving)return void(e.dragging=!1)}if(e.poly_brush&&e.poly_brush.active){let n=e._getMousePosition(t);e._extendPolyBrush(n)}if(e.mouse_position&&!e.dragging){var n=t.pageX-e.mouse_position[0],i=t.pageY-e.mouse_position[1];(Math.abs(n)>3||Math.abs(i)>3)&&(e.dragging=!0)}if(e.dragging){const n=t.pageX-e.mouse_position[0],i=t.pageY-e.mouse_position[1];if("3d"===e.mode)e.camera.mouseChange(n/e.width,i/e.height);else{const o=n/e.x_scale,a=i/e.y_scale;if(null!=e.movingImage&&t.ctrlKey&&e.images.count>0)e.moveImage(o,a),e.imageMoved=e.getImageDetails(e.movingImage);else if(e.offsets&&3==t.which)e.alterOffsets(o,a);else for(var r in e.config.lock_x_axis||(e.offset[0]+=o),e.offset[1]+=a,e.handlers.pan_or_zoom)e.handlers.pan_or_zoom[r](e.offset,e.x_scale,e.y_scale)}e.loop||(e.loop=e.regl.frame((()=>{e.regl.clear({color:[0,0,0,0],depth:1}),e._drawObjects(!1)}))),e.mouse_position[1]=t.pageY,e.mouse_position[0]=t.pageX}else{var o=e._getMousePosition(t),a=e._getObjectAtPosition(o);if(null!=a&&null==e.object_mouse_over){for(var r in e.handlers.object_over)e.handlers.object_over[r](t,a);e.object_mouse_over=a}else if(null==a&&e.object_mouse_over){for(var r in e.handlers.object_out)e.handlers.object_out[r](t,e.object_mouse_over);e.object_mouse_over=null}else if(null!=a&&a!==e.object_mouse_over){for(var r in e.handlers.object_over)e.handlers.object_over[r](t,a);e.object_mouse_over=a}}})),this.div_container.addEventListener("mouseleave",(function(t){if(e.object_mouse_over){for(var n in e.handlers.object_out)e.handlers.object_out[n](e.object_mouse_over[2]);e.object_mouse_over=null}e.brush&&e.brush.resizing&&e._brushingStopped()})),this.div_container.addEventListener("mouseup",(function(t){if(e.config.brush&&(e.div_container.style.cursor="crosshair"),e.brush&&e.brush.resizing&&e._brushingStopped(),e.poly_brush&&e.poly_brush.active&&e._finishPolyBrush(),e.dragging||e.brush||e.poly_brush){if(e.object_clicked)e.object_clicked=null,e.refresh(!0);else{let t=e.getRange();for(var n in e.loop&&(e.loop.cancel(),e.loop=null),e.refresh(),t.imageMoved=e.imageMoved,e.imageMoved=null,e.handlers.panning_stopped)e.handlers.panning_stopped[n](t)}e.dragging=!1}else{var i=e._getMousePosition(t),r=e._getObjectAtPosition(i);if(r)for(var n in e.handlers.object_clicked)e.handlers.object_clicked[n](r)}e.object_clicked=null,e.mouse_position=null})),this.div_container.addEventListener("wheel",(function(t){t.preventDefault();var n=e._getActualPosition(e._getMousePosition(t));let i=0;if(t.wheelDelta>0||t.detail<0?(e.zoom_amount+=.01,i=-30):(e.zoom_amount-=.01,i=30),"3d"===e.mode)e.camera.mouseWheel(0,i);else if(null!=e.movingImage&&t.ctrlKey){e.resizeImage(1+e.zoom_amount,e.movingImage);const i=e._getActualPosition(e._getMousePosition(t));e.moveImage(i[0]-n[0],i[1]-n[1]),e.imageMoved=e.getImageDetails(e.movingImage)}else{e.config.lock_x_axis||(e.x_scale*=1+e.zoom_amount),e.config.lock_y_axis||(e.y_scale*=1+e.zoom_amount);const i=e._getActualPosition(e._getMousePosition(t));for(var r in e.offset[0]+=i[0]-n[0],e.offset[1]+=i[1]-n[1],e.handlers.pan_or_zoom)e.handlers.pan_or_zoom[r](e.offset,e.x_scale,e.y_scale)}e.loop||(e.label_context.clearRect(0,0,e.width,e.height),e.loop=e.regl.frame((function(){e.regl.clear({color:[0,0,0,0],depth:1}),e._drawObjects(!1)}))),clearTimeout(e._timer),e._timer=setTimeout((function(){e.zoom_amount=0,e.loop.cancel(),e.loop=null,e._drawPickBuffer(!1),e.brush;let t=e.getRange();t.imageMoved=e.imageMoved,e.imageMoved=null;for(let n in e.handlers.zoom_stopped)e.handlers.zoom_stopped[n](t);e.refresh()}),350)})),this.div_container.addEventListener("mousedown",(function(t){t.which;let n=t.shiftKey||t.ctrlKey||2==t.which||3==t.which;if(e.config.brush&&!n||!e.config.brush&&n){let n=e._getMousePosition(t);if("default"==e.config.brush){if(t.target.classList.contains("wgl2di-brush"))return;e.brush&&e.clearBrush();let n=e._getMousePosition(t);return void e._setUpBrush(n)}if("poly"===e.config.brush)return e.poly_brush&&e.clearBrush(),void e._setUpPolyBrush(n)}t.otherKey&&(e.div_container.style.cursor="move"),e._getMousePosition(t),e.mouse_position=[t.pageX,t.pageY],e.clearBrush(),t.preventDefault()}))}_initDrawMethods(){var e=this;this.__drawCircles=this.regl({depth:e.draw_options.depth,blend:e.draw_options.blend,frag:"precision mediump float;\n\t\t\tvarying vec3 fragColor;\n\t\t\tvarying float op;\n\t\t\tvarying float has_border;\n\t\t\tvarying float grey_out;\n\t\t\tuniform float is_buffer;\n\t\t\t\n\t\t\tvoid main(){\n\t\t\t\n\t\t\t\tvec2 cxy = 2.0 * gl_PointCoord - 1.0;\n                \n\t\t\t\tfloat r = dot(cxy, cxy);\n\t\t\t\tif (r > 1.0) {\n\t\t\t\t\tdiscard;\n\t\t\t\t}\n\t\t\t\telse{\t\t\t\t\t\n\t\t\t\t\tif(r>0.60 && has_border==-1.0 && is_buffer==0.0 && grey_out==0.0){\n\t\t\t\t\t    gl_FragColor=vec4(0.1,0.1,0.1,1.0);\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tif (grey_out==1.0 && is_buffer==0.0){\n\t\t\t\t\t\t\tgl_FragColor = vec4(0.2,0.2,0.2,0.4);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\tgl_FragColor = vec4(fragColor,is_buffer==1.0?1.0:op);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t}",vert:"attribute float x_pos;\n            attribute float y_pos;\n\t\t\tattribute vec3 color;\n\t\t\tattribute float lFilter;\n\t\t\tattribute float gFilter;\n\t\t\tvarying vec3 fragColor;\n\t\t\tvarying float op;\n\t\t\tvarying float has_border;\n\t\t\tvarying float grey_out;\n\t\t\tuniform float x_scale;\n\t\t\tuniform float y_scale;\n\t\t\tuniform vec2 offset;\n\t\t\tuniform float stage_height;\n\t\t\tuniform float stage_width;\n\t\t\tuniform float point_radius;\n\t\t\tuniform float is_filtered;\n\t\t\tuniform float point_opacity;\n\t\t\tuniform float hide_on_filter;\n\t\t\tuniform float point_scale;\n\t\t\t\n\t\t\tvec2 normalizeCoords(float posX, float posY){\n\t\t\t\tfloat x = (posX+offset[0])*x_scale;\n\t\t\t\tfloat y = (posY+offset[1])*y_scale;\n\t\t\t\treturn vec2(2.0 * ((x / stage_width) - 0.5),-(2.0 * ((y / stage_height) - 0.5)));\n\t\t\t}\n\t\n\t\t\tvoid main() {\n\t\t\t\tfloat dd = 0.0;\n\t\t\t\tgrey_out=0.0;\n\t\t\t\tif (lFilter==2.0){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t    if (gFilter>0.0 && gFilter != lFilter) {\n\t\t\t\t\tif(hide_on_filter==1.0){\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tgrey_out=1.0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\n\t\t\t\tfloat r=point_radius;\n\t\t\t\n\t\t\t\tgl_PointSize = r*point_scale;\n\t\t\t\tvec3 c = vec3(255.0,255.0,255.0);\n\t\t\t\tif (color==c){\n\t\t\t\t\top=0.1;\n\t\t\t\t\tfragColor=vec3(0.1,0.1,0.1);\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\top=point_opacity;\n\t\t\t\t\tfragColor = color/255.0;\n\t\t\t\t}\n\t\t\t\n\t\t\t\t\n\t\t\t\t\n\t\t\t\thas_border=lFilter-is_filtered;\n\t\t\t\n\t\t\t\t\n\t\t\t\tvec2 real_position = normalizeCoords(x_pos,-y_pos);\n\t\t\t\tgl_Position = vec4(real_position, 0.0, 1.0);\n\t\t\t}\n\t\t\t",attributes:{x_pos:e.regl.prop("x_pos"),y_pos:e.regl.prop("y_pos"),color:e.regl.prop("color"),lFilter:e.regl.prop("localFilter"),gFilter:e.regl.prop("globalFilter")},uniforms:{x_scale:e.regl.prop("x_scale"),y_scale:e.regl.prop("y_scale"),stage_width:e.regl.context("viewportWidth"),stage_height:e.regl.context("viewportHeight"),offset:e.regl.prop("offset"),point_radius:e.regl.prop("point_radius"),point_opacity:e.regl.prop("point_opacity"),is_filtered:e.regl.prop("is_filtered"),is_buffer:e.regl.prop("is_buffer"),hide_on_filter:e.regl.prop("hide_on_filter"),point_scale:e.regl.prop("point_scale")},count:e.regl.prop("count"),primitive:e.regl.prop("primitive"),framebuffer:e.regl.prop("buffer")}),this.__drawHighlights=this.regl({depth:e.draw_options.depth,blend:e.draw_options.blend,depth:e.draw_options.depth,blend:e.draw_options.blend,frag:"precision highp float;\n\t\t\tvarying vec3 fragColor;\n\t\t\t\n\t\t\tvoid main(){\n\n\t\t\t\tvec2 cxy = 2.0 * gl_PointCoord - 1.0;\n                \n\t\t\t\tfloat r = dot(cxy, cxy);\n\t\t\t\tif (r > 1.0) {\n\t\t\t\t\tdiscard;\n\t\t\t\t}\n\t\t\t\telse{\t\t\t\t\t\n\t\t\t\t\tif(r>0.50) {\n\t\t\t\t\t    gl_FragColor=vec4(0.1,0.1,0.1,1.0);\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tgl_FragColor = vec4(fragColor,1);\n\t\t\t\t\t}\n\t\t\t\t}\t\n\t\t\t}",vert:"attribute float x_pos;\n            attribute float y_pos;\n\t\t\tattribute vec3 color;\n\t\t\tuniform float point_radius;\n\t\t\t\n\t\t\tvarying vec3 fragColor;\n\t\t\n\t\t\tuniform float x_scale;\n\t\t\tuniform float y_scale;\n\t\t\tuniform vec2 offset;\n\t\t\tuniform float stage_height;\n\t\t\tuniform float stage_width;\n\t\t\tuniform float point_scale;\n\t\t\t\n\t\t\tvec2 normalizeCoords(float posX, float posY){\n\t\t\t\tfloat x = (posX+offset[0])*x_scale;\n\t\t\t\tfloat y = (posY+offset[1])*y_scale;\n\t\t\t\treturn vec2(2.0 * ((x / stage_width) - 0.5),-(2.0 * ((y / stage_height) - 0.5)));\n\t\t\t}\n\t\n\t\t\tvoid main() {\n\t\t\t\n\t\t\t\tfloat pr = point_radius*point_scale;\n\t\t\t\tpr = pr<10.0?10.0:pr;\n\t\t\t\tgl_PointSize = pr;\n\t\t\t\tfragColor = color/255.0;\n\t\t\t\t\t\n\t\t\t\tvec2 real_position = normalizeCoords(x_pos,-y_pos);\n\t\t\t\tgl_Position = vec4(real_position, 0.0, 1.0);\n\t\t\t}\n\t\t\t",attributes:{x_pos:e.regl.prop("x_pos"),y_pos:e.regl.prop("y_pos"),color:e.regl.prop("color")},uniforms:{x_scale:e.regl.prop("x_scale"),y_scale:e.regl.prop("y_scale"),stage_width:e.regl.context("viewportWidth"),stage_height:e.regl.context("viewportHeight"),offset:e.regl.prop("offset"),point_radius:e.regl.prop("point_radius"),point_scale:e.regl.prop("point_scale")},count:e.regl.prop("count"),primitive:e.regl.prop("primitive")}),this.object_types[0].method=this.__drawCircles,this.__drawLines=this.regl({frag:"precision highp float;\n\t\t\t\t\t\tvarying vec3 fragColor;\n\t\t\t\t\t\tvoid main () {\n\t\t\t\t\t\t\t gl_FragColor = vec4(fragColor,1);\n\t\t\t\t\t\t}",vert:"\n\t\t\t\t\t\tattribute vec2 position;\n\t\t\t\t\t\tattribute vec3 color;\n\t\t\t\t\t\tattribute float opacity;\n\t\t\t\t\t\tuniform float x_scale;\n\t\t\t\t\t\tuniform float y_scale;\n\t\t\t\t\t\tuniform vec2 offset;\n\t\t\t\t\t\tuniform float stage_height;\n\t\t\t\t\t\tuniform float stage_width;\n\t\t\t\t\t\tvarying vec3 fragColor;\n\t\t\t\t\t\t//varying float op;\n\t\t\t\t\t\tvec2 normalizeCoords(vec2 position){\t    \n\t\t\t\t\t\t\tfloat x = (position[0]+offset[0])*x_scale;\n\t\t\t\t\t\t\tfloat y = (position[1]+offset[1])*y_scale;\n\t\t\t\t            return vec2(2.0 * ((x / stage_width) - 0.5),-(2.0 * ((y / stage_height) - 0.5)));\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvoid main () {\n\t\t\t\t\t\t\tif (opacity==0.0){\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tfragColor=color/255.0;\n\t\t\t\t\t\t\tvec2 norm_pos =normalizeCoords(position*vec2(1,-1));\n\t\t\t\t\t\t\tgl_Position = vec4(norm_pos, 0.0, 1.0);\n\t\t\t\t\t\t}",attributes:{position:e.regl.prop("position"),color:e.regl.prop("color"),opacity:e.regl.prop("opacity")},uniforms:{x_scale:e.regl.prop("x_scale"),y_scale:e.regl.prop("y_scale"),stage_height:e.regl.context("viewportHeight"),stage_width:e.regl.context("viewportWidth"),offset:e.regl.prop("offset")},primitive:e.regl.prop("primitive"),count:e.regl.prop("count")}),this.object_types[1].method=this.__drawLines,this.__drawImages=this.regl({frag:"\n\t\t\t\tprecision mediump float;\n\t\t\t\tuniform sampler2D text;\n\t\t\t\tvarying vec2 uv;\n\t\t\t\tvarying vec3 fragColor;\n\t\t\t\tvarying float op;\n\t\t\t\tvoid main () {\n\t\t\t\t\tgl_FragColor = vec4(fragColor,op)*texture2D(text, uv);\t\t\t\t\t\t\t\n\t\t\t\t}",vert:"\n\t\t\t\tprecision mediump float;\n\n\t\t\t\tattribute vec2 position;\n\t\t\t\tattribute vec3 color;\n\t\t\t\tattribute float opacity;\n\n\t\t\t\tuniform vec2 x_y;\n\t\t\t\tuniform vec2 w_h;\n\t\t\t\tuniform float stage_height;\n\t\t\t\tuniform float stage_width;\n\t\t\t\tuniform float x_scale;\n\t\t\t\tuniform float y_scale;\n\t\t\t\tuniform vec2 offset;\n\n\t\t\t\tvarying vec2 uv;\n\t\t\t\tvarying vec3 fragColor;\n\t\t\t\tvarying float op;\n\t\t\n\t\t\t\t\n\t\t\t\tvec2 normalizeCoords(vec2 pos){\n\t\t\t\t\tfloat x = (pos[0]+offset[0])*x_scale;\n\t\t\t\t\tfloat y = (pos[1]+offset[1])*y_scale;\n\t\t\t\t\treturn vec2(2.0 * ((x / stage_width) - 0.5),-(2.0 * ((y / stage_height) - 0.5)));\n\t\t\t\t}\n\n\t\t\t\tvoid main () {\n\t\t\t\t\tif (opacity==0.0){\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\top=opacity;\n\t\t\t\t\t\n\t\t\t\t\tvec2 new_pos=normalizeCoords(position);\n\t\t\t\t\tfragColor = color;\n\t\t\t\t\n\t\t\t\t\tfloat x_factor = 1.0/(((w_h[0]*x_scale)/stage_width)*2.0);\n\t\t\t\t\tfloat y_factor = 1.0/(((w_h[1]*y_scale)/stage_height)*2.0);\n\t\t\t\t\t\n\n\t\t\t\t\tfloat x_offset=(((x_y[0]+offset[0])*x_scale)/stage_width)*2.0*x_factor;\n\t\t\t\t\tfloat y_offset=(((x_y[1]+offset[1])*y_scale)/stage_height)*2.0*y_factor;\n\t\t\t\t\tuv = vec2((new_pos[0]*x_factor)+x_factor-x_offset,-(new_pos[1]*y_factor)+y_factor-y_offset);\n\t\t\t\t\tgl_Position = vec4(new_pos, 0.0, 1.0);\n\n\t\t\t\t}",attributes:{position:e.regl.prop("position"),color:e.regl.prop("color"),opacity:e.regl.prop("opacity")},uniforms:{stage_height:e.regl.context("viewportHeight"),stage_width:e.regl.context("viewportWidth"),w_h:e.regl.prop("w_h"),x_y:e.regl.prop("x_y"),text:e.regl.prop("text"),x_scale:e.regl.prop("x_scale"),y_scale:e.regl.prop("y_scale"),offset:e.regl.prop("offset")},count:e.regl.prop("count"),depth:e.draw_options.depth,blend:e.draw_options.blend}),this.object_types[2].method=this.__drawImages,this.__drawSquares=this.regl({frag:"\n\t\t\t\tprecision highp float;\n\t\t\t\tvarying vec3 fragColor;\n\t\t\t\tvarying float r_clip;\n\t\t\t\tvarying float b_clip;\n\t\t\t\tuniform int is_buffer;\n\t\t\t\tvoid main(){\n\t\t\t\t\tif (gl_PointCoord[1]<1.0-b_clip){\n\t\t\t\t\t\tdiscard;\n\t\t\t\t\t}\n\t\t\t\t\tif (gl_PointCoord[0]> r_clip){\n\t\t\t\t\t\tdiscard;\n\t\t\t\t\t}\t\t\t\t\n\t\t\t\t\tgl_FragColor = vec4(fragColor,1);\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\t",vert:" \n\t\t\t\tattribute float x_pos;\n\t\t\t\tattribute float y_pos;\t\t\t\n\t\t\t\tattribute vec3 color;\n\t\t\t\n\t\t\t\tvarying float r_clip;\n\t\t\t\tvarying float b_clip;\n\t\t\t\tvarying vec3 fragColor;\n\n\t\t\t\tuniform float x_scale;\n\t\t\t\tuniform float y_scale;\n\t\t\t\tuniform vec2 offset;\n\t\t\t\tuniform float stage_height;\n\t\t\t\tuniform float stage_width;\n\t\t\t\tuniform float right_clip;\n\t\t\t\tuniform float bottom_clip;\n\t\t\t\tuniform float side_length;\n\t\t\t\t\n\t\t\t\tvec2 normalizeCoords(float posX,float posY){\n\t\t\t\t\tfloat x = (posX+offset[0])*x_scale;\n\t\t\t\t\tfloat y = (posY+offset[1])*y_scale;\n\t\t\t\t\treturn vec2(2.0 * ((x / stage_width) - 0.5),-(2.0 * ((y / stage_height) - 0.5)));\n\t\t\t\t}\n\t\t\t\tvoid main() {\n\t\t\t\t\tgl_PointSize = side_length;\n\t\t\t\t\tfragColor = color/255.0;\n\t\t\t\t\tr_clip=right_clip;\n\t\t\t\t\tb_clip= bottom_clip;\n\t\t\t\t\tfloat y = y_pos;\n\t\t\t\t\tfloat x = x_pos;\n\t\t\t\t\tif (bottom_clip!=1.0){\n\t\t\t\t\t\ty-=10.0*(1.0/b_clip)-10.0;\n\t\t\t\t\t}\n\t\t\t\t\tif (r_clip!=1.0){\n\t\t\t\t\t\tx+=10.0*(1.0/r_clip)-10.0;\n\t\t\t\t\t}\n\n\t\t\t\t\tvec2 real_position = normalizeCoords(x,y);\n\t\t\t\t\n\t\t\t\t\tgl_Position = vec4(real_position, 0.0, 1.0);\n\t\t\t\t}\n\t\t\t",attributes:{x_pos:e.regl.prop("x_pos"),y_pos:e.regl.prop("y_pos"),color:e.regl.prop("color")},uniforms:{x_scale:e.regl.prop("x_scale"),y_scale:e.regl.prop("y_scale"),stage_height:e.regl.context("viewportHeight"),stage_width:e.regl.context("viewportWidth"),offset:e.regl.prop("offset"),is_buffer:e.regl.prop("is_buffer"),right_clip:e.regl.prop("right_clip"),bottom_clip:e.regl.prop("bottom_clip"),side_length:e.regl.prop("side_length")},count:e.regl.prop("count"),primitive:e.regl.prop("primitive"),framebuffer:e.regl.prop("buffer")}),this.object_types[3].method=this.__drawSquares,this.__draw3DCircles=this.regl({frag:"\n            precision highp float;\n            varying vec3 fragColor;\n\t\t\tvarying float op;\n\t\t\tvarying float has_border;\n\t\t\tuniform float is_buffer;\n\t\t\tvarying float grey_out;\n            void main () {\n\t\t\t  float r = length(gl_PointCoord.xy - 0.4) ;\n              if (r> 0.4) {\n                discard;\n              }\n\t\t\t  else{\n\t\t\t\tif(r>0.3 && has_border==-1.0 && is_buffer==0.0 && grey_out==0.0){\n\t\t\t\t\tgl_FragColor=vec4(0.1,0.1,0.1,1.0);\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tif (grey_out==1.0 && is_buffer==0.0){\n\t\t\t\t\t\tgl_FragColor = vec4(0.2,0.2,0.2,0.4);\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tgl_FragColor = vec4(fragColor,is_buffer==1.0?1.0:op);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t}\n\n\t\t\t  }\n             \n            }\n            ",vert:"\n            precision highp float;\n\n            attribute float x_pos;\n            attribute float y_pos;\n            attribute float z_pos;\n            attribute vec3 color;\n            attribute float lFilter;\n            attribute float gFilter;\n\t\t\t\n\t\t\tuniform float time;\n            uniform float cdistance;\n            uniform mat4 view, projection;\n\t\t\tuniform vec3 eye;\n\t\t\tuniform float point_radius;\n\t\t\tuniform float point_opacity;\n\t\t\tuniform float is_buffer;\n\t\t\tuniform float is_filtered;\n\t\t\tuniform float hide_on_filter;\n\t\t\tuniform vec3 axis_scales;\n\n\n            varying vec3 fragColor;\n\t\t\tvarying float op;\n\t\t\tvarying float has_border;\n\t\t\tvarying float grey_out;\n\n            void main () {\n\t\t\t\tgrey_out=0.0; \n\t\t\t    if (gFilter>0.0 && gFilter != lFilter) {\n\t\t\t\t\tif(hide_on_filter==1.0){\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tgrey_out=1.0;\n\t\t\t\t\t}\n\t\t\t\t}\n                vec3 position = vec3(-x_pos *axis_scales.x,y_pos*axis_scales.y,-z_pos*axis_scales.z);\n                fragColor=color/255.0;\n\t\t\t\top = is_buffer==1.0?1.0:point_opacity;\n\t\t\t\thas_border=lFilter-is_filtered;\n               \n\t\t\t\tgl_PointSize = point_radius; //(distance(eye, position.xyz) /30.0);\n                gl_Position = projection * view * vec4(2.0 * position, 1.0);\n            }\n            ",attributes:{x_pos:e.regl.prop("x_pos"),y_pos:e.regl.prop("y_pos"),z_pos:e.regl.prop("z_pos"),color:e.regl.prop("color"),lFilter:e.regl.prop("localFilter"),gFilter:e.regl.prop("globalFilter")},uniforms:{point_radius:e.regl.prop("point_radius"),point_opacity:e.regl.prop("point_opacity"),is_buffer:e.regl.prop("is_buffer"),view:e.regl.prop("cameraView"),cdistance:e.regl.prop("cameraDistance"),eye:e.regl.prop("cameraEye"),is_filtered:e.regl.prop("is_filtered"),hide_on_filter:e.regl.prop("hide_on_filter"),axis_scales:e.regl.prop("axisScales"),projection:(e,t)=>Ki.G3(t.cameraProjection,Math.PI/4,e.viewportWidth/e.viewportHeight,1,1e5)},count:e.regl.prop("count"),framebuffer:e.regl.prop("buffer"),blend:e.draw_options.blend,primitive:"points"}),this.__draw3DHighlights=this.regl({frag:"\n            precision mediump float;\n            varying vec3 fragColor;\n\t\t\n            void main () {\n\t\t\t  float r = length(gl_PointCoord.xy - 0.4) ;\n              if (r> 0.4) {\n                discard;\n              }\n\t\t\t  else{\n\t\t\t\tif(r>0.3){\n\t\t\t\t\tgl_FragColor=vec4(0.1,0.1,0.1,1.0);\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\t\n\t\t\t\t\t\tgl_FragColor = vec4(fragColor,1.0);\n\t\t\t\t}\n\t\t\t\t\t\n\t\t\t  }\n             \n            }\n            ",vert:"\n            precision mediump float;\n\n            attribute float x_pos;\n            attribute float y_pos;\n            attribute float z_pos;\n            attribute vec3 color;\n\t\t\t\n\t\t\tuniform float time;\n    \n            uniform mat4 view, projection;\n\t\t\tuniform vec3 eye;\n\t\t\tuniform float point_radius;\n\t\t\tuniform vec3 axis_scales;\n\t\t\n\n\n            varying vec3 fragColor;\n\t\t\n\n            void main () {\n\t\t\t\n                vec3 position = vec3(-x_pos*axis_scales.x,y_pos*axis_scales.y,-z_pos*axis_scales.z);\n                fragColor=color/255.0;\n               \n\t\t\t\tgl_PointSize = point_radius*2.0; //(distance(eye, position.xyz) /30.0);\n                gl_Position = projection * view * vec4(2.0 * position, 1.0);\n            }\n            ",attributes:{x_pos:e.regl.prop("x_pos"),y_pos:e.regl.prop("y_pos"),z_pos:e.regl.prop("z_pos"),color:e.regl.prop("color")},uniforms:{point_radius:e.regl.prop("point_radius"),view:e.regl.prop("cameraView"),cdistance:e.regl.prop("cameraDistance"),eye:e.regl.prop("cameraEye"),axis_scales:e.regl.prop("axisScales"),projection:(e,t)=>Ki.G3(t.cameraProjection,Math.PI/4,e.viewportWidth/e.viewportHeight,1,1e5)},count:e.regl.prop("count"),blend:e.draw_options.blend,primitive:"points"}),this.__draw3DLines=this.regl({frag:" precision highp float;\n                    varying vec3 fragColor;\n                    void main () {\n                         gl_FragColor = vec4(fragColor,1);\n                    }\n",vert:"\n                    attribute vec3 position;\n                    attribute vec3 color;\n                    uniform mat4 view, projection;\n\t\t\t\t\tuniform vec3 axis_scales;\n    \n                    varying vec3 fragColor;\n                  \n                    \n                    void main () {\n                     \n                        fragColor=color;\n                        gl_Position = projection * view * vec4(2.0 * position*axis_scales*vec3(-1.0,1.0,-1.0), 1.0);\n                       \n                       \n                    }",attributes:{position:e.regl.prop("position"),color:e.regl.prop("color")},uniforms:{view:e.regl.prop("cameraView"),axis_scales:e.regl.prop("axisScales"),projection:(e,t)=>Ki.G3(t.cameraProjection,Math.PI/4,e.viewportWidth/e.viewportHeight,.01,1e5)},primitive:e.regl.prop("primitive"),framebuffer:e.regl.prop("buffer"),count:e.regl.prop("count"),depth:{enable:!1}})}}const Qi=class extends Mt{constructor(e,t,n,i){super(e,t,n,i);const r=this.config;r.tooltip||(r.tooltip={show:!1}),r.default_color=r.default_color||"#377eb8";const o=this._getContentDimensions();this.graphDiv=(0,A.ut)("div",{styles:{position:"absolute",left:o.left+"px",top:o.top+"px",width:o.width+"px",height:o.height+"px"}},this.contentDiv),this.tooltip=(0,A.ut)("div",{styles:{position:"absolute",zIndex:100,display:"none","background-color":"lightgray"}},this.graphDiv)}onDataHighlighted(e){this.app.setHighlightPoints(e.indexes),this.app.refresh()}afterAppCreation(){const e=this,t=this.config;this.app.addHandler("object_over",(function(n,i){t.tooltip.show&&e.showTooltip(n,i)})),this.app.addHandler("object_out",(function(t,n){e.tooltip.style.display="none"})),t.default_color=t.default_color||"#377eb8",t.on_filter=null==t.on_filter?"hide":t.on_filter,this.app.setFilterAction(t.on_filter);const n=(0,Rt.$W)(t.default_color);let i=()=>n;if(t.color_by){const e={asArray:!0,overideValues:{colorLogScale:this.config.log_color_scale}};this._addTrimmedColor(t.color_by,e),i=this.dataStore.getColorFunction(t.color_by,e),t.color_legend||(t.color_legend={display:!0}),this.setColorLegend()}return this.app.addHandler("object_clicked",(e=>{this.dataStore.dataHighlighted([e],this)})),i}setToolTipColumn(e){this.config.tooltip.column=e}showTooltip(e,t){var n=this.graphDiv.getBoundingClientRect();const i=this.dataStore.getRowAsObject(t),r=e.clientX-n.left,o=e.clientY-n.top;this.tooltip.style.display="block",this.tooltip.style.left=r+"px",this.tooltip.style.top=o+"px",this.tooltip.textContent=i[this.config.tooltip.column]}getSetupConfig(){const e=this.config,t=(0,Rt.$W)(e.default_color);let n=()=>t;return e.color_by&&(n=this.dataStore.getColorFunction(e.color_by,{asArray:!0})),{localFilter:this.dim.getLocalFilter(),globalFilter:this.dataStore.getFilter(),colorFunc:n}}setSize(e,t){super.setSize(e,t);const n=this._getContentDimensions();this.app.setSize(n.width,n.height),this.graphDiv.style.left=n.left+"px",this.graphDiv.style.top=n.top+"px",this.updateAxis()}onDataFiltered(e){"all_removed"===e&&(this.app.clearBrush(),this.app.setFilter(!1),this.resetButton.style.display="none"),this.app.setHighlightPoints(null),this.app.refresh()}remove(e=!0){this.dim.destroy(e),this.app.remove(),super.remove()}removeFilter(){null!==this.filter&&(this.dim.removeFilter(),this.app.clearBrush(),this.app.setFilter(!1),this.app.refresh())}colorByColumn(e){this.config.color_by=e;const t=this.getColorFunction(e,!0),n=performance.now();this.app.colorPoints(t),console.log("color time:"+(performance.now()-n)),setTimeout((()=>{this.app.refresh()}),50)}colorByDefault(){this.legend&&this.legend.remove();const e=(0,Rt.$W)(this.config.default_color);this.app.colorPoints((()=>e)),setTimeout((()=>{this.app.refresh()}),50)}changeBaseDocument(e){this.app.clearBrush(),this.app.__doc__=e,super.changeBaseDocument(e)}getColorOptions(){return{colorby:"all",has_default_color:!0}}pinChart(){this.isPinned=!0,this.pinnedFilter=this.dataStore.getFilter().slice(0),this.app.setGlobalFilter(this.pinnedFilter)}unpinChart(){this.isPinned=!1,this.pinnedFilter=null,this.app.setGlobalFilter(this.dataStore.getFilter()),this.app.refresh()}addToImage(){this.app.refresh();let e=this.app.canvas.toDataURL("image/png");e=e.replace(/^data:image\/png/,"data:application/octet-stream");const t=this._getContentDimensions();this.svg.append("image").attr("xlink:href",e).attr("width",t.width).attr("height",t.height).attr("x",t.left).attr("y",t.top)}removeFromImage(){this.svg.select("image").remove()}getSettings(e){e||(e={pointMax:50,pointMin:1});const t=super.getSettings(),n=this.config,i=this.dataStore.getColumnList();return t.splice(2,0,{type:"slider",max:1,min:0,doc:this.__doc__,current_value:n.opacity,label:"Point Opacity",func:e=>{n.opacity=e,this.app.setPointOpacity(e),this.app.refresh()}},{type:"slider",max:10,min:0,doc:this.__doc__,current_value:n.radius,label:"Point Size",func:e=>{n.radius=e,this.app.setPointRadius(e),this.app.refresh(),console.log(e)}}),t.concat([{type:"check",label:"Show Tooltip",current_value:n.tooltip.show,func:e=>{n.tooltip.show=e;let t=n.tooltip.column||i[0].field;this.setToolTipColumn(t)}},{type:"dropdown",label:"Tooltip value",current_value:n.tooltip.column||i[0].field,values:[i,"name","field"],func:e=>{this.setToolTipColumn(e)}},{type:"button",label:"Centre Plot",func:e=>{this.centerGraph(),this.app.refresh()}},{type:"radiobuttons",label:"Action on Filter",choices:[["Hide Points","hide"],["Gray Out Points","grey"]],current_value:n.on_filter,func:e=>{n.on_filter=e,this.app.setFilterAction(e),this.app.refresh()}}])}};class Ji extends M{constructor(e){super({title:"Alter Position",width:300,doc:e.__doc__},e)}init(e){this.plot=e,this.ds=this.plot.dataStore,(0,A.ut)("div",{text:"Offset"},this.dialog),this.bdiv=(0,A.ut)("div",{styles:{display:"flex",justifyContent:"center",alignItems:"center",position:"relative",height:"60px"}},this.dialog);for(let e of[["top","up"],["bottom","down"],["right","right"],["left","left"]])this._addPButton(e);(0,A.ut)("div",{text:"Rotation"},this.dialog),this.rDiv=(0,A.ut)("div",{styles:{height:"30px",position:"relative"}},this.dialog);for(let e of["left","right"])this._addRButton(e);const t=(0,A.ut)("div",{},this.dialog),n=this.ds.columnIndex[this.ds.offsets.groups].name;(0,A.ut)("div",{text:n},t),this.groupSelect=(0,A.ut)("select",{},t),(0,A.ut)("button",{classes:["ciview-button-sm"],text:"Reset"},t).addEventListener("click",(e=>{this.ds.resetColumnOffsets(this.filter,this.groupSelect.value,!0),this._showOffsets(this.groupSelect.value)}));const i=this.ds.columnIndex[this.ds.offsets.groups].values;for(let e of i)(0,A.ut)("option",{text:e,value:e},this.groupSelect);this.filter=this.plot.config.background_filter?this.plot.config.background_filter.category:null,this.groupSelect.addEventListener("change",(()=>{this._showOffsets(this.groupSelect.value)})),this._addOffsetLabels(),this._showOffsets(i[0])}_alterOffset(e){const t=this.plot.dataStore;let n=0,i=0;const r=parseFloat(this.offsetAm.value);if(isNaN(r))return;n+="right"===e?r:0,n-="left"===e?r:0,i+="up"===e?r:0,i-="down"===e?r:0;const o=this.groupSelect.value;t.setColumnOffset({group:o,offsets:[n,i],filter:this.filter},!0),this._showOffsets(o)}_addOffsetLabels(){const e=(0,A.ut)("div",{styles:{position:"absolute",top:"20px",left:"20px",display:"flex",justifyContent:"center",gap:"5px"}},this.bdiv);this.xoffset=(0,A.ut)("span",{},e),this.yoffset=(0,A.ut)("span",{},e),(0,A.ut)("span",{text:"step:"},e),this.offsetAm=(0,A.ut)("input",{styles:{width:"30px"},value:1},e);const t=(0,A.ut)("div",{styles:{position:"absolute",top:"0px",justifyContent:"center",left:"25px",display:"flex",gap:"5px"}},this.rDiv);this.angle=(0,A.ut)("span",{},t),(0,A.ut)("span",{text:"step:"},t),this.offsetAn=(0,A.ut)("input",{styles:{width:"30px"},value:1},t)}_showOffsets(e){let t=[0,0],n=0;const i=this.ds.offsets.values[this.filter||"all"];i&&i[e]&&(t=i[e].offsets,n=i[e].rotation),this.xoffset.textContent="x:"+t[0].toFixed(1),this.yoffset.textContent="y:"+t[1].toFixed(1),this.angle.textContent="angle:"+n.toFixed(1)}_addPButton(e){const t={position:"absolute",textAlign:"center",cursor:"pointer"};t[e[0]]="0px",(0,A.ut)("i",{classes:["fas",`fa-arrow-${e[1]}`],styles:t},this.bdiv).addEventListener("click",(()=>{this._alterOffset(e[1])}))}_addRButton(e){const t={position:"absolute",textAlign:"center"};t[e]="5px",(0,A.ut)("i",{classes:["fas",`fa-angle-double-${e}`],styles:t,cursor:"pointer"},this.rDiv).addEventListener("click",(t=>{const n=parseFloat(this.offsetAn.value);if(isNaN(n))return;const i="left"===e?-n:n;this.plot.dataStore.setColumnOffset({group:this.groupSelect.value,rotation:i,filter:this.filter},!0),this._showOffsets(this.groupSelect.value)}))}}class er extends Qi{constructor(e,t,n){const i=e.getColumnName(n.param[0]),r=e.getColumnName(n.param[1]);n.axis||(n.axis={x:{size:30,label:i,textsize:13},y:{size:45,label:r,textsize:13}}),n.title||(n.title=i+" x "+r),super(e,t,n,{x:{},y:{}}),this.x=this.config.param[0],this.y=this.config.param[1],this.dim=this.getDimension();const o=n.background_filter;o&&this.dim.setBackgroundFilter(o.column,o.category),this.minMaxX=this.dataStore.getMinMaxForColumn(this.x),this.minMaxY=this.dataStore.getMinMaxForColumn(this.y),this.type="wgl_scatter_plot";let a=this;const s=this.config;s.brush=s.brush||"poly";let l={brush:s.brush};this.app=new Yi(this.graphDiv,l),this.app.addHandler("zoom_stopped",(e=>this.handlePanZoom(e))),this.app.addHandler("panning_stopped",(e=>this.handlePanZoom(e))),this.centerGraph();const c=this.afterAppCreation();this.app.setBackGroundColor(s.background_color),this.app.addHandler("brush_stopped",(function(e,t){a.resetButton.style.display="inline",a.app.setFilter(!0),t?a._createPolyFilter(e):a._createFilter(e)})),s.background_image&&(s.image_opacity=null==s.image_opacity?1:s.image_opacity,this.addBackgroundImage(s.background_image));let h=this.dataStore.columnIndex[this.x],u=this.dataStore.columnIndex[this.y];this.app.addCircles({x:"int32"===h.datatype?new Float32Array(h.data):h.data,y:"int32"===u.datatype?new Float32Array(u.data):u.data,localFilter:this.dim.getLocalFilter(),globalFilter:this.dataStore.getFilter(),colorFunc:c}),this.defaultRadius=this._calculateRadius(),s.radius=s.radius||2,s.opacity=null==s.opacity?.8:s.opacity,this.app.setPointRadius(this.config.radius),this.app.setPointOpacity(this.config.opacity),this.onDataFiltered()}getDimension(){return this.dataStore.getDimension("range_dimension")}handlePanZoom(e){if(e.imageMoved){const t=e.imageMoved,n=this.config,i=n.background_image.name,r=n.image_choices.find((e=>e[0]===i));t.position[1]=-(t.position[1]+t.height),n.background_image.height=t.height,n.background_image.width=t.width,n.background_image.position=t.position,r[2]=t.width,r[3]=t.height,r[4]=t.position[0],r[5]=t.position[1]}else this._updateScale(e),this.updateAxis()}onDataAdded(e){const t=this.getSetupConfig();t.x=this.dataStore.getRawColumn(this.x),t.y=this.dataStore.getRawColumn(this.y),this.app.updateSize(e,t),super.onDataAdded(e)}addBackgroundImage(e,t=!1){const n=new Image,i=this.config;i.image_opacity=i.image_opacity||1,n.src=e.url,n.onload=()=>{t?this.app.changeImage(n,e,0):(this.app.addImage(n,e),this.app.changeImageOpacity(0,i.image_opacity)),this.app.refresh()}}linkToOtherChart(e){this.app.addHandler("pan_or_zoom",((t,n,i)=>{e.app.offset=[t[0],t[1]],e.app.x_scale=n,e.app.y_scale=i,e.app.refresh(),e._updateScale(this.app.getRange()),e.updateAxis()}),this.config.id)}highlightDataItem(e){this.app.highlightPoint(e)}getFilter(){if(!this.range||!0===this.range)return null;const e={};return e[this.config.param[0]]=[this.range.x_min,this.range.x_max],e[this.config.param[1]]=[this.range.y_min,this.range.y_max],e}_updateScale(e){this.x_scale.domain([e.x_range[0],e.x_range[1]]),this.y_scale.domain([-e.y_range[0],-e.y_range[1]])}_calculateRadius(){this.width&&this.width;let e=this.config.max_x||0==this.config.max_x?this.config.max_x:this.minMaxX[1],t=this.config.min_x||0==this.config.min_x?this.config.min_x:this.minMaxX[0];this.config.axis.x_log_scale&&(e=this._getLogValue(e),t=this._getLogValue(t));let n=e-t;return Math.pow(n,1.5)/(Math.pow(this.dataStore.size,.8)+n)*5}_createFilter(e){if(this.range=e,null==e)this.dim.removeFilter();else{let t=e.y_max,n=e.y_min,i=e.x_max,r=e.x_min;this.config.axis.y_log_scale&&(t=this._getInverseLogValue(t),n=this._getInverseLogValue(n)),this.config.axis.x_log_scale&&(i=this._getInverseLogValue(i),r=this._getInverseLogValue(r)),this.filter=[[r,i],[n,t]],this.dim.filter("filterSquare",this.config.param,{range1:this.filter[0],range2:this.filter[1]})}}_createPolyFilter(e){this.range=!0;for(let t of e)t[1]=-t[1],this.config.axis.x_log_scale&&(t[0]=this._getInverseLogValue(t[0])),this.config.axis.y_log_scale&&(t[1]=this._getInverseLogValue(t[1]));this.filter=e,this.dim.filter("filterPoly",this.config.param,e)}centerGraph(){const e=this.config,t=e.roi||{};let n=t.max_x||this.minMaxX[1],i=t.max_y||this.minMaxY[1],r=t.min_x||this.minMaxX[0],o=t.min_y||this.minMaxY[0];if(e.center_using_quantiles){const t=this.dataStore.columnIndex[e.param[0]].quantiles,n=this.dataStore.columnIndex[e.param[1]].quantiles;t[e.center_using_quantiles],n[e.center_using_quantiles]}this.config.axis.y_log_scale&&(i=this._getLogValue(i),o=this._getLogValue(o)),this.config.axis.x_log_scale&&(n=this._getLogValue(n),r=this._getLogValue(r));let a=(n-r)/20,s=(i-o)/20,l=n-r+2*a,c=i-o+2*s;const h=this._getContentDimensions();this.app.x_scale=h.width/l,this.app.y_scale=h.height/c,this.app.pointScale=(this.app.x_scale+this.app.y_scale)/2,this.app.offset[0]=-(r-a),this.app.offset[1]=i+s,this._updateScale(this.app.getRange()),this.updateAxis()}getContextMenu(){const e=super.getContextMenu(),t=this.config,n=this.dataStore;if(n.offsets){const i=n.offsets,r=n.getColumnName(i.groups);i.param[0]===t.param[0]&&i.param[1]===t.param[1]&&(i.background_filter&&i.background_filter!==t?.background_filter?.column||e.push({text:`Adjust ${r} position`,icon:"fas fa-arrows-alt",func:()=>{new Ji(this)}}))}return e}_addSliderToSettings(e,t,n){e.splice(1,0,{type:"slider",current_value:t.opacity,min:0,max:1,func:e=>{t.opacity=e,this.app.changeImageOpacity(n,e),this.app.refresh()}})}getConfig(){const e=super.getConfig();return e.offsets&&(e.offsets.offsets=this.app.offsets.values.offsets),e}getSettings(){const e=super.getSettings({pointMax:30,pointMin:0}),t=this.config;if(t.image_choices){const n=t.image_choices.slice(0);n.unshift(["None","__none__"]);let i="__none__";t.background_image&&(i=t.background_image.url),e.splice(1,0,{type:"dropdown",current_value:i,values:[n,0,1],label:"Change Image",func:e=>{if("__none__"===e)return delete t.background_image,this.app.removeImages(),void this.app.refresh();let n=!0;t.background_image||(t.background_image={},n=!1),t.background_image.url=e;let i=t.title.split("-")[0];const r=t.image_choices.find((t=>t[1]===e));t.background_image.name=r[0],r[2]&&(t.background_image.width=r[2],t.background_image.height=r[3],t.background_image.position=[r[4],r[5]]),this.setTitle(i+"-"+r[0]),this.addBackgroundImage(t.background_image,n)}})}return t.background_image&&e.splice(2,0,{label:"Image Opacity",type:"slider",current_value:t.image_opacity,max:1,min:0,func:e=>{t.image_opacity=e,this.app.changeImageOpacity(0,e),this.app.refresh()}}),e.push({type:"radiobuttons",label:"Background Color",choices:[["none","none"],["white","white"],["light gray","lightgray"],["gray","gray"],["black","black"]],current_value:t.background_color||"none",func:e=>{"none"===e?delete t.background_color:t.background_color=e,this.app.setBackGroundColor(t.background_color)}}),e.concat([{type:"radiobuttons",label:"Brush Type",choices:[["Free Draw","poly"],["Rectangle","default"]],current_value:t.brush,func:e=>{this.app.clearBrush(),this.app.config.brush=e,t.brush=e}}])}}I.types.wgl_scatter_plot={name:"2D Scatter Plot",class:er,params:[{type:"number",name:"X axis"},{type:"number",name:"Y axis"}]};const tr=er,nr=e=>e;function ir(e,t){e&&or.hasOwnProperty(e.type)&&or[e.type](e,t)}var rr={Feature:function(e,t){ir(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,i=-1,r=n.length;++i<r;)ir(n[i].geometry,t)}},or={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)e=n[i],t.point(e[0],e[1],e[2])},LineString:function(e,t){ar(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)ar(n[i],t,0)},Polygon:function(e,t){sr(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)sr(n[i],t)},GeometryCollection:function(e,t){for(var n=e.geometries,i=-1,r=n.length;++i<r;)ir(n[i],t)}};function ar(e,t,n){var i,r=-1,o=e.length-n;for(t.lineStart();++r<o;)i=e[r],t.point(i[0],i[1],i[2]);t.lineEnd()}function sr(e,t){var n=-1,i=e.length;for(t.polygonStart();++n<i;)ar(e[n],t,1);t.polygonEnd()}function lr(e,t){e&&rr.hasOwnProperty(e.type)?rr[e.type](e,t):ir(e,t)}class cr{constructor(){this._partials=new Float64Array(32),this._n=0}add(e){const t=this._partials;let n=0;for(let i=0;i<this._n&&i<32;i++){const r=t[i],o=e+r,a=Math.abs(e)<Math.abs(r)?e-(o-r):r-(o-e);a&&(t[n++]=a),e=o}return t[n]=e,this._n=n+1,this}valueOf(){const e=this._partials;let t,n,i,r=this._n,o=0;if(r>0){for(o=e[--r];r>0&&(t=o,n=e[--r],o=t+n,i=n-(o-t),!i););r>0&&(i<0&&e[r-1]<0||i>0&&e[r-1]>0)&&(n=2*i,t=o+n,n==t-o&&(o=t))}return o}}var hr=2*Math.PI,ur=Math.abs,fr=(Math.atan,Math.atan2,Math.cos,Math.ceil,Math.exp,Math.floor,Math.hypot,Math.log,Math.pow,Math.sin,Math.sign,Math.sqrt);function dr(){}Math.tan;var pr,gr,mr,_r,vr=new cr,br=new cr,yr={point:dr,lineStart:dr,lineEnd:dr,polygonStart:function(){yr.lineStart=wr,yr.lineEnd=kr},polygonEnd:function(){yr.lineStart=yr.lineEnd=yr.point=dr,vr.add(ur(br)),br=new cr},result:function(){var e=vr/2;return vr=new cr,e}};function wr(){yr.point=xr}function xr(e,t){yr.point=Cr,pr=mr=e,gr=_r=t}function Cr(e,t){br.add(_r*e-mr*t),mr=e,_r=t}function kr(){Cr(pr,gr)}const Sr=yr;var Er=1/0,Dr=Er,Ar=-Er,Mr=Ar,Rr={point:function(e,t){e<Er&&(Er=e),e>Ar&&(Ar=e),t<Dr&&(Dr=t),t>Mr&&(Mr=t)},lineStart:dr,lineEnd:dr,polygonStart:dr,polygonEnd:dr,result:function(){var e=[[Er,Dr],[Ar,Mr]];return Ar=Mr=-(Dr=Er=1/0),e}};const Lr=Rr;var Tr,Pr,zr,Ir,Or=0,Fr=0,Br=0,Nr=0,Hr=0,Ur=0,$r=0,jr=0,Wr=0,qr={point:Vr,lineStart:Kr,lineEnd:Xr,polygonStart:function(){qr.lineStart=Yr,qr.lineEnd=Qr},polygonEnd:function(){qr.point=Vr,qr.lineStart=Kr,qr.lineEnd=Xr},result:function(){var e=Wr?[$r/Wr,jr/Wr]:Ur?[Nr/Ur,Hr/Ur]:Br?[Or/Br,Fr/Br]:[NaN,NaN];return Or=Fr=Br=Nr=Hr=Ur=$r=jr=Wr=0,e}};function Vr(e,t){Or+=e,Fr+=t,++Br}function Kr(){qr.point=Gr}function Gr(e,t){qr.point=Zr,Vr(zr=e,Ir=t)}function Zr(e,t){var n=e-zr,i=t-Ir,r=fr(n*n+i*i);Nr+=r*(zr+e)/2,Hr+=r*(Ir+t)/2,Ur+=r,Vr(zr=e,Ir=t)}function Xr(){qr.point=Vr}function Yr(){qr.point=Jr}function Qr(){eo(Tr,Pr)}function Jr(e,t){qr.point=eo,Vr(Tr=zr=e,Pr=Ir=t)}function eo(e,t){var n=e-zr,i=t-Ir,r=fr(n*n+i*i);Nr+=r*(zr+e)/2,Hr+=r*(Ir+t)/2,Ur+=r,$r+=(r=Ir*e-zr*t)*(zr+e),jr+=r*(Ir+t),Wr+=3*r,Vr(zr=e,Ir=t)}const to=qr;function no(e){this._context=e}no.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:this._context.moveTo(e,t),this._point=1;break;case 1:this._context.lineTo(e,t);break;default:this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,hr)}},result:dr};var io,ro,oo,ao,so,lo=new cr,co={point:dr,lineStart:function(){co.point=ho},lineEnd:function(){io&&uo(ro,oo),co.point=dr},polygonStart:function(){io=!0},polygonEnd:function(){io=null},result:function(){var e=+lo;return lo=new cr,e}};function ho(e,t){co.point=uo,ro=ao=e,oo=so=t}function uo(e,t){ao-=e,so-=t,lo.add(fr(ao*ao+so*so)),ao=e,so=t}const fo=co;function po(){this._string=[]}function go(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}po.prototype={_radius:4.5,_circle:go(4.5),pointRadius:function(e){return(e=+e)!==this._radius&&(this._radius=e,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(e,t){switch(this._point){case 0:this._string.push("M",e,",",t),this._point=1;break;case 1:this._string.push("L",e,",",t);break;default:null==this._circle&&(this._circle=go(this._radius)),this._string.push("M",e,",",t,this._circle)}},result:function(){if(this._string.length){var e=this._string.join("");return this._string=[],e}return null}},__webpack_require__(8796);class mo extends tr{afterAppCreation(){this.contentDiv.prepend(this.app.div_container),this.svg.style("position","absolute").style("pointer-events","none");const e=this.config;e.contour_bandwidth=e.contour_bandwidth||5,e.contour_intensity=e.contour_intensity||.7,e.contour_opacity=e.contour_opacity||1;const t=e.param,n=this.dataStore.getMinMaxForColumn(t[0]),i=this.dataStore.getMinMaxForColumn(t[1]),r=n[1]-n[0],o=i[1]-i[0];return this.whRatio=r/o,this.catKeys=[-1,-1],this.data=[null,null],this.orig_y_scale=this.y_scale.domain(),this.orig_x_scale=this.x_scale.domain(),this.or_y_scale=[0,400/this.whRatio],this.or_x_scale=[0,400],this.app.addHandler("pan_or_zoom",((e,t,n)=>{this._updateScale(this.app.getRange()),this._rescaleSVG()}),e.id),super.afterAppCreation()}getDimension(){return this.dataStore.getDimension("density_dimension")}onDataFiltered(e){const t=this.config,n=t.param;super.onDataFiltered(e);const i=this.dataStore.getColumnValues(t.param[2]);if(this.catKeys=[i.indexOf(t.category1),i.indexOf(t.category2)],-1===this.catKeys[0]&&-1===this.catKeys[1])return void(this.data=[null,null]);const r={categories:this.catKeys,yscale:[this.orig_y_scale,this.or_y_scale],xscale:[this.orig_x_scale,this.or_x_scale],bandwidth:this.config.contour_bandwidth};this.dim.getDensityContours((e=>{this.data=e,this.drawChart(),this._rescaleSVG()}),n,r)}setSize(e,t){super.setSize(e,t),this._rescaleSVG()}_drawContours(e,t,n){const i=`dp-poly-${n}`,r=this.config;this.graph_area.selectAll("."+i).data(this.data[n]).join("path").attr("class",i).attr("stroke",r.contour_fill?"none":e).style("opacity",r.contour_opacity).attr("stroke-linejoin","round").attr("d",function(e,t){var n,i,r=4.5;function o(e){return e&&("function"==typeof r&&i.pointRadius(+r.apply(this,arguments)),lr(e,n(i))),i.result()}return o.area=function(e){return lr(e,n(Sr)),Sr.result()},o.measure=function(e){return lr(e,n(fo)),fo.result()},o.bounds=function(e){return lr(e,n(Lr)),Lr.result()},o.centroid=function(e){return lr(e,n(to)),to.result()},o.projection=function(t){return arguments.length?(n=null==t?(e=null,nr):(e=t).stream,o):e},o.context=function(e){return arguments.length?(i=null==e?(t=null,new po):new no(t=e),"function"!=typeof r&&i.pointRadius(r),o):t},o.pointRadius=function(e){return arguments.length?(r="function"==typeof e?e:(i.pointRadius(+e),+e),o):r},o.projection(e).context(t)}()).attr("fill",(e=>r.contour_fill?t(e.value):"none"))}removeCategory(e){delete this.config["category"+e],this.data[e-1]=null,this.catKeys[e-1]=-1,this.graph_area.selectAll(".dp-poly-"+(e-1)).remove()}changeContourParameter(e){this.config.param[2]=e,this.removeCategory(1),this.removeCategory(2),this.drawChart()}drawChart(e=400){const t=this.config;for(let e in this.catKeys){let n=this.catKeys[e];if(-1===n)this.graph_area.selectAll(`.dp-poly-${e}`).remove();else{let i=this.dataStore.getColumnColors(t.param[2])[n],r=(0,Z.Z)([0,1-t.contour_intensity],["white",i]);this._drawContours(i,r,e)}}}_rescaleSVG(){const e=this.x_scale.domain(),t=e[1]-e[0],n=this.x_scale.range()[1]/this.or_x_scale[1],i=(this.orig_x_scale[1]-this.orig_x_scale[0])/t*n,r=(0,Z.Z)().domain(e).range(this.or_x_scale),o=r(e[0])-r(this.orig_x_scale[0])*n,a=this.y_scale.domain(),s=a[0]-a[1],l=this.y_scale.range()[1]/this.or_y_scale[1],c=(this.orig_y_scale[0]-this.orig_y_scale[1])/s*l,h=(0,Z.Z)().domain(a).range(this.or_y_scale),u=h(a[0])-h(this.orig_y_scale[0])*l,f=this.margins.left,d=this.margins.top;this.graph_area.attr("transform",`translate(${f-o},${d-u}) scale(${i},${c})  `)}getSettings(){const e=super.getSettings(),t=this.config,n=this.dataStore.getColumnList("text");let i=this.dataStore.getColumnValues(t.param[2]);return i=i.map((e=>({t:e}))),i.push({t:"None"}),e.push({type:"dropdown",label:"Contour Parameter",current_value:this.dataStore.getColumnName(t.param[2]),values:[n,"name","field"],func:e=>{this.changeContourParameter(e)},onchange:(e,t)=>{const n=this.dataStore.getColumnValues(t).slice(0);n.push("None");for(let t of["Contour Category 1","Contour Category 2"]){e[t].innerHTML="";for(let i of n)(0,A.ut)("option",{text:i,value:i},e[t]);e[t].value="None"}}},{type:"dropdown",label:"Contour Category 1",current_value:t.category1||"None",values:[i,"t","t"],func:e=>{"None"===e?this.removeCategory(1):t.category1=e,this.onDataFiltered()}},{type:"dropdown",label:"Contour Category 2",current_value:t.category2||"None",values:[i,"t","t"],func:e=>{"None"===e?this.removeCategory(2):t.category2=e,this.onDataFiltered()}},{type:"slider",max:25,min:1,doc:this.__doc__,current_value:t.contour_bandwidth,label:"KDE Bandwidth",func:e=>{t.contour_bandwidth=e,this.onDataFiltered()}},{label:"Fill Contours",type:"check",current_value:t.contour_fill,func:e=>{t.contour_fill=e,this.drawChart()}},{type:"slider",max:1,min:0,doc:this.__doc__,current_value:t.contour_intensity,label:"Fill Intensity",func:e=>{t.contour_intensity=e,this.drawChart()}},{type:"slider",max:1,min:0,doc:this.__doc__,current_value:t.contour_opacity,label:"Contour opacity",func:e=>{t.contour_opacity=e,this.drawChart()}}),e}}I.types.density_scatter_plot={name:"Density Scatter Plot",class:mo,params:[{type:"number",name:"X axis"},{type:"number",name:"Y axis"},{type:"text",name:"Category Column"}]};const _o=mo;class vo extends M{constructor(e,t){super({width:500,title:"Channels",doc:t||document},e)}init(e){this.viv=e,this.mainDiv=(0,A.ut)("div",{},this.dialog);const t=this.viv.getChannels();for(let e of t)this.addSlider(e);const n=(0,A.ut)("div",{styles:{padding:"4px"}},this.dialog),i=(0,A.ut)("select",{},n),r=e.getAllChannels();for(let e=0;e<r.length;e++)(0,A.ut)("option",{text:r[e].Name??r[e].ID,value:e},i);const o=(0,A.ut)("input",{styles:{width:"25px",height:"20px",padding:"0px",margin:"0px 4px"},type:"color",value:"#ff0000"},n);(0,A.ut)("button",{classes:["ciview-button-sm"],text:"Add Channel"},n).addEventListener("click",(()=>{const e=this.viv.addChannel({index:parseInt(i.value),color:o.value});this.addSlider(e)}))}addSlider(e){const t=(0,A.ut)("div",{styles:{display:"flex",padding:"4px",alignItems:"center"}},this.mainDiv);(0,A.ut)("span",{text:e.name,classes:["mdv-flex-dynamic"],styles:{flexBasis:"30%"}},t);const n=(0,A.ut)("div",{classes:["mdv-flex-dynamic"],styles:{padding:"0px 10px",flexBasis:"70%",overflow:"visible"}},t),i=e.domains;L().create(n,{start:[e.contrastLimits[0],e.contrastLimits[1]],range:{min:i?i[0]:0,max:i?i[1]:300},step:1,document:this.config.doc,tooltips:!0},t),n.noUiSlider.on("update",(t=>{e.contrastLimits=[parseFloat(t[0]),parseFloat(t[1])],this.viv.setChannel(e)}));const r=(0,A.ut)("input",{classes:["mdv-flex-fixed"],styles:{width:"25px",height:"20px",padding:"0px"},type:"color",value:e.color},t);r.addEventListener("input",(()=>{e.color=r.value,this.viv.setChannel(e)}));const o=(0,A.ut)("input",{classes:["mdv-flex-fixed","mdv-checkbox"],type:"checkbox"},t);o.checked=e.channelsVisible,o.addEventListener("click",(()=>{e.channelsVisible=o.checked,this.viv.setChannel(e)})),(0,A.ut)("i",{classes:["mdv-flex-fixed","fas","fa-times"],styles:{width:"16px",margin:"0px 3px",cursor:"pointer"}},t).addEventListener("click",(()=>{this.viv.removeChannel(e),t.remove()}))}}I.types.viv_scatter_plot={name:"Viv Scatter Plot",allow_user_add:!1,class:class extends _o{constructor(e,t,n){const i=e.getColumnName(n.param[0]),r=e.getColumnName(n.param[1]);n.axis||(n.axis={x:{size:30,label:i,textsize:13},y:{size:45,label:r,textsize:13}}),super(e,t,n,{x:{},y:{}}),n.viv&&this.addMenuIcon("fas fa-palette","Alter Channels").addEventListener("click",(e=>new vo(this.viv,this.__doc__)))}setSize(e,t){if(super.setSize(e,t),this.viv){const e=this._getContentDimensions();this.viv.setSize(e.width,e.height,this.app)}}remove(){this.viv.deck.finalize(),super.remove()}centerGraph(){super.centerGraph(),this.viv&&this.viv.setPanZoom(this.app.offset,this.app.x_scale,this.app.y_scale)}getConfig(){const e=super.getConfig(),t=this.viv.layers[0].props;return e.viv.image_properties={selections:t.selections.slice(0),colors:t.colors.slice(0),channelsVisible:t.channelsVisible.slice(0),contrastLimits:t.contrastLimits.slice(0),domains:t.domains?.slice(0)},e}afterAppCreation(){const e=this.config;if(e.viv||(e.viv={url:"https://viv-demo.storage.googleapis.com/LuCa-7color_3x3component_data.ome.tif",image_properties:{contrastLimits:[[0,255]],colors:[[255,255,255]],channelsVisible:[!0],selections:[{c:0,t:0,z:0}]}}),e.viv){const t=this._getContentDimensions();this.vivCanvas=(0,A.ut)("canvas",{height:t.height,width:t.width,styles:{position:"absolute"}}),this.graphDiv.prepend(this.vivCanvas),Promise.all([__webpack_require__.e(316),__webpack_require__.e(867)]).then(__webpack_require__.bind(__webpack_require__,2806)).then((({default:t})=>{this.viv=new t(this.vivCanvas,e.viv,this.app),this.app.addHandler("pan_or_zoom",((e,t,n)=>{this.viv.setPanZoom(e,t,n)}),e.id+"_viv")}))}return super.afterAppCreation()}},params:[{type:"number",name:"X axis"},{type:"number",name:"Y axis"},{type:"text",name:"Category Column"}]};var bo=__webpack_require__(7636);const yo={"blue yellow":["#115f9a","#1984c5","#22a7f0","#48b5c4","#76c68f","#a6d75b","#c9e52f","#d0ee11","#d0f400"],red:ji[8].slice(1),"blue yellow red":["blue","yellow","red"]};function wo(e,t){let n=(e-90)/180*Math.PI,i=t;return[i*Math.cos(n),i*Math.sin(n)]}I.types.cell_network_chart={name:"Cell Network Chart",allow_user_add:!1,methodsUsingColumns:["changeLinkThicknessParameter","changeLinkLengthParameter","changeLinkColorParameter"],class:class extends Mt{constructor(e,t,n){n.title||(n.title=n.category),n.link_strength=n.link_strength||1,n.node_repulsion=n.node_repulsion||-500,super(e,t,n,{});const i=this.config;if(this.linkThicknessScale=(0,Z.Z)(),i.scales={},i.link_thickness)this._changeLinkThicknessScale();else{i.link_thickness={show_legend:!0,legend_position:[20,80]};const e=this.dataStore.getColumnQuantile(i.param[4],.01);this._changeLinkThicknessScale(e,[1,10])}if(this.linkLengthScale=(0,Z.Z)(),this.forceLink=function(e){var t,n,i,r,o,a,s=ti,l=function(e){return 1/Math.min(r[e.source.index],r[e.target.index])},c=Jn(30),h=1;function u(i){for(var r=0,s=e.length;r<h;++r)for(var l,c,u,f,d,p,g,m=0;m<s;++m)c=(l=e[m]).source,f=(u=l.target).x+u.vx-c.x-c.vx||ei(a),d=u.y+u.vy-c.y-c.vy||ei(a),f*=p=((p=Math.sqrt(f*f+d*d))-n[m])/p*i*t[m],d*=p,u.vx-=f*(g=o[m]),u.vy-=d*g,c.vx+=f*(g=1-g),c.vy+=d*g}function f(){if(i){var a,l,c=i.length,h=e.length,u=new Map(i.map(((e,t)=>[s(e,t,i),e])));for(a=0,r=new Array(c);a<h;++a)(l=e[a]).index=a,"object"!=typeof l.source&&(l.source=ni(u,l.source)),"object"!=typeof l.target&&(l.target=ni(u,l.target)),r[l.source.index]=(r[l.source.index]||0)+1,r[l.target.index]=(r[l.target.index]||0)+1;for(a=0,o=new Array(h);a<h;++a)l=e[a],o[a]=r[l.source.index]/(r[l.source.index]+r[l.target.index]);t=new Array(h),d(),n=new Array(h),p()}}function d(){if(i)for(var n=0,r=e.length;n<r;++n)t[n]=+l(e[n],n,e)}function p(){if(i)for(var t=0,r=e.length;t<r;++t)n[t]=+c(e[t],t,e)}return null==e&&(e=[]),u.initialize=function(e,t){i=e,a=t,f()},u.links=function(t){return arguments.length?(e=t,f(),u):e},u.id=function(e){return arguments.length?(s=e,u):s},u.iterations=function(e){return arguments.length?(h=+e,u):h},u.strength=function(e){return arguments.length?(l="function"==typeof e?e:Jn(+e),d(),u):l},u.distance=function(e){return arguments.length?(c="function"==typeof e?e:Jn(+e),p(),u):c},u}().id((function(e){return e.id})),i.link_length)this._changeLinkLengthScale();else{i.link_length={};const e=this.dataStore.getColumnQuantile(i.param[3],.01);this._changeLinkLengthScale(e,[1,100])}if(this.nodeScale=$i(),i.node_size)this._changeNodeSizeScale();else{i.node_size={show_legend:!0,legend_position:[20,180]};const e=this.dataStore.getMinMaxForColumn(i.param[6]);this._changeNodeSizeScale(e,[1,15])}if(i.link_color)this._changeLinkColorScale();else{i.link_color={};const e=this.dataStore.getColumnQuantile(i.param[5],.01);this._changeLinkColorScale("red",e)}i.color_legend||(i.color_legend={display:!0}),i.node_color=i.node_color||"cells",i.levels=i.levels||1,i.label_size=i.label_size||13,this.extra_legends=["linkThicknessLegend","nodeColorLegend"],this.forceManyBody=function(){var e,t,n,i,r,o=Jn(-30),a=1,s=1/0,l=.81;function c(n){var r,o=e.length,a=si(e,fi,di).visitAfter(u);for(i=n,r=0;r<o;++r)t=e[r],a.visit(f)}function h(){if(e){var t,n,i=e.length;for(r=new Array(i),t=0;t<i;++t)n=e[t],r[n.index]=+o(n,t,e)}}function u(e){var t,n,i,o,a,s=0,l=0;if(e.length){for(i=o=a=0;a<4;++a)(t=e[a])&&(n=Math.abs(t.value))&&(s+=t.value,l+=n,i+=n*t.x,o+=n*t.y);e.x=i/l,e.y=o/l}else{(t=e).x=t.data.x,t.y=t.data.y;do{s+=r[t.data.index]}while(t=t.next)}e.value=s}function f(e,o,c,h){if(!e.value)return!0;var u=e.x-t.x,f=e.y-t.y,d=h-o,p=u*u+f*f;if(d*d/l<p)return p<s&&(0===u&&(p+=(u=ei(n))*u),0===f&&(p+=(f=ei(n))*f),p<a&&(p=Math.sqrt(a*p)),t.vx+=u*e.value*i/p,t.vy+=f*e.value*i/p),!0;if(!(e.length||p>=s)){(e.data!==t||e.next)&&(0===u&&(p+=(u=ei(n))*u),0===f&&(p+=(f=ei(n))*f),p<a&&(p=Math.sqrt(a*p)));do{e.data!==t&&(d=r[e.data.index]*i/p,t.vx+=u*d,t.vy+=f*d)}while(e=e.next)}}return c.initialize=function(t,i){e=t,n=i,h()},c.strength=function(e){return arguments.length?(o="function"==typeof e?e:Jn(+e),h(),c):o},c.distanceMin=function(e){return arguments.length?(a=e*e,c):Math.sqrt(a)},c.distanceMax=function(e){return arguments.length?(s=e*e,c):Math.sqrt(s)},c.theta=function(e){return arguments.length?(l=e*e,c):Math.sqrt(l)},c}().distanceMax(150),this.simulation=function(e){var t,n=1,i=.001,r=1-Math.pow(i,1/300),o=0,a=.6,s=new Map,l=_e(u),c=ie("tick","end"),h=function(){let e=1;return()=>(e=(1664525*e+1013904223)%ui)/ui}();function u(){f(),c.call("tick",t),n<i&&(l.stop(),c.call("end",t))}function f(i){var l,c,h=e.length;void 0===i&&(i=1);for(var u=0;u<i;++u)for(n+=(o-n)*r,s.forEach((function(e){e(n)})),l=0;l<h;++l)null==(c=e[l]).fx?c.x+=c.vx*=a:(c.x=c.fx,c.vx=0),null==c.fy?c.y+=c.vy*=a:(c.y=c.fy,c.vy=0);return t}function d(){for(var t,n=0,i=e.length;n<i;++n){if((t=e[n]).index=n,null!=t.fx&&(t.x=t.fx),null!=t.fy&&(t.y=t.fy),isNaN(t.x)||isNaN(t.y)){var r=10*Math.sqrt(.5+n),o=n*pi;t.x=r*Math.cos(o),t.y=r*Math.sin(o)}(isNaN(t.vx)||isNaN(t.vy))&&(t.vx=t.vy=0)}}function p(t){return t.initialize&&t.initialize(e,h),t}return null==e&&(e=[]),d(),t={tick:f,restart:function(){return l.restart(u),t},stop:function(){return l.stop(),t},nodes:function(n){return arguments.length?(e=n,d(),s.forEach(p),t):e},alpha:function(e){return arguments.length?(n=+e,t):n},alphaMin:function(e){return arguments.length?(i=+e,t):i},alphaDecay:function(e){return arguments.length?(r=+e,t):+r},alphaTarget:function(e){return arguments.length?(o=+e,t):o},velocityDecay:function(e){return arguments.length?(a=1-e,t):1-a},randomSource:function(e){return arguments.length?(h=e,s.forEach(p),t):h},force:function(e,n){return arguments.length>1?(null==n?s.delete(e):s.set(e,p(n)),t):s.get(e)},find:function(t,n,i){var r,o,a,s,l,c=0,h=e.length;for(null==i?i=1/0:i*=i,c=0;c<h;++c)(a=(r=t-(s=e[c]).x)*r+(o=n-s.y)*o)<i&&(l=s,i=a);return l},on:function(e,n){return arguments.length>1?(c.on(e,n),t):c.on(e)}}}().force("link",this.forceLink.strength(this.config.link_strength)).force("charge",this.forceManyBody.strength(n.node_repulsion)).force("center",Qn(this.width/2,this.height/2)),this.config.base_cell?this.getLinks2():this.getLinks(),this.setColorLegend(),this.reCalculate()}remove(){this.simulation.on("tick",null),super.remove()}drawChart(){const e=this,t=this.config;this.svg.selectAll("*").remove();const n=this.dataStore.getColumnColors(t.param[1]),i=this.dataStore.getColorForCategory(t.param[0],t.category),r=this.dataStore.getRawColumn(t.param[4]),o=this.svg.append("g").attr("class","links").selectAll("line").data(this.linkData).enter();this.link=o.append("line").attr("stroke-width",(t=>e.linkThicknessScale(r[t.d_index]))).style("stroke",(t=>e.linkColorScale?e.linkColorScale(t.d_index):"currentcolor")).style("opacity",.6).on("click",((t,n)=>{e.dataStore.dataHighlighted([n.d_index],e)})),this.arrows=o.append("path").attr("stroke-width",3).attr("fill","none").style("opacity",t.show_directionality?1:0).attr("stroke",(t=>e.linkColorScale?e.linkColorScale(t.d_index):"currentcolor")),this.node=this.svg.append("g").attr("class","nodes").selectAll("g").data(this.nodeData).enter().append("g"),this.circles=this.node.append("circle").attr("r",(t=>e.nodeScale(t.node_size))).attr("fill",(function(e){return"cells"===t.node_color?n[e.d_index]:i})).call(this.setUpDrag()),this.lables=this.node.append("text").text((function(e){return e.id})).style("fill","currentcolor").style("font-size",`${e.config.label_size}px`).attr("x",6).attr("y",3),this.simulation.nodes(this.nodeData).on("tick",(()=>e.ticked())),this.simulation.force("link").links(this.linkData)}_changeLabelSize(e){this.config.label_size=e,this.lables.style("font-size",`${e}px`)}_changeNodeSizeScale(e,t,n){const i=this.config;t&&(i.node_size.range=t),e&&(i.node_size.domain=e);const r=this;this.nodeScale=$i().domain(i.node_size.domain).range(i.node_size.range).clamp(!0);const o=this.nodeColorLegend;if(o&&(i.node_size.legend_position=[o.offsetLeft,o.offsetTop],o.remove()),!i.node_size.show_legend)return void delete this.nodeColorLegend;const a=this.dataStore.columnIndex[i.param[6]].name;let s=i.node_size.legend_position;this.nodeColorLegend=(0,bo.JW)(this.nodeScale,{label:a,type:"circle"}),this.contentDiv.append(this.nodeColorLegend),this.nodeColorLegend.style.top=s[1]+"px",this.nodeColorLegend.style.left=s[0]+"px",n&&this.circles.attr("r",(e=>r.nodeScale(e.node_size)))}changeLinkThicknessParameter(e,t){this._changeLinkThicknessScale(t,null,!0)}changeLinkLengthParameter(e,t){this._changeLinkLengthScale(t,null,!0)}changeLinkColorParameter(e,t){this._changeLinkColorScale(null,[t[0],t[1]],!0)}_changeLinkThicknessScale(e,t,n){const i=this.config;if(t&&(i.link_thickness.range=t),e&&(i.link_thickness.domain=e),this.linkThicknessScale.domain(i.link_thickness.domain).range(i.link_thickness.range).clamp(!0),n){const e=this,t=this.dataStore.getRawColumn(i.param[4]);this.link.attr("stroke-width",(n=>e.linkThicknessScale(t[n.d_index])))}const r=this.linkThicknessLegend;if(r&&(i.link_thickness.legend_position=[r.offsetLeft,r.offsetTop],r.remove()),!i.link_thickness.show_legend)return void delete this.linkThicknessLegend;let o=i.link_thickness.legend_position;const a=this.dataStore.columnIndex[i.param[4]].name;this.linkThicknessLegend=(0,bo.JW)(this.linkThicknessScale,{label:a,type:"line"}),this.contentDiv.append(this.linkThicknessLegend),this.linkThicknessLegend.style.top=o[1]+"px",this.linkThicknessLegend.style.left=o[0]+"px"}_changeLinkLengthScale(e,t,n){const i=this.config,r=this;t&&(i.link_length.range=t),e&&(i.link_length.domain=e);const o=[i.link_length.range[0],i.link_length.range[1]];this.linkLengthScale.domain([...i.link_length.domain].reverse()).range(o).clamp(!0);const a=this.dataStore.getRawColumn(i.param[3]),s=this.linkLengthScale.range()[1];this.forceLink.distance((e=>{const t=a[e.d_index];return isNaN(t)?s:r.linkLengthScale(t)})),n&&(this.simulation.alphaTarget(.2).restart(),setTimeout((()=>{this.simulation.alphaTarget(0)}),1e3))}_changeNodeColor(e){const t=this.config;t.node_color=e;const n=this.dataStore.getColumnColors(t.param[1]),i=this.dataStore.getColorForCategory(t.param[0],t.category);this.circles.attr("fill",(function(e){return"cells"===t.node_color?n[e.d_index]:i}))}getConfig(){const e=super.getConfig(),t=this.linkThicknessLegend;t&&(e.link_thickness.legend_position=[t.offsetLeft,t.offsetTop]);const n=this.nodeColorLegend;return n&&(e.node_size.legend_position=[n.offsetLeft,n.offsetTop]),e}_changeLinkColorScale(e,t,n){t&&(this.config.link_color.domain=t),e&&(this.config.link_color.colors=e);const i=this.config.link_color.domain;this.linkColorScale=this.dataStore.getColorFunction(this.config.param[5],{overideValues:{min:i[0],max:i[1],colors:yo[this.config.link_color.colors]}});const r=this;n&&(this.link.style("stroke",(e=>r.linkColorScale?r.linkColorScale(e.d_index):"black")),this.setColorLegend(),this.arrows.attr("stroke",(e=>r.linkColorScale?r.linkColorScale(e.d_index):"black")))}onDataFiltered(e){this.reCalculate()}getColorLegend(){const e=this.config,t=e.link_color.domain;return this.dataStore.getColorLegend(e.param[5],{overideValues:{min:t[0],max:t[1],colors:yo[e.link_color.colors]}})}colorByDefault(){delete this.config.color_by,this.legend&&this.legend.remove(),this.linkColorScale=null,this._changeLinkColor()}ticked(){const e=this;this.lables.attr("text-anchor",(e=>e.x>2*this.width/3?"end":"start")).attr("x",(e=>e.x>2*this.width/3?-6:6)),this.node.attr("transform",(function(t){return t.x=Math.min(t.x,e.width-20),t.x=Math.max(t.x,15),t.y=Math.min(t.y,e.height-20),t.y=Math.max(t.y,15),"translate("+t.x+","+t.y+")"})),this.link.attr("x1",(function(e){return e.source.x})).attr("y1",(function(e){return e.source.y})).attr("x2",(function(e){return e.target.x})).attr("y2",(function(e){return e.target.y})),this.arrows.attr("d",(e=>{let t=Math.sqrt(Math.pow(e.source.y-e.target.y,2)+Math.pow(e.target.x-e.source.x,2));t=0===t?.1:t;const n=(t/2-5)/t,i=(e.target.x-e.source.x)/2+e.source.x,r=(e.target.y-e.source.y)/2+e.source.y,o=(e.target.x-e.source.x)*n+e.source.x,a=(e.target.y-e.source.y)*n+e.source.y,s=5/t*(e.source.y-e.target.y),l=o+s,c=o-s,h=5/t*(e.target.x-e.source.x);return`M ${l} ${a+h} ${i} ${r} ${c} ${a-h}`}))}setUpDrag(){const e=this;return function(){var e,t,n,i,r=Gn,o=Zn,a=Xn,s=Yn,l={},c=ie("start","drag","end"),h=0,u=0;function f(e){e.on("mousedown.drag",d).filter(s).on("touchstart.drag",m).on("touchmove.drag",_,fn).on("touchend.drag touchcancel.drag",v).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function d(a,s){if(!i&&r.call(this,a,s)){var l=b(this,o.call(this,a,s),a,s,"mouse");l&&((0,O.Z)(a.view).on("mousemove.drag",p,dn).on("mouseup.drag",g,dn),mn(a.view),pn(a),n=!1,e=a.clientX,t=a.clientY,l("start",a))}}function p(i){if(gn(i),!n){var r=i.clientX-e,o=i.clientY-t;n=r*r+o*o>u}l.mouse("drag",i)}function g(e){(0,O.Z)(e.view).on("mousemove.drag mouseup.drag",null),_n(e.view,n),gn(e),l.mouse("end",e)}function m(e,t){if(r.call(this,e,t)){var n,i,a=e.changedTouches,s=o.call(this,e,t),l=a.length;for(n=0;n<l;++n)(i=b(this,s,e,t,a[n].identifier,a[n]))&&(pn(e),i("start",e,a[n]))}}function _(e){var t,n,i=e.changedTouches,r=i.length;for(t=0;t<r;++t)(n=l[i[t].identifier])&&(gn(e),n("drag",e,i[t]))}function v(e){var t,n,r=e.changedTouches,o=r.length;for(i&&clearTimeout(i),i=setTimeout((function(){i=null}),500),t=0;t<o;++t)(n=l[r[t].identifier])&&(pn(e),n("end",e,r[t]))}function b(e,t,n,i,r,o){var s,u,d,p=c.copy(),g=bn(o||n,t);if(null!=(d=a.call(e,new Kn("beforestart",{sourceEvent:n,target:f,identifier:r,active:h,x:g[0],y:g[1],dx:0,dy:0,dispatch:p}),i)))return s=d.x-g[0]||0,u=d.y-g[1]||0,function n(o,a,c){var m,_=g;switch(o){case"start":l[r]=n,m=h++;break;case"end":delete l[r],--h;case"drag":g=bn(c||a,t),m=h}p.call(o,e,new Kn(o,{sourceEvent:a,subject:d,target:f,identifier:r,active:m,x:g[0]+s,y:g[1]+u,dx:g[0]-_[0],dy:g[1]-_[1],dispatch:p}),i)}}return f.filter=function(e){return arguments.length?(r="function"==typeof e?e:Vn(!!e),f):r},f.container=function(e){return arguments.length?(o="function"==typeof e?e:Vn(e),f):o},f.subject=function(e){return arguments.length?(a="function"==typeof e?e:Vn(e),f):a},f.touchable=function(e){return arguments.length?(s="function"==typeof e?e:Vn(!!e),f):s},f.on=function(){var e=c.on.apply(c,arguments);return e===c?f:e},f.clickDistance=function(e){return arguments.length?(u=(e=+e)*e,f):Math.sqrt(u)},f}().on("start",(function(t){t.active||e.simulation.alphaTarget(.3).restart(),t.subject.fx=t.subject.x,t.subject.fy=t.subject.y})).on("drag",(function(e){e.subject.fx=e.x,e.subject.fy=e.y})).on("end",(function(t){t.active||e.simulation.alphaTarget(0),t.subject.fx=null,t.subject.fy=null}))}reCalculate(){this.config.base_cell?this.getLinks2():this.getLinks(),this.drawChart(),this.simulation.alphaTarget(.2).restart(),setTimeout((()=>{this.simulation.alphaTarget(0)}),1e3)}changeParameter(){const e=this.config;this.forceLink.strength(e.link_strength),this.forceManyBody.strength(e.node_repulsion),this.simulation.alphaTarget(.2).restart(),setTimeout((()=>{this.simulation.alphaTarget(0)}),1e3)}getLinks2(){const e=this.config.param,t=this.dataStore.getColumnValues(e[1]),n=this.dataStore.getColumnValues(e[2]),i=this.dataStore.getColumnValues(e[0]).indexOf(this.config.category),r=this.dataStore.columnIndex,o=r[e[0]].data,a=r[e[1]].data,s=r[e[2]].data,l=r[e[6]].data;this.nodeData=[];let c=new Set;const h=t.indexOf(this.config.base_cell);c.add(h);const u=new Set;let f=new Set;const d=this.config.specific_only;if(d)f=new Set(d[0].map((e=>t.indexOf(e))));else for(let e=0;e<t.length;e++)f.add(e);const p=this.dataStore.filterArray;for(let e=0;e<this.dataStore.size;e++)p[e]>0||o[e]===i&&a[e]==h&&f.has(s[e])&&a[e]!==s[e]&&(u.add(`${a[e]}|${s[e]}`),c.add(s[e]));let g=new Set(c);if(2==this.config.levels)for(let e=0;e<this.dataStore.size;e++)if(!(p[e]>0)&&o[e]===i&&c.has(a[e])&&f.has(s[e])&&a[e]!==s[e]){if(s[e]===h)continue;u.has(`${s[e]}|${a[e]}`)||(u.add(`${a[e]}|${s[e]}`),g.add(s[e]))}for(let e=0;e<t.length;e++)for(let t=0;t<n.length;t++)(!g||g.has(e)&&g.has(t))&&u.add(`${e}|${t}`);this.linkData=[];const m={};for(let e=0;e<this.dataStore.size;e++){if(p[e]>0)continue;m[t[a[e]]]=l[e];const r=`${a[e]}|${s[e]}`;o[e]===i&&u.has(r)&&(u.delete(`${s[e]}|${a[e]}`),this.linkData.push({source:t[a[e]],target:n[s[e]],d_index:e}))}for(let e=0;e<t.length;e++)g&&!g.has(e)||this.nodeData.push({id:t[e],d_index:e,node_size:m[t[e]]})}getLinks(){const e=this.config.param,t=this.dataStore.getColumnValues(e[1]),n=this.dataStore.getColumnValues(e[2]);this.nodeData=[];let i=null;const r=this.config.specific_only;r&&(i=new Set(r[0].map((e=>t.indexOf(e)))));const o=new Set;for(let e=0;e<t.length;e++)for(let t=e+1;t<n.length;t++)(!i||i.has(e)&&i.has(t))&&o.add(`${e}|${t}`);const a=this.dataStore.getColumnValues(e[0]).indexOf(this.config.category),s=this.dataStore.columnIndex,l=s[e[0]].data,c=s[e[1]].data,h=s[e[2]].data,u=s[e[6]].data;this.linkData=[];const f={},d=this.dataStore.filterArray;for(let e=0;e<this.dataStore.size;e++){if(d[e]>0)continue;f[t[c[e]]]=u[e];const i=`${c[e]}|${h[e]}`;l[e]===a&&o.has(i)&&this.linkData.push({source:t[c[e]],target:n[h[e]],d_index:e})}for(let e=0;e<t.length;e++)i&&!i.has(e)||this.nodeData.push({id:t[e],d_index:e,node_size:f[t[e]]})}setSize(e,t){super.setSize(e,t),this.simulation.force("center",Qn(this.width/2,this.height/2)),this._changeLinkLengthScale(null,null,!0)}getSettings(){const e=super.getSettings(),t=this.config,n=this.dataStore.getColumnValues(t.param[0]),i=this.dataStore.getColumnValues(t.param[1]).map((e=>({t:e})));i.unshift({t:"None"}),n.map((e=>({t:e,v:e}))),e.push({type:"slider",max:20,min:5,doc:this.__doc__,current_value:t.label_size,label:"Label Size",func:e=>{this._changeLabelSize(e)}}),e.push({type:"dropdown",current_value:t.base_cell||"None",values:[i,"t","t"],label:"Center Cell",func:e=>{"None"===e?delete t.base_cell:t.base_cell=e,this.reCalculate()}}),e.push({type:"radiobuttons",label:"Number of Levels",current_value:t.levels,choices:[["1",1],["2",2]],func:e=>{t.levels=parseInt(e),t.base_cell&&this.reCalculate()}});const r=this.dataStore.getColumnList("number");let o=this.dataStore.getColumnQuantile(t.param[5],.01);e.push({label:"Link Color",type:"dropdown",values:[r,"name","field"],current_value:t.param[5],func:e=>{t.param[5]=e},onchange:(e,n)=>{t.param[5]=n;const i=e["Link Color Domain"].noUiSlider,r=this.dataStore.getColumnQuantile(n,.01);i.updateOptions({range:{max:r[1],min:r[0]}}),i.set(r),this.changeLinkColorParameter(n,r)}});const a=[];for(let e in yo)a.push([e,e]);return e.push({type:"radiobuttons",label:"Link Color",current_value:t.link_color.colors,choices:a,func:e=>{this._changeLinkColorScale(e,null,!0)}}),e.push({type:"doubleslider",max:o[1],min:o[0],doc:this.__doc__,current_value:this.config.link_color.domain,label:"Link Color Domain",func:(e,t)=>{this._changeLinkColorScale(null,[e,t],!0)}}),o=this.dataStore.getColumnQuantile(t.param[4],.01),e.push({label:"Link Thickness",type:"dropdown",values:[r,"name","field"],current_value:t.param[4],func:e=>{t.param[4]=e},onchange:(e,n)=>{t.param[4]=n;const i=e["Link Thickness Domain"].noUiSlider,r=this.dataStore.getColumnQuantile(n,.01);i.updateOptions({range:{max:r[1],min:r[0]}}),i.set(r),this.changeLinkThicknessParameter(n,r)}}),e.push({type:"doubleslider",max:20,min:1,doc:this.__doc__,current_value:this.config.link_thickness.range,label:"Link Thickness Range",func:(e,t)=>{this._changeLinkThicknessScale(null,[e,t],!0)}}),e.push({type:"doubleslider",max:o[1],min:o[0],doc:this.__doc__,current_value:this.config.link_thickness.domain,label:"Link Thickness Domain",func:(e,t)=>{this._changeLinkThicknessScale([e,t],null,!0)}}),e.push({type:"check",current_value:t.link_thickness.show_legend,label:"Show Link Thickness Legend",func:e=>{t.link_thickness.show_legend=e,this._changeLinkThicknessScale()}}),o=this.dataStore.getColumnQuantile(t.param[3],.01),e.push({label:"Link Length",type:"dropdown",values:[r,"name","field"],current_value:t.param[3],func:e=>{t.param[3]=e},onchange:(e,n)=>{t.param[3]=n;const i=e["Link Length Domain"].noUiSlider,r=this.dataStore.getColumnQuantile(n,.01);i.updateOptions({range:{max:r[1],min:r[0]}}),i.set(r),this.changeLinkLengthParameter(n,r)}}),e.push({type:"doubleslider",max:200,min:1,doc:this.__doc__,current_value:this.config.link_length.range,label:"Link Length Range",func:(e,t)=>{this._changeLinkLengthScale(null,[e,t],!0)}}),e.push({type:"doubleslider",max:o[1],min:o[0],doc:this.__doc__,current_value:this.config.link_length.domain,label:"Link Length Domain",func:(e,t)=>{this._changeLinkLengthScale([e,t],null,!0)}}),e.push({type:"check",current_value:t.show_directionality,label:"Show Directionality",func:e=>{t.show_directionality=e,this.arrows.style("opacity",e?1:0)}}),e.push({type:"radiobuttons",label:"Node Color",current_value:t.node_color,choices:[["Cells","cells"],["State","state"]],func:e=>{this._changeNodeColor(e)}}),o=this.dataStore.getMinMaxForColumn(t.param[6]),e.push({type:"doubleslider",max:50,min:1,doc:this.__doc__,current_value:this.config.node_size.range,label:"Node Size Range",func:(e,t)=>{this._changeNodeSizeScale(null,[e,t],!0)}}),e.push({type:"doubleslider",max:o[1],min:o[0],doc:this.__doc__,current_value:this.config.node_size.domain,label:"Node Size Domain",func:(e,t)=>{this._changeNodeSizeScale([e,t],null,!0)}}),e.push({type:"check",current_value:t.node_size.show_legend,label:"Show Node Size Legend",func:e=>{t.node_size.show_legend=e,this._changeNodeSizeScale()}}),e.push({type:"slider",max:2,min:0,doc:this.__doc__,current_value:t.link_strength,label:"Link Strength",func:e=>{t.link_strength=e,this.changeParameter()}}),e.push({type:"slider",max:0,min:-1e3,doc:this.__doc__,current_value:t.node_repulsion,label:"Node Repulsion",func:e=>{t.node_repulsion=e,this.changeParameter()}}),e}},params:[{type:"text",name:"category"},{type:"text",name:"Cells 1"},{type:"text",name:"Cells 2"},{type:"number",name:"link length"},{type:"number",name:"link thickness"},{type:"number",name:"link color"},{type:"number",name:"cell Number"}]},I.types.cell_radial_chart={name:"Cell Radial Chart",allow_user_add:!1,class:class extends Mt{constructor(e,t,n){super(e,t,n,{});const i=this.config;if(i.label_size=i.label_size||12,this.stratify=function(){var e,t=Ei,n=Di;function i(i){var r,o,a,s,l,c,h,u,f=Array.from(i),d=t,p=n,g=new Map;if(null!=e){const t=f.map(((t,n)=>function(e){let t=(e=`${e}`).length;return Mi(e,t-1)&&!Mi(e,t-2)&&(e=e.slice(0,-1)),"/"===e[0]?e:`/${e}`}(e(t,n,i)))),n=t.map(Ai),r=new Set(t).add("");for(const e of n)r.has(e)||(r.add(e),t.push(e),n.push(Ai(e)),f.push(Si));d=(e,n)=>t[n],p=(e,t)=>n[t]}for(a=0,r=f.length;a<r;++a)o=f[a],c=f[a]=new xi(o),null!=(h=d(o,a,i))&&(h+="")&&(u=c.id=h,g.set(u,g.has(u)?ki:c)),null!=(h=p(o,a,i))&&(h+="")&&(c.parent=h);for(a=0;a<r;++a)if(h=(c=f[a]).parent){if(!(l=g.get(h)))throw new Error("missing: "+h);if(l===ki)throw new Error("ambiguous: "+h);l.children?l.children.push(c):l.children=[c],c.parent=l}else{if(s)throw new Error("multiple roots");s=c}if(!s)throw new Error("no root");if(null!=e){for(;s.data===Si&&1===s.children.length;)s=s.children[0],--r;for(let e=f.length-1;e>=0&&(c=f[e],c.data===Si);--e)c.data=null}if(s.parent=Ci,s.eachBefore((function(e){e.depth=e.parent.depth+1,--r})).eachBefore(wi),s.parent=null,r>0)throw new Error("cycle");return s}return i.id=function(e){return arguments.length?(t=gi(e),i):t},i.parentId=function(e){return arguments.length?(n=gi(e),i):n},i.path=function(t){return arguments.length?(e=gi(t),i):e},i}().id((e=>e[0])).parentId((e=>e[1])),this.linkThicknessScale=(0,Z.Z)(),i.scales={},!i.link_thickness){i.link_thickness={type:"constant",width:3};const e=this.dataStore.getColumnQuantile(i.param[4],.01);this._changeLinkThicknessScale(e,[1,10])}i.filtered_ids&&(this.filtered_ids=new Set(i.filtered_ids)),i.state_legend=i.state_legend||{show:!0,position:[10,20]},i.outer_cell_color=i.outer_cell_color||"state",this.extra_legends=["state_legend"],i.node_size=i.node_size||{inner:5,outer:5},i.label_size=i.label_size||13,this.makeHierarchy(),this.drawTree(),this.setStateLegend()}onDataFiltered(){this.makeHierarchy(),this.drawTree(),this.setStateLegend()}getConfig(){const e=super.getConfig(),t=this.state_legend;return t&&(e.state_legend.position=[t.offsetLeft,t.offsetTop]),e}setStateLegend(){const e=this.config,t=this.config.state_legend;if(this.state_legend&&this.state_legend.remove(),!t.show)return;const n=this.dataStore.columnIndex[e.param[0]];let i=n.values,r=this.dataStore.getColumnColors(e.param[0]);e.states&&(r=r.filter(((t,n)=>-1!==e.states.indexOf(i[n]))),i=i.filter((t=>-1!==e.states.indexOf(t)))),this.state_legend=(0,bo.Ee)(r,i,{label:n.name}),this.contentDiv.append(this.state_legend),this.state_legend.style.top=t.position[1]+"px",this.state_legend.style.left=t.position[0]+"px"}_changeNodeSize(){const e=this.config;this.nodes.attr("r",(t=>1===t.depth?e.node_size.inner:3===t.depth?e.node_size.outer:void 0))}_changeLinkThicknessScale(e,t,n){const i=this.config,r=this.dataStore.getRawColumn(i.param[4]);t&&(i.link_thickness.range=t),e&&(i.link_thickness.domain=e),this.linkThicknessScale.domain(i.link_thickness.domain).range(i.link_thickness.range).clamp(!0);const o=this,a="constant"===i.link_thickness.type,s=i.link_thickness.width+"px";n&&this.links.attr("stroke-width",(e=>3===e.depth?a?s:o.linkThicknessScale(r[e.id]):s))}getSettings(){const e=super.getSettings(),t=this.config,n=this.dataStore.getColumnValues(t.param[1]),i=this.dataStore.getColumnValues(t.param[0]),r=this.dataStore.getColumnValues(t.param[5]),o=this.dataStore.getColumnList("number");let a=this.dataStore.getColumnQuantile(t.param[4],.01);return e.concat([{type:"slider",max:1,min:0,step:.01,doc:this.__doc__,current_value:t.stat_cutoff,label:"significance cut off",func:e=>{t.stat_cutoff=e,this.makeHierarchy(),this.drawTree()}},{type:"slider",max:20,min:5,doc:this.__doc__,current_value:t.label_size,label:"Label Size",func:e=>{t.label_size=e,this.graph_area.selectAll("text").attr("font-size",e)}},{type:"dropdown",current_value:t.outer_cell_type||"none",values:[r.map((e=>[e])).concat([["none"]]),0,0],label:"Outer Cell Type",func:e=>{"none"===e?delete t.outer_cell_type:t.outer_cell_type=e,this.makeHierarchy(),this.drawTree()}},{type:"multidropdown",current_value:t.center_cells,values:[n.map((e=>[e])),0,0],label:"Central Cells",func:e=>{t.center_cells=e,this.makeHierarchy(),this.drawTree()}},{type:"multidropdown",current_value:t.states,values:[i.map((e=>[e])),0,0],label:"Cell states",func:e=>{t.states=e,this.makeHierarchy(),this.drawTree(),this.setStateLegend()}},{type:"slider",label:"Inner Node Size",max:20,min:1,doc:this.__doc__,current_value:t.node_size.inner,func:e=>{t.node_size.inner=e,this.drawTree()}},{type:"check",label:"Show Inner Links",current_value:t.central_links,func:e=>{t.central_links=e,this.drawTree()}},{type:"slider",label:"Outer Node Size",max:20,min:1,doc:this.__doc__,current_value:t.node_size.outer,func:e=>{t.node_size.outer=e,this.drawTree()}},{type:"radiobuttons",label:"Outer Node Color",current_value:t.outer_cell_color,choices:[["state","state"],["Cell color","cell_color"]],func:e=>{t.outer_cell_color=e,this.drawTree()}},{type:"radiobuttons",label:"Link Thickness Type",current_value:t.link_thickness.type,choices:[["constant","constant"],["based on column","column"]],func:e=>{t.link_thickness.type=e,this._changeLinkThicknessScale(null,null,!0)}},{type:"slider",label:"Link Thickness",max:10,min:1,doc:this.__doc__,current_value:this.config.link_thickness.width,func:e=>{t.link_thickness.width=e,this._changeLinkThicknessScale(null,null,!0)}},{label:"Link Thickness Column",type:"dropdown",values:[o,"name","field"],current_value:t.param[4],func:e=>{t.param[4]=e},onchange:(e,n)=>{t.param[4]=n;const i=e["Link Thickness Domain"].noUiSlider,r=this.dataStore.getColumnQuantile(n,.01);i.updateOptions({range:{max:r[1],min:r[0]}}),i.set(r),this._changeLinkThicknessScale(r,null,!0)}},{type:"doubleslider",max:20,min:1,doc:this.__doc__,current_value:this.config.link_thickness.range,label:"Link Thickness Range",func:(e,t)=>{this._changeLinkThicknessScale(null,[e,t],!0)}},{type:"doubleslider",max:a[1],min:a[0],doc:this.__doc__,current_value:this.config.link_thickness.domain,label:"Link Thickness Domain",func:(e,t)=>{this._changeLinkThicknessScale([e,t],null,!0)}}])}drawTree(){const e=this._getContentDimensions(),t=this.config,n=this.dataStore.getRawColumn(this.config.param[4]),i=Math.min(e.width,e.height)/2.8;this.graph_area.attr("transform",`translate(${e.left+e.width/2},${e.top+e.height/2})`);const r=this.dataStore.getColumnColors(t.param[0]),o=this.dataStore.getColumnColors(t.param[1]),a=this.dataStore.getColumnColors(t.param[2]),s=this.dataStore.getRawColumn(t.param[0]);var l=function(){var e=Ri,t=1,n=1,i=null;function r(r){var l=function(e){for(var t,n,i,r,o,a=new Ii(e,0),s=[a];t=s.pop();)if(i=t._.children)for(t.children=new Array(o=i.length),r=o-1;r>=0;--r)s.push(n=t.children[r]=new Ii(i[r],r)),n.parent=t;return(a.parent=new Ii(null,0)).children=[a],a}(r);if(l.eachAfter(o),l.parent.m=-l.z,l.eachBefore(a),i)r.eachBefore(s);else{var c=r,h=r,u=r;r.eachBefore((function(e){e.x<c.x&&(c=e),e.x>h.x&&(h=e),e.depth>u.depth&&(u=e)}));var f=c===h?1:e(c,h)/2,d=f-c.x,p=t/(h.x+f+d),g=n/(u.depth||1);r.eachBefore((function(e){e.x=(e.x+d)*p,e.y=e.depth*g}))}return r}function o(t){var n=t.children,i=t.parent.children,r=t.i?i[t.i-1]:null;if(n){!function(e){for(var t,n=0,i=0,r=e.children,o=r.length;--o>=0;)(t=r[o]).z+=n,t.m+=n,n+=t.s+(i+=t.c)}(t);var o=(n[0].z+n[n.length-1].z)/2;r?(t.z=r.z+e(t._,r._),t.m=t.z-o):t.z=o}else r&&(t.z=r.z+e(t._,r._));t.parent.A=function(t,n,i){if(n){for(var r,o=t,a=t,s=n,l=o.parent.children[0],c=o.m,h=a.m,u=s.m,f=l.m;s=Ti(s),o=Li(o),s&&o;)l=Li(l),(a=Ti(a)).a=t,(r=s.z+u-o.z-c+e(s._,o._))>0&&(Pi(zi(s,t,i),t,r),c+=r,h+=r),u+=s.m,c+=o.m,f+=l.m,h+=a.m;s&&!Ti(a)&&(a.t=s,a.m+=u-h),o&&!Li(l)&&(l.t=o,l.m+=c-f,i=t)}return i}(t,r,t.parent.A||i[0])}function a(e){e._.x=e.z+e.parent.m,e.m+=e.parent.m}function s(e){e.x*=t,e.y=e.depth*n}return r.separation=function(t){return arguments.length?(e=t,r):e},r.size=function(e){return arguments.length?(i=!1,t=+e[0],n=+e[1],r):i?null:[t,n]},r.nodeSize=function(e){return arguments.length?(i=!0,t=+e[0],n=+e[1],r):i?[t,n]:null},r}().size([360,i]).separation((function(e,t){return(e.parent==t.parent?1:2)/e.depth})),c=l(this.root);const h=this;this.graph_area.selectAll(".link").remove(),this.graph_area.selectAll(".node").remove(),this.graph_area.selectAll(".wedge").remove(),this.graph_area.selectAll(".ring").remove();const u={},f=c.descendants().slice(1),d=i/10;f.forEach((e=>{1===e.depth&&(e.y+=d)}));const p={};for(let e of f){if(3!==e.depth)continue;const t=e.data[1];p[t]?(p[t][0]=Math.min(p[t][0],e.x),p[t][1]=Math.max(p[t][1],e.x)):p[t]=[e.x,e.x,e.data[3]]}const g=[];for(let e in p){const t=p[e],n=e.split("|");g.push({startAngle:(t[0]-2)*Math.PI/180,endAngle:(t[1]+2)*Math.PI/180,cell:n[0],state:n[1],sid:t[2]})}const m=un().innerRadius(i*(2/3)).outerRadius(i+5);this.graph_area.selectAll(".wedge").data(g).enter().append("path").attr("class","wedge").attr("d",m).attr("opacity",.8).attr("fill",(e=>r[e.sid])).attr("stroke","gray").attr("stroke-width",1);const _=un().startAngle(0).endAngle(2*Math.PI),v=[{outerRadius:i+5,innerRadius:i-5,color:"blue"},{outerRadius:1*i/3+d+5,innerRadius:1*i/3+d-5,color:"green"}];this.graph_area.selectAll(".ring").data(v).enter().append("path").attr("class","ring").attr("d",_).attr("opacity",.4).attr("fill",(e=>e.color)).attr("stroke","gray").attr("stroke-width",1);const b="constant"===t.link_thickness.type;this.links=this.graph_area.selectAll(".link").data(f).enter().filter((e=>!!t.central_links||e.depth>1)).append("path").attr("class","link").attr("fill","none").attr("stroke","currentColor").attr("stroke-width",(e=>3===e.depth?b?t.link_thickness.type:h.linkThicknessScale(n[e.id]):t.link_thickness.type)).attr("d",(function(e){return u[e.depth]=e.y,e.depth>1?"M"+wo(e.x,e.y)+"C"+wo(e.x,(e.y+e.parent.y)/2)+" "+wo(e.parent.x,(e.y+e.parent.y)/2)+" "+wo(e.parent.x,e.parent.y):"M"+wo(e.x,e.y)+"L"+wo(e.parent.x,e.parent.y)}));var y=this.graph_area.selectAll(".node").data(f).enter().append("g").attr("class",(function(e){return"node"+(e.children?" node--internal":" node--leaf")})).attr("transform",(function(e){return"translate("+wo(e.x,e.y)+")"})).on("click",(function(e){h.nodeClicked(e)}));this.nodes=y.filter((e=>2!==e.depth)).append("circle").style("pointer-events","visible").attr("fill",(e=>1===e.depth?o[e.data[3]]:"state"===t.outer_cell_color?r[s[e.data[0]]]:a[e.data[4]])).attr("stroke","black").attr("stroke-width",1).attr("r",(e=>1===e.depth?t.node_size.inner:3===e.depth?t.node_size.outer:void 0));const w=this.config.label_size+"px";y.append("text").attr("dy",".31em").attr("font-size",w).style("fill","currentColor").attr("font-family","Helvetica").attr("x",(e=>{const n=1==e.depth?t.node_size.inner+1:t.node_size.outer+1;return e.x<180==!e.children?n:-n})).attr("alignment-baseline",(e=>1===e.depth&&t.central_links?"hanging":"baseline")).style("text-anchor",(function(e){return e.children?e.x>180?"start":"end":e.x<180?"start":"end"})).attr("transform",(function(e){return 1!==e.depth||t.central_links?"rotate("+(e.x<180?e.x-90:e.x+90)+")":"rotate(0)"})).text((function(e){return 2==e.depth?"":e.data[2]}))}setSize(e,t){super.setSize(e,t),this.drawTree()}makeHierarchy(){console.log("making hierarchy");const e=this.config,t=this.dataStore.columnIndex[e.param[1]],n=this.dataStore.columnIndex[e.param[2]],i=this.dataStore.columnIndex[e.param[0]],r=(this.dataStore.columnIndex[e.param[3]],this.dataStore.columnIndex[e.param[5]],e.specific_only);let o=null;r&&(o=new Set(r[0].map((e=>t.values.indexOf(e)))));let a=e.center_cells.map((e=>[e,"root",e,t.values.indexOf(e)]));a.unshift(["root",null]);for(let t of e.states)for(let n of e.center_cells){const e=`${t}|${n}`;a.push([e,n,t])}const s=e.center_cells.length+1,l=a.slice(s),c={};for(let e of l)c[e[0]]=e;const h=s+l.length,u=new Set,f=this.dataStore.filterArray;for(let r=0;r<this.dataStore.size;r++){if(f[r]>0)continue;if(o&&!o.has(n.data[r]))continue;const s=t.values[t.data[r]],l=n.values[n.data[r]],h=`${i.values[i.data[r]]}|${s}`;let d=!1;for(let t of e.exclude_interactions)if(-1!==t.indexOf(s)&&-1!==t.indexOf(l)){d=!0;break}d||c[h]&&(u.add(h),a.push([r,h,l,i.data[r],n.data[r]]))}a=a.filter(((e,t)=>t<s||t>=h||u.has(e[0]))),this.root=this.stratify(a)}},params:[{type:"text",name:"state"},{type:"text",name:"Cell Type 1"},{type:"text",name:"Cell Type 2"},{type:"number",name:"stat cuttoff"},{type:"number",name:"link width"},{type:"text",name:"outer cell type"}]};I.types.row_summary_box={class:class extends I{constructor(e,t,n){if(super(e,t,n),n.image){const e=(0,A.ut)("div",{classes:["mdv-image-holder"],style:{height:parseInt(.7*this.width)+"px"}},this.contentDiv);this.imViewer=new class{constructor(e,t,n={}){this.container=e,this.img=new Image,this.img.style.position="absolute",this.img.onload=e=>{this.orig_dim=[this.img.naturalWidth,this.img.naturalHeight,this.img.naturalWidth/this.img.naturalHeight],this.container.append(this.img),this.fit()},(0,A.$q)(this.img),this.container.style.overflow="hidden",this.container.addEventListener("wheel",(e=>{e.preventDefault(),this.zoom(Math.sign(e.deltaY)>0?-1:1,e)})),this.setImage(t)}setImage(e){this.img.src=e}fit(){const e=this.container.getBoundingClientRect();this.img.height=e.height,this.img.width=this.img.height*this.orig_dim[2],this.img.width>e.width?(this.img.width=e.width,this.img.height=this.img.width/this.orig_dim[2],this.img.style.top=(e.height-this.img.height)/2+"px",this.img.style.left="0px"):(this.img.style.top="0px",this.img.style.left=(e.width-this.img.width)/2+"px")}zoom(e,t){e=e>0?1.1:.9;const n=this.container.getBoundingClientRect();let i=this.img.getBoundingClientRect();const r=(t.clientX-n.left-this.img.offsetLeft)*(e-1),o=(t.clientY-n.top-this.img.offsetTop)*(e-1);this.img.width=i.width*e,this.img.height=i.height*e,this.img.style.left=this.img.offsetLeft-r+"px",this.img.style.top=this.img.offsetTop-o+"px"}}(e,this._getImage(0))}this.paramHolders={};const i=(0,A.ut)("div",{},this.contentDiv);for(let e of this.config.param){if(e===this.img_param)continue;const t=this.dataStore.columnIndex[e],n=(0,A.ut)("div",{classes:["mdv-section"]},i);n.__mcol__=t.field,(0,A.ut)("div",{text:t.name,classes:["mdv-section-header"]},n);let r=(0,A.ut)("div",{classes:["mdv-section-value"]},n);t.is_url&&(r=(0,A.ut)("a",{target:"_blank"},r)),this.paramHolders[t.field]=r}(0,A.Ng)(i,{handle:"mdv-section-header",sortEnded:e=>{const t=this.config;let n=[];t.image&&(n=[t.param[t.image.param]],t.image.param=0),t.param=n.concat(e.map((e=>e.__mcol__)))}}),this.setParam(0),this.contentDiv.style.overflowY="auto"}setParam(e){for(let t in this.paramHolders){const n=this.dataStore.getRowText(e,t);this.paramHolders[t].textContent=n,"A"===this.paramHolders[t].nodeName&&(this.paramHolders[t].href=n)}}_getImage(e){const t=this.config,n=t.param[t.image.param];this.img_param=n;const i=this.dataStore.getRowText(e,n);return`${t.image.base_url}${i}.${t.image.type}`}setSize(e,t){super.setSize(e,t),this.imViewer&&(this.imViewer.container.style.height=Math.round(.7*this.width)+"px",this.imViewer.fit())}onDataHighlighted(e){const t=e.indexes[0];this.imViewer&&this.imViewer.setImage(this._getImage(t)),this.setParam(t)}onDataFiltered(){const e=this.dataStore.getFirstFilteredIndex();this.onDataHighlighted({indexes:[e]})}changeBaseDocument(e){super.changeBaseDocument(e),this.imViewer.img.__doc__=e}getSettings(){return super.getSettings()}},name:"Row Summary Box",init:(e,t,n)=>{const i=n.image_set;if(i&&"__none__"!==i){const n=t.large_images[i];e.param=e.param||[],e.param.push(n.key_column),e.image={base_url:n.base_url,type:n.type,param:e.param.length-1}}},extra_controls:e=>{const t=e.large_images;if(t){let e=[];for(let n in t)e.push({name:n,value:n});return e=[{name:"none",value:"__none__"}].concat(e),[{type:"dropdown",name:"image_set",label:"Image Set",values:e}]}return[]},params:[{type:"_multi_column:all",name:"Values To Display"}]};var xo=__webpack_require__(1451),Co={};Co.styleTagTransform=u(),Co.setAttributes=s(),Co.insert=o().bind(null,"head"),Co.domAPI=i(),Co.insertStyleElement=c(),t()(xo.Z,Co),xo.Z&&xo.Z.locals&&xo.Z.locals;var ko=-2,So=-3,Eo=-5,Do=13,Ao=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535],Mo=[96,7,256,0,8,80,0,8,16,84,8,115,82,7,31,0,8,112,0,8,48,0,9,192,80,7,10,0,8,96,0,8,32,0,9,160,0,8,0,0,8,128,0,8,64,0,9,224,80,7,6,0,8,88,0,8,24,0,9,144,83,7,59,0,8,120,0,8,56,0,9,208,81,7,17,0,8,104,0,8,40,0,9,176,0,8,8,0,8,136,0,8,72,0,9,240,80,7,4,0,8,84,0,8,20,85,8,227,83,7,43,0,8,116,0,8,52,0,9,200,81,7,13,0,8,100,0,8,36,0,9,168,0,8,4,0,8,132,0,8,68,0,9,232,80,7,8,0,8,92,0,8,28,0,9,152,84,7,83,0,8,124,0,8,60,0,9,216,82,7,23,0,8,108,0,8,44,0,9,184,0,8,12,0,8,140,0,8,76,0,9,248,80,7,3,0,8,82,0,8,18,85,8,163,83,7,35,0,8,114,0,8,50,0,9,196,81,7,11,0,8,98,0,8,34,0,9,164,0,8,2,0,8,130,0,8,66,0,9,228,80,7,7,0,8,90,0,8,26,0,9,148,84,7,67,0,8,122,0,8,58,0,9,212,82,7,19,0,8,106,0,8,42,0,9,180,0,8,10,0,8,138,0,8,74,0,9,244,80,7,5,0,8,86,0,8,22,192,8,0,83,7,51,0,8,118,0,8,54,0,9,204,81,7,15,0,8,102,0,8,38,0,9,172,0,8,6,0,8,134,0,8,70,0,9,236,80,7,9,0,8,94,0,8,30,0,9,156,84,7,99,0,8,126,0,8,62,0,9,220,82,7,27,0,8,110,0,8,46,0,9,188,0,8,14,0,8,142,0,8,78,0,9,252,96,7,256,0,8,81,0,8,17,85,8,131,82,7,31,0,8,113,0,8,49,0,9,194,80,7,10,0,8,97,0,8,33,0,9,162,0,8,1,0,8,129,0,8,65,0,9,226,80,7,6,0,8,89,0,8,25,0,9,146,83,7,59,0,8,121,0,8,57,0,9,210,81,7,17,0,8,105,0,8,41,0,9,178,0,8,9,0,8,137,0,8,73,0,9,242,80,7,4,0,8,85,0,8,21,80,8,258,83,7,43,0,8,117,0,8,53,0,9,202,81,7,13,0,8,101,0,8,37,0,9,170,0,8,5,0,8,133,0,8,69,0,9,234,80,7,8,0,8,93,0,8,29,0,9,154,84,7,83,0,8,125,0,8,61,0,9,218,82,7,23,0,8,109,0,8,45,0,9,186,0,8,13,0,8,141,0,8,77,0,9,250,80,7,3,0,8,83,0,8,19,85,8,195,83,7,35,0,8,115,0,8,51,0,9,198,81,7,11,0,8,99,0,8,35,0,9,166,0,8,3,0,8,131,0,8,67,0,9,230,80,7,7,0,8,91,0,8,27,0,9,150,84,7,67,0,8,123,0,8,59,0,9,214,82,7,19,0,8,107,0,8,43,0,9,182,0,8,11,0,8,139,0,8,75,0,9,246,80,7,5,0,8,87,0,8,23,192,8,0,83,7,51,0,8,119,0,8,55,0,9,206,81,7,15,0,8,103,0,8,39,0,9,174,0,8,7,0,8,135,0,8,71,0,9,238,80,7,9,0,8,95,0,8,31,0,9,158,84,7,99,0,8,127,0,8,63,0,9,222,82,7,27,0,8,111,0,8,47,0,9,190,0,8,15,0,8,143,0,8,79,0,9,254,96,7,256,0,8,80,0,8,16,84,8,115,82,7,31,0,8,112,0,8,48,0,9,193,80,7,10,0,8,96,0,8,32,0,9,161,0,8,0,0,8,128,0,8,64,0,9,225,80,7,6,0,8,88,0,8,24,0,9,145,83,7,59,0,8,120,0,8,56,0,9,209,81,7,17,0,8,104,0,8,40,0,9,177,0,8,8,0,8,136,0,8,72,0,9,241,80,7,4,0,8,84,0,8,20,85,8,227,83,7,43,0,8,116,0,8,52,0,9,201,81,7,13,0,8,100,0,8,36,0,9,169,0,8,4,0,8,132,0,8,68,0,9,233,80,7,8,0,8,92,0,8,28,0,9,153,84,7,83,0,8,124,0,8,60,0,9,217,82,7,23,0,8,108,0,8,44,0,9,185,0,8,12,0,8,140,0,8,76,0,9,249,80,7,3,0,8,82,0,8,18,85,8,163,83,7,35,0,8,114,0,8,50,0,9,197,81,7,11,0,8,98,0,8,34,0,9,165,0,8,2,0,8,130,0,8,66,0,9,229,80,7,7,0,8,90,0,8,26,0,9,149,84,7,67,0,8,122,0,8,58,0,9,213,82,7,19,0,8,106,0,8,42,0,9,181,0,8,10,0,8,138,0,8,74,0,9,245,80,7,5,0,8,86,0,8,22,192,8,0,83,7,51,0,8,118,0,8,54,0,9,205,81,7,15,0,8,102,0,8,38,0,9,173,0,8,6,0,8,134,0,8,70,0,9,237,80,7,9,0,8,94,0,8,30,0,9,157,84,7,99,0,8,126,0,8,62,0,9,221,82,7,27,0,8,110,0,8,46,0,9,189,0,8,14,0,8,142,0,8,78,0,9,253,96,7,256,0,8,81,0,8,17,85,8,131,82,7,31,0,8,113,0,8,49,0,9,195,80,7,10,0,8,97,0,8,33,0,9,163,0,8,1,0,8,129,0,8,65,0,9,227,80,7,6,0,8,89,0,8,25,0,9,147,83,7,59,0,8,121,0,8,57,0,9,211,81,7,17,0,8,105,0,8,41,0,9,179,0,8,9,0,8,137,0,8,73,0,9,243,80,7,4,0,8,85,0,8,21,80,8,258,83,7,43,0,8,117,0,8,53,0,9,203,81,7,13,0,8,101,0,8,37,0,9,171,0,8,5,0,8,133,0,8,69,0,9,235,80,7,8,0,8,93,0,8,29,0,9,155,84,7,83,0,8,125,0,8,61,0,9,219,82,7,23,0,8,109,0,8,45,0,9,187,0,8,13,0,8,141,0,8,77,0,9,251,80,7,3,0,8,83,0,8,19,85,8,195,83,7,35,0,8,115,0,8,51,0,9,199,81,7,11,0,8,99,0,8,35,0,9,167,0,8,3,0,8,131,0,8,67,0,9,231,80,7,7,0,8,91,0,8,27,0,9,151,84,7,67,0,8,123,0,8,59,0,9,215,82,7,19,0,8,107,0,8,43,0,9,183,0,8,11,0,8,139,0,8,75,0,9,247,80,7,5,0,8,87,0,8,23,192,8,0,83,7,51,0,8,119,0,8,55,0,9,207,81,7,15,0,8,103,0,8,39,0,9,175,0,8,7,0,8,135,0,8,71,0,9,239,80,7,9,0,8,95,0,8,31,0,9,159,84,7,99,0,8,127,0,8,63,0,9,223,82,7,27,0,8,111,0,8,47,0,9,191,0,8,15,0,8,143,0,8,79,0,9,255],Ro=[80,5,1,87,5,257,83,5,17,91,5,4097,81,5,5,89,5,1025,85,5,65,93,5,16385,80,5,3,88,5,513,84,5,33,92,5,8193,82,5,9,90,5,2049,86,5,129,192,5,24577,80,5,2,87,5,385,83,5,25,91,5,6145,81,5,7,89,5,1537,85,5,97,93,5,24577,80,5,4,88,5,769,84,5,49,92,5,12289,82,5,13,90,5,3073,86,5,193,192,5,24577],Lo=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],To=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,112,112],Po=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],zo=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13];function Io(){}function Oo(){this.was=[0]}Io.prototype.inflateInit=function(e,t){return e||(e=15),t&&(t=!1),this.istate=new Oo,this.istate.inflateInit(this,t?-e:e)},Io.prototype.inflate=function(e){return null==this.istate?ko:this.istate.inflate(this,e)},Io.prototype.inflateEnd=function(){if(null==this.istate)return ko;var e=istate.inflateEnd(this);return this.istate=null,e},Io.prototype.inflateSync=function(){return istate.inflateSync(this)},Io.prototype.inflateSetDictionary=function(e,t){return istate.inflateSetDictionary(this,e,t)},Oo.prototype.inflateReset=function(e){return null==e||null==e.istate?ko:(e.total_in=e.total_out=0,e.msg=null,e.istate.mode=0!=e.istate.nowrap?7:0,e.istate.blocks.reset(e,null),0)},Oo.prototype.inflateEnd=function(e){return null!=this.blocks&&this.blocks.free(e),this.blocks=null,0},Oo.prototype.inflateInit=function(e,t){e.msg=null,this.blocks=null;let n=0;return t<0&&(t=-t,1),t<8||t>15?(this.inflateEnd(e),ko):(this.wbits=t,e.istate.blocks=new No(e,0!=e.istate.nowrap?null:this,1<<t),this.inflateReset(e),0)},Oo.prototype.inflate=function(e,t){var n,i;if(null==e||null==e.istate||null==e.next_in)return ko;for(t=4==t?Eo:0,n=Eo;;)switch(e.istate.mode){case 0:if(0==e.avail_in)return n;if(n=t,e.avail_in--,e.total_in++,8!=(15&(e.istate.method=e.next_in[e.next_in_index++]))){e.istate.mode=Do,e.msg="unknown compression method",e.istate.marker=5;break}if(8+(e.istate.method>>4)>e.istate.wbits){e.istate.mode=Do,e.msg="invalid window size",e.istate.marker=5;break}e.istate.mode=1;case 1:if(0==e.avail_in)return n;if(n=t,e.avail_in--,e.total_in++,i=255&e.next_in[e.next_in_index++],((e.istate.method<<8)+i)%31!=0){e.istate.mode=Do,e.msg="incorrect header check",e.istate.marker=5;break}if(0==(32&i)){e.istate.mode=7;break}e.istate.mode=2;case 2:if(0==e.avail_in)return n;n=t,e.avail_in--,e.total_in++,e.istate.need=(255&e.next_in[e.next_in_index++])<<24&4278190080,e.istate.mode=3;case 3:if(0==e.avail_in)return n;n=t,e.avail_in--,e.total_in++,e.istate.need+=(255&e.next_in[e.next_in_index++])<<16&16711680,e.istate.mode=4;case 4:if(0==e.avail_in)return n;n=t,e.avail_in--,e.total_in++,e.istate.need+=(255&e.next_in[e.next_in_index++])<<8&65280,e.istate.mode=5;case 5:return 0==e.avail_in?n:(n=t,e.avail_in--,e.total_in++,e.istate.need+=255&e.next_in[e.next_in_index++],e.adler=e.istate.need,e.istate.mode=6,2);case 6:return e.istate.mode=Do,e.msg="need dictionary",e.istate.marker=0,ko;case 7:if((n=e.istate.blocks.proc(e,n))==So){e.istate.mode=Do,e.istate.marker=0;break}if(0==n&&(n=t),1!=n)return n;if(n=t,e.istate.blocks.reset(e,e.istate.was),0!=e.istate.nowrap){e.istate.mode=12;break}e.istate.mode=8;case 8:if(0==e.avail_in)return n;n=t,e.avail_in--,e.total_in++,e.istate.need=(255&e.next_in[e.next_in_index++])<<24&4278190080,e.istate.mode=9;case 9:if(0==e.avail_in)return n;n=t,e.avail_in--,e.total_in++,e.istate.need+=(255&e.next_in[e.next_in_index++])<<16&16711680,e.istate.mode=10;case 10:if(0==e.avail_in)return n;n=t,e.avail_in--,e.total_in++,e.istate.need+=(255&e.next_in[e.next_in_index++])<<8&65280,e.istate.mode=11;case 11:if(0==e.avail_in)return n;if(n=t,e.avail_in--,e.total_in++,e.istate.need+=255&e.next_in[e.next_in_index++],e.istate.was[0]!=e.istate.need){e.istate.mode=Do,e.msg="incorrect data check",e.istate.marker=5;break}e.istate.mode=12;case 12:return 1;case Do:return So;default:return ko}},Oo.prototype.inflateSetDictionary=function(e,t,n){var i=0,r=n;return null==e||null==e.istate||6!=e.istate.mode?ko:e._adler.adler32(1,t,0,n)!=e.adler?So:(e.adler=e._adler.adler32(0,null,0,0),r>=1<<e.istate.wbits&&(i=n-(r=(1<<e.istate.wbits)-1)),e.istate.blocks.set_dictionary(t,i,r),e.istate.mode=7,0)};var Fo=[0,0,255,255];Oo.prototype.inflateSync=function(e){var t,n,i,r,o;if(null==e||null==e.istate)return ko;if(e.istate.mode!=Do&&(e.istate.mode=Do,e.istate.marker=0),0==(t=e.avail_in))return Eo;for(n=e.next_in_index,i=e.istate.marker;0!=t&&i<4;)e.next_in[n]==Fo[i]?i++:i=0!=e.next_in[n]?0:4-i,n++,t--;return e.total_in+=n-e.next_in_index,e.next_in_index=n,e.avail_in=t,e.istate.marker=i,4!=i?So:(r=e.total_in,o=e.total_out,this.inflateReset(e),e.total_in=r,e.total_out=o,e.istate.mode=7,0)},Oo.prototype.inflateSyncPoint=function(e){return null==e||null==e.istate||null==e.istate.blocks?ko:e.istate.blocks.sync_point()};var Bo=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];function No(e,t,n){this.hufts=new Int32Array(4320),this.window=new Uint8Array(n),this.end=n,this.checkfn=t,this.mode=0,this.reset(e,null),this.left=0,this.table=0,this.index=0,this.blens=null,this.bb=new Int32Array(1),this.tb=new Int32Array(1),this.codes=new Ho,this.last=0,this.bitk=0,this.bitb=0,this.read=0,this.write=0,this.check=0,this.inftree=new Uo}function Ho(){}function Uo(){}function $o(e,t,n,i,r){return e[0]=9,t[0]=5,n[0]=Mo,i[0]=Ro,0}No.prototype.reset=function(e,t){t&&(t[0]=this.check),6==this.mode&&this.codes.free(e),this.mode=0,this.bitk=0,this.bitb=0,this.read=this.write=0,this.checkfn&&(e.adler=this.check=e._adler.adler32(0,null,0,0))},No.prototype.proc=function(e,t){var n,i,r,o,a,s,l;for(o=e.next_in_index,a=e.avail_in,i=this.bitb,r=this.bitk,l=(s=this.write)<this.read?this.read-s-1:this.end-s;;)switch(this.mode){case 0:for(;r<3;){if(0==a)return this.bitb=i,this.bitk=r,e.avail_in=a,e.total_in+=o-e.next_in_index,e.next_in_index=o,this.write=s,this.inflate_flush(e,t);t=0,a--,i|=(255&e.next_in[o++])<<r,r+=8}switch(n=7&i,this.last=1&n,n>>>1){case 0:i>>>=3,i>>>=n=7&(r-=3),r-=n,this.mode=1;break;case 1:$o(f=new Int32Array(1),d=new Int32Array(1),p=[],g=[]),this.codes.init(f[0],d[0],p[0],0,g[0],0,e),i>>>=3,r-=3,this.mode=6;break;case 2:i>>>=3,r-=3,this.mode=3;break;case 3:return i>>>=3,r-=3,this.mode=Do,e.msg="invalid block type",t=So,this.bitb=i,this.bitk=r,e.avail_in=a,e.total_in+=o-e.next_in_index,e.next_in_index=o,this.write=s,this.inflate_flush(e,t)}break;case 1:for(;r<32;){if(0==a)return this.bitb=i,this.bitk=r,e.avail_in=a,e.total_in+=o-e.next_in_index,e.next_in_index=o,this.write=s,this.inflate_flush(e,t);t=0,a--,i|=(255&e.next_in[o++])<<r,r+=8}if((~i>>>16&65535)!=(65535&i))return this.mode=Do,e.msg="invalid stored block lengths",t=So,this.bitb=i,this.bitk=r,e.avail_in=a,e.total_in+=o-e.next_in_index,e.next_in_index=o,this.write=s,this.inflate_flush(e,t);this.left=65535&i,i=r=0,this.mode=0!=left?2:0!=this.last?7:0;break;case 2:if(0==a)return this.bitb=i,this.bitk=r,e.avail_in=a,e.total_in+=o-e.next_in_index,e.next_in_index=o,write=s,this.inflate_flush(e,t);if(0==l&&(s==end&&0!=read&&(l=(s=0)<this.read?this.read-s-1:this.end-s),0==l&&(this.write=s,t=this.inflate_flush(e,t),l=(s=this.write)<this.read?this.read-s-1:this.end-s,s==this.end&&0!=this.read&&(l=(s=0)<this.read?this.read-s-1:this.end-s),0==l)))return this.bitb=i,this.bitk=r,e.avail_in=a,e.total_in+=o-e.next_in_index,e.next_in_index=o,this.write=s,this.inflate_flush(e,t);if(t=0,(n=this.left)>a&&(n=a),n>l&&(n=l),Wo(e.next_in,o,window,s,n),o+=n,a-=n,s+=n,l-=n,0!=(this.left-=n))break;this.mode=0!=this.last?7:0;break;case 3:for(;r<14;){if(0==a)return this.bitb=i,this.bitk=r,e.avail_in=a,e.total_in+=o-e.next_in_index,e.next_in_index=o,this.write=s,this.inflate_flush(e,t);t=0,a--,i|=(255&e.next_in[o++])<<r,r+=8}if(this.table=n=16383&i,(31&n)>29||(n>>5&31)>29)return this.mode=9,e.msg="too many length or distance symbols",t=So,this.bitb=i,this.bitk=r,e.avail_in=a,e.total_in+=o-e.next_in_index,e.next_in_index=o,this.write=s,this.inflate_flush(e,t);if(n=258+(31&n)+(n>>5&31),null==this.blens||this.blens.length<n)this.blens=new Int32Array(n);else for(var c=0;c<n;c++)this.blens[c]=0;i>>>=14,r-=14,this.index=0,this.mode=4;case 4:for(;this.index<4+(this.table>>>10);){for(;r<3;){if(0==a)return this.bitb=i,this.bitk=r,e.avail_in=a,e.total_in+=o-e.next_in_index,e.next_in_index=o,this.write=s,this.inflate_flush(e,t);t=0,a--,i|=(255&e.next_in[o++])<<r,r+=8}this.blens[Bo[this.index++]]=7&i,i>>>=3,r-=3}for(;this.index<19;)this.blens[Bo[this.index++]]=0;if(this.bb[0]=7,0!=(n=this.inftree.inflate_trees_bits(this.blens,this.bb,this.tb,this.hufts,e)))return(t=n)==So&&(this.blens=null,this.mode=9),this.bitb=i,this.bitk=r,e.avail_in=a,e.total_in+=o-e.next_in_index,e.next_in_index=o,write=s,this.inflate_flush(e,t);this.index=0,this.mode=5;case 5:for(;n=this.table,this.index<258+(31&n)+(n>>5&31);){var h,u;for(n=this.bb[0];r<n;){if(0==a)return this.bitb=i,this.bitk=r,e.avail_in=a,e.total_in+=o-e.next_in_index,e.next_in_index=o,this.write=s,this.inflate_flush(e,t);t=0,a--,i|=(255&e.next_in[o++])<<r,r+=8}if(n=this.hufts[3*(this.tb[0]+(i&Ao[n]))+1],(u=this.hufts[3*(this.tb[0]+(i&Ao[n]))+2])<16)i>>>=n,r-=n,this.blens[this.index++]=u;else{for(c=18==u?7:u-14,h=18==u?11:3;r<n+c;){if(0==a)return this.bitb=i,this.bitk=r,e.avail_in=a,e.total_in+=o-e.next_in_index,e.next_in_index=o,this.write=s,this.inflate_flush(e,t);t=0,a--,i|=(255&e.next_in[o++])<<r,r+=8}if(r-=n,h+=(i>>>=n)&Ao[c],i>>>=c,r-=c,(c=this.index)+h>258+(31&(n=this.table))+(n>>5&31)||16==u&&c<1)return this.blens=null,this.mode=9,e.msg="invalid bit length repeat",t=So,this.bitb=i,this.bitk=r,e.avail_in=a,e.total_in+=o-e.next_in_index,e.next_in_index=o,this.write=s,this.inflate_flush(e,t);u=16==u?this.blens[c-1]:0;do{this.blens[c++]=u}while(0!=--h);this.index=c}}this.tb[0]=-1;var f=new Int32Array(1),d=new Int32Array(1),p=new Int32Array(1),g=new Int32Array(1);if(f[0]=9,d[0]=6,n=this.table,0!=(n=this.inftree.inflate_trees_dynamic(257+(31&n),1+(n>>5&31),this.blens,f,d,p,g,this.hufts,e)))return n==So&&(this.blens=null,this.mode=Do),t=n,this.bitb=i,this.bitk=r,e.avail_in=a,e.total_in+=o-e.next_in_index,e.next_in_index=o,this.write=s,this.inflate_flush(e,t);this.codes.init(f[0],d[0],this.hufts,p[0],this.hufts,g[0],e),this.mode=6;case 6:if(this.bitb=i,this.bitk=r,e.avail_in=a,e.total_in+=o-e.next_in_index,e.next_in_index=o,this.write=s,1!=(t=this.codes.proc(this,e,t)))return this.inflate_flush(e,t);if(t=0,this.codes.free(e),o=e.next_in_index,a=e.avail_in,i=this.bitb,r=this.bitk,l=(s=this.write)<this.read?this.read-s-1:this.end-s,0==this.last){this.mode=0;break}this.mode=7;case 7:if(this.write=s,t=this.inflate_flush(e,t),l=(s=this.write)<this.read?this.read-s-1:this.end-s,this.read!=this.write)return this.bitb=i,this.bitk=r,e.avail_in=a,e.total_in+=o-e.next_in_index,e.next_in_index=o,this.write=s,this.inflate_flush(e,t);this.mode=12;case 8:return t=1,this.bitb=i,this.bitk=r,e.avail_in=a,e.total_in+=o-e.next_in_index,e.next_in_index=o,this.write=s,this.inflate_flush(e,t);case 9:return t=So,this.bitb=i,this.bitk=r,e.avail_in=a,e.total_in+=o-e.next_in_index,e.next_in_index=o,this.write=s,this.inflate_flush(e,t);default:return t=ko,this.bitb=i,this.bitk=r,e.avail_in=a,e.total_in+=o-e.next_in_index,e.next_in_index=o,this.write=s,this.inflate_flush(e,t)}},No.prototype.free=function(e){this.reset(e,null),this.window=null,this.hufts=null},No.prototype.set_dictionary=function(e,t,n){Wo(e,t,window,0,n),this.read=this.write=n},No.prototype.sync_point=function(){return 1==this.mode},No.prototype.inflate_flush=function(e,t){var n,i,r;return i=e.next_out_index,(n=((r=this.read)<=this.write?this.write:this.end)-r)>e.avail_out&&(n=e.avail_out),0!=n&&t==Eo&&(t=0),e.avail_out-=n,e.total_out+=n,null!=this.checkfn&&(e.adler=this.check=e._adler.adler32(this.check,this.window,r,n)),Wo(this.window,r,e.next_out,i,n),i+=n,(r+=n)==this.end&&(r=0,this.write==this.end&&(this.write=0),(n=this.write-r)>e.avail_out&&(n=e.avail_out),0!=n&&t==Eo&&(t=0),e.avail_out-=n,e.total_out+=n,null!=this.checkfn&&(e.adler=this.check=e._adler.adler32(this.check,this.window,r,n)),Wo(this.window,r,e.next_out,i,n),i+=n,r+=n),e.next_out_index=i,this.read=r,t},Ho.prototype.init=function(e,t,n,i,r,o,a){this.mode=0,this.lbits=e,this.dbits=t,this.ltree=n,this.ltree_index=i,this.dtree=r,this.dtree_index=o,this.tree=null},Ho.prototype.proc=function(e,t,n){var i,r,o,a,s,l,c,h=0,u=0,f=0;for(f=t.next_in_index,a=t.avail_in,h=e.bitb,u=e.bitk,l=(s=e.write)<e.read?e.read-s-1:e.end-s;;)switch(this.mode){case 0:if(l>=258&&a>=10&&(e.bitb=h,e.bitk=u,t.avail_in=a,t.total_in+=f-t.next_in_index,t.next_in_index=f,e.write=s,n=this.inflate_fast(this.lbits,this.dbits,this.ltree,this.ltree_index,this.dtree,this.dtree_index,e,t),f=t.next_in_index,a=t.avail_in,h=e.bitb,u=e.bitk,l=(s=e.write)<e.read?e.read-s-1:e.end-s,0!=n)){this.mode=1==n?7:9;break}this.need=this.lbits,this.tree=this.ltree,this.tree_index=this.ltree_index,this.mode=1;case 1:for(i=this.need;u<i;){if(0==a)return e.bitb=h,e.bitk=u,t.avail_in=a,t.total_in+=f-t.next_in_index,t.next_in_index=f,e.write=s,e.inflate_flush(t,n);n=0,a--,h|=(255&t.next_in[f++])<<u,u+=8}if(r=3*(this.tree_index+(h&Ao[i])),h>>>=this.tree[r+1],u-=this.tree[r+1],0==(o=this.tree[r])){this.lit=this.tree[r+2],this.mode=6;break}if(0!=(16&o)){this.get=15&o,this.len=this.tree[r+2],this.mode=2;break}if(0==(64&o)){this.need=o,this.tree_index=r/3+this.tree[r+2];break}if(0!=(32&o)){this.mode=7;break}return this.mode=9,t.msg="invalid literal/length code",n=So,e.bitb=h,e.bitk=u,t.avail_in=a,t.total_in+=f-t.next_in_index,t.next_in_index=f,e.write=s,e.inflate_flush(t,n);case 2:for(i=this.get;u<i;){if(0==a)return e.bitb=h,e.bitk=u,t.avail_in=a,t.total_in+=f-t.next_in_index,t.next_in_index=f,e.write=s,e.inflate_flush(t,n);n=0,a--,h|=(255&t.next_in[f++])<<u,u+=8}this.len+=h&Ao[i],h>>=i,u-=i,this.need=this.dbits,this.tree=this.dtree,this.tree_index=this.dtree_index,this.mode=3;case 3:for(i=this.need;u<i;){if(0==a)return e.bitb=h,e.bitk=u,t.avail_in=a,t.total_in+=f-t.next_in_index,t.next_in_index=f,e.write=s,e.inflate_flush(t,n);n=0,a--,h|=(255&t.next_in[f++])<<u,u+=8}if(r=3*(this.tree_index+(h&Ao[i])),h>>=this.tree[r+1],u-=this.tree[r+1],0!=(16&(o=this.tree[r]))){this.get=15&o,this.dist=this.tree[r+2],this.mode=4;break}if(0==(64&o)){this.need=o,this.tree_index=r/3+this.tree[r+2];break}return this.mode=9,t.msg="invalid distance code",n=So,e.bitb=h,e.bitk=u,t.avail_in=a,t.total_in+=f-t.next_in_index,t.next_in_index=f,e.write=s,e.inflate_flush(t,n);case 4:for(i=this.get;u<i;){if(0==a)return e.bitb=h,e.bitk=u,t.avail_in=a,t.total_in+=f-t.next_in_index,t.next_in_index=f,e.write=s,e.inflate_flush(t,n);n=0,a--,h|=(255&t.next_in[f++])<<u,u+=8}this.dist+=h&Ao[i],h>>=i,u-=i,this.mode=5;case 5:for(c=s-this.dist;c<0;)c+=e.end;for(;0!=this.len;){if(0==l&&(s==e.end&&0!=e.read&&(l=(s=0)<e.read?e.read-s-1:e.end-s),0==l&&(e.write=s,n=e.inflate_flush(t,n),l=(s=e.write)<e.read?e.read-s-1:e.end-s,s==e.end&&0!=e.read&&(l=(s=0)<e.read?e.read-s-1:e.end-s),0==l)))return e.bitb=h,e.bitk=u,t.avail_in=a,t.total_in+=f-t.next_in_index,t.next_in_index=f,e.write=s,e.inflate_flush(t,n);e.window[s++]=e.window[c++],l--,c==e.end&&(c=0),this.len--}this.mode=0;break;case 6:if(0==l&&(s==e.end&&0!=e.read&&(l=(s=0)<e.read?e.read-s-1:e.end-s),0==l&&(e.write=s,n=e.inflate_flush(t,n),l=(s=e.write)<e.read?e.read-s-1:e.end-s,s==e.end&&0!=e.read&&(l=(s=0)<e.read?e.read-s-1:e.end-s),0==l)))return e.bitb=h,e.bitk=u,t.avail_in=a,t.total_in+=f-t.next_in_index,t.next_in_index=f,e.write=s,e.inflate_flush(t,n);n=0,e.window[s++]=this.lit,l--,this.mode=0;break;case 7:if(u>7&&(u-=8,a++,f--),e.write=s,n=e.inflate_flush(t,n),l=(s=e.write)<e.read?e.read-s-1:e.end-s,e.read!=e.write)return e.bitb=h,e.bitk=u,t.avail_in=a,t.total_in+=f-t.next_in_index,t.next_in_index=f,e.write=s,e.inflate_flush(t,n);this.mode=8;case 8:return n=1,e.bitb=h,e.bitk=u,t.avail_in=a,t.total_in+=f-t.next_in_index,t.next_in_index=f,e.write=s,e.inflate_flush(t,n);case 9:return n=So,e.bitb=h,e.bitk=u,t.avail_in=a,t.total_in+=f-t.next_in_index,t.next_in_index=f,e.write=s,e.inflate_flush(t,n);default:return n=ko,e.bitb=h,e.bitk=u,t.avail_in=a,t.total_in+=f-t.next_in_index,t.next_in_index=f,e.write=s,e.inflate_flush(t,n)}},Ho.prototype.free=function(e){},Ho.prototype.inflate_fast=function(e,t,n,i,r,o,a,s){var l,c,h,u,f,d,p,g,m,_,v,b,y,w,x,C;p=s.next_in_index,g=s.avail_in,f=a.bitb,d=a.bitk,_=(m=a.write)<a.read?a.read-m-1:a.end-m,v=Ao[e],b=Ao[t];do{for(;d<20;)g--,f|=(255&s.next_in[p++])<<d,d+=8;if(0!=(u=(c=n)[C=3*((h=i)+(l=f&v))]))for(;;){if(f>>=c[C+1],d-=c[C+1],0!=(16&u)){for(u&=15,y=c[C+2]+(f&Ao[u]),f>>=u,d-=u;d<15;)g--,f|=(255&s.next_in[p++])<<d,d+=8;for(u=(c=r)[C=3*((h=o)+(l=f&b))];;){if(f>>=c[C+1],d-=c[C+1],0!=(16&u)){for(u&=15;d<u;)g--,f|=(255&s.next_in[p++])<<d,d+=8;if(w=c[C+2]+(f&Ao[u]),f>>=u,d-=u,_-=y,m>=w)x=m-w,a.window[m++]=a.window[x++],a.window[m++]=a.window[x++],y-=2;else{x=m-w;do{x+=a.end}while(x<0);if(y>(u=a.end-x)){if(y-=u,m-x>0&&u>m-x)do{a.window[m++]=a.window[x++]}while(0!=--u);else Wo(a.window,x,a.window,m,u),m+=u,x+=u,u=0;x=0}}do{a.window[m++]=a.window[x++]}while(0!=--y);break}if(0!=(64&u))return s.msg="invalid distance code",g+=y=d>>3<(y=s.avail_in-g)?d>>3:y,p-=y,d-=y<<3,a.bitb=f,a.bitk=d,s.avail_in=g,s.total_in+=p-s.next_in_index,s.next_in_index=p,a.write=m,So;l+=c[C+2],u=c[C=3*(h+(l+=f&Ao[u]))]}break}if(0!=(64&u))return 0!=(32&u)?(g+=y=d>>3<(y=s.avail_in-g)?d>>3:y,p-=y,d-=y<<3,a.bitb=f,a.bitk=d,s.avail_in=g,s.total_in+=p-s.next_in_index,s.next_in_index=p,a.write=m,1):(s.msg="invalid literal/length code",g+=y=d>>3<(y=s.avail_in-g)?d>>3:y,p-=y,d-=y<<3,a.bitb=f,a.bitk=d,s.avail_in=g,s.total_in+=p-s.next_in_index,s.next_in_index=p,a.write=m,So);if(l+=c[C+2],0==(u=c[C=3*(h+(l+=f&Ao[u]))])){f>>=c[C+1],d-=c[C+1],a.window[m++]=c[C+2],_--;break}}else f>>=c[C+1],d-=c[C+1],a.window[m++]=c[C+2],_--}while(_>=258&&g>=10);return g+=y=d>>3<(y=s.avail_in-g)?d>>3:y,p-=y,d-=y<<3,a.bitb=f,a.bitk=d,s.avail_in=g,s.total_in+=p-s.next_in_index,s.next_in_index=p,a.write=m,0},Uo.prototype.huft_build=function(e,t,n,i,r,o,a,s,l,c,h){var u,f,d,p,g,m,_,v,b,y,w,x,C,k,S;y=0,g=n;do{this.c[e[t+y]]++,y++,g--}while(0!=g);if(this.c[0]==n)return a[0]=-1,s[0]=0,0;for(v=s[0],m=1;m<=15&&0==this.c[m];m++);for(_=m,v<m&&(v=m),g=15;0!=g&&0==this.c[g];g--);for(d=g,v>g&&(v=g),s[0]=v,k=1<<m;m<g;m++,k<<=1)if((k-=this.c[m])<0)return So;if((k-=this.c[g])<0)return So;for(this.c[g]+=k,this.x[1]=m=0,y=1,C=2;0!=--g;)this.x[C]=m+=this.c[y],C++,y++;g=0,y=0;do{0!=(m=e[t+y])&&(this.v[this.x[m]++]=g),y++}while(++g<n);for(n=this.x[d],this.x[0]=g=0,y=0,p=-1,x=-v,this.u[0]=0,w=0,S=0;_<=d;_++)for(u=this.c[_];0!=u--;){for(;_>x+v;){if(p++,S=(S=d-(x+=v))>v?v:S,(f=1<<(m=_-x))>u+1&&(f-=u+1,C=_,m<S))for(;++m<S&&!((f<<=1)<=this.c[++C]);)f-=this.c[C];if(S=1<<m,this.hn[0]+S>1440)return So;this.u[p]=w=this.hn[0],this.hn[0]+=S,0!=p?(this.x[p]=g,this.r[0]=m,this.r[1]=v,m=g>>>x-v,this.r[2]=w-this.u[p-1]-m,Wo(this.r,0,l,3*(this.u[p-1]+m),3)):a[0]=w}for(this.r[1]=_-x,y>=n?this.r[0]=192:h[y]<i?(this.r[0]=this.v[y]<256?0:96,this.r[2]=this.v[y++]):(this.r[0]=o[this.v[y]-i]+16+64,this.r[2]=r[this.v[y++]-i]),f=1<<_-x,m=g>>>x;m<S;m+=f)Wo(this.r,0,l,3*(w+m),3);for(m=1<<_-1;0!=(g&m);m>>>=1)g^=m;for(g^=m,b=(1<<x)-1;(g&b)!=this.x[p];)p--,b=(1<<(x-=v))-1}return 0!=k&&1!=d?Eo:0},Uo.prototype.inflate_trees_bits=function(e,t,n,i,r){var o;return this.initWorkArea(19),this.hn[0]=0,(o=this.huft_build(e,0,19,19,null,null,n,t,i,this.hn,this.v))==So?r.msg="oversubscribed dynamic bit lengths tree":o!=Eo&&0!=t[0]||(r.msg="incomplete dynamic bit lengths tree",o=So),o},Uo.prototype.inflate_trees_dynamic=function(e,t,n,i,r,o,a,s,l){var c;return this.initWorkArea(288),this.hn[0]=0,0!=(c=this.huft_build(n,0,e,257,Lo,To,o,i,s,this.hn,this.v))||0==i[0]?(c==So?l.msg="oversubscribed literal/length tree":-4!=c&&(l.msg="incomplete literal/length tree",c=So),c):(this.initWorkArea(288),0!=(c=this.huft_build(n,e,t,0,Po,zo,a,r,s,this.hn,this.v))||0==r[0]&&e>257?(c==So?l.msg="oversubscribed distance tree":c==Eo?(l.msg="incomplete distance tree",c=So):-4!=c&&(l.msg="empty distance tree with lengths",c=So),c):0)},Uo.prototype.initWorkArea=function(e){null==this.hn&&(this.hn=new Int32Array(1),this.v=new Int32Array(e),this.c=new Int32Array(16),this.r=new Int32Array(3),this.u=new Int32Array(15),this.x=new Int32Array(16)),this.v.length<e&&(this.v=new Int32Array(e));for(var t=0;t<e;t++)this.v[t]=0;for(t=0;t<16;t++)this.c[t]=0;for(t=0;t<3;t++)this.r[t]=0;Wo(this.c,0,this.u,0,15),Wo(this.c,0,this.x,0,16)};var jo="function"==typeof new Uint8Array(1).subarray;function Wo(e,t,n,i,r){if(0!=r){if(!e)throw"Undef src";if(!n)throw"Undef dest";0==t&&r==e.length?qo(e,n,i):jo?qo(e.subarray(t,t+r),n,i):1==e.BYTES_PER_ELEMENT&&r>100?qo(new Uint8Array(e.buffer,e.byteOffset+t,r),n,i):function(e,t,n,i,r){for(var o=0;o<r;++o)n[i+o]=e[t+o]}(e,t,n,i,r)}}function qo(e,t,n){t.set(e,n)}function Vo(e,t,n,i){e=t?new Uint8Array(e,t,n):new Uint8Array(e);var r=new Io;r.inflateInit(15,!0),r.next_in=e,r.next_in_index=0,r.avail_in=e.length;for(var o=[],a=0;;){var s=new Uint8Array(32e3);r.next_out=s,r.next_out_index=0,r.avail_out=s.length;var l=r.inflate(0);if(0!=l&&1!=l)throw r.msg;if(0!=r.avail_out){var c=new Uint8Array(s.length-r.avail_out);Wo(s,0,c,0,s.length-r.avail_out),s=c}if(o.push(s),a+=s.length,1==l)break}if(i&&(i[0]=(t||0)+r.next_in_index),1==o.length)return o[0].buffer;for(var h=new Uint8Array(a),u=0,f=0;f<o.length;++f){var d=o[f];Wo(d,0,h,u,d.length),u+=d.length}return h.buffer}var Ko={Huffman:{},Util:{},CRC32:{},CompressionMethod:{DEFLATE:8,RESERVED:15},Zip:function(e){e=e||{},this.files=[],this.comment=e.comment,this.password}};Ko.Zip.CompressionMethod={STORE:0,DEFLATE:8},Ko.Zip.OperatingSystem={MSDOS:0,UNIX:3,MACINTOSH:7},Ko.Zip.Flags={ENCRYPT:1,DESCRIPTOR:8,UTF8:2048},Ko.Zip.FileHeaderSignature=[80,75,1,2],Ko.Zip.LocalFileHeaderSignature=[80,75,3,4],Ko.Zip.CentralDirectorySignature=[80,75,5,6],Ko.Zip.prototype.addFile=function(e,t){(t=t||{}).filename;var n,i=e.length,r=0;if(e instanceof Array&&(e=new Uint8Array(e)),"number"!=typeof t.compressionMethod&&(t.compressionMethod=Ko.Zip.CompressionMethod.DEFLATE),t.compress)switch(t.compressionMethod){case Ko.Zip.CompressionMethod.STORE:break;case Ko.Zip.CompressionMethod.DEFLATE:r=Ko.CRC32.calc(e),e=this.deflateWithOption(e,t),n=!0;break;default:throw new Error("unknown compression method:"+t.compressionMethod)}this.files.push({buffer:e,option:t,compressed:n,encrypted:!1,size:i,crc32:r})},Ko.Zip.prototype.setPassword=function(e){this.password=e},Ko.Zip.prototype.compress=function(){var e,t,n,i,r,o,a,s,l,c,h,u,f,d,p,g,m,_,v,b,y,w,x,C,k,S,E=this.files,D=0,A=0;for(x=0,C=E.length;x<C;++x){if(d=(e=E[x]).option.filename?e.option.filename.length:0,p=e.option.extraField?e.option.extraField.length:0,g=e.option.comment?e.option.comment.length:0,!e.compressed)switch(e.crc32=Ko.CRC32.calc(e.buffer),e.option.compressionMethod){case Ko.Zip.CompressionMethod.STORE:break;case Ko.Zip.CompressionMethod.DEFLATE:e.buffer=this.deflateWithOption(e.buffer,e.option),e.compressed=!0;break;default:throw new Error("unknown compression method:"+e.option.compressionMethod)}if(void 0!==e.option.password||void 0!==this.password){for(w=this.createEncryptionKey(e.option.password||this.password),b=e.buffer,(y=new Uint8Array(b.length+12)).set(b,12),b=y,k=0;k<12;++k)b[k]=this.encode(w,11===x?255&e.crc32:256*Math.random()|0);for(S=b.length;k<S;++k)b[k]=this.encode(w,b[k]);e.buffer=b}D+=30+d+e.buffer.length,A+=46+d+g}for(o=22+(this.comment?this.comment.length:0),t=new Uint8Array(D+A+o),n=0,r=(i=D)+A,x=0,C=E.length;x<C;++x)d=(e=E[x]).option.filename?e.option.filename.length:0,p=0,g=e.option.comment?e.option.comment.length:0,a=n,t[n++]=Ko.Zip.LocalFileHeaderSignature[0],t[n++]=Ko.Zip.LocalFileHeaderSignature[1],t[n++]=Ko.Zip.LocalFileHeaderSignature[2],t[n++]=Ko.Zip.LocalFileHeaderSignature[3],t[i++]=Ko.Zip.FileHeaderSignature[0],t[i++]=Ko.Zip.FileHeaderSignature[1],t[i++]=Ko.Zip.FileHeaderSignature[2],t[i++]=Ko.Zip.FileHeaderSignature[3],t[i++]=20,t[i++]=e.option.os||Ko.Zip.OperatingSystem.MSDOS,t[n++]=t[i++]=20,t[n++]=t[i++]=0,s=0,(e.option.password||this.password)&&(s|=Ko.Zip.Flags.ENCRYPT),t[n++]=t[i++]=255&s,t[n++]=t[i++]=s>>8&255,l=e.option.compressionMethod,t[n++]=t[i++]=255&l,t[n++]=t[i++]=l>>8&255,c=e.option.date||new Date,t[n++]=t[i++]=(7&c.getMinutes())<<5|c.getSeconds()/2|0,t[n++]=t[i++]=c.getHours()<<3|c.getMinutes()>>3,t[n++]=t[i++]=(c.getMonth()+1&7)<<5|c.getDate(),t[n++]=t[i++]=(c.getFullYear()-1980&127)<<1|c.getMonth()+1>>3,h=e.crc32,t[n++]=t[i++]=255&h,t[n++]=t[i++]=h>>8&255,t[n++]=t[i++]=h>>16&255,t[n++]=t[i++]=h>>24&255,u=e.buffer.length,t[n++]=t[i++]=255&u,t[n++]=t[i++]=u>>8&255,t[n++]=t[i++]=u>>16&255,t[n++]=t[i++]=u>>24&255,f=e.size,t[n++]=t[i++]=255&f,t[n++]=t[i++]=f>>8&255,t[n++]=t[i++]=f>>16&255,t[n++]=t[i++]=f>>24&255,t[n++]=t[i++]=255&d,t[n++]=t[i++]=d>>8&255,t[n++]=t[i++]=255&p,t[n++]=t[i++]=p>>8&255,t[i++]=255&g,t[i++]=g>>8&255,t[i++]=0,t[i++]=0,t[i++]=0,t[i++]=0,t[i++]=0,t[i++]=0,t[i++]=0,t[i++]=0,t[i++]=255&a,t[i++]=a>>8&255,t[i++]=a>>16&255,t[i++]=a>>24&255,(m=e.option.filename)&&(t.set(m,n),t.set(m,i),n+=d,i+=d),(_=e.option.extraField)&&(t.set(_,n),t.set(_,i),n+=p,i+=p),(v=e.option.comment)&&(t.set(v,i),i+=g),t.set(e.buffer,n),n+=e.buffer.length;return t[r++]=Ko.Zip.CentralDirectorySignature[0],t[r++]=Ko.Zip.CentralDirectorySignature[1],t[r++]=Ko.Zip.CentralDirectorySignature[2],t[r++]=Ko.Zip.CentralDirectorySignature[3],t[r++]=0,t[r++]=0,t[r++]=0,t[r++]=0,t[r++]=255&C,t[r++]=C>>8&255,t[r++]=255&C,t[r++]=C>>8&255,t[r++]=255&A,t[r++]=A>>8&255,t[r++]=A>>16&255,t[r++]=A>>24&255,t[r++]=255&D,t[r++]=D>>8&255,t[r++]=D>>16&255,t[r++]=D>>24&255,g=this.comment?this.comment.length:0,t[r++]=255&g,t[r++]=g>>8&255,this.comment&&(t.set(this.comment,r),r+=g),t},Ko.Zip.prototype.deflateWithOption=function(e,t){return new Ko.RawDeflate(e,t.deflateOption).compress()},Ko.Zip.prototype.getByte=function(e){var t=65535&e[2]|2;return t*(1^t)>>8&255},Ko.Zip.prototype.encode=function(e,t){var n=this.getByte(e);return this.updateKeys(e,t),n^t},Ko.Zip.prototype.updateKeys=function(e,t){e[0]=Ko.CRC32.single(e[0],t),e[1]=1+(6681*(20173*(e[1]+(255&e[0]))>>>0)>>>0)>>>0,e[2]=Ko.CRC32.single(e[2],e[1]>>>24)},Ko.Zip.prototype.createEncryptionKey=function(e){var t,n,i=[305419896,591751049,878082192];for(i=new Uint32Array(i),t=0,n=e.length;t<n;++t)this.updateKeys(i,255&e[t]);return i},Ko.Huffman.buildHuffmanTable=function(e){var t,n,i,r,o,a,s,l,c,h,u,f=e.length,d=0,p=Number.POSITIVE_INFINITY;for(l=0,c=f;l<c;++l)e[l]>d&&(d=e[l]),e[l]<p&&(p=e[l]);for(t=1<<d,n=new Uint32Array(t),i=1,r=0,o=2;i<=d;){for(l=0;l<f;++l)if(e[l]===i){for(a=0,s=r,h=0;h<i;++h)a=a<<1|1&s,s>>=1;for(u=i<<16|l,h=a;h<t;h+=o)n[h]=u;++r}++i,r<<=1,o<<=1}return[n,d,p]};var Go=Ko.Huffman.buildHuffmanTable;Ko.RawInflate=function(e,t){switch(this.buffer,this.blocks=[],this.bufferSize=32768,this.totalpos=0,this.ip=0,this.bitsbuf=0,this.bitsbuflen=0,this.input=new Uint8Array(e),this.output,this.op,this.bfinal=!1,this.bufferType=Ko.RawInflate.BufferType.ADAPTIVE,this.resize=!1,!t&&(t={})||(t.index&&(this.ip=t.index),t.bufferSize&&(this.bufferSize=t.bufferSize),t.bufferType&&(this.bufferType=t.bufferType),t.resize&&(this.resize=t.resize)),this.bufferType){case Ko.RawInflate.BufferType.BLOCK:this.op=Ko.RawInflate.MaxBackwardLength,this.output=new Uint8Array(Ko.RawInflate.MaxBackwardLength+this.bufferSize+Ko.RawInflate.MaxCopyLength);break;case Ko.RawInflate.BufferType.ADAPTIVE:this.op=0,this.output=new Uint8Array(this.bufferSize);break;default:throw new Error("invalid inflate mode")}},Ko.RawInflate.BufferType={BLOCK:0,ADAPTIVE:1},Ko.RawInflate.prototype.decompress=function(){for(;!this.bfinal;)this.parseBlock();switch(this.bufferType){case Ko.RawInflate.BufferType.BLOCK:return this.concatBufferBlock();case Ko.RawInflate.BufferType.ADAPTIVE:return this.concatBufferDynamic();default:throw new Error("invalid inflate mode")}},Ko.RawInflate.MaxBackwardLength=32768,Ko.RawInflate.MaxCopyLength=258,Ko.RawInflate.Order=new Uint16Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Ko.RawInflate.LengthCodeTable=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258]),Ko.RawInflate.LengthExtraTable=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0]),Ko.RawInflate.DistCodeTable=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577]),Ko.RawInflate.DistExtraTable=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),Ko.RawInflate.FixedLiteralLengthTable=function(){var e,t,n=new Uint8Array(288);for(e=0,t=n.length;e<t;++e)n[e]=e<=143?8:e<=255?9:e<=279?7:8;return Go(n)}(),Ko.RawInflate.FixedDistanceTable=function(){var e,t,n=new Uint8Array(30);for(e=0,t=n.length;e<t;++e)n[e]=5;return Go(n)}(),Ko.RawInflate.prototype.parseBlock=function(){var e=this.readBits(3);switch(1&e&&(this.bfinal=!0),e>>>=1){case 0:this.parseUncompressedBlock();break;case 1:this.parseFixedHuffmanBlock();break;case 2:this.parseDynamicHuffmanBlock();break;default:throw new Error("unknown BTYPE: "+e)}},Ko.RawInflate.prototype.readBits=function(e){var t,n=this.bitsbuf,i=this.bitsbuflen,r=this.input,o=this.ip;if(o+(e-i+7>>3)>=r.length)throw new Error("input buffer is broken");for(;i<e;)n|=r[o++]<<i,i+=8;return t=n&(1<<e)-1,n>>>=e,i-=e,this.bitsbuf=n,this.bitsbuflen=i,this.ip=o,t},Ko.RawInflate.prototype.readCodeByTable=function(e){for(var t,n,i=this.bitsbuf,r=this.bitsbuflen,o=this.input,a=this.ip,s=o.length,l=e[0],c=e[1];r<c&&!(a>=s);)i|=o[a++]<<r,r+=8;if((n=(t=l[i&(1<<c)-1])>>>16)>r)throw new Error("invalid code length: "+n);return this.bitsbuf=i>>n,this.bitsbuflen=r-n,this.ip=a,65535&t},Ko.RawInflate.prototype.parseUncompressedBlock=function(){var e,t,n=this.input,i=this.ip,r=this.output,o=this.op,a=n.length,s=r.length;if(this.bitsbuf=0,this.bitsbuflen=0,i+1>=a)throw new Error("invalid uncompressed block header: LEN");if(e=n[i++]|n[i++]<<8,i+1>=a)throw new Error("invalid uncompressed block header: NLEN");if(e===~(n[i++]|n[i++]<<8))throw new Error("invalid uncompressed block header: length verify");if(i+e>n.length)throw new Error("input buffer is broken");switch(this.bufferType){case Ko.RawInflate.BufferType.BLOCK:for(;o+e>r.length;)e-=t=s-o,r.set(n.subarray(i,i+t),o),o+=t,i+=t,this.op=o,r=this.expandBufferBlock(),o=this.op;break;case Ko.RawInflate.BufferType.ADAPTIVE:for(;o+e>r.length;)r=this.expandBufferAdaptive({fixRatio:2});break;default:throw new Error("invalid inflate mode")}r.set(n.subarray(i,i+e),o),o+=e,i+=e,this.ip=i,this.op=o,this.output=r},Ko.RawInflate.prototype.parseFixedHuffmanBlock=function(){switch(this.bufferType){case Ko.RawInflate.BufferType.ADAPTIVE:this.decodeHuffmanAdaptive(Ko.RawInflate.FixedLiteralLengthTable,Ko.RawInflate.FixedDistanceTable);break;case Ko.RawInflate.BufferType.BLOCK:this.decodeHuffmanBlock(Ko.RawInflate.FixedLiteralLengthTable,Ko.RawInflate.FixedDistanceTable);break;default:throw new Error("invalid inflate mode")}},Ko.RawInflate.prototype.parseDynamicHuffmanBlock=function(){var e,t,n,i,r,o,a,s,l,c=this.readBits(5)+257,h=this.readBits(5)+1,u=this.readBits(4)+4,f=new Uint8Array(Ko.RawInflate.Order.length);for(s=0;s<u;++s)f[Ko.RawInflate.Order[s]]=this.readBits(3);for(e=Go(f),i=new Uint8Array(c+h),s=0,l=c+h;s<l;)switch(r=this.readCodeByTable(e)){case 16:for(a=3+this.readBits(2);a--;)i[s++]=o;break;case 17:for(a=3+this.readBits(3);a--;)i[s++]=0;o=0;break;case 18:for(a=11+this.readBits(7);a--;)i[s++]=0;o=0;break;default:i[s++]=r,o=r}switch(t=Go(i.subarray(0,c)),n=Go(i.subarray(c)),this.bufferType){case Ko.RawInflate.BufferType.ADAPTIVE:this.decodeHuffmanAdaptive(t,n);break;case Ko.RawInflate.BufferType.BLOCK:this.decodeHuffmanBlock(t,n);break;default:throw new Error("invalid inflate mode")}},Ko.RawInflate.prototype.decodeHuffmanBlock=function(e,t){var n=this.output,i=this.op;this.currentLitlenTable=e;for(var r,o,a,s,l=n.length-Ko.RawInflate.MaxCopyLength,c=Ko.RawInflate.LengthCodeTable,h=Ko.RawInflate.LengthExtraTable,u=Ko.RawInflate.DistCodeTable,f=Ko.RawInflate.DistExtraTable;256!==(r=this.readCodeByTable(e));)if(r<256)i>=l&&(this.op=i,n=this.expandBufferBlock(),i=this.op),n[i++]=r;else for(s=c[o=r-257],h[o]>0&&(s+=this.readBits(h[o])),a=u[r=this.readCodeByTable(t)],f[r]>0&&(a+=this.readBits(f[r])),i>=l&&(this.op=i,n=this.expandBufferBlock(),i=this.op);s--;)n[i]=n[i++-a];for(;this.bitsbuflen>=8;)this.bitsbuflen-=8,this.ip--;this.op=i},Ko.RawInflate.prototype.decodeHuffmanAdaptive=function(e,t){var n=this.output,i=this.op;this.currentLitlenTable=e;for(var r,o,a,s,l=n.length,c=Ko.RawInflate.LengthCodeTable,h=Ko.RawInflate.LengthExtraTable,u=Ko.RawInflate.DistCodeTable,f=Ko.RawInflate.DistExtraTable;256!==(r=this.readCodeByTable(e));)if(r<256)i>=l&&(l=(n=this.expandBufferAdaptive()).length),n[i++]=r;else for(s=c[o=r-257],h[o]>0&&(s+=this.readBits(h[o])),a=u[r=this.readCodeByTable(t)],f[r]>0&&(a+=this.readBits(f[r])),i+s>l&&(l=(n=this.expandBufferAdaptive()).length);s--;)n[i]=n[i++-a];for(;this.bitsbuflen>=8;)this.bitsbuflen-=8,this.ip--;this.op=i},Ko.RawInflate.prototype.expandBufferBlock=function(e){var t=new Uint8Array(this.op-Ko.RawInflate.MaxBackwardLength),n=this.op-Ko.RawInflate.MaxBackwardLength,i=this.output;return t.set(i.subarray(Ko.RawInflate.MaxBackwardLength,t.length)),this.blocks.push(t),this.totalpos+=t.length,i.set(i.subarray(n,n+Ko.RawInflate.MaxBackwardLength)),this.op=Ko.RawInflate.MaxBackwardLength,i},Ko.RawInflate.prototype.expandBufferAdaptive=function(e){var t,n,i,r=this.input.length/this.ip+1|0,o=this.input,a=this.output;return e&&("number"==typeof e.fixRatio&&(r=e.fixRatio),"number"==typeof e.addRatio&&(r+=e.addRatio)),n=r<2?(i=(o.length-this.ip)/this.currentLitlenTable[2]/2*258|0)<a.length?a.length+i:a.length<<1:a.length*r,(t=new Uint8Array(n)).set(a),this.output=t,this.output},Ko.RawInflate.prototype.concatBufferBlock=function(){var e,t,n,i,r,o=0,a=this.totalpos+(this.op-Ko.RawInflate.MaxBackwardLength),s=this.output,l=this.blocks,c=new Uint8Array(a);if(0===l.length)return this.output.subarray(Ko.RawInflate.MaxBackwardLength,this.op);for(t=0,n=l.length;t<n;++t)for(i=0,r=(e=l[t]).length;i<r;++i)c[o++]=e[i];for(t=Ko.RawInflate.MaxBackwardLength,n=this.op;t<n;++t)c[o++]=s[t];return this.blocks=[],this.buffer=c,this.buffer},Ko.RawInflate.prototype.concatBufferDynamic=function(){var e,t=this.op;return this.resize?(e=new Uint8Array(t)).set(this.output.subarray(0,t)):e=this.output.subarray(0,t),this.buffer=e,this.buffer},Go=Ko.Huffman.buildHuffmanTable,Ko.RawInflateStream=function(e,t,n){this.blocks=[],this.bufferSize=n||65e3,this.totalpos=0,this.ip=void 0===t?0:t,this.bitsbuf=0,this.bitsbuflen=0,this.input=new Uint8Array(e),this.output=new Uint8Array(this.bufferSize),this.op=0,this.bfinal=!1,this.blockLength,this.resize=!1,this.litlenTable,this.distTable,this.sp=0,this.status=Ko.RawInflateStream.Status.INITIALIZED,this.ip_,this.bitsbuflen_,this.bitsbuf_},Ko.RawInflateStream.BlockType={UNCOMPRESSED:0,FIXED:1,DYNAMIC:2},Ko.RawInflateStream.Status={INITIALIZED:0,BLOCK_HEADER_START:1,BLOCK_HEADER_END:2,BLOCK_BODY_START:3,BLOCK_BODY_END:4,DECODE_BLOCK_START:5,DECODE_BLOCK_END:6},Ko.RawInflateStream.prototype.decompress=function(e,t){var n=!1;for(void 0!==e&&(this.input=e),void 0!==t&&(this.ip=t);!n;)switch(this.status){case Ko.RawInflateStream.Status.INITIALIZED:case Ko.RawInflateStream.Status.BLOCK_HEADER_START:this.readBlockHeader()<0&&(n=!0);break;case Ko.RawInflateStream.Status.BLOCK_HEADER_END:case Ko.RawInflateStream.Status.BLOCK_BODY_START:switch(this.currentBlockType){case Ko.RawInflateStream.BlockType.UNCOMPRESSED:this.readUncompressedBlockHeader()<0&&(n=!0);break;case Ko.RawInflateStream.BlockType.FIXED:this.parseFixedHuffmanBlock()<0&&(n=!0);break;case Ko.RawInflateStream.BlockType.DYNAMIC:this.parseDynamicHuffmanBlock()<0&&(n=!0)}break;case Ko.RawInflateStream.Status.BLOCK_BODY_END:case Ko.RawInflateStream.Status.DECODE_BLOCK_START:switch(this.currentBlockType){case Ko.RawInflateStream.BlockType.UNCOMPRESSED:this.parseUncompressedBlock()<0&&(n=!0);break;case Ko.RawInflateStream.BlockType.FIXED:case Ko.RawInflateStream.BlockType.DYNAMIC:this.decodeHuffman()<0&&(n=!0)}break;case Ko.RawInflateStream.Status.DECODE_BLOCK_END:this.bfinal?n=!0:this.status=Ko.RawInflateStream.Status.INITIALIZED}return this.concatBuffer()},Ko.RawInflateStream.MaxBackwardLength=32768,Ko.RawInflateStream.MaxCopyLength=258,Ko.RawInflateStream.Order=new Uint16Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Ko.RawInflateStream.LengthCodeTable=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258]),Ko.RawInflateStream.LengthExtraTable=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0]),Ko.RawInflateStream.DistCodeTable=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577]),Ko.RawInflateStream.DistExtraTable=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),Ko.RawInflateStream.FixedLiteralLengthTable=function(){var e,t,n=new Uint8Array(288);for(e=0,t=n.length;e<t;++e)n[e]=e<=143?8:e<=255?9:e<=279?7:8;return Go(n)}(),Ko.RawInflateStream.FixedDistanceTable=function(){var e,t,n=new Uint8Array(30);for(e=0,t=n.length;e<t;++e)n[e]=5;return Go(n)}(),Ko.RawInflateStream.prototype.readBlockHeader=function(){var e;if(this.status=Ko.RawInflateStream.Status.BLOCK_HEADER_START,this.save_(),(e=this.readBits(3))<0)return this.restore_(),-1;switch(1&e&&(this.bfinal=!0),e>>>=1){case 0:this.currentBlockType=Ko.RawInflateStream.BlockType.UNCOMPRESSED;break;case 1:this.currentBlockType=Ko.RawInflateStream.BlockType.FIXED;break;case 2:this.currentBlockType=Ko.RawInflateStream.BlockType.DYNAMIC;break;default:throw new Error("unknown BTYPE: "+e)}this.status=Ko.RawInflateStream.Status.BLOCK_HEADER_END},Ko.RawInflateStream.prototype.readBits=function(e){for(var t,n=this.bitsbuf,i=this.bitsbuflen,r=this.input,o=this.ip;i<e;){if(r.length<=o)return-1;n|=(t=r[o++])<<i,i+=8}return t=n&(1<<e)-1,n>>>=e,i-=e,this.bitsbuf=n,this.bitsbuflen=i,this.ip=o,t},Ko.RawInflateStream.prototype.readCodeByTable=function(e){for(var t,n,i=this.bitsbuf,r=this.bitsbuflen,o=this.input,a=this.ip,s=e[0],l=e[1];r<l;){if(o.length<=a)return-1;i|=o[a++]<<r,r+=8}if((n=(t=s[i&(1<<l)-1])>>>16)>r)throw new Error("invalid code length: "+n);return this.bitsbuf=i>>n,this.bitsbuflen=r-n,this.ip=a,65535&t},Ko.RawInflateStream.prototype.readUncompressedBlockHeader=function(){var e,t=this.input,n=this.ip;if(this.status=Ko.RawInflateStream.Status.BLOCK_BODY_START,n+4>=t.length)return-1;if((e=t[n++]|t[n++]<<8)==~(t[n++]|t[n++]<<8))throw new Error("invalid uncompressed block header: length verify");this.bitsbuf=0,this.bitsbuflen=0,this.ip=n,this.blockLength=e,this.status=Ko.RawInflateStream.Status.BLOCK_BODY_END},Ko.RawInflateStream.prototype.parseUncompressedBlock=function(){var e=this.input,t=this.ip,n=this.output,i=this.op,r=this.blockLength;for(this.status=Ko.RawInflateStream.Status.DECODE_BLOCK_START;r--;){if(i===n.length&&(n=this.expandBuffer({fixRatio:2})),t>=e.length)return this.ip=t,this.op=i,this.blockLength=r+1,-1;n[i++]=e[t++]}return r<0&&(this.status=Ko.RawInflateStream.Status.DECODE_BLOCK_END),this.ip=t,this.op=i,0},Ko.RawInflateStream.prototype.parseFixedHuffmanBlock=function(){return this.status=Ko.RawInflateStream.Status.BLOCK_BODY_START,this.litlenTable=Ko.RawInflateStream.FixedLiteralLengthTable,this.distTable=Ko.RawInflateStream.FixedDistanceTable,this.status=Ko.RawInflateStream.Status.BLOCK_BODY_END,0},Ko.RawInflateStream.prototype.save_=function(){this.ip_=this.ip,this.bitsbuflen_=this.bitsbuflen,this.bitsbuf_=this.bitsbuf},Ko.RawInflateStream.prototype.restore_=function(){this.ip=this.ip_,this.bitsbuflen=this.bitsbuflen_,this.bitsbuf=this.bitsbuf_},Ko.RawInflateStream.prototype.parseDynamicHuffmanBlock=function(){var e,t,n,i,r=new Uint8Array(Ko.RawInflateStream.Order.length);if(this.status=Ko.RawInflateStream.Status.BLOCK_BODY_START,this.save_(),e=this.readBits(5)+257,t=this.readBits(5)+1,n=this.readBits(4)+4,e<0||t<0||n<0)return this.restore_(),-1;try{(function(){var o,a,s,l,c,h,u=0;for(c=0;c<n;++c){if((o=this.readBits(3))<0)throw new Error("not enough input");r[Ko.RawInflateStream.Order[c]]=o}for(i=Go(r),l=new Uint8Array(e+t),c=0,h=e+t;c<h;){if((a=this.readCodeByTable(i))<0)throw new Error("not enough input");switch(a){case 16:if((o=this.readBits(2))<0)throw new Error("not enough input");for(s=3+o;s--;)l[c++]=u;break;case 17:if((o=this.readBits(3))<0)throw new Error("not enough input");for(s=3+o;s--;)l[c++]=0;u=0;break;case 18:if((o=this.readBits(7))<0)throw new Error("not enough input");for(s=11+o;s--;)l[c++]=0;u=0;break;default:l[c++]=a,u=a}}new Uint8Array(e),new Uint8Array(t),this.litlenTable=Go(l.subarray(0,e)),this.distTable=Go(l.subarray(e))}).call(this)}catch(e){return this.restore_(),-1}return this.status=Ko.RawInflateStream.Status.BLOCK_BODY_END,0},Ko.RawInflateStream.prototype.decodeHuffman=function(){var e,t,n,i,r,o=this.output,a=this.op,s=this.litlenTable,l=this.distTable,c=o.length;for(this.status=Ko.RawInflateStream.Status.DECODE_BLOCK_START;;){if(this.save_(),(e=this.readCodeByTable(s))<0)return this.op=a,this.restore_(),-1;if(256===e)break;if(e<256)a===c&&(c=(o=this.expandBuffer()).length),o[a++]=e;else{if(t=e-257,i=Ko.RawInflateStream.LengthCodeTable[t],Ko.RawInflateStream.LengthExtraTable[t]>0){if((r=this.readBits(Ko.RawInflateStream.LengthExtraTable[t]))<0)return this.op=a,this.restore_(),-1;i+=r}if((e=this.readCodeByTable(l))<0)return this.op=a,this.restore_(),-1;if(n=Ko.RawInflateStream.DistCodeTable[e],Ko.RawInflateStream.DistExtraTable[e]>0){if((r=this.readBits(Ko.RawInflateStream.DistExtraTable[e]))<0)return this.op=a,this.restore_(),-1;n+=r}for(a+i>=c&&(c=(o=this.expandBuffer()).length);i--;)o[a]=o[a++-n];if(this.ip===this.input.length)return this.op=a,-1}}for(;this.bitsbuflen>=8;)this.bitsbuflen-=8,this.ip--;this.op=a,this.status=Ko.RawInflateStream.Status.DECODE_BLOCK_END},Ko.RawInflateStream.prototype.expandBuffer=function(e){var t,n,i,r=this.input.length/this.ip+1|0,o=this.input,a=this.output;return e&&("number"==typeof e.fixRatio&&(r=e.fixRatio),"number"==typeof e.addRatio&&(r+=e.addRatio)),n=r<2?(i=(o.length-this.ip)/this.litlenTable[2]/2*258|0)<a.length?a.length+i:a.length<<1:a.length*r,(t=new Uint8Array(n)).set(a),this.output=t,this.output},Ko.RawInflateStream.prototype.concatBuffer=function(){var e,t,n=this.op;return e=this.resize?new Uint8Array(this.output.subarray(this.sp,n)):this.output.subarray(this.sp,n),this.sp=n,n>Ko.RawInflateStream.MaxBackwardLength+this.bufferSize&&(this.op=this.sp=Ko.RawInflateStream.MaxBackwardLength,t=this.output,this.output=new Uint8Array(this.bufferSize+Ko.RawInflateStream.MaxBackwardLength),this.output.set(t.subarray(n-Ko.RawInflateStream.MaxBackwardLength,n))),e},Ko.Inflate=function(e,t){var n,i;if(this.input=e,this.ip=0,this.rawinflate,this.verify,!t&&(t={})||(t.index&&(this.ip=t.index),t.verify&&(this.verify=t.verify)),n=e[this.ip++],i=e[this.ip++],(15&n)!==Ko.CompressionMethod.DEFLATE)throw new Error("unsupported compression method");if(this.method=Ko.CompressionMethod.DEFLATE,((n<<8)+i)%31!=0)throw new Error("invalid fcheck flag:"+((n<<8)+i)%31);if(32&i)throw new Error("fdict flag is not supported");this.rawinflate=new Ko.RawInflate(e,{index:this.ip,bufferSize:t.bufferSize,bufferType:t.bufferType,resize:t.resize})},Ko.Inflate.BufferType=Ko.RawInflate.BufferType,Ko.Inflate.prototype.decompress=function(){var e,t=this.input;if(e=this.rawinflate.decompress(),this.ip=this.rawinflate.ip,this.verify&&(t[this.ip++]<<24|t[this.ip++]<<16|t[this.ip++]<<8|t[this.ip++])>>>0!==Ko.Adler32(e))throw new Error("invalid adler-32 checksum");return e},Ko.InflateStream=function(e){this.input=void 0===e?new Uint8Array:e,this.ip=0,this.rawinflate=new Ko.RawInflateStream(this.input,this.ip),this.method,this.output=this.rawinflate.output},Ko.InflateStream.prototype.decompress=function(e){var t;if(void 0!==e){var n=new Uint8Array(this.input.length+e.length);n.set(this.input,0),n.set(e,this.input.length),this.input=n}return void 0===this.method&&this.readHeader()<0?new Uint8Array:(t=this.rawinflate.decompress(this.input,this.ip),0!==this.rawinflate.ip&&(this.input=this.input.subarray(this.rawinflate.ip),this.ip=0),t)},Ko.InflateStream.prototype.readHeader=function(){var e=this.ip,t=this.input,n=t[e++],i=t[e++];if(void 0===n||void 0===i)return-1;if((15&n)!==Ko.CompressionMethod.DEFLATE)throw new Error("unsupported compression method");if(this.method=Ko.CompressionMethod.DEFLATE,((n<<8)+i)%31!=0)throw new Error("invalid fcheck flag:"+((n<<8)+i)%31);if(32&i)throw new Error("fdict flag is not supported");this.ip=e},Ko.Gunzip=function(e,t){this.input=e,this.ip=0,this.member=[],this.decompressed=!1},Ko.Gunzip.prototype.getMembers=function(){return this.decompressed||this.decompress(),this.member.slice()},Ko.Gunzip.prototype.decompress=function(){for(var e=this.input.length;this.ip<e;)this.decodeMember();return this.decompressed=!0,this.concatMember()},Ko.Gunzip.prototype.decodeMember=function(){var e,t,n,i,r,o,a,s,l,c=new Ko.GunzipMember,h=this.input,u=this.ip;if(c.id1=h[u++],c.id2=h[u++],31!==c.id1||139!==c.id2)throw new Error("invalid file signature:"+c.id1+","+c.id2);if(c.cm=h[u++],8!==c.cm)throw new Error("unknown compression method: "+c.cm);if(c.flg=h[u++],s=h[u++]|h[u++]<<8|h[u++]<<16|h[u++]<<24,c.mtime=new Date(1e3*s),c.xfl=h[u++],c.os=h[u++],(c.flg&Ko.Gzip.FlagsMask.FEXTRA)>0&&(c.xlen=h[u++]|h[u++]<<8,u=this.decodeSubField(u,c.xlen)),(c.flg&Ko.Gzip.FlagsMask.FNAME)>0){for(a=[],o=0;(r=h[u++])>0;)a[o++]=String.fromCharCode(r);c.name=a.join("")}if((c.flg&Ko.Gzip.FlagsMask.FCOMMENT)>0){for(a=[],o=0;(r=h[u++])>0;)a[o++]=String.fromCharCode(r);c.comment=a.join("")}if((c.flg&Ko.Gzip.FlagsMask.FHCRC)>0&&(c.crc16=65535&Ko.CRC32.calc(h,0,u),c.crc16!==(h[u++]|h[u++]<<8)))throw new Error("invalid header crc16");if(e=h[h.length-4]|h[h.length-3]<<8|h[h.length-2]<<16|h[h.length-1]<<24,h.length-u-4-4<512*e&&(i=e),t=new Ko.RawInflate(h,{index:u,bufferSize:i}),c.data=n=t.decompress(),u=t.ip,c.crc32=l=(h[u++]|h[u++]<<8|h[u++]<<16|h[u++]<<24)>>>0,Ko.CRC32.calc(n)!==l)throw new Error("invalid CRC-32 checksum: 0x"+Ko.CRC32.calc(n).toString(16)+" / 0x"+l.toString(16));if(c.isize=e=(h[u++]|h[u++]<<8|h[u++]<<16|h[u++]<<24)>>>0,(4294967295&n.length)!==e)throw new Error("invalid input size: "+(4294967295&n.length)+" / "+e);this.member.push(c),this.ip=u},Ko.Gunzip.prototype.decodeSubField=function(e,t){return e+t},Ko.Gunzip.prototype.concatMember=function(){var e,t,n,i=this.member,r=0,o=0;for(e=0,t=i.length;e<t;++e)o+=i[e].data.length;for(n=new Uint8Array(o),e=0;e<t;++e)n.set(i[e].data,r),r+=i[e].data.length;return n},Ko.GunzipMember=function(){this.id1,this.id2,this.cm,this.flg,this.mtime,this.xfl,this.os,this.crc16,this.xlen,this.crc32,this.isize,this.name,this.comment,this.data},Ko.GunzipMember.prototype.getName=function(){return this.name},Ko.GunzipMember.prototype.getData=function(){return this.data},Ko.GunzipMember.prototype.getMtime=function(){return this.mtime},Ko.Gzip=function(e,t){this.input=e,this.ip=0,this.output,this.op=0,this.flags={},this.filename,this.comment,this.deflateOptions,t&&(t.flags&&(this.flags=t.flags),"string"==typeof t.filename&&(this.filename=t.filename),"string"==typeof t.comment&&(this.comment=t.comment),t.deflateOptions&&(this.deflateOptions=t.deflateOptions)),this.deflateOptions||(this.deflateOptions={})},Ko.Gzip.DefaultBufferSize=32768,Ko.Gzip.prototype.compress=function(){var e,t,n,i,r,o,a,s,l=new Uint8Array(Ko.Gzip.DefaultBufferSize),c=0,h=this.input,u=this.ip,f=this.filename,d=this.comment;if(l[c++]=31,l[c++]=139,l[c++]=8,e=0,this.flags.fname&&(e|=Ko.Gzip.FlagsMask.FNAME),this.flags.fcomment&&(e|=Ko.Gzip.FlagsMask.FCOMMENT),this.flags.fhcrc&&(e|=Ko.Gzip.FlagsMask.FHCRC),l[c++]=e,t=(Date.now?Date.now():+new Date)/1e3|0,l[c++]=255&t,l[c++]=t>>>8&255,l[c++]=t>>>16&255,l[c++]=t>>>24&255,l[c++]=0,l[c++]=Ko.Gzip.OperatingSystem.UNKNOWN,void 0!==this.flags.fname){for(a=0,s=f.length;a<s;++a)(o=f.charCodeAt(a))>255&&(l[c++]=o>>>8&255),l[c++]=255&o;l[c++]=0}if(this.flags.comment){for(a=0,s=d.length;a<s;++a)(o=d.charCodeAt(a))>255&&(l[c++]=o>>>8&255),l[c++]=255&o;l[c++]=0}return this.flags.fhcrc&&(n=65535&Ko.CRC32.calc(l,0,c),l[c++]=255&n,l[c++]=n>>>8&255),this.deflateOptions.outputBuffer=l,this.deflateOptions.outputIndex=c,l=(r=new Ko.RawDeflate(h,this.deflateOptions)).compress(),(c=r.op)+8>l.buffer.byteLength?(this.output=new Uint8Array(c+8),this.output.set(new Uint8Array(l.buffer)),l=this.output):l=new Uint8Array(l.buffer),i=Ko.CRC32.calc(h),l[c++]=255&i,l[c++]=i>>>8&255,l[c++]=i>>>16&255,l[c++]=i>>>24&255,s=h.length,l[c++]=255&s,l[c++]=s>>>8&255,l[c++]=s>>>16&255,l[c++]=s>>>24&255,this.ip=u,c<l.length&&(this.output=l=l.subarray(0,c)),l},Ko.Gzip.OperatingSystem={FAT:0,AMIGA:1,VMS:2,UNIX:3,VM_CMS:4,ATARI_TOS:5,HPFS:6,MACINTOSH:7,Z_SYSTEM:8,CP_M:9,TOPS_20:10,NTFS:11,QDOS:12,ACORN_RISCOS:13,UNKNOWN:255},Ko.Gzip.FlagsMask={FTEXT:1,FHCRC:2,FEXTRA:4,FNAME:8,FCOMMENT:16},Ko.Heap=function(e){this.buffer=new Uint16Array(2*e),this.length=0},Ko.Heap.prototype.getParent=function(e){return 2*((e-2)/4|0)},Ko.Heap.prototype.getChild=function(e){return 2*e+2},Ko.Heap.prototype.push=function(e,t){var n,i,r,o=this.buffer;for(n=this.length,o[this.length++]=t,o[this.length++]=e;n>0&&(i=this.getParent(n),o[n]>o[i]);)r=o[n],o[n]=o[i],o[i]=r,r=o[n+1],o[n+1]=o[i+1],o[i+1]=r,n=i;return this.length},Ko.Heap.prototype.pop=function(){var e,t,n,i,r,o=this.buffer;for(t=o[0],e=o[1],this.length-=2,o[0]=o[this.length],o[1]=o[this.length+1],r=0;!((i=this.getChild(r))>=this.length)&&(i+2<this.length&&o[i+2]>o[i]&&(i+=2),o[i]>o[r]);)n=o[r],o[r]=o[i],o[i]=n,n=o[r+1],o[r+1]=o[i+1],o[i+1]=n,r=i;return{index:e,value:t,length:this.length}},Ko.RawDeflate=function(e,t){this.compressionType=Ko.RawDeflate.CompressionType.DYNAMIC,this.lazy=0,this.freqsLitLen,this.freqsDist,this.input=e instanceof Array?new Uint8Array(e):e,this.output,this.op=0,t&&(t.lazy&&(this.lazy=t.lazy),"number"==typeof t.compressionType&&(this.compressionType=t.compressionType),t.outputBuffer&&(this.output=t.outputBuffer instanceof Array?new Uint8Array(t.outputBuffer):t.outputBuffer),"number"==typeof t.outputIndex&&(this.op=t.outputIndex)),this.output||(this.output=new Uint8Array(32768))},Ko.RawDeflate.CompressionType={NONE:0,FIXED:1,DYNAMIC:2,RESERVED:3},Ko.RawDeflate.Lz77MinLength=3,Ko.RawDeflate.Lz77MaxLength=258,Ko.RawDeflate.WindowSize=32768,Ko.RawDeflate.MaxCodeLength=16,Ko.RawDeflate.HUFMAX=286,Ko.RawDeflate.FixedHuffmanTable=function(){var e,t=[];for(e=0;e<288;e++)switch(!0){case e<=143:t.push([e+48,8]);break;case e<=255:t.push([e-144+400,9]);break;case e<=279:t.push([e-256+0,7]);break;case e<=287:t.push([e-280+192,8]);break;default:throw"invalid literal: "+e}return t}(),Ko.RawDeflate.prototype.compress=function(){var e,t,n,i=this.input;switch(this.compressionType){case Ko.RawDeflate.CompressionType.NONE:for(t=0,n=i.length;t<n;)t+=(e=i.subarray(t,t+65535)).length,this.makeNocompressBlock(e,t===n);break;case Ko.RawDeflate.CompressionType.FIXED:this.output=this.makeFixedHuffmanBlock(i,!0),this.op=this.output.length;break;case Ko.RawDeflate.CompressionType.DYNAMIC:this.output=this.makeDynamicHuffmanBlock(i,!0),this.op=this.output.length;break;default:throw"invalid compression type"}return this.output},Ko.RawDeflate.prototype.makeNocompressBlock=function(e,t){var n,i,r,o,a=this.output,s=this.op;for(a=new Uint8Array(this.output.buffer);a.length<=s+e.length+5;)a=new Uint8Array(a.length<<1);return a.set(this.output),n=t?1:0,i=Ko.RawDeflate.CompressionType.NONE,a[s++]=n|i<<1,o=65536+~(r=e.length)&65535,a[s++]=255&r,a[s++]=r>>>8&255,a[s++]=255&o,a[s++]=o>>>8&255,a.set(e,s),s+=e.length,a=a.subarray(0,s),this.op=s,this.output=a,a},Ko.RawDeflate.prototype.makeFixedHuffmanBlock=function(e,t){var n,i,r,o=new Ko.BitStream(new Uint8Array(this.output.buffer),this.op);return n=t?1:0,i=Ko.RawDeflate.CompressionType.FIXED,o.writeBits(n,1,!0),o.writeBits(i,2,!0),r=this.lz77(e),this.fixedHuffman(r,o),o.finish()},Ko.RawDeflate.prototype.makeDynamicHuffmanBlock=function(e,t){var n,i,r,o,a,s,l,c,h,u,f,d,p,g,m,_,v,b=new Ko.BitStream(new Uint8Array(this.output.buffer),this.op),y=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],w=new Array(19);for(n=t?1:0,i=Ko.RawDeflate.CompressionType.DYNAMIC,b.writeBits(n,1,!0),b.writeBits(i,2,!0),r=this.lz77(e),l=this.getLengths_(this.freqsLitLen,15),c=this.getCodesFromLengths_(l),h=this.getLengths_(this.freqsDist,7),u=this.getCodesFromLengths_(h),o=286;o>257&&0===l[o-1];o--);for(a=30;a>1&&0===h[a-1];a--);for(f=this.getTreeSymbols_(o,l,a,h),d=this.getLengths_(f.freqs,7),_=0;_<19;_++)w[_]=d[y[_]];for(s=19;s>4&&0===w[s-1];s--);for(p=this.getCodesFromLengths_(d),b.writeBits(o-257,5,!0),b.writeBits(a-1,5,!0),b.writeBits(s-4,4,!0),_=0;_<s;_++)b.writeBits(w[_],3,!0);for(_=0,v=f.codes.length;_<v;_++)if(g=f.codes[_],b.writeBits(p[g],d[g],!0),g>=16){switch(_++,g){case 16:m=2;break;case 17:m=3;break;case 18:m=7;break;default:throw"invalid code: "+g}b.writeBits(f.codes[_],m,!0)}return this.dynamicHuffman(r,[c,l],[u,h],b),b.finish()},Ko.RawDeflate.prototype.dynamicHuffman=function(e,t,n,i){var r,o,a,s,l,c,h,u;for(l=t[0],c=t[1],h=n[0],u=n[1],r=0,o=e.length;r<o;++r)if(a=e[r],i.writeBits(l[a],c[a],!0),a>256)i.writeBits(e[++r],e[++r],!0),s=e[++r],i.writeBits(h[s],u[s],!0),i.writeBits(e[++r],e[++r],!0);else if(256===a)break;return i},Ko.RawDeflate.prototype.fixedHuffman=function(e,t){var n,i,r;for(n=0,i=e.length;n<i;n++)if(r=e[n],Ko.BitStream.prototype.writeBits.apply(t,Ko.RawDeflate.FixedHuffmanTable[r]),r>256)t.writeBits(e[++n],e[++n],!0),t.writeBits(e[++n],5),t.writeBits(e[++n],e[++n],!0);else if(256===r)break;return t},Ko.RawDeflate.Lz77Match=function(e,t){this.length=e,this.backwardDistance=t},Ko.RawDeflate.Lz77Match.LengthCodeTable=function(e){return new Uint32Array(e)}(function(){var e,t,n=[];for(e=3;e<=258;e++)t=i(e),n[e]=t[2]<<24|t[1]<<16|t[0];function i(e){switch(!0){case 3===e:return[257,e-3,0];case 4===e:return[258,e-4,0];case 5===e:return[259,e-5,0];case 6===e:return[260,e-6,0];case 7===e:return[261,e-7,0];case 8===e:return[262,e-8,0];case 9===e:return[263,e-9,0];case 10===e:return[264,e-10,0];case e<=12:return[265,e-11,1];case e<=14:return[266,e-13,1];case e<=16:return[267,e-15,1];case e<=18:return[268,e-17,1];case e<=22:return[269,e-19,2];case e<=26:return[270,e-23,2];case e<=30:return[271,e-27,2];case e<=34:return[272,e-31,2];case e<=42:return[273,e-35,3];case e<=50:return[274,e-43,3];case e<=58:return[275,e-51,3];case e<=66:return[276,e-59,3];case e<=82:return[277,e-67,4];case e<=98:return[278,e-83,4];case e<=114:return[279,e-99,4];case e<=130:return[280,e-115,4];case e<=162:return[281,e-131,5];case e<=194:return[282,e-163,5];case e<=226:return[283,e-195,5];case e<=257:return[284,e-227,5];case 258===e:return[285,e-258,0];default:throw"invalid length: "+e}}return n}()),Ko.RawDeflate.Lz77Match.prototype.getDistanceCode_=function(e){var t;switch(!0){case 1===e:t=[0,e-1,0];break;case 2===e:t=[1,e-2,0];break;case 3===e:t=[2,e-3,0];break;case 4===e:t=[3,e-4,0];break;case e<=6:t=[4,e-5,1];break;case e<=8:t=[5,e-7,1];break;case e<=12:t=[6,e-9,2];break;case e<=16:t=[7,e-13,2];break;case e<=24:t=[8,e-17,3];break;case e<=32:t=[9,e-25,3];break;case e<=48:t=[10,e-33,4];break;case e<=64:t=[11,e-49,4];break;case e<=96:t=[12,e-65,5];break;case e<=128:t=[13,e-97,5];break;case e<=192:t=[14,e-129,6];break;case e<=256:t=[15,e-193,6];break;case e<=384:t=[16,e-257,7];break;case e<=512:t=[17,e-385,7];break;case e<=768:t=[18,e-513,8];break;case e<=1024:t=[19,e-769,8];break;case e<=1536:t=[20,e-1025,9];break;case e<=2048:t=[21,e-1537,9];break;case e<=3072:t=[22,e-2049,10];break;case e<=4096:t=[23,e-3073,10];break;case e<=6144:t=[24,e-4097,11];break;case e<=8192:t=[25,e-6145,11];break;case e<=12288:t=[26,e-8193,12];break;case e<=16384:t=[27,e-12289,12];break;case e<=24576:t=[28,e-16385,13];break;case e<=32768:t=[29,e-24577,13];break;default:throw"invalid distance"}return t},Ko.RawDeflate.Lz77Match.prototype.toLz77Array=function(){var e,t=this.length,n=this.backwardDistance,i=[],r=0;return e=Ko.RawDeflate.Lz77Match.LengthCodeTable[t],i[r++]=65535&e,i[r++]=e>>16&255,i[r++]=e>>24,e=this.getDistanceCode_(n),i[r++]=e[0],i[r++]=e[1],i[r++]=e[2],i},Ko.RawDeflate.prototype.lz77=function(e){var t,n,i,r,o,a,s,l,c,h={},u=Ko.RawDeflate.WindowSize,f=new Uint16Array(2*e.length),d=0,p=0,g=new Uint32Array(286),m=new Uint32Array(30),_=this.lazy;function v(e,t){var n,i,r=e.toLz77Array();for(n=0,i=r.length;n<i;++n)f[d++]=r[n];g[r[0]]++,m[r[3]]++,p=e.length+t-1,l=null}for(g[256]=1,t=0,n=e.length;t<n;++t){for(o=0,i=0,r=Ko.RawDeflate.Lz77MinLength;i<r&&t+i!==n;++i)o=o<<8|e[t+i];if(void 0===h[o]&&(h[o]=[]),a=h[o],p-- >0)a.push(t);else{for(;a.length>0&&t-a[0]>u;)a.shift();if(t+Ko.RawDeflate.Lz77MinLength>=n){for(l&&v(l,-1),i=0,r=n-t;i<r;++i)c=e[t+i],f[d++]=c,++g[c];break}a.length>0?(s=this.searchLongestMatch_(e,t,a),l?l.length<s.length?(c=e[t-1],f[d++]=c,++g[c],v(s,0)):v(l,-1):s.length<_?l=s:v(s,0)):l?v(l,-1):(c=e[t],f[d++]=c,++g[c]),a.push(t)}}return f[d++]=256,g[256]++,this.freqsLitLen=g,this.freqsDist=m,f.subarray(0,d)},Ko.RawDeflate.prototype.searchLongestMatch_=function(e,t,n){var i,r,o,a,s,l,c=0,h=e.length;e:for(a=0,l=n.length;a<l;a++){if(i=n[l-a-1],o=Ko.RawDeflate.Lz77MinLength,c>Ko.RawDeflate.Lz77MinLength){for(s=c;s>Ko.RawDeflate.Lz77MinLength;s--)if(e[i+s-1]!==e[t+s-1])continue e;o=c}for(;o<Ko.RawDeflate.Lz77MaxLength&&t+o<h&&e[i+o]===e[t+o];)++o;if(o>c&&(r=i,c=o),o===Ko.RawDeflate.Lz77MaxLength)break}return new Ko.RawDeflate.Lz77Match(c,t-r)},Ko.RawDeflate.prototype.getTreeSymbols_=function(e,t,n,i){var r,o,a,s,l,c,h=new Uint32Array(e+n),u=new Uint32Array(316),f=new Uint8Array(19);for(o=0,r=0;r<e;r++)h[o++]=t[r];for(r=0;r<n;r++)h[o++]=i[r];for(l=0,r=0,s=h.length;r<s;r+=o){for(o=1;r+o<s&&h[r+o]===h[r];++o);if(a=o,0===h[r])if(a<3)for(;a-- >0;)u[l++]=0,f[0]++;else for(;a>0;)(c=a<138?a:138)>a-3&&c<a&&(c=a-3),c<=10?(u[l++]=17,u[l++]=c-3,f[17]++):(u[l++]=18,u[l++]=c-11,f[18]++),a-=c;else if(u[l++]=h[r],f[h[r]]++,--a<3)for(;a-- >0;)u[l++]=h[r],f[h[r]]++;else for(;a>0;)(c=a<6?a:6)>a-3&&c<a&&(c=a-3),u[l++]=16,u[l++]=c-3,f[16]++,a-=c}return{codes:u.subarray(0,l),freqs:f}},Ko.RawDeflate.prototype.getLengths_=function(e,t){var n,i,r,o,a,s=e.length,l=new Ko.Heap(2*Ko.RawDeflate.HUFMAX),c=new Uint8Array(s);for(o=0;o<s;++o)e[o]>0&&l.push(o,e[o]);if(n=new Array(l.length/2),i=new Uint32Array(l.length/2),1===n.length)return c[l.pop().index]=1,c;for(o=0,a=l.length/2;o<a;++o)n[o]=l.pop(),i[o]=n[o].value;for(r=this.reversePackageMerge_(i,i.length,t),o=0,a=n.length;o<a;++o)c[n[o].index]=r[o];return c},Ko.RawDeflate.prototype.reversePackageMerge_=function(e,t,n){var i,r,o,a,s,l=new Uint16Array(n),c=new Uint8Array(n),h=new Uint8Array(t),u=new Array(n),f=new Array(n),d=new Array(n),p=(1<<n)-t,g=1<<n-1;function m(e){var n=f[e][d[e]];n===t?(m(e+1),m(e+1)):--h[n],++d[e]}for(l[n-1]=t,r=0;r<n;++r)p<g?c[r]=0:(c[r]=1,p-=g),p<<=1,l[n-2-r]=(l[n-1-r]/2|0)+t;for(l[0]=c[0],u[0]=new Array(l[0]),f[0]=new Array(l[0]),r=1;r<n;++r)l[r]>2*l[r-1]+c[r]&&(l[r]=2*l[r-1]+c[r]),u[r]=new Array(l[r]),f[r]=new Array(l[r]);for(i=0;i<t;++i)h[i]=n;for(o=0;o<l[n-1];++o)u[n-1][o]=e[o],f[n-1][o]=o;for(i=0;i<n;++i)d[i]=0;for(1===c[n-1]&&(--h[0],++d[n-1]),r=n-2;r>=0;--r){for(i=0,a=0,s=d[r+1],o=0;o<l[r];o++)(a=u[r+1][s]+u[r+1][s+1])>e[i]?(u[r][o]=a,f[r][o]=t,s+=2):(u[r][o]=e[i],f[r][o]=i,++i);d[r]=0,1===c[r]&&m(r)}return h},Ko.RawDeflate.prototype.getCodesFromLengths_=function(e){var t,n,i,r,o=new Uint16Array(e.length),a=[],s=[],l=0;for(t=0,n=e.length;t<n;t++)a[e[t]]=1+(0|a[e[t]]);for(t=1,n=Ko.RawDeflate.MaxCodeLength;t<=n;t++)s[t]=l,l+=0|a[t],l<<=1;for(t=0,n=e.length;t<n;t++)for(l=s[e[t]],s[e[t]]+=1,o[t]=0,i=0,r=e[t];i<r;i++)o[t]=o[t]<<1|1&l,l>>>=1;return o},Ko.Unzip=function(e,t){t=t||{},this.input=e instanceof Array?new Uint8Array(e):e,this.ip=0,this.eocdrOffset,this.numberOfThisDisk,this.startDisk,this.totalEntriesThisDisk,this.totalEntries,this.centralDirectorySize,this.centralDirectoryOffset,this.commentLength,this.comment,this.fileHeaderList,this.filenameToIndex,this.verify=t.verify||!1,this.password=t.password},Ko.Unzip.CompressionMethod=Ko.Zip.CompressionMethod,Ko.Unzip.FileHeaderSignature=Ko.Zip.FileHeaderSignature,Ko.Unzip.LocalFileHeaderSignature=Ko.Zip.LocalFileHeaderSignature,Ko.Unzip.CentralDirectorySignature=Ko.Zip.CentralDirectorySignature,Ko.Unzip.FileHeader=function(e,t){this.input=e,this.offset=t,this.length,this.version,this.os,this.needVersion,this.flags,this.compression,this.time,this.date,this.crc32,this.compressedSize,this.plainSize,this.fileNameLength,this.extraFieldLength,this.fileCommentLength,this.diskNumberStart,this.internalFileAttributes,this.externalFileAttributes,this.relativeOffset,this.filename,this.extraField,this.comment},Ko.Unzip.FileHeader.prototype.parse=function(){var e=this.input,t=this.offset;if(e[t++]!==Ko.Unzip.FileHeaderSignature[0]||e[t++]!==Ko.Unzip.FileHeaderSignature[1]||e[t++]!==Ko.Unzip.FileHeaderSignature[2]||e[t++]!==Ko.Unzip.FileHeaderSignature[3])throw new Error("invalid file header signature");this.version=e[t++],this.os=e[t++],this.needVersion=e[t++]|e[t++]<<8,this.flags=e[t++]|e[t++]<<8,this.compression=e[t++]|e[t++]<<8,this.time=e[t++]|e[t++]<<8,this.date=e[t++]|e[t++]<<8,this.crc32=(e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24)>>>0,this.compressedSize=(e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24)>>>0,this.plainSize=(e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24)>>>0,this.fileNameLength=e[t++]|e[t++]<<8,this.extraFieldLength=e[t++]|e[t++]<<8,this.fileCommentLength=e[t++]|e[t++]<<8,this.diskNumberStart=e[t++]|e[t++]<<8,this.internalFileAttributes=e[t++]|e[t++]<<8,this.externalFileAttributes=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24,this.relativeOffset=(e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24)>>>0,this.filename=String.fromCharCode.apply(null,e.subarray(t,t+=this.fileNameLength)),this.extraField=e.subarray(t,t+=this.extraFieldLength),this.comment=e.subarray(t,t+this.fileCommentLength),this.length=t-this.offset},Ko.Unzip.LocalFileHeader=function(e,t){this.input=e,this.offset=t,this.length,this.needVersion,this.flags,this.compression,this.time,this.date,this.crc32,this.compressedSize,this.plainSize,this.fileNameLength,this.extraFieldLength,this.filename,this.extraField},Ko.Unzip.LocalFileHeader.Flags=Ko.Zip.Flags,Ko.Unzip.LocalFileHeader.prototype.parse=function(){var e=this.input,t=this.offset;if(e[t++]!==Ko.Unzip.LocalFileHeaderSignature[0]||e[t++]!==Ko.Unzip.LocalFileHeaderSignature[1]||e[t++]!==Ko.Unzip.LocalFileHeaderSignature[2]||e[t++]!==Ko.Unzip.LocalFileHeaderSignature[3])throw new Error("invalid local file header signature");this.needVersion=e[t++]|e[t++]<<8,this.flags=e[t++]|e[t++]<<8,this.compression=e[t++]|e[t++]<<8,this.time=e[t++]|e[t++]<<8,this.date=e[t++]|e[t++]<<8,this.crc32=(e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24)>>>0,this.compressedSize=(e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24)>>>0,this.plainSize=(e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24)>>>0,this.fileNameLength=e[t++]|e[t++]<<8,this.extraFieldLength=e[t++]|e[t++]<<8,this.filename=String.fromCharCode.apply(null,e.subarray(t,t+=this.fileNameLength)),this.extraField=e.subarray(t,t+=this.extraFieldLength),this.length=t-this.offset},Ko.Unzip.prototype.searchEndOfCentralDirectoryRecord=function(){var e,t=this.input;for(e=t.length-12;e>0;--e)if(t[e]===Ko.Unzip.CentralDirectorySignature[0]&&t[e+1]===Ko.Unzip.CentralDirectorySignature[1]&&t[e+2]===Ko.Unzip.CentralDirectorySignature[2]&&t[e+3]===Ko.Unzip.CentralDirectorySignature[3])return void(this.eocdrOffset=e);throw new Error("End of Central Directory Record not found")},Ko.Unzip.prototype.parseEndOfCentralDirectoryRecord=function(){var e,t=this.input;if(this.eocdrOffset||this.searchEndOfCentralDirectoryRecord(),e=this.eocdrOffset,t[e++]!==Ko.Unzip.CentralDirectorySignature[0]||t[e++]!==Ko.Unzip.CentralDirectorySignature[1]||t[e++]!==Ko.Unzip.CentralDirectorySignature[2]||t[e++]!==Ko.Unzip.CentralDirectorySignature[3])throw new Error("invalid signature");this.numberOfThisDisk=t[e++]|t[e++]<<8,this.startDisk=t[e++]|t[e++]<<8,this.totalEntriesThisDisk=t[e++]|t[e++]<<8,this.totalEntries=t[e++]|t[e++]<<8,this.centralDirectorySize=(t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24)>>>0,this.centralDirectoryOffset=(t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24)>>>0,this.commentLength=t[e++]|t[e++]<<8,this.comment=t.subarray(e,e+this.commentLength)},Ko.Unzip.prototype.parseFileHeader=function(){var e,t,n,i,r=[],o={};if(!this.fileHeaderList){for(void 0===this.centralDirectoryOffset&&this.parseEndOfCentralDirectoryRecord(),e=this.centralDirectoryOffset,n=0,i=this.totalEntries;n<i;++n)(t=new Ko.Unzip.FileHeader(this.input,e)).parse(),e+=t.length,r[n]=t,o[t.filename]=n;if(this.centralDirectorySize<e-this.centralDirectoryOffset)throw new Error("invalid file header size");this.fileHeaderList=r,this.filenameToIndex=o}},Ko.Unzip.prototype.getFileData=function(e,t){t=t||{};var n,i,r,o,a,s,l,c,h=this.input,u=this.fileHeaderList;if(u||this.parseFileHeader(),void 0===u[e])throw new Error("wrong index");if(i=u[e].relativeOffset,(n=new Ko.Unzip.LocalFileHeader(this.input,i)).parse(),i+=n.length,r=n.compressedSize,0!=(n.flags&Ko.Unzip.LocalFileHeader.Flags.ENCRYPT)){if(!t.password&&!this.password)throw new Error("please set password");for(s=this.createDecryptionKey(t.password||this.password),l=i,c=i+12;l<c;++l)this.decode(s,h[l]);for(l=i+=12,c=i+(r-=12);l<c;++l)h[l]=this.decode(s,h[l])}switch(n.compression){case Ko.Unzip.CompressionMethod.STORE:o=this.input.subarray(i,i+r);break;case Ko.Unzip.CompressionMethod.DEFLATE:o=new Ko.RawInflate(this.input,{index:i,bufferSize:n.plainSize}).decompress();break;default:throw new Error("unknown compression type")}if(this.verify&&(a=Ko.CRC32.calc(o),n.crc32!==a))throw new Error("wrong crc: file=0x"+n.crc32.toString(16)+", data=0x"+a.toString(16));return o},Ko.Unzip.prototype.getFilenames=function(){var e,t,n,i=[];for(this.fileHeaderList||this.parseFileHeader(),e=0,t=(n=this.fileHeaderList).length;e<t;++e)i[e]=n[e].filename;return i},Ko.Unzip.prototype.decompress=function(e,t){var n;if(this.filenameToIndex||this.parseFileHeader(),void 0===(n=this.filenameToIndex[e]))throw new Error(e+" not found");return this.getFileData(n,t)},Ko.Unzip.prototype.setPassword=function(e){this.password=e},Ko.Unzip.prototype.decode=function(e,t){return t^=this.getByte(e),this.updateKeys(e,t),t},Ko.Unzip.prototype.updateKeys=Ko.Zip.prototype.updateKeys,Ko.Unzip.prototype.createDecryptionKey=Ko.Zip.prototype.createEncryptionKey,Ko.Unzip.prototype.getByte=Ko.Zip.prototype.getByte,Ko.Util.stringToByteArray=function(e){var t,n,i=e.split("");for(t=0,n=i.length;t<n;t++)i[t]=(255&i[t].charCodeAt(0))>>>0;return i},Ko.Adler32=function(e){return"string"==typeof e&&(e=Ko.Util.stringToByteArray(e)),Ko.Adler32.update(1,e)},Ko.Adler32.update=function(e,t){for(var n,i=65535&e,r=e>>>16&65535,o=t.length,a=0;o>0;){o-=n=o>Ko.Adler32.OptimizationParameter?Ko.Adler32.OptimizationParameter:o;do{r+=i+=t[a++]}while(--n);i%=65521,r%=65521}return(r<<16|i)>>>0},Ko.Adler32.OptimizationParameter=1024,Ko.BitStream=function(e,t){if(this.index="number"==typeof t?t:0,this.bitindex=0,this.buffer=e instanceof Uint8Array?e:new Uint8Array(Ko.BitStream.DefaultBlockSize),2*this.buffer.length<=this.index)throw new Error("invalid index");this.buffer.length<=this.index&&this.expandBuffer()},Ko.BitStream.DefaultBlockSize=32768,Ko.BitStream.prototype.expandBuffer=function(){var e=this.buffer,t=e.length,n=new Uint8Array(t<<1);return n.set(e),this.buffer=n},Ko.BitStream.prototype.writeBits=function(e,t,n){var i,r=this.buffer,o=this.index,a=this.bitindex,s=r[o];if(n&&t>1&&(e=t>8?function(e){return Ko.BitStream.ReverseTable[255&e]<<24|Ko.BitStream.ReverseTable[e>>>8&255]<<16|Ko.BitStream.ReverseTable[e>>>16&255]<<8|Ko.BitStream.ReverseTable[e>>>24&255]}(e)>>32-t:Ko.BitStream.ReverseTable[e]>>8-t),t+a<8)s=s<<t|e,a+=t;else for(i=0;i<t;++i)s=s<<1|e>>t-i-1&1,8==++a&&(a=0,r[o++]=Ko.BitStream.ReverseTable[s],s=0,o===r.length&&(r=this.expandBuffer()));r[o]=s,this.buffer=r,this.bitindex=a,this.index=o},Ko.BitStream.prototype.finish=function(){var e=this.buffer,t=this.index;return this.bitindex>0&&(e[t]<<=8-this.bitindex,e[t]=Ko.BitStream.ReverseTable[e[t]],t++),e.subarray(0,t)},Ko.BitStream.ReverseTable=function(){var e,t=new Uint8Array(256);for(e=0;e<256;++e)t[e]=function(e){var t=e,n=7;for(e>>>=1;e;e>>>=1)t<<=1,t|=1&e,--n;return(t<<n&255)>>>0}(e);return t}(),Ko.CRC32.calc=function(e,t,n){return Ko.CRC32.update(e,0,t,n)},Ko.CRC32.update=function(e,t,n,i){var r=Ko.CRC32.Table,o="number"==typeof n?n:n=0,a="number"==typeof i?i:e.length;for(t^=4294967295,o=7&a;o--;++n)t=t>>>8^r[255&(t^e[n])];for(o=a>>3;o--;n+=8)t=(t=(t=(t=(t=(t=(t=(t=t>>>8^r[255&(t^e[n])])>>>8^r[255&(t^e[n+1])])>>>8^r[255&(t^e[n+2])])>>>8^r[255&(t^e[n+3])])>>>8^r[255&(t^e[n+4])])>>>8^r[255&(t^e[n+5])])>>>8^r[255&(t^e[n+6])])>>>8^r[255&(t^e[n+7])];return(4294967295^t)>>>0},Ko.CRC32.single=function(e,t){return(Ko.CRC32.Table[255&(e^t)]^e>>>8)>>>0},Ko.CRC32.Table_=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],Ko.CRC32.Table=new Uint32Array(Ko.CRC32.Table_),Ko.Deflate=function(e,t){this.input=e,this.output=new Uint8Array(Ko.Deflate.DefaultBufferSize),this.compressionType=Ko.Deflate.CompressionType.DYNAMIC,this.rawDeflate;var n,i={};for(n in!t&&(t={})||"number"==typeof t.compressionType&&(this.compressionType=t.compressionType),t)i[n]=t[n];i.outputBuffer=this.output,this.rawDeflate=new Ko.RawDeflate(this.input,i)},Ko.Deflate.DefaultBufferSize=32768,Ko.Deflate.CompressionType=Ko.RawDeflate.CompressionType,Ko.Deflate.compress=function(e,t){return new Ko.Deflate(e,t).compress()},Ko.Deflate.prototype.compress=function(){var e,t,n,i,r,o,a=0;if(o=this.output,(e=Ko.CompressionMethod.DEFLATE)!==Ko.CompressionMethod.DEFLATE)throw new Error("invalid compression method");if(t=Math.LOG2E*Math.log(Ko.RawDeflate.WindowSize)-8<<4|e,o[a++]=t,e!==Ko.CompressionMethod.DEFLATE)throw new Error("invalid compression method");switch(this.compressionType){case Ko.Deflate.CompressionType.NONE:i=0;break;case Ko.Deflate.CompressionType.FIXED:i=1;break;case Ko.Deflate.CompressionType.DYNAMIC:i=2;break;default:throw new Error("unsupported compression type")}return n=i<<6|0,n|=31-(256*t+n)%31,o[a++]=n,r=Ko.Adler32(this.input),this.rawDeflate.op=a,a=(o=this.rawDeflate.compress()).length,(o=new Uint8Array(o.buffer)).length<=a+4&&(this.output=new Uint8Array(o.length+4),this.output.set(o),o=this.output),(o=o.subarray(0,a+4))[a++]=r>>24&255,o[a++]=r>>16&255,o[a++]=r>>8&255,o[a++]=255&r,o};let Zo=!1;try{navigator}catch(hs){Zo=!0}class Xo{static load(e,t){return new Promise((function(n,i){var r,o,a,s,l=new XMLHttpRequest,c=t.sendData,h=t.method||(c?"POST":"GET"),u=t.range,f=t.responseType,d=t.contentType,p=t.mimeType,g=t.headers,m=(!Zo&&0==navigator.vendor.indexOf("Apple")&&/\sSafari\//.test(navigator.userAgent),t.withCredentials);if(l.open(h,e),u){var _=u.size?u.start+u.size-1:"";l.setRequestHeader("Range","bytes="+u.start+"-"+_)}if(d&&l.setRequestHeader("Content-Type",d),p&&l.overrideMimeType(p),f&&(l.responseType=f),g)for(r=Object.keys(g),s=0;s<r.length;s++)a=g[o=r[s]],l.setRequestHeader(o,a);!0===m&&(l.withCredentials=!0),l.timeout=3e4,l.onload=function(t){0==l.status||l.status>=200&&l.status<=300?u&&206!=l.status?v("ERROR: range-byte header was ignored for url: "+e):n(l.response,l):416===l.status?v("Unsatisfiable range"):v("Error accessing resource: "+l.status)},l.onerror=function(t){v("Error accessing resource: "+e+" Status: "+l.status)},l.ontimeout=function(e){v("Timed out")},l.onabort=function(e){console.log("Aborted"),i(new igv.AbortLoad)};try{l.send(c)}catch(e){i(e)}function v(e){if(!i)throw Error(e);i(e)}}))}static loadArrayBuffer(e,t){return void 0===t&&(t={}),t.responseType="arraybuffer",Xo.load(e,t)}static loadJson(e,t){return"POST"==(t.method||(t.sendData?"POST":"GET"))&&(t.contentType="application/json"),new Promise((function(n,i){Xo.load(e,t).then((function(e){n(e?JSON.parse(e):e)})).catch(i)}))}static loadString(e,t){var n,i,r;return void 0===t&&(t={}),i=(r=e.indexOf("?"))>0?e.substring(0,r):e,0==(n=t.bgz?2:i.endsWith(".gz")?1:0)?(t.mimeType="text/plain; charset=x-user-defined",Xo.load(e,t)):(t.responseType="arraybuffer",new Promise((function(i,r){Xo.load(e,t).then((function(e){var t=Xo.arrayBufferToString(e,n);i(t)})).catch(r)})))}static loadStringFromFile(e,t){return new Promise((function(n,i){var r=new FileReader;t.range,r.onload=function(i){var o,a;o=t.bgz?2:e.name.endsWith(".gz")?1:0,a=Xo.arrayBufferToString(r.result,o),n(a,e)},r.onerror=function(t){console.log("reject uploading local file "+e.name),i(null,r)},r.readAsArrayBuffer(e)}))}static isCrossDomain(e){var t=window.location.origin;return!e.startsWith(t)}static arrayBufferToString(e,t){for(var n,i="",r=0,o=(n=1===t?new Ko.Gunzip(new Uint8Array(e)).decompress():2===t?new Uint8Array(Yo(e)):new Uint8Array(e)).length;r<o;r++)i+=String.fromCharCode(n[r]);return i}}let Yo=function(e,t){var n=[],i=[0],r=0;t=t||e.byteLength-18;const o=[];for(;i[0]<t;){var a=new Uint8Array(e,i[0],18),s=a[11]<<8|a[10],l=(a[12],a[13],a[15],a[14],a[17]<<8|a[16]+1);o.push(l);var c=12+s+i[0],h=e.byteLength-c;if(h<l+8)break;var u=Vo(e,c,h,i);i[0]+=8,r+=u.byteLength,n.push(u)}if(1==n.length)return n.blockLengths=o,n[0];for(var f=new Uint8Array(r),d=0,p=0;p<n.length;++p){var g=new Uint8Array(n[p]);Wo(g,0,f,d,g.length),d+=g.length}return f.buffer.blockLengths=o,f.buffer};class Qo{constructor(e,t,n){this.path=e.url,this.contentLength=t,this.bufferSize=n||512e3,this.range={start:-1,size:-1},this.config=e}dataViewForRange(e,t){var n=this;return new Promise((function(i,r){var o,a;function s(e,t,n){var r=e.data.byteLength,o=t.start-e.range.start,a=n?new Uint8Array(e.data,o,r-o):new DataView(e.data,o,r-o);i(a)}n.data&&n.range.start<=e.start&&n.range.start+n.range.size>=e.start+e.size?s(n,e,t):(o=Math.max(n.bufferSize,e.size),a=n.contentLength>0&&e.start+o>n.contentLength?{start:e.start}:{start:e.start,size:o},Xo.loadArrayBuffer(n.path,Object.assign(n.config,{range:a})).then((function(i){n.data=i,n.range=a,s(n,e,t)})).catch(r))}))}}class Jo{constructor(e,t){this.reader=new ea(e),this.bufferedReader=new Qo(e),this.create_feature=t||Jo.createFeature}getFeatures(e,t,n,i,r){this.st=(new Date).getTime();var o=this;return new Promise((function(a,s){o.features&&i?a(o.features):o.reader.getZoomHeaders().then((function(i){var l,c=o.reader,h=o.bufferedReader,u=r.bpPerPixel,f=Jo.zoomLevelForScale(u,i);f&&"BigWig"===c.type?(l=f.indexOffset,o.decodeFunction=Jo.decodeZoomData):(l=c.header.fullIndexOffset,"BigWig"===c.type?o.decodeFunction=Jo.decodeWigData:o.decodeFunction=o.decodeBedData),c.loadRPTree(l).then((function(i){var r=o.reader.chromTree.dictionary[e];void 0===r?a(null):i.findLeafItemsOverlapping(r,t,n).then((function(i){var l=[];i&&0!=i.length||a([]),i.forEach((function(i){l.push(new Promise((function(a,s){var l=[];h.dataViewForRange({start:i.dataOffset,size:i.dataSize},!0).then((function(i){var s=new Ko.Inflate(i).decompress();o.decodeFunction(new DataView(s.buffer),e,r,t,n,l),a(l)})).catch(s)})))})),Promise.all(l).then((function(e){(new Date).getTime(),o.st;var t,n=e[0];if(e.length>1)for(t=1;t<e.length;t++)n=n.concat(e[t]);n.sort((function(e,t){return e.start-t.start})),o.features=n,a(n)})).catch(s)})).catch((function(e){s(e)}))})).catch((function(e){s(e)}))})).catch((function(e){s(e)}))}))}getDefaultRange(){return null!=this.reader.totalSummary?this.reader.totalSummary.defaultRange:void 0}static zoomLevelForScale(e,t){var n,i,r=null;for(n=0;n<t.length;n++)if((i=t[n]).reductionLevel>e){r=i;break}return null==r&&(r=t[t.length-1]),r&&r.reductionLevel<4*e?r:null}static decodeWigData(e,t,n,i,r,o){var a,s=new oa(e),l=s.getInt(),c=s.getInt(),h=s.getInt(),u=s.getInt(),f=s.getInt(),d=s.getByte(),p=(s.getByte(),s.getUShort());if(l===n)for(;p-- >0;){switch(d){case 1:c=s.getInt(),h=s.getInt(),a=s.getFloat();break;case 2:c=s.getInt(),a=s.getFloat(),h=c+f;break;case 3:a=s.getFloat(),h=c+f,c+=u}if(c>=r)break;h>i&&Number.isFinite(a)&&o.push({chr:t,start:c,end:h,value:a})}}static decodeZoomData(e,t,n,i,r,o){for(var a,s,l,c,h,u=new oa(e);u.remLength()>=32;)if(u.getInt()===n){if(a=u.getInt(),s=u.getInt(),l=u.getInt(),u.getFloat(),u.getFloat(),c=u.getFloat(),u.getFloat(),h=0==l?0:c/l,a>=r&&a<1e9){console.log("should have broken");break}s>i&&Number.isFinite(h)&&o.push({chr:t,start:a,end:s,value:h})}}decodeBedData(e,t,n,i,r,o){for(var a,s,l,c,h,u=new oa(e);u.remLength()>=13;)u.getInt()==n&&(a=u.getInt(),s=u.getInt(),l=u.getString(),h={chr:t,start:a,end:s},a<r&&s>=i&&(o.push(h),c=l.split("\t"),this.create_feature(c,h)))}static createFeature(e,t){if(e.length>0&&(t.name=e[0]),e.length>1&&(t.score=parseFloat(e[1])),e.length>2&&(t.strand=e[2]),e.length>3&&(t.cdStart=parseInt(e[3])),e.length>4&&(t.cdEnd=parseInt(e[4])),e.length,e.length>8){exonCount=parseInt(e[6]),exonSizes=e[7].split(","),exonStarts=e[8].split(","),exons=[];for(var n=0;n<exonCount;n++)eStart=start+parseInt(exonStarts[n]),eEnd=eStart+parseInt(exonSizes[n]),exons.push({start:eStart,end:eEnd});t.exons=exons}}}class ea{constructor(e){this.path=e.url,this.headPath=e.headURL||this.path,this.rpTreeCache={},this.config=JSON.parse(JSON.stringify(e))}getZoomHeaders(){var e=this;return new Promise((function(t,n){e.zoomLevelHeaders?t(e.zoomLevelHeaders):e.loadHeader().then((function(){t(e.zoomLevelHeaders)})).catch((function(e){n(e)}))}))}loadHeader(){var e=this;return new Promise((function(t,n){Xo.loadArrayBuffer(e.path,Object.assign(e.config,{range:{start:0,size:64}})).then((function(i){if(i){e.littleEndian=!0;var r=new oa(new DataView(i));if(2291137574===(o=r.getUInt()))e.type="BigWig";else if(2273964779==o)e.type="BigBed";else{var o;e.littleEndian=!1,r.littleEndian=!1,r.position=0,654085990===(o=r.getUInt())?e.type="BigWig":3958540679==o&&(e.type="BigBed")}e.header={},e.header.bwVersion=r.getUShort(),e.header.nZoomLevels=r.getUShort(),e.header.chromTreeOffset=r.getLong(),e.header.fullDataOffset=r.getLong(),e.header.fullIndexOffset=r.getLong(),e.header.fieldCount=r.getUShort(),e.header.definedFieldCount=r.getUShort(),e.header.autoSqlOffset=r.getLong(),e.header.totalSummaryOffset=r.getLong(),e.header.uncompressBuffSize=r.getInt(),e.header.reserved=r.getLong(),e.loadZoomHeadersAndChrTree().then(t).catch(n)}})).catch((function(e){n(e)}))}))}loadZoomHeadersAndChrTree(){var e=64,t=this;return new Promise((function(n,i){var r={start:e,size:t.header.fullDataOffset-e+5};Xo.loadArrayBuffer(t.path,Object.assign(t.config,{range:r})).then((function(i){var r,o,a=t.header.nZoomLevels,s=new oa(new DataView(i));for(t.zoomLevelHeaders=[],t.firstZoomDataOffset=Number.MAX_VALUE,r=0;r<a;r++)o=new ta(a-r,s),t.firstZoomDataOffset=Math.min(o.dataOffset,t.firstZoomDataOffset),t.zoomLevelHeaders.push(o);t.header.autoSqlOffset>0&&(s.position=t.header.autoSqlOffset-e,t.autoSql=s.getString()),t.header.totalSummaryOffset>0&&(s.position=t.header.totalSummaryOffset-e,t.totalSummary=new sa(s)),t.header.chromTreeOffset>0&&(s.position=t.header.chromTreeOffset-e,t.chromTree=new la(s,e)),s.position=t.header.fullDataOffset-e,t.dataCount=s.getInt(),n()})).catch((function(e){i(e)}))}))}loadRPTree(e){var t=this;return new Promise((function(n,i){var r=t.rpTreeCache[e];r?n(r):(r=new ia(e,t.contentLength,t.config,t.littleEndian),t.rpTreeCache[e]=r,r.load().then((function(){n(r)})).catch(i))}))}}class ta{constructor(e,t){this.index=e,this.reductionLevel=t.getInt(),this.reserved=t.getInt(),this.dataOffset=t.getLong(),this.indexOffset=t.getLong()}}const na=512e3;class ia{constructor(e,t,n,i){this.config=n,this.filesize=t,this.fileOffset=e,this.path=n.url,this.littleEndian=i}load(){var e=this;return new Promise((function(t,n){var i=e.fileOffset+48,r=new Qo(e.config,e.filesize,na);e.readNode(i,r).then((function(n){e.rootNode=n,t(e)})).catch(n)}))}readNode(e,t){var n=this;return new Promise((function(i,r){t.dataViewForRange({start:e,size:4},!1).then((function(o){var a=new oa(o,n.littleEndian),s=1===a.getByte(),l=(a.getByte(),a.getUShort()),c={start:e+=4,size:l*(s?32:24)};t.dataViewForRange(c,!1).then((function(e){var t,n=new Array(l),r=new oa(e);if(s){for(t=0;t<l;t++){var o={isLeaf:!0,startChrom:r.getInt(),startBase:r.getInt(),endChrom:r.getInt(),endBase:r.getInt(),dataOffset:r.getLong(),dataSize:r.getLong()};n[t]=o}i(new ra(n))}else{for(t=0;t<l;t++)o={isLeaf:!1,startChrom:r.getInt(),startBase:r.getInt(),endChrom:r.getInt(),endBase:r.getInt(),childOffset:r.getLong()},n[t]=o;i(new ra(n))}})).catch(r)})).catch(r)}))}findLeafItemsOverlapping(e,t,n){var i=this;return new Promise((function(r,o){var a=[],s=new Set,l=new Qo(i.config,i.filesize,na);s.add(0),function c(h,u){ia.overlaps(h,e,t,n)&&h.items.forEach((function(r){ia.overlaps(r,e,t,n)&&(r.isLeaf?a.push(r):r.childNode?c(r.childNode):(s.add(r.childOffset),i.readNode(r.childOffset,l).then((function(e){r.childNode=e,c(e,r.childOffset)})).catch(o)))})),null!=u&&s.delete(u),0===s.size&&r(a)}(i.rootNode,0)}))}static overlaps(e,t,n,i){return e?(t>e.startChrom||t==e.startChrom&&i>=e.startBase)&&(t<e.endChrom||t==e.endChrom&&n<e.endBase):(console.log("null item"),!1)}}class ra{constructor(e){this.items=e;var t,n,i=Number.MAX_VALUE,r=0,o=Number.MAX_VALUE,a=0;for(t=0;t<e.length;t++)n=e[t],i=Math.min(i,n.startChrom),r=Math.max(r,n.endChrom),o=Math.min(o,n.startBase),a=Math.max(a,n.endBase);this.startChrom=i,this.endChrom=r,this.startBase=o,this.endBase=a}}class oa{constructor(e,t){this.littleEndian=t||!0,this.position=0,this.view=e,this.length=e.byteLength}available(){return this.length-this.position}remLength(){return this.length-this.position}hasNext(){return this.position<this.length-1}getByte(){var e=this.view.getUint8(this.position,this.littleEndian);return this.position++,e}getShort(){var e=this.view.getInt16(this.position,this.littleEndian);return this.position+=2,e}getUShort(){var e=this.view.getUint16(this.position,this.littleEndian);return this.position+=2,e}getInt(){var e=this.view.getInt32(this.position,this.littleEndian);return this.position+=4,e}getUInt(){var e=this.view.getUint32(this.position,this.littleEndian);return this.position+=4,e}getLong(){var e=[];e[0]=this.view.getUint8(this.position),e[1]=this.view.getUint8(this.position+1),e[2]=this.view.getUint8(this.position+2),e[3]=this.view.getUint8(this.position+3),e[4]=this.view.getUint8(this.position+4),e[5]=this.view.getUint8(this.position+5),e[6]=this.view.getUint8(this.position+6),e[7]=this.view.getUint8(this.position+7);var t=0;if(this.littleEndian)for(var n=e.length-1;n>=0;n--)t=256*t+e[n];else for(n=0;n<e.length;n++)t=256*t+e[n];return this.position+=8,t}getString(e){for(var t,n="";0!=(t=this.view.getUint8(this.position++))&&(n+=String.fromCharCode(t),!e||n.length!=e););return n}getFixedLengthString(e){var t,n,i="";for(t=0;t<e;t++)(n=this.view.getUint8(this.position++))>0&&(i+=String.fromCharCode(n));return i}getFixedLengthTrimmedString(e){var t,n,i="";for(t=0;t<e;t++)(n=this.view.getUint8(this.position++))>32&&(i+=String.fromCharCode(n));return i}getFloat(){var e=this.view.getFloat32(this.position,this.littleEndian);return this.position+=4,e}getDouble(){var e=this.view.getFloat64(this.position,this.littleEndian);return this.position+=8,e}skip(e){return this.position+=e,this.position}getVPointer(){var e=this.position,t=this.view.getUint8(e+1)<<8|this.view.getUint8(e),n=4294967296*(255&this.view.getUint8(e+6))+16777216*(255&this.view.getUint8(e+5))+65536*(255&this.view.getUint8(e+4))+256*(255&this.view.getUint8(e+3))+(255&this.view.getUint8(e+2));return this.position+=8,new aa(n,t)}}class aa{constructor(e,t){this.block=e,this.offset=t}isLessThan(e){return this.block<e.block||this.block===e.block&&this.offset<e.offset}isGreaterThan(e){return this.block>e.block||this.block===e.block&&this.offset>e.offset}print(){return this.block+":"+this.offset}}class sa{constructor(e){e?(this.basesCovered=e.getLong(),this.minVal=e.getDouble(),this.maxVal=e.getDouble(),this.sumData=e.getDouble(),this.sumSquares=e.getDouble(),this.computeStats()):(this.basesCovered=0,this.minVal=0,this.maxVal=0,this.sumData=0,this.sumSquares=0,this.mean=0,this.stddev=0)}computeStats(){var e=this.basesCovered;e>0&&(this.mean=this.sumData/e,this.stddev=Math.sqrt(this.sumSquares/(e-1)),this.minVal<0&&(this.mean,this.stddev),this.maxVal>0&&(this.mean,this.stddev),this.defaultRange={min:0,max:this.mean+3*this.stddev})}updateStats(e){this.basesCovered+=e.count,this.sumData+=status.sumData,this.sumSquares+=sumSquares,this.minVal=MIN(_minVal,min),this.maxVal=MAX(_maxVal,max),computeStats.call(this)}}class la{constructor(e,t){this.header={},this.header.magic=e.getInt(),this.header.blockSize=e.getInt(),this.header.keySize=e.getInt(),this.header.valSize=e.getInt(),this.header.itemCount=e.getLong(),this.header.reserved=e.getLong(),this.dictionary={},function e(n,i,r,o){i>=0&&(n.position=i);var a,s,l,c,h,u=n.getByte(),f=(n.getByte(),n.getUShort());if(1==u)for(a=0;a<f;a++)s=n.getFixedLengthTrimmedString(r),l=n.getInt(),n.getInt(),o[s]=l;else for(a=0;a<f;a++)s=n.getFixedLengthTrimmedString(r),c=n.getLong()-t,h=n.position,e(n,c,r,o),n.position=h}(e,-1,this.header.keySize,this.dictionary),this.header.keySize}}let ca={strictMode:!1,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};class ha{static addAlphaToRGB(e,t){return e.startsWith("rgb")?e.replace("rgb","rgba").replace(")",", "+t+")"):(console.log(e+" is not an rgb style string"),e)}static presentAlert(e,t){let n=$("<div>").css({position:"absolute","background-color":"white"}).attr("class","mlv-alert").appendTo(e);$("<div>").css({display:"flex","justify-content":"center"}).appendTo(n).append($('<i class="fas fa-exclamation-circle"></i>').css({color:"red","font-size":"16px","text-align":"center"})),n.append($("<div>"+t+"</div>").css({color:"red","font-size":"14px","text-align":"center"}));let i=Math.round(e.width()/2-n.width()/2),r=Math.round(e.height()/2-n.height()/2);n.css({left:i+"px",top:r+"px"})}static spinner(e){var t;return t=$('<i class="fa fa-lg fa-spinner fa-spin igv-spinner">').css({position:"absolute",top:"50%",left:"50%"}),e&&t.css("font-size",e),t[0]}static getSpinnerObjectWithParentElement(e){return e.find("div.igv-spinner-container")}static startSpinnerAtParentElement(e){e.children(".fa-spinner").show()}static stopSpinnerAtParentElement(e){e.children(".fa-spinner").hide()}static parseUri(e){for(var t=ca,n=t.parser[t.strictMode?"strict":"loose"].exec(e),i={},r=14;r--;)i[t.key[r]]=n[r]||"";return i[t.q.name]={},i[t.key[12]].replace(t.q.parser,(function(e,n,r){n&&(i[t.q.name][n]=r)})),i}static domElementRectAsString(e){return" x "+e.clientLeft+" y "+e.clientTop+" w "+e.clientWidth+" h "+e.clientHeight}static isNumber(e){return""!==e&&void 0!==e&&!isNaN(parseFloat(e))&&isFinite(e)}static guid(){return("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4)}static random(e,t){return Math.random()*(t-e)+e}static numberFormatter(e){var t=String(e).split(/[.,]/);return t[0].split("").reverse().reduce((function(e,t,n){return n%3==0?e+","+t:e+t})).split("").reverse().join("")+(t[1]?"."+t[1]:"")}static numberUnFormatter(e){return e.split(",").join().replace(",","","g")}static translateMouseCoordinates(e,t){var n=$.event.fix(e);return{x:n.pageX-$(t).offset().left,y:n.pageY-$(t).offset().top}}static formatPopoverText(e){var t='<table class="igv-popover-table">';return e.forEach((function(e){e.name?t+='<tr><td class="igv-popover-td"><div class="igv-popoverNameValue"><span class="igv-popoverName">'+e.name+'</span><span class="igv-popoverValue">'+e.value+"</span></div></td></tr>":t+="<tr><td>"+e.toString()+"</td></tr>"})),t+="</table>"}static throttle(e,t,n){var i,r;return t||(t=200),function(){var o=n||this,a=+new Date,s=arguments;i&&a<i+t?(clearTimeout(r),r=setTimeout((function(){i=a,e.apply(o,s)}),t)):(i=a,e.apply(o,s))}}static splitStringRespectingQuotes(e,t){var n,i,r=[],o=e.length,a=0,s=!1;if(o>0)for(r[a]=e.charAt(0),n=1;n<o;n++)'"'===(i=e.charAt(n))?s=!s:s||i!==t?r[a]+=i:r[++a]="";return r}static addAjaxExtensions(){$.ajaxTransport("+binary",(function(e,t,n){return{send:function(t,n){var i=new XMLHttpRequest,r=e.url,o=e.type;if(e.data,i.addEventListener("load",(function(){var t={};t[e.dataType]=i.response,n(i.status,i.statusText,t,i.getAllResponseHeaders())})),i.open(o,r),i.responseType="arraybuffer",e.headers)for(var a in e.headers)e.headers.hasOwnProperty(a)&&i.setRequestHeader(a,e.headers[a])},abort:function(){n.abort()}}}))}static isStringOrNumber(e){return!(!e.substring&&!e.toFixed)}static constrainBBox(e,t){var n,i,r={},o={};return o.left=o.top=0,o.right=t.outerWidth(),o.bottom=t.outerHeight(),i=e.offset(),r.left=i.left-t.offset().left,r.top=i.top-t.offset().top,r.right=r.left+e.outerWidth(),r.bottom=r.top+e.outerHeight(),(n=r.bottom-o.bottom)>0&&(i.top-=n,r.top-=n,r.bottom-=n,(n=r.top-o.top)<0&&(i.top-=n)),i}static log(e){igv.enableLogging&&console&&console.log&&console.log(e)}}let ua=function(e,t,n){return new Promise((function(i,r){Xo.loadArrayBuffer(e,{headers:t.headers,withCredentials:t.withCredentials}).then((function(t){var r,o,a,s,l,c,h,u,f,d,p,g,m,_,v=[],b=Number.MAX_VALUE,y=0;if(t){if(n&&(t=new Ko.Gunzip(new Uint8Array(t)).decompress().buffer),!(21578050===(r=(l=new oa(new DataView(t))).getInt())||n&&21578324===r))throw new Error(e+" is not a "+(n?"tabix":"bai")+" file");if(s=l.getInt(),n)for(l.getInt(),l.getInt(),l.getInt(),l.getInt(),l.getInt(),l.getInt(),l.getInt(),_={},g=0;g<s;g++){_[l.getString()]=g}for(m=0;m<s;++m){for(c={},h=[],o=l.getInt(),p=0;p<o;++p)if(37450==(u=l.getInt()))w=l.getInt(),f=l.getVPointer(),d=l.getVPointer(),l.getLong(),l.getLong();else{c[u]=[];var w=l.getInt();for(g=0;g<w;g++)f=l.getVPointer(),d=l.getVPointer(),f&&d&&(f.block<b&&(b=f.block),d.block>y&&(y=d.block),c[u].push([f,d]))}for(a=l.getInt(),g=0;g<a;g++)f=l.getVPointer(),h.push(f);o>0&&(v[m]={binIndex:c,linearIndex:h})}i(new fa(v,b,y,_,n))}else i(null)})).catch(r)}))};class fa{constructor(e,t,n,i,r){this.firstAlignmentBlock=t,this.indices=e,this.lastAlignmentBlock=n,this.sequenceIndexMap=i,this.tabix=r}getBlocksForRange(e,t,n){const i=this.indices[e];if(!i)return[];const r=i.linearIndex,o=r.length,a=Math.max(t>>14,0),s=Math.min(n>>14,o-1);return[{minv:r[a],maxv:r[s],bin:1}]}blocksForRange(e,t,n){var i,r,o,a,s,l,c,h,u=this.indices[e];if(u){for(i=fa.reg2bins(t,n),r=[],i.forEach((function(e){if(u.binIndex[e])for(var t=u.binIndex[e],n=t.length,i=0;i<n;++i){var o=t[i][0],a=t[i][1];r.push({minv:o,maxv:a,bin:e})}})),o=u.linearIndex.length,a=null,s=Math.min(t>>14,o-1),l=Math.min(n>>14,o-1),h=s;h<=l;++h)(c=u.linearIndex[h])&&(a&&!c.isLessThan(a)||(a=c));return function(e,t){var n=[],i=null;return 0===e.length?e:(e.sort((function(e,t){var n=e.minv.block-t.minv.block;return 0!=n?n:e.minv.offset-t.minv.offset})),e.forEach((function(e){t&&!e.maxv.isGreaterThan(t)||(null===i?(n.push(e),i=e):e.minv.block-i.maxv.block<65e3?e.maxv.isGreaterThan(i.maxv)&&(i.maxv=e.maxv):(n.push(e),i=e))})),n)}(r,a)}return[]}static reg2bins(e,t){var n,i=[];for(t>=1<<29&&(t=1<<29),--t,i.push(0),n=1+(e>>26);n<=1+(t>>26);++n)i.push(n);for(n=9+(e>>23);n<=9+(t>>23);++n)i.push(n);for(n=73+(e>>20);n<=73+(t>>20);++n)i.push(n);for(n=585+(e>>17);n<=585+(t>>17);++n)i.push(n);for(n=4681+(e>>14);n<=4681+(t>>14);++n)i.push(n);return i}}var da=["=","A","C","x","G","x","x","x","T","x","x","x","x","x","x","N"],pa=["M","I","D","N","S","H","P","=","X","?","?","?","?","?","?","?"];const ga=65536;class ma{constructor(e){this.bamPath=e.url,this.baiPath=e.indexURL||this.bamPath+".bai",this.headPath=e.headURL||this.bamPath,this.alignments=[],this.features=[],this.alignmentBuffer=new SharedArrayBuffer(8e6),this.alignments=new Int32Array(this.alignmentBuffer),this.pointer=0,this.config=e,this.fragmentThreshold=50}async getAlignments(e,t,n){if(this.store&&e===this.store[0]&&t>=this.store[1]&&n<=this.store[2])return this.features;this.index||await this.readHeader(),this.pointer=0;const i=this.chrToIndex[e],r=this.index.blocksForRange(i,t,n);return r?0===r.length?[]:(await Promise.all(r.map((async e=>{var r=e.minv.block,o={start:r,size:e.maxv.block+ga-r+1};const a=await Xo.loadArrayBuffer(this.bamPath,{headers:this.config.headers,range:o,withCredentials:this.config.withCredentials});var s=new Uint8Array(new Aa(a));this.addAlignments(s,e.minv.offset,t,n,i)}))),this.store=[e,t,n],this.calculateCategories(),this.features):[]}setCategories(e,t){this.catData=e,this.catNames=t}setFilter(e,t){this.filter=e,this.localFilter=t}calculateFragmentSize(){const e=this.store[1],t=this.store[2]-this.store[1];this.features=[];for(let e=0;e<3;e++)this.features.push(new Uint16Array(t));for(let t=0;t<this.pointer;t+=4){let n=this.alignments[t]-e;const i=n+this.alignments[t+1];n<0&&(n=0);let r=this.features[0];if(this.alignments[t+3]>this.fragmentThreshold&&(r=this.features[1]),i>n)for(let e=n;e<i;e++)r[e]++,this.features[2][e]++;else for(let e=i;e<n;e++)r[e]++,this.features[2][e]++}this.features.store=this.store}calculateCategories(){const e=this.catNames.length,t=this.store[1],n=this.store[2]-this.store[1];this.features=[];for(let t=0;t<e;t++)this.features.push(new Uint16Array(n));if(this.cut_window=0,performance.now(),this.cut_window){const e=this.cut_window;for(let n=0;n<this.pointer;n+=4){let i=this.alignments[n]-t,r=i-e;const o=i+e;r<0&&(r=0);const a=this.alignments[n+2];if(this.filter&&0!==this.filter[a]&&this.filter[a]!==this.localFilter[a])continue;const s=this.features[this.catData[a]];for(let e=r;e<o;e++)s[e]++}}else for(let e=0;e<this.pointer;e+=4){if(this.size_filter_on&&this.alignments[e+3]>this.size_filter)continue;let n=this.alignments[e]-t;const i=n+this.alignments[e+1];n<0&&(n=0);const r=this.alignments[e+2];if(this.filter&&0!==this.filter[r]&&this.filter[r]!==this.localFilter[r])continue;const o=this.features[this.catData[r]];if(i>n)for(let e=n;e<i;e++)o[e]++;else for(let e=i;e<n;e++)o[e]++}this.features.store=this.store}getIdsInRange(e){const t=Math.round(e.start),n=Math.round(e.end),i=this.alignments,r=new Set;for(let e=0;e<this.alignments.length;e+=3)if(!(i[e]<t)){if(i[e]>n)break;r.add(i[e+2])}return r}addAlignments(e,t,n,i,r){for(var o,a,s,l,c,h,u,f,d,p,g;;){if((o=t+ba(e,t)+4)>e.length)return;if(s=ba(e,t+4),l=ba(e,t+8),s<0)return;if(s>r||l>i)return;if(s<r)continue;c=255&ba(e,t+12),f=65535&(h=ba(e,t+16));const v=!(16&(4294901760&h)>>16);d=ba(e,t+20);const b=Math.abs(ba(e,t+32));for(g=t+36+c,p=0,u=0;u<f;++u){var m=ba(e,g),_=pa[15&m];"M"!=_&&"EQ"!=_&&"X"!=_&&"D"!=_&&"N"!=_&&"="!=_||(p+=m>>4),g+=4}l+p<n||(v||(l+=p,p=-p),this.alignments[this.pointer++]=l,this.alignments[this.pointer++]=p,g+=d+1>>1,g+=d,a=Fa(new Uint8Array(e.buffer.slice(g,o))),this.catIndex[a.CB],this.alignments[this.pointer++]=this.catIndex[a.CB],this.alignments[this.pointer++]=Math.abs(b),g+=o),t=o}}async readHeader(){var e=this,t=(await va(this)).firstAlignmentBlock+ga;const n=await Xo.loadArrayBuffer(e.bamPath,{headers:e.config.headers,range:{start:0,size:t},withCredentials:e.config.withCredentials});for(var i=new Aa(n,t),r=new Uint8Array(i),o=(ba(r,0),ba(r,4)),a=0;a<o;++a)String.fromCharCode(r[a+8]);var s=ba(r,o+8),l=o+12;for(e.chrToIndex={},e.indexToChr=[],a=0;a<s;++a){for(var c=ba(r,l),h="",u=0;u<c-1;++u)h+=String.fromCharCode(r[l+4+u]);ba(r,l+c+4),e.chrToIndex[h]=a,e.indexToChr.push(h),l=l+8+c}}}class _a{constructor(e,t){this.config=e,this.parent=t,this.ac_class=Ma,t.ac_class&&(this.ac_class=parent_class),this.filter=e.filter||new Da,this.bamPath=e.url,this.baiPath=e.indexURL||this.bamPath+".bai",this.headPath=e.headURL||this.bamPath,this.samplingWindowSize=void 0===e.samplingWindowSize?100:e.samplingWindowSize,this.samplingDepth=void 0===e.samplingDepth?2500:e.samplingDepth,this.samplingDepth>2500&&(igv.log("Warning: attempt to set sampling depth > maximum value of 2500"),this.samplingDepth=2500),e.viewAsPairs?this.pairsSupported=!0:this.pairsSupported=void 0===e.pairsSupported||e.pairsSupported}readAlignments(e,t,n){var i=this;return new Promise((function(o,a){var s;(s=i,new Promise((function(e,t){s.chrToIndex?e(s.chrToIndex):s.readHeader().then((function(){e(s.chrToIndex)})).catch(t)}))).then((function(s){var l=s[e],c=new i.ac_class(e,t,n,i.samplingWindowSize,i.samplingDepth,i.pairsSupported,i.parent);void 0===l?o(c):va(i).then((function(e){var s=e.blocksForRange(l,t,n),h=[];if(!s)return o(null),void a("Error reading bam index");0!==s.length?(s.forEach((function(e){h.push(new Promise((function(o,a){var s=e.minv.block,h={start:s,size:e.maxv.block+ga-s+1};Xo.loadArrayBuffer(i.bamPath,{headers:i.config.headers,range:h,withCredentials:i.config.withCredentials}).then((function(a){!function(e,t,n,o,a,s,l){for(var c,h,u,f,d,p,g,m,_,v,b,y,w,x,C,k,S,E,D,A,M,R,L;;){if((c=t+ba(e,t)+4)>e.length)return;if(h=new Sa,f=ba(e,t+4),d=ba(e,t+8),f<0)return;if(f>s||d>a)return;if(!(f<s)){for(g=(65280&(p=ba(e,t+12)))>>8,m=255&p,v=(4294901760&(_=ba(e,t+16)))>>16,b=65535&_,h.flags=v,h.strand=!(16&v),y=ba(e,t+20),w=ba(e,t+24),x=ba(e,t+28),h.fragmentLength=ba(e,t+32),C="",k=0;k<m-1;++k)C+=String.fromCharCode(e[t+36+k]);for(S=t+36+m,E=0,D="",M=[],A=0;A<b;++A){var T=ba(e,S),P=T>>4,z=pa[15&T];"M"!=z&&"EQ"!=z&&"X"!=z&&"D"!=z&&"N"!=z&&"="!=z||(E+=P),D=D+P+z,S+=4,M.push({len:P,ltr:z})}if(h.cigar=D,h.lengthOnRef=E,!(h.start+h.lengthOnRef<o)){for(R="",L=y+1>>1,k=0;k<L;++k){var I=e[S+k];R+=da[(240&I)>>4],R+=da[15&I]}if(R=R.substring(0,y),S+=L,h.seq=R,1===y&&"*"===String.fromCharCode(e[S+k]+33));else for(h.qual=[],k=0;k<y;++k)h.qual.push(e[S+k]);S+=y,h.start=d,h.mq=g,h.readName=C,h.chr=i.indexToChr[f],w>=0&&(h.mate={chr:i.indexToChr[w],position:x,strand:!(32&v)}),h.tagBA=new Uint8Array(e.buffer.slice(S,c)),S+=c,(!o||h.start<=a&&h.start+h.lengthOnRef>=o&&l.pass(h))&&(void 0!==s&&f!=s||(u=r(h,M),h.blocks=u.blocks,h.insertions=u.insertions,n.push(h))),t=c}}}}(new Uint8Array(new Aa(a)),e.minv.offset,c,t,n,l,i.filter),o(c)})).catch((function(e){a(e)}))})))})),Promise.all(h).then((function(e){c.finish(),o(c)})).catch((function(e){a(e)}))):o(c)})).catch(a)})).catch(a)}));function r(e,t){for(var n,i,r,o,a=[],s=0,l=e.start,c=t.length,h=0;h<c;h++){var u=t[h];switch(u.ltr){case"H":case"P":break;case"S":s+=u.len,o="S";break;case"N":l+=u.len,o="N";break;case"D":l+=u.len,o="D";break;case"I":i="*"===e.seq?"*":e.seq.substr(s,u.len),r=e.qual?e.qual.slice(s,u.len):void 0,void 0===n&&(n=[]),n.push({start:l,len:u.len,seq:i,qual:r}),s+=u.len;break;case"M":case"EQ":case"=":case"X":i="*"===e.seq?"*":e.seq.substr(s,u.len),r=e.qual?e.qual.slice(s,u.len):void 0,a.push({start:l,len:u.len,seq:i,qual:r,gapType:o}),s+=u.len,l+=u.len;break;default:console.log("Error processing cigar element: "+u.len+u.ltr)}}return{blocks:a,insertions:n}}}readHeader(){var e=this;return new Promise((function(t,n){va(e).then((function(i){var r=i.firstAlignmentBlock+ga;Xo.loadArrayBuffer(e.bamPath,{headers:e.config.headers,range:{start:0,size:r},withCredentials:e.config.withCredentials}).then((function(n){for(var i=new Aa(n,r),o=new Uint8Array(i),a=(ba(o,0),ba(o,4)),s=0;s<a;++s)String.fromCharCode(o[s+8]);var l=ba(o,a+8),c=a+12;for(e.chrToIndex={},e.indexToChr=[],s=0;s<l;++s){for(var h=ba(o,c),u="",f=0;f<h-1;++f)u+=String.fromCharCode(o[c+4+f]);ba(o,c+h+4),e.chrToIndex[u]=s,e.indexToChr.push(u),c=c+8+h}t()})).catch(n)})).catch(n)}))}}function va(e){return new Promise((function(t,n){e.index?t(e.index):ua(e.baiPath,e.config).then((function(n){e.index=n,t(e.index)})).catch(n)}))}function ba(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]}function ya(e,t){return e[t+1]<<8|e[t]}class wa{constructor(e,t){this.config=e,this.alignmentContainer=void 0,this.maxRows=e.maxRows||1e3,e.seq_url&&(this.sequence_source=new Ya(e.seq_url)),this.parent=t,this.pack_alignments=!0,"ga4gh"===e.sourceType?this.bamReader=new igv.Ga4ghAlignmentReader(e):this.bamReader=new _a(e,t),this.viewAsPairs=!0}setViewAsPairs(e){var t,n,i;if(this.viewAsPairs!==e&&(this.viewAsPairs=e,this.alignmentContainer)){var r,o=this.alignmentContainer;e?(t=o.packedAlignmentRows,n={},i=[],t.forEach((function(e){e.alignments.forEach((function(e){var t;Ca(e)?(t=n[e.readName])?(t.setSecondAlignment(e),n[e.readName]=void 0):(t=new igv.PairedAlignment(e),n[e.readName]=t,i.push(t)):i.push(e)}))})),r=i):r=xa(o.packedAlignmentRows),o.packedAlignmentRows=ka(r,o.start,o.end,this.maxRows)}}getAlignments(e,t,n){var i=this;return new Promise((function(r,o){i.alignmentContainer&&i.alignmentContainer.contains(e,t,n)?r(i.alignmentContainer):i.bamReader.readAlignments(e,t,n).then((function(e){var t=i.config.maxRows||500,n=e.alignments;i.viewAsPairs||(n=xa([{alignments:n}])),i.parent.display_alignments&&(e.packedAlignmentRows=ka(n,e.start,e.end,t)),e.alignments=void 0,i.alignmentContainer=e,i.sequence_source?i.sequence_source.getSequence(e.chr,e.start,e.end).then((function(t){t&&(e.coverageMap.refSeq=t,e.sequence=t,r(e))})).catch(o):r(e)})).catch(o)}))}}function xa(e){var t=[];return e.forEach((function(e){e.alignments.forEach((function(e){e instanceof Ia?(e.firstAlignment&&t.push(e.firstAlignment),e.secondAlignment&&t.push(e.secondAlignment)):t.push(e)}))})),t}function Ca(e){return e.isPaired()&&e.isMateMapped()&&e.chr===e.mate.chr&&(e.isFirstOfPair()||e.isSecondOfPair())&&!(e.isSecondary()||e.isSupplementary())}function ka(e,t,n,i){if(e){if(e.sort((function(e,t){return e.start-t.start})),0===e.length)return[];var r,o,a,s,l=[],c=0,h=0,u=t,f=[],d=Math.max(t,e[0].start);for(e.forEach((function(e){var t=Math.max(0,e.start-d);void 0===l[t]&&(l[t]=[]),l[t].push(e)}));c<e.length&&f.length<i;){for(r=new Oa;u<=n;){for(a=void 0;!a&&u<=n;)void 0===l[o=u-d]?++u:a=l[o];if(!a)break;s=a.pop(),0===a.length&&(l[o]=void 0),r.alignments.push(s),u=s.start+s.lengthOnRef+8,++c}if(r.alignments.length>0&&f.push(r),u=d,c===h)break;h=c}return f}}class Sa{constructor(){this.hidden=!1}isMapped(){return 0==(4&this.flags)}isPaired(){return 0!=(1&this.flags)}isProperPair(){return 0!=(2&this.flags)}isFirstOfPair(){return 0!=(64&this.flags)}isSecondOfPair(){return 0!=(128&this.flags)}isSecondary(){return 0!=(256&this.flags)}isSupplementary(){return 0!=(2048&this.flags)}isFailsVendorQualityCheck(){return 0!=(512&this.flags)}isDuplicate(){return 0!=(1024&this.flags)}isMateMapped(){return 0==(8&this.flags)}isNegativeStrand(){return 0!=(16&this.flags)}isMateNegativeStrand(){return 0!=(32&this.flags)}tags(){return this.tagDict||(this.tagBA?(this.tagDict=function(e){for(var t=0,n=e.length,i={};t<n;){var r,o=String.fromCharCode(e[t])+String.fromCharCode(e[t+1]),a=String.fromCharCode(e[t+2]);if("A"==a)r=String.fromCharCode(e[t+3]),t+=4;else if("i"===a||"I"===a)r=ba(e,t+3),t+=7;else if("c"===a||"C"===a)r=e[t+3],t+=4;else if("s"===a||"S"===a)r=ya(e,t+3),t+=5;else if("f"===a)r=Ea(e,t+3),t+=7;else{if("Z"!==a){r="Error unknown type: "+a,i[o]=r;break}for(t+=3,r="";;){var s=e[t++];if(0===s)break;r+=String.fromCharCode(s)}}i[o]=r}return i}(this.tagBA),this.tagBA=void 0):this.tagDict={}),this.tagDict}popupData(e){var t,n,i=[];if(this.insertions)for(var r=0;r<this.insertions.length;r+=1){var o=this.insertions[r].start;if(e==o||e==o-1)return i.push({name:"Insertion",value:this.insertions[r].seq}),i.push({name:"Location",value:o}),i}for(var a in i.push({name:"Read Name",value:this.readName}),i.push("<hr>"),i.push({name:"Alignment Start",value:igv.numberFormatter(1+this.start),borderTop:!0}),i.push({name:"Read Strand",value:!0===this.strand?"(+)":"(-)",borderTop:!0}),i.push({name:"Cigar",value:this.cigar}),i.push({name:"Mapped",value:s(this.isMapped())}),i.push({name:"Mapping Quality",value:this.mq}),i.push({name:"Secondary",value:s(this.isSecondary())}),i.push({name:"Supplementary",value:s(this.isSupplementary())}),i.push({name:"Duplicate",value:s(this.isDuplicate())}),i.push({name:"Failed QC",value:s(this.isFailsVendorQualityCheck())}),this.isPaired()&&(i.push("<hr>"),i.push({name:"First in Pair",value:!this.isSecondOfPair(),borderTop:!0}),i.push({name:"Mate is Mapped",value:s(this.isMateMapped())}),this.isMateMapped()&&(i.push({name:"Mate Chromosome",value:this.mate.chr}),i.push({name:"Mate Start",value:this.mate.position+1}),i.push({name:"Mate Strand",value:!0===this.mate.strand?"(+)":"(-)"}),i.push({name:"Insert Size",value:this.fragmentLength}))),i.push("<hr>"),t=!0,n=this.tags())n.hasOwnProperty(a)&&(t?(i.push({name:a,value:n[a],borderTop:!0}),t=!1):i.push({name:a,value:n[a]}));return i;function s(e){return e?"Yes":"No"}}}function Ea(e,t){return new DataView(e.buffer).getFloat32(t,!0)}class Da{constructor(e){e||(e={}),this.vendorFailed=void 0===e.vendorFailed||e.vendorFailed,this.duplicates=void 0===e.duplicates||e.duplicates,this.secondary=e.secondary||!1,this.supplementary=e.supplementary||!1,this.mqThreshold=void 0===e.mqThreshold?0:e.mqThreshold}pass(e){return!(this.vendorFailed&&e.isFailsVendorQualityCheck()||this.duplicates&&e.isDuplicate()||this.secondary&&e.isSecondary()||this.supplementary&&e.isSupplementary()||e.mq<this.mqThreshold)}}class Aa{constructor(e,t){for(let t in e)console.log(t);var n=[],i=[0],r=0;for(t=t||e.byteLength-18;i[0]<t;){var o=new Uint8Array(e,i[0],18),a=o[11]<<8|o[10],s=(o[12],o[13],o[15],o[14],o[17]<<8|o[16]+1),l=12+a+i[0],c=e.byteLength-l;if(c<s+8)break;var h=Vo(e,l,c,i);i[0]+=8,r+=h.byteLength,n.push(h)}if(1==n.length)return n[0];for(var u=new Uint8Array(r),f=0,d=0;d<n.length;++d){var p=new Uint8Array(n[d]);Wo(p,0,u,f,p.length),f+=p.length}return u.buffer}}class Ma{constructor(e,t,n,i,r,o,a){this.parent=a,this.chr=e,this.start=t,this.end=n,this.length=n-t,this.parent.cm_class?this.coverageMap=new this.parent.cm_class(e,t,n,a):this.coverageMap=new Ta(e,t,n,a),this.alignments=[],this.raw_alignments=[],this.downsampledIntervals=[],this.samplingWindowSize=void 0===i?100:i,this.samplingDepth=void 0===r?50:r,this.pairsSupported=o,this.paired=!1,this.pairsCache={},this.downsampledReads=new Set,this.currentBucket=new La(this.start,this.start+this.samplingWindowSize,this),this.filter=function(e){return e.isMapped()&&!e.isFailsVendorQualityCheck()}}push(e){!1!==this.filter(e)&&(e.tagBA&&(e.tagBA=Fa(e.tagBA)),this.parent.keep_raw_alignments&&this.raw_alignments.push(e),this.coverageMap.incCounts(e),this.parent.display_alignments&&(this.pairsSupported&&this.downsampledReads.has(e.readName)||(e.start>=this.currentBucket.end&&(Ra.call(this),this.currentBucket=new La(e.start,e.start+this.samplingWindowSize,this)),this.currentBucket.addAlignment(e))))}forEach(e){this.alignments.forEach(e)}finish(){if(void 0!==this.currentBucket&&Ra.call(this),this.pairsSupported){var e=[],t=this.downsampledReads;this.alignments.forEach((function(n){t.has(n.readName)||e.push(n)})),this.alignments=e}this.alignments.sort((function(e,t){return e.start-t.start})),this.pairsCache=void 0,this.downsampledReads=void 0}contains(e,t,n){return this.chr==e&&this.start<=t&&this.end>=n}hasDownsampledIntervals(){return this.downsampledIntervals&&this.downsampledIntervals.length>0}}function Ra(){this.alignments=this.alignments.concat(this.currentBucket.alignments),this.currentBucket.downsampledCount>0&&this.downsampledIntervals.push(new za(this.currentBucket.start,this.currentBucket.end,this.currentBucket.downsampledCount)),this.paired=this.paired||this.currentBucket.paired}class La{constructor(e,t,n){this.start=e,this.end=t,this.alignments=[],this.downsampledCount=0,this.samplingDepth=n.samplingDepth,this.pairsSupported=n.pairsSupported,this.downsampledReads=n.downsampledReads,this.pairsCache=n.pairsCache}addAlignment(e){var t,n,i,r;this.alignments.length<this.samplingDepth?this.pairsSupported&&Ca(e)?(r=this.pairsCache[e.readName])?(r.setSecondAlignment(e),this.pairsCache[e.readName]=void 0):(r=new Ia(e),this.paired=!0,this.pairsCache[e.readName]=r,this.alignments.push(r)):this.alignments.push(e):(t=this.samplingDepth/(this.samplingDepth+this.downsampledCount+1),Math.random()<t?(n=Math.floor(Math.random()*(this.alignments.length-1)),i=this.alignments[n],this.pairsSupported&&Ca(e)?(void 0!==this.pairsCache[i.readName]&&(this.pairsCache[i.readName]=void 0),r=new Ia(e),this.paired=!0,this.pairsCache[e.readName]=r,this.alignments[n]=r):this.alignments[n]=e,this.downsampledReads.add(i.readName)):this.downsampledReads.add(e.readName),this.downsampledCount++)}}class Ta{constructor(e,t,n,i){this.chr=e,this.bpStart=t,this.length=n-t,this.parent=i,this.coverage=new Array(this.length),this.maximum=0}incCounts(e){var t=this;function n(n){var i,r,o,a,s;for(o=n.start-t.bpStart,a=0;a<n.len;o++,a++)t.coverage[o]||(t.coverage[o]=new Pa),r=n.seq.charAt(a),i=e.strand?"pos"+r:"neg"+r,s=n.qual[a],t.coverage[o][i]+=1,t.coverage[o]["qual"+r]+=s,t.coverage[o].total+=1,t.coverage[o].qual+=s,t.maximum=Math.max(t.coverage[o].total,t.maximum)}void 0===e.blocks?n(e):e.blocks.forEach((function(e){n(e)}))}}Ta.threshold=.2,Ta.qualityWeight=!0;class Pa{constructor(){this.posA=0,this.negA=0,this.posT=0,this.negT=0,this.posC=0,this.negC=0,this.posG=0,this.negG=0,this.posN=0,this.negN=0,this.pos=0,this.neg=0,this.qualA=0,this.qualT=0,this.qualC=0,this.qualG=0,this.qualN=0,this.qual=0,this.total=0}isMismatch(e){var t,n=this,i=Ta.threshold*(Ta.qualityWeight&&this.qual?this.qual:this.total);return t=0,["A","T","C","G"].forEach((function(i){i!==e&&(t+=Ta.qualityWeight&&n.qual?n["qual"+i]:n["pos"+i]+n["neg"+i])})),t>=i}}class za{constructor(e,t,n){this.start=e,this.end=t,this.counts=n}popupData(e){return[{name:"start",value:this.start+1},{name:"end",value:this.end},{name:"# downsampled:",value:this.counts}]}}class Ia{constructor(e){this.firstAlignment=e,this.chr=e.chr,this.readName=e.readName,e.start<e.mate.position?(this.start=e.start,this.end=Math.max(e.mate.position,e.start+e.lengthOnRef),this.connectingStart=e.start+e.lengthOnRef,this.connectingEnd=e.mate.position):(this.start=e.mate.position,this.end=e.start+e.lengthOnRef,this.connectingStart=e.mate.position,this.connectingEnd=e.start),this.lengthOnRef=this.end-this.start}setSecondAlignment(e){this.secondAlignment=e,e.start>this.firstAlignment.start?(this.end=e.start+e.lengthOnRef,this.connectingEnd=e.start):(this.start=e.start,this.connectingStart=e.start+e.lengthOnRef),this.lengthOnRef=this.end-this.start}popupData(e){var t=[];return t=t.concat(this.firstAlignment.popupData(e)),this.secondAlignment&&(t.push("-------------------------------"),t=t.concat(this.secondAlignment.popupData(e))),t}isPaired(){return!0}firstOfPairStrand(){return this.firstAlignment.isFirstOfPair()?this.firstAlignment.strand:this.secondAlignment?this.secondAlignment.strand:this.firstAlignment.strand}}class Oa{constructor(){this.alignments=[],this.score=void 0}findCenterAlignment(e,t){var n=void 0;return this.alignments.forEach((function(i){void 0===n&&(i.start+i.lengthOnRef<e||i.start>t||(n=i))})),n}updateScore(e,t,n){this.score=this.caculateScore(e,1+e,t,n)}caculateScore(e,t,n,i){var r,o;return void 0===(o=this.findCenterAlignment(e,t))?Number.MAX_VALUE:"NUCLEOTIDE"===i.sort?(r=void 0,o.blocks.forEach((function(t){var i,o,a,s,l,c=n.sequence,h=n.coverageMap;if("*"!==t.seq)for(var u=0,f=t.start-n.start,d=t.start,p=t.seq.length;u<p;u++,f++,d++)e===d&&(i=c.charAt(f),"="===(o=t.seq.charAt(u))&&(o=i),"N"===o?r=2:o===i?r=3:"X"===o||o!==i?(s=(a=h.coverage[d-h.bpStart])["pos"+o]+a["neg"+o],l=a.qual?a.qual:0,r=-(s+l/1e3)):console.log("BamAlignmentRow.caculateScore - huh?"));else r=3})),void 0===r?Number.MAX_VALUE:r):"STRAND"===i.sort?o.strand?1:-1:"START"===i.sort?o.start:Number.MAX_VALUE}}function Fa(e){for(var t=0,n=e.length,i={};t<n;){var r,o=String.fromCharCode(e[t])+String.fromCharCode(e[t+1]),a=String.fromCharCode(e[t+2]);if("A"==a)r=String.fromCharCode(e[t+3]),t+=4;else if("i"===a||"I"===a)r=ba(e,t+3),t+=7;else if("c"===a||"C"===a)r=e[t+3],t+=4;else if("s"===a||"S"===a)r=ya(e,t+3),t+=5;else if("f"===a)r=Ea(e,t+3),t+=7;else{if("Z"!==a){r="Error unknown type: "+a,i[o]=r;break}for(t+=3,r="";;){var s=e[t++];if(0===s)break;r+=String.fromCharCode(s)}}i[o]=r}return i}class Ba{constructor(e){this.config=e||{}}getFileHeader(){return this.is_indexed=!0,new Promise((function(e,t){e()}))}getFeatures(e,t,n,i,r){if(this.is_indexed)return this._getFeatures(e,t,n,i,r);var o=this;return new Promise((function(a,s){o.getFileHeader().then((function(){o._getFeatures(e,t,n,i,r).then((function(e){a(e)})).catch(s)})).catch(s)}))}_getFeatures(e,t,n,i,r){0===t&&(t=1);var o=this;return o.time=Date.now(),new Promise((function(a,s){o.featureCache&&e!==o.featureCache.range.chr&&(o.featureCache=null);var l=new Xa(e,t,n),c=o.featureCache,h=o.config.maxRows||500;let u=!1;if(c?void 0!==c.range&&(u=c.range.rangesToGet(l)):u={all:[t,n]},u){let c=[],f=[];for(let t in u){let n=u[t];c.push(o.retrieveFeatures(e,n[0],n[1],i,r)),f.push([t,u[t]])}Promise.all(c).then((function(i){let r=[];o.featureCache&&(r=o.featureCache.allFeatures());let s=0;for(let e of i){if(null===e&&(e=[]),"left"===f[s][0]){let t=f[s][1][1],n=0;for(let i=e.length-1;i>=0&&!(e[i].end<t);i--)n++;0!==n&&e.splice(-n)}if("right"===f[s][0]){let t=f[s][1][0],n=0;for(n=0;n<e.length&&!(e[n].start>t);n++);0!==n&&e.splice(0,n)}s++,r=r.concat(e)}let c=o.featureCache?o.featureCache.range:l;o.featureCache=new qa(r,c),Ba.packFeatures(r,h),a(o.featureCache.queryFeatures(e,t,n))})).catch((function(e){s(e)}))}else a(o.featureCache.queryFeatures(e,t,n))}))}static packFeatures(e,t){if(null!=e&&0!==e.length){var n={},i=[];e.forEach((function(e){var t=e.chr,r=n[t];r||(r=[],n[t]=r,i.push(t)),r.push(e)})),i.forEach((function(e){!function(e,t){var n=[];e.sort((function(e,t){return e.start-t.start})),n.push(-1e3),e.forEach((function(e){var i,r=Math.min(n.length,t),o=e.start;for(i=0;i<r;i++)if(o>=n[i])return e.row=i,void(n[i]=e.end);e.row=i,n[i]=e.end}))}(n[e],t)}))}}}class Na extends Ba{constructor(e,t){super(e),this.reader=new Ua(e,t)}retrieveFeatures(e,t,n){return this.reader.readFeatures(e,t,n)}getFileHeader(){var e=this;return new Promise((function(t,n){e.reader.readHeader().then((function(){e.is_indexed=!0,t()})).catch(n)}))}}class Ha extends Ba{constructor(e,t){e.sourceType="gtex",super(e),this.header=!0,this.feature_source=new Jo(e,t)}retrieveFeatures(e,t,n,i,r){return this.feature_source.getFeatures(e,t,n,!1,r)}}class Ua{constructor(e,t){if(this.config=e||{},e.localFile)this.localFile=e.localFile,this.filename=e.localFile.name;else{this.url=e.url,this.indexURL=e.indexURL,this.headURL=e.headURL||this.filename;var n=ha.parseUri(e.url);this.filename=n.file,this.path=n.path}this.format=e.format,this.parser=this.getParser(this.format,t)}getParser(e,t){switch(e){case"vcf":return new VcfParser;case"seg":return new SegParser;default:return new Wa(e,t,this.config)}}isIndexable(){var e=this.config.indexURL,t=this.type,n=this.config.indexed;return e||"wig"!=t&&0!=n}loadIndex(){var e=this.indexURL;return this.filename.endsWith(".gz")?(e||(e=this.url+".tbi"),ua(e,this.config,!0)):(e||(e=this.url+".idx"),loadTribbleIndex(e,this.config))}loadFeaturesNoIndex(){var e=this;return new Promise((function(t,n){var i=e.parser,r={headers:e.config.headers,withCredentials:e.config.withCredentials};function o(n){e.header=i.parseHeader(n),e.header instanceof String&&e.header.startsWith("##gff-version 3")&&(e.format="gff3"),t(i.parseFeatures(n))}e.localFile?Xo.loadStringFromFile(e.localFile,r).then(o).catch(n):Xo.loadString(e.url,r).then(o).catch(n)}))}loadFeaturesWithIndex(e,t,n){var i=this;return new Promise((function(r,o){var a,s=i.index,l=s&&s.tabix?s.sequenceIndexMap[e]:e,c=[];(a=s.getBlocksForRange(l,t,n))&&0!==a.length?(a.forEach((function(r){c.push(new Promise((function(o,a){var l,c=r.minv.block,h=r.minv.offset,u=r.maxv.block+(s.tabix?65536:0),f={headers:i.config.headers,range:{start:c,size:u-c+1},withCredentials:i.config.withCredentials};l=function(r){var a,l;a=s.tabix?Xo.arrayBufferToString(Yo(r)):r,l=h?a.slice(h):a;var c=i.parser.parseFeatures(l,e,t,n);o(c)},i.localFile?Xo.loadStringFromFile(i.localFile,f).then(l).catch(a):s.tabix?Xo.loadArrayBuffer(i.url,f).then(l).catch(a):Xo.loadString(i.url,f).then(l).catch(a)})))})),Promise.all(c).then((function(e){var t,n;if(1===e.length)n=e[0];else{for(n=e[0],t=1;t<e.length;t++)n=n.concat(e[t]);n.sort((function(e,t){return e.start-t.start}))}r(n)})).catch(o)):r(null)}))}getIndex(){var e=this,t=this.isIndexable();return new Promise((function(n,i){void 0===e.indexed&&t?e.loadIndex().then((function(t){t?(e.index=t,e.indexed=!0):e.indexed=!1,n(e.index)})).catch(i):n(e.index)}))}readHeader(){var e=this;return new Promise((function(t,n){e.header?t(e.header):e.getIndex().then((function(i){if(i){var r={headers:e.config.headers,bgz:i.tabix,range:{start:0,size:65e3},withCredentials:e.config.withCredentials},o=function(n){e.header=e.parser.parseHeader(n),t(e.header)};e.localFile?Xo.loadStringFromFile(e.localFile,r).then(o):Xo.loadString(e.url,r).then(o).catch(n)}else e.loadFeaturesNoIndex(void 0).then((function(n){var i=e.header||{};i.features=n,t(i)})).catch(error)})).catch(n)}))}readFeatures(e,t,n){var i=this;return new Promise((function(r,o){function a(e){r(e)}i.index?i.loadFeaturesWithIndex(e,t,n).then(a).catch(o):i.loadFeaturesNoIndex().then(a)}))}}const $a=Number.MAX_VALUE,ja=["Name","gene_name","gene","gene_id","alias","locus"];class Wa{constructor(e,t,n){this.format=e,this.nameField=n?n.nameField:void 0,this.skipRows=0,t?(this.delimiter=/\s+/,this.decode=function(e,n){let i={chr:e[0],start:parseInt(e[1]),end:parseInt(e[2])};return t(e.slice(3),i),i}):"generic"===n.decode_function?this.decode=function(e,t){let n={chr:e[0],start:parseInt(e[1]),end:parseInt(e[2])};return n.data=e.slice(3),n}:(this.decode="decodeRefflat"===n.decode_function?Wa.decodeRefflat:Wa.decodeBed,this.delimiter=/\s+/)}parseHeader(e){var t,n,i,r=e.split("\n"),o=r.length;for(n=0;n<o;n++){if(!((t=r[n]).startsWith("track")||t.startsWith("#")||t.startsWith("browser"))){i={};break}t.startsWith("track")?i=this.parseTrackLine(t):t.startsWith("##gff-version 3")&&(this.format="gff3",i||(i={}),i.format="gff3")}return i}parseFeatures(e,t,n,i){if(!e)return null;var r,o,a,s,l,c,h=e.split("\n"),u=h.length,f=[],d=0,p=(this.decode,this.format),g=this.delimiter||"\t";for(l=this.skipRows;l<u;l++)if(!((s=h[l]).startsWith("track")||s.startsWith("#")||s.startsWith("browser")))if("wig"===p&&s.startsWith("fixedStep"))r=this.parseFixedStep(s);else if("wig"===p&&s.startsWith("variableStep"))r=this.parseVariableStep(s);else if(!((a=h[l].split(g)).length<1||"wig"!==p&&a.length<3))if(o=this.decode(a,r)){if(o.chr!==t||o.end<n||o.start>i)continue;f.length<$a?f.push(o):(c=Math.floor(Math.random()*d))<$a&&(f[c]=o),d++}else console.log(null);return f}static parseFixedStep(e){var t=e.split(/\s+/);return{format:"fixedStep",chrom:t[1].split("=")[1],start:parseInt(t[2].split("=")[1],10),step:parseInt(t[3].split("=")[1],10),span:t.length>4?parseInt(t[4].split("=")[1],10):1,index:0}}static parseVariableStep(e){var t=e.split(/\s+/);return{format:"variableStep",chrom:t[1].split("=")[1],span:t.length>2?parseInt(t[2].split("=")[1],10):1}}static parseTrackLine(e){var t,n,i,r={},o=e.split(/(?:")([^"]+)(?:")|([^\s"]+)(?=\s+|$)/g),a=[];for(t=1;t<o.length;t++)o[t]&&0!==o[t].trim().length&&((n=o[t].trim()).endsWith("=")>0?i=n:i?(a.push(i+n),i=void 0):a.push(n));return a.forEach((function(e){if(e){var t=e.split("=",2);2==t.length&&(r[t[0]]=t[1])}})),r}static decodeBed(e,t){var n,i,r,o,a,s,l,c,h,u,f,d;if(e.length<3)return null;if(u={chr:e[0],start:n=parseInt(e[1]),end:e.length>2?parseInt(e[2]):n+1,score:1e3},e.length>3){a=(o=e[3].replace(/"/g,"")).split(";");for(var p=0;p<a.length;p++){var g=a[p].split("=");"gene_id"==g[0]&&(i=g[1]),"gene_name"==g[0]&&(r=g[1])}u.id=i||o,u.name=r||o}if(e.length>4&&(u.score=parseFloat(e[4])),e.length>5&&(u.strand=e[5]),e.length>6&&(u.cdStart=parseInt(e[6])),e.length>7&&(u.cdEnd=parseInt(e[7])),e.length,e.length>11){for(s=parseInt(e[9]),l=e[10].split(","),c=e[11].split(","),h=[],p=0;p<s;p++){var m={start:f=n+parseInt(c[p]),end:d=f+parseInt(l[p])};(u.cdStart>d||u.cdEnd<u.cdStart)&&(m.utr=!0),u.cdStart>=f&&u.cdStart<=d&&(m.cdStart=u.cdStart),u.cdEnd>=f&&u.cdEnd<=d&&(m.cdEnd=u.cdEnd),h.push(m)}u.exons=h}return u}static decodeRefflat(e,t){if(e.length<10)return null;if(void 0===e[10])return console.log(e[1]),null;for(var n={chr:e[2],start:parseInt(e[4]),end:parseInt(e[5]),id:e[1],name:e[0],strand:e[3],cdStart:parseInt(e[6]),cdEnd:parseInt(e[7])},i=parseInt(e[8]),r=e[9].split(","),o=e[10].split(","),a=[],s=0;s<i;s++){let e={start:parseInt(r[s]),end:parseInt(o[s])};(n.cdStart>e.end||n.cdEnd<n.cdStart)&&(e.utr=!0),n.cdStart>=e.start&&n.cdStart<=e.end&&(e.cdStart=n.cdStart),n.cdEnd>=e.start&&n.cdEnd<=e.end&&(e.cdEnd=n.cdEnd),a.push(e)}return n.exons=a,n}static decodePeak(e,t){var n,i,r,o,a,s,l;return e.length<9?null:(n=e[0],i=parseInt(e[1]),r=parseInt(e[2]),a=e[3],s=parseFloat(e[4]),o=e[5].trim(),l=parseFloat(e[6]),0===s&&(s=l),{chr:n,start:i,end:r,name:a,score:s,strand:o,signal:l,pValue:parseFloat(e[7]),qValue:parseFloat(e[8])})}static decodeBedGraph(e,t){return e.length<3?null:{chr:e[0],start:parseInt(e[1]),end:parseInt(e[2]),value:parseFloat(e[3])}}static decodeWig(e,t){var n,i,r;return"fixedStep"===t.format?(i=(n=t.index*t.step+t.start)+t.span,r=parseFloat(e[0]),++t.index,isNaN(r)?null:{chr:t.chrom,start:n,end:i,value:r}):"variableStep"===t.format?e.length<2?null:(i=(n=parseInt(e[0],10))+t.span,r=parseFloat(e[1]),isNaN(r)?null:{chr:t.chrom,start:n,end:i,value:r}):decodeBedGraph(e)}static decodeAneu(e,t){var n,i,r,o;return e.length<4?null:(n=e[1],i=parseInt(e[2]),r=e.length>3?parseInt(e[3]):i+1,o={chr:n,start:i,end:r},e.length>4&&(o.score=parseFloat(e[4]),o.value=o.score),o.popupData=function(){return[{name:"Name",value:o.name}]},o)}static decodeFusionJuncSpan(e,t){var n=e[0],i=e[1],r=parseInt(e[2]),o=parseInt(e[3]),a=parseInt(e[4]),s=parseInt(e[5]),l=e[6],c={chr:n,name:i,junction_left:r,junction_right:o,num_junction_reads:a,num_spanning_frags:s,spanning_frag_coords:[],start:-1,end:-1},h=r,u=o;if(s>0)for(var f=l.split(","),d=0;d<f.length;d++){var p=f[d].split("-"),g=p[0],m=p[1];g<h&&(h=g),m>u&&(u=m),c.spanning_frag_coords.push({left:g,right:m})}return c.start=h,c.end=u,c.popupData=function(){return[{name:"Name",value:c.name}]},c}static decodeGtexGWAS(e,t){return e.length<8?null:{chr:e[0],start:parseInt(e[1])-1,end:parseInt(e[3].split(":")[1]),pvalue:parseFloat(e[5])}}static decodeGFF(e,t){var n,i,r,o,a,s,l,c,h,u,f,d,p=this.format;if(e.length<9)return null;n=e[0],a=e[2],i=parseInt(e[3])-1,r=parseInt(e[4]),s="."===e[5]?0:parseFloat(e[5]),o=e[6],"."===e[7]||parseInt(e[7]),l=e[8];var g="gff3"===p?"=":/\s+/,m={};if(l.split(";").forEach((function(e){var t,n,i=e.trim().split(g,2);2==i.length&&(t=i[0].trim(),(n=i[1].trim()).startsWith('"')&&n.endsWith('"')&&(n=n.substr(1,n.length-2)),"ID"===i[0]?c=i[1]:"Parent"===i[0]?h=i[1]:"color"===i[0].toLowerCase()?u=igv.createColorString(i[1]):"transcript_id"===i[0]&&(c=i[1]),m[t]=n)})),this.nameField)f=m[this.nameField];else for(d=0;d<ja.length;d++)if(m.hasOwnProperty(ja[d])){this.nameField=ja[d],f=m[this.nameField];break}return{id:c,parent:h,name:f,type:a,chr:n,start:i,end:r,score:s,strand:o,color:u,attributeString:l,popupData:function(){var e,t,n=this.attributeString.split(";"),i=[];return n.forEach((function(n){var r=n.trim().split(g,2);2===r.length&&void 0!==r[1]&&(e=r[0].trim(),(t=r[1].trim()).startsWith('"')&&t.endsWith('"')&&(t=t.substr(1,t.length-2)),i.push({name:e,value:t}))})),i}}}decodeCustom(e,t){var n,i,r,o,a=this.format,s=a.coords||0;return e.length<3?null:(i=e[a.chr],r=parseInt(e[a.start])-s,o=void 0!==a.end?parseInt(e[a.end]):r+1,n={chr:i,start:r,end:o},a.fields&&a.fields.forEach((function(t,i){i!=a.chr&&i!=a.start&&i!=a.end&&(n[t]=e[i])})),n)}}class qa{constructor(e,t){this.treeMap=qa.buildTreeMap(e),this.range=t}queryFeatures(e,t,n){var i,r,o,a,s,l,c;return(l=this.treeMap[e])?0==(c=l.findOverlapping(t,n)).length?[]:(i=[],c.forEach((function(e){for(r=e.value,a=r.length,s=0;s<a&&!((o=r[s]).start>n);s++)o.end>=t&&i.push(o)})),i):[]}allFeatures(){var e=[],t=this.treeMap;if(t)for(var n in t)t.hasOwnProperty(n)&&t[n].mapIntervals((function(t){e=e.concat(t.value)}));return e}static buildTreeMap(e){var t={},n=[],i={};if(e){e.forEach((function(e){var i,r=e.chr;(i=t[r])||(n.push(r),i=[],t[r]=i),i.push(e)}));for(let e=0;e<n.length;e++){let r=n[e];i[r]=qa.buildIntervalTree(t[r])}}return i}static buildIntervalTree(e){var t,n,i,r,o,a,s,l;for(o=new Ka,s=e.length,a=Math.max(10,Math.round(s/100)),e.sort((function(e,t){return e.start===t.start?0:e.start>t.start?1:-1})),t=0;t<s;t+=a)n=Math.min(s,t+a),i=(l=e.slice(t,n))[0].start,r=i,l.forEach((function(e){r=Math.max(r,e.end)})),o.insert(i,r,l);return o}}let Va={color:1};Va.parent=Va,Va.left=Va,Va.right=Va;class Ka{constructor(){this.root=Va}insert(e,t,n){var i=new Ga(e,t,n),r=new Za(i);for(this.treeInsert(r),r.color=2;r!=this.root&&2==r.parent.color;){var o;r.parent==r.parent.parent.left?2==(o=r.parent.parent.right).color?(r.parent.color=1,o.color=1,r.parent.parent.color=2,r=r.parent.parent):(r==r.parent.right&&(r=r.parent,this.leftRotate(r)),r.parent.color=1,r.parent.parent.color=2,this.rightRotate(r.parent.parent)):2==(o=r.parent.parent.left).color?(r.parent.color=1,o.color=1,r.parent.parent.color=2,r=r.parent.parent):(r==r.parent.left&&(r=r.parent,this.rightRotate(r)),r.parent.color=1,r.parent.parent.color=2,this.leftRotate(r.parent.parent))}this.root.color=1}findOverlapping(e,t){var n=new Ga(e,t,0);if(this.root===Va)return[];var i=this.searchAll(n,this.root,[]);return i.length>1&&i.sort((function(e,t){return e.low-t.low})),i}logIntervals(){!function e(t,n){for(var i="",r=0;r<n;r++)i+=" ";console.log(i+t.interval.low+" "+t.interval.high),n+=5,t.left!=Va&&e(t.left,n),t.right!=Va&&e(t.right,n)}(this.root,0)}mapIntervals(e){!function t(n){e(n.interval),n.left!=Va&&t(n.left),n.right!=Va&&t(n.right)}(this.root)}searchAll(e,t,n){return t.interval.overlaps(e)&&n.push(t.interval),t.left!=Va&&t.left.max>=e.low&&this.searchAll(e,t.left,n),t.right!=Va&&t.right.min<=e.high&&this.searchAll(e,t.right,n),n}leftRotate(e){var t=e.right;e.right=t.left,t.left!=Va&&(t.left.parent=e),t.parent=e.parent,e.parent==Va?this.root=t:e.parent.left==e?e.parent.left=t:e.parent.right=t,t.left=e,e.parent=t,this.applyUpdate(e)}rightRotate(e){var t=e.left;e.left=t.right,t.right!=Va&&(t.right.parent=e),t.parent=e.parent,e.parent==Va?this.root=t:e.parent.right==e?e.parent.right=t:e.parent.left=t,t.right=e,e.parent=t,this.applyUpdate(e)}treeInsert(e){for(var t=this.root,n=Va;t!=Va;)n=t,t=e.interval.low<=t.interval.low?t.left:t.right;e.parent=n,n==Va?(this.root=e,e.left=e.right=Va):e.interval.low<=n.interval.low?n.left=e:n.right=e,this.applyUpdate(e)}applyUpdate(e){for(;e!=Va;){var t=e.left.max>e.right.max?e.left.max:e.right.max,n=e.interval.high;e.max=t>n?t:n;var i=e.left.min<e.right.min?e.left.min:e.right.min,r=e.interval.low;e.min=i<r?i:r,e=e.parent}}}class Ga{constructor(e,t,n){this.low=e,this.high=t,this.value=n}equals(e){return!!e&&(this==e||this.low==otherInterval.low&&this.high==otherInterval.high)}compareTo(e){return this.low<e.low?-1:this.low>e.low?1:this.high<e.high?-1:this.high>e.high?1:0}overlaps(e){try{return this.low<=e.high&&e.low<=this.high}catch(e){igv.presentAlert(e)}}}class Za{constructor(e){this.parent=Va,this.left=Va,this.right=Va,this.interval=e,this.color=2}}class Xa{constructor(e,t,n,i){this.chr=e,this.start=t,this.end=n,this.features=i}contains(e,t,n){return this.chr==e&&this.start<=t&&this.end>=n}containsRange(e){return this.chr===e.chr&&this.start<=e.start&&this.end>=e.end}rangesToGet(e){let t=!1,n={};return this.chr!==e.chr?(n.all=[e.start,e.end],t=!0,this.start=e.start,this.end=e.end):(e.start<this.start&&(n.left=[e.start,this.start],t=!0,this.start=e.start),e.end>this.end&&(n.right=[this.end,e.end],t=!0,this.end=e.end)),!!t&&n}}class Ya{constructor(e){this.file=e,this.indexed=!0,this.indexed&&(this.indexFile=this.file+".fai")}init(){var e=this;return e.indexed?new Promise((function(t,n){e.getIndex().then((function(n){var i=0;e.chromosomes={},e.chromosomeNames.forEach((function(t){var n=e.index[t].size;e.chromosomes[t]=new igv.Chromosome(t,i++,n)})),t()})).catch(n)})):e.loadAll()}getSequence(e,t,n){return this.indexed?this.getSequenceIndexed(e,t,n):getSequenceNonIndexed.this(e,t,n)}getSequenceIndexed(e,t,n){var i=this;return new Promise((function(r,o){var a=i.interval;if(a&&a.contains(e,t,n))r(u(a,t,n));else{var s=t,l=n;if(n-t<1e5){var c=n-t,h=Math.round(t+c/2);s=Math.max(0,h-5e4),l=h+5e4}i.readSequence(e,s,l).then((function(o){i.interval=new Xa(e,s,l,o),r(u(i.interval,t,n))})).catch(o)}function u(e,t,n){var i=t-e.start,r=n-t;return e.features?e.features.substr(i,r):null}}))}getSequenceNonIndexed(e,t,n){var i=this;return new Promise((function(r,o){var a=i.sequences[e];a&&a.length>n&&r(a.substring(t,n))}))}getIndex(){var e=this;return new Promise((function(t,n){e.index?t(e.index):Xo.load(e.indexFile,{}).then((function(n){var i=n.split("\n"),r=i.length,o=0;for(e.chromosomeNames=[],e.index={};o<r;){var a=i[o++].split("\t");if(5==a.length){var s=a[0],l={size:parseInt(a[1]),position:parseInt(a[2]),basesPerLine:parseInt(a[3]),bytesPerLine:parseInt(a[4])};e.chromosomeNames.push(s),e.index[s]=l}}t&&t(e.index)})).catch(n)}))}loadAll(){var e=this;return new Promise((function(t,n){e.chromosomeNames=[],e.chromosomes={},e.sequences={},Xo.load(e.file,{withCredentials:e.withCredentials}).then((function(n){for(var i,r,o=n.splitLines(),a=o.length,s=0,l="",c=0;s<a;)(i=o[s++].trim()).startsWith("#")||0===i.length||(i.startsWith(">")?(l&&(e.chromosomeNames.push(r),e.sequences[r]=l,e.chromosomes[r]=new igv.Chromosome(r,c++,l.length)),r=i.substr(1).split("\\s+")[0],l=""):l+=i);t()}))}))}readSequence(e,t,n){var i=this;return new Promise((function(r,o){i.getIndex().then((function(){var a=i.index[e];if(a){var s=Math.max(0,t),l=Math.min(a.size,n),c=a.bytesPerLine,h=a.basesPerLine,u=a.position,f=c-h,d=Math.floor(s/h),p=Math.floor(l/h),g=s-d*h,m=u+d*c+g,_=u+p*c+(l-p*h)-1-m+1;_<=0&&r(null),Xo.load(i.file,{range:{start:m,size:_}}).then((function(e){var t,n="",i=0,o=e.length;for(g>0&&(t=Math.min(l-s,h-g),n+=e.substr(i,t),i+=t+f);i<o;)t=Math.min(h,o-i),n+=e.substr(i,t),i+=t+f;r(n)})).catch(o)}else console.log("No index entry for chr: "+e),i.interval=new Xa(e,t,n,null),r(null)})).catch(o)}))}}class Qa{constructor(e){this.config=e}_setFeatureSource(){}drawScale(e){}getConfig(){return JSON.parse(JSON.stringify(this.config))}setConfigAttribute(e,t){this.config[e]=t,"url"===e&&this._setFeatureSource()}setColorFunction(e){this.color_function=e}getFeatureAt(e,t,n,i){return null}setConfig(e){this.config.url!==e.url?(this.config=e,this._setFeatureSource()):this._setFeatureSource()}getFeatures(e,t,n,i,r){return this.feature_source.getFeatures(e,t,n,i,r)}getSettings(e){return[{type:"slider",min:10,max:1e3,label:"Height",current_value:this.config.height,func:t=>{this.setConfigAttribute("height",t),e.update()}}]}static calculateLabel(e){"string"!=typeof e&&(e=e[0]);let t=e.split("/"),n=t[t.length-1];return t=n.split("."),n=t[0],n}addExtraControls(e,t){}static getTypeFromURL(e){let t={};return"string"!=typeof e||(e.endsWith("bw")?(t.type="bigwig",t.format="wig"):e.endsWith(".bed.gz")?(t.type="bed",t.format="feature"):e.endsWith(".bb")&&!t.type?(t.type="bigbed",t.format="feature"):e.endsWith(".fasta")?(t.type="fasta",t.format="sequence"):e.endsWith(".bam")&&(t.type="bam",t.format="alignment")),t}static parseConfig(e){let t=JSON.parse(JSON.stringify(e));if(!t.type&&t.url){let e=Qa.getTypeFromURL(t.url);e.type&&(t.type=e.type,t.format=e.format)}return"bed"!==t.type&&"bigbed"!==t.type||(t.format="feature"),!t.short_label&&t.url&&(t.short_label=Qa.calculateLabel(t.url)),t.track_id||(t.track_id=t.url),"feature"===t.format&&(t.displayMode=t.displayMode||"COLLAPSED",t.labelDisplayMode="SLANT",t.squishedCallHeight=t.squishedCallHeight||30,t.expandedCallHeight=t.expandedCallHeight||15,t.featureHeight=t.featureHeight||12),"wig"!==t.format&&"bigwig"!==t.type||(t.scale||(t.scale="dynamic"),t.min_y||(t.min_y=0),t.max_y||(t.max_y=100),t.height||(t.height=100)),"bam"===t.type&&(t.featureHeight||(t.featureHeight=12)),t.height||(t.height=100),t.color||"bam"===t.type&&(t.color="#D3D3D3"),t.opacity||(t.opacity=1),t}drawMessage(e){const t=e.context;t.save(),t.font="15px Verdana";const n=t.measureText(e.features),i=e.top+e.height/2+20;t.fillStyle=e.textColor;for(let r=0;r<e.pixelWidth;r+=n.width+10)t.fillText(e.features,r,i);t.restore()}static getTrack(e){e=Qa.parseConfig(e);let t=Qa.track_types[e.type];if(!t)throw new Error("Track type "+e.type+" not recognised");return new t.class(e)}}Qa.custom_tracks={},Qa.track_types={};class Ja extends Qa{constructor(e){e||(e={track_id:"ruler"+Ja.count,format:"ruler",short_label:"Ruler",type:"ruler"}),super(e),this.height=30,this.config.height=30,this.name="",this.disableButtons=!0,this.ignoreTrackMenu=!0,this.order=-Number.MAX_VALUE,Ja.count++}getFeatures(e,t,n){return new Promise((function(e,t){e([])}))}drawFeatures(e){var t,n,i,r,o,a,s=e.context;t={textAlign:"center",font:"10px PT Sans",fillStyle:e.textColor,strokeStyle:e.textColor},n=Math.floor(1100*e.bpPerPixel),r=(i=Ja.findSpacing(n)).majorTick,o=Math.floor(e.bpStart/r)-1,a=0;let l=e.top+this.height;for(is.setProperties(s,t);a<e.pixelWidth;){var c=Math.floor(o*r),h=2;a=Math.round((c-1-e.bpStart+.5)/e.bpPerPixel);var u=f(c/i.unitMultiplier,0)+" "+i.majorUnit;o%1==0&&is.fillText(s,u,a,l-15),is.strokeLine(s,a,l-10,a,l-h),o++}function f(e,t){var n=10;switch(t){case 0:n=1;break;case 1:n=10;break;case 2:n=100;break;default:n=1e3}var i=""+Math.abs(Math.round(e*n)/n);-1==i.indexOf(".")&&(i+=".");for(var r=i.substr(0,i.indexOf(".")),o=r-0,a=i.substr(i.indexOf("."));a.length-1<t;)a+="0";if("."==a&&(a=""),o>=1e3){var s=r.length;r=parseInt(""+o/1e3)+","+r.substring(s-3,s)}o>=1e6&&(s=r.length,r=parseInt(""+o/1e6)+","+r.substring(s-7,s));var l=r+a;return e<0&&(l="("+l+")"),l}return is.strokeLine(s,0,l-h,e.pixelWidth,l-h),l}static findSpacing(e){if(e<10)return new es(1,"",1);var t,n,i=Math.floor((t=e,n=Math.log(10),Math.log(t)/n)),r="",o=1;i>9&&(r="gb",o=1e9),i>6?(r="mb",o=1e6):i>3&&(r="kb",o=1e3);var a=e/Math.pow(10,i-1);return new es(a<25?Math.pow(10,i-1):Math.pow(10,i)/2,r,o)}}Ja.count=0,Qa.track_types.ruler={class:Ja,name:"Ruler"};class es{constructor(e,t,n){this.majorTick=e,this.majorUnit=t,this.unitMultiplier=n}}class ts extends Qa{constructor(e){super(e),this._setFeatureSource(),this.filter_function=null,this.color_function=null}_setFeatureSource(){this.feature_source=new Na(this.config)}setFilterFunction(e){this.filter_function=e}getCurrentFeatures(e,t,n){return this.feature_source.featureCache.queryFeatures(e,t,n)}drawFeatures(e){let t=0;var n,i=e.features,r=e.context,o=e.bpPerPixel,a=e.bpStart,s=e.pixelWidth,l=(e.pixelHeight,a+s*o+1);let c=0;e.top&&(c=e.top),this.top=c;let h=this.config,u=0+s;this.config.squishedCallHeight=this.config.featureHeight+10,this.config.expandedCallHeight=this.config.featureHeight/2+2;let f=null;if(i.length>5e4&&(f=Math.round(i.length/5e4)+1),i){let m=this.config.opacity?this.config.opacity:1;r.globalAlpha=m;for(var d,p=0,g=i.length;p<g;p++){if(f&&p%f!=0)continue;if(d=i[p],this.filter_function&&!this.filter_function(d)){d.display=!1;continue}if(d.display=!0,d.end<a)continue;if(d.start>l)break;let g=this.calculateFeatureCoordinates(d,a,o),m=h.featureHeight;"SQUISHED"===h.displayMode&&null!=d.row?(m=h.featureHeight/2,n=h.expandedCallHeight*d.row+2):n="EXPANDED"===h.displayMode&&null!=d.row?h.squishedCallHeight*d.row+5:5,(n+=c)+m>t&&(t=n+m),g.py=n,g.h=m;let _={bpPerPixel:o,bpStart:a,pixelWidth:s};this.color_function&&(d.color=this.color_function(d)),this.renderFeature(d,g,r,_,e.textColor),this.renderFeatureLabel(r,d,g.px,g.px1,n,0,u,e.textColor)}r.globalAlpha=1}else console.log("No feature list");return this.bottom=t,"COLLAPSED"===this.config.displayMode&&(t+=25),t}renderFeatureLabel(e,t,n,i,r,o,a,s){let l=this.config;var c,h,u,f,d,p;i<o||n>a?(u=n,f=i):(u=Math.max(n,o),f=Math.min(i,a));let g=t.name;this.label_function&&(g=this.label_function(t)),f-u>e.measureText(g).width&&"SQUISHED"!=l.displayMode&&g&&(c={font:"10px PT Sans",textAlign:"center",fillStyle:l.color||s,strokeStyle:l.color||s},"COLLAPSED"===l.displayMode&&"SLANT"===l.labelDisplayMode&&(h={rotate:{angle:45}},delete c.textAlign),d=u+(f-u)/2,p=function(e,t){return t?e+l.featureHeight+14:e+l.featureHeight+7}(r,h),is.fillText(e,g,d,p,c,h))}calculateFeatureCoordinates(e,t,n){var i=Math.round((e.start-1-t)/n),r=Math.round((e.end-t)/n),o=r-i;return o<3&&(o=3,i-=1),{px:i,px1:r,pw:o}}renderFeature(e,t,n,i,r){var o,a,s,l,c,h,u,f,d,p,g,m=this.config.color||r;e.color&&(m=e.color),n.fillStyle=m,n.strokeStyle=m,p=(s=t.py+t.h/2)-(g=t.h/2)/2;let _=e.exons?e.exons.length:0;if(0==_)n.fillRect(t.px,t.py,t.pw,t.h);else{for(t.px=Math.max(t.px,0),t.px1=Math.min(t.px1,i.pixelWidth),is.strokeLine(n,t.px+1,s,t.px1-1,s),l="+"==e.strand?1:-1,a=t.px+10;a<t.px1;a+=20)is.strokeLine(n,a-2*l,s-2,a,s),is.strokeLine(n,a-2*l,s+2,a,s);for(o=0;o<_;o++)if(c=e.exons[o],h=Math.round((c.start-i.bpStart)/i.bpPerPixel),u=Math.round((c.end-i.bpStart)/i.bpPerPixel),d=Math.max(1,u-h),c.utr)n.fillRect(h,p,d,g);else if(c.cdStart&&(f=Math.round((c.cdStart-i.bpStart)/i.bpPerPixel),n.fillRect(h,p,f-h,g),d-=f-h,h=f),c.cdEnd&&(f=Math.round((c.cdEnd-i.bpStart)/i.bpPerPixel),n.fillRect(f,p,u-f,g),d-=u-f,u=f),n.fillRect(h,t.py,d,t.h),d>25){for(n.fillStyle="white",n.strokeStyle="white",a=h+10;a<u;a+=20)is.strokeLine(n,a-2*l,s-2,a,s),is.strokeLine(n,a-2*l,s+2,a,s);n.fillStyle=m,n.strokeStyle=m}}}getFeatureAt(e,t,n,i){let r=n.y-this.top;if(this.feature_source.featureCache){var o,a=2*i,s=this.feature_source.featureCache.queryFeatures(t,e-a,e+a);if("COLLAPSED"!=this.config.displayMode)o=Math.floor("SQUISHED"===this.config.displayMode?r/this.config.expandedCallHeight:r/this.config.squishedCallHeight);else if(r<5||r>5+this.config.featureHeight)return;if(s&&s.length>0)for(let t of s)if(t.end>=e-a&&t.start<=e+a&&(void 0===o||void 0===t.row||o===t.row)&&t.display)return t}return null}}Qa.track_types.bed={class:ts,name:"bed(tabix)"},Qa.track_types.bigbed={class:class extends ts{constructor(e){super(e)}_setFeatureSource(){this.feature_source=new Ha(this.config)}},name:"BigBed"};class ns extends Qa{constructor(e){e.format="wig",super(e),this._setFeatureSource()}_setFeatureSource(){this.feature_source=new Jo(this.config)}drawScale(e,t,n){if(this.config.scale_link_to&&this.config.group)return;let i=this.top,r=this.bottom;t.fillStyle=n,t.strokeStyle=n,t.beginPath(),t.moveTo(0,i),t.lineTo(0,r),t.moveTo(0,i),t.lineTo(20,i),t.moveTo(0,r),t.lineTo(20,r),t.font="12px Arial",t.stroke(),t.textBaseline="top",null!=this.max_y&&(t.fillText(this.max_y.toFixed(2),20,i),t.textBaseline="alphabetic",t.fillText(this.min_y,20,r))}drawFeatures(e){let t,n=this,i=e.features,r=n.config.color,o=e.context,a=e.bpPerPixel,s=e.bpStart,l=e.pixelWidth,c=e.pixelHeight,h=e.top,u=s+l*a+1;if(c=this.config.group?e.height:this.config.height,r||(r="black"),n.prev_coords={x:0,y:0},i){if(n.scale_link_to){let e=n.scale_link_to.config;e&&(n.config.scale=e.scale,n.max_y=n.scale_link_to.max_y,n.min_y=n.scale_link_to.min_y)}else if(n.set_scale)n.min_y=n.set_scale.min,n.max_y=n.set_scale.max;else if(void 0===n.max_y&&"automatic"===n.config.scale||"dynamic"===n.config.scale){var f=function(e){var t=0,n=-Number.MAX_VALUE;return e.forEach((function(e){t=Math.min(t,e.value),n=Math.max(n,e.value)})),{min:t,max:n}}(i);n.min_y=f.min,n.max_y=f.max}else"fixed"===n.config.scale&&(n.min_y=n.config.min_y,n.max_y=n.config.max_y);if(t=n.max_y-n.min_y,o.globalAlpha=this.config.opacity?this.config.opacity:1,n.is_line){let e=(1-n.config.value/t)*c;is.strokeLine(o,0,e,l,e,{strokeStyle:n.config.color,lineWidth:n.config.width?n.config.width:1})}else i.forEach((function(e,i,l){var f,d,p,g,m,_,v;e.end<s||e.start>u||(e.end===e.start&&(e.start-=1),p=Math.floor((e.start-s)/a),v=Math.floor((e.end-s)/a),m=Math.max(0,v-p),function(e,t){return e>0&&t<0||e<0&&t>0}(n.min_y,n.max_y)?e.value<0?(f=n.max_y/t,d=-e.value/t):(f=(n.max_y-e.value)/t,d=e.value/t):n.min_y<0?(f=0,d=-e.value/t):(f=1-(e.value-n.min_y)/t,d=(e.value+n.min_y)/t),g=(g=f*c+h)<h?h:g,_=(_=d*c)>c?c:_,"line"===n.config.display?(n.prev_coords.x&&is.strokeLine(o,p,g,n.prev_coords.x,n.prev_coords.y,{strokeStyle:r,lineWidth:3}),n.prev_coords.x=p,n.prev_coords.y=g):is.fillRect(o,p,g,m,_,{fillStyle:r}))}));if(o.globalAlpha=1,n.config.threshold){let e=h+(1-n.config.threshold/t)*c;is.strokeLine(o,0,e,l,e,{strokeStyle:"black",lineWidth:1})}}return this.top=h,this.bottom=h+c,this.bottom}}Qa.track_types.bigwig={class:ns,name:"BigWig"},Qa.track_types.line={class:class extends ns{constructor(e){super(e),this.is_line=!0}getFeatures(e,t,n){return new Promise((function(e,t){e([])}))}},name:"Line Track"},Qa.track_types.fasta={class:class extends Qa{constructor(e){super(e),this._setFeatureSource(e),this.sequenceType=e.sequenceType||"dna",this.height=15}_setFeatureSource(e){this.feature_source=new Ya(e.url)}getFeatures(e,t,n,i,r){let o=this;return new Promise((function(i,a){r.bpPerPixel>1?i(null):o.feature_source.getSequence(e,t,n).then(i).catch(a)}))}drawFeatures(e){var t,n,i,r,o,a,s,l,c,h,u=e.features,f=e.context,d=e.bpPerPixel,p=e.bpStart,g=p+e.pixelWidth*d+1;let m=e.top;if(u)for(t=u.length,n=1/d,i=m+this.height/2,r=p;r<=g;r++)(o=r-p)<t&&(a=u[o],s=Math.floor(o*n),l=Math.floor((o+1)*n),c=Math.round((s+l)/2),(h=this.color?this.color:"dna"===this.sequenceType?is.nucleotideColors[a]:"rgb(0, 0, 150)")||(h="gray"),d>.18?is.fillRect(f,s,m,l-s,10,{fillStyle:h}):is.strokeText(f,a,c,i,{strokeStyle:h,font:"normal 10px Arial",textAlign:"center"}));return m+10}},name:"Fasta"};class is{static setProperties(e,t){for(var n in t)if(t.hasOwnProperty(n)){var i=t[n];e[n]=i}}static strokeLine(e,t,n,i,r,o){t=Math.floor(t)+.5,n=Math.floor(n)+.5,i=Math.floor(i)+.5,r=Math.floor(r)+.5,e.save(),o&&is.setProperties(e,o),e.beginPath(),e.moveTo(t,n),e.lineTo(i,r),e.stroke(),e.restore()}static fillRect(e,t,n,i,r,o){t=Math.round(t),n=Math.round(n),o&&(e.save(),is.setProperties(e,o)),e.fillRect(t,n,i,r),o&&e.restore()}static fillPolygon(e,t,n,i){e.save(),i&&is.setProperties(e,i),is.doPath(e,t,n),e.fill(),e.restore()}static strokePolygon(e,t,n,i){e.save(),i&&is.setProperties(e,i),is.doPath(e,t,n),e.stroke(),e.restore()}static fillText(e,t,n,i,r,o){if(r&&(e.save(),is.setProperties(e,r)),e.save(),e.translate(n,i),o)for(var a in o){var s=o[a];"translate"==a&&e.translate(s.x,s.y),"rotate"==a&&e.rotate(s.angle*Math.PI/180)}e.fillText(t,0,0),e.restore(),r&&e.restore()}static strokeText(e,t,n,i,r,o){if(e.save(),r&&is.setProperties(e,r),e.translate(n,i),o)for(var a in o){var s=o[a];"translate"==a&&e.translate(s.x,s.y),"rotate"==a&&e.rotate(s.angle*Math.PI/180)}e.strokeText(t,0,0),e.restore()}static strokeCircle(e,t,n,i){e.beginPath(),e.arc(t,n,i,0,2*Math.PI),e.stroke()}static fillCircle(e,t,n,i){e.beginPath(),e.arc(t,n,i,0,2*Math.PI),e.fill()}static drawArrowhead(e,t,n,i,r){e.save(),i||(i=5),r&&(e.lineWidth=r),e.beginPath(),e.moveTo(t,n-i/2),e.lineTo(t,n+i/2),e.lineTo(t+i,n),e.lineTo(t,n-i/2),e.closePath(),e.fill(),e.restore()}static dashedLine(e,t,n,i,r,o,a){e.save(),t=Math.round(t),n=Math.round(n),i=Math.round(i),r=Math.round(r),o=Math.round(o),log("dashedLine"),a&&is.setProperties(e,a),null==o&&(o=2),e.moveTo(t,n);for(var s=i-t,l=r-n,c=Math.floor(Math.sqrt(s*s+l*l)/o),h=s/c,u=l/c,f=0;f++<c;)t+=h,n+=u,e[f%2==0?"moveTo":"lineTo"](t,n);e[f%2==0?"moveTo":"lineTo"](i,r),e.restore()}static doPath(e,t,n){var i,r=t.length;for(i=0;i<r;i++)t[i]=Math.round(t[i]),n[i]=Math.round(n[i]);for(e.beginPath(),e.moveTo(t[0],n[0]),i=1;i<r;i++)e.lineTo(t[i],n[i]);e.closePath()}}is.nucleotideColors={A:"green",T:"red",G:"gray",C:"blue",a:"green",t:"red",c:"blue",g:"gray"};var rs=0;class os extends Qa{constructor(e){e.color||(e.color="#D3D3D3"),super(e),this._setFeatureSource(),this.config.bigwig&&(this.bigwig_track=new ns({url:this.config.bigwig,type:"bigwig",discrete:!0,color:"#D3D3D3",scale:"dynamic",height:100})),this.config=e,void 0===e.coverageTrackHeight&&(e.coverageTrackHeight=50),this.visibilityWindow=e.visibilityWindow||3e4,this.viewAsPairs=!0,this.pairsSupported=void 0===e.pairsSupported,this.color=e.color||"rgb(185, 185, 185)",this.sortOption=e.sortOption||{sort:"NUCLEOTIDE"},this.sortDirection=!0,this.filterOption=e.filterOption||{name:"mappingQuality",params:[30,void 0]},this.display_alignments=!0}_setFeatureSource(){this.feature_source=new wa(this.config,this),this.feature_source.setViewAsPairs(!0),this.coverageTrack=new ss(this.config,this),this.alignmentTrack=new ls(this.config,this)}getFeatures(e,t,n,i,r){return n-t>5e5&&this.bigwig_track?(this.draw_bigwig=!0,this.bigwig_track.getFeatures(e,t,n,i,r)):(this.draw_bigwig=!1,this.feature_source.getAlignments(e,t,n))}altClick(e,t){this.alignmentTrack.sortAlignmentRows(e,this.sortOption),this.trackView.redrawTile(this.featureSource.alignmentContainer),$(this.trackView.viewportDiv).scrollTop(0),this.sortDirection=!this.sortDirection}computePixelHeight(e){return this.coverageTrack.computePixelHeight(e)+this.alignmentTrack.computePixelHeight(e)}drawFeatures(e){return this.top=e.top,this.draw_zoom_in?(this.bottom=this.top+this.config.height,this.bottom):this.draw_bigwig?void(this.bottom=this.bigwig_track.drawFeatures(e)):(this.coverageTrack.height>0&&this.coverageTrack.draw(e),this.bottom=this.alignmentTrack.draw(e),this.bottom)}paintAxis(e,t,n){this.coverageTrack.paintAxis(e,t,this.coverageTrackHeight)}getFeatureAt(e,t,n,i){if(!this.feature_source.alignmentContainer)return null;var r,o,a,s,l,c,h=this.feature_source.alignmentContainer.packedAlignmentRows,u=this.feature_source.alignmentContainer.downsampledIntervals;if(!h)return null;if((r=Math.floor((n.y-this.top-this.coverageTrack.height-rs)/this.config.featureHeight))<0){for(s=0,l=u.length;s<l;s++)if(u[s].start<=e&&u[s].end>=e){a=u[s];break}}else if(r<h.length)for(a=void 0,s=0,l=(o=h[r]).alignments.length;s<l;s++)if((c=o.alignments[s]).start<=e&&c.start+c.lengthOnRef>=e){a=c;break}return a}popupData(e,t,n){return n>=this.coverageTrack.top&&n<this.coverageTrack.height?this.coverageTrack.popupData(e,t,this.coverageTrack.top):this.alignmentTrack.popupData(e,t,n-this.alignmentTrack.top)}popupMenuItems(e){var t,n,i=this,r=[],o=[],a="tag"+(i.alignmentTrack.colorByTag?" ("+i.alignmentTrack.colorByTag+")":"");return o.push({key:"none",label:"track color"}),i.viewAsPairs||o.push({key:"strand",label:"read strand"}),i.pairsSupported&&i.alignmentTrack.hasPairs&&o.push({key:"firstOfPairStrand",label:"first-of-pair strand"}),o.push({key:"tag",label:a}),r.push(igv.colorPickerMenuItem(e,this.trackView)),r.push('<div class="igv-track-menu-category igv-track-menu-border-top">Color by</div>'),o.forEach((function(e){n=i.alignmentTrack.colorBy===e.key,r.push(function(e,t,n){var r=[],o={};return r.push('<div class="igv-track-menu-item">'),r.push(t?'<i class="fa fa-check fa-check-shim"></i>':'<i class="fa fa-check fa-check-shim fa-check-hidden"></i>'),"tag"===e.key?r.push('<span id="color-by-tag">'):r.push("<span>"),r.push(e.label),r.push("</span>"),r.push("</div>"),o.object=$(r.join("")),o.click=function(){igv.popover.hide(),"tag"===e.key?(igv.dialog.configure((function(){return"Tag Name"}),i.alignmentTrack.colorByTag?i.alignmentTrack.colorByTag:"",(function(){var e=igv.dialog.$dialogInput.val().trim();i.alignmentTrack.colorBy="tag",e!==i.alignmentTrack.colorByTag&&(i.alignmentTrack.colorByTag=igv.dialog.$dialogInput.val().trim(),i.alignmentTrack.tagColors=new igv.PaletteColorTable("Set1"),$("#color-by-tag").text(i.alignmentTrack.colorByTag)),i.trackView.update()})),igv.dialog.show($(i.trackView.trackDiv))):(i.alignmentTrack.colorBy=e.key,i.trackView.update())},o}(e,n))})),t=[],i.pairsSupported&&i.alignmentTrack.hasPairs&&(t.push('<div class="igv-track-menu-item igv-track-menu-border-top">'),t.push(!0===i.viewAsPairs?'<i class="fa fa-check fa-check-shim">':'<i class="fa fa-check fa-check-shim fa-check-hidden">'),t.push("</i>"),t.push("View as pairs"),t.push("</div>"),r.push({object:$(t.join("")),click:function(){var t=$(this).find("i");e.hide(),i.viewAsPairs=!i.viewAsPairs,!0===i.viewAsPairs?t.removeClass("fa-check-hidden"):t.addClass("fa-check-hidden"),i.featureSource.setViewAsPairs(i.viewAsPairs),i.trackView.update()}})),r}}function as(e,t,n){var i,r=[0,255,255];if(r)return i=e<5?.1:Math.max(.1,Math.min(1,.1+.9*(e-5)/15)),(i=Math.round(10*i)/10)>=1?is.nucleotideColors[t]:"rgba("+r[0]+","+r[1]+","+r[2]+","+i+")"}class ss{constructor(e,t){this.parent=t,this.featureSource=t.featureSource,this.height=20,this.dataRange={min:0}}computePixelHeight(e){return this.height}draw(e){var t,n,i,r,o,a,s,l,c,h,u,f=this,d=e.features,p=e.context,g=e.bpPerPixel,m=e.bpStart,_=m+e.pixelWidth*g+1,v=d.coverageMap;v.refSeq&&(u=v.refSeq.toUpperCase()),this.dataRange.max=v.maximum;var b=e.top;for(e.top+=this.height,r=Math.max(1,Math.ceil(1/g)),s=0,l=v.coverage.length;s<l;s++)if(!((t=v.bpStart+s)<m)){if(t>_)break;(c=v.coverage[s])&&(o=Math.round(c.total/this.dataRange.max*this.height),i=this.height-o,n=Math.floor((t-m)/g),is.setProperties(p,{fillStyle:this.parent.config.color,strokeStyle:this.color}),is.fillRect(p,n,i+b,r,o))}if(u)for(s=0,l=v.coverage.length;s<l;s++)if(!((t=v.bpStart+s)<m)){if(t>_)break;(c=v.coverage[s])&&(o=c.total/this.dataRange.max*this.height,i=this.height-o,n=Math.floor((t-m)/g),a=u[s],c.isMismatch(a)&&(is.setProperties(p,{fillStyle:is.nucleotideColors[a]}),is.fillRect(p,n,i+b,r,o),h=0,["A","C","T","G"].forEach((function(e){var t;t=(c["pos"+e]+c["neg"+e])/f.dataRange.max*f.height,i=f.height-t-h,h+=t,is.setProperties(p,{fillStyle:is.nucleotideColors[e]}),is.fillRect(p,n,i+b,r,t)}))))}}popupData(e,t,n){var i,r,o=this.featureSource.alignmentContainer.coverageMap,a=[];return i=e-o.bpStart,(r=o.coverage[i])&&(a.push(igv.browser.referenceFrame.chr+":"+igv.numberFormatter(1+e)),a.push({name:"Total Count",value:r.total}),tmp=r.posA+r.negA,tmp>0&&(tmp=tmp.toString()+" ("+Math.floor((r.posA+r.negA)/r.total*100)+"%)"),a.push({name:"A",value:tmp}),tmp=r.posC+r.negC,tmp>0&&(tmp=tmp.toString()+" ("+Math.floor(tmp/r.total*100)+"%)"),a.push({name:"C",value:tmp}),tmp=r.posG+r.negG,tmp>0&&(tmp=tmp.toString()+" ("+Math.floor(tmp/r.total*100)+"%)"),a.push({name:"G",value:tmp}),tmp=r.posT+r.negT,tmp>0&&(tmp=tmp.toString()+" ("+Math.floor(tmp/r.total*100)+"%)"),a.push({name:"T",value:tmp}),tmp=r.posN+r.negN,tmp>0&&(tmp=tmp.toString()+" ("+Math.floor(tmp/r.total*100)+"%)"),a.push({name:"N",value:tmp})),a}}class ls{constructor(e,t){this.config=e,this.parent=t,this.featureSource=t.feature_source,this.alignmentRowHeight=e.alignmentRowHeight||6,this.negStrandColor=e.negStrandColor||"rgba(150, 150, 230, 0.75)",this.posStrandColor=e.posStrandColor||"rgba(230, 150, 150, 0.75)",this.insertionColor=e.insertionColor||"rgb(138, 94, 161)",this.deletionColor=e.deletionColor||"black",this.skippedColor=e.skippedColor||"rgb(150, 170, 170)",this.colorBy=e.colorBy||"none",this.colorByTag=e.colorByTag,this.bamColorTag=void 0===e.bamColorTag?"YC":e.bamColorTag,this.sortOption=e.sortOption||{sort:"NUCLEOTIDE"},this.sortDirection=!0,this.hasPairs=!1}computePixelHeight(e){if(e.packedAlignmentRows){var t=0;return e.hasDownsampledIntervals()&&(t+=10),t+this.config.featureHeight*e.packedAlignmentRows.length+5}return this.height}draw(e){var t=this,n=e.features,i=e.context,r=e.bpPerPixel,o=e.bpStart,a=e.pixelWidth,s=o+a*r+1,l=n.packedAlignmentRows,c=n.sequence,h="normal "+(this.config.featureHeight-2)+"px Arial";if(!l)return;let u=e.top;function f(e,n,a){var l=t.getAlignmentColor(e.firstAlignment),c=l,h=(e.connectingStart-o)/r,u=(e.connectingEnd-o)/r,f=n+a/2;e.connectingEnd<o||e.connectingStart>s||(e.mq<=0&&(l=ha.addAlphaToRGB(l,"0.15")),is.setProperties(i,{fillStyle:l,strokeStyle:c}),is.strokeLine(i,h,f,u,f))}function d(e,a,l){var u,f,d,p=t.getAlignmentColor(e),g=p,m=e.blocks;if(p||(p="gray"),!(e.start+e.lengthOnRef<o||e.start>s))for(e.mq<=0&&(p=ha.addAlphaToRGB(p,"0.15")),is.setProperties(i,{fillStyle:p,strokeStyle:g}),d=0;d<m.length;d++)if(!((f=m[d]).start+f.len<o)){if(_(f),f.start+f.len>s)break;e.insertions&&e.insertions.forEach((function(e){var n=(e.start-o)/r-1;is.fillRect(i,n,a-1,3,l+2,{fillStyle:t.insertionColor})}))}function _(s){var f,_,v,b,y,w,x,C=s.start-n.start,k=(s.start-o)/r,S=(s.start+s.len-o)/r,E=Math.max(1,S-k),D=t.config.featureHeight/2,A=s.seq.toUpperCase(),M=t.skippedColor,R=t.deletionColor,L=a+l/2;if(void 0!==s.gapType&&void 0!==S&&void 0!==u&&("D"===s.gapType?is.strokeLine(i,u,L,k,L,{strokeStyle:R}):is.strokeLine(i,u,L,k,L,{strokeStyle:M})),u=S,!0===e.strand&&d===m.length-1?(w=[k,S,S+D,S,k,k],x=[a,a,a+l/2,a+l,a+l,a],is.fillPolygon(i,w,x,{fillStyle:p}),e.mq<=0&&is.strokePolygon(i,w,x,{strokeStyle:g})):!1===e.strand&&0===d?(w=[S,k,k-D,k,S,S],x=[a,a,a+l/2,a+l,a+l,a],is.fillPolygon(i,w,x,{fillStyle:p}),e.mq<=0&&is.strokePolygon(i,w,x,{strokeStyle:g})):(is.fillRect(i,k,a,E,l,{fillStyle:p}),e.mq<=0&&(i.save(),i.strokeStyle=g,i.strokeRect(k,a,E,l),i.restore())),c&&"*"!==A)for(var T=0,P=A.length;T<P;T++)_=A.charAt(T),f=c.charAt(C+T),"="===_&&(_=f),"X"!==_&&f===_||(y=s.qual&&s.qual.length>T?as(s.qual[T],_,s.start):is.nucleotideColors[_])&&(v=(s.start+T-o)/r,b=Math.max(1,1/r),r<.15?is.strokeText(i,_,v+b/2,a+2,{strokeStyle:y,font:h,textAlign:"center",textBaseline:"hanging"}):is.fillRect(i,v,a,b,l,{fillStyle:y}))}}return c&&(c=c.toUpperCase()),n.hasDownsampledIntervals()?(rs=10,n.downsampledIntervals.forEach((function(e){var t=(e.start-o)/r,n=(e.end-o)/r;n-t>5&&(t+=1,n-=1),is.fillRect(i,t,2,n-t,3,{fillStyle:"black"})}))):rs=3,l&&l.forEach((function(e,n){var i,r=rs+t.config.featureHeight*n+u,a=t.config.featureHeight-2;for(n=0;n<e.alignments.length;n++)if(i=e.alignments[n],t.hasPairs=t.hasPairs||i.isPaired(),!(i.start+i.lengthOnRef<o)){if(i.start>s)break;!0!==i.hidden&&(i instanceof Ia?(f(i,r,a),d(i.firstAlignment,r,a),i.secondAlignment&&d(i.secondAlignment,r,a)):d(i,r,a))}})),rs+t.config.featureHeight*l.length+u}sortAlignmentRows(e,t){var n=this,i=this.featureSource.alignmentContainer,r=i.packedAlignmentRows;r.forEach((function(n){n.updateScore(e,i,t)})),r.sort((function(e,t){return n.sortDirection?e.score-t.score:t.score-e.score}))}static doSortAlignmentRows(e,t,n,i){var r=t.packedAlignmentRows,o=t.sequence;o?(o=o.toUpperCase(),r.forEach((function(i){i.updateScore(e,t,n)})),r.sort((function(e,t){return i?e.score-t.score:t.score-e.score}))):console.log("No sequence, no traversal. No discussion!")}popupData(e,t,n){var i,r,o,a,s,l,c=this.featureSource.alignmentContainer.packedAlignmentRows,h=this.featureSource.alignmentContainer.downsampledIntervals;if((i=Math.floor((n-rs)/this.config.featureHeight))<0){for(a=0,s=h.length;a<s;a++)if(h[a].start<=e&&h[a].end>=e){o=h[a];break}}else if(i<c.length)for(o=void 0,a=0,s=(r=c[i]).alignments.length;a<s;a++)if((l=r.alignments[a]).start<=e&&l.start+l.lengthOnRef>=e){o=l;break}return o?o.popupData(e):[]}getAlignmentColor(e){if(this.parent.color_function)return this.parent.color_function(e);var t,n,i=this,r=i.colorBy;switch(n=i.parent.config.color,r){case"strand":n=e.strand?i.posStrandColor:i.negStrandColor;break;case"firstOfPairStrand":e instanceof Ia?n=e.firstOfPairStrand()?i.posStrandColor:i.negStrandColor:e.isPaired()&&(e.isFirstOfPair()?n=e.strand?i.posStrandColor:i.negStrandColor:e.isSecondOfPair()?n=e.strand?i.negStrandColor:i.posStrandColor:console.log("ERROR. Paired alignments are either first or second."));break;case"tag":void 0!==(t=e.tags()[i.colorByTag])&&(n=i.bamColorTag===i.colorByTag?"rgb("+t+")":i.tagColors.getColor(t));break;default:n=i.parent.config.color}return n}}os.filters={noop:function(){return function(e){return!1}},strand:function(e){return function(t){return t.strand===e}},mappingQuality:function(e,t){return function(n){return!!(e&&n.mq<e)||!!(t&&n.mq>t)}}},Qa.custom_tracks.bam=os,Qa.track_types.bam={class:os,name:"BAM"};function cs(e,t){var n,i=Object.keys(t);for(n=0;n<i.length;n++)e=e.replace(new RegExp("\\{"+i[n]+"\\}","gi"),t[i[n]]);return e}function hs(e){var t,n,i;if(!e)throw new Error("cannot create a random attribute name for an undefined object");t="ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz",n="";do{for(n="",i=0;i<12;i++)n+=t[Math.floor(Math.random()*t.length)]}while(e[n]);return n}Qa.track_types.bam_sca_track={class:class extends Qa{constructor(e){super(e),this.catNumbers={},this.config.scale=this.config.scale||.1,this.config.size_filter=this.config.size_filter=50,this.config.size_filter_on=void 0!==this.config.size_filter_on&&e.size_filter_on,this.config.tag||(this.config.tag="CB"),this.feature_source=new ma(this.config),this.setFragmentSizeFilter()}addIndex(e){this.feature_source.catIndex=e}getIdsInRange(e){return this.feature_source.getIdsInRange(e)}filterReads(e,t){this.feature_source.setFilter(e,t),this.feature_source.calculateCategories()}setCategories(e,t,n,i,r=!1,o=!1){if(null==e&&this.feature_source.setCategories(null,null),!this.catNumbers[e]||o){const i=new Array(n.length).fill(0);for(let e=0;e<t.length;e++)i[t[e]]++;this.catNumbers[e]=i}this.numbers=this.catNumbers[e],this.feature_source.setCategories(t,n),this.catColors=i,this.catNames=n,r&&this.feature_source.calculateCategories()}setFragmentSizeFilter(e,t){(e||!1===e)&&(this.config.size_filter_on=e),t&&(this.config.size_filter=t),this.feature_source.size_filter_on=this.config.size_filter_on,this.feature_source.size_filter=this.config.size_filter}async getFeatures(e,t,n,i,r){if(n-t>1e7)return"zoom in to see coverage";try{return await this.feature_source.getAlignments(e,t,n)}catch(e){return e.message}}drawScale(e,t,n){let i=this.top;const r=Math.round(this.config.height/this.catNames.length);t.strokeStyle=n,t.fillStyle=n;for(let e of this.catNames){let n=i+r;t.beginPath(),t.moveTo(0,i),t.lineTo(0,n),t.moveTo(0,i),t.lineTo(20,i),t.moveTo(0,n),t.lineTo(20,n),t.font="12px Arial",t.stroke(),t.textBaseline="top";let o=this.config.scale;t.fillText(o.toFixed(2),20,i),t.font="14px Arial",t.textBaseline="middle",t.fillText(e,2,i+r/2),t.font="12px Arial",i+=r}}drawFeatures(e){var t,n,i,r=e.features,o=e.context,a=e.bpPerPixel,s=e.bpStart,l=e.pixelWidth;const c=s-r.store[1],h=c+l*a+1,u=Math.round(this.config.height/r.length);let f=this.config.scale,d=e.top;this.top=e.top;let p=Math.max(1,Math.ceil(1/a)),g=a>5?5:1;for(let e=0;e<r.length;e++){let l=r[e];o.fillStyle=this.catColors[e];for(let m=c;m<h;m+=g){let c=m+r.store[1];-0!==l[m]&&(t=Math.round(l[m]/this.numbers[e]/f*u),n=u-(t=t>u?u:t),i=Math.floor((c-s)/a),o.fillRect(i,n+d,p,t))}d+=u}}getSettings(e){return super.getSettings(e).concat([{label:"Fragment Size Filter",type:"check",current_value:this.config.size_filter_on,func:t=>{this.setFragmentSizeFilter(t),this.feature_source.calculateCategories(),e.update()}},{type:"slider",min:0,max:300,step:1,label:"Fragment Size",current_value:this.config.size_filter,func:t=>{this.setFragmentSizeFilter(null,t),this.feature_source.calculateCategories(),e.update()}},{type:"slider",min:0,max:1,label:"Scale (cov/no cells)",current_value:this.config.scale,func:t=>{this.config.scale=t,e.update()}}])}},name:"BAM SCA Track"};var us={left:"start",right:"end",center:"middle",start:"start",end:"end"},fs={alphabetic:"alphabetic",hanging:"hanging",top:"text-before-edge",bottom:"text-after-edge",middle:"central"},ds=function(e){var t=Math.sqrt(e[0]*e[0]+e[1]*e[1]);return[e[0]/t,e[1]/t]},ps=function(e,t){void 0===t&&(t=10);var n,i,r,o={},a="50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro".split(",");for(n=0;n<a.length;n+=2)i="&"+a[n+1]+";",r=parseInt(a[n],t),o[i]="&#"+r+";";return o["\\xa0"]="&#160;",o}(0,32),gs={strokeStyle:{svgAttr:"stroke",canvas:"#000000",svg:"none",apply:"stroke"},fillStyle:{svgAttr:"fill",canvas:"#000000",svg:null,apply:"fill"},lineCap:{svgAttr:"stroke-linecap",canvas:"butt",svg:"butt",apply:"stroke"},lineJoin:{svgAttr:"stroke-linejoin",canvas:"miter",svg:"miter",apply:"stroke"},miterLimit:{svgAttr:"stroke-miterlimit",canvas:10,svg:4,apply:"stroke"},lineWidth:{svgAttr:"stroke-width",canvas:1,svg:1,apply:"stroke"},globalAlpha:{svgAttr:"opacity",canvas:1,svg:1,apply:"fill stroke"},font:{canvas:"10px sans-serif"},shadowColor:{canvas:"#000000"},shadowOffsetX:{canvas:0},shadowOffsetY:{canvas:0},shadowBlur:{canvas:0},textAlign:{canvas:"start"},textBaseline:{canvas:"alphabetic"},lineDash:{svgAttr:"stroke-dasharray",canvas:[],svg:null,apply:"stroke"}},ms=function(){function e(e,t){this.__root=void 0,this.__ctx=void 0,this.__root=e,this.__ctx=t}return e.prototype.addColorStop=function(e,t){var n,i=this.__ctx.__createElement("stop");i.setAttribute("offset",e),-1!==t.indexOf("rgba")?(n=/rgba\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?\.?\d*)\s*\)/gi.exec(t))&&(i.setAttribute("stop-color",cs("rgb({r},{g},{b})",{r:n[1],g:n[2],b:n[3]})),i.setAttribute("stop-opacity",n[4])):i.setAttribute("stop-color",t),this.__root.appendChild(i)},e}(),_s=function(e,t){this.__root=void 0,this.__ctx=void 0,this.__root=e,this.__ctx=t},vs={width:500,height:500,enableMirroring:!1},bs=function(){function e(e,t){var n,i,r,o;if(void 0===e&&(e=vs),this.width=void 0,this.height=void 0,this.enableMirroring=void 0,this.canvas=void 0,this.__document=void 0,this.__canvas=void 0,this.__ctx=void 0,this.__ids=void 0,this.__root=void 0,this.__defs=void 0,this.__currentElement=void 0,this.__groupStack=void 0,this.__currentElementsToStyle=null,"number"==typeof e?(this.width=e,this.height=null!=t?t:vs.height,this.enableMirroring=vs.enableMirroring,this.__document=document):(this.width=null!=(i=e.width)?i:vs.width,this.height=null!=(r=e.height)?r:vs.height,this.enableMirroring=null!=(o=e.enableMirroring)?o:vs.enableMirroring,this.__document=e.document||document,n=e.ctx),!(n||(this.__canvas=this.__document.createElement("canvas"),n=this.__canvas.getContext("2d"))))throw new Error("Unable to get canvas context");this.__ctx=n,this.canvas=this,this.__setDefaultStyles(),this.__stack=[this.__getStyleState()],this.__groupStack=[],this.__root=this.__document.createElementNS("http://www.w3.org/2000/svg","svg"),this.__root.setAttribute("version","1.1"),this.__root.setAttribute("xmlns","http://www.w3.org/2000/svg"),this.__root.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),this.__root.setAttribute("width",this.width.toString()),this.__root.setAttribute("height",this.height.toString()),this.__ids={},this.__defs=this.__document.createElementNS("http://www.w3.org/2000/svg","defs"),this.__root.appendChild(this.__defs),this.__currentElement=this.__document.createElementNS("http://www.w3.org/2000/svg","g"),this.__root.appendChild(this.__currentElement)}var t=e.prototype;return t.__createElement=function(e,t,n){void 0===t&&(t={});var i,r,o=this.__document.createElementNS("http://www.w3.org/2000/svg",e),a=Object.keys(t);for(n&&(o.setAttribute("fill","none"),o.setAttribute("stroke","none")),i=0;i<a.length;i++)o.setAttribute(r=a[i],t[r]);return o},t.__setDefaultStyles=function(){for(var e in gs)this[e]=gs[e].canvas},t.__applyStyleState=function(e){var t,n,i=Object.keys(e);for(t=0;t<i.length;t++)this[n=i[t]]=e[n]},t.__getStyleState=function(){var e,t,n={},i=Object.keys(gs);for(e=0;e<i.length;e++)n[t=i[e]]=this[t];return n},t.__applyStyleToCurrentElement=function(e){if(this.__currentElement){var t,n,i,r,o,a=this.__currentElement,s=Object.keys(gs);for(t=0;t<s.length;t++)if(i=this[s[t]],"apply"in(n=gs[s[t]]))if(i instanceof _s){if(i.__ctx)for(;i.__ctx.__defs.childNodes.length;)r=i.__ctx.__defs.childNodes[0].getAttribute("id"),this.__ids[r]=r,this.__defs.appendChild(i.__ctx.__defs.childNodes[0]);a.setAttribute(n.apply,cs("url(#{id})",{id:i.__root.getAttribute("id")}))}else if(i instanceof ms)a.setAttribute(n.apply,cs("url(#{id})",{id:i.__root.getAttribute("id")}));else if(-1!==n.apply.indexOf(e)&&n.svg!==i)if("stroke"!==n.svgAttr&&"fill"!==n.svgAttr||-1===i.indexOf("rgba")){var l=n.svgAttr;if("globalAlpha"===s[t]&&a.getAttribute(l=e+"-"+n.svgAttr))continue;a.setAttribute(l,i)}else if(o=/rgba\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?\.?\d*)\s*\)/gi.exec(i)){a.setAttribute(n.svgAttr,cs("rgb({r},{g},{b})",{r:o[1],g:o[2],b:o[3]}));var c=parseFloat(o[4]),h=this.globalAlpha;null!=h&&(c*=h),a.setAttribute(n.svgAttr+"-opacity",c.toString())}}},t.__closestGroupOrSvg=function(e){if(void 0===e&&(e=this.__currentElement),e)return"g"===e.nodeName||"svg"===e.nodeName?e:this.__closestGroupOrSvg(e.parentNode)},t.getSerializedSvg=function(e){var t,n,i,r,o,a=(new XMLSerializer).serializeToString(this.__root);if(/xmlns="http:\/\/www\.w3\.org\/2000\/svg".+xmlns="http:\/\/www\.w3\.org\/2000\/svg/gi.test(a)&&(a=a.replace('xmlns="http://www.w3.org/2000/svg','xmlns:xlink="http://www.w3.org/1999/xlink')),e)for(t=Object.keys(ps),n=0;n<t.length;n++)r=ps[i=t[n]],(o=new RegExp(i,"gi")).test(a)&&(a=a.replace(o,r));return a},t.getSvg=function(){return this.__root},t.save=function(){var e=this.__createElement("g"),t=this.__closestGroupOrSvg();t&&this.__groupStack.push(t),t.appendChild(e),this.__currentElement=e,this.__stack.push(this.__getStyleState())},t.restore=function(){this.__currentElement=this.__groupStack.pop(),this.__currentElementsToStyle=null,this.__currentElement||(this.__currentElement=this.__root.childNodes[1]);var e=this.__stack.pop();this.__applyStyleState(e)},t.__addTransform=function(e){if(this.__currentElement){var t=this.__closestGroupOrSvg();if(t){if(t.childNodes.length>0){"path"===this.__currentElement.nodeName&&(this.__currentElementsToStyle||(this.__currentElementsToStyle={element:t,children:[]}),this.__currentElementsToStyle.children.push(this.__currentElement),this.__applyCurrentDefaultPath());var n=this.__createElement("g");t.appendChild(n),this.__currentElement=n}if(this.__currentElement){var i=this.__currentElement.getAttribute("transform");i?i+=" ":i="",this.__currentElement.setAttribute("transform",i+=e)}}}},t.scale=function(e,t){void 0===t&&(t=e),this.__addTransform(cs("scale({x},{y})",{x:e,y:t}))},t.rotate=function(e){var t=180*e/Math.PI;this.__addTransform(cs("rotate({angle},{cx},{cy})",{angle:t,cx:0,cy:0}))},t.translate=function(e,t){this.__addTransform(cs("translate({x},{y})",{x:e,y:t}))},t.transform=function(e,t,n,i,r,o){this.__addTransform(cs("matrix({a},{b},{c},{d},{e},{f})",{a:e,b:t,c:n,d:i,e:r,f:o}))},t.beginPath=function(){var e,t;this.__currentDefaultPath="",this.__currentPosition={},e=this.__createElement("path",{},!0),(t=this.__closestGroupOrSvg())&&(t.appendChild(e),this.__currentElement=e)},t.__applyCurrentDefaultPath=function(){var e=this.__currentElement;e&&("path"===e.nodeName?e.setAttribute("d",this.__currentDefaultPath):console.error("Attempted to apply path command to node",e.nodeName))},t.__addPathCommand=function(e){this.__currentDefaultPath+=" ",this.__currentDefaultPath+=e},t.moveTo=function(e,t){this.__currentElement&&("path"!==this.__currentElement.nodeName&&this.beginPath(),this.__currentPosition={x:e,y:t},this.__addPathCommand(cs("M {x} {y}",{x:e,y:t})))},t.closePath=function(){this.__currentDefaultPath&&this.__addPathCommand("Z")},t.lineTo=function(e,t){this.__currentPosition={x:e,y:t},this.__currentDefaultPath.indexOf("M")>-1?this.__addPathCommand(cs("L {x} {y}",{x:e,y:t})):this.__addPathCommand(cs("M {x} {y}",{x:e,y:t}))},t.bezierCurveTo=function(e,t,n,i,r,o){this.__currentPosition={x:r,y:o},this.__addPathCommand(cs("C {cp1x} {cp1y} {cp2x} {cp2y} {x} {y}",{cp1x:e,cp1y:t,cp2x:n,cp2y:i,x:r,y:o}))},t.quadraticCurveTo=function(e,t,n,i){this.__currentPosition={x:n,y:i},this.__addPathCommand(cs("Q {cpx} {cpy} {x} {y}",{cpx:e,cpy:t,x:n,y:i}))},t.arcTo=function(e,t,n,i,r){var o=this.__currentPosition&&this.__currentPosition.x,a=this.__currentPosition&&this.__currentPosition.y;if(void 0!==o&&void 0!==a){if(r<0)throw new Error("IndexSizeError: The radius provided ("+r+") is negative.");if(o===e&&a===t||e===n&&t===i||0===r)this.lineTo(e,t);else{var s=ds([o-e,a-t]),l=ds([n-e,i-t]);if(s[0]*l[1]!=s[1]*l[0]){var c=Math.acos(Math.abs(s[0]*l[0]+s[1]*l[1])),h=ds([s[0]+l[0],s[1]+l[1]]),u=r/Math.sin(c/2),f=e+u*h[0],d=t+u*h[1],p=[-s[1],s[0]],g=[l[1],-l[0]],m=function(e){var t=e[0];return e[1]>=0?Math.acos(t):-Math.acos(t)},_=m(p),v=m(g);this.lineTo(f+p[0]*r,d+p[1]*r),this.arc(f,d,r,_,v)}else this.lineTo(e,t)}}},t.stroke=function(){this.__currentElement&&("path"===this.__currentElement.nodeName&&this.__currentElement.setAttribute("paint-order","fill stroke markers"),this.__applyCurrentDefaultPath(),this.__applyStyleToCurrentElement("stroke"))},t.fill=function(){this.__currentElement&&("path"===this.__currentElement.nodeName&&this.__currentElement.setAttribute("paint-order","stroke fill markers"),this.__applyCurrentDefaultPath(),this.__applyStyleToCurrentElement("fill"))},t.rect=function(e,t,n,i){this.__currentElement&&("path"!==this.__currentElement.nodeName&&this.beginPath(),this.moveTo(e,t),this.lineTo(e+n,t),this.lineTo(e+n,t+i),this.lineTo(e,t+i),this.lineTo(e,t),this.closePath())},t.fillRect=function(e,t,n,i){var r;r=this.__createElement("rect",{x:e,y:t,width:n,height:i},!0),this.__closestGroupOrSvg().appendChild(r),this.__currentElement=r,this.__applyStyleToCurrentElement("fill")},t.strokeRect=function(e,t,n,i){var r;r=this.__createElement("rect",{x:e,y:t,width:n,height:i},!0),this.__closestGroupOrSvg().appendChild(r),this.__currentElement=r,this.__applyStyleToCurrentElement("stroke")},t.__clearCanvas=function(){var e=this.__closestGroupOrSvg();if(e){for(var t=e.getAttribute("transform"),n=this.__root.childNodes[1],i=n.childNodes,r=i.length-1;r>=0;r--)i[r]&&n.removeChild(i[r]);this.__currentElement=n,this.__groupStack=[],t&&this.__addTransform(t)}},t.clearRect=function(e,t,n,i){if(0!==e||0!==t||n!==this.width||i!==this.height){var r,o=this.__closestGroupOrSvg();r=this.__createElement("rect",{x:e,y:t,width:n,height:i,fill:"#FFFFFF"},!0),o.appendChild(r)}else this.__clearCanvas()},t.createLinearGradient=function(e,t,n,i){var r=this.__createElement("linearGradient",{id:hs(this.__ids),x1:e+"px",x2:n+"px",y1:t+"px",y2:i+"px",gradientUnits:"userSpaceOnUse"},!1);return this.__defs.appendChild(r),new ms(r,this)},t.createRadialGradient=function(e,t,n,i,r,o){var a=this.__createElement("radialGradient",{id:hs(this.__ids),cx:i+"px",cy:r+"px",r:o+"px",fx:e+"px",fy:t+"px",gradientUnits:"userSpaceOnUse"},!1);return this.__defs.appendChild(a),new ms(a,this)},t.__parseFont=function(){var e=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-,\'\"\sa-z0-9]+?)\s*$/i.exec(this.font);if(e){var t={style:e[1]||"normal",size:e[4]||"10px",family:e[6]||"sans-serif",weight:e[3]||"normal",decoration:e[2]||"normal",href:null};return"underline"===this.__fontUnderline&&(t.decoration="underline"),this.__fontHref&&(t.href=this.__fontHref),t}},t.__wrapTextLink=function(e,t){if(e.href){var n=this.__createElement("a");return n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",e.href),n.appendChild(t),n}return t},t.__applyText=function(e,t,n,i){var r=this.__parseFont(),o=this.__closestGroupOrSvg();if(r){var a,s,l=this.__createElement("text",{"font-family":r.family,"font-size":r.size,"font-style":r.style,"font-weight":r.weight,"text-decoration":r.decoration,x:t,y:n,"text-anchor":(s=this.textAlign,us[s]||us.start),"dominant-baseline":(a=this.textBaseline,fs[a]||fs.alphabetic)},!0);l.appendChild(this.__document.createTextNode(e)),this.__currentElement=l,this.__applyStyleToCurrentElement(i),o.appendChild(this.__wrapTextLink(r,l))}},t.fillText=function(e,t,n){this.__applyText(e,t,n,"fill")},t.strokeText=function(e,t,n){this.__applyText(e,t,n,"stroke")},t.measureText=function(e){return this.__ctx.font=this.font,this.__ctx.measureText(e)},t.arc=function(e,t,n,i,r,o){if(i!==r){(i%=2*Math.PI)==(r%=2*Math.PI)&&(r=(r+2*Math.PI-.001*(o?-1:1))%(2*Math.PI));var a,s=e+n*Math.cos(r),l=t+n*Math.sin(r),c=e+n*Math.cos(i),h=t+n*Math.sin(i),u=o?0:1,f=r-i;f<0&&(f+=2*Math.PI),a=o?f>Math.PI?0:1:f>Math.PI?1:0,this.lineTo(c,h),this.__addPathCommand(cs("A {rx} {ry} {xAxisRotation} {largeArcFlag} {sweepFlag} {endX} {endY}",{rx:n,ry:n,xAxisRotation:0,largeArcFlag:a,sweepFlag:u,endX:s,endY:l})),this.__currentPosition={x:s,y:l}}},t.clip=function(){var e=this.__closestGroupOrSvg(),t=this.__createElement("clipPath"),n=hs(this.__ids),i=this.__createElement("g");e&&this.__currentElement&&(this.__applyCurrentDefaultPath(),e.removeChild(this.__currentElement),t.setAttribute("id",n),t.appendChild(this.__currentElement),this.__defs.appendChild(t),e.setAttribute("clip-path",cs("url(#{id})",{id:n})),e.appendChild(i),this.__currentElement=i)},t.drawImage=function(){var t,n,i,r,o,a,s,l,c,h,u,f,d,p,g=Array.prototype.slice.call(arguments),m=g[0],_=0,v=0;if(3===g.length)t=g[1],n=g[2],i=o=m.width,r=a=m.height;else if(5===g.length)t=g[1],n=g[2],i=g[3],r=g[4],o=m.width,a=m.height;else{if(9!==g.length)throw new Error("Invalid number of arguments passed to drawImage: "+arguments.length);_=g[1],v=g[2],o=g[3],a=g[4],t=g[5],n=g[6],i=g[7],r=g[8]}s=this.__closestGroupOrSvg();var b="translate("+t+", "+n+")";if(m instanceof e){if((l=m.getSvg().cloneNode(!0)).childNodes&&l.childNodes.length>1){for(c=l.childNodes[0];c.childNodes.length;)p=c.childNodes[0].getAttribute("id"),this.__ids[p]=p,this.__defs.appendChild(c.childNodes[0]);if(h=l.childNodes[1]){var y=h.getAttribute("transform");h.setAttribute("transform",y?y+" "+b:b),s.appendChild(h)}}}else if("CANVAS"===m.nodeName||"IMG"===m.nodeName){if((u=this.__createElement("image")).setAttribute("width",i),u.setAttribute("height",r),u.setAttribute("preserveAspectRatio","none"),_||v||o!==m.width||a!==m.height){if((f=this.__document.createElement("canvas")).width=i,f.height=r,!(d=f.getContext("2d")))return;d.drawImage(m,_,v,o,a,0,0,i,r),m=f}u.setAttribute("transform",b),u.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href","CANVAS"===m.nodeName?m.toDataURL():m.getAttribute("src")),s.appendChild(u)}},t.createPattern=function(t,n){var i,r=this.__document.createElementNS("http://www.w3.org/2000/svg","pattern"),o=hs(this.__ids);return r.setAttribute("id",o),r.setAttribute("width",t.width),r.setAttribute("height",t.height),"CANVAS"===t.nodeName||"IMG"===t.nodeName?((i=this.__document.createElementNS("http://www.w3.org/2000/svg","image")).setAttribute("width",t.width),i.setAttribute("height",t.height),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href","CANVAS"===t.nodeName?t.toDataURL():t.getAttribute("src")),r.appendChild(i),this.__defs.appendChild(r)):t instanceof e&&(r.appendChild(t.__root.childNodes[1]),this.__defs.appendChild(r)),new _s(r,this)},t.setLineDash=function(e){this.lineDash=e&&e.length>0?e.join(","):null},e}();class ys{constructor(e,t,n,i,r){this.chr=e,this.startBP=t,this.endBP=n,this.scale=i,this.image=r}containsRange(e,t,n,i){return t<0&&(t=0),this.scale.toFixed(3)===i.toFixed(3)&&t>=this.startBP&&n<=this.endBP&&e===this.chr}overlapsRange(e,t,n){return this.chr===e&&this.endBP>=t&&this.startBP<=n}}const ws=class extends M{constructor(e){e.buttons&&(e.footer=!0,e._buttons=e.buttons,delete e.buttons),e.width=e.width||300,super(e,e)}init(e){if(this.controlValues={},this.controls={},e._buttons)for(let t of e._buttons)this.addButton(t);if(e.text&&((0,A.ut)("div",{},this.dialog).innerHTML=e.text),e.controls)for(let t of e.controls){t.id||(t.id=t.label);let e=(0,A.ut)("div",{styles:{padding:"5px"}},this.dialog);if("button"!==t.type){const n="checkbox"===t.type?"inline":"block";(0,A.ut)("label",{text:t.label,styles:{fontWeight:"bold",display:n,marginBottom:"3px"}},e)}this[t.type](t,e),t.description&&(0,A.ut)("div",{text:t.description,styles:{fontSize:"12px"}},e)}}radiobuttons(e,t){const n=(0,A.ut)("div",{},t);this.controlValues[e.id]=e.current_value;for(let t of e.choices){(0,A.ut)("span",{text:t[0]},n);const i=(0,A.ut)("input",{type:"radio",name:e.label,value:t[1]},n);i.checked=e.current_value===t[1],i.addEventListener("click",(t=>{const n=t.currentTarget.value;this.controlValues[e.id]=n,e.func&&e.func(n,this)}))}}slider(e,t){const n=(0,A.ut)("div",{},t);L().create(n,{start:[e.current_value],range:{min:[e.min],max:[e.max]},step:e.step||null,tooltips:!0,documentElement:e.doc||document}),this.controlValues[e.id]=e.current_value,n.noUiSlider.on("end",(t=>{const n=parseFloat(t[0]);this.controlValues[e.id]=n,e.func&&e.func(n)}))}changeDropDownContent(e,t){const n=this.controls[e];for(;0!==n.length;)n.remove(0);for(let e of t)(0,A.ut)("option",{text:e.text,value:e.value},n);this.controlValues[e]=n.value}dropdown(e,t){const n=(0,A.ut)("select",{styles:{maxWidth:"200px"}});for(let t of e.items)(0,A.ut)("option",{text:t.text,value:t.value},n);t.append(n),e.current_value&&(n.value=e.current_value),this.controlValues[e.id]=n.value,n.addEventListener("change",(t=>{this.controlValues[e.id]=n.value,e.func&&e.func(n.value,this)})),this.controls[e.id]=n}checkboxgroup(e,t){const n=this,i=(0,A.ut)("div",{},t);function r(t,r){(0,A.ut)("button",{text:t,classes:["ciview-button-sm"]},i).addEventListener("click",(()=>{for(let t of e.checkboxes)n.controls[t.id].checked=r,n.controlValues[t.id]=r}))}r("Check All",!0),r("Uncheck All",!1);const o=(0,A.ut)("div",{},t);for(let t of e.checkboxes){const n=(0,A.ut)("div",{styles:{display:"inline-block",padding:"3px"}},o);(0,A.ut)("span",{styles:{fontSize:"13px"},text:t.label},n),t.id=`${e.id}_${t.id}`,this.checkbox(t,n)}}checkbox(e,t){const n=e.current_value,i=(0,A.ut)("input",{type:"checkbox",classes:["mdv-checkbox"]},t);i.checked=e.current_value,this.controlValues[e.id]=n,i.addEventListener("click",(t=>{this.controlValues[e.id]=i.checked,e.func&&e.func(i.checked)})),this.controls[e.id]=i}text(e,t){const n=e.defaultValue||"",i=(0,A.ut)("input",{value:n},t);this.controlValues[e.id]=n,i.addEventListener("keyup",(()=>{this.controlValues[e.id]=i.value})),this.controls[e.id]=i}buttonClicked(e){"noclose"!==e.method(this.controlValues,this.controls)&&this.close()}addButton(e){(0,A.ut)("button",{text:e.text,classes:["ciview-button"]},this.footer).addEventListener("click",(()=>this.buttonClicked(e)))}};I.types.genome_browser={class:class extends I{constructor(e,t,n){super(e,t,n);const i=this.config;i.view_margins=i.view_margins||{type:"percentage",value:20},this.contentDiv.style.width="100%",this.contentDiv.style.height="100%",i.type="genome_browser";const r=!i.tracks.find((e=>"ruler"===e.format));if(this.browser=new class{constructor(e,t={},n=[]){this.trackDiv="string"==typeof e?document.getElementById("#"+e):e;const i=this.trackDiv.getBoundingClientRect();this.height=i.height,this.width=i.width,this.tracks={},this.track_order=[],this.trackLabels={},this.trackDialogs={};for(let e of n){let t=Qa.getTrack(e);this.tracks[t.config.track_id]=t,this.track_order.push(t.config.track_id),this._addTrackLabel(t.config)}this._tracksChanged(),this.legend=null,this.trackDiv.style.position="relative",this.canvas=(0,A.ut)("canvas",{classes:["igv-content-canvas"],width:this.width,height:this.height},this.trackDiv),this.ctx=this.canvas.getContext("2d"),t.show_scale&&(this.addScaleCanvas(this.height),this.show_scale=!0),this.is_dragging=!1,this.isMouseDown=!1,this.lastMouseX=void 0,this.mouseDownX=void 0,this.buffer_level=1,this.groups={},this.highlighted_regions={},this.listeners={},t.allow_user_interactions&&(this.allowUserDrag(),this.allowUserZoom(),this.allowUserFeatureClick(),this.allowUserFeatureOver(),this.allowUserRangeSelection(),this.trackDiv.addEventListener("dragover",(e=>{e.preventDefault()}))),t.ruler_track&&this.addRulerTrack(),t.new_layout&&(this.new_layout=!0),this.__doc__=document,this.retries=0,this.yOffset=0,this.loadingIcon=(0,A.ut)("i",{classes:["fas","fa-spinner","fa-spin","panel-loading-icon"]},this.trackDiv),this.messageAlert=(0,A.ut)("div",{classes:["panel-error-message"]},this.trackDiv)}closeAllDialogs(){for(let e in this.trackDialogs)this.trackDialogs[e].close();this.trackDialogs={}}_addTrackLabel(e){e.show_track_label;const t=(0,A.ut)("div",{classes:["panel-track-label"],text:e.short_label,draggable:!0},this.trackDiv);t.addEventListener("click",(t=>{this._openTrackDialog(t,e.track_id)})),t.addEventListener("drag",(e=>{this.trackDiv.style.cursor="ne-risize"})),t.addEventListener("mousedown",(e=>{e.stopImmediatePropagation()})),t.addEventListener("dragend",(t=>{let n=this._getCoords(t).y+this.yOffset,i=null;if(n<0)this.track_order[0];else for(let e in this.tracks){const t=this.tracks[e];if(n>=t.top&&n<=t.bottom){i=e;break}}i!==e.track_id&&(i=i||this.track_order[this.track_order.length-1],this.track_order.splice(this.track_order.indexOf(e.track_id),1),this.track_order.splice(this.track_order.indexOf(i)+1,0,e.track_id),this.update())})),this.trackLabels[e.track_id]=t}_openTrackDialog(e,t){if(this.trackDialogs[t])return;const n=this.tracks[t];this.trackDialogs[t]=new T({maxHeight:400,doc:this.__doc__||document,width:300,title:n.config.short_label,position:[e.pageX,e.pageY],onclose:()=>delete this.trackDialogs[t]},n.getSettings(this))}_parseConfig(e){this.fixed_height_mode&&(e.height||(e.height=150))}addScaleCanvas(e){this.scale_canvas=(0,A.ut)("canvas",{styles:{position:"absolute",top:"0px",left:"5px"},width:100,height:this.height},this.trackDiv),this.scale_ctx=this.scale_canvas.getContext("2d")}setBufferLevel(e){this.buffer_level=e}getDiv(){return this.trackDiv}setHighlightedRegion(e,t,n){this.highlighted_regions[t]={chr:e.chr,start:e.start,end:e.end,color:n},this.force_redraw=!0}removeHighlightedRegion(e){delete this.highlighted_regions[e],this.force_redraw=!0}addRulerTrack(){let e=new Ja,t=e.getConfig();return this.tracks[t.track_id]=e,this.track_order.unshift(t.track_id),this._addTrackLabel(t),this}addListener(e,t){this.listeners[e]=t}removeListener(e){delete this.listeners[e]}addTrack(e,t,n){let i=Qa.getTrack(e);this.tracks[i.config.track_id]=i,t||0==t?this.track_order.splice(t,0,i.config.track_id):this.track_order.push(i.config.track_id),this._tracksChanged(),this._addTrackLabel(i.config),n||this._callListeners("track_added",i.config)}_callListeners(e,t){for(let n in this.listeners)this.listeners[n](e,t)}removeAllTracks(){let e=this.track_order.slice();for(let t of e)this.removeTrack(t,!0)}removeTrack(e,t,n){if(!this.tracks[e])return null;this.track_order=this.track_order.filter((t=>t!==e)),t||this.repaint(!0,!0),this.legend&&this.legend.removeTrack(e);let i=this.tracks[e].config;if(delete this.tracks[e],n||this._callListeners("track_removed",i),0===this.track_order.length)for(let e in this.listeners.panel_empty)this.listeners.panel_empty[e](this);return i}getTrackConfig(e){return this.tracks[e].getConfig()}getTrack(e){return this.tracks[e]}getAllTrackConfigs(){let e=[];for(let t of this.track_order)e.push(this.tracks[t].getConfig());return e}setTrackAttribute(e,t,n){let i=this.tracks[e];i&&(i.setConfigAttribute(t,n),"scale_link_to"===t&&(this.tracks[e].scale_link_to=this.tracks[n]),"color"!==t&&"display"!==t||!this.legend||this.legend.updateTrack(e))}setTrackAttributes(e,t){let n=this.tracks[e];for(let i in t)n.setConfigAttribute(i,t[i]),"color"===i&&this.legend&&this.legend.updateTrack(e)}setTrackFeatureFilter(e,t){this.tracks[e].setFilterFunction(t)}setTrackColorFunction(e,t){this.tracks[e].setColorFunction(t)}setTrackLabelFunction(e,t){let n=this.tracks[e];n&&(n.label_function=t)}_tracksChanged(){for(let e of this.track_order){let t=this.tracks[e],n=t.config.scale_link_to;if(n){let e=this.tracks[n];e&&(t.scale_link_to=e)}}}getCurrentTrackFeatures(e){return this.tracks[e].getCurrentFeatures(this.chr,this.start,this.end)}update(e,t,n,i){if(this.call_update_listener=i,t>n){const e=t;t=n,n=e}e?(this.chr=e,this.start=t,this.end=n,this.repaint()):this.repaint(!0,!0)}getTracksHeight(){let e=0,t={};for(let n of this.track_order){let i=this.tracks[n],r=i.config.group;i.config.hide||(r?t[r]||(e+=i.config.height,t[r]=!0):e+=i.config.height)}return e}async getAllFeatures(e,t,n,i){let r=[];this._display_order=[];for(let o of this.track_order){let a=this.tracks[o];a.config.hide||(this._display_order.push(o),r.push(a.getFeatures(this.chr,e,t,n,i)))}return await Promise.all(r.map((e=>e.catch((e=>e)))))}repaint(e,t,n){this.messageAlert.style.display="none";var i,r,o,a,s,l,c,h,u=this;l=this.chr,c=this.start,h=this.end,this.bpPerPixel=(this.end-this.start)/this.canvas.width;let f=!0;if(this.tile&&this.tile.containsRange(l,c,h,this.bpPerPixel)&&(f=!1),f||e||this.force_redraw){if(this.force_redraw=!1,n?(i=this.canvas.width,o=Math.max(0,Math.round(this.start))):(i=(2*this.buffer_level+1)*this.canvas.width,o=Math.max(0,Math.round(this.start-this.buffer_level*this.canvas.width*this.bpPerPixel))),r=Math.round(i*this.bpPerPixel),a=o+r,u.loading&&!n)return void(u.update_required=!(!e||!t)||"location");t&&this.tile&&(o=this.tile.startBP,a=this.tile.endBP),n||(u.loading={start:o,end:a},u.loadingIcon.style.display="block");const c=n?"black":getComputedStyle(u.trackDiv).getPropertyValue("color");u.getAllFeatures(o,a,!f,{pixelWidth:i,bpPerPixel:u.bpPerPixel}).then((function(e){if(e){let h=null;h=n?{}:document.createElement("canvas"),h.width=i,h.height=u.getTracksHeight(),s=n?new bs(h.width,h.height):h.getContext("2d"),u.show_scale&&!n&&(u.scale_buffer=document.createElement("canvas"),u.scale_buffer.width=200,u.scale_buffer.height=h.height,u.scale_buffer_ctx=u.scale_buffer.getContext("2d"));var t={context:s,bpStart:o,bpPerPixel:u.bpPerPixel,pixelWidth:h.width,pixelHeight:h.height,chr:l,textColor:c};let f=0;u.groups={},u.calculateMaxScale(e);for(let e in u.tracks){const t=u.tracks[e].config;t.hide&&(u.trackLabels[t.track_id].style.display="none")}for(var r in e){let i=u.tracks[u._display_order[r]];const o=u.trackLabels[i.config.track_id];o&&(o.style.display="block",o.style.top=f+u.yOffset+"px"),t.features=e[r];let a=i.config.group;if(a?(u.groups[a]||(u.groups[a]={top:f,height:i.config.height},f+=i.config.height),t.top=i.top=u.groups[a].top,t.height=u.groups[a].height,i.bottom=t.top+t.height):(t.top=f,i.top=f,t.height=i.config.height,f+=t.height,i.bottom=f),"string"!=typeof t.features||"fasta"===i.config.type){if(s.save(),s.rect(0,t.top,t.pixelWidth,t.height),s.clip(),s.beginPath(),i.drawFeatures(t),s.restore(),u.show_scale){const e=n?s:u.scale_buffer_ctx;i.drawScale(t.pixelHeight,e,c)}}else i.drawMessage(t)}for(let e in u.highlighted_regions){let n=u.highlighted_regions[e];u.chr===n.chr&&(n.end<o||n.start>a||u.drawHighlightedRegion(n,t))}if(n)return void n(s.getSerializedSvg());u.retries=0,u.loading=!1,u.tile=new ys(l,o,a,u.bpPerPixel,h),u.paintImage(),u.call_update_listener||u._callListeners("view_changed",{chr:u.chr,start:parseInt(u.start),end:parseInt(u.end)}),u.call_update_listener=!1}else u.ctx.clearRect(0,0,u.canvas.width,u.canvas.height);u.update_required&&("location"===u.update_required?(u.update(u.chr,u.start,u.end),u.update_required=!1):(u.update_required=!1,u.update())),u.loadingIcon.style.display="none"})).catch((function(n){u.loading=!1,console.log(n),u.retries<3&&"Timed out"!==n?(u.retries++,u.repaint(e,t)):(u.loading=!1,u.force_redraw=!0,u.loadingIcon.style.display="none",u.messageAlert.textContent=n,u.messageAlert.style.display="block")}))}else this.force_redraw=!1,this.paintImage(),u.call_update_listener||u._callListeners("view_changed",{chr:u.chr,start:parseInt(u.start),end:parseInt(u.end)}),u.call_update_listener=!1,u.retries=0}autoScale(e,t,n){return e&&"string"!=typeof e?(e.forEach((function(e){t=Math.min(t,e.value),n=Math.max(n,e.value)})),{min:t,max:n}):{min:0,max:1}}calculateMaxScale(e){let t={};for(var n in e){let i=this.tracks[this.track_order[n]];i.set_scale=null;let r=i.config.group;if(r&&"fixed"!==i.config.scale&&!i.config.scale_link_to&&(i.config.scale_group=r),r=i.config.scale_group,r){let o=t[r];o?(o.features.push(e[n]),o.tracks.push(i)):(o={tracks:[i],features:[e[n]]},t[r]=o)}}for(let e in t){let n=t[e];if(!n.ignore){let e=0,t=-Number.MAX_VALUE,i=null;for(let r of n.features)i=this.autoScale(r,e,t),e=i.min,t=i.max;for(let e of n.tracks)e.set_scale=i}}}drawHighlightedRegion(e,t){let n=(e.start-t.bpStart)/t.bpPerPixel;n=n<0?0:n;let i=(e.end-e.start)/t.bpPerPixel;i=i<3?3:i,i=i>t.pixelWidth?t.pixelWidth:i,t.context.globalAlpha=.1,t.context.fillStyle=e.color,t.context.fillRect(n,0,i,t.pixelHeight),t.context.globalAlpha=1}paintImage(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.show_scale&&(this.scale_ctx.clearRect(0,0,100,this.canvas.height),this.scale_ctx.drawImage(this.scale_buffer,0,this.yOffset)),this.tile&&(this.xOffset=Math.round((this.tile.startBP-this.start)/this.bpPerPixel),this.ctx.drawImage(this.tile.image,this.xOffset,this.yOffset),this.ctx.save(),this.ctx.restore())}allowUserFeatureOver(){this.foListener||(this.foListener=e=>{this.loading||(clearTimeout(this.moto),this.moto=setTimeout((()=>{if(!this.is_dragging){let t=this.getFeatureAt(e),n=this.mouse_over_feature;if(t.feature)n&&n.feature!==t.feature&&this._callListeners("featureout",{track:n.track,feature:n.feature,event:e}),n&&n.feature===t.feature||(this._callListeners("featureover",{track:t.track,feature:t.feature,event:e}),this.mouse_over_feature=t);else{let t=this.mouse_over_feature;t&&(this._callListeners("featureout",{track:t.track,feature:t.feature,event:e}),this.mouse_over_feature=null)}}}),10))},this.trackDiv.addEventListener("mousemove",this.foListener))}removeFeatureOverHandler(){this.trackDiv.removeEventListener("mouseover",this.foListener),this.foListener=null}allowUserFeatureClick(){this.fcListener||(this.allowUserFeatureOver(),this.listeners._fcfo||this.addListener("_fcfo",((e,t)=>{"featureout"===e&&(this.trackDiv.style.cursor="default"),"featureover"===e&&(this.trackDiv.style.cursor="pointer")})),this.fcListener=e=>{this.loading||(clearTimeout(this.foto),this.foto=setTimeout((()=>{if(!this.is_dragging){let t=this.getFeatureAt(e);t.track&&this._callListeners("featureclick",{track:t.track,feature:t.feature,event:e})}}),200))},this.trackDiv.addEventListener("click",this.fcListener))}removeFeatureClickHandler(){this.trackDiv.removeEventListener("click",this.fcListener),this.fcListener=null,this.removeListener("_fcfo")}allowUserDrag(){this.drmdListener=e=>{if(e.shiftKey)return;const t=this._getCoords(e);this.isMouseDown=!0,this.start_dragging=!0,this.lastMouseX=t.x,this.lastMouseY=t.y,this.mouseDownX=this.lastMouseX},this.trackDiv.addEventListener("mousedown",this.drmdListener),this.drmmListener=e=>{let t=this._getCoords(e);if(this.is_dragging||this.start_dragging){var n=t.x-this.lastMouseX,i=this.bpPerPixel*n;this.start-=i,this.end-=i;let e=this.canvas.height-this.tile.image.height,r=0;if(e<0||0!==this.yOffset){let n=t.y-this.lastMouseY;this.yOffset+=n,this.yOffset>0?this.yOffset=0:this.yOffset<e&&(this.yOffset=e);for(let e in this.tracks){const t=this.tracks[e],n=this.trackLabels[e];n&&(n.style.display="block",n.style.top=t.top+this.yOffset+"px")}}this.repaint(),this.lastMouseX=t.x,this.lastMouseY=t.y,this.start_dragging&&(n>5||r>5)&&(this.is_dragging=!0,this.start_dragging=!1)}},this.trackDiv.addEventListener("mousemove",this.drmmListener),this.drmuListener=e=>{this.is_dragging=!1,this.start_dragging=!1},this.trackDiv.addEventListener("mouseup",this.drmuListener)}removeDragHandler(){this.trackDiv.removeEventListener("mousedown",this.drmdListener),this.trackDiv.removeEventListener("mousemove",this.drmmListener),this.trackDiv.removeEventListener("mouseup",this.drmuListener),this.drmdListener=null,this.drmmListener=null,this.drmuListener=null}_getCoords(e){const t=this.canvas.getBoundingClientRect();return{x:e.clientX-Math.round(t.left),y:e.clientY-Math.round(t.top)}}allowUserZoom(){this.zmListener=e=>{e.preventDefault();let t=e.deltaY;if(void 0===t&&(t=e.detail),this.loading||this.bpPerPixel<.05&&t<0)return;let n=this._getCoords(e),i=t>0?2:.5,r=this.start+n.x*this.bpPerPixel,o=(this.end-this.start)*i,a=r-n.x/this.canvas.width*o;this.start=a,this.end=a+o,this.repaint()},this.trackDiv.addEventListener("wheel",this.zmListener)}disableUserZoom(){this.trackDiv.removeEventListener("wheel",this.zmListener)}allowUserRangeSelection(){this.rsmdListener=e=>{if(e.shiftKey){this.start_select=this._getCoords(e).x;let t=this.start_select+"px";this.select_div=(0,A.ut)("div",{styles:{position:"absolute",opacity:.2,"background-color":"blue",top:"0px",height:this.height+"px",left:t,width:"0px"}},this.trackDiv),e.stopPropagation()}},this.trackDiv.addEventListener("mousedown",this.rsmdListener),this.rsmmListener=e=>{if(e.shiftKey&&this.start_select){let t=this._getCoords(e).x;t<this.start_select?(this.select_div.style.left=t+"px",this.select_div.style.width=this.start_select-t+"px"):(this.select_div.style.left=this.start_select+"px",this.select_div.style.width=t-this.start_select+"px"),e.stopPropagation()}},this.trackDiv.addEventListener("mousemove",this.rsmmListener),this.rsmuListener=e=>{if(this.start_select){let t=this._getCoords(e).x,n=this.start+this.start_select*this.bpPerPixel,i=this.start+t*this.bpPerPixel;if(this.start_select=null,this.select_div.remove(),n>i){let e=i;i=n,n=e}this._callListeners("range_selected",{chr:this.chr,start:n,end:i})}},this.trackDiv.addEventListener("mouseup",this.rsmuListener)}removeAllowSelection(){this.trackDiv.removeEventListener("mousedown",this.rsmdListener),this.trackDiv.removeEventListener("mousemove",this.rsmmListener),this.trackDiv.removeEventListener("mouseup",this.rsmuListener),this.rsmdListener=null,this.rsmmListener=null,this.rsmuListener=null}getImage(){this.canvas[0].toDataURL(MIME_TYPE)}getFeatureAt(e){let t=this._getCoords(e);t.y-=this.yOffset;let n=Math.round(this.start+t.x*this.bpPerPixel);for(let e in this.tracks){let i=this.tracks[e];if(t.y>i.top&&t.y<i.bottom)return{track:i,feature:i.getFeatureAt(n,this.chr,t,this.bpPerPixel,this.ctx,this.yOffset)}}return{track:null,feature:null}}setSize(e,t){if(e)this.height=t,this.width=e,this.trackDiv.style.height=t+"px",this.trackDiv.style.width=e+"px";else{const e=this.trackDiv.getBoundingClientRect();this.width=e.width,this.height=e.height}this.canvas.setAttribute("width",this.width),this.canvas.setAttribute("height",this.height),this.show_scale&&this.scale_canvas.setAttribute("height",this.height)}redrawTile(e){if(this.tile){var t=this,n=t.tile.chr,i=t.tile.startBP,r=t.tile.endBP,o=document.createElement("canvas"),a=t.tile.scale;o.width=t.tile.image.width,o.height=t.tile.image.height;var s=o.getContext("2d");t.track.draw({features:e,context:s,bpStart:i,bpPerPixel:a,pixelWidth:o.width,pixelHeight:o.height}),t.tile=new ys(n,i,r,a,o),t.paintImage()}}}(this.contentDiv,{allow_user_interactions:!0,show_scale:!0,ruler_track:r},i.tracks),this.bamscatrack=this.browser.getTrack("_atac_bam_track"),this.baseTrack=this.browser.getTrack("_base_track"),this.baseTrack.dataStore=this.dataStore,this.addMenuIcon("fa fa-eye-slash",n.legend||"Shoow/Hide Tracks",{func:e=>this.showHideDialog()}),this.locText=(0,A.ut)("input",{styles:{fontSize:"11px"}},this.menuSpace),this.locText.addEventListener("keypress",(e=>{if(13==e.keyCode){const e=this._calculatePosition(this.locText.value);this.browser.update(e.chr,e.start,e.end)}})),this.browser.addListener(this.config.id,((e,t)=>this.onBrowserAction(e,t))),i.feature_label&&this.setLabelFunction(i.feature_label),i.color_by&&this.colorByColumn(i.color_by,!1),i.color_wig_tracks_by){const e=i.color_wig_tracks_by,t=this.dataStore.getValueToColor(e);for(let n in t){const i=this.browser.tracks[`${e}|${n}`];i&&(i.config.color=t[n])}}if(!this.bamscatrack){const e=this.config.genome_location;e?this.browser.update(e.chr,Math.round(e.start),Math.round(e.end),!0):this.onDataHighlighted({indexes:[0]})}}onBrowserAction(e,t){switch(e){case"featureclick":if("_base_track"===t.track.config.track_id){const e=t.feature.data[0];this.dataStore.dataHighlighted([parseInt(e)],this)}"_bam"===t.track.config.track_id&&console.log(t.feature);break;case"range_selected":if(this.bamscatrack){const e=this.bamscatrack.getIdsInRange(t);this.cellDim.filter("filterOnIndex",[],e),this.browser.setHighlightedRegion(t,"_filter","blue"),this.resetButton.style.display="inline",this.browser.update()}break;case"view_changed":this.locText.value=`${t.chr}:${t.start}-${t.end}`}}setupLinks(e,t,n){if(this.dataLink={dataStore:e,index:t,getDataFunction:n},!this.bamscatrack)return;const i=this.config.cluster_reads;e.addListener("gb_"+this.config.id,((e,t)=>{if("filtered"===e)this.filterReads(t);else if("data_changed"===e){const e=this.config.cluster_reads;-1!==t.columns.indexOf(e)&&this.changeClusters(e,!0)}})),n([i],(()=>{const n=e.getColumnIndex(t),r=e.getColumnColors(i),o=e.columnIndex[i];this.bamscatrack.setCategories(i,o.data,o.values,r),this.cellDim=e.getDimension("base_dimension"),this.bamscatrack.addIndex(n),this.config.color_by&&this.colorByColumn(this.config.color_by);const a=this.config.genome_location;a?this.browser.update(a.chr,a.start,a.end,!0):this.onDataHighlighted({indexes:[0]})}))}changeClusters(e,t=!1){this.config.cluster_reads=e;const n=this.dataLink.dataStore;this.dataLink.getDataFunction([e],(()=>{const i=n.getColumnColors(e),r=n.columnIndex[e];this.bamscatrack.setCategories(e,r.data,r.values,i,!0,t),this.browser.update()}))}themeChanged(){this.browser.repaint(!0,!0)}showHideDialog(){const e=this.browser,t=e.track_order.map((t=>{const n=e.tracks[t].config;return{type:"checkbox",id:n.track_id,label:n.short_label,current_value:!n.hide}}));new ws({title:"Show/Hide Tracks",controls:t,doc:this.__doc__,buttons:[{text:"Update",method:t=>{for(let n in t)e.tracks[n].config.hide=!t[n];e.update()}}]})}getConfig(){const e=super.getConfig(),t=this.browser;return e.tracks=this.browser.getAllTrackConfigs(),e.genome_location={chr:t.chr,start:t.start,end:t.end},e}filterReads(e){e!==this.cellDim&&("all_removed"===e?(this.bamscatrack.filterReads(null,null),this.resetButton.style.display="none",this.browser.removeHighlightedRegion("_filter")):this.bamscatrack.filterReads(this.dataLink.dataStore.filterArray,this.cellDim.filterArray),this.browser.update())}createColumnLinks(e,t,n){this.dataLink={dataStore:e,columns:t,getDataFunction:n};const i=t[0].col,r=this.dataStore.getValueToColor(i);for(let e in r){const t=this.browser.tracks[`${i}|${e}`];t&&(t.config.color=r[e])}}onDataHighlighted(e){if(e.source===this)return;const t=this.config.param,n=this.config.view_margins,i=this.dataStore.getRowAsObject(e.indexes[0],t);let r=i[t[2]]>i[t[1]]?i[t[1]]:i[t[2]],o=i[t[2]]>i[t[1]]?i[t[2]]:i[t[1]],a=1e3;"percentage"===n.type?(o=r===o?r+1:o,a=Math.round(o-r)*(n.value/100)):a=n.value;const s=this.config.feature_present_column;if(s){const t=this.dataStore.getRowText(e.indexes[0],s).split(", ");for(let e of t)this.browser.setTrackAttribute(e,"color","#35de26");const n=this.dataStore.getColumnValues(s).slice(0).filter((e=>-1===t.indexOf(e)));for(let e of n)this.browser.setTrackAttribute(e,"color","#939c92");const i=t.concat(n),r=[];let o=0;for(let e of this.browser.track_order)-1!==i.indexOf(e)?(r.push(i[o]),o++):r.push(e);this.browser.track_order=r}this.browser.update(i[t[0]],r-a,o+a)}getImage(e,t){"svg"==t?this.browser.repaint(!0,!1,e):e(this.browser.canvas)}configure_tracks(){this.dataSrore}getColorOptions(){return{colorby:"all",has_default_color:!0}}_calculatePosition(e){let t=(e=e.replace(/,/g,"")).split(":"),n=null,i=null;1===t.length?(n=this.browser.getPosition().chr,i=t[0]):(n=t[0],i=t[1]);let r=i.split("-");return{chr:n,start:parseInt(r[0]),end:parseInt(r[1])}}colorByColumn(e,t=!0){const n=this.getColorFunction(e);this.browser.setTrackColorFunction("_base_track",(e=>n(e.data[0]))),t&&this.browser.update()}setLabelFunction(e){e?(this.config.feature_label=e,this.browser.setTrackLabelFunction("_base_track",(t=>this.dataStore.getRowText(t.data[0],e)))):(this.browser.setTrackLabelFunction("_base_track",null),delete this.config.feature_label)}onDataFiltered(e){this.dataStore.isFiltered()?this.browser.setTrackFeatureFilter("_base_track",(e=>0===this.dataStore.filterArray[e.data[0]])):this.browser.setTrackFeatureFilter("_base_track",null),this.browser.update()}removeFilter(){this.cellDim.removeFilter(),this.browser.removeHighlightedRegion("_filter"),this.browser.update()}changeBaseDocument(e){this.browser.closeAllDialogs(),super.changeBaseDocument(e),this.browser.__doc__=e}setSize(e,t){super.setSize(e,t),this.browser.setSize(),this.browser.update()}remove(e=!0){this.cellDim&&(this.cellDim.destroy(e),this.dataLink.dataStore.removeListener("gb_"+this.config.id)),super.remove()}getSettings(){const e=super.getSettings(),t=this.dataStore.getColumnList(),n=this.config;if(t.push({name:"None",field:"_none"}),this.bamscatrack){const t=this.dataLink.dataStore.getColumnList("text");e.push({label:"Group By",type:"dropdown",values:[t,"name","field"],current_value:n.cluster_reads,func:e=>{this.changeClusters(e)}})}return e.push({label:"Feature Label",type:"dropdown",values:[t,"name","field"],current_value:n.feature_label||"_none",func:e=>{e="_none"===e?null:e,this.setLabelFunction(e),this.browser.update()}}),e.push({label:"View margin type",type:"radiobuttons",choices:[["% of feature length","percentage"],["absolute (bp)","absolute"]],current_value:n.view_margins.type,func:e=>{n.view_margins.type=e;const t=this.dataStore.getHighlightedData();t&&this.onDataHighlighted({indexes:[t]})}}),e.push({label:"View margin length",type:"text",current_value:n.view_margins.value,only_update_on_enter:!0,func:e=>{e=parseInt(e),e=isNaN(e)?"percentage"===n.view_margins.type?20:1e3:e,n.view_margins.value=e;const t=this.dataStore.getHighlightedData();t&&this.onDataHighlighted({indexes:[t]})}}),e}},name:"Genome Browser",methodsUsingColumns:["setLabelFunction"],configEntriesUsingColumns:["feature_label","color_wig_tracks_by","feature_present_column"],params:[],required:["genome_browser"],init:(e,t)=>{const n=t.genome_browser;e.param=n.location_fields.slice(0),n.feature_label&&(e.feature_label=n.feature_label),n.default_parameters&&Object.assign(e,n.default_parameters);const i={short_label:n.default_track.label,url:n.default_track.url,track_id:"_base_track",decode_function:"generic",displayMode:"EXPANDED"};if(e.tracks=[i],n.default_track_parameters&&Object.assign(i,n.default_track_parameters),n.atac_bam_track&&(e.cluster_reads=n.atac_bam_track.cluster_reads,e.tracks.push({short_label:"Coverage",height:400,track_id:"_atac_bam_track",url:n.atac_bam_track.url,type:"bam_sca_track"})),e.default_track=n.default_track.url,n.default_tracks)for(let t of n.default_tracks)e.tracks.push(JSON.parse(JSON.stringify(t)))}};class xs{constructor(e,t,n={}){let i=this;const r=document.documentElement.className;let o=URL.createObjectURL(new Blob([],{type:"text/html"}));o=n.url||o;const a=n;this.window=window.open(o,"win"+(new Date).getTime(),`width=${a.width||800},\n            height=${a.height||400},\n            screenX=${a.screenX||200},\n            screenY=${a.screenY||200}\n            ;modal=yes`),this.window.addEventListener("load",(function(){let n=i.window.document;n.documentElement.className=r,this.setTimeout((()=>{n.documentElement.className=r}),1e3),n.write("<head>");let o=document.head.innerHTML;if(n.write(o),a.stylesheets)for(let e of a.stylesheets)n.write(`<link rel="stylesheet" type="text/css" href="${e}">`);n.write("</head>"),n.write("<body><body>"),a.title&&(n.title=a.title),e&&e(n,i.getDimensions()),i.onclose=t,i.window.addEventListener("beforeunload",(function(e){i.closing(n)})),a.stayInFront&&(i.focusListener=()=>{i.window.focus()},document.body.addEventListener("mousedown",i.focusListener));const s=a.onresize;s&&i.window.addEventListener("resize",(function(e){clearTimeout(i.resizeTO),i.resizeTO=setTimeout((()=>{s(n,i.getDimensions())}),200)}))}))}getDimensions(){const e=this.window;return{width:e.innerWidth-10,height:e.innerHeight-10}}closing(e){this.onclose&&this.onclose(e),this.focusListener&&document.body.removeEventListener("mousedown",this.focusListener)}close(){this.window.close()}}I.types.bar_chart={name:"Histogram",class:class extends Mt{constructor(e,t,n){Array.isArray(n.param)&&(n.param=n.param[0]);const i=e.getColumnName(n.param);n.axis||(n.axis={x:{size:30,label:i,textsize:13},y:{size:45,label:"frequency",textsize:13}}),n.title||(n.title=i),super(e,t,n,{x:{},y:{}});const r=this.config;r.type="bar_chart";const o=this.dataStore.getMinMaxForColumn(n.param);this._setConfigValue(r,"display_max",o[1]),this._setConfigValue(r,"display_min",o[0]),this._setConfigValue(r,"bin_number",10),this.brush=function(e){var t,n=$n,i=Un,r=jn,o=!0,a=ie("start","brush","end"),s=6;function l(t){var n=t.property("__brush",g).selectAll(".overlay").data([Hn("overlay")]);n.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",In.overlay).merge(n).each((function(){var e=Wn(this).extent;(0,O.Z)(this).attr("x",e[0][0]).attr("y",e[0][1]).attr("width",e[1][0]-e[0][0]).attr("height",e[1][1]-e[0][1])})),t.selectAll(".selection").data([Hn("selection")]).enter().append("rect").attr("class","selection").attr("cursor",In.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var i=t.selectAll(".handle").data(e.handles,(function(e){return e.type}));i.exit().remove(),i.enter().append("rect").attr("class",(function(e){return"handle handle--"+e.type})).attr("cursor",(function(e){return In[e.type]})),t.each(c).attr("fill","none").attr("pointer-events","all").on("mousedown.brush",f).filter(r).on("touchstart.brush",f).on("touchmove.brush",d).on("touchend.brush touchcancel.brush",p).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function c(){var e=(0,O.Z)(this),t=Wn(this).selection;t?(e.selectAll(".selection").style("display",null).attr("x",t[0][0]).attr("y",t[0][1]).attr("width",t[1][0]-t[0][0]).attr("height",t[1][1]-t[0][1]),e.selectAll(".handle").style("display",null).attr("x",(function(e){return"e"===e.type[e.type.length-1]?t[1][0]-s/2:t[0][0]-s/2})).attr("y",(function(e){return"s"===e.type[0]?t[1][1]-s/2:t[0][1]-s/2})).attr("width",(function(e){return"n"===e.type||"s"===e.type?t[1][0]-t[0][0]+s:s})).attr("height",(function(e){return"e"===e.type||"w"===e.type?t[1][1]-t[0][1]+s:s}))):e.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function h(e,t,n){var i=e.__brush.emitter;return!i||n&&i.clean?new u(e,t,n):i}function u(e,t,n){this.that=e,this.args=t,this.state=e.__brush,this.active=0,this.clean=n}function f(n){if((!t||n.touches)&&i.apply(this,arguments)){var r,a,s,l,u,f,d,p,g,m,_,v=this,b=n.target.__data__.type,y="selection"===(o&&n.metaKey?b="overlay":b)?kn:o&&n.altKey?Dn:En,w=e===zn?null:Bn[b],x=e===Pn?null:Nn[b],C=Wn(v),k=C.extent,S=C.selection,E=k[0][0],D=k[0][1],A=k[1][0],M=k[1][1],R=0,L=0,T=w&&x&&o&&n.shiftKey,P=Array.from(n.touches||[n],(e=>{const t=e.identifier;return(e=bn(e,v)).point0=e.slice(),e.identifier=t,e}));Ae(v);var z=h(v,arguments,!0).beforestart();if("overlay"===b){S&&(g=!0);const t=[P[0],P[1]||P[0]];C.selection=S=[[r=e===zn?E:Rn(t[0][0],t[1][0]),s=e===Pn?D:Rn(t[0][1],t[1][1])],[u=e===zn?A:Mn(t[0][0],t[1][0]),d=e===Pn?M:Mn(t[0][1],t[1][1])]],P.length>1&&H(n)}else r=S[0][0],s=S[0][1],u=S[1][0],d=S[1][1];a=r,l=s,f=u,p=d;var I=(0,O.Z)(v).attr("pointer-events","none"),F=I.selectAll(".overlay").attr("cursor",In[b]);if(n.touches)z.moved=N,z.ended=U;else{var B=(0,O.Z)(n.view).on("mousemove.brush",N,!0).on("mouseup.brush",U,!0);o&&B.on("keydown.brush",$,!0).on("keyup.brush",j,!0),mn(n.view)}c.call(v),z.start(n,y.name)}function N(e){for(const t of e.changedTouches||[e])for(const e of P)e.identifier===t.identifier&&(e.cur=bn(t,v));if(T&&!m&&!_&&1===P.length){const e=P[0];An(e.cur[0]-e[0])>An(e.cur[1]-e[1])?_=!0:m=!0}for(const e of P)e.cur&&(e[0]=e.cur[0],e[1]=e.cur[1]);g=!0,Cn(e),H(e)}function H(e){const t=P[0],n=t.point0;var i;switch(R=t[0]-n[0],L=t[1]-n[1],y){case Sn:case kn:w&&(R=Mn(E-r,Rn(A-u,R)),a=r+R,f=u+R),x&&(L=Mn(D-s,Rn(M-d,L)),l=s+L,p=d+L);break;case En:P[1]?(w&&(a=Mn(E,Rn(A,P[0][0])),f=Mn(E,Rn(A,P[1][0])),w=1),x&&(l=Mn(D,Rn(M,P[0][1])),p=Mn(D,Rn(M,P[1][1])),x=1)):(w<0?(R=Mn(E-r,Rn(A-r,R)),a=r+R,f=u):w>0&&(R=Mn(E-u,Rn(A-u,R)),a=r,f=u+R),x<0?(L=Mn(D-s,Rn(M-s,L)),l=s+L,p=d):x>0&&(L=Mn(D-d,Rn(M-d,L)),l=s,p=d+L));break;case Dn:w&&(a=Mn(E,Rn(A,r-R*w)),f=Mn(E,Rn(A,u+R*w))),x&&(l=Mn(D,Rn(M,s-L*x)),p=Mn(D,Rn(M,d+L*x)))}f<a&&(w*=-1,i=r,r=u,u=i,i=a,a=f,f=i,b in On&&F.attr("cursor",In[b=On[b]])),p<l&&(x*=-1,i=s,s=d,d=i,i=l,l=p,p=i,b in Fn&&F.attr("cursor",In[b=Fn[b]])),C.selection&&(S=C.selection),m&&(a=S[0][0],f=S[1][0]),_&&(l=S[0][1],p=S[1][1]),S[0][0]===a&&S[0][1]===l&&S[1][0]===f&&S[1][1]===p||(C.selection=[[a,l],[f,p]],c.call(v),z.brush(e,y.name))}function U(e){if(xn(e),e.touches){if(e.touches.length)return;t&&clearTimeout(t),t=setTimeout((function(){t=null}),500)}else _n(e.view,g),B.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);I.attr("pointer-events","all"),F.attr("cursor",In.overlay),C.selection&&(S=C.selection),qn(S)&&(C.selection=null,c.call(v)),z.end(e,y.name)}function $(e){switch(e.keyCode){case 16:T=w&&x;break;case 18:y===En&&(w&&(u=f-R*w,r=a+R*w),x&&(d=p-L*x,s=l+L*x),y=Dn,H(e));break;case 32:y!==En&&y!==Dn||(w<0?u=f-R:w>0&&(r=a-R),x<0?d=p-L:x>0&&(s=l-L),y=Sn,F.attr("cursor",In.selection),H(e));break;default:return}Cn(e)}function j(e){switch(e.keyCode){case 16:T&&(m=_=T=!1,H(e));break;case 18:y===Dn&&(w<0?u=f:w>0&&(r=a),x<0?d=p:x>0&&(s=l),y=En,H(e));break;case 32:y===Sn&&(e.altKey?(w&&(u=f-R*w,r=a+R*w),x&&(d=p-L*x,s=l+L*x),y=Dn):(w<0?u=f:w>0&&(r=a),x<0?d=p:x>0&&(s=l),y=En),F.attr("cursor",In[b]),H(e));break;default:return}Cn(e)}}function d(e){h(this,arguments).moved(e)}function p(e){h(this,arguments).ended(e)}function g(){var t=this.__brush||{selection:null};return t.extent=Tn(n.apply(this,arguments)),t.dim=e,t}return l.move=function(t,n,i){t.tween?t.on("start.brush",(function(e){h(this,arguments).beforestart().start(e)})).on("interrupt.brush end.brush",(function(e){h(this,arguments).end(e)})).tween("brush",(function(){var t=this,i=t.__brush,r=h(t,arguments),o=i.selection,a=e.input("function"==typeof n?n.apply(this,arguments):n,i.extent),s=(0,vn.Z)(o,a);function l(e){i.selection=1===e&&null===a?null:s(e),c.call(t),r.brush()}return null!==o&&null!==a?l:l(1)})):t.each((function(){var t=this,r=arguments,o=t.__brush,a=e.input("function"==typeof n?n.apply(t,r):n,o.extent),s=h(t,r).beforestart();Ae(t),o.selection=null===a?null:a,c.call(t),s.start(i).brush(i).end(i)}))},l.clear=function(e,t){l.move(e,null,t)},u.prototype={beforestart:function(){return 1==++this.active&&(this.state.emitter=this,this.starting=!0),this},start:function(e,t){return this.starting?(this.starting=!1,this.emit("start",e,t)):this.emit("brush",e),this},brush:function(e,t){return this.emit("brush",e,t),this},end:function(e,t){return 0==--this.active&&(delete this.state.emitter,this.emit("end",e,t)),this},emit:function(t,n,i){var r=(0,O.Z)(this.that).datum();a.call(t,this.that,new wn(t,{sourceEvent:n,target:l,selection:e.output(this.state.selection),mode:i,dispatch:a}),r)}},l.extent=function(e){return arguments.length?(n="function"==typeof e?e:yn(Tn(e)),l):n},l.filter=function(e){return arguments.length?(i="function"==typeof e?e:yn(!!e),l):i},l.touchable=function(e){return arguments.length?(r="function"==typeof e?e:yn(!!e),l):r},l.handleSize=function(e){return arguments.length?(s=+e,l):s},l.keyModifiers=function(e){return arguments.length?(o=!!e,l):o},l.on=function(){var e=a.on.apply(a,arguments);return e===a?l:e},l}(Pn).on("end",(e=>{const t=e.selection;if(null==t)return;const n=this.margins.left;this.setRange(this.x_scale.invert(t[0]-n),this.x_scale.invert(t[1]-n))})),this._setBrushExtent(),this.dim=this.dataStore.getDimension("range_dimension"),this.filter=null,this.binFiltered=new Array(this.config.bin_number).fill(!1),this.onDataFiltered(null,!0)}_setBrushExtent(){this.brush.extent([[this.margins.left,0],[this.width-this.margins.right,this.height-this.margins.bottom]]),this.svg.call(this.brush)}setSize(e,t){super.setSize(e,t),this._setBrushExtent(),this.drawChart(),this.svg.call(this.brush.move,null)}remove(e=!0){this.dim.destroy(e),super.remove()}removeFilter(){this.dim.removeFilter(),this.filter=null,this.binFiltered=new Array(this.config.bin_number).fill(!1),this.drawChart(),this.svg.call(this.brush.move,null)}_calculateFilterBins(){const e=this.config,t=e.bin_number;if(this.binFiltered=new Array(t).fill(!1),!this.filter)return;const n=(e.display_max-e.display_min)/e.bin_number;let i=e.display_min;for(let t=0;t<e.bin_number;t++){const e=i+t*n;(e<=this.filter[0]||e>this.filter[1])&&(this.binFiltered[t]=!0)}}setRange(e,t){this.filter=[e,t],this._calculateFilterBins(),this.dim.filter("filterRange",[this.config.param],{min:e,max:t}),this.drawChart(),this.resetButton.style.display="inline"}getFilter(){if(!this.filter)return null;const e={};return e[this.config.param]=this.filter.slice(0),e}onDataFiltered(e){if(this.dim===e||this.isPinned)return;const t=this.config.bin_number,n={bins:this.config.bin_number,max:this.config.display_max,min:this.config.display_min};"all_removed"===e&&(this.filter=null,this.binFiltered.fill(!1),this.svg.call(this.brush.move,null),this.resetButton.style.display="none"),this.dim.getBins((e=>{this.originalBinData=e,this.binData=e.slice(0,t),this.binData[t-1]+=e[t],this.drawChart()}),this.config.param,n)}drawChart(){const e=(0,O.Z)(this.contentDiv).transition().duration(400).ease(Ct),t=this._getContentDimensions(),n=this.config.bin_number,i=(t.width-3*(n+1))/n;let r=Math.max(...this.binData);r=r||1,this.x_scale.domain([this.config.display_min,this.config.display_max]),this.y_scale.domain([r,0]),this.updateAxis();const o=t.height/r,a=this;this.graph_area.selectAll(".bar").data(this.binData).join("rect").transition(e).style("fill",((e,t)=>a.binFiltered[t]?"gray":"blue")).attr("class","bar").attr("x",((e,t)=>3*(t+1)+t*i)).attr("width",i).attr("y",(e=>t.height-e*o)).attr("height",(e=>e*o))}pinChart(){this.isPinned=!0}unpinChart(){this.isPinned=!1,this.onDataFiltered()}getSettings(){const e=super.getSettings(),t=this.config,n=this.dataStore.getMinMaxForColumn(t.param);return e.concat([{type:"doubleslider",min:n[0],max:n[1],doc:this.__doc__||document,current_value:[t.display_min,t.display_max],label:"max min values",info:{text:"Sometimes outliers can skew the histogram to one side.\n                     Setting a min/max value will add all counts less/greater than the \n                     value specified to the first/last bin.",position:"left"},func:(e,n)=>{t.display_min=e,t.display_max=n,this._calculateFilterBins(),this.onDataFiltered()}},{type:"spinner",max:100,min:2,current_value:t.bin_number,label:"Number of bins",func:e=>{t.bin_number=e,this._calculateFilterBins(),this.onDataFiltered()}}])}},params:[{type:"number",name:"Frequency Data"}]};const Cs=class extends Mt{constructor(e,t,n,i){Array.isArray(n.param)&&(n.param=n.param[0]),n.title=n.title||e.getColumnName(n.param),super(e,t,n,i),this.dim=this.dataStore.getDimension("category_dimension"),this.colors=this.dataStore.getColumnColors(n.param),this.filter=[]}remove(e=!0){this.dim.destroy(e),super.remove()}setSize(e,t){super.setSize(e,t),this.drawChart()}removeFilter(){this.dim.removeFilter(),this.filter=[],this.drawChart()}filterCategories(e,t){if(t)if(-1!==this.filter.indexOf(e))this.filter=this.filter.filter((t=>t!==e));else if(0==this.filter.length){const t=this.dataStore.getColumnValues(this.config.param);this.filter=t.filter((t=>t!==e))}else this.filter.push(e);else this.filter=[e];this.resetButton.style.display="inline",this.drawChart(100),this.dim.filter("filterCategories",[this.config.param],this.filter)}getFilter(){const e={};return this.filter&&0!==this.filter.length?(e[this.config.param]=this.filter.slice(0),e):null}pinChart(){this.isPinned=!0}unpinChart(){this.isPinned=!1,this.onDataFiltered()}updateData(){const e=this.config;if(this.rowData=this.data.slice(0),e.filter_zeros&&(this.rowData=this.rowData.filter((e=>0!==e[0]))),"size"===e.sort&&this.rowData.sort(((e,t)=>t[0]-e[0])),"name"===e.sort){const t=this.dataStore.getColumnValues(e.param);this.rowData.sort(((e,n)=>t[e[1]].localeCompare(t[n[1]])))}this.rowData.length>40&&!e.show_limit&&(e.show_limit=40),e.show_limit&&e.show_limit<this.rowData.length&&this.rowData.splice(e.show_limit)}onDataFiltered(e){this.dim===e||this.isPinned||("all_removed"===e&&(this.filter=[],this.resetButton.style.display="none"),this.dim.getCategories((e=>{this.data=new Array(e.length),this.maxCount=1,this.config;for(let t=0;t<e.length;t++)this.data[t]=[e[t],t],this.maxCount=Math.max(e[t],this.maxCount);this.updateData(),this.drawChart()}),this.config.param,{}))}};I.types.row_chart={class:class extends Cs{constructor(e,t,n){super(e,t,n,{x:{}}),this.config.type="row_chart",this.onDataFiltered(null),this.labelg=this.graph_area.append("g")}drawChart(e=400){const t=this.config,n=(0,O.Z)(this.contentDiv).transition().duration(e).ease(Ct),i=this.width-this.margins.left-this.margins.right,r=this.height-this.margins.bottom-this.margins.top,o=this.dataStore.getColumnColors(this.config.param),a=this.dataStore.getColumnValues(this.config.param),s=i/this.maxCount,l=this;let c=this.rowData,h=this.maxCount;if(t.exclude_categories){const e=new Set;for(let n of t.exclude_categories)e.add(a.indexOf(n));c=this.rowData.filter(((t,n)=>!e.has(n))),h=c.reduce(((e,t)=>Math.max(e[0],t[0])))}const u=c.length,f=(r-3*(u+1))/u;let d=Math.round(f);d=d>20?20:d,this.x_scale.domain([0,this.maxCount]),this.updateAxis(),this.labelg.selectAll(".row-bar").data(c,(e=>e[1])).join("rect").attr("class","row-bar").on("click",((e,t)=>{l.filterCategories(a[t[1]],e.shiftKey)})).transition(n).style("fill",(e=>{const t=e[1];return l.filter.length>0&&-1===l.filter.indexOf(a[t])?"lightgray":o[t]})).attr("class","row-bar").attr("x",0).attr("width",(e=>e[0]*s)).attr("y",((e,t)=>3*(t+1)+t*f)).attr("height",f),this.graph_area.selectAll(".row-text").data(c,(e=>e[1])).join("text").on("click",((e,t)=>{l.filterCategories(a[t[1]],e.shiftKey)})).attr("class","row-text").transition(n).text((e=>""===a[e[1]]?"none":a[e[1]])).attr("font-size",d+"px").attr("x",5).style("fill","currentColor").attr("y",((e,t)=>3*(t+1)+t*f+f/2)).attr("dominant-baseline","central")}getSettings(){const e=super.getSettings(),t=this.config,n=Math.max(this.data.length||60);return e.concat([{type:"spinner",label:"Max Rows",current_value:t.show_limit||n,max:n,func:e=>{t.show_limit=e,this.updateData(),this.drawChart()}},{type:"check",label:"Hide zero values",current_value:t.filter_zeros,func:e=>{t.filter_zeros=e,this.updateData(),this.drawChart()}},{type:"radiobuttons",label:"Sort Order",current_value:t.sort||"default",choices:[["Default","default"],["Size","size"],["Name","name"]],func:e=>{t.sort=e,this.updateData(),this.drawChart()}}])}},name:"Row Chart",params:[{type:["text","multitext"],name:"Category"}]};var ks=__webpack_require__(626),Ss=__webpack_require__(2024);function Es(e){var t,n,i,r=[],o=this,a=new Ss.v.EventHandler,s={selectActiveRow:!0};function l(e){return function(){n||(n=!0,e.apply(this,arguments),n=!1)}}function c(e){for(var t=[],n=0;n<e.length;n++)for(var i=e[n].fromRow;i<=e[n].toRow;i++)t.push(i);return t}function h(e){for(var n=[],i=t.getColumns().length-1,r=0;r<e.length;r++)n.push(new Ss.v.Range(e[r],0,e[r],i));return n}function u(){return c(r)}function f(e){(r&&0!==r.length||e&&0!==e.length)&&(r=e,o.onSelectedRangesChanged.notify(r))}function d(e,n){i.selectActiveRow&&null!=n.row&&f([new Ss.v.Range(n.row,0,n.row,t.getColumns().length-1)])}function p(e){var n=t.getActiveCell();if(t.getOptions().multiSelect&&n&&e.shiftKey&&!e.ctrlKey&&!e.altKey&&!e.metaKey&&(e.which==Ss.v.keyCode.UP||e.which==Ss.v.keyCode.DOWN)){var i=u();i.sort((function(e,t){return e-t})),i.length||(i=[n.row]);var r,o=i[0],a=i[i.length-1];if((r=e.which==Ss.v.keyCode.DOWN?n.row<a||o==a?++a:++o:n.row<a?--a:--o)>=0&&r<t.getDataLength()){t.scrollRowIntoView(r);var s=h(function(e,t){var n,i=[];for(n=e;n<=t;n++)i.push(n);for(n=t;n<e;n++)i.push(n);return i}(o,a));f(s)}e.preventDefault(),e.stopPropagation()}}function g(e){var n=t.getCellFromEvent(e);if(!n||!t.canCellBeActive(n.row,n.cell))return!1;if(!t.getOptions().multiSelect||!e.ctrlKey&&!e.shiftKey&&!e.metaKey)return!1;var i=c(r),o=i.indexOf(n.row);if(-1===o&&(e.ctrlKey||e.metaKey))i.push(n.row),t.setActiveCell(n.row,n.cell);else if(-1!==o&&(e.ctrlKey||e.metaKey))i=i.filter((function(e,t){return e!==n.row})),t.setActiveCell(n.row,n.cell);else if(i.length&&e.shiftKey){var a=i.pop(),s=Math.min(n.row,a),l=Math.max(n.row,a);i=[];for(var u=s;u<=l;u++)u!==a&&i.push(u);i.push(a),t.setActiveCell(n.row,n.cell)}return f(h(i)),e.stopImmediatePropagation(),!0}Object.assign(this,{getSelectedRows:u,setSelectedRows:function(e){f(h(e))},getSelectedRanges:function(){return r},setSelectedRanges:f,init:function(n){i=Object.assign(s,e),t=n,a.subscribe(t.onActiveCellChanged,l(d)),a.subscribe(t.onKeyDown,l(p)),a.subscribe(t.onClick,l(g))},destroy:function(){a.unsubscribeAll()},pluginName:"RowSelectionModel",onSelectedRangesChanged:new Ss.v.Event})}class Ds extends M{constructor(e,t,n,i){super({doc:i,columns:2,width:380,maxHeight:500,title:"Bulk Edit "+n},{table:e,column:t})}init(e){this.col=e.column,this.dataModel=e.table.dataModel,this.table=e.table;const t=(0,A.ut)("div",{},this.columns[0]);(0,A.ut)("div",{text:"Value:"},t),this.valInput=(0,A.ut)("input",{},t),this.valInput.addEventListener("keyup",(e=>{const t=e.which;if(37===t||39===t||8===t)return void e.stopImmediatePropagation();const n=this.dataModel.getValueSuggestion(this.valInput.value,this.col);n&&(this.valInput.value=n)}));const n=(0,A.ut)("div",{},this.columns[0]);(0,A.ut)("div",{text:"Replace With:"},n),this.replaceInput=(0,A.ut)("input",{},n),this._createButton("Fill All Cells","_all_"),this._createButton("Fill Empty Cells","_blank_"),this._createButton("Replace Value",null),this._createButton("Delete Unused Values","_delete_"),this._createButton("Remove Column","_delete_column_")}_createButton(e,t){const n=(0,A.ut)("div",{style:{padding:"5px 10px"}},this.columns[1]);(0,A.ut)("button",{classes:["ciview-button"],text:e},n).addEventListener("click",(()=>{const e=t||this.replaceInput.value;"_delete_column_"===e?(this.table._removeColumn(this.col),this.close()):this.dataModel.replaceValues(this.valInput.value,e,this.col)}))}}class As extends M{constructor(e,t){super({doc:t,footer:!0,buttons:[{text:"Add",method:"addColumn"}],width:280,maxHeight:500,title:"Add Column"},e)}init(e){const t={padding:"5px"};this.table=e;const n=(0,A.ut)("div",{style:t},this.dialog);(0,A.ut)("div",{text:"Column Name"},n),this.name=(0,A.ut)("input",{},n),this.name.addEventListener("keydown",(e=>{"Enter"===e.key&&this.addColumn()}));const i=(0,A.ut)("div",{style:t},this.dialog),r=(0,A.ut)("div",{},i);this.cloneCheck=(0,A.ut)("input",{type:"checkbox"},r),(0,A.ut)("span",{text:"Copy Existing Column"},r);const o=e.getColumnInfo();this.cloneCol=(0,A.ut)("select",{},i);for(let e of o)(0,A.ut)("option",{text:e.name,value:e.field},this.cloneCol);const a=(0,A.ut)("div",{style:t},this.dialog);(0,A.ut)("div",{text:"Position"},a),this.position=(0,A.ut)("input",{style:{width:"100px"},value:2},a),setTimeout((()=>this.name.focus()),100)}addColumn(){if(!this.name.value)return void this.name.focus();let e=this.cloneCheck.checked?this.cloneCol.value:null,t=parseInt(this.position.value);t=isNaN(t)?null:t,this.table.createColumn(this.name.value,e,t),this.close()}}I.types.table_chart={class:class extends I{constructor(e,t,n){super(e,t,n),this.config.type="table_chart";let i=[];i=[{field:"__index__",id:"__index__",name:"index",datatype:"integer",sortable:!0,width:100}];const r=n.column_widths||{};for(let t of this.config.param){const n=e.columnIndex[t],o={id:n.field,field:n.field,name:n.name,datatype:n.datatype,sortable:!0,width:r[t]?r[t]:100};n.editable&&(o.editor=ks.H4),n.is_url&&(o.formatter=(e,t,n,i,r)=>`<a href="${n}" target="_blank">${n}</a>`),i.push(o)}this.options={enableCellNavigation:!0,enableColumnReorder:!1,editable:!1,autoEdit:!0,enableAsyncPostRender:!0,frozenColumn:null},this.dataModel=new Lt(e,{autoupdate:!1}),this.dataModel.setColumns(this.config.param),this.grid=new ks.zn(this.contentDiv,this.dataModel,i,this.options),this.grid.onHeaderCellRendered.subscribe(((e,t)=>{const n=t.column;if(n.editor&&"edit"===this.mode){const e=(0,A.ut)("i",{classes:["far","fa-edit"],style:{cursor:"pointer"}});t.node.prepend(e),e.addEventListener("click",(e=>{e.stopImmediatePropagation(),new Ds(this,n.field,n.name,this.__doc__)}))}})),this.dataModel.addListener(this.config.id,(()=>{this.grid.invalidate()})),this.grid.setColumns(this.grid.getColumns()),this.mode="select",this.grid.setSelectionModel(new Es),this.grid.init(),this.grid.onSort.subscribe(((e,t)=>{this.dataModel.sort(t.columnId,t.sortAsc?"asc":"desc"),this.grid.invalidateAllRows(),this.grid.render()})),this.grid.onSelectedRowsChanged.subscribe(((e,t)=>{"select"===this.mode&&this._rowsSelected(t)})),this.editIcon=this.addMenuIcon("fas fa-edit","Change To Edit Mode",{func:()=>{this.editIcon.firstElementChild.remove(),this.mode="select"===this.mode?"edit":"select";const e="select"===this.mode?["fas","fa-edit"]:["fas","fa-table"];(0,A.ut)("i",{classes:e},this.editIcon),this.editIcon.setAttribute("aria-label","edit"===this.mode?"Change To Selection Mode":"Change To Edit Mode"),this._changeMode()}}),this.addMenuIcon("fas fa-download","Download data",{func:()=>{this.downloadData()}}),this.filter=[],this.themeChanged(),this.onDataFiltered()}onDataHighlighted(e){if(e.source===this)return;const t=this.dataModel.data.indexOf(e.indexes[0]);-1!==t&&(this.grid.scrollRowIntoView(t),this.tempMode=this.mode,this.mode="",this.grid.setSelectedRows([t]),this.mode=this.tempMode)}onColumnRemoved(e){if(-1===this.config.param.indexOf(e))return!1;const t=this.grid.getCellEditor();t&&t.destroy(),this.grid.setActiveCell(null);let n=this.grid.getColumns();return n=n.filter((t=>t.field!==e)),this.config.param=this.config.param.filter((t=>t!==e)),this.dataModel.setColumns(this.config.param),this.grid.setColumns(n),!1}getConfig(){const e=super.getConfig(),t=this.grid.getColumns();e.param=t.filter((e=>"__index__"!==e.field)).map((e=>e.field)),e.column_widths={};for(let n of t)100!==n.width&&(e.column_widths[n.field]=n.width);return e}downloadData(){const e=this.dataModel.getDataAsBlob(),t=(0,A.ut)("a",{download:"data",target:"_blank",href:window.URL.createObjectURL(e)},this.__doc__.body);t.click(),t.remove()}_changeMode(){"select"===this.mode?(this.addColumnIcon&&(this.addColumnIcon.remove(),this.addColumnIcon=null),this.selectionModel=new Es,this.grid.setSelectionModel(this.selectionModel),this.overlay&&(this.grid.unregisterPlugin(this.overlay),this.overlay=null),this.grid.setOptions({editable:!1},!0,!0),this.grid.setColumns(this.grid.getColumns())):(this.grid.setSelectedRows([]),this.selectionModel&&(this.grid.setSelectionModel(null),this.selectionModel=null),this.grid.setOptions({editable:!0},!0,!0),this.grid.setColumns(this.grid.getColumns()),this.addColumnIcon=this.addMenuIcon("fas fa-plus","Add Column",{func:e=>{new As(this)}}),this.overlay=new ks.A5({}),this.overlay.onFillUpDown.subscribe(((e,t)=>this._updateOverlay(t))),this.grid.registerPlugin(this.overlay))}onDataChanged(e){this.grid.invalidate()}getColumnInfo(){return this.grid.getColumns().filter((e=>"text"===e.datatype)).map((e=>({name:e.name,field:e.field}))).sort(((e,t)=>e.name.localeCompare(t.name)))}createColumn(e,t=null,n=2){this.dataModel.createColumn(e,t);const i=this.grid.getColumns();(n-=1)<0||n>=i.length&&(n=i.length-1),i.splice(n,0,{name:e,field:e,id:e,datatype:"text",editor:ks.H4,sortable:!0}),this.config.param.push(e),this.grid.setColumns(i),this.grid.invalidate()}_removeColumn(e){this.dataModel.removeColumn(e,!0,!0)}_updateOverlay(e){var t=this.grid.getColumns()[e.range.fromCell];t.editor&&(this.dataModel.updateRange(t.field,e.range.fromRow,e.range.toRow,e.dir),this.grid.invalidate())}_rowsSelected(e){const t=[];for(let n of e.rows)t.push(this.dataModel.data[n]);this.dataStore.dataHighlighted(t,this)}themeChanged(){console.warn("themeChanged() deprecated")}changeBaseDocument(e){super.changeBaseDocument(e),this.grid.setBaseDocument(e),"edit"===this.mode&&(this.grid.unregisterPlugin(this.overlay),this.grid.registerPlugin(this.overlay))}setSize(e,t){super.setSize(e,t),this.grid.resizeCanvas(),this.grid.invalidate()}pinChart(){this.isPinned=!0}unpinChart(){this.isPinned=!1,this.onDataFiltered()}addColumns(){}remove(){this.grid.destroy(),super.remove()}onDataFiltered(){this.isPinned||this.dataModel.updateModel()}},name:"Table",params:[{type:"_multi_column:all",name:"Columns To Display"}]};I.types.wgl_3d_scatter_plot={name:"3D Scatter Plot",class:class extends Qi{constructor(e,t,n){n.title||(n.title=e.getColumnName(n.param[0])+" x "+e.getColumnName(n.param[1])+" x "+e.getColumnName(n.param[2])),super(e,t,n,{});const i=this.config,r=i.param;this.dim=this.dataStore.getDimension("range_dimension",r);const o=r.map((e=>this.dataStore.getColumnRange(e))),a=Math.max(...o);this.defaultCDistance=4*a,i.brush=i.brush||"default",i.center=i.center||[0,0,0],this.app=new Yi(this.graphDiv,{mode:"3d",brush:i.brush,cameraDistance:this.defaultCDistance,cameraCenter:[2*-i.center[0],2*i.center[1],2*-i.center[2]]}),this.app.addHandler("brush_stopped",((e,t)=>{this.resetButton.style.display="inline",this.app.setFilter(!0),t?this._createPolyFilter(range):this._createFilter(e)}));const s=this.afterAppCreation();let l=this.dataStore.columnIndex[r[0]],c=this.dataStore.columnIndex[r[1]],h=this.dataStore.columnIndex[r[2]];this.app.addCircles({x:"int32"===l.datatype?new Float32Array(l.data):l.data,y:"int32"===c.datatype?new Float32Array(c.data):c.data,z:"int32"===h.datatype?new Float32Array(h.data):h.data,localFilter:this.dim.getLocalFilter(),globalFilter:e.getFilter(),colorFunc:s}),i.radius=i.radius||5,i.opacity=i.opacity||.8,this.app.setPointRadius(i.radius),this.app.setPointOpacity(i.opacity),i.axis_scales=i.axis_scales||[1,1,1],this.app.axisScales=i.axis_scales,this.addAxis(),this.centerGraph(i.camera),this.app.refresh()}setAxisScales(e,t){this.config.axis_scales[e]=t,this.app.refresh()}getSettings(){let e=super.getSettings({pointMax:30,pointMin:1});const t=this.config;return e=e.concat([{type:"slider",max:3,min:.5,doc:this.__doc__,current_value:t.axis_scales[0],label:"X Axis Scale",func:e=>{this.setAxisScales(0,e)}},{type:"slider",max:3,min:.5,doc:this.__doc__,current_value:t.axis_scales[1],label:"Y Axis Scale",func:e=>{this.setAxisScales(1,e)}},{type:"slider",max:3,min:.5,doc:this.__doc__,current_value:t.axis_scales[2],label:"Z Axis Scale",func:e=>{this.setAxisScales(2,e)}}]),e}centerGraph(e){e?this.app.setCamera(e.distance,e.theta,e.phi):this.app.setCamera(this.defaultCDistance,-1.038,.261)}getConfig(){const e=super.getConfig();return e.camera=this.app.getCameraSettings(),e}_createFilter(e){this.dim.filter("filterOnIndex",[],e)}onDataAdded(e){const t=this.config.param,n=this.getSetupConfig();n.x=this.dataStore.getRawColumn(t[0]),n.y=this.dataStore.getRawColumn(t[1]),n.z=this.dataStore.getRawColumn(t[2]),this.app.updateSize(e,n),super.onDataAdded(e)}addAxis(){for(let e=0;e<3;e++){let t=this.dataStore.getMinMaxForColumn(this.config.param[e]);const n=this.config.center.map(((e,t)=>e));n[e]=t[0];const i=this.config.center.map(((e,t)=>e));i[e]=t[1];const r=[0,0,0];r[e]=255,this.app.addLine(n,i,r)}}},params:[{type:"number",name:"X axis"},{type:"number",name:"Y axis"},{type:"number",name:"Z axis"}]};I.types.ring_chart={class:class extends Cs{constructor(e,t,n){super(e,t,n,{x:{}}),this.config.type="ring_chart",this.pie=Zt().sort(null).value((e=>e[0])),this.arc=un(),this.onDataFiltered(null)}drawChart(e=1e3){(0,O.Z)(this.contentDiv).transition().duration(e).ease(Ct);const t=this._getContentDimensions(),n=Math.min(t.width,t.height)/2,i=t.left+t.width/2,r=t.top+t.height/2;this.graph_area.attr("transform",`translate(${i},${r})`),this.arc.innerRadius(.5*n).outerRadius(.9*n);const o=Math.floor(n/8),a=this.dataStore.getColumnValues(this.config.param),s=this.dataStore.getColumnColors(this.config.param),l=this.pie(this.rowData.filter((e=>0!==e[0]))),c=this;this.graph_area.selectAll(".pie-arc").data(l,((e,t)=>{e.data[1]})).join("path").on("click",((e,t)=>{c.filterCategories(a[t.data[1]],e.shiftKey)})).style("fill",((e,t)=>c.filter.length>0&&-1===c.filter.indexOf(a[e.data[1]])?"lightgray":s[e.data[1]])).attr("class","pie-arc").attr("stroke","white").attr("d",this.arc).style("stroke-width","2px"),this.graph_area.selectAll(".pie-text").data(l,((e,t)=>{e.data[1]})).join("text").on("click",((e,t)=>{c.filterCategories(a[t.data[1]],e.shiftKey)})).attr("class","pie-text").text(((e,t)=>e.endAngle-e.startAngle>.4?a[e.data[1]]:"")).attr("x",(e=>c.arc.centroid(e)[0])).attr("font-size",o+"px").attr("y",(e=>c.arc.centroid(e)[1])).attr("text-anchor","middle").attr("dominant-baseline","central")}},name:"Pie Chart",params:[{type:"text",name:"Category"}]};I.types.text_box_chart={class:class extends I{constructor(e,t,n){super(e,t,n);const i=this.config;i.text=i.text||"",this.para=(0,A.ut)("div",{styles:{padding:"5px"}},this.contentDiv),Promise.all([__webpack_require__.e(589),__webpack_require__.e(103)]).then(__webpack_require__.bind(__webpack_require__,6103)).then((({default:e})=>{this.render=e,this.para.innerHTML=this.render(i.text)}))}getSettings(){const e=super.getSettings(),t=this.config;return e.push({label:"Text",type:"textbox",current_value:t.text,func:e=>{t.text=e,this.para.innerHTML=this.render(e)}}),e}},name:"Text Box",params:[],extra_controls:()=>[{type:"textbox",name:"text"}],init:(e,t,n)=>{e.text=n.text}};const Ms={euclidean:function(e,t){for(var n=0,i=0;i<e.length;i++)n+=Math.pow(isNaN(t[i])?0:t[i]-e[i],2);return Math.sqrt(n)},manhattan:function(e,t){for(var n=0,i=0;i<e.length;i++)n+=Math.abs(t[i]-e[i]);return n},max:function(e,t){for(var n=0,i=0;i<e.length;i++)n=Math.max(n,Math.abs(t[i]-e[i]));return n}};class Rs{constructor(e,t,n){this.distance=Ms[e],this.distance||(this.distance=Ms.euclidean),this.linkage=t||"average",this.threshold=null==n?1/0:n}cluster(e,t,n){this.clusters=[],this.dists=[],this.mins=[],this.index=[];for(var i=0;i<e.length;i++){var r={value:e[i],key:i,index:i,size:1};this.clusters[i]=r,this.index[i]=r,this.dists[i]=[],this.mins[i]=0}for(i=0;i<this.clusters.length;i++)for(var o=0;o<=i;o++){var a=i==o?1/0:this.distance(this.clusters[i].value,this.clusters[o].value);this.dists[i][o]=a,this.dists[o][i]=a,a<this.dists[i][this.mins[i]]&&(this.mins[i]=o)}var s=this.mergeClosest();for(i=0;s;)n&&i++%t==0&&n(this.clusters),s=this.mergeClosest();return this.clusters.forEach((function(e){delete e.key,delete e.index})),this.node_order=[],this.order=0,this.orderClusters(this.clusters[0]),this.clusters}mergeClosest(){for(var e=0,t=1/0,n=0;n<this.clusters.length;n++){var i=this.clusters[n].key;(s=this.dists[i][this.mins[i]])<t&&(e=i,t=s)}if(t>=this.threshold)return!1;var r=this.index[e],o=this.index[this.mins[e]],a={children:[r,o],key:r.key,size:r.size+o.size};for(this.clusters[r.index]=a,this.clusters.splice(o.index,1),this.index[r.key]=a,n=0;n<this.clusters.length;n++){var s,l=this.clusters[n];r.key==l.key?s=1/0:"single"==this.linkage?(s=this.dists[r.key][l.key],this.dists[r.key][l.key]>this.dists[o.key][l.key]&&(s=this.dists[o.key][l.key])):"complete"==this.linkage?(s=this.dists[r.key][l.key],this.dists[r.key][l.key]<this.dists[o.key][l.key]&&(s=this.dists[o.key][l.key])):s="average"==this.linkage?(this.dists[r.key][l.key]*r.size+this.dists[o.key][l.key]*o.size)/(r.size+o.size):this.distance(l.value,r.value),this.dists[r.key][l.key]=this.dists[l.key][r.key]=s}for(n=0;n<this.clusters.length;n++){var c=this.clusters[n].key;if(this.mins[c]==r.key||this.mins[c]==o.key){t=c;for(var h=0;h<this.clusters.length;h++){var u=this.clusters[h].key;this.dists[c][u]<this.dists[c][t]&&(t=u)}this.mins[c]=t}this.clusters[n].index=n}return delete r.key,delete o.key,delete r.index,delete o.index,!0}orderClusters(e){for(let t in e)"children"===t&&(this.orderClusters(e[t][0]),this.orderClusters(e[t][1])),"value"===t&&(e[t]._order=this.order++,this.node_order.push(e[t]._id))}}function Ls(e,t={}){const n=new Rs(t.distance,t.linkage,t.threshold);n.cluster(e);const i=_i(n.clusters[0]);for(let e of i.descendants()){let t=e.data;delete t.size,t.value&&(t.id=t.value._id,t.order=t.value._order,delete t.value)}return{nodes:i,order:n.node_order}}function Ts(e){this._context=e}function Ps(e){return new Ts(e)}function zs(e){return e[0]}function Is(e){return e[1]}function Os(e,t){var n=Pt(!0),i=null,r=Ps,o=null;function a(a){var s,l,c,h=(a=Tt(a)).length,u=!1;for(null==i&&(o=r(c=nn())),s=0;s<=h;++s)!(s<h&&n(l=a[s],s,a))===u&&((u=!u)?o.lineStart():o.lineEnd()),u&&o.point(+e(l,s,a),+t(l,s,a));if(c)return o=null,c+""||null}return e="function"==typeof e?e:void 0===e?zs:Pt(e),t="function"==typeof t?t:void 0===t?Is:Pt(t),a.x=function(t){return arguments.length?(e="function"==typeof t?t:Pt(+t),a):e},a.y=function(e){return arguments.length?(t="function"==typeof e?e:Pt(+e),a):t},a.defined=function(e){return arguments.length?(n="function"==typeof e?e:Pt(!!e),a):n},a.curve=function(e){return arguments.length?(r=e,null!=i&&(o=r(i)),a):r},a.context=function(e){return arguments.length?(null==e?i=o=null:o=r(i=e),a):i},a}function Fs(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function Bs(e){this._context=e}function Ns(e){return new Bs(e)}I.types.heat_map={name:"Heat Map",class:class extends Mt{constructor(e,t,n){n.title=n.title||e.getColumnName(n.param[0]),super(e,t,n,{x:{type:"band"},y:{type:"band"},tx:{custom:!0,size:45}});const i=this.config.param,r=this.dataStore.getColumnValues(i[0]);this.x_scale.domain(r.slice(0));const o=[],a=this.config;a.method=a.method||"mean",a.color_scale=a.color_scale||{log:!1},a.color_legend||(a.color_legend={display:!0}),this.setColorFunction();for(let e=1;e<i.length;e++)o.push(this.dataStore.getColumnName(i[e]));this.cat_scale=(0,Z.Z)().range([0,40]),this.cat_axis_svg=this.svg.append("g"),this.cat_axis_call=(0,kt.y4)(this.cat_scale).ticks(3),this.y_scale.domain(o),this.dim=this.dataStore.getDimension("catcol_dimension"),a.cluster_rows&&(this.margins.right=70),this.addToolTip(),this.onDataFiltered()}remove(e=!0){this.dim.destroy(e),super.remove()}setColorFunction(){const e=this.config.param,t={useValue:!0,overideValues:{colorLogScale:this.config.color_scale.log,colors:["#313695","#4575B4","#74ADD1","#ABD9E9","#E0F3F8","#E0F3F8","#FFFFBF","#FEE090","#FDAE61","#F46D43","#D73027","#A50026"],max:1,min:0}};this.colorFunction=this.dataStore.getColorFunction(e[1],t),this.setColorLegend()}getColorLegend(){const e={overideValues:{max:1,min:0,colorLogScale:this.config.color_scale.log,colors:["#313695","#4575B4","#74ADD1","#ABD9E9","#E0F3F8","#E0F3F8","#FFFFBF","#FEE090","#FDAE61","#F46D43","#D73027","#A50026"]},name:"Scale"};return this.dataStore.getColorLegend(this.config.param[1],e)}onDataFiltered(e){if(this.dim===e||this.isPinned)return;"all_removed"===e&&(this.filter=[],this.resetButton.style.display="none");const t={method:this.config.method,scaleVals:[]},n=this.config.param;let i="none"==this.config.color_scale.trim?null:this.config.color_scale.trim;for(let e=1;e<n.length;e++){const r=this.dataStore.columnIndex[n[e]];t.scaleVals.push([i?r.quantiles[i][0]:r.minMax[0],i?r.quantiles[i][1]:r.minMax[1]])}this.dim.getAverages((e=>{this.data=e,this.clusterRows(),this.clusterColumns(),this.drawChart()}),this.config.param,t)}clusterRows(){this.config.cluster_rows?(this.rowClusterNodes=Ls(this.data.averages),this.data.averages.sort(((e,t)=>e._order-t._order)),this.margins.right=70,this.y_scale.domain(this.rowClusterNodes.order.map((e=>this.dataStore.getColumnName(this.config.param[e+1]))))):(delete this.rowClusterNodes,this.y_scale.domain(this.config.param.slice(1).map((e=>this.dataStore.getColumnName(e)))),this.margins.right=10,this.data.averages.sort(((e,t)=>e._id-t._id)),this.ry_axis_svg.selectAll("*").remove())}clusterColumns(){const e=this.dataStore.getColumnValues(this.config.param[0]);this.config.cluster_columns?(this.columnClusterNodes=Ls(this.data.transpose),this.data.transpose.sort(((e,t)=>e._order-t._order)),this.x_scale.domain(this.columnClusterNodes.order.map((t=>e[t]))),this.setAxisSize("tx",85)):(delete this.columnClusterNodes,this.x_scale.domain(this.data.transpose.map((t=>e[t._id]))),this.setAxisSize("tx",45),this.data.transpose.sort(((e,t)=>e._id-t._id)),this.x_scale.domain(this.data.transpose.map((t=>e[t._id]))),this.tx_axis_svg.selectAll("path").remove())}drawChart(e=400){const t=(0,O.Z)(this.contentDiv).transition().duration(e).ease(Ct),n=this.dataStore.getColumnValues(this.config.param[0]),i=this.dataStore.getColumnColors(this.config.param[0]),r=this._getContentDimensions(),o=r.width/this.data.transpose.length,a=o/2,s=Math.max(...this.data.catTotals);this.cat_scale.domain([s,0]);const l=0===s?0:40/s,c=this.data.transpose.map((e=>[this.data.catTotals[e._id],e._id])),h=this,u=r.height/(this.config.param.length-1);this.graph_area.selectAll(".heatmap-row").data(this.data.averages).join("g").attr("transform",((e,t)=>`translate(0,${t*u})`)).attr("class","heatmap-row").selectAll(".heatmap-rect").data((e=>e.map(((t,n)=>{const i=e._id,r=h.data.transpose[n]._id;return{av:h.data.transpose[n][i],row_id:i,col_id:r,miss:!1}})))).join("rect").attr("class","heatmap-rect").attr("x",((e,t)=>t*o)).attr("height",u).attr("width",o).on("click",((e,t)=>{const i=h.config.param[t.row_id+1];this._callListeners("cell_clicked",{row:i,col:n[t.col_id],val:t.av})})).on("mouseover mousemove",((e,t)=>{const i=h.dataStore.columnIndex[h.config.param[t.row_id+1]].name;h.showToolTip(e,`${n[t.col_id]}<br>${i}<br>${t.av.toPrecision(2)}`)})).on("mouseleave",(()=>{h.hideToolTip()})).transition(t).attr("fill",((e,t)=>e.miss?"#DCDCDC":h.colorFunction(e.av)));const f=(0,O.Z)(this.contentDiv).transition().duration(e).ease(Ct);this.tx_axis_svg.selectAll(".heatmap-catsize").data(c,((e,t)=>e[1])).join((e=>e.append("rect").attr("class","heatmap-catsize").attr("height",0).attr("y",45).attr("x",((e,t)=>a/2+t*o)).attr("width",a)),(e=>e),(e=>e.call((e=>e.transition(f).attr("height",0).attr("y",45).remove())))).transition(f).attr("y",(e=>40-e[0]*l+5)).attr("height",(e=>e[0]*l)).attr("fill",((e,t)=>i[e[1]])).attr("width",a).attr("x",((e,t)=>a/2+t*o)),this.cat_axis_svg.attr("transform",`translate(${r.left},5)`),this.cat_axis_svg.transition().call(this.cat_axis_call),this.updateAxis(),this.rowClusterNodes&&this.drawYTree(this.rowClusterNodes.nodes,this.config.param.length-1),this.columnClusterNodes&&this.drawXTree(this.columnClusterNodes.nodes,this.data.transpose.length,40,45)}setSize(e,t){super.setSize(e,t),this.drawChart()}getSettings(){const e=this.config;return super.getSettings().concat([{type:"check",label:"Cluster Rows",current_value:e.cluster_rows,func:t=>{e.cluster_rows=t,this.clusterRows(),this.drawChart()}},{type:"check",label:"Cluster Columns",current_value:e.cluster_columns,func:t=>{e.cluster_columns=t,this.clusterColumns(),this.drawChart()}},{type:"radiobuttons",label:"Averaging Method",current_value:e.method,choices:[["Mean","mean"],["Median","median"]],func:t=>{e.method=t,this.onDataFiltered()}},{type:"radiobuttons",label:"Trim to Percentile",current_value:e.color_scale.trim||"none",choices:[["No Trim","none"],["0.001","0.001"],["0.01","0.01"],["0.05","0.05"]],func:t=>{e.color_scale.trim=t,this.onDataFiltered()}},{label:"Show Color Legend",type:"check",current_value:!e.color_legend||e.color_legend.display,func:t=>{e.color_legend.display=t,this.setColorLegend()}},{type:"check",label:"Log Color Scale",current_value:e.color_scale.log,func:t=>{e.color_scale.log=t,this.setColorFunction(),this.drawChart()}}])}},params:[{type:"text",name:"Categories on x-axis"},{type:"_multi_column:number",name:"Fields on y axis"}]},Ts.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t)}}},Bs.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Fs(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Fs(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};class Hs extends Qi{constructor(e,t,n){const i=e.getColumnName(n.param[0]),r=e.getColumnName(n.param[1]);n.axis||(n.axis={x:{size:30,label:i,textsize:13},y:{size:45,label:r,textsize:13}}),n.title||(n.title=i+" x "+r),super(e,t,n,{x:{type:"band"},y:{}}),this.config.type="violin_plot";const o=this.config;o.brush=o.brush||"poly";let a={brush:o.brush};this.app=new Yi(this.graphDiv,a);const s=this.afterAppCreation(),l=this.dataStore.size;this.xPosBuff=new SharedArrayBuffer(4*l),this.xPos=new Float32Array(this.xPosBuff),this.values=this.dataStore.getColumnValues(o.param[0]);const c=this.dataStore.getRawColumn(o.param[0]);for(let e=0;e<l;e++)this.xPos[e]=50*c[e]+4+42*Math.random();const h=this.dataStore.getMinMaxForColumn(o.param[1]);this.defaultBandWidth=(h[1]-h[0])/100,o.band_width=o.band_width||this.defaultBandWidth,o.intervals=o.intervals||20,this.dim=this.dataStore.getDimension("catrange_dimension"),this.x_scale.domain(this.values);const u=this.dataStore.columnIndex[o.param[1]];this.app.addCircles({x:this.xPos,y:"int32"===u.datatype?new Float32Array(u.data):u.data,localFilter:this.dim.getLocalFilter(),globalFilter:this.dataStore.getFilter(),colorFunc:s}),this.app.addHandler("brush_stopped",((e,t)=>{this.resetButton.style.display="inline",this.app.setFilter(!0),t?this._createPolyFilter(e):this._createFilter(e)})),o.radius=o.radius||5,o.opacity=o.opacity||.8,this.app.setPointRadius(this.config.radius),this.app.setPointOpacity(this.config.opacity),this.data=[],this.centerGraph(),this.onDataFiltered()}_createFilter(e){if(this.range=e,null==e)this.dim.removeFilter();else{let t=e.y_max,n=e.y_min,i=e.x_max,r=e.x_min;this.filter=[[r,i],[n,t]],this.dim("filterSquare",[this.xPos,this.config.param[1]],{range1:this.filter[0],range2:this.filter[1]},[this.xPos,1]),this.app.refresh()}}onDataFiltered(e){if(!this.isPinned&&e!==this.dim){"all_removed"===e&&(this.app.clearBrush(),this.app.setFilter(!1),this.resetButton.style.display="none");const t=this.config;this.ticks=this.y_scale.ticks(t.intervals),this.dim.getKernalDensity((e=>{this.data=e,this.drawChart()}),t.param,{ticks:this.ticks,bandwidth:t.band_width,intervals:t.intervals,xPos:this.xPosBuff})}}drawChart(){const e=(0,O.Z)(this.contentDiv).transition().duration(400).ease(Ct),t=[],n=this.data.length,i=this._getContentDimensions(),r=i.width/n,o=[];for(let e=0;e<this.data.length;e++)t.push(r/(2*this.data[e].max)*.9),o.push(this.values[this.data[e].id]);this.x_scale.domain(o),this.centerGraph();const a=this.ticks.map((e=>this.y_scale(e))),s=[];for(let e=0;e<this.data.length;e++){const n=e*r+.5*r,o=[];let l=!0;for(let i=0;i<this.data[e].length;i++){const r=this.data[e][i];if(0===r||isNaN(r)){if(!l){if(0==o[o.length-1][2])continue;o.push([a[i],n,0])}}else{if(0===o.length){if(0===i){o.push([0,n,0]);continue}o.push([a[i-1],n,0]),l=!1}o.push([a[i],n,t[e]*r])}}0===o.length?(o.push([0,n,0]),o.push([0,n,0])):0!==o[o.length-1][2]&&o.push([i.height,n,0]),s.push(o),o.id=this.data[e].id}const l=this.dataStore.getColumnColors(this.config.param[0]);this.graph_area.selectAll(".violin-curve").data(s,(e=>"A"+e.id)).join("path").attr("class","violin-curve").transition(e).attr("fill","none").attr("stroke",((e,t)=>l[e.id])).attr("stroke-width",2).attr("stroke-linejoin","round").attr("d",Os().curve(Ns).x((function(e,t){return e[1]+e[2]})).y((function(e,t){return e[0]}))),this.graph_area.selectAll(".violin-curve1").data(s,(e=>"B"+e.id)).join("path").attr("class","violin-curve1").transition(e).attr("fill","none").attr("stroke",((e,t)=>l[e.id])).attr("stroke-width",2).attr("stroke-linejoin","round").attr("d",Os().curve(Ns).x((function(e,t){return e[1]-e[2]})).y((function(e,t){return e[0]}))),this.app.refresh()}unpinChart(){super.unpinChart(),this.onDataFiltered()}onDataAdded(e){const t=this.config.param,n=this.getSetupConfig();let i=new Float32Array(e);i.set(this.xPos),this.values=this.dataStore.getColumnValues(t[0]);const r=this.dataStore.getRawColumn(t[0]);for(let t=this.xPos.length;t<e;t++)i[t]=50*r[t]+4+42*Math.random();this.xPos=i,n.x=i,n.y=this.dataStore.getRawColumn(t[1]),this.dim.filterColumns&&(this.dimFilterColumns[0]=i),this.app.updateSize(e,n),super.onDataAdded(e)}setSize(e,t){super.setSize(e,t),this.drawChart()}centerGraph(){const e=this.dataStore.getMinMaxForColumn(this.config.param[1]);let t=50*this.data.length,n=e[1],i=e[0],r=(n-i)/20,o=t-0,a=n-i+2*r;const s=this._getContentDimensions();this.app.x_scale=s.width/o,this.app.y_scale=s.height/a,this.app.offset[0]=-0,this.app.offset[1]=n+r,this._updateScale(this.app.getRange()),this.updateAxis()}_updateScale(e){this.y_scale.domain([-e.y_range[0],-e.y_range[1]])}getSettings(){const e=super.getSettings(),t=this.config,n=this.dataStore.getMinMaxForColumn(t.param[1]);return e.splice(1,0,{type:"slider",max:n[1]/10,min:n[0]<0?0:n[0],doc:this.__doc__,current_value:t.band_width,label:"Band Width",func:e=>{t.band_width=e,this.onDataFiltered()}},{type:"slider",max:100,min:10,step:1,doc:this.__doc__,current_value:t.intervals,label:"Intervals",func:e=>{t.intervals=e,this.onDataFiltered()}}),e}_createPolyFilter(e){this.range=!0;for(let t of e)t[1]=-t[1],this.config.axis.x_log_scale&&(t[0]=this._getInverseLogValue(t[0])),this.config.axis.y_log_scale&&(t[1]=this._getInverseLogValue(t[1]));this.filter=e,this.dim.filter("filterPoly",[this.xPos,this.config.param[1]],e),this.app.refresh()}}I.types.violin_plot={class:Hs,name:"Violin Plot",params:[{type:"text",name:"Category (X axis)"},{type:"number",name:"Value (Y axis)"}]};const Us=Hs;function $s(e,t){let n=0;if(void 0===t)for(let t of e)(t=+t)&&(n+=t);else{let i=-1;for(let r of e)(r=+t(r,++i,e))&&(n+=r)}return n}function js(e,t){let n;if(void 0===t)for(const t of e)null!=t&&(n<t||void 0===n&&t>=t)&&(n=t);else{let i=-1;for(let r of e)null!=(r=t(r,++i,e))&&(n<r||void 0===n&&r>=r)&&(n=r)}return n}function Ws(e,t){return e.sourceLinks.length?e.depth:t-1}function qs(e){return function(){return e}}function Vs(e,t){return Gs(e.source,t.source)||e.index-t.index}function Ks(e,t){return Gs(e.target,t.target)||e.index-t.index}function Gs(e,t){return e.y0-t.y0}function Zs(e){return e.value}function Xs(e){return e.index}function Ys(e){return e.nodes}function Qs(e){return e.links}function Js(e,t){const n=e.get(t);if(!n)throw new Error("missing: "+t);return n}function el({nodes:e}){for(const t of e){let e=t.y0,n=e;for(const n of t.sourceLinks)n.y0=e+n.width/2,e+=n.width;for(const e of t.targetLinks)e.y1=n+e.width/2,n+=e.width}}I.types.box_plot={class:class extends Us{constructor(e,t,n){super(e,t,n),this.config.type="box_plot"}onDataFiltered(e){this.isPinned||e!==this.dim&&("all_removed"===e&&(this.app.clearBrush(),this.app.setFilter(!1),this.resetButton.style.display="none"),this.ticks=this.y_scale.ticks(20),this.dim.getBoxPlotData((e=>{this.data=e,this.drawChart()}),this.config.param,{xPos:this.xPosBuff}))}drawChart(){const e=(0,O.Z)(this.contentDiv).transition().duration(400).ease(Ct),t=this.data.length,n=this.y_scale,i=[];for(let e of this.data)i.push(this.values[e.id]);this.x_scale.domain(i),this.centerGraph();const r=this._getContentDimensions().width/t,o=this.dataStore.getColumnColors(this.config.param[0]);this.graph_area.selectAll(".boxplot-rect").data(this.data,(e=>e.id)).join("rect").attr("class","boxplot-rect").transition(e).attr("x",((e,t)=>t*(r-3)+3*(t+1))).attr("y",(e=>n(e.Q3))).attr("width",r-6).attr("height",(e=>{const t=n(e.Q1)-n(e.Q3);return isNaN(t)?0:t})).attr("fill","none").attr("stroke",((e,t)=>o[e.id])).attr("stroke-width",3),this.graph_area.selectAll(".boxplot-whisker").data(this.data,(e=>e.id)).join("path").attr("class","boxplot-whisker").transition(e).attr("stroke",((e,t)=>o[e.id])).attr("fill","none").attr("stroke-width",3).attr("d",((e,t)=>{if(isNaN(e.med))return"";const i=t*(r-6)+6*(t+1),o=t*(r-3)+3*(t+1),a=t*r+.5*r,s=n(e.max),l=n(e.min);return null==s||null==l?"":`\n             M${i} ${s} L${i+r-12} ${s}\n             M${a} ${s} L${a} ${n(e.Q3)}\n             M${o} ${n(e.med)} L${o+r-6} ${n(e.med)}\n             M${a} ${l} L${a} ${n(e.Q1)}\n             M${i} ${l} L${i+r-12} ${l}`})),this.app.refresh()}},name:"Box Plot",params:[{type:"text",name:"Category (X axis)"},{type:"number",name:"Value (Y axis)"}]};var tl=Math.PI,nl=2*tl,il=1e-6,rl=nl-il;function ol(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function al(){return new ol}ol.prototype=al.prototype={constructor:ol,moveTo:function(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function(e,t,n,i){this._+="Q"+ +e+","+ +t+","+(this._x1=+n)+","+(this._y1=+i)},bezierCurveTo:function(e,t,n,i,r,o){this._+="C"+ +e+","+ +t+","+ +n+","+ +i+","+(this._x1=+r)+","+(this._y1=+o)},arcTo:function(e,t,n,i,r){e=+e,t=+t,n=+n,i=+i,r=+r;var o=this._x1,a=this._y1,s=n-e,l=i-t,c=o-e,h=a-t,u=c*c+h*h;if(r<0)throw new Error("negative radius: "+r);if(null===this._x1)this._+="M"+(this._x1=e)+","+(this._y1=t);else if(u>il)if(Math.abs(h*s-l*c)>il&&r){var f=n-o,d=i-a,p=s*s+l*l,g=f*f+d*d,m=Math.sqrt(p),_=Math.sqrt(u),v=r*Math.tan((tl-Math.acos((p+u-g)/(2*m*_)))/2),b=v/_,y=v/m;Math.abs(b-1)>il&&(this._+="L"+(e+b*c)+","+(t+b*h)),this._+="A"+r+","+r+",0,0,"+ +(h*f>c*d)+","+(this._x1=e+y*s)+","+(this._y1=t+y*l)}else this._+="L"+(this._x1=e)+","+(this._y1=t)},arc:function(e,t,n,i,r,o){e=+e,t=+t,o=!!o;var a=(n=+n)*Math.cos(i),s=n*Math.sin(i),l=e+a,c=t+s,h=1^o,u=o?i-r:r-i;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+l+","+c:(Math.abs(this._x1-l)>il||Math.abs(this._y1-c)>il)&&(this._+="L"+l+","+c),n&&(u<0&&(u=u%nl+nl),u>rl?this._+="A"+n+","+n+",0,1,"+h+","+(e-a)+","+(t-s)+"A"+n+","+n+",0,1,"+h+","+(this._x1=l)+","+(this._y1=c):u>il&&(this._+="A"+n+","+n+",0,"+ +(u>=tl)+","+h+","+(this._x1=e+n*Math.cos(r))+","+(this._y1=t+n*Math.sin(r))))},rect:function(e,t,n,i){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +n+"v"+ +i+"h"+-n+"Z"},toString:function(){return this._}};const sl=al;var ll=Array.prototype.slice;function cl(e){return function(){return e}}function hl(e){return e[0]}function ul(e){return e[1]}function fl(e){return e.source}function dl(e){return e.target}function pl(e,t,n,i,r){e.moveTo(t,n),e.bezierCurveTo(t=(t+i)/2,n,t,r,i,r)}function gl(e){return[e.source.x1,e.y0]}function ml(e){return[e.target.x0,e.y1]}function _l(){return function(e){var t=fl,n=dl,i=hl,r=ul,o=null;function a(){var a,s=ll.call(arguments),l=t.apply(this,s),c=n.apply(this,s);if(o||(o=a=sl()),e(o,+i.apply(this,(s[0]=l,s)),+r.apply(this,s),+i.apply(this,(s[0]=c,s)),+r.apply(this,s)),a)return o=null,a+""||null}return a.source=function(e){return arguments.length?(t=e,a):t},a.target=function(e){return arguments.length?(n=e,a):n},a.x=function(e){return arguments.length?(i="function"==typeof e?e:cl(+e),a):i},a.y=function(e){return arguments.length?(r="function"==typeof e?e:cl(+e),a):r},a.context=function(e){return arguments.length?(o=null==e?null:e,a):o},a}(pl).source(gl).target(ml)}function vl(e,t,n){var i=null,r=Pt(!0),o=null,a=Ps,s=null;function l(l){var c,h,u,f,d,p=(l=Tt(l)).length,g=!1,m=new Array(p),_=new Array(p);for(null==o&&(s=a(d=nn())),c=0;c<=p;++c){if(!(c<p&&r(f=l[c],c,l))===g)if(g=!g)h=c,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),u=c-1;u>=h;--u)s.point(m[u],_[u]);s.lineEnd(),s.areaEnd()}g&&(m[c]=+e(f,c,l),_[c]=+t(f,c,l),s.point(i?+i(f,c,l):m[c],n?+n(f,c,l):_[c]))}if(d)return s=null,d+""||null}function c(){return Os().defined(r).curve(a).context(o)}return e="function"==typeof e?e:void 0===e?zs:Pt(+e),t="function"==typeof t?t:Pt(void 0===t?0:+t),n="function"==typeof n?n:void 0===n?Is:Pt(+n),l.x=function(t){return arguments.length?(e="function"==typeof t?t:Pt(+t),i=null,l):e},l.x0=function(t){return arguments.length?(e="function"==typeof t?t:Pt(+t),l):e},l.x1=function(e){return arguments.length?(i=null==e?null:"function"==typeof e?e:Pt(+e),l):i},l.y=function(e){return arguments.length?(t="function"==typeof e?e:Pt(+e),n=null,l):t},l.y0=function(e){return arguments.length?(t="function"==typeof e?e:Pt(+e),l):t},l.y1=function(e){return arguments.length?(n=null==e?null:"function"==typeof e?e:Pt(+e),l):n},l.lineX0=l.lineY0=function(){return c().x(e).y(t)},l.lineY1=function(){return c().x(e).y(n)},l.lineX1=function(){return c().x(i).y(t)},l.defined=function(e){return arguments.length?(r="function"==typeof e?e:Pt(!!e),l):r},l.curve=function(e){return arguments.length?(a=e,null!=o&&(s=a(o)),l):a},l.context=function(e){return arguments.length?(null==e?o=s=null:s=a(o=e),l):o},l}I.types.sankey_chart={name:"Sankey Diagram",class:class extends Mt{constructor(e,t,n){const i=e.getColumnName(n.param[0]),r=e.getColumnName(n.param[1]);n.label||(n.label=`${i} vs. ${r}`),n.axis||(n.axis={}),n.axis.y||(n.axis.y={size:25,textSize:15,label:i}),n.axis.ry||(n.axis.ry={size:25,textSize:15,label:r}),super(e,t,n,{y:{custom:!0},ry:{label:!0}}),this.config.type="sankey_chart",this.dim=this.dataStore.getDimension("category_dimension"),this.filter=[],this.addToolTip(),this.onDataFiltered()}setSize(e,t){super.setSize(e,t),this.drawChart()}remove(e=!0){this.dim.destroy(e),super.remove()}removeFilter(){this.dim.removeFilter(),this.filter=[],this.nodeFilter=null,this.linkFilter=null,this.drawChart()}onDataFiltered(e){this.dim===e||this.isPinned||("all_removed"===e&&(this.filter=[],this.nodeFilter=null,this.linkFilter=null,this.resetButton.style.display="none"),this.dim.getSankeyData((e=>{this.sankeyData=e,this.drawChart()}),this.config.param))}drawChart(){this.updateAxis();const e=(0,O.Z)(this.contentDiv).transition().duration(400).ease(Ct),t=this._getContentDimensions(),n=this.config.param,i=[this.dataStore.getColumnColors(n[0]),this.dataStore.getColumnColors(n[1])],r=this;let o=20-this.sankeyData.minNodes;o=o<1?1:o>10?10:o;const a=function(){let e,t,n,i=0,r=0,o=1,a=1,s=24,l=8,c=Xs,h=Ws,u=Ys,f=Qs,d=6;function p(){const e={nodes:u.apply(null,arguments),links:f.apply(null,arguments)};return g(e),m(e),_(e),v(e),b(e),el(e),e}function g({nodes:e,links:t}){for(const[t,n]of e.entries())n.index=t,n.sourceLinks=[],n.targetLinks=[];const i=new Map(e.map(((t,n)=>[c(t,n,e),t])));for(const[e,n]of t.entries()){n.index=e;let{source:t,target:r}=n;"object"!=typeof t&&(t=n.source=Js(i,t)),"object"!=typeof r&&(r=n.target=Js(i,r)),t.sourceLinks.push(n),r.targetLinks.push(n)}if(null!=n)for(const{sourceLinks:t,targetLinks:i}of e)t.sort(n),i.sort(n)}function m({nodes:e}){for(const t of e)t.value=void 0===t.fixedValue?Math.max($s(t.sourceLinks,Zs),$s(t.targetLinks,Zs)):t.fixedValue}function _({nodes:e}){const t=e.length;let n=new Set(e),i=new Set,r=0;for(;n.size;){for(const e of n){e.depth=r;for(const{target:t}of e.sourceLinks)i.add(t)}if(++r>t)throw new Error("circular link");n=i,i=new Set}}function v({nodes:e}){const t=e.length;let n=new Set(e),i=new Set,r=0;for(;n.size;){for(const e of n){e.height=r;for(const{source:t}of e.targetLinks)i.add(t)}if(++r>t)throw new Error("circular link");n=i,i=new Set}}function b(n){const c=function({nodes:e}){const n=js(e,(e=>e.depth))+1,r=(o-i-s)/(n-1),a=new Array(n);for(const t of e){const e=Math.max(0,Math.min(n-1,Math.floor(h.call(null,t,n))));t.layer=e,t.x0=i+e*r,t.x1=t.x0+s,a[e]?a[e].push(t):a[e]=[t]}if(t)for(const e of a)e.sort(t);return a}(n);e=Math.min(l,(a-r)/(js(c,(e=>e.length))-1)),function(t){const n=function(e,t){let n;if(void 0===t)for(const t of e)null!=t&&(n>t||void 0===n&&t>=t)&&(n=t);else{let i=-1;for(let r of e)null!=(r=t(r,++i))&&(n>r||void 0===n&&r>=r)&&(n=r)}return n}(t,(t=>(a-r-(t.length-1)*e)/$s(t,Zs)));for(const i of t){let t=r;for(const r of i){r.y0=t,r.y1=t+r.value*n,t=r.y1+e;for(const e of r.sourceLinks)e.width=e.value*n}t=(a-t+e)/(i.length+1);for(let e=0;e<i.length;++e){const n=i[e];n.y0+=t*(e+1),n.y1+=t*(e+1)}E(i)}}(c);for(let e=0;e<d;++e){const t=Math.pow(.99,e),n=Math.max(1-t,(e+1)/d);w(c,t,n),y(c,t,n)}}function y(e,n,i){for(let r=1,o=e.length;r<o;++r){const o=e[r];for(const e of o){let t=0,i=0;for(const{source:n,value:r}of e.targetLinks){let o=r*(e.layer-n.layer);t+=D(n,e)*o,i+=o}if(!(i>0))continue;let r=(t/i-e.y0)*n;e.y0+=r,e.y1+=r,S(e)}void 0===t&&o.sort(Gs),x(o,i)}}function w(e,n,i){for(let r=e.length-2;r>=0;--r){const o=e[r];for(const e of o){let t=0,i=0;for(const{target:n,value:r}of e.sourceLinks){let o=r*(n.layer-e.layer);t+=A(e,n)*o,i+=o}if(!(i>0))continue;let r=(t/i-e.y0)*n;e.y0+=r,e.y1+=r,S(e)}void 0===t&&o.sort(Gs),x(o,i)}}function x(t,n){const i=t.length>>1,o=t[i];k(t,o.y0-e,i-1,n),C(t,o.y1+e,i+1,n),k(t,a,t.length-1,n),C(t,r,0,n)}function C(t,n,i,r){for(;i<t.length;++i){const o=t[i],a=(n-o.y0)*r;a>1e-6&&(o.y0+=a,o.y1+=a),n=o.y1+e}}function k(t,n,i,r){for(;i>=0;--i){const o=t[i],a=(o.y1-n)*r;a>1e-6&&(o.y0-=a,o.y1-=a),n=o.y0-e}}function S({sourceLinks:e,targetLinks:t}){if(void 0===n){for(const{source:{sourceLinks:e}}of t)e.sort(Ks);for(const{target:{targetLinks:t}}of e)t.sort(Vs)}}function E(e){if(void 0===n)for(const{sourceLinks:t,targetLinks:n}of e)t.sort(Ks),n.sort(Vs)}function D(t,n){let i=t.y0-(t.sourceLinks.length-1)*e/2;for(const{target:r,width:o}of t.sourceLinks){if(r===n)break;i+=o+e}for(const{source:e,width:r}of n.targetLinks){if(e===t)break;i-=r}return i}function A(t,n){let i=n.y0-(n.targetLinks.length-1)*e/2;for(const{source:r,width:o}of n.targetLinks){if(r===t)break;i+=o+e}for(const{target:e,width:r}of t.sourceLinks){if(e===n)break;i-=r}return i}return p.update=function(e){return el(e),e},p.nodeId=function(e){return arguments.length?(c="function"==typeof e?e:qs(e),p):c},p.nodeAlign=function(e){return arguments.length?(h="function"==typeof e?e:qs(e),p):h},p.nodeSort=function(e){return arguments.length?(t=e,p):t},p.nodeWidth=function(e){return arguments.length?(s=+e,p):s},p.nodePadding=function(t){return arguments.length?(l=e=+t,p):l},p.nodes=function(e){return arguments.length?(u="function"==typeof e?e:qs(e),p):u},p.links=function(e){return arguments.length?(f="function"==typeof e?e:qs(e),p):f},p.linkSort=function(e){return arguments.length?(n=e,p):n},p.size=function(e){return arguments.length?(i=r=0,o=+e[0],a=+e[1],p):[o-i,a-r]},p.extent=function(e){return arguments.length?(i=+e[0][0],o=+e[1][0],r=+e[0][1],a=+e[1][1],p):[[i,r],[o,a]]},p.iterations=function(e){return arguments.length?(d=+e,p):d},p}().size([t.width,t.height]).nodeId((e=>e.id)).nodeWidth(20).nodePadding(o).nodeAlign(Ws)(this.sankeyData);this.graph_area.selectAll(".s-links").data(a.links).join("path").on("click",((e,t)=>{r.filterMultipleCategories(t)})).on("mouseover mousemove",((e,t)=>{const n=t.source,i=r.dataStore.getColumnValues(r.config.param[n.param])[n.ind],o=t.target,a=r.dataStore.getColumnValues(r.config.param[o.param])[o.ind];r.showToolTip(e,`${i}<br>${a}<br>${t.trueValue}`)})).on("mouseleave",(()=>{r.hideToolTip()})).transition(e).attr("class","s-links").attr("d",_l()).attr("fill","none").attr("stroke","currentColor").attr("stroke-width",(e=>e.width)).attr("stoke-opacity",.5).attr("opacity",(e=>r.linkFilter?e.source.id===r.linkFilter[0]&&e.target.id===r.linkFilter[1]?.8:.2:r.nodeFilter?e.source.id===r.nodeFilter||e.target.id===r.nodeFilter?.8:.2:.5)),this.graph_area.selectAll(".s-nodes").data(a.nodes).join("rect").on("click",((e,t)=>{const i=n[t.param];r.nodeFilter=(0===t.param?"A":"B")+t.ind,r.linkFilter=null;const o=r.dataStore.getColumnValues(i);r.filterCategories(i,o[t.ind])})).on("mouseover mousemove",((e,t)=>{const n=r.dataStore.getColumnValues(r.config.param[t.param])[t.ind];r.showToolTip(e,n)})).on("mouseleave",(()=>{r.hideToolTip()})).attr("class","s-nodes").attr("x",(e=>e.x0)).attr("y",(e=>e.y0)).attr("width",(e=>e.x1-e.x0)).attr("height",(e=>e.y1-e.y0)).attr("fill",(e=>i[e.param][e.ind]))}getFilter(){const e=this.config.param;if(this.linkFilter){const t={};let n=parseInt(this.linkFilter[0].substring(1));return t[e[0]]=[this.dataStore.getColumnValues(e[0])[n]],n=parseInt(this.linkFilter[1].substring(1)),t[e[1]]=[this.dataStore.getColumnValues(e[1])[n]],t}if(this.nodeFilter){const t={},n=this.nodeFilter.startsWith("A")?0:1;let i=parseInt(this.nodeFilter.substring(1));return t[e[n]]=[this.dataStore.getColumnValues(e[n])[i]],t}return null}filterMultipleCategories(e){const t=this.config.param,n=t[e.source.param],i=this.dataStore.getColumnValues(n)[e.source.ind],r=t[e.target.param],o=this.dataStore.getColumnValues(r)[e.target.ind];this.linkFilter=["A"+e.source.ind,"B"+e.target.ind],this.resetButton.style.display="inline",this.drawChart(),this.dim.filter("filterMultipleCategories",[n,r],[i,o])}filterCategories(e,t,n){n?this.filter.push(t):this.filter=[t],this.resetButton.style.display="inline",this.drawChart(),this.dim.filter("filterCategories",[e],this.filter)}pinChart(){this.isPinned=!0}unpinChart(){this.isPinned=!1,this.onDataFiltered()}getSettings(){const e=super.getSettings();return this.config,e}},params:[{type:"text",name:"First Group"},{type:"text",name:"Second Group"}]};I.types.multi_line_chart={class:class extends Mt{constructor(e,t,n){const i=e.getColumnName(n.param[0]);n.axis||(n.axis={x:{size:30,label:i,textsize:13},y:{size:45,label:"density",textsize:13}}),n.title||(n.title=i),n.scaletrim&&!n.band_width&&(n.band_width=.1),super(e,t,n,{x:{},y:{type:n.stacked?"band":"linear"}}),this.config.type="multi_line_chart";const r=this.config;r.color_legend||(r.color_legend={display:!r.stacked});let o=this.dataStore.getMinMaxForColumn(r.param[0]),a=o.slice(0);n.scaletrim&&(a=[0,1]),this.x_scale.domain(a),this.defaultBandWidth=(o[1]-o[0])/100,r.band_width=r.band_width||this.defaultBandWidth,r.intervals=r.intervals||40,this.dim=this.dataStore.getDimension("catrange_dimension"),this.data=[],this.addToolTip(),this.setColorLegend(),this.stackLines(r.stacked),this.scaleTrim(r.scaletrim),this.onDataFiltered()}stackLines(e){this.config.stacked=e,e?(this.y_scale=G(),this.y_axis_call=(0,kt.y4)(this.y_scale),this.config.color_legend.display=!1,this.setColorLegend(),this.y_scale.domain(this.dataStore.getColumnValues(this.config.param[1]))):(this.y_scale=(0,Z.Z)(),this.y_axis_call=(0,kt.y4)(this.y_scale),this.y_scale.domain([1,0]))}changeCategories(e,t,n){this.config.param[1]=e,this.onDataFiltered()}scaleTrim(e){const t=this.config;if(e&&"none"!==e)t.scaletrim=e+"",this.x_scale.domain([0,1]),t.band_width=.1;else{delete t.scaletrim;const e=this.dataStore.getMinMaxForColumn(t.param[0]);this.x_scale.domain(e)}}getColorLegend(){return this.dataStore.getColorLegend(this.config.param[1])}onDataFiltered(e){if(!this.isPinned&&e!==this.dim){"all_removed"===e&&(this.resetButton.style.display="none");const t=this.config;this.ticks=this.x_scale.ticks(t.intervals),this.dim.getKernalDensity((e=>{this.data=e,this.drawChart()}),[t.param[1],t.param[0]],{ticks:this.ticks,bandwidth:t.band_width,intervals:t.intervals,scaletrim:t.scaletrim})}}remove(e=!0){this.dim.destroy(e),super.remove()}drawChart(){const e=this.config,t=this.dataStore.getColumnValues(e.param[1]),n=(0,O.Z)(this.contentDiv).transition().duration(400).ease(Ct),i=this._getContentDimensions(),r=[],o=i.height/this.data.length,a=[];for(let n=0;n<this.data.length;n++){const s=e.stacked?o/this.data[n].max:i.height/this.data[n].max,l=e.stacked?this.data[n].map((e=>o*n+o-e*s)):this.data[n].map((e=>i.height-e*s));l.id=this.data[n].id,a.push(t[l.id]),r.push(l)}this.y_scale.domain(a),this.updateAxis();const s=this.ticks.map((e=>this.x_scale(e))),l=this,c=this.dataStore.getColumnColors(this.config.param[1]);this.graph_area.selectAll(".chart-line").data(r).join("path").attr("class","chart-line").on("mouseover mousemove",((e,n)=>{const i=t[n.id];l.showToolTip(e,i)})).on("mouseout",(()=>{l.hideToolTip()})).transition(n).attr("fill","none").attr("stroke",((e,t)=>c[e.id])).attr("stroke-width",2).attr("stroke-linejoin","round").attr("d",Os().x(((e,t)=>s[t])).y(((e,t)=>e))),e.fill?(vl().x((function(e,t){return s[t]})).y0((function(e,t){return e})).y1(((t,n)=>{e.stacked?t.id:i.height})),this.graph_area.selectAll(".chart-area").data(r).join("path").attr("class","chart-area").transition(n).attr("fill",(e=>c[e.id])).style("opacity",.5).attr("d",(function(t,n){return vl().x((function(e,t){return s[t]})).y0((function(e){return e})).y1((t=>e.stacked?o*n+o:i.height))(t)}))):this.graph_area.selectAll(".chart-area").remove()}unpinChart(){super.unpinChart(),this.onDataFiltered()}setSize(e,t){super.setSize(e,t),this.drawChart()}getSettings(){const e=super.getSettings(),t=this.config,n=this.dataStore.getMinMaxForColumn(t.param[0]),i=this.dataStore.getColumnList("text");return e.splice(1,0,{type:"dropdown",current_value:t.param[1],label:"Change Cetegories (y axis)",values:[i,"name","field"],func:e=>{this.changeCategories(e,"val1","val2")}},{type:"check",current_value:t.stacked,label:"Stack Lines",func:e=>{this.stackLines(e),this.drawChart()}},{type:"check",current_value:t.fill,label:"Fill Lines",func:e=>{t.fill=e,this.drawChart()}},{type:"radiobuttons",label:"Scale/Trim to Percentile",current_value:t.scaletrim||"none",choices:[["No Trim","none"],["0.001","0.001"],["0.01","0.01"],["0.05","0.05"]],func:e=>{this.scaleTrim(e),this.onDataFiltered()}},{type:"slider",max:n[1]/10,min:n[0]<0?0:n[0],doc:this.__doc__,current_value:t.band_width,label:"Band Width",func:e=>{t.band_width=e,this.onDataFiltered()}},{type:"slider",max:100,min:10,step:1,doc:this.__doc__,current_value:t.intervals,label:"Intervals",func:e=>{t.intervals=e,this.onDataFiltered()}},{label:"Show Color Legend",type:"check",current_value:!t.color_legend||t.color_legend.display,func:e=>{t.color_legend.display=e,this.setColorLegend()}}),e}},name:"Multi Line Chart",methodsUsingColumns:["changeCategories"],params:[{type:"number",name:"Value (X axis)"},{type:"text",name:"Categories to show"}]};var bl={},yl={};function wl(e){return new Function("d","return {"+e.map((function(e,t){return JSON.stringify(e)+": d["+t+'] || ""'})).join(",")+"}")}function xl(e){var t=Object.create(null),n=[];return e.forEach((function(e){for(var i in e)i in t||n.push(t[i]=i)})),n}function Cl(e,t){var n=e+"",i=n.length;return i<t?new Array(t-i+1).join(0)+n:n}function kl(e){var t=new RegExp('["'+e+"\n\r]"),n=e.charCodeAt(0);function i(e,t){var i,r=[],o=e.length,a=0,s=0,l=o<=0,c=!1;function h(){if(l)return yl;if(c)return c=!1,bl;var t,i,r=a;if(34===e.charCodeAt(r)){for(;a++<o&&34!==e.charCodeAt(a)||34===e.charCodeAt(++a););return(t=a)>=o?l=!0:10===(i=e.charCodeAt(a++))?c=!0:13===i&&(c=!0,10===e.charCodeAt(a)&&++a),e.slice(r+1,t-1).replace(/""/g,'"')}for(;a<o;){if(10===(i=e.charCodeAt(t=a++)))c=!0;else if(13===i)c=!0,10===e.charCodeAt(a)&&++a;else if(i!==n)continue;return e.slice(r,t)}return l=!0,e.slice(r,o)}for(10===e.charCodeAt(o-1)&&--o,13===e.charCodeAt(o-1)&&--o;(i=h())!==yl;){for(var u=[];i!==bl&&i!==yl;)u.push(i),i=h();t&&null==(u=t(u,s++))||r.push(u)}return r}function r(t,n){return t.map((function(t){return n.map((function(e){return a(t[e])})).join(e)}))}function o(t){return t.map(a).join(e)}function a(e){return null==e?"":e instanceof Date?(r=(n=e).getUTCHours(),o=n.getUTCMinutes(),a=n.getUTCSeconds(),s=n.getUTCMilliseconds(),isNaN(n)?"Invalid Date":((i=n.getUTCFullYear())<0?"-"+Cl(-i,6):i>9999?"+"+Cl(i,6):Cl(i,4))+"-"+Cl(n.getUTCMonth()+1,2)+"-"+Cl(n.getUTCDate(),2)+(s?"T"+Cl(r,2)+":"+Cl(o,2)+":"+Cl(a,2)+"."+Cl(s,3)+"Z":a?"T"+Cl(r,2)+":"+Cl(o,2)+":"+Cl(a,2)+"Z":o||r?"T"+Cl(r,2)+":"+Cl(o,2)+"Z":"")):t.test(e+="")?'"'+e.replace(/"/g,'""')+'"':e;var n,i,r,o,a,s}return{parse:function(e,t){var n,r,o=i(e,(function(e,i){if(n)return n(e,i-1);r=e,n=t?function(e,t){var n=wl(e);return function(i,r){return t(n(i),r,e)}}(e,t):wl(e)}));return o.columns=r||[],o},parseRows:i,format:function(t,n){return null==n&&(n=xl(t)),[n.map(a).join(e)].concat(r(t,n)).join("\n")},formatBody:function(e,t){return null==t&&(t=xl(e)),r(e,t).join("\n")},formatRows:function(e){return e.map(o).join("\n")},formatRow:o,formatValue:a}}var Sl=kl(","),El=Sl.parse,Dl=(Sl.parseRows,Sl.format,Sl.formatBody,Sl.formatRows,Sl.formatRow,Sl.formatValue,kl("\t")),Al=Dl.parse;function Ml(e){if(!e.ok)throw new Error(e.status+" "+e.statusText);return e.text()}function Rl(e,t){return fetch(e,t).then(Ml)}function Ll(e){return function(t,n,i){return 2===arguments.length&&"function"==typeof n&&(i=n,n=void 0),Rl(t,n).then((function(t){return e(t,i)}))}}Dl.parseRows,Dl.format,Dl.formatBody,Dl.formatRows,Dl.formatRow,Dl.formatValue;var Tl=Ll(El),Pl=Ll(Al);function zl(e){if(!e.ok)throw new Error(e.status+" "+e.statusText);if(204!==e.status&&205!==e.status)return e.json()}function Il(e,t){return fetch(e,t).then(zl)}const Ol=class extends M{constructor(e,t,n,i){super({title:`Add ${n.name}`,footer:!0,columns:2,width:380},{ds:e,ds_to:t,link:n,cm:i})}init(e){this.ds=e.ds,this.ds_to=e.ds_to,this.link=e.link,this.cm=e.cm,this.cm._getColumnsThen(this.ds_to.name,[this.link.name_column],(()=>{const e=(0,A.ut)("div",{classes:["mdv-section"]},this.columns[0]),t=(0,A.ut)("input",{},e);this.ac=new class{constructor(e,t,n={}){this.__doc__=n.doc||document,this.input=e,this.listeners=[],n.minLength=n.minLength||2,this.input.addEventListener("input",(e=>{this.input.value.length<n.minLength||(this.text=this.input.value,t(this.text).then((e=>{this.list=e,this.createDropDown()})))})),this.dli=e=>{e.target.parentElement!==this.listHolder&&this.listHolder&&(this.listHolder.remove(),this.listHolder=null)},this.__doc__.addEventListener("mousedown",this.dli)}getSelectedItem(){return this.selectedItem}addListener(e){this.listeners.push(e)}destroy(){this.listholder&&this.listholder.remove(),this.__doc__.removeEventListener("click",this.dli)}setSelectedItem(e,t=!0){this.selectedItem=e,this.input.value=e.value,t&&this.listeners.map((t=>t("item_chose",e)))}addItemEventListener(e,t){e.addEventListener("click",(e=>{this.listHolder.remove(),this.listHolder=null,this.setSelectedItem(t)}))}createDropDown(){if(this.listHolder&&this.listHolder.remove(),!this.text)return;const e=(0,A.qT)(this.input);this.listHolder=(0,A.ut)("div",{classes:["autocomplete-items"],styles:{top:e.top+e.height+"px",left:e.left+"px",width:e.width+"px",zIndex:1200}},this.__doc__.body);for(let e=0;e<this.list.length;e++){const t=this.list[e].value;let n=(0,A.ut)("div",{text:t},this.listHolder);this.addItemEventListener(n,this.list[e])}}}(t,(async e=>this.ds_to.dataStore.getSuggestedValues(e,this.link.name_column,8))),this.ac.addListener(((e,t)=>this.addColumn(t))),this.rn=(0,E.zO)();for(let e in this.link.subgroups)(0,A.ut)("label",{text:this.link.subgroups[e].label},this.footer),(0,A.ut)("input",{type:"radio",name:this.rn,value:e,checked:!0},this.footer);this._addOptionsSection(),(0,A.ut)("button",{classes:["ciview-button-sm"],styles:[],text:"Apply"},this.columns[0]).addEventListener("click",(()=>{this.addColumn(this.ac.getSelectedItem())})),this.ta=(0,A.ut)("textarea",{rows:10},this.columns[1]),this.errorDiv=(0,A.ut)("div",{classes:["mdv-section"]},this.columns[1]);let n=(0,A.ut)("div",{classes:["mdv-section"]},this.columns[1]);this.addHeatMapCheck=(0,A.ut)("input",{type:"checkbox"},n),(0,A.ut)("span",{text:"Create Heat Map:",styles:{marginRight:"4px"}},n),n=(0,A.ut)("div",{classes:["mdv-section"]},this.columns[1]),(0,A.ut)("span",{text:"Categories:",styles:{marginRight:"4px"}},n),this.heatMapSel=(0,A.ut)("select",{styles:{maxWidth:"150px"}},n),this.ds.dataStore.getColumnList("text").forEach((e=>(0,A.ut)("option",{value:e.field,text:e.name},this.heatMapSel))),(0,A.ut)("button",{classes:["ciview-button-sm"],text:"Add All"},this.columns[1]).addEventListener("click",(e=>{this.parseNames()})),this.cm.addListener(this.rn,((e,t,n)=>{switch(e){case"chart_added":this._addColorChartOption(n);break;case"chart_removed":this._addColorChartOption(n,!0);break;case"filtered":console.log("ss");break;case"view_laoded":this.close()}})),this.itemList=[];const i=this.ds_to.dataStore;i.addListener(this.rn,((e,t)=>{if("data_highlighted"===e){const e=t.indexes.length;if(1==e){const e=t.indexes[0],n=i.getRowText(e,this.link.name_column);this.ac.setSelectedItem({value:n,index:e})}else this.ta.value=e<200?t.indexes.map((e=>i.getRowText(e,this.link.name_column))).join("\n"):"Too many items selected"}else"filtered"===e&&(i.filterSize<500&&i.isFiltered()?this.ta.value=i.getFilteredValues(this.link.name_column).join("\n"):this.ta.value="Too many items selected")}))}))}addFilteredItems(){const e=this.ds_to.dataStore;for(let t=0;t<e.size;t++)0===e.filterArray[t]&&(this.itemList.push(t),(0,A.ut)("div",{text:e.getRowText(t,this.link.name_column)},this.columns[1]))}close(){this.cm.removeListener(this.rn),this.ds_to.dataStore.removeListener(this.rn),this.ac.destroy(),super.close()}_addColorChartOption(e,t=!1){const n=e.config;if(e.dataStore===this.ds.dataStore&&e.getColorOptions().colorby){if(t){const e=this.colorChartSelect.querySelector(`[value='${n.id}']`);return e&&e.remove(),void(0===this.colorChartSelect.children.length&&this.colorDiv.classList.add("mdv-disabled"))}(0,A.ut)("option",{value:n.id,text:n.title},this.colorChartSelect),this.colorDiv.classList.remove("mdv-disabled")}}_addOptionsSection(){this.colorDiv=(0,A.ut)("div",{classes:["mdv-section","mdv-disabled"]},this.columns[0]),this.colorCheck=(0,A.ut)("input",{type:"checkbox"},this.colorDiv),(0,A.ut)("span",{text:"Color Chart:",styles:{marginRight:"4px"}},this.colorDiv),(0,A.ut)("br",{},this.colorDiv),this.colorChartSelect=(0,A.ut)("select",{styles:{maxWidth:"150px"}},this.colorDiv);for(let e in this.cm.charts)this._addColorChartOption(this.cm.charts[e].chart);const e=(0,A.ut)("div",{classes:["mdv-section"]},this.columns[0]);this.histoCheck=(0,A.ut)("input",{type:"checkbox"},e),(0,A.ut)("span",{text:"Create Histogram:",styles:{marginRight:"4px"}},e)}parseNames(){let e=this.ta.value.replaceAll('"',"").split(/[,\s]+/);e=e.filter((e=>""!==e));const t=this.ds_to.dataStore.getColumnIndex(this.link.name_column);let n=!1;const i=new Array(e.length);for(let r=0;r<e.length;r++){const o=t[e[r]];void 0!==o?i[r]={value:e[r],index:o}:(n=!0,e[r]=e[r]+"??")}n?(this.errorDiv.textContent="Some Entries were unrecognised",this.ta.value="",this.ta.value=e.join("\n")):(this.errorDiv.textContent="",this.addColumn(i))}addColumn(e){const t=document.querySelector(`input[name='${this.rn}']:checked`).value,n=Array.isArray(e),i=n?e:[e],r=[];for(let e of i){const i=`${t}|${e.value}(${t})|${e.index}`;if(this.ds.dataStore.addColumnFromField(i),r.push(i),!n){if(this.colorCheck.checked){const e=this.colorChartSelect.value;e&&this.cm.getChart(e).colorByColumn(i)}return void(this.histoCheck.checked&&this.cm.addChart(this.ds.name,{type:"bar_chart",param:i}))}}this.addHeatMapCheck.checked&&this.cm.addChart(this.ds.name,{type:"heat_map",param:[this.heatMapSel.value].concat(r)})}},Fl=class extends M{constructor(e,t){super({footer:!0,width:500,maxHeight:500,title:"Field Colors For "+t.name,columns:2,buttons:[{text:"Apply",method:"applyColor"}]},{cm:e,ds:t})}init(e){this.cm=e.cm,this.ds=e.ds;const t=this.columns[1];this.columns[0].style.overflowY="auto";const n={whiteSpace:"nowrap",padding:"2px"},i=((0,A.ut)("div",{styles:n},t),(0,A.ut)("div",{styles:n},t));(0,A.ut)("label",{text:"Field:",styles:{width:"70px",display:"inline-block"}},i),this.columnSelect=(0,A.ut)("select",{classes:["mdv-select"],styles:{maxWidth:"150px"}},i);const r=(0,A.ut)("div",{styles:n},t);(0,A.ut)("div",{text:"Color Scheme",styles:{fontWeight:"bold"}},r),(0,A.ut)("span",{classes:["mdv-info-text"],text:"Paste list of colors (hex)"},r);const o=(0,A.ut)("div",{styles:{display:"flex",alignItems:"flex-start",marginTop:"2px"}},t);this.colorList=(0,A.ut)("textarea",{classes:["mdv-select"],styles:{width:"100px",padding:"2px",height:"150px"}},o),this.setDataSource(this.ds.dataStore.name),(0,A.ut)("button",{classes:["ciview-button-sm"],text:"Use Scheme"},o).addEventListener("click",(()=>{this.parseColors(this.colorList.value)}))}parseColors(e){const t=/^#[0-9A-F]{6}$/i;let n=e.replaceAll('"',"").split(/[,\s]+/);n=n.filter((e=>e.match(t)));const i=n.join("\n");this.colorList.value=i;let r=0;if(i.length>0)for(let e=0;e<this.colorChoosers.length;e++)this.colorChoosers[e].value=n[r],r++,r===n.length&&(r=0)}setDataSource(e){this.columnSelect.innerHTML="";const t=this.cm.getDataSource(e);this.dataSource=t,this.dsName=e;const n=t.getColumnList("text");for(let e of n)(0,A.ut)("option",{text:e.name,value:e.field},this.columnSelect);this.columnSelect.addEventListener("change",(()=>{this.setColumn(this.columnSelect.value)})),this.setColumn(n[0].field)}applyColor(){const e=new Array(this.colorChoosers.length);this.colorChoosers.forEach((t=>e[t.__index]=t.value)),this.dataSource.setColumnColors(this.column,e),this.dataSource.dataChanged([this.column],!1,!1);for(let t of this.cm.dataSources){const n=t.dataStore,i=n.syncColumnColors.find((e=>e.dataSource===this.dataSource.name));if(i){const e=i.columns.find((e=>e.link_to===this.column));e&&(this.cm._sync_colors([e],this.dataSource,n),n.dataChanged([e.col],!1,!1))}const r=n.linkColumns.find((e=>e.dataSource===this.dataSource.name));r&&-1!==r.columns.indexOf(this.column)&&(n.setColumnColors(this.column,e),n.dataChanged([this.column],!1,!1))}}setColumn(e){const t=this.columns[0];this.column=e,t.innerHTML="";const n=this.dataSource.getColumnValues(e),i=n.slice(0).sort(),r=this.dataSource.getColumnColors(e),o=r.map(((e,t)=>{const o=n.indexOf(i[t]);return{index:o,color:r[o]}}));this.colorChoosers=[];for(let e=0;e<i.length;e++){const n=(0,A.ut)("div",{styles:{display:"flex",flexWrap:"nowrap"}},t);(0,A.ut)("span",{styles:{display:"inline-block",fontSize:"0.8erm"},classes:["mdv-flex-dynamic"],text:i[e]},n);const r=(0,A.ut)("input",{classes:["mdv-flex-fixed"],styles:{width:"25px",height:"20px",padding:"0px"},type:"color",value:o[e].color},n);r.__index=o[e].index,this.colorChoosers.push(r)}}};var Bl=__webpack_require__(9863),Nl={};Nl.styleTagTransform=u(),Nl.setAttributes=s(),Nl.insert=o().bind(null,"head"),Nl.domAPI=i(),Nl.insertStyleElement=c(),t()(Bl.Z,Nl),Bl.Z&&Bl.Z.locals&&Bl.Z.locals;var Hl=__webpack_require__(5929);class Ul{cellHeight=150;cellApproxWidth=300;grids;dragHandle=".ciview-chart-title";chartManager;constructor(e){this.grids=new Map,this.chartManager=e}getGrid(e){if(!this.grids.has(e)){const t=e.contentDiv;t.classList.add("grid-stack");const n=t.getBoundingClientRect(),i=Math.round(n.width/this.cellApproxWidth);console.log(i);const r=Math.round(n.height/this.cellHeight);this.cellHeight=n.height/r,console.log("gridstack cellHeight",this.cellHeight);const o=Hl.GridStack.init({cellHeight:this.cellHeight,handle:this.dragHandle,float:!0,oneColumnSize:400},t);o.on("resizestop",((e,t)=>{t instanceof HTMLElement&&(t.style.filter="")})),o.on("resizestart",((e,t)=>{t instanceof HTMLElement&&(t.style.filter="blur(1px) opacity(0.5)")}));const a=this.chartManager.addMenuIcon(e.name,"fas fa-compress-arrows-alt","compact layout",(()=>o.compact()));this.grids.set(e,{grid:o,charts:new Set,icon:a})}return this.grids.get(e)}destroy(e){this.grids.has(e)||console.error(`destroying non-existent gridstack - ${e.name}`);const t=this.grids.get(e),n=e.contentDiv,i=new Map;for(let e of t.charts){const t=e.getDiv();i.set(t,[t.offsetWidth,t.offsetHeight,t.offsetLeft,t.offsetTop]),e.removeLayout(),delete e.config.gssize,delete e.config.gsposition}t.grid.destroy(!1);for(let e of t.charts){const t=e.getDiv(),n=i.get(t);t.style.position="absolute",t.style.width=n[0]-5+"px",t.style.height=n[1]-5+"px",t.style.left=n[2]+"px",t.style.top=n[3]+"px",e.config.size=[n[0]-5,n[1]-5],e.config.position=[n[2],n[3]],t.classList.remove("grid-stack-item")}n.classList.remove("grid-stack"),t.icon.remove(),this.grids.delete(e)}getCellDimensions(e){return[this.getGrid(e).grid.cellWidth(),this.cellHeight]}manageChart(e,t,n){const i=this.getGrid(t),r=i.grid;i.charts.add(e);const o=e.getDiv(),a=o.getBoundingClientRect();let s=Math.round(a.width/r.cellWidth()),l=Math.round(a.height/this.cellHeight),c=Math.round(o.offsetLeft/r.cellWidth());c=c>11?11:c;let h=Math.floor(o.offsetTop/this.cellHeight);e.config.gsposition&&([c,h]=e.config.gsposition,[s,l]=e.config.gssize,n=!1),function(e){e.style.position="",e.style.left="",e.style.right="",e.style.top="",e.style.bottom="",e.style.width="",e.style.height=""}(o),o.style.transition="filter 0.5s ease";const u=new ResizeObserver((0,E.Ds)((()=>{try{e.setSize()}catch{}}),20));u.observe(o),r.makeWidget(o),n?r.update(o,{w:s,h:l}):(console.log({w:s,h:l,x:c,y:h}),r.update(o,{w:s,h:l,x:c,y:h}));const f=function(){const{changeBaseDocument:t}=e;return o.gridstackPopoutCallback=()=>{r.removeWidget(o,!0)},e.changeBaseDocument=n=>{t.apply(e,[n]),n===document&&console.error("changeBaseDocument should be restored to normal by the time we get here..."),r.removeWidget(o,!0),d.remove(),e.remove=p,e.changeBaseDocument=f},t}(),d=function(){let t=!1;const n=e.addMenuIcon("fas fa-unlock","lock position"),i=n.children[0];return n.addEventListener("click",(()=>{t=!t,i.classList.toggle("fa-lock",t),i.classList.toggle("fa-unlock",!t),r.update(o,{locked:t}),o.classList.toggle("gridLock",t)})),n}(),p=function(){const{remove:t}=e;return e.remove=()=>{r.removeWidget(o,!0),i.charts.delete(e),t.apply(e)},t}();e.removeLayout=()=>{r.removeWidget(o,!1),d.remove(),delete o.gridstackPopoutCallback,e.remove=p,e.changeBaseDocument=f,u.disconnect()}}}const $l={double:0,integer:0,int32:0,multitext:1,text:2,unique:2},jl={Dark:{title_bar_color:"#222",main_panel_color:"black",text_color:"white",background_color:"#333"},Light:{title_bar_color:"white",main_panel_color:"#f1f1f1",text_color:"black",background_color:"#bababa"}};function Wl(){return window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"Dark":"Light"}class ql extends M{constructor(e,t,n="all"){super({footer:!0,width:250,maxHeight:500,title:"Select Columns",buttons:[{text:"OK",method:"getColumns"}]},{dataStore:e,callback:t,filter:n})}init(e){this.ds=e.dataStore;const t=(0,A.ut)("div",{styles:{padding:"8px"}}),n=(0,E.zO)();(0,A.ut)("div",{text:"Groups"},this.dialog);const i=Object.keys(this.ds.columnGroups);i.unshift("All");for(let e of i){const i=(0,A.ut)("span",{styles:{display:"inline-block",whiteSpace:"nowrap",marginRight:"5px"}},t);(0,A.ut)("span",{text:e},i),(0,A.ut)("input",{type:"radio",value:e,name:n},i).addEventListener("click",(e=>{this.checkAllInGroup(e.target.value)}))}this.dialog.append(t),(0,A.ut)("div",{text:"Select Individual Columns"},this.dialog);const r=(0,A.ut)("div",{style:{padding:"8px"}}),o=this.ds.getColumnList(e.filter);this.checks=[],this.callback=e.callback;for(let e of o){const t=(0,A.ut)("div",{styles:{whiteSpace:"nowrap"}},r),n=(0,A.ut)("input",{type:"checkbox"},t);this.checks.push([n,e.field]),(0,A.ut)("span",{text:e.name},t)}this.dialog.append(r)}checkAllInGroup(e){if("All"===e)for(let e of this.checks)e[0].checked=!0;else{const t=this.ds.columnGroups[e].columns;for(let e of this.checks)e[0].checked=-1!==t.indexOf(e[1])}}getColumns(){const e=[];for(let t of this.checks)t[0].checked&&e.push(t[1]);this.callback(e),this.close()}}class Vl extends M{constructor(e,t){super({title:"Add Chart",columns:2,footer:!0,width:380},{dataSource:e,callback:t})}init(e){this.extraControls={};const t=[];this.dataSource=e.dataSource,this.dataStore=e.dataSource.dataStore;for(let e in I.types){const n=I.types[e];let i=!0;if(n.required){for(let e of n.required)this.dataStore[e]||(i=!1);if(!i)continue}!1!==n.allow_user_add&&t.push({name:n.name,type:e})}t.sort(((e,t)=>e.name.localeCompare(t.name))),this.defaultType=t[0].type,(0,A.ut)("div",{text:"Chart Type",classes:["ciview-title-div"]},this.columns[0]),this.chartType=(0,A.ut)("select",{styles:{maxWidth:"200px"}});for(let e of t)(0,A.ut)("option",{text:e.name,value:e.type},this.chartType);(0,A.ut)("div",{},this.columns[0]).append(this.chartType),this.chartType.addEventListener("change",(t=>{this.setParamDiv(this.chartType.value,e.dataStore)})),(0,A.ut)("div",{text:"Title",classes:["ciview-title-div"]},this.columns[0]),this.chartName=(0,A.ut)("input",{styles:{width:"150px"}},this.columns[0]),(0,A.ut)("div",{text:"Description",classes:["ciview-title-div"]},this.columns[0]),this.chartDescription=(0,A.ut)("textarea",{styles:{width:"150px",height:"100px"}},this.columns[0]),(0,A.ut)("div",{text:"Columns",classes:["ciview-title-div"]},this.columns[1]),this.paramDiv=(0,A.ut)("div",{},this.columns[1]),this.setParamDiv(t[0].type,e.dataStore),(0,A.ut)("button",{text:"Add",classes:["ciview-button"]},this.footer).addEventListener("click",(()=>this.submit(e.callback)))}submit(e){const t={title:this.chartName.value,legend:this.chartDescription.value,type:this.chartType.value,param:this.paramSelects.map((e=>e.value))},n={};for(let e in this.extraControls)n[e]=this.extraControls[e].value;this.multiColumns&&(t.param=t.param.concat(this.multiColumns)),console.log("config from add chart dialog",t);const i=I.types[this.chartType.value];i.init&&i.init(t,this.dataSource.dataStore,n),e(t),this.chartName.value="",this.chartDescription.value="",this.close()}_addMultiColumnSelect(e,t){const n=this.dataStore.getColumnList(t);let i="";n.length>1&&(i=`${n[0].name},... (1)`,this.multiColumns=[n[0].field]);const r=(0,A.ut)("span",{text:i},e);(0,A.ut)("i",{classes:["fas","fa-plus"]},e),e.style.cursor="pointer",e.addEventListener("click",(()=>{new ql(this.dataStore,(e=>{this.multiColumns=e;let t="";if(e.length>0){const n=e.length<3?e.length:3,i=[];for(let t=0;t<n;t++)i.push(this.dataStore.getColumnName(e[t]));t=i.join(","),e.length>3&&(t+=",...."),t+=`(${e.length})`,r.textContent=t}}),t)}))}setParamDiv(e){this.paramDiv.innerHTML="";const t=I.types[e].params;if(this.paramSelects=[],t)for(let e of t){const t=(0,A.ut)("div",{styles:{padding:"4px"}},this.paramDiv),n=((0,A.ut)("div",{text:e.name+":"},t),(0,A.ut)("div",{},this.paramDiv));if(!Array.isArray(e.type)&&e.type.startsWith("_multi"))this._addMultiColumnSelect(n,e.type.split(":")[1]);else{this.multiColumns=null;const t=(0,A.ut)("select",{styles:{maxWidth:"200px"}},n),i=this.dataStore.getColumnList(e.type),r={};for(let e of this.dataStore.subgroupDataSources)r[e]=(0,A.ut)("optgroup",{label:e});for(let e of i){let n=t;e.subgroup&&(n=r[e.subgroup.dataSource]),(0,A.ut)("option",{text:e.name,value:e.field},n)}for(let e of this.dataStore.subgroupDataSources)t.append(r[e]);this.paramSelects.push(t)}}const n=I.types[this.chartType.value];if(this.extraControls={},n.extra_controls){const e=n.extra_controls(this.dataSource.dataStore),t=this.paramDiv;for(let n of e)if((0,A.ut)("div",{text:n.label,classes:["ciview-title-div"]},t),"dropdown"===n.type){const e=(0,A.ut)("select",{styles:{maxWidth:"200px"}},t);for(let t of n.values)(0,A.ut)("option",{text:t.name,value:t.value},e);this.extraControls[n.name]=e}else if("string"===n.type){const e=(0,A.ut)("input",{value:n.defaultVal},t);this.extraControls[n.name]=e}else if("textbox"===n.type){const e=(0,A.ut)("textarea",{value:n.defaultVal,styles:{height:"300px"}},t);this.extraControls[n.name]=e}}}}function Kl(e,t,n){const i=[];let r=0;for(let o of t){let t="int32"===o.datatype?Int32Array:Float32Array,a=n,s=4;if("unique"==o.datatype||"text"==o.datatype?(t=Uint8Array,s=1,"unique"==o.datatype&&(s=o.stringLength,a=n*s)):"multitext"===o.datatype&&(t=Uint16Array,s=2*o.stringLength,a=n*o.stringLength),"sparse"==o.sgtype){const t=new Uint32Array(e,r,1)[0];r+=4;const a=new Uint32Array(e,r,t);r+=4*t;const s=new Float32Array(e,r,t);r+=4*t;const l=new SharedArrayBuffer(4*n),c=new Float32Array(l);c.fill(NaN);for(let e=0;e<a.length;e++)c[a[e]]=s[e];i.push({data:l,field:o.field})}else{const l=n*s;let c=new t(e,r,a);const h=new SharedArrayBuffer(l);new t(h).set(c,0),i.push({data:h,field:o.field}),r+=l}}return i}class Gl{constructor(e,t){this.url=e,this.index=null,this.size=t}async getColumnData(e,t){const{default:n}=await __webpack_require__.e(885).then(__webpack_require__.bind(__webpack_require__,7885));if(!this.index){const e=this.url.replace(".gz",".json"),t=await fetch(e);this.index=await t.json()}return await Promise.all(e.map((async e=>{let i=e.field;if(e.subgroup){const t=e.field.split("|");i=t[0]+t[2]}const r=this.index[i];let o=null;const a={headers:{responseType:"arraybuffer",range:`bytes=${r[0]}-${r[1]}`}};try{o=await fetch(this.url,a)}catch(e){o=await fetch(this.url,a)}const s=await o.arrayBuffer(),l=n.inflate(s);if("sparse"===e.sgtype){const n=l.buffer,i=new Uint32Array(n,0,1)[0],r=new Uint32Array(n,4,i),o=new Float32Array(n,4*i+4,i),a=new SharedArrayBuffer(4*t),s=new Float32Array(a);s.fill(NaN);for(let e=0;e<r.length;e++)s[r[e]]=o[e];return{data:a,field:e.field}}{const t=new SharedArrayBuffer(l.length);return new Uint8Array(t).set(l,0),{data:t,field:e.field}}})))}}window.ChartManager=class{constructor(e,t,n,i={},r=null){var o;this.listeners={},this.infoAlerts={},this.progressBars={},this.setTheme(Wl()),o=e=>this.setTheme(e),window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",(()=>o(Wl()))),this.dataSources=[],this.dsIndex={},this.columnsLoading={};for(const e of t){const t={name:e.name,dataStore:new Rt.ZP(e.size,e),link_to:e.link_to,index_link_to:e.index_link_to,color:e.color||jl[this.theme].background_color,column_link_to:e.column_link_to,links:e.links,custom:e.custom||{}};this.dataSources.push(t),this.dsIndex[e.name]=t,this._addDSListeners(t),this.columnsLoading[e.name]={}}if(r&&this.addListener("_default",r),this.transactions={},this.containerDiv="string"==typeof e?document.getElementById(e):e,this.containerDiv.style.display="flex",this.containerDiv.style.flexDirection="column",this.menuBar=(0,A.ut)("div",{classes:["ciview-main-menu-bar"]},this.containerDiv),this.leftMenuBar=(0,A.ut)("span",{},this.menuBar),this.rightMenuBar=(0,A.ut)("span",{styles:{float:"right"}},this.menuBar),(0,A.ut)("span",{classes:["mdv-divider"]},this.menuBar),i.all_views){this.viewSelect=(0,A.ut)("select",{},this.menuBar);for(let e of i.all_views)(0,A.ut)("option",{text:e,value:e},this.viewSelect);this.viewSelect.addEventListener("change",(e=>{this.config.show_save_view_dialog&&"edit"===i.permission?this.showSaveViewDialog((()=>this.changeView(this.viewSelect.value))):this.changeView(this.viewSelect.value)}))}"edit"===i.permission&&(0,A.Eo)("fas fa-save",{tooltip:{text:"Save View",position:"bottom-right"},func:()=>{const e=this.getState();this._callListeners("state_saved",e)}},this.menuBar),"edit"===i.permission&&i.all_views&&((0,A.Eo)("fas fa-plus",{tooltip:{text:"Create New View",position:"bottom-right"},func:()=>{this.showSaveViewDialog((()=>this.showAddViewDialog()))}},this.menuBar),(0,A.Eo)("fas fa-minus",{tooltip:{text:"Delete Current View",position:"bottom-right"},func:()=>{this.showDeleteViewDialog()}},this.menuBar));const a=(0,A.Eo)("fas fa-adjust",{tooltip:{text:"Change Theme",position:"bottom-left"},func:e=>{this.themeMenu.show(e)}},this.rightMenuBar);a.style.margin="3px",this._setupThemeContextMenu(),this.contentDiv=(0,A.ut)("div",{styles:{flex:"1 1 auto",position:"relative"}},this.containerDiv),this.contentDiv.classList.add("ciview-contentDiv"),this.gridStack=new Ul(this),this.charts={},this.config=i;const s=this.config;if(s.chart_color=s.chart_color||"white",this.dataLoader=n.function,this.viewLoader=n.viewLoader,this.layoutMenus={},n.files){this.filesToLoad=n.files.length;for(let e of n.files)this.loadFile(e,(()=>{this.filesToLoad--,0===this.filesToLoad&&this._loadView(i,n,!0)}))}else this._loadView(i,n,!0)}_setUpChangeLayoutMenu(e){this.layoutMenus[e.name]=new D((()=>{const t=this.viewData.dataSources[e.name].layout||"absolute";return[{text:"Absolute",ghosted:"absolute"===t,func:()=>this.changeLayout("absolute",e)},{text:"Grid Stack",ghosted:"gridstack"===t,func:()=>this.changeLayout("gridstack",e)}]}))}changeLayout(e,t){const n=this.viewData.dataSources[t.name],i=n.layout||"absolute";e!==i&&("gridstack"===i?this.gridStack.destroy(t):"absolute"===i&&this.getAllCharts(t.name).forEach((e=>{const t=e.getDiv();(0,A.P_)(t),(0,A.EA)(t)})),n.layout=e,"absolute"===e?this.getAllCharts(t.name).forEach((e=>this._makeChartRD(e,t))):"gridstack"===e&&this.getAllCharts(t.name).forEach((e=>{this.gridStack.manageChart(e,t,this._inInit)})))}_setupThemeContextMenu(){this.themeMenu=new D((()=>{const e=[];for(let t in jl)e.push(this.__getMenuItem(t));return e}))}__getMenuItem(e){return{text:e,ghosted:this.theme===e,func:()=>this.setTheme(e)}}setTheme(e){if(this.theme=e,document.getElementsByTagName("html")[0].className=e,this.charts)for(let e in this.charts){const t=this.charts[e];t.chart.themeChanged&&t.chart.themeChanged()}}_sync_colors(e,t,n){for(let i of e){const e=t.columnIndex[i.link_to],r=n.columnIndex[i.col],o=new Array(r.values),a=t.getColumnColors(i.link_to);for(let t=0;t<e.values.length;t++){const n=e.values[t],i=r.values.indexOf(n);-1!==i&&(o[i]=a[t])}r.colors=o}}_initiateOffsets(e){const t=e.dataStore,n=t.offsets,i=n.param,r=[i[0],i[1],n.groups];n.background_filter&&r.push(n.background_filter),this._getColumnsThen(e.name,r,(()=>{t.initiateOffsets(),t.updateColumnOffsets(),t.updateColumnOffsets(null,!0,!0)}))}_loadView(e,t,n=!1){e.all_views?(this.currentView=e.initial_view||e.all_views[0],this.viewSelect.value=this.currentView,t.viewLoader(this.currentView).then((e=>{this._init(e,n)}))):this._init(e.only_view,n)}getDataSource(e){return this.dsIndex[e].dataStore}_init(e,t=!1){if(e){if(!e.dataSources){e.dataSources={};for(let t in e.initialCharts)e.dataSources[t]={}}this.viewData=e}else{const e={};for(let t in this.dsIndex)e[t]={layout:"gridstack"};this.viewData={dataSources:e,initialCharts:{}}}for(let e of this.dataSources)delete e.contentDiv,delete e.menuBar;const n=Object.keys(this.viewData.dataSources);let i=[];for(let e of n){let t=this.viewData.dataSources[e].panelWidth;if(!t){i=null;break}i.push(t)}this.dsPanes={};const r=(0,A.Ni)(this.contentDiv,{number:n.length,sizes:i});for(let e=0;e<n.length;e++){const t=r[e];t.style.display="flex",t.style.flexDirection="column";const i=this.dsIndex[n[e]];this.dsPanes[i.name]=t,this.columnsLoading[i.name]={},i.charts=[],i.menuBar=(0,A.ut)("div",{classes:["ciview-menu-bar"]},t);const o=(0,A.ut)("div",{styles:{flex:"1 1 auto",position:"relative",overflow:"auto",height:"100px"}},t);this._setUpMenu(i),i.contentDiv=(0,A.ut)("div",{styles:{position:"relative",height:"100%"}},o),i.contentDiv.classList.add("ciview-contentDiv"),this._setUpChangeLayoutMenu(i)}if(t)for(let e of this.dataSources){const t=e.dataStore;t.offsets&&this._initiateOffsets(e),e.column_link_to&&this._sync_colors(e.column_link_to.columns,this.dsIndex[e.column_link_to.dataSource].dataStore,t);for(let e of t.syncColumnColors)this._sync_colors(e.columns,this.dsIndex[e.dataSource].dataStore,t)}const o=e.initialCharts||{};this._toLoadCharts=new Set;for(let e in o)for(let t of o[e])this._toLoadCharts.add(t);0==this._toLoadCharts.size&&(delete this._toLoadCharts,this._callListeners("view_loaded",this.currentView)),this._inInit=!0;for(let e in o)for(let t of o[e])this.addChart(e,t);this._inInit=!1}_addDSListeners(e){e.dataStore.addListener("l1",((t,n)=>{if("column_removed"===t)this._columnRemoved(e,n);else if("data_highlighted"===t)n.dataStore=e.dataStore,this._callListeners(t,n);else if("filtered"===t){if(!this.progressBars[e.name])return;e.dataStore.size;const i=e.dataStore.filterSize;this.progressBars[e.name].setValue(i),this.progressBars[e.name].setText(i),this._callListeners(t,n)}}))}showAddViewDialog(){const e=[{type:"checkbox",id:"clone-view",label:"Clone current view"},{type:"text",id:"name",label:"name"}];if(this.dataSources.length>1)for(let t of this.dataSources)e.push({type:"checkbox",id:t.name,label:`Include ${t.name}`});new ws({title:"Add New View",controls:e,buttons:[{text:"Create New View",method:e=>{if((0,A.ut)("option",{text:e.name,value:e.name},this.viewSelect),this.viewSelect.value=e.name,this.currentView=e.name,e["clone-view"]){const e=this.getState();this._callListeners("state_saved",e)}else{for(let e in this.viewData.dataSources)"gridstack"===this.viewData.dataSources[e].layout&&this.gridStack.destroy(this.dsIndex[e]);this.removeAllCharts(),this.viewData.links=[];const t=this.getState();if(t.view.initialCharts={},t.view.dataSources={},1===this.dataSources.length)t.view.initialCharts[this.dataSources[0].name]=[],t.view.dataSources[this.dataSources[0].name]={};else for(let n in this.dsIndex)e[n]&&(t.view.initialCharts[n]=[],t.view.dataSources[n]={});this._callListeners("state_saved",t),this.contentDiv.innerHTML="",this._init(t.view)}}}]})}showSaveViewDialog(e){new ws({title:"Save View",text:"Do you want to save the current view",buttons:[{text:"YES",method:()=>{const t=this.getState();this._callListeners("state_saved",t),e()}},{text:"NO",method:()=>{e()}}]})}showDeleteViewDialog(){new ws({title:"Delete View",text:"Do you want to delete the current view?",buttons:[{text:"YES",method:()=>{this.deleteCurrentView()}},{text:"NO",method:()=>{}}]})}changeView(e){for(let e in this.viewData.dataSources)"gridstack"===this.viewData.dataSources[e].layout&&this.gridStack.destroy(this.dsIndex[e]);this.removeAllCharts(),this.contentDiv.innerHTML="",this.currentView=e,this.viewLoader(e).then((e=>{this._init(e)}))}deleteCurrentView(){this.viewSelect.querySelector(`option[value='${this.viewSelect.value}']`).remove();const e=this.getState();e.view=null,this._callListeners("state_saved",e),this.currentView=this.viewSelect.value,this.changeView(this.viewSelect.value)}_columnRemoved(e,t){const n=[];for(let i in this.charts){const r=this.charts[i];if(r.dataSource===e){const e=r.chart,o=e.getDiv();e.onColumnRemoved(t)&&(o.remove(!1),n.push(i),this._removeLinks(e),this._callListeners("chart_removed",e))}}n.length>0&&e.dataStore._callListeners("filtered");for(let e of n)delete this.charts[e]}_getColumnsRequiredForChart(e,t){const n=e.param;if(!n)return;if("string"==typeof n)t.add(n);else for(let e of n)t.add(e);e.color_by&&(e.color_by.column?t.add(e.color_by.column.field):t.add(e.color_by)),e.tooltip&&e.tooltip.column&&t.add(e.tooltip.column),e.background_filter&&t.add(e.background_filter.column);const i=I.types[e.type];i.configEntriesUsingColumns&&i.configEntriesUsingColumns.forEach((n=>{let i=e[n];if(i){i=Array.isArray(i)?i:[i];for(let e of i)t.add(e)}}))}loadFile(e,t){const n={csv:Tl,json:Il,tsv:Pl},i=this.createInfoAlert("loading file",{spinner:!0});n[e.type](e.url).then((n=>{const r={},o=e.dataSource,a=this.dsIndex[o].dataStore,s=a.getAllColumns();for(let e of n.columns)a.columnIndex[e]&&(r[e]=[]);for(let e=0;e<n.length;e++){const t=n[e];e+1===0&&this.updateInfoAlert(i,`processed ${e}/${n.length} rows`);for(let e in r)r[e].push(t[e])}let l=0;for(let e in r)a.setColumnData(e,r[e]),l++,this.updateInfoAlert(i,`processed ${l}/${s.length} columns`);this.updateInfoAlert(i,"complete",{duration:2e3}),t&&t()}))}_getUpdatedColumns(e){const t=e.dirtyColumns,n={columns:[],added:[],removed:[],colors_changed:[]};for(let e in t.added){const t=i(e);n.columns.push(t),n.added.push(e)}for(let e in t.removed)n.removed.push(e);for(let e in t.data_changed)if(!n.columns[e]){const t=i(e);n.columns.push(t)}for(let i in t.colors_changed)n.colors_changed.push({column:i,colors:e.columnIndex[i].colors});return n;function i(t){const n=e.columnIndex[t],i={values:n.values,datatype:n.datatype,name:n.name,editable:!0,field:n.field},r=new Array(n.data.length);for(let e=0;e<n.data.length;e++)r[e]=n.data[e];return{metadata:i,data:r}}}getState(){const e={},t={},n={};this.contentDiv.offsetWidth;for(const i of this.dataSources){if(i.contentDiv){e[i.name]=[];let t=this.dsPanes[i.name].style.width;const n=/calc\((.+)\%.+/;this.viewData.dataSources[i.name].panelWidth=parseFloat(t.match(n)[1])}t[i.name]=this._getUpdatedColumns(i.dataStore);const r=i.dataStore;if(0!==r.dirtyMetadata.size){n[i.name]={};for(let e of r.dirtyMetadata)n[i.name][e]=r[e]}}for(let t in this.charts){const n=this.charts[t],i=n.chart,r=i.getConfig(),o=i.getDiv();"gridstack"===this.viewData.dataSources[n.dataSource.name].layout?(r.gsposition=[parseInt(o.getAttribute("gs-x")),parseInt(o.getAttribute("gs-y"))],r.gssize=[parseInt(o.getAttribute("gs-w")),parseInt(o.getAttribute("gs-h"))]):r.position=[o.offsetLeft,o.offsetTop],e[n.dataSource.name].push(r)}const i=JSON.parse(JSON.stringify(this.viewData));i.initialCharts=e;const r=this.viewSelect?Array.from(this.viewSelect.children,(e=>e.value)):null;return{view:i,currentView:this.currentView,all_views:r,updatedColumns:t,metadata:n}}setAllColumnsClean(){for(let e of this.dataSources)e.dataStore.setAllColumnsClean()}showCustomDialog(e){new ws(e)}addMenuIcon(e,t,n,i){const r="_main"===e?"bottom-right":"bottom",o="_main"===e?this.leftMenuBar:this.dsIndex[e].menuBar;return(0,A.Eo)(t,{tooltip:{text:n,position:r},func:i},o)}createInfoAlert(e,t={}){let n=(0,E.zO)();const i=Object.keys(this.infoAlerts).length;t.type=t.type||"info";const r=(0,A.ut)("div",{classes:["ciview-info-alert","ciview-alert-"+t.type],styles:{right:"10px",top:50+40*i+"px"}},this.containerDiv);let o=null;const a=(0,A.ut)("span",{text:e},r);return t.spinner&&(o=(0,A.ut)("i",{classes:["fas","fa-spinner","fa-spin","ciview-info-alert-spin"]},r)),this.infoAlerts[n]={div:r,text:a,spinner:o,type:t.type},t.duration&&this.removeInfoAlert(n,t.duration),n}updateInfoAlert(e,t,n={}){const i=this.infoAlerts[e];n.type&&i.type!==n.type&&(i.div.classList.remove("ciview-alert-"+i.type),i.div.classList.add("ciview-alert-"+n.type),i.type=n.type),i.text.textContent=t,n.duration&&this.removeInfoAlert(e,n.duration)}removeInfoAlert(e,t=2e3){const n=this.infoAlerts[e].spinner;n&&n.remove(),setTimeout((()=>{if(!this.infoAlerts[e])return;this.infoAlerts[e].div.remove(),delete this.infoAlerts[e];let t=50;for(let e in this.infoAlerts)this.infoAlerts[e].div.style.top=t+"px",t+=40}),t)}clearInfoAlerts(){for(const e in this.infoAlerts)this.infoAlerts[e].div.remove();this.infoAlerts={}}loadColumnSet(e,t,n,i=10,r=2){const o=(0,E.zO)(),a=this.config.dataloading||{};i=a.split||10,r=a.threads||2,this.transactions[o]={callback:n,columns:[],totalColumns:e.length,failedColumns:[],nextColumn:0,columnsLoaded:0,id:o};let s=[];const l=this.transactions[o];for(let n of e)this.columnsLoading[t][n]=!0,s.push(n),s.length===i&&(l.columns.push(s),s=[]);0!==s.length&&(l.columns.push(s),s=[]),l.alertID=this.createInfoAlert(`Loading Columns:0/${e.length}`,{spinner:!0});const c=Math.min(l.columns.length,r);for(let e=0;e<c;e++)this._loadColumnData(l,t)}_loadColumnData(e,t){const n=this.dsIndex[t].dataStore,i=e.columns[e.nextColumn++],r=[];for(let e of i)r.push(n.getColumnInfo(e));r.sort(((e,t)=>$l[e.datatype]-$l[t.datatype])),this.dataLoader(r,t,n.size).then((t=>{for(let e of t)n.setColumnData(e.field,e.data);e.columnsLoaded++})).catch((t=>{console.log(t),e.columnsLoaded++,e.failedColumns.push(r)})).finally((()=>{const n=e.columns.length,r=e.columnsLoaded;let o=r*i.length;for(let e of i)delete this.columnsLoading[t][e];o=o>e.totalColumns?e.totalColumns:o,this.updateInfoAlert(e.alertID,`Loading Columns:${o}/${e.totalColumns}`),r>=n&&(this.updateInfoAlert(e.alertID,`Loaded ${n} column${1===n?"":"s"}`,{duration:2e3}),e.callback(e.failedColumns),delete this.transactions[e.id]),e.nextColumn<n&&this._loadColumnData(e,t)}))}_addLinkIcon(e,t,n){(0,A.Eo)("fas fa-plus-square",{tooltip:{text:`Add ${n.name}`,position:"bottom-right"},func:()=>{new Ol(e,t,n,this)}},e.menuBar)}_setUpMenu(e){const t=e.dataStore;if((0,A.Eo)("fas fa-chart-bar",{tooltip:{text:"Add Chart",position:"bottom-right"},func:()=>{new Vl(e,(t=>this.addChart(e.name,t,!0)))}},e.menuBar),(0,A.Eo)("fas fa-sync-alt",{tooltip:{text:"Reset All Filters",position:"bottom-right"},func:()=>{t.removeAllFilters()}},e.menuBar),(0,A.Eo)("fas fa-palette",{tooltip:{text:"Change Color Scheme",position:"bottom-right"},func:()=>{try{new Fl(this,e)}catch(e){console.error("error making ColorChooser",e),this.createInfoAlert("Error making color chooser",{type:"warning",duration:2e3})}}},e.menuBar),(0,A.Eo)("fas fa-th",{tooltip:{text:"Change layout",position:"bottom-right"},func:t=>{this.layoutMenus[e.name].show(t)}},e.menuBar),t.links)for(let n in t.links){const i=t.links[n];i.rows_as_columns&&this._addLinkIcon(e,this.dsIndex[n],i.rows_as_columns)}const n=(0,A.ut)("div",{styles:{float:"right",lineHeight:"1.0"}},e.menuBar);(0,A.ut)("span",{text:e.name,styles:{verticalAlign:"top",fontSize:"16px",marginRight:"4px"}},n);const i=e.dataStore.size;e.filterBar=(0,A.ut)("progress",{value:i},e.menBar);const r=(0,A.ut)("div",{styles:{width:"100px",display:"inline-block",marginTop:"2px"}},n),o={max:i,value:i,text:`${i}`};this.progressBars[e.name]=new A.Vq(r,o)}addListener(e,t){this.listeners[e]=t}removeListener(e){delete this.listeners[e]}_callListeners(e,t){for(let n in this.listeners)this.listeners[n](e,this,t)}addChart(e,t,n=!1){const i=new Set;if(this._getColumnsRequiredForChart(t,i),t.location){const e=t.location,n=5;t.size=[90*e.width+e.width*n-n,40*e.height+e.height*n-n],t.position=[(e.x+1)*n+90*e.x,(e.y+1)*n+40*e.y]}const r=this.dsIndex[e];let o=300,a=300,s=10,l=10;if(t.size&&(o=t.size[0],a=t.size[1]),t.position&&(s=t.position[0],l=t.position[1]),"gridstack"===this.viewData.dataSources[e].layout&&t.gssize){const n=this.gridStack.getCellDimensions(this.dsIndex[e]);o=Math.round(t.gssize[0]*n[0]),a=Math.round(t.gssize[1]*n[1]),s=Math.round(t.gsposition[0]*(n[0]+5)),l=Math.floor(t.gsposition[1]*(n[1]+5))}I.types[t.type];const c=jl[this.theme],h=(0,A.ut)("div",{styles:{position:"absolute",width:o+"px",height:a+"px",left:s+"px",top:l+"px",background:c.main_panel_color,zIndex:2,display:"flex",alignItems:"center",justifyContent:"center"}},r.contentDiv);(0,A.ut)("i",{classes:["fas","fa-circle-notch","fa-spin"],styles:{fontSize:"30px",color:c.text_color}},h),(0,A.ut)("div",{styles:{position:"absolute",overflow:"hide",textAlign:"center",top:"3px",color:c.text_color,textOverflow:"ellipsis",wordBreak:"break-all",fontSize:"16px"},text:t.title},h);const u=()=>{this._addChart(e,t,h,n)},f=Array.from(i);try{this._getColumnsThen(e,f,u)}catch(e){this.clearInfoAlerts();const t=this.createInfoAlert(`Error creating chart with columns [${f.join(", ")}]: '${e}'`,{type:"warning"});console.log(e);const n=this.infoAlerts[t].div;n.onclick=()=>n.remove(),h.remove()}}_getColumnsFromOtherSource(e,t,n,i,r){this._getColumnsThen(t,n.concat(i),(()=>{const o=this.dsIndex[e].dataStore,a=this.dsIndex[t].dataStore,s=a.getColumnIndex(i),l=o.columnIndex[i],c=l.values.map((e=>s[e])),h=n.map((e=>{const t=o.columnIndex[e],n=a.columnIndex[e];n.values&&(t.values=n.values),n.minMax&&(t.minMax=n.minMax),n.quantiles&&(t.quantiles=n.quantiles);const i=new SharedArrayBuffer(o.size*("text"===t.datatype?1:4));return{col:e,data:i,arr:new("text"===t.datatype?Uint8Array:Float32Array)(i),odata:n.data}}));for(let e=0;e<o.size;e++){const t=c[l.data[e]];for(let n of h)n.arr[e]=n.odata[t]}for(let e of h)o.setColumnData(e.col,e.data);r()}))}_getColumnsThen(e,t,n){const i=this.dsIndex[e].dataStore;if(i.links)for(let r in i.links){const o=i.links[r];if(o.columns){const a=[],s=[];for(let e of t)-1===o.columns.indexOf(e)?s.push(e):i.columnIndex[e].data||a.push(e);if(a.length>0)return void this._getColumnsThen(e,[o.index],(()=>{this._getColumnsFromOtherSource(e,r,a,o.index,(()=>{this._getColumnsThen(e,s,n)}))}))}}const r=t.filter((t=>{if(this.columnsLoading[e][t])return!1;const n=i.columnIndex[t];return n?!n.data:(i.addColumnFromField(t),!0)}));0===r.length?this._haveColumnsLoaded(t,e,n):this.loadColumnSet(r,e,(()=>{this._haveColumnsLoaded(t,e,n)}))}_decorateColumnMethod(e,t,n){const i="_"+e;t[i]=t[e],t[e]=e=>{this._getColumnsThen(n,[e],(()=>t[i](e)))}}__decorateColumnMethod(e,t,n){const i="_"+e;t[i]=t[e];const r=this;t[e]=function(){if(null==arguments[0])t[i](...arguments);else{const e=Array.isArray(arguments[0])?arguments[0]:[arguments[0]];r._getColumnsThen(n,e,(()=>t[i](...arguments)))}}}_haveColumnsLoaded(e,t,n){for(let i of e)if(this.columnsLoading[t][i])return void setTimeout((()=>{this._haveColumnsLoaded(e,t,n)}),500);n()}_addChart(e,t,n,i=!1){const r=this.dsIndex[e];n.innerHTML="",n.style.display="",n.style.alignItems="",n.style.justifyContent="";const o=I.types[t.type],a=new o.class(r.dataStore,n,t);if(this.charts[a.config.id]={chart:a,dataSource:r},this._makeChartRD(a,r),a.popoutIcon=a.addMenuIcon("fas fa-external-link-alt","popout",{func:()=>{this._popOutChart(a)}}),a.addMenuIcon("fas fa-times","remove chart").addEventListener("click",(()=>{a.remove(),n.remove(),delete this.charts[a.config.id],this._removeLinks(a),this._callListeners("chart_removed",a)})),a.colorByColumn&&this._decorateColumnMethod("colorByColumn",a,e),a.setToolTipColumn&&this._decorateColumnMethod("setToolTipColumn",a,e),a.setBackgroundFilter&&this._decorateColumnMethod("setBackgroundFilter",a,e),a.changeContourParameter&&this._decorateColumnMethod("changeContourParameter",a,e),o.methodsUsingColumns)for(let t of o.methodsUsingColumns)this.__decorateColumnMethod(t,a,e);if(a.setupLinks){r.index_link_to&&this._giveChartAccess(a,this.dsIndex[r.index_link_to.dataSource].dataStore,r.index_link_to.index);for(let e of r.dataStore.accessOtherDataStore)this._giveChartAccess(a,this.dsIndex[e.dataSource].dataStore,e.index)}const s=r.column_link_to;if(s&&a.createColumnLinks){const e=(e,t)=>{this._getColumnsThen(s.dataSource,e,t)};a.createColumnLinks(this.dsIndex[s.dataSource].dataStore,s.columns,e)}if(i&&this._callListeners("chart_added",a),this._toLoadCharts&&(this._toLoadCharts.delete(t),0===this._toLoadCharts.size)){if(delete this._toLoadCharts,this.viewData.links)for(let e of this.viewData.links)this._setUpLink(e);this._callListeners("view_loaded",this.currentView)}return a}_giveChartAccess(e,t,n){e.setupLinks(t,n,((e,i)=>{e.push(n),this._getColumnsThen(t.name,e,i)}))}_setUpLink(e){if(e.id||(e.id=(0,E.zO)()),"color_by_column"===e.type){const t=this.charts[e.source_chart];t||console.error(`broken link link:${e.id}`),t.chart.addListener(e.id,((t,n)=>{if("cell_clicked"===t)for(let t of e.target_charts)this.getChart(t).colorByColumn(n.row)}))}}_removeLinks(e){const t=[],n=e.config.id,i=this.viewData.links;if(i){for(let e=0;e<i.length;e++){const r=i[e];r.source_chart===n&&t.push(e);const o=r.target_charts.indexOf(n);-1!==o&&(r.target_charts.splice(o,1),0===r.target_charts.length&&t.push(e))}for(let e of t)this.removeLink(e)}}removeLink(e){const t=this.viewData.links[e];"color_by_column"===t.type&&this.charts[t.source_chart].chart.removeListener(t.id),this.viewData.links.splice(e,1)}removeAllCharts(e){const t=[];for(let n in this.charts){const i=this.charts[n];e&&-1===e.indexOf(i.dataSource.name)||t.push([i.chart,i.window])}for(let e of t)e[1]&&e[1].close(),e[0].remove(),e[0].div.remove();this.charts={}}getAllFilters(e){const t=this.getAllCharts(e),n=[];for(let e of t){const t=e.getFilter();t&&n.push(t)}return n}getChart(e){const t=this.charts[e];return t?t.chart:null}getAllCharts(e){const t=[];for(let n in this.charts){const i=this.charts[n];i.dataSource.name===e&&t.push(i.chart)}return t}setChartsAsGrid(e=5,t=[300,300],n=10){let i=n,r=n,o=0;for(let a in this.charts){const s=this.charts[a].chart.getDiv();s.style.left=r+"px",s.style.top=i+"px",r+=t[0]+n,o++,o===e&&(o=0,r=n,i+=t[1]+n)}}addButton(e,t,n){(0,A.ut)("button",{classes:["ciview-button"],text:e,styles:{position:"fixed",bottom:"40px",right:"40px",fontSize:"18px",zIndex:100}},this.contentDiv).addEventListener("click",(()=>t()))}_popOutChart(e){const t=e.getDiv(),n=this.charts[e.config.id],i={dim:[e.config.size[0],e.config.size[1]],pos:[t.style.left,t.style.top]};t.gridstackPopoutCallback&&t.gridstackPopoutCallback(),(0,A.P_)(t),(0,A.EA)(t);const r=new xs(((n,i)=>{e.setSize(i.width,i.height),t.style.top="5px",t.style.left="5px",n.body.append(t),e.changeBaseDocument(n),n.body.style.overflow="hidden",e.popoutIcon.style.display="none"}),((r,o)=>{n.dataSource.contentDiv.append(t),e.changeBaseDocument(document),t.style.left=i.pos[0],t.style.top=i.pos[1],e.setSize(i.dim[0],i.dim[1]),this._makeChartRD(e,n.dataSource),e.popoutIcon.style.display="inline",delete n.window}),{onresize:(t,n)=>{e.setSize(n.width,n.height)},url:this.config.popouturl||"/"});n.window=r}_sendAllChartsToBack(e){for(let t in this.charts){const n=this.charts[t];e===n.dataSource&&(n.chart.div.style.zIndex="")}}_makeChartRD(e,t){if(t&&this.gridStack&&"gridstack"===this.viewData.dataSources[t.name].layout)return void this.gridStack.manageChart(e,t,this._inInit);const n=e.getDiv();(0,A.$q)(n,{handle:".ciview-chart-title",contain:"topleft",ondragstart:e=>{this._sendAllChartsToBack(t),n.style.zIndex=2}}),(0,A.n2)(n,{onResizeStart:()=>{this._sendAllChartsToBack(t),n.style.zIndex=2},onresizeend:(t,n)=>e.setSize(t,n)})}},window.scFileUploadDialog=class extends M{constructor(e){super({footer:!0,buttons:[{text:"Upload",method:"uploadfiles",id:"upload"}],title:e.title||"Upload Files"},{text:e.text||"Please press select to upload files"}),this.validate=e.validate,this.onupload=e.onupload,this.onfinished=e.onfinished,this.fileInput=(0,A.ut)("input",{type:"file",multiple:!0,filter:e.filter||"",styles:{},display:"none"},this.div),this.fileInput.addEventListener("change",(e=>{this.filesChosen(e.target.files)})),this.url=e.url}init(e){this.files=[],(0,A.ut)("div",{text:e.text,classes:["civ-dg-div"]},this.dialog);const t=(0,A.ut)("div",{classes:["civ-dg-div","ciview-center"]},this.dialog),n=(0,A.ut)("button",{classes:["ciview-button-sm"],text:"Select Files"},t);(0,A.ut)("i",{classes:["fas","fa-file-image"],styles:{marginLeft:"4px"}},n),t.addEventListener("click",(()=>{this.fileInput.click()})),this.fileDiv=(0,A.ut)("div",{classes:["civ-dg-div"]},this.dialog),this.infoDiv=(0,A.ut)("div",{classes:["civ-dg-div","ciview-center"]},this.dialog),this.progressDiv=(0,A.ut)("progress",{classes:["civ-dg-div"],styles:{width:"100%"},value:0},this.dialog),this.disableButton("upload",!0)}filesChosen(e){if(this.validate){const t=this.validate(e);e=t.files,this.infoDiv.textContent=t.msg}for(let t of e)this.addFile(t)}uploadfiles(){if(this.files.length>0){let e={};this.onupload&&(e=this.onupload(this.files));let t=new XMLHttpRequest,n=new FormData;t.responseType="json",t.open("POST",this.url,!0);for(let e in this.files)n.append("file"+e,this.files[e]);n.append("data",JSON.stringify(e)),t.onreadystatechange=()=>{if(4==t.readyState&&200==t.status){let e=null;this.onfinished&&(e=this.onfinished(t.response)),this.infoDiv.innerHTML="",e=e||"Files were successfully uploaded",this.infoDiv.textContent=e}},t.upload.onprogress=e=>{this.progressDiv.value=e.loaded,this.progressDiv.max=e.total},this.fileDiv.classList.add("ciview-disabled"),this.disableButton("upload",!0),this.infoDiv.innerHTML="",(0,A.ut)("i",{classes:["fas","fa-spinner","fa-spin","ciview-center"],styles:{fontSize:"30px"}},this.infoDiv),t.send(n)}}removeFile(e){this.files=this.files.filter((t=>t!==e)),0===this.files.length&&this.disableButton("upload",!0)}addFile(e){if(this.files.find((t=>t.name===e.name)))return;this.disableButton("upload",!1),this.files.push(e);const t=(0,A.ut)("div",{styles:{padding:"3px"}},this.fileDiv);(0,A.ut)("span",{text:e.name},t),(0,A.ut)("i",{classes:["fas","fa-trash","ciview-chart-icon"],styles:{float:"right"}},t).addEventListener("click",(()=>{t.remove(),this.removeFile(e)}))}},window.processArrayBuffer=Kl,window.getArrayBufferDataLoader=function(e){return async(t,n,i)=>{const r=await fetch(e,{method:"POST",body:JSON.stringify({columns:t,data_source:n}),headers:{"Content-Type":"application/json"}});return Kl(await r.arrayBuffer(),t,i)}},window.createEl=A.ut,window.getLocalCompressedBinaryDataLoader=function(e,t){const n={};for(let i of e)n[i.name]=new Gl(`${t}/${i.name}.gz`,i.size);return async(e,t,i)=>await n[t].getColumnData(e,i)}})()})();