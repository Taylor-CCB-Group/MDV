/*! For license information please see mdv.js.LICENSE.txt */
(()=>{var __webpack_modules__={6688:(t,e,n)=>{"use strict";n.d(e,{Z:()=>v});var i=n(4942),r=n(3630);const o=()=>{},s=t=>t;class a{constructor(t){(0,i.Z)(this,"getControllerState",void 0),(0,i.Z)(this,"props",void 0),(0,i.Z)(this,"propsInTransition",void 0),(0,i.Z)(this,"transition",void 0),(0,i.Z)(this,"onViewStateChange",void 0),(0,i.Z)(this,"onStateChange",void 0),(0,i.Z)(this,"_onTransitionUpdate",(t=>{const{time:e,settings:{interpolator:n,startProps:i,endProps:r,duration:o,easing:s}}=t,a=s(e/o),l=n.interpolateProps(i,r,a);this.propsInTransition=this.getControllerState({...this.props,...l}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})})),this.getControllerState=t.getControllerState,this.propsInTransition=null,this.transition=new r.Z(t.timeline),this.onViewStateChange=t.onViewStateChange||o,this.onStateChange=t.onStateChange||o}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(t){let e=!1;const n=this.props;if(this.props=t,!n||this._shouldIgnoreViewportChange(n,t))return!1;if(this._isTransitionEnabled(t)){let i=n;if(this.transition.inProgress){const{interruption:t,endProps:e}=this.transition.settings;i={...n,...2===t?e:this.propsInTransition||n}}this._triggerTransition(i,t),e=!0}else this.transition.cancel();return e}updateTransition(){this.transition.update()}_isTransitionEnabled(t){const{transitionDuration:e,transitionInterpolator:n}=t;return(e>0||"auto"===e)&&Boolean(n)}_isUpdateDueToCurrentTransition(t){return!(!this.transition.inProgress||!this.propsInTransition)&&this.transition.settings.interpolator.arePropsEqual(t,this.propsInTransition)}_shouldIgnoreViewportChange(t,e){return this.transition.inProgress?3===this.transition.settings.interruption||this._isUpdateDueToCurrentTransition(e):!this._isTransitionEnabled(e)||e.transitionInterpolator.arePropsEqual(t,e)}_triggerTransition(t,e){const n=this.getControllerState(t),i=this.getControllerState(e).shortestPathFrom(n),r=e.transitionInterpolator,o=r.getDuration?r.getDuration(t,e):e.transitionDuration;if(0===o)return;const a=r.initializeProps(t,i);this.propsInTransition={};const l={duration:o,easing:e.transitionEasing||s,interpolator:r,interruption:e.transitionInterruption||1,startProps:a.start,endProps:a.end,onStart:e.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(e.onTransitionInterrupt),onEnd:this._onTransitionEnd(e.onTransitionEnd)};this.transition.start(l),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(t){return e=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),null==t||t(e)}}}var l=n(9191);const c={transitionDuration:0},u=t=>1-(1-t)*(1-t),h=["wheel"],d=["panstart","panmove","panend"],f=["pinchstart","pinchmove","pinchend"],p=["tripanstart","tripanmove","tripanend"],g=["doubletap"],m=["keydown"],_={};class v{constructor(t){(0,i.Z)(this,"props",void 0),(0,i.Z)(this,"state",{}),(0,i.Z)(this,"transitionManager",void 0),(0,i.Z)(this,"eventManager",void 0),(0,i.Z)(this,"onViewStateChange",void 0),(0,i.Z)(this,"onStateChange",void 0),(0,i.Z)(this,"makeViewport",void 0),(0,i.Z)(this,"_controllerState",void 0),(0,i.Z)(this,"_events",{}),(0,i.Z)(this,"_interactionState",{isDragging:!1}),(0,i.Z)(this,"_customEvents",[]),(0,i.Z)(this,"_eventStartBlocked",null),(0,i.Z)(this,"_panMove",!1),(0,i.Z)(this,"invertPan",!1),(0,i.Z)(this,"dragMode","rotate"),(0,i.Z)(this,"inertia",0),(0,i.Z)(this,"scrollZoom",!0),(0,i.Z)(this,"dragPan",!0),(0,i.Z)(this,"dragRotate",!0),(0,i.Z)(this,"doubleClickZoom",!0),(0,i.Z)(this,"touchZoom",!0),(0,i.Z)(this,"touchRotate",!1),(0,i.Z)(this,"keyboard",!0),this.transitionManager=new a({...t,getControllerState:t=>new this.ControllerState(t),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=t.eventManager,this.onViewStateChange=t.onViewStateChange||(()=>{}),this.onStateChange=t.onStateChange||(()=>{}),this.makeViewport=t.makeViewport}set events(t){this.toggleEvents(this._customEvents,!1),this.toggleEvents(t,!0),this._customEvents=t,this.props&&this.setProps(this.props)}finalize(){for(const e in this._events){var t;this._events[e]&&(null===(t=this.eventManager)||void 0===t||t.off(e,this.handleEvent))}this.transitionManager.finalize()}handleEvent(t){this._controllerState=void 0;const e=this._eventStartBlocked;switch(t.type){case"panstart":return!e&&this._onPanStart(t);case"panmove":return this._onPan(t);case"panend":return this._onPanEnd(t);case"pinchstart":return!e&&this._onPinchStart(t);case"pinchmove":return this._onPinch(t);case"pinchend":return this._onPinchEnd(t);case"tripanstart":return!e&&this._onTriplePanStart(t);case"tripanmove":return this._onTriplePan(t);case"tripanend":return this._onTriplePanEnd(t);case"doubletap":return this._onDoubleTap(t);case"wheel":return this._onWheel(t);case"keydown":return this._onKeyDown(t);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(t){const{x:e,y:n}=this.props,{offsetCenter:i}=t;return[i.x-e,i.y-n]}isPointInBounds(t,e){const{width:n,height:i}=this.props;if(e&&e.handled)return!1;const r=t[0]>=0&&t[0]<=n&&t[1]>=0&&t[1]<=i;return r&&e&&e.stopPropagation(),r}isFunctionKeyPressed(t){const{srcEvent:e}=t;return Boolean(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(t){const e=setTimeout((()=>{this._eventStartBlocked===e&&(this._eventStartBlocked=null)}),t);this._eventStartBlocked=e}setProps(t){t.dragMode&&(this.dragMode=t.dragMode),this.props=t,"transitionInterpolator"in t||(t.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(t);const{inertia:e}=t;this.inertia=Number.isFinite(e)?e:!0===e?300:0;const{scrollZoom:n=!0,dragPan:i=!0,dragRotate:r=!0,doubleClickZoom:o=!0,touchZoom:s=!0,touchRotate:a=!1,keyboard:l=!0}=t,c=Boolean(this.onViewStateChange);this.toggleEvents(h,c&&n),this.toggleEvents(d,c&&(i||r)),this.toggleEvents(f,c&&(s||a)),this.toggleEvents(p,c&&a),this.toggleEvents(g,c&&o),this.toggleEvents(m,c&&l),this.scrollZoom=n,this.dragPan=i,this.dragRotate=r,this.doubleClickZoom=o,this.touchZoom=s,this.touchRotate=a,this.keyboard=l}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(t,e){this.eventManager&&t.forEach((t=>{this._events[t]!==e&&(this._events[t]=e,e?this.eventManager.on(t,this.handleEvent):this.eventManager.off(t,this.handleEvent))}))}updateViewport(t,e=null,n={}){const i={...t.getViewportProps(),...e},r=this.controllerState!==t;if(this.state=t.getState(),this._setInteractionState(n),r){const t=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:i,interactionState:this._interactionState,oldViewState:t})}}_onTransition(t){this.onViewStateChange({...t,interactionState:this._interactionState})}_setInteractionState(t){Object.assign(this._interactionState,t),this.onStateChange(this._interactionState)}_onPanStart(t){const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;let n=this.isFunctionKeyPressed(t)||t.rightButton||!1;(this.invertPan||"pan"===this.dragMode)&&(n=!n);const i=this.controllerState[n?"panStart":"rotateStart"]({pos:e});return this._panMove=n,this.updateViewport(i,c,{isDragging:!0}),!0}_onPan(t){return!!this.isDragging()&&(this._panMove?this._onPanMove(t):this._onPanRotate(t))}_onPanEnd(t){return!!this.isDragging()&&(this._panMove?this._onPanMoveEnd(t):this._onPanRotateEnd(t))}_onPanMove(t){if(!this.dragPan)return!1;const e=this.getCenter(t),n=this.controllerState.pan({pos:e});return this.updateViewport(n,c,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(t){const{inertia:e}=this;if(this.dragPan&&e&&t.velocity){const n=this.getCenter(t),i=[n[0]+t.velocityX*e/2,n[1]+t.velocityY*e/2],r=this.controllerState.pan({pos:i}).panEnd();this.updateViewport(r,{...this._getTransitionProps(),transitionDuration:e,transitionEasing:u},{isDragging:!1,isPanning:!0})}else{const t=this.controllerState.panEnd();this.updateViewport(t,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(t){if(!this.dragRotate)return!1;const e=this.getCenter(t),n=this.controllerState.rotate({pos:e});return this.updateViewport(n,c,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(t){const{inertia:e}=this;if(this.dragRotate&&e&&t.velocity){const n=this.getCenter(t),i=[n[0]+t.velocityX*e/2,n[1]+t.velocityY*e/2],r=this.controllerState.rotate({pos:i}).rotateEnd();this.updateViewport(r,{...this._getTransitionProps(),transitionDuration:e,transitionEasing:u},{isDragging:!1,isRotating:!0})}else{const t=this.controllerState.rotateEnd();this.updateViewport(t,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(t){if(!this.scrollZoom)return!1;t.srcEvent.preventDefault();const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const{speed:n=.01,smooth:i=!1}=!0===this.scrollZoom?{}:this.scrollZoom,{delta:r}=t;let o=2/(1+Math.exp(-Math.abs(r*n)));r<0&&0!==o&&(o=1/o);const s=this.controllerState.zoom({pos:e,scale:o});return this.updateViewport(s,{...this._getTransitionProps({around:e}),transitionDuration:i?250:1},{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(t){const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const n=this.controllerState.rotateStart({pos:e});return this.updateViewport(n,c,{isDragging:!0}),!0}_onTriplePan(t){if(!this.touchRotate)return!1;if(!this.isDragging())return!1;const e=this.getCenter(t);e[0]-=t.deltaX;const n=this.controllerState.rotate({pos:e});return this.updateViewport(n,c,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(t){if(!this.isDragging())return!1;const{inertia:e}=this;if(this.touchRotate&&e&&t.velocityY){const n=this.getCenter(t),i=[n[0],n[1]+=t.velocityY*e/2],r=this.controllerState.rotate({pos:i});this.updateViewport(r,{...this._getTransitionProps(),transitionDuration:e,transitionEasing:u},{isDragging:!1,isRotating:!0}),this.blockEvents(e)}else{const t=this.controllerState.rotateEnd();this.updateViewport(t,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(t){const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const n=this.controllerState.zoomStart({pos:e}).rotateStart({pos:e});return _._startPinchRotation=t.rotation,_._lastPinchEvent=t,this.updateViewport(n,c,{isDragging:!0}),!0}_onPinch(t){if(!this.touchZoom&&!this.touchRotate)return!1;if(!this.isDragging())return!1;let e=this.controllerState;if(this.touchZoom){const{scale:n}=t,i=this.getCenter(t);e=e.zoom({pos:i,scale:n})}if(this.touchRotate){const{rotation:n}=t;e=e.rotate({deltaAngleX:_._startPinchRotation-n})}return this.updateViewport(e,c,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),_._lastPinchEvent=t,!0}_onPinchEnd(t){if(!this.isDragging())return!1;const{inertia:e}=this,{_lastPinchEvent:n}=_;if(this.touchZoom&&e&&n&&t.scale!==n.scale){const i=this.getCenter(t);let r=this.controllerState.rotateEnd();const o=Math.log2(t.scale),s=(o-Math.log2(n.scale))/(t.deltaTime-n.deltaTime),a=Math.pow(2,o+s*e/2);r=r.zoom({pos:i,scale:a}).zoomEnd(),this.updateViewport(r,{...this._getTransitionProps({around:i}),transitionDuration:e,transitionEasing:u},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(e)}else{const t=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(t,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return _._startPinchRotation=null,_._lastPinchEvent=null,!0}_onDoubleTap(t){if(!this.doubleClickZoom)return!1;const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const n=this.isFunctionKeyPressed(t),i=this.controllerState.zoom({pos:e,scale:n?.5:2});return this.updateViewport(i,this._getTransitionProps({around:e}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(t){if(!this.keyboard)return!1;const e=this.isFunctionKeyPressed(t),{zoomSpeed:n,moveSpeed:i,rotateSpeedX:r,rotateSpeedY:o}=!0===this.keyboard?{}:this.keyboard,{controllerState:s}=this;let a;const l={};switch(t.srcEvent.code){case"Minus":a=e?s.zoomOut(n).zoomOut(n):s.zoomOut(n),l.isZooming=!0;break;case"Equal":a=e?s.zoomIn(n).zoomIn(n):s.zoomIn(n),l.isZooming=!0;break;case"ArrowLeft":e?(a=s.rotateLeft(r),l.isRotating=!0):(a=s.moveLeft(i),l.isPanning=!0);break;case"ArrowRight":e?(a=s.rotateRight(r),l.isRotating=!0):(a=s.moveRight(i),l.isPanning=!0);break;case"ArrowUp":e?(a=s.rotateUp(o),l.isRotating=!0):(a=s.moveUp(i),l.isPanning=!0);break;case"ArrowDown":e?(a=s.rotateDown(o),l.isRotating=!0):(a=s.moveDown(i),l.isPanning=!0);break;default:return!1}return this.updateViewport(a,this._getTransitionProps(),l),!0}_getTransitionProps(t){const{transition:e}=this;return e&&e.transitionInterpolator?t?{...e,transitionInterpolator:new l.Z({...t,...e.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:e:c}}},7557:(t,e,n)=>{"use strict";n.d(e,{G:()=>c,Z:()=>u});var i=n(4942),r=n(4034),o=n(6688),s=n(6442),a=n(5126),l=n(9191);class c extends s.Z{constructor(t){const{width:e,height:n,rotationX:r=0,rotationOrbit:o=0,target:s=[0,0,0],zoom:a=0,minRotationX:l=-90,maxRotationX:c=90,minZoom:u=-1/0,maxZoom:h=1/0,startPanPosition:d,startRotatePos:f,startRotationX:p,startRotationOrbit:g,startZoomPosition:m,startZoom:_}=t;super({width:e,height:n,rotationX:r,rotationOrbit:o,target:s,zoom:a,minRotationX:l,maxRotationX:c,minZoom:u,maxZoom:h},{startPanPosition:d,startRotatePos:f,startRotationX:p,startRotationOrbit:g,startZoomPosition:m,startZoom:_}),(0,i.Z)(this,"makeViewport",void 0),this.makeViewport=t.makeViewport}panStart({pos:t}){return this._getUpdatedState({startPanPosition:this._unproject(t)})}pan({pos:t,startPosition:e}){const n=this.getState().startPanPosition||e;if(!n)return this;const i=this.makeViewport(this.getViewportProps()).panByPosition(n,t);return this._getUpdatedState(i)}panEnd(){return this._getUpdatedState({startPanPosition:null})}rotateStart({pos:t}){return this._getUpdatedState({startRotatePos:t,startRotationX:this.getViewportProps().rotationX,startRotationOrbit:this.getViewportProps().rotationOrbit})}rotate({pos:t,deltaAngleX:e=0,deltaAngleY:n=0}){const{startRotatePos:i,startRotationX:r,startRotationOrbit:o}=this.getState(),{width:s,height:a}=this.getViewportProps();if(!i||void 0===r||void 0===o)return this;let l;if(t){let e=(t[0]-i[0])/s;const n=(t[1]-i[1])/a;(r<-90||r>90)&&(e*=-1),l={rotationX:r+180*n,rotationOrbit:o+180*e}}else l={rotationX:r+n,rotationOrbit:o+e};return this._getUpdatedState(l)}rotateEnd(){return this._getUpdatedState({startRotationX:null,startRotationOrbit:null})}shortestPathFrom(t){const e=t.getViewportProps(),n={...this.getViewportProps()},{rotationOrbit:i}=n;return Math.abs(i-e.rotationOrbit)>180&&(n.rotationOrbit=i<0?i+360:i-360),n}zoomStart({pos:t}){return this._getUpdatedState({startZoomPosition:this._unproject(t),startZoom:this.getViewportProps().zoom})}zoom({pos:t,startPos:e,scale:n}){let{startZoom:i,startZoomPosition:r}=this.getState();if(r||(i=this.getViewportProps().zoom,r=this._unproject(e)||this._unproject(t)),!r)return this;const o=this._calculateNewZoom({scale:n,startZoom:i}),s=this.makeViewport({...this.getViewportProps(),zoom:o});return this._getUpdatedState({zoom:o,...s.panByPosition(r,t)})}zoomEnd(){return this._getUpdatedState({startZoomPosition:null,startZoom:null})}zoomIn(t=2){return this._getUpdatedState({zoom:this._calculateNewZoom({scale:t})})}zoomOut(t=2){return this._getUpdatedState({zoom:this._calculateNewZoom({scale:1/t})})}moveLeft(t=50){return this._panFromCenter([-t,0])}moveRight(t=50){return this._panFromCenter([t,0])}moveUp(t=50){return this._panFromCenter([0,-t])}moveDown(t=50){return this._panFromCenter([0,t])}rotateLeft(t=15){return this._getUpdatedState({rotationOrbit:this.getViewportProps().rotationOrbit-t})}rotateRight(t=15){return this._getUpdatedState({rotationOrbit:this.getViewportProps().rotationOrbit+t})}rotateUp(t=10){return this._getUpdatedState({rotationX:this.getViewportProps().rotationX-t})}rotateDown(t=10){return this._getUpdatedState({rotationX:this.getViewportProps().rotationX+t})}_unproject(t){const e=this.makeViewport(this.getViewportProps());return t&&e.unproject(t)}_calculateNewZoom({scale:t,startZoom:e}){const{maxZoom:n,minZoom:i}=this.getViewportProps();void 0===e&&(e=this.getViewportProps().zoom);const o=e+Math.log2(t);return(0,r.uZ)(o,i,n)}_panFromCenter(t){const{width:e,height:n,target:i}=this.getViewportProps();return this.pan({startPosition:i,pos:[e/2+t[0],n/2+t[1]]})}_getUpdatedState(t){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...t})}applyConstraints(t){const{maxZoom:e,minZoom:n,zoom:i,maxRotationX:o,minRotationX:s,rotationOrbit:l}=t;return t.zoom=Array.isArray(i)?[(0,r.uZ)(i[0],n,e),(0,r.uZ)(i[1],n,e)]:(0,r.uZ)(i,n,e),t.rotationX=(0,r.uZ)(t.rotationX,s,o),(l<-180||l>180)&&(t.rotationOrbit=(0,a.wQ)(l+180,360)-180),t}}class u extends o.Z{constructor(...t){super(...t),(0,i.Z)(this,"ControllerState",c),(0,i.Z)(this,"transition",{transitionDuration:300,transitionInterpolator:new l.Z({transitionProps:{compare:["target","zoom","rotationX","rotationOrbit"],required:["target","zoom"]}})})}}},6442:(t,e,n)=>{"use strict";n.d(e,{Z:()=>r});var i=n(4942);class r{constructor(t,e){(0,i.Z)(this,"_viewportProps",void 0),(0,i.Z)(this,"_state",void 0),this._viewportProps=this.applyConstraints(t),this._state=e}getViewportProps(){return this._viewportProps}getState(){return this._state}}},3803:(t,e,n)=>{"use strict";n.d(e,{Z:()=>s,z:()=>o});var i=n(744);let r={};function o(t){r=t}function s(t,e,n,o){i.Z.level>0&&r[t]&&r[t].call(null,e,n,o)}},4088:(t,e,n)=>{"use strict";n.d(e,{Df:()=>r,FP:()=>a,iI:()=>s,k8:()=>l,zG:()=>o});var i=n(744);const r={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(r,"IDENTITY",{get:()=>(i.Z.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const o={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},s={common:0,meters:1,pixels:2},a={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}},l={DRAW:"draw",MASK:"mask"}},5923:(t,e,n)=>{"use strict";n.d(e,{Z:()=>Oe});var i=n(4942);let r=1,o=1;class s{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(t){const{delay:e=0,duration:n=Number.POSITIVE_INFINITY,rate:i=1,repeat:o=1}=t,s=r++,a={time:0,delay:e,duration:n,rate:i,repeat:o};return this._setChannelTime(a,this.time),this.channels.set(s,a),s}removeChannel(t){this.channels.delete(t);for(const[e,n]of this.animations)n.channel===t&&this.detachAnimation(e)}isFinished(t){const e=this.channels.get(t);return void 0!==e&&this.time>=e.delay+e.duration*e.repeat}getTime(t){if(void 0===t)return this.time;const e=this.channels.get(t);return void 0===e?-1:e.time}setTime(t){this.time=Math.max(0,t);const e=this.channels.values();for(const t of e)this._setChannelTime(t,this.time);const n=this.animations.values();for(const t of n){const{animation:e,channel:n}=t;e.setTime(this.getTime(n))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(t,e){const n=o++;return this.animations.set(n,{animation:t,channel:e}),t.setTime(this.getTime(e)),n}detachAnimation(t){this.animations.delete(t)}update(t){this.playing&&(-1===this.lastEngineTime&&(this.lastEngineTime=t),this.setTime(this.time+(t-this.lastEngineTime)),this.lastEngineTime=t)}_setChannelTime(t,e){const n=e-t.delay;n>=t.duration*t.repeat?t.time=t.duration*t.rate:(t.time=Math.max(0,n)%t.duration,t.time*=t.rate)}}var a=n(5409),l=n(744),c=n(3803),u=n(1855),h=n(8295),d=n(1469);class f{constructor(t,e,n){(0,i.Z)(this,"id",void 0),(0,i.Z)(this,"context",void 0),(0,i.Z)(this,"isLoaded",void 0),(0,i.Z)(this,"persistent",void 0),(0,i.Z)(this,"_loadCount",0),(0,i.Z)(this,"_subscribers",new Set),(0,i.Z)(this,"_data",void 0),(0,i.Z)(this,"_loader",void 0),(0,i.Z)(this,"_error",void 0),(0,i.Z)(this,"_content",void 0),this.id=t,this.context=n,this.setData(e)}subscribe(t){this._subscribers.add(t)}unsubscribe(t){this._subscribers.delete(t)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then((()=>this.getData()))}setData(t,e){if(t===this._data&&!e)return;this._data=t;const n=++this._loadCount;let i=t;"string"==typeof t&&(i=(0,d.z)(t)),i instanceof Promise?(this.isLoaded=!1,this._loader=i.then((t=>{this._loadCount===n&&(this.isLoaded=!0,this._error=void 0,this._content=t)})).catch((t=>{this._loadCount===n&&(this.isLoaded=!0,this._error=t||!0)}))):(this.isLoaded=!0,this._error=void 0,this._content=t);for(const t of this._subscribers)t.onChange(this.getData())}}class p{constructor({gl:t,protocol:e}){(0,i.Z)(this,"protocol",void 0),(0,i.Z)(this,"_context",void 0),(0,i.Z)(this,"_resources",void 0),(0,i.Z)(this,"_consumers",void 0),(0,i.Z)(this,"_pruneRequest",void 0),this.protocol=e||"resource://",this._context={gl:t,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(t){return!!t.startsWith(this.protocol)||t in this._resources}add({resourceId:t,data:e,forceUpdate:n=!1,persistent:i=!0}){let r=this._resources[t];r?r.setData(e,n):(r=new f(t,e,this._context),this._resources[t]=r),r.persistent=i}remove(t){const e=this._resources[t];e&&(e.delete(),delete this._resources[t])}unsubscribe({consumerId:t}){const e=this._consumers[t];if(e){for(const t in e){const n=e[t],i=this._resources[n.resourceId];i&&i.unsubscribe(n)}delete this._consumers[t],this.prune()}}subscribe({resourceId:t,onChange:e,consumerId:n,requestId:i="default"}){const{_resources:r,protocol:o}=this;t.startsWith(o)&&(r[t=t.replace(o,"")]||this.add({resourceId:t,data:null,persistent:!1}));const s=r[t];if(this._track(n,i,s,e),s)return s.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout((()=>this._prune()),0))}finalize(){for(const t in this._resources)this._resources[t].delete()}_track(t,e,n,i){const r=this._consumers,o=r[t]=r[t]||{},s=o[e]||{},a=s.resourceId&&this._resources[s.resourceId];a&&(a.unsubscribe(s),this.prune()),n&&(o[e]=s,s.onChange=i,s.resourceId=n.id,n.subscribe(s))}_prune(){this._pruneRequest=null;for(const t of Object.keys(this._resources)){const e=this._resources[t];e.persistent||e.inUse()||(e.delete(),delete this._resources[t])}}}var g=n(7013),m=n(358),_=n(6084);const v=[_.Z],b=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function y(t){const e=m.Z.getDefaultProgramManager(t);for(const t of v)e.addDefaultModule(t);for(const t of b)e.addShaderHook(t);return e}class w{constructor(t,{deck:e,stats:n,viewport:r,timeline:o}={}){(0,i.Z)(this,"layers",void 0),(0,i.Z)(this,"context",void 0),(0,i.Z)(this,"resourceManager",void 0),(0,i.Z)(this,"_lastRenderedLayers",[]),(0,i.Z)(this,"_needsRedraw",!1),(0,i.Z)(this,"_needsUpdate",!1),(0,i.Z)(this,"_nextLayers",null),(0,i.Z)(this,"_debug",!1),(0,i.Z)(this,"activateViewport",(t=>{(0,c.Z)("layerManager.activateViewport",this,t),t&&(this.context.viewport=t)})),this.layers=[],this.resourceManager=new p({gl:t,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,gl:t,deck:e,programManager:t&&y(t),stats:n||new h.Z({id:"deck.gl"}),viewport:r||new g.Z({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:o||new s,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const t of this.layers)this._finalizeLayer(t)}needsRedraw(t={clearRedrawFlags:!1}){let e=this._needsRedraw;t.clearRedrawFlags&&(this._needsRedraw=!1);for(const n of this.layers){const i=n.getNeedsRedraw(t);e=e||i}return e}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._needsUpdate}setNeedsRedraw(t){this._needsRedraw=this._needsRedraw||t}setNeedsUpdate(t){this._needsUpdate=this._needsUpdate||t}getLayers({layerIds:t}={}){return t?this.layers.filter((e=>t.find((t=>0===e.id.indexOf(t))))):this.layers}setProps(t){"debug"in t&&(this._debug=t.debug),"userData"in t&&(this.context.userData=t.userData),"layers"in t&&(this._nextLayers=t.layers),"onError"in t&&(this.context.onError=t.onError)}setLayers(t,e){(0,c.Z)("layerManager.setLayers",this,e,t),this._lastRenderedLayers=t;const n=(0,u.x)(t,Boolean);for(const t of n)t.context=this.context;this._updateLayers(this.layers,n)}updateLayers(){const t=this.needsUpdate();t&&(this.setNeedsRedraw("updating layers: ".concat(t)),this.setLayers(this._nextLayers||this._lastRenderedLayers,t)),this._nextLayers=null}_handleError(t,e,n){n.raiseError(e,"".concat(t," of ").concat(n))}_updateLayers(t,e){const n={};for(const e of t)n[e.id]?l.Z.warn("Multiple old layers with same id ".concat(e.id))():n[e.id]=e;const i=[];this._updateSublayersRecursively(e,n,i),this._finalizeOldLayers(n);let r=!1;for(const t of i)if(t.hasUniformTransition()){r="Uniform transition in ".concat(t);break}this._needsUpdate=r,this.layers=i}_updateSublayersRecursively(t,e,n){for(const i of t){i.context=this.context;const t=e[i.id];null===t&&l.Z.warn("Multiple new layers with same id ".concat(i.id))(),e[i.id]=null;let r=null;try{this._debug&&t!==i&&i.validateProps(),t?(this._transferLayerState(t,i),this._updateLayer(i)):this._initializeLayer(i),n.push(i),r=i.isComposite?i.getSubLayers():null}catch(t){this._handleError("matching",t,i)}r&&this._updateSublayersRecursively(r,e,n)}}_finalizeOldLayers(t){for(const e in t){const n=t[e];n&&this._finalizeLayer(n)}}_initializeLayer(t){try{t._initialize(),t.lifecycle=a.dt.INITIALIZED}catch(e){this._handleError("initialization",e,t)}}_transferLayerState(t,e){e._transferState(t),e.lifecycle=a.dt.MATCHED,e!==t&&(t.lifecycle=a.dt.AWAITING_GC)}_updateLayer(t){try{t._update()}catch(e){this._handleError("update",e,t)}}_finalizeLayer(t){this._needsRedraw=this._needsRedraw||"finalized ".concat(t),t.lifecycle=a.dt.AWAITING_FINALIZATION;try{t._finalize(),t.lifecycle=a.dt.FINALIZED}catch(e){this._handleError("finalization",e,t)}}}var x=n(6871);class C{constructor(t){(0,i.Z)(this,"width",void 0),(0,i.Z)(this,"height",void 0),(0,i.Z)(this,"views",void 0),(0,i.Z)(this,"viewState",void 0),(0,i.Z)(this,"controllers",void 0),(0,i.Z)(this,"timeline",void 0),(0,i.Z)(this,"_viewports",void 0),(0,i.Z)(this,"_viewportMap",void 0),(0,i.Z)(this,"_isUpdating",void 0),(0,i.Z)(this,"_needsRedraw",void 0),(0,i.Z)(this,"_needsUpdate",void 0),(0,i.Z)(this,"_eventManager",void 0),(0,i.Z)(this,"_eventCallbacks",void 0),this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=t.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=t.eventManager,this._eventCallbacks={onViewStateChange:t.onViewStateChange,onInteractionStateChange:t.onInteractionStateChange},Object.seal(this),this.setProps(t)}finalize(){for(const t in this.controllers){const e=this.controllers[t];e&&e.finalize()}this.controllers={}}needsRedraw(t={clearRedrawFlags:!1}){const e=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),e}setNeedsUpdate(t){this._needsUpdate=this._needsUpdate||t,this._needsRedraw=this._needsRedraw||t}updateViewStates(){for(const t in this.controllers){const e=this.controllers[t];e&&e.updateTransition()}}getViewports(t){return t?this._viewports.filter((e=>e.containsPixel(t))):this._viewports}getViews(){const t={};return this.views.forEach((e=>{t[e.id]=e})),t}getView(t){return this.views.find((e=>e.id===t))}getViewState(t){const e="string"==typeof t?this.getView(t):t,n=e&&this.viewState[e.getViewStateId()]||this.viewState;return e?e.filterViewState(n):n}getViewport(t){return this._viewportMap[t]}unproject(t,e){const n=this.getViewports(),i={x:t[0],y:t[1]};for(let r=n.length-1;r>=0;--r){const o=n[r];if(o.containsPixel(i)){const n=t.slice();return n[0]-=o.x,n[1]-=o.y,o.unproject(n,e)}}return null}setProps(t){t.views&&this._setViews(t.views),t.viewState&&this._setViewState(t.viewState),("width"in t||"height"in t)&&this._setSize(t.width,t.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(t,e){t===this.width&&e===this.height||(this.width=t,this.height=e,this.setNeedsUpdate("Size changed"))}_setViews(t){t=(0,u.x)(t,Boolean),this._diffViews(t,this.views)&&this.setNeedsUpdate("views changed"),this.views=t}_setViewState(t){t?(!(0,x.v)(t,this.viewState)&&this.setNeedsUpdate("viewState changed"),this.viewState=t):l.Z.warn("missing `viewState` or `initialViewState`")()}_onViewStateChange(t,e){this._eventCallbacks.onViewStateChange&&this._eventCallbacks.onViewStateChange({...e,viewId:t})}_createController(t,e){return new(0,e.type)({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,e.id),onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:e=>{var n;return null===(n=this.getView(t.id))||void 0===n?void 0:n.makeViewport({viewState:e,width:this.width,height:this.height})}})}_updateController(t,e,n,i){const r=t.controller;if(r){const o={...e,...r,id:t.id,x:n.x,y:n.y,width:n.width,height:n.height};return i||(i=this._createController(t,o)),i&&i.setProps(o),i}return null}_rebuildViewports(){const{views:t}=this,e=this.controllers;this._viewports=[],this.controllers={};let n=!1;for(let i=t.length;i--;){const r=t[i],o=this.getViewState(r),s=r.makeViewport({viewState:o,width:this.width,height:this.height});let a=e[r.id];const l=Boolean(r.controller);l&&!a&&(n=!0),!n&&l||!a||(a.finalize(),a=null),this.controllers[r.id]=this._updateController(r,o,s,a),this._viewports.unshift(s)}for(const t in e){const n=e[t];n&&!this.controllers[t]&&n.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach((t=>{t.id&&(this._viewportMap[t.id]=this._viewportMap[t.id]||t)}))}_diffViews(t,e){return t.length!==e.length||t.some(((n,i)=>!t[i].equals(e[i])))}}var k=n(4897),E=n(9970),S=n(4034),A=n(6688),T=n(6442),M=n(6018),D=n(5304),P=n(9191);class L extends T.Z{constructor(t){const{width:e,height:n,latitude:r,longitude:o,zoom:s,bearing:a=0,pitch:l=0,altitude:c=1.5,position:u=[0,0,0],maxZoom:h=20,minZoom:d=0,maxPitch:f=60,minPitch:p=0,startPanLngLat:g,startZoomLngLat:m,startRotatePos:_,startBearing:v,startPitch:b,startZoom:y,normalize:w=!0}=t;(0,D.Z)(Number.isFinite(o)),(0,D.Z)(Number.isFinite(r)),(0,D.Z)(Number.isFinite(s)),super({width:e,height:n,latitude:r,longitude:o,zoom:s,bearing:a,pitch:l,altitude:c,maxZoom:h,minZoom:d,maxPitch:f,minPitch:p,normalize:w,position:u},{startPanLngLat:g,startZoomLngLat:m,startRotatePos:_,startBearing:v,startPitch:b,startZoom:y}),(0,i.Z)(this,"makeViewport",void 0),this.makeViewport=t.makeViewport}panStart({pos:t}){return this._getUpdatedState({startPanLngLat:this._unproject(t)})}pan({pos:t,startPos:e}){const n=this.getState().startPanLngLat||this._unproject(e);if(!n)return this;const i=this.makeViewport(this.getViewportProps()).panByPosition(n,t);return this._getUpdatedState(i)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:t}){return this._getUpdatedState({startRotatePos:t,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:t,deltaAngleX:e=0,deltaAngleY:n=0}){const{startRotatePos:i,startBearing:r,startPitch:o}=this.getState();if(!i||void 0===r||void 0===o)return this;let s;return s=t?this._getNewRotation(t,i,o,r):{bearing:r+e,pitch:o+n},this._getUpdatedState(s)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:t}){return this._getUpdatedState({startZoomLngLat:this._unproject(t),startZoom:this.getViewportProps().zoom})}zoom({pos:t,startPos:e,scale:n}){let{startZoom:i,startZoomLngLat:r}=this.getState();if(r||(i=this.getViewportProps().zoom,r=this._unproject(e)||this._unproject(t)),!r)return this;const{maxZoom:o,minZoom:s}=this.getViewportProps();let a=i+Math.log2(n);a=(0,S.uZ)(a,s,o);const l=this.makeViewport({...this.getViewportProps(),zoom:a});return this._getUpdatedState({zoom:a,...l.panByPosition(r,t)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(t=2){return this._zoomFromCenter(t)}zoomOut(t=2){return this._zoomFromCenter(1/t)}moveLeft(t=100){return this._panFromCenter([t,0])}moveRight(t=100){return this._panFromCenter([-t,0])}moveUp(t=100){return this._panFromCenter([0,t])}moveDown(t=100){return this._panFromCenter([0,-t])}rotateLeft(t=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-t})}rotateRight(t=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+t})}rotateUp(t=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+t})}rotateDown(t=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-t})}shortestPathFrom(t){const e=t.getViewportProps(),n={...this.getViewportProps()},{bearing:i,longitude:r}=n;return Math.abs(i-e.bearing)>180&&(n.bearing=i<0?i+360:i-360),Math.abs(r-e.longitude)>180&&(n.longitude=r<0?r+360:r-360),n}applyConstraints(t){const{maxZoom:e,minZoom:n,zoom:i}=t;t.zoom=(0,S.uZ)(i,n,e);const{maxPitch:r,minPitch:o,pitch:s}=t;t.pitch=(0,S.uZ)(s,o,r);const{normalize:a=!0}=t;return a&&Object.assign(t,(0,M.QA)(t)),t}_zoomFromCenter(t){const{width:e,height:n}=this.getViewportProps();return this.zoom({pos:[e/2,n/2],scale:t})}_panFromCenter(t){const{width:e,height:n}=this.getViewportProps();return this.pan({startPos:[e/2,n/2],pos:[e/2+t[0],n/2+t[1]]})}_getUpdatedState(t){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...t})}_unproject(t){const e=this.makeViewport(this.getViewportProps());return t&&e.unproject(t)}_getNewRotation(t,e,n,i){const r=t[0]-e[0],o=t[1]-e[1],s=t[1],a=e[1],{width:l,height:c}=this.getViewportProps(),u=r/l;let h=0;o>0?Math.abs(c-a)>5&&(h=o/(a-c)*1.2):o<0&&a>5&&(h=1-s/a),h=(0,S.uZ)(h,-1,1);const{minPitch:d,maxPitch:f}=this.getViewportProps();let p=n;return h>0?p=n+h*(f-n):h<0&&(p=n-h*(d-n)),{pitch:p,bearing:i+180*u}}}class R extends A.Z{constructor(...t){super(...t),(0,i.Z)(this,"ControllerState",L),(0,i.Z)(this,"transition",{transitionDuration:300,transitionInterpolator:new P.Z({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})}),(0,i.Z)(this,"dragMode","pan")}setProps(t){t.position=t.position||[0,0,0];const e=this.props;super.setProps(t),(!e||e.height!==t.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...t,...this.state}))}}class I extends k.Z{get ViewportType(){return E.Z}get ControllerType(){return R}}(0,i.Z)(I,"displayName","MapView");var O=n(4912);const z=[255,255,255],F=1;let B=0;class N{constructor(t={}){(0,i.Z)(this,"id",void 0),(0,i.Z)(this,"color",void 0),(0,i.Z)(this,"intensity",void 0),(0,i.Z)(this,"type","ambient");const{color:e=z}=t,{intensity:n=F}=t;this.id=t.id||"ambient-".concat(B++),this.color=e,this.intensity=n}}var j=n(3855);const U=[255,255,255],V=1,W=[0,0,-1];let H=0;class ${constructor(t={}){(0,i.Z)(this,"id",void 0),(0,i.Z)(this,"color",void 0),(0,i.Z)(this,"intensity",void 0),(0,i.Z)(this,"type","directional"),(0,i.Z)(this,"direction",void 0),(0,i.Z)(this,"shadow",void 0);const{color:e=U}=t,{intensity:n=V}=t,{direction:r=W}=t,{_shadow:o=!1}=t;this.id=t.id||"directional-".concat(H++),this.color=e,this.intensity=n,this.type="directional",this.direction=new j.Z(r).normalize().toArray(),this.shadow=o}getProjectedLight(t){return this}}var Z=n(5451),q=n(9450),G=n(6047);class K extends class{constructor(t,e={id:"pass"}){(0,i.Z)(this,"id",void 0),(0,i.Z)(this,"gl",void 0),(0,i.Z)(this,"props",void 0);const{id:n}=e;this.id=n,this.gl=t,this.props={...e}}setProps(t){Object.assign(this.props,t)}render(t){}cleanup(){}}{constructor(...t){super(...t),(0,i.Z)(this,"_lastRenderIndex",-1)}render(t){const e=this.gl;return(0,q.dR)(e,{framebuffer:t.target}),this._drawLayers(t)}_drawLayers(t){const{target:e,moduleParameters:n,viewports:i,views:r,onViewportActive:o,clearStack:s=!0,clearCanvas:a=!0}=t;t.pass=t.pass||"unknown";const l=this.gl;a&&function(t){const e=t.drawingBufferWidth,n=t.drawingBufferHeight;(0,q.dR)(t,{viewport:[0,0,e,n]}),t.clear(16640)}(l),s&&(this._lastRenderIndex=-1);const c=[];for(const s of i){const i=r&&r[s.id];o(s);const a=this._getDrawLayerParams(s,t),u=s.subViewports||[s];for(const r of u){const o=this._drawLayersInViewport(l,{target:e,moduleParameters:n,viewport:r,view:i,pass:t.pass,layers:t.layers},a);c.push(o)}}return c}_getDrawLayerParams(t,{layers:e,pass:n,layerFilter:i,cullRect:r,effects:o,moduleParameters:s}){const a=[],l=X(this._lastRenderIndex+1),c={layer:e[0],viewport:t,isPicking:n.startsWith("picking"),renderPass:n,cullRect:r},u={};for(let r=0;r<e.length;r++){const h=e[r],d=this._shouldDrawLayer(h,c,i,u),f={shouldDrawLayer:d};d&&(f.layerRenderIndex=l(h,d),f.moduleParameters=this._getModuleParameters(h,o,n,s),f.layerParameters=this.getLayerParameters(h,r,t)),a[r]=f}return a}_drawLayersInViewport(t,{layers:e,moduleParameters:n,pass:i,target:r,viewport:o,view:s},a){const l=function(t,{moduleParameters:e,target:n,viewport:i}){const r=n&&"default-framebuffer"!==n.id,o=e&&e.devicePixelRatio||(0,q.w)(t),s=r?n.height:t.drawingBufferHeight,a=i;return[a.x*o,s-(a.y+a.height)*o,a.width*o,a.height*o]}(t,{moduleParameters:n,target:r,viewport:o});if(s&&s.props.clear){const e=!0===s.props.clear?{color:!0,depth:!0}:s.props.clear;(0,q.s8)(t,{scissorTest:!0,scissor:l},(()=>(0,G.Z)(t,e)))}const c={totalCount:e.length,visibleCount:0,compositeCount:0,pickableCount:0};(0,q.dR)(t,{viewport:l});for(let t=0;t<e.length;t++){const n=e[t],{shouldDrawLayer:r,layerRenderIndex:s,moduleParameters:l,layerParameters:u}=a[t];if(r&&n.props.pickable&&c.pickableCount++,n.isComposite)c.compositeCount++;else if(r){c.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,s),l.viewport=o;try{n._drawLayer({moduleParameters:l,uniforms:{layerIndex:s},parameters:u})}catch(t){n.raiseError(t,"drawing ".concat(n," to ").concat(i))}}}return c}shouldDrawLayer(t){return!0}getModuleParameters(t,e){return null}getLayerParameters(t,e,n){return t.props.parameters}_shouldDrawLayer(t,e,n,i){if(!t.props.visible||!this.shouldDrawLayer(t))return!1;e.layer=t;let r=t.parent;for(;r;){if(!r.props.visible||!r.filterSubLayer(e))return!1;e.layer=r,r=r.parent}if(n){const t=e.layer.id;if(t in i||(i[t]=n(e)),!i[t])return!1}return t.activateViewport(e.viewport),!0}_getModuleParameters(t,e,n,i){var r;const o=Object.assign(Object.create((null===(r=t.internalState)||void 0===r?void 0:r.propsInTransition)||t.props),{autoWrapLongitude:t.wrapLongitude,viewport:t.context.viewport,mousePosition:t.context.mousePosition,pickingActive:0,devicePixelRatio:(0,q.w)(this.gl)});if(e)for(const n of e){var s;Object.assign(o,null===(s=n.getModuleParameters)||void 0===s?void 0:s.call(n,t))}return Object.assign(o,this.getModuleParameters(t,e),i)}}function X(t=0,e={}){const n={},i=(r,o)=>{const s=r.props._offset,a=r.id,l=r.parent&&r.parent.id;let c;if(l&&!(l in e)&&i(r.parent,!1),l in n){const t=n[l]=n[l]||X(e[l],e);c=t(r,o),n[a]=t}else Number.isFinite(s)?(c=s+(e[l]||0),n[a]=null):c=t;return o&&c>=t&&(t=c+1),e[a]=c,c};return i}var Y=n(9830),Q=n(3849);class J extends K{constructor(t,e){super(t,e),(0,i.Z)(this,"shadowMap",void 0),(0,i.Z)(this,"depthBuffer",void 0),(0,i.Z)(this,"fbo",void 0),this.shadowMap=new O.Z(t,{width:1,height:1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.depthBuffer=new Y.Z(t,{format:33189,width:1,height:1}),this.fbo=new Q.Z(t,{id:"shadowmap",width:1,height:1,attachments:{36064:this.shadowMap,36096:this.depthBuffer}})}render(t){const e=this.fbo;(0,q.s8)(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},(()=>{const n=t.viewports[0],i=(0,q.w)(this.gl),r=n.width*i,o=n.height*i;r===e.width&&o===e.height||e.resize({width:r,height:o}),super.render({...t,target:e,pass:"shadow"})}))}shouldDrawLayer(t){return!1!==t.props.shadowEnabled}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}var tt=n(4088),et=n(8177);const nt=(0,et.Z)((function({viewport:t,center:e}){return new Z.Z(t.viewProjectionMatrix).invert().transform(e)})),it=(0,et.Z)((function({viewport:t,shadowMatrices:e}){const n=[],i=t.pixelUnprojectionMatrix,r=t.isGeospatial?void 0:1,o=[[0,0,r],[t.width,0,r],[0,t.height,r],[t.width,t.height,r],[0,0,-1],[t.width,0,-1],[0,t.height,-1],[t.width,t.height,-1]].map((t=>function(t,e){const[n,i,r]=t,o=(0,M.CT)([n,i,r],e);return Number.isFinite(r)?o:[o[0],o[1],0]}(t,i)));for(const i of e){const e=i.clone().translate(new j.Z(t.center).negate()),r=o.map((t=>e.transform(t))),s=(new Z.Z).ortho({left:Math.min(...r.map((t=>t[0]))),right:Math.max(...r.map((t=>t[0]))),bottom:Math.min(...r.map((t=>t[1]))),top:Math.max(...r.map((t=>t[1]))),near:Math.min(...r.map((t=>-t[2]))),far:Math.max(...r.map((t=>-t[2])))});n.push(s.multiplyRight(i))}return n})),rt=[0,0,0,1],ot=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],st={name:"shadow",dependencies:[_.Z],vs:"\nconst int max_lights = 2;\nuniform mat4 shadow_uViewProjectionMatrices[max_lights];\nuniform vec4 shadow_uProjectCenters[max_lights];\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform int shadow_uLightId;\nuniform float shadow_uLightCount;\n\nvarying vec3 shadow_vPosition[max_lights];\n\nvec4 shadow_setVertexPosition(vec4 position_commonspace) {\n  if (shadow_uDrawShadowMap) {\n    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);\n  }\n  if (shadow_uUseShadowMap) {\n    for (int i = 0; i < max_lights; i++) {\n      if(i < int(shadow_uLightCount)) {\n        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);\n        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;\n      }\n    }\n  }\n  return gl_Position;\n}\n",fs:"\nconst int max_lights = 2;\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform sampler2D shadow_uShadowMap0;\nuniform sampler2D shadow_uShadowMap1;\nuniform vec4 shadow_uColor;\nuniform float shadow_uLightCount;\n\nvarying vec3 shadow_vPosition[max_lights];\n\nconst vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);\nconst vec4 bitUnpackShift = 1.0 / bitPackShift;\nconst vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);\n\nfloat shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {\n  vec4 rgbaDepth = texture2D(shadowMap, position.xy);\n\n  float z = dot(rgbaDepth, bitUnpackShift);\n  return smoothstep(0.001, 0.01, position.z - z);\n}\n\nvec4 shadow_filterShadowColor(vec4 color) {\n  if (shadow_uDrawShadowMap) {\n    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);\n    rgbaDepth -= rgbaDepth.gbaa * bitMask;\n    return rgbaDepth;\n  }\n  if (shadow_uUseShadowMap) {\n    float shadowAlpha = 0.0;\n    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);\n    if(shadow_uLightCount > 1.0) {\n      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);\n    }\n    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;\n    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);\n\n    return vec4(\n      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),\n      blendedAlpha\n    );\n  }\n  return color;\n}\n",inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    position = shadow_setVertexPosition(geometry.position);\n    ","fs:DECKGL_FILTER_COLOR":"\n    color = shadow_filterShadowColor(color);\n    "},getUniforms:(t={},e={})=>"viewport"in t&&(t.drawToShadowMap||t.shadowMaps&&t.shadowMaps.length>0)?function(t,e){const{shadowEnabled:n=!0}=t;if(!n||!t.shadowMatrices||!t.shadowMatrices.length)return{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1};const i={shadow_uDrawShadowMap:Boolean(t.drawToShadowMap),shadow_uUseShadowMap:!!t.shadowMaps&&t.shadowMaps.length>0,shadow_uColor:t.shadowColor||rt,shadow_uLightId:t.shadowLightId||0,shadow_uLightCount:t.shadowMatrices.length},r=nt({viewport:t.viewport,center:e.project_uCenter}),o=[],s=it({shadowMatrices:t.shadowMatrices,viewport:t.viewport}).slice();for(let n=0;n<t.shadowMatrices.length;n++){const i=s[n],a=i.clone().translate(new j.Z(t.viewport.center).negate());e.project_uCoordinateSystem===tt.Df.LNGLAT&&e.project_uProjectionMode===tt.zG.WEB_MERCATOR?(s[n]=a,o[n]=r):(s[n]=i.clone().multiplyRight(ot),o[n]=a.transform(r))}for(let e=0;e<s.length;e++)i["shadow_uViewProjectionMatrices[".concat(e,"]")]=s[e],i["shadow_uProjectCenters[".concat(e,"]")]=o[e],t.shadowMaps&&t.shadowMaps.length>0?i["shadow_uShadowMap".concat(e)]=t.shadowMaps[e]:i["shadow_uShadowMap".concat(e)]=t.dummyShadowMap;return i}(t,e):{}},at={color:[255,255,255],intensity:1},lt=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],ct=[0,0,0,200/255];class ut{constructor(t={}){(0,i.Z)(this,"id","lighting-effect"),(0,i.Z)(this,"props",null),(0,i.Z)(this,"shadowColor",ct),(0,i.Z)(this,"shadow",void 0),(0,i.Z)(this,"ambientLight",null),(0,i.Z)(this,"directionalLights",[]),(0,i.Z)(this,"pointLights",[]),(0,i.Z)(this,"shadowPasses",[]),(0,i.Z)(this,"shadowMaps",[]),(0,i.Z)(this,"dummyShadowMap",null),(0,i.Z)(this,"programManager",void 0),(0,i.Z)(this,"shadowMatrices",void 0);for(const e in t){const n=t[e];switch(n.type){case"ambient":this.ambientLight=n;break;case"directional":this.directionalLights.push(n);break;case"point":this.pointLights.push(n)}}this._applyDefaultLights(),this.shadow=this.directionalLights.some((t=>t.shadow))}preRender(t,{layers:e,layerFilter:n,viewports:i,onViewportActive:r,views:o}){if(this.shadow){this.shadowMatrices=this._calculateMatrices(),0===this.shadowPasses.length&&this._createShadowPasses(t),this.programManager||(this.programManager=m.Z.getDefaultProgramManager(t),st&&this.programManager.addDefaultModule(st)),this.dummyShadowMap||(this.dummyShadowMap=new O.Z(t,{width:1,height:1}));for(let t=0;t<this.shadowPasses.length;t++)this.shadowPasses[t].render({layers:e,layerFilter:n,viewports:i,onViewportActive:r,views:o,moduleParameters:{shadowLightId:t,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}getModuleParameters(t){const e=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return e.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map((e=>e.getProjectedLight({layer:t}))),pointLights:this.pointLights.map((e=>e.getProjectedLight({layer:t})))},e}cleanup(){for(const t of this.shadowPasses)t.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(st),this.programManager=null)}_calculateMatrices(){const t=[];for(const e of this.directionalLights){const n=(new Z.Z).lookAt({eye:new j.Z(e.direction).negate()});t.push(n)}return t}_createShadowPasses(t){for(let e=0;e<this.directionalLights.length;e++){const n=new J(t);this.shadowPasses[e]=n,this.shadowMaps[e]=n.shadowMap}}_applyDefaultLights(){const{ambientLight:t,pointLights:e,directionalLights:n}=this;t||0!==e.length||0!==n.length||(this.ambientLight=new N(at),this.directionalLights.push(new $(lt[0]),new $(lt[1])))}}class ht extends K{constructor(t,e){super(t,e),(0,i.Z)(this,"maskMap",void 0),(0,i.Z)(this,"fbo",void 0);const{mapSize:n=2048}=e;this.maskMap=new O.Z(t,{width:n,height:n,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.fbo=new Q.Z(t,{id:"maskmap",width:n,height:n,attachments:{36064:this.maskMap}})}render(t){const e=this.gl,n=[!1,!1,!1,!1];return n[t.channel]=!0,(0,q.s8)(e,{clearColor:[255,255,255,255],blend:!0,blendFunc:[0,1],blendEquation:32778,colorMask:n,depthTest:!1},(()=>super.render({...t,target:this.fbo,pass:"mask"})))}shouldDrawLayer(t){return t.props.operation===tt.k8.MASK}delete(){this.fbo.delete(),this.maskMap.delete()}}var dt=n(6786);class ft{constructor(){(0,i.Z)(this,"id","mask-effect"),(0,i.Z)(this,"props",null),(0,i.Z)(this,"useInPicking",!0),(0,i.Z)(this,"dummyMaskMap",void 0),(0,i.Z)(this,"channels",[]),(0,i.Z)(this,"masks",null),(0,i.Z)(this,"maskPass",void 0),(0,i.Z)(this,"maskMap",void 0),(0,i.Z)(this,"lastViewport",void 0)}preRender(t,{layers:e,layerFilter:n,viewports:i,onViewportActive:r,views:o}){this.dummyMaskMap||(this.dummyMaskMap=new O.Z(t,{width:1,height:1}));const s=e.filter((t=>t.props.visible&&t.props.operation===tt.k8.MASK));if(0===s.length)return this.masks=null,void(this.channels.length=0);this.masks={},this.maskPass||(this.maskPass=new ht(t,{id:"default-mask"}),this.maskMap=this.maskPass.maskMap);const a=this._sortMaskChannels(s),l=i[0],c=!this.lastViewport||!this.lastViewport.equals(l);for(const t in a)this._renderChannel(a[t],{layerFilter:n,onViewportActive:r,views:o,viewport:l,viewportChanged:c})}_renderChannel(t,{layerFilter:e,onViewportActive:n,views:i,viewport:r,viewportChanged:o}){const s=this.channels[t.index];if(!s)return;const a=t===s||s.layers.length!==t.layers.length||t.layerBounds.some(((t,e)=>t!==s.layerBounds[e]));if(t.bounds=s.bounds,t.maskBounds=s.maskBounds,this.channels[t.index]=t,(a||o)&&(this.lastViewport=r,t.bounds=function({layers:t,viewport:e}){let n=null;for(const e of t){const t=e.getBounds();t&&(n?(n[0]=Math.min(n[0],t[0][0]),n[1]=Math.min(n[1],t[0][1]),n[2]=Math.max(n[2],t[1][0]),n[3]=Math.max(n[3],t[1][1])):n=[t[0][0],t[0][1],t[1][0],t[1][1]])}const i=e.getBounds();if(!n)return i;const r=function(t){const e=t[2]-t[0],n=t[3]-t[1],i=t[0]+.5*e,r=t[1]+.5*n;return[i-e,r-n,i+e,r+n]}(i);return n[2]-n[0]<r[2]-r[0]||n[3]-n[1]<r[3]-r[1]||(n[0]=Math.max(n[0],r[0]),n[1]=Math.max(n[1],r[1]),n[2]=Math.min(n[2],r[2]),n[3]=Math.min(n[3],r[3])),n}({layers:t.layers,viewport:r}),a||!(0,S.fS)(t.bounds,s.bounds))){const{maskPass:o,maskMap:s}=this,a=function({bounds:t,viewport:e,width:n,height:i}){if(t[2]<=t[0]||t[3]<=t[1])return null;if(n-=2,i-=2,e instanceof E.Z){const{longitude:e,latitude:r,zoom:o}=(0,M.Xg)({width:n,height:i,bounds:[[t[0],t[1]],[t[2],t[3]]],maxZoom:20});return new E.Z({longitude:e,latitude:r,zoom:o,x:1,y:1,width:n,height:i})}const r=[(t[0]+t[2])/2,(t[1]+t[3])/2,0],o=Math.min(20,n/(t[2]-t[0]),i/(t[3]-t[1]));return new dt.Z({x:1,y:1}).makeViewport({width:n,height:i,viewState:{target:r,zoom:Math.log2(o)}})}({bounds:t.bounds,viewport:r,width:s.width,height:s.height});t.maskBounds=a?a.getBounds():[0,0,1,1],o.render({pass:"mask",channel:t.index,layers:t.layers,layerFilter:e,viewports:a?[a]:[],onViewportActive:n,views:i,moduleParameters:{devicePixelRatio:1}})}this.masks[t.id]={index:t.index,bounds:t.maskBounds,coordinateOrigin:t.coordinateOrigin,coordinateSystem:t.coordinateSystem}}_sortMaskChannels(t){const e={};let n=0;for(const i of t){const{id:t}=i.root;let r=e[t];if(!r){if(++n>4){l.Z.warn("Too many mask layers. The max supported is 4")();continue}r={id:t,index:this.channels.findIndex((e=>(null==e?void 0:e.id)===t)),layers:[],layerBounds:[],coordinateOrigin:i.root.props.coordinateOrigin,coordinateSystem:i.root.props.coordinateSystem},e[t]=r}r.layers.push(i),r.layerBounds.push(i.getBounds())}for(let t=0;t<4;t++){const n=this.channels[t];n&&n.id in e||(this.channels[t]=null)}for(const t in e){const n=e[t];n.index<0&&(n.index=this.channels.findIndex((t=>!t)),this.channels[n.index]=n)}return e}getModuleParameters(){return{maskMap:this.masks?this.maskMap:this.dummyMaskMap,maskChannels:this.masks}}cleanup(){this.dummyMaskMap&&(this.dummyMaskMap.delete(),this.dummyMaskMap=void 0),this.maskPass&&(this.maskPass.delete(),this.maskPass=void 0,this.maskMap=void 0),this.lastViewport=void 0,this.masks=null,this.channels.length=0}}const pt=new ut;class gt{constructor(){(0,i.Z)(this,"effects",void 0),(0,i.Z)(this,"_internalEffects",void 0),(0,i.Z)(this,"_needsRedraw",void 0),this.effects=[],this._internalEffects=[],this._needsRedraw="Initial render",this.setEffects()}setProps(t){"effects"in t&&(t.effects.length===this.effects.length&&(0,x.v)(t.effects,this.effects)||(this.setEffects(t.effects),this._needsRedraw="effects changed"))}needsRedraw(t={clearRedrawFlags:!1}){const e=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),e}getEffects(){return this._internalEffects}finalize(){this.cleanup()}setEffects(t=[]){this.cleanup(),this.effects=t,this._internalEffects=t.slice(),this._internalEffects.push(new ft),t.some((t=>t instanceof ut))||this._internalEffects.push(pt)}cleanup(){for(const t of this.effects)t.cleanup();for(const t of this._internalEffects)t.cleanup();this.effects.length=0,this._internalEffects.length=0}}class mt extends K{shouldDrawLayer(t){return t.props.operation===tt.k8.DRAW}}const _t={blendFunc:[1,0,32771,0],blendEquation:32774};class vt extends K{constructor(...t){super(...t),(0,i.Z)(this,"pickZ",void 0),(0,i.Z)(this,"_colors",null)}render(t){return t.pickingFBO?this._drawPickingBuffer(t):super.render(t)}_drawPickingBuffer({layers:t,layerFilter:e,views:n,viewports:i,onViewportActive:r,pickingFBO:o,deviceRect:{x:s,y:a,width:l,height:c},cullRect:u,effects:h,pass:d="picking",pickZ:f}){const p=this.gl;this.pickZ=f;const g=f?null:{byLayer:new Map,byAlpha:[]};this._colors=g;const m=(0,q.s8)(p,{scissorTest:!0,scissor:[s,a,l,c],clearColor:[0,0,0,0],depthMask:!0,depthTest:!0,depthRange:[0,1],colorMask:[!0,!0,!0,!0],..._t,blend:!f},(()=>super.render({target:o,layers:t,layerFilter:e,views:n,viewports:i,onViewportActive:r,cullRect:u,effects:null==h?void 0:h.filter((t=>t.useInPicking)),pass:d})));return this._colors=null,{decodePickingColor:g&&bt.bind(null,g),stats:m}}shouldDrawLayer(t){return t.props.pickable&&t.props.operation===tt.k8.DRAW}getModuleParameters(){return{pickingActive:1,pickingAttribute:this.pickZ,lightSources:{}}}getLayerParameters(t,e,n){const i={...t.props.parameters};return this._colors?(Object.assign(i,_t),i.blend=!0,i.blendColor=function(t,e,n){const{byLayer:i,byAlpha:r}=t;let o,s=i.get(e);return s?(s.viewports.push(n),o=s.a):(o=i.size+1,o<=255?(s={a:o,layer:e,viewports:[n]},i.set(e,s),r[o]=s):(l.Z.warn("Too many pickable layers, only picking the first 255")(),o=0)),[0,0,0,o/255]}(this._colors,t,n)):i.blend=!1,i}}function bt(t,e){const n=t.byAlpha[e[3]];return n&&{pickedLayer:n.layer,pickedViewports:n.viewports,pickedObjectIndex:n.layer.decodePickingColor(e)}}class yt{constructor(t){this.gl=t,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new mt(t),this.pickLayersPass=new vt(t),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(t){"layerFilter"in t&&this.layerFilter!==t.layerFilter&&(this.layerFilter=t.layerFilter,this._needsRedraw="layerFilter changed"),"drawPickingColors"in t&&this.drawPickingColors!==t.drawPickingColors&&(this.drawPickingColors=t.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(t){const e=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass;t.layerFilter=t.layerFilter||this.layerFilter,t.effects=t.effects||[],t.target=t.target||Q.Z.getDefaultFramebuffer(this.gl),this._preRender(t.effects,t);const n=this.lastPostProcessEffect?this.renderBuffers[0]:t.target,i=e.render({...t,target:n});this._postRender(t.effects,t),this.renderCount++,(0,c.Z)("deckRenderer.renderLayers",this,i,t)}needsRedraw(t={clearRedrawFlags:!1}){const e=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),e}finalize(){const{renderBuffers:t}=this;for(const e of t)e.delete();t.length=0}_preRender(t,e){let n=null;for(const i of t)i.preRender(this.gl,e),i.postRender&&(n=i);n&&this._resizeRenderBuffers(),this.lastPostProcessEffect=n}_resizeRenderBuffers(){const{renderBuffers:t}=this;0===t.length&&t.push(new Q.Z(this.gl),new Q.Z(this.gl));for(const e of t)e.resize()}_postRender(t,e){const{renderBuffers:n}=this,i={inputBuffer:n[0],swapBuffer:n[1],target:null};for(const r of t)if(r.postRender){if(r===this.lastPostProcessEffect){i.target=e.target,r.postRender(this.gl,i);break}const t=r.postRender(this.gl,i);i.inputBuffer=t,i.swapBuffer=t===n[0]?n[1]:n[0]}}}var wt=n(1953);const xt={pickedColor:null,pickedObjectIndex:-1};function Ct({pickedColors:t,decodePickingColor:e,deviceX:n,deviceY:i,deviceRadius:r,deviceRect:o}){const{x:s,y:a,width:c,height:u}=o;let h=r*r,d=-1,f=0;for(let e=0;e<u;e++){const r=e+a-i,o=r*r;if(o>h)f+=4*c;else for(let e=0;e<c;e++){if(t[f+3]-1>=0){const t=e+s-n,i=t*t+o;i<=h&&(h=i,d=f)}f+=4}}if(d>=0){const n=t.slice(d,d+4),i=e(n);if(i){const t=Math.floor(d/4/c),e=d/4-t*c;return{...i,pickedColor:n,pickedX:s+e,pickedY:a+t}}l.Z.error("Picked non-existent layer. Is picking buffer corrupt?")()}return xt}function kt({pickInfo:t,viewports:e,pixelRatio:n,x:i,y:r,z:o}){let s,a=e[0];if(e.length>1&&(a=function(t,e){for(let n=t.length-1;n>=0;n--){const i=t[n];if(i.containsPixel(e))return i}return t[0]}((null==t?void 0:t.pickedViewports)||e,{x:i,y:r})),a){const t=[i-a.x,r-a.y];void 0!==o&&(t[2]=o),s=a.unproject(t)}return{color:null,layer:null,viewport:a,index:-1,picked:!1,x:i,y:r,pixel:[i,r],coordinate:s,devicePixel:t&&"pickedX"in t?[t.pickedX,t.pickedY]:void 0,pixelRatio:n}}function Et(t){const{pickInfo:e,lastPickedInfo:n,mode:i,layers:r}=t,{pickedColor:o,pickedLayer:s,pickedObjectIndex:a}=e,l=s?[s]:[];if("hover"===i){const t=n.index,e=n.layerId,i=s?s.props.id:null;if(i!==e||a!==t){if(i!==e){const t=r.find((t=>t.props.id===e));t&&l.unshift(t)}n.layerId=i,n.index=a,n.info=null}}const c=kt(t),u=new Map;return u.set(null,c),l.forEach((t=>{let e={...c};t===s&&(e.color=o,e.index=a,e.picked=!0),e=St({layer:t,info:e,mode:i});const r=e.layer;t===s&&"hover"===i&&(n.info=e),u.set(r.id,e),"hover"===i&&r.updateAutoHighlight(e)})),u}function St({layer:t,info:e,mode:n}){for(;t&&e;){const i=e.layer||null;e.sourceLayer=i,e.layer=t,e=t.getPickingInfo({info:e,mode:n,sourceLayer:i}),t=t.parent}return e}class At{constructor(t){(0,i.Z)(this,"gl",void 0),(0,i.Z)(this,"pickingFBO",void 0),(0,i.Z)(this,"depthFBO",void 0),(0,i.Z)(this,"pickLayersPass",void 0),(0,i.Z)(this,"layerFilter",void 0),(0,i.Z)(this,"lastPickedInfo",void 0),(0,i.Z)(this,"_pickable",!0),this.gl=t,this.pickLayersPass=new vt(t),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(t){"layerFilter"in t&&(this.layerFilter=t.layerFilter),"_pickable"in t&&(this._pickable=t._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.delete(),this.depthFBO&&(this.depthFBO.color.delete(),this.depthFBO.delete())}pickObject(t){return this._pickClosestObject(t)}pickObjects(t){return this._pickVisibleObjects(t)}getLastPickedObject({x:t,y:e,layers:n,viewports:i},r=this.lastPickedInfo.info){const o=r&&r.layer&&r.layer.id,s=r&&r.viewport&&r.viewport.id,a=o?n.find((t=>t.id===o)):null,l=s&&i.find((t=>t.id===s))||i[0],c=l&&l.unproject([t-l.x,e-l.y]),u={x:t,y:e,viewport:l,coordinate:c,layer:a};return{...r,...u}}_resizeBuffer(){var t,e;const{gl:n}=this;if(!this.pickingFBO&&(this.pickingFBO=new Q.Z(n),Q.Z.isSupported(n,{colorBufferFloat:!0}))){const t=new Q.Z(n);t.attach({36064:new O.Z(n,{format:(0,q.D0)(n)?34836:6408,type:5126})}),this.depthFBO=t}null===(t=this.pickingFBO)||void 0===t||t.resize({width:n.canvas.width,height:n.canvas.height}),null===(e=this.depthFBO)||void 0===e||e.resize({width:n.canvas.width,height:n.canvas.height})}_getPickable(t){if(!1===this._pickable)return null;const e=t.filter((t=>t.isPickable()&&!t.isComposite));return e.length?e:null}_pickClosestObject({layers:t,views:e,viewports:n,x:i,y:r,radius:o=0,depth:s=1,mode:a="query",unproject3D:l,onViewportActive:c,effects:u}){const h=this._getPickable(t),d=(0,q.w)(this.gl);if(!h)return{result:[],emptyInfo:kt({viewports:n,x:i,y:r,pixelRatio:d})};this._resizeBuffer();const f=(0,q.JY)(this.gl,[i,r],!0),p=[f.x+Math.floor(f.width/2),f.y+Math.floor(f.height/2)],g=Math.round(o*d),{width:m,height:_}=this.pickingFBO,v=this._getPickingRect({deviceX:p[0],deviceY:p[1],deviceRadius:g,deviceWidth:m,deviceHeight:_}),b={x:i-o,y:r-o,width:2*o+1,height:2*o+1};let y;const w=[],x=new Set;for(let t=0;t<s;t++){let o,f;o=v?Ct({...this._drawAndSample({layers:h,views:e,viewports:n,onViewportActive:c,deviceRect:v,cullRect:b,effects:u,pass:"picking:".concat(a)}),deviceX:p[0],deviceY:p[1],deviceRadius:g,deviceRect:v}):{pickedColor:null,pickedObjectIndex:-1},o.pickedLayer&&l&&this.depthFBO&&(f=this._drawAndSample({layers:[o.pickedLayer],views:e,viewports:n,onViewportActive:c,deviceRect:{x:o.pickedX,y:o.pickedY,width:1,height:1},cullRect:b,effects:u,pass:"picking:".concat(a,":z")},!0).pickedColors[0]),o.pickedLayer&&t+1<s&&(x.add(o.pickedLayer),o.pickedLayer.disablePickingIndex(o.pickedObjectIndex)),y=Et({pickInfo:o,lastPickedInfo:this.lastPickedInfo,mode:a,layers:h,viewports:n,x:i,y:r,z:f,pixelRatio:d});for(const t of y.values())t.layer&&w.push(t);if(!o.pickedColor)break}for(const t of x)t.restorePickingColors();return{result:w,emptyInfo:y.get(null)}}_pickVisibleObjects({layers:t,views:e,viewports:n,x:i,y:r,width:o=1,height:s=1,mode:a="query",maxObjects:c=null,onViewportActive:u,effects:h}){const d=this._getPickable(t);if(!d)return[];this._resizeBuffer();const f=(0,q.w)(this.gl),p=(0,q.JY)(this.gl,[i,r],!0),g=p.x,m=p.y+p.height,_=(0,q.JY)(this.gl,[i+o,r+s],!0),v=_.x+_.width,b=_.y,y={x:g,y:b,width:v-g,height:m-b},w=function({pickedColors:t,decodePickingColor:e}){const n=new Map;if(t)for(let i=0;i<t.length;i+=4)if(t[i+3]-1>=0){const r=t.slice(i,i+4),o=r.join(",");if(!n.has(o)){const t=e(r);t?n.set(o,{...t,color:r}):l.Z.error("Picked non-existent layer. Is picking buffer corrupt?")()}}return Array.from(n.values())}(this._drawAndSample({layers:d,views:e,viewports:n,onViewportActive:u,deviceRect:y,cullRect:{x:i,y:r,width:o,height:s},effects:h,pass:"picking:".concat(a)})),x=new Map,C=Number.isFinite(c);for(let t=0;t<w.length&&!(C&&c&&x.size>=c);t++){const e=w[t];let n={color:e.pickedColor,layer:null,index:e.pickedObjectIndex,picked:!0,x:i,y:r,pixelRatio:f};n=St({layer:e.pickedLayer,info:n,mode:a}),x.has(n.object)||x.set(n.object,n)}return Array.from(x.values())}_drawAndSample({layers:t,views:e,viewports:n,onViewportActive:i,deviceRect:r,cullRect:o,effects:s,pass:a},l=!1){const c=l?this.depthFBO:this.pickingFBO,{decodePickingColor:u}=this.pickLayersPass.render({layers:t,layerFilter:this.layerFilter,views:e,viewports:n,onViewportActive:i,pickingFBO:c,deviceRect:r,cullRect:o,effects:s,pass:a,pickZ:l}),{x:h,y:d,width:f,height:p}=r,g=new(l?Float32Array:Uint8Array)(f*p*4);return(0,wt.z6)(c,{sourceX:h,sourceY:d,sourceWidth:f,sourceHeight:p,target:g}),{pickedColors:g,decodePickingColor:u}}_getPickingRect({deviceX:t,deviceY:e,deviceRadius:n,deviceWidth:i,deviceHeight:r}){const o=Math.max(0,t-n),s=Math.max(0,e-n),a=Math.min(i,t+n+1)-o,l=Math.min(r,e+n+1)-s;return a<=0||l<=0?null:{x:o,y:s,width:a,height:l}}}const Tt={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};class Mt{constructor(t){(0,i.Z)(this,"el",null),(0,i.Z)(this,"isVisible",!1);const e=t.parentElement;e&&(this.el=document.createElement("div"),this.el.className="deck-tooltip",Object.assign(this.el.style,Tt),e.appendChild(this.el))}setTooltip(t,e,n){const i=this.el;if(i){if("string"==typeof t)i.innerText=t;else{if(!t)return this.isVisible=!1,void(i.style.display="none");t.text&&(i.innerText=t.text),t.html&&(i.innerHTML=t.html),t.className&&(i.className=t.className),Object.assign(i.style,t.style)}this.isVisible=!0,i.style.display="block",i.style.transform="translate(".concat(e,"px, ").concat(n,"px)")}}remove(){this.el&&(this.el.remove(),this.el=null)}}var Dt=n(6610),Pt=n(6228),Lt=n(3579);const Rt={id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:function(t){const e=t[0],n=t[t.length-1];return"{"===e&&"}"===n||"["===e&&"]"===n},parseTextSync:JSON.parse},It="8.8.21",Ot=globalThis.deck&&globalThis.deck.VERSION;if(Ot&&Ot!==It)throw new Error("deck.gl - multiple versions detected: ".concat(Ot," vs ").concat(It));Ot||(l.Z.log(1,"deck.gl ".concat(It))(),globalThis.deck={...globalThis.deck,VERSION:It,version:It,log:l.Z,_registerLoggers:c.z},(0,Pt.fh)([Rt,[Lt.S,{imagebitmap:{premultiplyAlpha:"none"}}]]));const zt=globalThis.deck;var Ft=n(3485),Bt=n(9835),Nt=n(2525),jt=n(7577),Ut=n(8271),Vt=n(6948);class Wt extends jt.Z{get[Symbol.toStringTag](){return"Query"}static isSupported(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const n=(0,q.D0)(t),i=(0,Ut.ag)(t,Vt.h.TIMER_QUERY);let r=n||i;for(const t of e)switch(t){case"queries":r=r&&n;break;case"timers":r=r&&i;break;default:(0,Nt.h)(!1)}return r}constructor(t){super(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),this.target=null,this._queryPending=!1,this._pollingPromise=null,Object.seal(this)}beginTimeElapsedQuery(){return this.begin(35007)}beginOcclusionQuery(){let{conservative:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.begin(t?36202:35887)}beginTransformFeedbackQuery(){return this.begin(35976)}begin(t){return this._queryPending||(this.target=t,this.gl2.beginQuery(this.target,this.handle)),this}end(){return this._queryPending||this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this}isResultAvailable(){if(!this._queryPending)return!1;const t=this.gl2.getQueryParameter(this.handle,34919);return t&&(this._queryPending=!1),t}isTimerDisjoint(){return this.gl2.getParameter(36795)}getResult(){return this.gl2.getQueryParameter(this.handle,34918)}getTimerMilliseconds(){return this.getResult()/1e6}createPoll(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.POSITIVE_INFINITY;if(this._pollingPromise)return this._pollingPromise;let e=0;return this._pollingPromise=new Promise(((n,i)=>{const r=()=>{this.isResultAvailable()?(n(this.getResult()),this._pollingPromise=null):e++>t?(i("Timed out"),this._pollingPromise=null):requestAnimationFrame(r)};requestAnimationFrame(r)})),this._pollingPromise}_createHandle(){return Wt.isSupported(this.gl)?this.gl2.createQuery():null}_deleteHandle(){this.gl2.deleteQuery(this.handle)}}const Ht=(0,n(3370).Z)()&&"undefined"!=typeof document;let $t=0;class Zt{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{onCreateContext:e=(t=>(0,q.s9)(t)),onAddHTML:n=null,onInitialize:i=(()=>{}),onRender:r=(()=>{}),onFinalize:o=(()=>{}),onError:s,gl:a=null,glOptions:l={},debug:c=!1,createFramebuffer:u=!1,autoResizeViewport:h=!0,autoResizeDrawingBuffer:d=!0,stats:f=Bt.lR.get("animation-loop-".concat($t++))}=t;let{useDevicePixels:p=!0}=t;"useDevicePixelRatio"in t&&(q.cM.deprecated("useDevicePixelRatio","useDevicePixels")(),p=t.useDevicePixelRatio),this.props={onCreateContext:e,onAddHTML:n,onInitialize:i,onRender:r,onFinalize:o,onError:s,gl:a,glOptions:l,debug:c,createFramebuffer:u},this.gl=a,this.needsRedraw=null,this.timeline=null,this.stats=f,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:h,autoResizeDrawingBuffer:d,useDevicePixels:p}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}delete(){this.stop(),this._setDisplay(null)}setNeedsRedraw(t){return(0,Nt.h)("string"==typeof t),this.needsRedraw=this.needsRedraw||t,this}setProps(t){return"autoResizeViewport"in t&&(this.autoResizeViewport=t.autoResizeViewport),"autoResizeDrawingBuffer"in t&&(this.autoResizeDrawingBuffer=t.autoResizeDrawingBuffer),"useDevicePixels"in t&&(this.useDevicePixels=t.useDevicePixels),this}start(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._running)return this;this._running=!0;const e=this._getPageLoadPromise().then((()=>!this._running||this._initialized?null:(this._createWebGLContext(t),this._createFramebuffer(),this._startEventHandling(),this._initializeCallbackData(),this._updateCallbackData(),this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._gpuTimeQuery=Wt.isSupported(this.gl,["timers"])?new Wt(this.gl):null,this._initialized=!0,this.onInitialize(this.animationProps)))).then((t=>{this._running&&(this._addCallbackData(t||{}),!1!==t&&this._startLoop())}));return this.props.onError&&e.catch(this.props.onError),this}redraw(){return this.isContextLost()||(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers()),this}stop(){return this._running&&(this._finalizeCallbackData(),this._cancelAnimationFrame(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this}attachTimeline(t){return this.timeline=t,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise((t=>{this._resolveNextFrame=t}))),this._nextFramePromise}async toDataURL(){return this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.gl.canvas.toDataURL()}isContextLost(){return this.gl.isContextLost()}onCreateContext(){return this.props.onCreateContext(...arguments)}onInitialize(){return this.props.onInitialize(...arguments)}onRender(){return this.props.onRender(...arguments)}onFinalize(){return this.props.onFinalize(...arguments)}getHTMLControlValue(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const n=document.getElementById(t);return n?Number(n.value):e}setViewParameters(){return q.cM.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}_startLoop(){const t=()=>{this._running&&(this.redraw(),this._animationFrameId=this._requestAnimationFrame(t))};this._cancelAnimationFrame(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame(t)}_getPageLoadPromise(){return this._pageLoadPromise||(this._pageLoadPromise=Ht?new Promise(((t,e)=>{Ht&&"complete"===document.readyState?t(document):window.addEventListener("load",(()=>{t(document)}))})):Promise.resolve({})),this._pageLoadPromise}_setDisplay(t){this.display&&(this.display.delete(),this.display.animationLoop=null),t&&(t.animationLoop=this),this.display=t}_cancelAnimationFrame(t){return this.display&&this.display.cancelAnimationFrame?this.display.cancelAnimationFrame(t):(e=t,"undefined"!=typeof window&&window.cancelAnimationFrame?window.cancelAnimationFrame(e):clearTimeout(e));var e}_requestAnimationFrame(t){if(this._running)return this.display&&this.display.requestAnimationFrame?this.display.requestAnimationFrame(t):(e=t,"undefined"!=typeof window&&window.requestAnimationFrame?window.requestAnimationFrame(e):setTimeout(e,1e3/60));var e}_renderFrame(){this.display?this.display._renderFrame(...arguments):this.onRender(...arguments)}_clearNeedsRedraw(){this.needsRedraw=null}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()}_initializeCallbackData(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}}_updateCallbackData(){const{width:t,height:e,aspect:n}=this._getSizeAndAspect();t===this.animationProps.width&&e===this.animationProps.height||this.setNeedsRedraw("drawing buffer resized"),n!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=t,this.animationProps.height=e,this.animationProps.aspect=n,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen}_finalizeCallbackData(){this.onFinalize(this.animationProps)}_addCallbackData(t){"object"==typeof t&&null!==t&&(this.animationProps=Object.assign({},this.animationProps,t))}_createWebGLContext(t){if(this.offScreen=t.canvas&&"undefined"!=typeof OffscreenCanvas&&t.canvas instanceof OffscreenCanvas,t=Object.assign({},t,this.props.glOptions),this.gl=this.props.gl?(0,q.yW)(this.props.gl,t):this.onCreateContext(t),!(0,q.UF)(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");(0,q.kL)(this.gl),this._createInfoDiv()}_createInfoDiv(){if(this.gl.canvas&&this.props.onAddHTML){const t=document.createElement("div");document.body.appendChild(t),t.style.position="relative";const e=document.createElement("div");e.style.position="absolute",e.style.left="10px",e.style.bottom="10px",e.style.width="300px",e.style.background="white",t.appendChild(this.gl.canvas),t.appendChild(e);const n=this.props.onAddHTML(e);n&&(e.innerHTML=n)}}_getSizeAndAspect(){const t=this.gl.drawingBufferWidth,e=this.gl.drawingBufferHeight;let n=1;const{canvas:i}=this.gl;return i&&i.clientHeight?n=i.clientWidth/i.clientHeight:t>0&&e>0&&(n=t/e),{width:t,height:e,aspect:n}}_resizeViewport(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.autoResizeDrawingBuffer&&(0,q.aQ)(this.gl,{useDevicePixels:this.useDevicePixels})}_createFramebuffer(){this.props.createFramebuffer&&(this.framebuffer=new Q.Z(this.gl))}_resizeFramebuffer(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}_beginTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()}_endTimers(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()}_startEventHandling(){const{canvas:t}=this.gl;t&&(t.addEventListener("mousemove",this._onMousemove),t.addEventListener("mouseleave",this._onMouseleave))}_onMousemove(t){this.animationProps._mousePosition=[t.offsetX,t.offsetY]}_onMouseleave(t){this.animationProps._mousePosition=null}}var qt=n(840);const Gt={mousedown:1,mousemove:2,mouseup:4};!function(t){const e=t.prototype.handler;t.prototype.handler=function(t){const n=this.store;t.button>0&&"pointerdown"===t.type&&(function(e,n){for(let n=0;n<e.length;n++)if(e[n].pointerId===t.pointerId)return!0;return!1}(n)||n.push(t)),e.call(this,t)}}(qt.PointerEventInput),qt.MouseInput.prototype.handler=function(t){let e=Gt[t.type];1&e&&t.button>=0&&(this.pressed=!0),2&e&&0===t.which&&(e=4),this.pressed&&(4&e&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:"mouse",srcEvent:t}))};const Kt=qt.Manager,Xt=qt;class Yt{constructor(t,e,n){this.element=t,this.callback=e,this.options={enable:!0,...n}}}const Qt=Xt?[[Xt.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[Xt.Rotate,{enable:!1}],[Xt.Pinch,{enable:!1}],[Xt.Swipe,{enable:!1}],[Xt.Pan,{threshold:0,enable:!1}],[Xt.Press,{enable:!1}],[Xt.Tap,{event:"doubletap",taps:2,enable:!1}],[Xt.Tap,{event:"anytap",enable:!1}],[Xt.Tap,{enable:!1}]]:null,Jt={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},te={doubletap:["tap"]},ee={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},ne={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},ie={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},re={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},oe="undefined"!=typeof navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",se="undefined"!=typeof window?window:n.g;void 0!==n.g?n.g:window,"undefined"!=typeof document&&document;let ae=!1;try{const t={get passive(){return ae=!0,!0}};se.addEventListener("test",null,t),se.removeEventListener("test",null)}catch(t){ae=!1}const le=-1!==oe.indexOf("firefox"),{WHEEL_EVENTS:ce}=ne,ue="wheel",he=4.000244140625;class de extends Yt{constructor(t,e,n){super(t,e,n),this.handleEvent=t=>{if(!this.options.enable)return;let e=t.deltaY;se.WheelEvent&&(le&&t.deltaMode===se.WheelEvent.DOM_DELTA_PIXEL&&(e/=se.devicePixelRatio),t.deltaMode===se.WheelEvent.DOM_DELTA_LINE&&(e*=40)),0!==e&&e%he==0&&(e=Math.floor(e/he)),t.shiftKey&&e&&(e*=.25),this.callback({type:ue,center:{x:t.clientX,y:t.clientY},delta:-e,srcEvent:t,pointerType:"mouse",target:t.target})},this.events=(this.options.events||[]).concat(ce),this.events.forEach((e=>t.addEventListener(e,this.handleEvent,!!ae&&{passive:!1})))}destroy(){this.events.forEach((t=>this.element.removeEventListener(t,this.handleEvent)))}enableEventType(t,e){t===ue&&(this.options.enable=e)}}const{MOUSE_EVENTS:fe}=ne,pe="pointermove",ge="pointerover",me="pointerout",_e="pointerenter",ve="pointerleave";class be extends Yt{constructor(t,e,n){super(t,e,n),this.handleEvent=t=>{this.handleOverEvent(t),this.handleOutEvent(t),this.handleEnterEvent(t),this.handleLeaveEvent(t),this.handleMoveEvent(t)},this.pressed=!1;const{enable:i}=this.options;this.enableMoveEvent=i,this.enableLeaveEvent=i,this.enableEnterEvent=i,this.enableOutEvent=i,this.enableOverEvent=i,this.events=(this.options.events||[]).concat(fe),this.events.forEach((e=>t.addEventListener(e,this.handleEvent)))}destroy(){this.events.forEach((t=>this.element.removeEventListener(t,this.handleEvent)))}enableEventType(t,e){t===pe&&(this.enableMoveEvent=e),t===ge&&(this.enableOverEvent=e),t===me&&(this.enableOutEvent=e),t===_e&&(this.enableEnterEvent=e),t===ve&&(this.enableLeaveEvent=e)}handleOverEvent(t){this.enableOverEvent&&"mouseover"===t.type&&this._emit(ge,t)}handleOutEvent(t){this.enableOutEvent&&"mouseout"===t.type&&this._emit(me,t)}handleEnterEvent(t){this.enableEnterEvent&&"mouseenter"===t.type&&this._emit(_e,t)}handleLeaveEvent(t){this.enableLeaveEvent&&"mouseleave"===t.type&&this._emit(ve,t)}handleMoveEvent(t){if(this.enableMoveEvent)switch(t.type){case"mousedown":t.button>=0&&(this.pressed=!0);break;case"mousemove":0===t.which&&(this.pressed=!1),this.pressed||this._emit(pe,t);break;case"mouseup":this.pressed=!1}}_emit(t,e){this.callback({type:t,center:{x:e.clientX,y:e.clientY},srcEvent:e,pointerType:"mouse",target:e.target})}}const{KEY_EVENTS:ye}=ne,we="keydown",xe="keyup";class Ce extends Yt{constructor(t,e,n){super(t,e,n),this.handleEvent=t=>{const e=t.target||t.srcElement;"INPUT"===e.tagName&&"text"===e.type||"TEXTAREA"===e.tagName||(this.enableDownEvent&&"keydown"===t.type&&this.callback({type:we,srcEvent:t,key:t.key,target:t.target}),this.enableUpEvent&&"keyup"===t.type&&this.callback({type:xe,srcEvent:t,key:t.key,target:t.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=(this.options.events||[]).concat(ye),t.tabIndex=this.options.tabIndex||0,t.style.outline="none",this.events.forEach((e=>t.addEventListener(e,this.handleEvent)))}destroy(){this.events.forEach((t=>this.element.removeEventListener(t,this.handleEvent)))}enableEventType(t,e){t===we&&(this.enableDownEvent=e),t===xe&&(this.enableUpEvent=e)}}const ke="contextmenu";class Ee extends Yt{constructor(t,e,n){super(t,e,n),this.handleEvent=t=>{this.options.enable&&this.callback({type:ke,center:{x:t.clientX,y:t.clientY},srcEvent:t,pointerType:"mouse",target:t.target})},t.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(t,e){t===ke&&(this.options.enable=e)}}const Se={pointerdown:1,pointermove:2,pointerup:4,mousedown:1,mousemove:2,mouseup:4};function Ae(t){const e=Se[t.srcEvent.type];if(!e)return null;const{buttons:n,button:i,which:r}=t.srcEvent;let o=!1,s=!1,a=!1;return 4===e||2===e&&!Number.isFinite(n)?(o=1===r,s=2===r,a=3===r):2===e?(o=Boolean(1&n),s=Boolean(4&n),a=Boolean(2&n)):1===e&&(o=0===i,s=1===i,a=2===i),{leftButton:o,middleButton:s,rightButton:a}}function Te(t,e){const n=t.center;if(!n)return null;const i=e.getBoundingClientRect(),r=i.width/e.offsetWidth||1,o=i.height/e.offsetHeight||1;return{center:n,offsetCenter:{x:(n.x-i.left-e.clientLeft)/r,y:(n.y-i.top-e.clientTop)/o}}}const Me={srcElement:"root",priority:0};class De{constructor(t){this.handleEvent=t=>{if(this.isEmpty())return;const e=this._normalizeEvent(t);let n=t.srcEvent.target;for(;n&&n!==e.rootElement;){if(this._emit(e,n),e.handled)return;n=n.parentNode}this._emit(e,"root")},this.eventManager=t,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(t,e,n,i=!1,r=!1){const{handlers:o,handlersByElement:s}=this;let a=Me;"string"==typeof n||n&&n.addEventListener?a={...Me,srcElement:n}:n&&(a={...Me,...n});let l=s.get(a.srcElement);l||(l=[],s.set(a.srcElement,l));const c={type:t,handler:e,srcElement:a.srcElement,priority:a.priority};i&&(c.once=!0),r&&(c.passive=!0),o.push(c),this._active=this._active||!c.passive;let u=l.length-1;for(;u>=0&&!(l[u].priority>=c.priority);)u--;l.splice(u+1,0,c)}remove(t,e){const{handlers:n,handlersByElement:i}=this;for(let r=n.length-1;r>=0;r--){const o=n[r];if(o.type===t&&o.handler===e){n.splice(r,1);const t=i.get(o.srcElement);t.splice(t.indexOf(o),1),0===t.length&&i.delete(o.srcElement)}}this._active=n.some((t=>!t.passive))}_emit(t,e){const n=this.handlersByElement.get(e);if(n){let e=!1;const i=()=>{t.handled=!0},r=()=>{t.handled=!0,e=!0},o=[];for(let s=0;s<n.length;s++){const{type:a,handler:l,once:c}=n[s];if(l({...t,type:a,stopPropagation:i,stopImmediatePropagation:r}),c&&o.push(n[s]),e)break}for(let t=0;t<o.length;t++){const{type:e,handler:n}=o[t];this.remove(e,n)}}}_normalizeEvent(t){const e=this.eventManager.getElement();return{...t,...Ae(t),...Te(t,e),preventDefault:()=>{t.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:e}}}const Pe={events:null,recognizers:null,recognizerOptions:{},Manager:Kt,touchAction:"none",tabIndex:0};class Le{constructor(t=null,e){this._onBasicInput=t=>{const{srcEvent:e}=t,n=ee[e.type];n&&this.manager.emit(n,t)},this._onOtherEvent=t=>{this.manager.emit(t.type,t)},this.options={...Pe,...e},this.events=new Map,this.setElement(t);const{events:n}=this.options;n&&this.on(n)}getElement(){return this.element}setElement(t){if(this.element&&this.destroy(),this.element=t,!t)return;const{options:e}=this,n=e.Manager;this.manager=new n(t,{touchAction:e.touchAction,recognizers:e.recognizers||Qt}).on("hammer.input",this._onBasicInput),e.recognizers||Object.keys(Jt).forEach((t=>{const e=this.manager.get(t);e&&Jt[t].forEach((t=>{e.recognizeWith(t)}))}));for(const t in e.recognizerOptions){const n=this.manager.get(t);if(n){const i=e.recognizerOptions[t];delete i.enable,n.set(i)}}this.wheelInput=new de(t,this._onOtherEvent,{enable:!1}),this.moveInput=new be(t,this._onOtherEvent,{enable:!1}),this.keyInput=new Ce(t,this._onOtherEvent,{enable:!1,tabIndex:e.tabIndex}),this.contextmenuInput=new Ee(t,this._onOtherEvent,{enable:!1});for(const[t,e]of this.events)e.isEmpty()||(this._toggleRecognizer(e.recognizerName,!0),this.manager.on(t,e.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(t,e,n){this._addEventHandler(t,e,n,!1)}once(t,e,n){this._addEventHandler(t,e,n,!0)}watch(t,e,n){this._addEventHandler(t,e,n,!1,!0)}off(t,e){this._removeEventHandler(t,e)}_toggleRecognizer(t,e){const{manager:n}=this;if(!n)return;const i=n.get(t);if(i&&i.options.enable!==e){i.set({enable:e});const r=te[t];r&&!this.options.recognizers&&r.forEach((r=>{const o=n.get(r);e?(o.requireFailure(t),i.dropRequireFailure(r)):o.dropRequireFailure(t)}))}this.wheelInput.enableEventType(t,e),this.moveInput.enableEventType(t,e),this.keyInput.enableEventType(t,e),this.contextmenuInput.enableEventType(t,e)}_addEventHandler(t,e,n,i,r){if("string"!=typeof t){n=e;for(const e in t)this._addEventHandler(e,t[e],n,i,r);return}const{manager:o,events:s}=this,a=re[t]||t;let l=s.get(a);l||(l=new De(this),s.set(a,l),l.recognizerName=ie[a]||a,o&&o.on(a,l.handleEvent)),l.add(t,e,n,i,r),l.isEmpty()||this._toggleRecognizer(l.recognizerName,!0)}_removeEventHandler(t,e){if("string"!=typeof t){for(const e in t)this._removeEventHandler(e,t[e]);return}const{events:n}=this,i=re[t]||t,r=n.get(i);if(r&&(r.remove(t,e),r.isEmpty())){const{recognizerName:t}=r;let e=!1;for(const i of n.values())if(i.recognizerName===t&&!i.isEmpty()){e=!0;break}e||this._toggleRecognizer(t,!1)}}}function Re(){}const Ie={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,glOptions:{},parameters:{},parent:null,gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,onWebGLInitialized:Re,onResize:Re,onViewStateChange:Re,onInteractionStateChange:Re,onBeforeRender:Re,onAfterRender:Re,onLoad:Re,onError:t=>l.Z.error(t.message)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:({isDragging:t})=>t?"grabbing":"grab",getTooltip:null,debug:!1,drawPickingColors:!1};class Oe{constructor(t){(0,i.Z)(this,"props",void 0),(0,i.Z)(this,"width",0),(0,i.Z)(this,"height",0),(0,i.Z)(this,"userData",{}),(0,i.Z)(this,"canvas",null),(0,i.Z)(this,"viewManager",null),(0,i.Z)(this,"layerManager",null),(0,i.Z)(this,"effectManager",null),(0,i.Z)(this,"deckRenderer",null),(0,i.Z)(this,"deckPicker",null),(0,i.Z)(this,"eventManager",null),(0,i.Z)(this,"tooltip",null),(0,i.Z)(this,"metrics",void 0),(0,i.Z)(this,"animationLoop",void 0),(0,i.Z)(this,"stats",void 0),(0,i.Z)(this,"viewState",void 0),(0,i.Z)(this,"cursorState",void 0),(0,i.Z)(this,"_needsRedraw",void 0),(0,i.Z)(this,"_pickRequest",void 0),(0,i.Z)(this,"_lastPointerDownInfo",null),(0,i.Z)(this,"_metricsCounter",void 0),(0,i.Z)(this,"_onPointerMove",(t=>{const{_pickRequest:e}=this;if("pointerleave"===t.type)e.x=-1,e.y=-1,e.radius=0;else{if(t.leftButton||t.rightButton)return;{const n=t.offsetCenter;if(!n)return;e.x=n.x,e.y=n.y,e.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:e.x,y:e.y}),e.event=t})),(0,i.Z)(this,"_onEvent",(t=>{const e=tt.FP[t.type],n=t.offsetCenter;if(!e||!n||!this.layerManager)return;const i=this.layerManager.getLayers(),r=this.deckPicker.getLastPickedObject({x:n.x,y:n.y,layers:i,viewports:this.getViewports(n)},this._lastPointerDownInfo),{layer:o}=r,s=o&&(o[e.handler]||o.props[e.handler]),a=this.props[e.handler];let l=!1;s&&(l=s.call(o,r,t)),!l&&a&&a(r,t)})),(0,i.Z)(this,"_onPointerDown",(t=>{const e=t.offsetCenter,n=this._pick("pickObject","pickObject Time",{x:e.x,y:e.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=n.result[0]||n.emptyInfo})),this.props={...Ie,...t},t=this.props,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this.cursorState={isHovering:!1,isDragging:!1},t.viewState&&t.initialViewState&&l.Z.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),"IE"===(0,Ft.Z)()&&l.Z.warn("IE 11 is not supported")(),this.viewState=t.initialViewState,t.gl||"undefined"!=typeof document&&(this.canvas=this._createCanvas(t)),this.animationLoop=this._createAnimationLoop(t),this.stats=new h.Z({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this.setProps(t),t._typedArrayManagerProps&&Dt.Z.setOptions(t._typedArrayManagerProps),this.animationLoop.start()}finalize(){var t,e,n,i,r,o,s,a;this.animationLoop.stop(),this.animationLoop=null,this._lastPointerDownInfo=null,null===(t=this.layerManager)||void 0===t||t.finalize(),this.layerManager=null,null===(e=this.viewManager)||void 0===e||e.finalize(),this.viewManager=null,null===(n=this.effectManager)||void 0===n||n.finalize(),this.effectManager=null,null===(i=this.deckRenderer)||void 0===i||i.finalize(),this.deckRenderer=null,null===(r=this.deckPicker)||void 0===r||r.finalize(),this.deckPicker=null,null===(o=this.eventManager)||void 0===o||o.destroy(),this.eventManager=null,null===(s=this.tooltip)||void 0===s||s.remove(),this.tooltip=null,this.props.canvas||this.props.gl||!this.canvas||(null===(a=this.canvas.parentElement)||void 0===a||a.removeChild(this.canvas),this.canvas=null)}setProps(t){this.stats.get("setProps Time").timeStart(),"onLayerHover"in t&&l.Z.removed("onLayerHover","onHover")(),"onLayerClick"in t&&l.Z.removed("onLayerClick","onClick")(),t.initialViewState&&!(0,x.v)(this.props.initialViewState,t.initialViewState)&&(this.viewState=t.initialViewState),Object.assign(this.props,t),this._setCanvasSize(this.props);const e=Object.create(this.props);Object.assign(e,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop.setProps(e),this.layerManager&&(this.viewManager.setProps(e),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(e),this.effectManager.setProps(e),this.deckRenderer.setProps(e),this.deckPicker.setProps(e)),this.stats.get("setProps Time").timeEnd()}needsRedraw(t={clearRedrawFlags:!1}){if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let e=this._needsRedraw;t.clearRedrawFlags&&(this._needsRedraw=!1);const n=this.viewManager.needsRedraw(t),i=this.layerManager.needsRedraw(t),r=this.effectManager.needsRedraw(t),o=this.deckRenderer.needsRedraw(t);return e=e||n||i||r||o,e}redraw(t){if(!this.layerManager)return;let e=this.needsRedraw({clearRedrawFlags:!0});e=t||e,e&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(e):this._drawLayers(e))}get isInitialized(){return null!==this.viewManager}getViews(){return(0,D.Z)(this.viewManager),this.viewManager.views}getViewports(t){return(0,D.Z)(this.viewManager),this.viewManager.getViewports(t)}pickObject(t){const e=this._pick("pickObject","pickObject Time",t).result;return e.length?e[0]:null}pickMultipleObjects(t){return t.depth=t.depth||10,this._pick("pickObject","pickMultipleObjects Time",t).result}pickObjects(t){return this._pick("pickObjects","pickObjects Time",t)}_addResources(t,e=!1){for(const n in t)this.layerManager.resourceManager.add({resourceId:n,data:t[n],forceUpdate:e})}_removeResources(t){for(const e of t)this.layerManager.resourceManager.remove(e)}_pick(t,e,n){(0,D.Z)(this.deckPicker);const{stats:i}=this;i.get("Pick Count").incrementCount(),i.get(e).timeStart();const r=this.deckPicker[t]({layers:this.layerManager.getLayers(n),views:this.viewManager.getViews(),viewports:this.getViewports(n),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...n});return i.get(e).timeEnd(),r}_createCanvas(t){let e=t.canvas;return"string"==typeof e&&(e=document.getElementById(e),(0,D.Z)(e)),e||(e=document.createElement("canvas"),e.id=t.id||"deckgl-overlay",(t.parent||document.body).appendChild(e)),Object.assign(e.style,t.style),e}_setCanvasSize(t){if(!this.canvas)return;const{width:e,height:n}=t;if(e||0===e){const t=Number.isFinite(e)?"".concat(e,"px"):e;this.canvas.style.width=t}if(n||0===n){var i;const e=Number.isFinite(n)?"".concat(n,"px"):n;this.canvas.style.position=(null===(i=t.style)||void 0===i?void 0:i.position)||"absolute",this.canvas.style.height=e}}_updateCanvasSize(){const{canvas:t}=this;if(!t)return;const e=t.clientWidth||t.width,n=t.clientHeight||t.height;var i;e===this.width&&n===this.height||(this.width=e,this.height=n,null===(i=this.viewManager)||void 0===i||i.setProps({width:e,height:n}),this.props.onResize({width:e,height:n}))}_createAnimationLoop(t){const{width:e,height:n,gl:i,glOptions:r,debug:o,onError:s,onBeforeRender:a,onAfterRender:l,useDevicePixels:c}=t;return new Zt({width:e,height:n,useDevicePixels:c,autoResizeViewport:!1,gl:i,onCreateContext:t=>(0,q.s9)({...r,...t,canvas:this.canvas,debug:o,onContextLost:()=>this._onContextLost()}),onInitialize:t=>this._setGLContext(t.gl),onRender:this._onRenderFrame.bind(this),onBeforeRender:a,onAfterRender:l,onError:s})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let t=this.props.views||[new I({id:"default-view"})];return t=Array.isArray(t)?t:[t],t.length&&this.props.controller&&(t[0].props.controller=this.props.controller),t}_onContextLost(){const{onError:t}=this.props;this.animationLoop&&t&&t(new Error("WebGL context is lost"))}_pickAndCallback(){const{_pickRequest:t}=this;if(t.event){const{result:n,emptyInfo:i}=this._pick("pickObject","pickObject Time",t);this.cursorState.isHovering=n.length>0;let r=i,o=!1;for(const i of n){var e;r=i,o=(null===(e=i.layer)||void 0===e?void 0:e.onHover(i,t.event))||o}if(!o&&this.props.onHover&&this.props.onHover(r,t.event),this.props.getTooltip&&this.tooltip){const t=this.props.getTooltip(r);this.tooltip.setTooltip(t,r.x,r.y)}t.event=null}}_updateCursor(){const t=this.props.parent||this.canvas;t&&(t.style.cursor=this.props.getCursor(this.cursorState))}_setGLContext(t){if(this.layerManager)return;this.canvas||(this.canvas=t.canvas,(0,q.yW)(t,{enable:!0,copyState:!0})),this.tooltip=new Mt(this.canvas),(0,q.dR)(t,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onWebGLInitialized(t);const e=new s;e.play(),this.animationLoop.attachTimeline(e),this.eventManager=new Le(this.props.parent||t.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const t in tt.FP)this.eventManager.on(t,this._onEvent);this.viewManager=new C({timeline:e,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const n=this.viewManager.getViewports()[0];this.layerManager=new w(t,{deck:this,stats:this.stats,viewport:n,timeline:e}),this.effectManager=new gt,this.deckRenderer=new yt(t),this.deckPicker=new At(t),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(t,e){const{gl:n}=this.layerManager.context;(0,q.dR)(n,this.props.parameters),this.props.onBeforeRender({gl:n}),this.deckRenderer.renderLayers({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",redrawReason:t,effects:this.effectManager.getEffects(),...e}),this.props.onAfterRender({gl:n})}_onRenderFrame(t){this._getFrameStats(),this._metricsCounter++%60==0&&(this._getMetrics(),this.stats.reset(),l.Z.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.tooltip.isVisible&&this.viewManager.needsRedraw()&&this.tooltip.setTooltip(null),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(t){const e=this.props.onViewStateChange(t)||t.viewState;this.viewState&&(this.viewState={...this.viewState,[t.viewId]:e},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(t){this.cursorState.isDragging=t.isDragging||!1,this.props.onInteractionStateChange(t)}_getFrameStats(){const{stats:t}=this;t.get("frameRate").timeEnd(),t.get("frameRate").timeStart();const e=this.animationLoop.stats;t.get("GPU Time").addTime(e.get("GPU Time").lastTiming),t.get("CPU Time").addTime(e.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:t,stats:e}=this;t.fps=e.get("frameRate").getHz(),t.setPropsTime=e.get("setProps Time").time,t.updateAttributesTime=e.get("Update Attributes").time,t.framesRedrawn=e.get("Redraw Count").count,t.pickTime=e.get("pickObject Time").time+e.get("pickMultipleObjects Time").time+e.get("pickObjects Time").time,t.pickCount=e.get("Pick Count").count,t.gpuTime=e.get("GPU Time").time,t.cpuTime=e.get("CPU Time").time,t.gpuTimePerFrame=e.get("GPU Time").getAverageTime(),t.cpuTimePerFrame=e.get("CPU Time").getAverageTime();const n=Bt.lR.get("Memory Usage");t.bufferMemory=n.get("Buffer Memory").count,t.textureMemory=n.get("Texture Memory").count,t.renderbufferMemory=n.get("Renderbuffer Memory").count,t.gpuMemory=n.get("GPU Memory").count}}(0,i.Z)(Oe,"defaultProps",Ie),(0,i.Z)(Oe,"VERSION",zt.VERSION)},3693:(t,e,n)=>{"use strict";n.d(e,{Z:()=>o});var i=n(4942),r=n(6871);class o{constructor(t){(0,i.Z)(this,"opts",void 0),t&&(this.opts=t)}equals(t){return this===t||this.constructor===t.constructor&&(0,r.v)(this.opts,t.opts)}getShaders(t){return null}getSubLayerProps(t){const{defaultProps:e}=t.constructor,n={updateTriggers:{}};for(const t in e)if(t in this.props){const i=e[t],r=this.props[t];n[t]=r,i&&"accessor"===i.type&&(n.updateTriggers[t]=this.props.updateTriggers[t],"function"==typeof r&&(n[t]=this.getSubLayerAccessor(r)))}return n}initializeState(t,e){}updateState(t,e){}draw(t,e){}finalizeState(t,e){}}(0,i.Z)(o,"defaultProps",{})},5522:(t,e,n)=>{"use strict";n.d(e,{Z:()=>Qt});var i=n(4942),r=n(4088),o=n(8271),s=n(6948),a=n(3478);class l{constructor(t,e){(0,i.Z)(this,"opts",void 0),(0,i.Z)(this,"source",void 0),this.opts=e,this.source=t}get value(){return this.source.value}getValue(){const t=this.source.getBuffer(),e=this.getAccessor();if(t)return[t,e];const{value:n}=this.source,{size:i}=e;let r=n;if(n&&n.length!==i){r=new Float32Array(i);const t=e.elementOffset||0;for(let e=0;e<i;++e)r[e]=n[t+e]}return r}getAccessor(){return{...this.source.getAccessor(),...this.opts}}}var c=n(6610),u=n(5126),h=n(744);function d(t){return t.stride||t.size*t.bytesPerElement}function f(t,e){e.offset&&h.Z.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const n=d(t),i=(void 0!==e.vertexOffset?e.vertexOffset:t.vertexOffset||0)*n+(e.elementOffset||0)*t.bytesPerElement+(t.offset||0);return{...e,offset:i,stride:n}}var p=n(5304),g=n(8550),m=n(1855);const _=[],v=[[0,1/0]];function b(t){const{source:e,target:n,start:i=0,size:r,getData:o}=t,s=t.end||n.length,a=e.length,l=s-i;if(a>l)return void n.set(e.subarray(0,l),i);if(n.set(e,i),!o)return;let c=a;for(;c<l;){const t=o(c,e);for(let e=0;e<r;e++)n[i+c]=t[e]||0,c++}}const y={interpolation:{duration:0,easing:t=>t},spring:{stiffness:.05,damping:.5}};function w(t,e){if(!t)return null;Number.isFinite(t)&&(t={type:"interpolation",duration:t});const n=t.type||"interpolation";return{...y[n],...e,...t,type:n}}function x(t,e){const n=e.getBuffer();return n?[n,{divisor:0,size:e.size,normalized:e.settings.normalized}]:e.value}function C(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(t,'"'))}}function k(t){t.push(t.shift())}function E(t,e){const{doublePrecision:n,settings:i,value:r,size:o}=t,s=n&&r instanceof Float64Array?2:1;return(i.noAlloc?r.length:e*o)*s}function S({buffer:t,numInstances:e,attribute:n,fromLength:i,fromStartIndices:r,getData:o=(t=>t)}){const s=n.doublePrecision&&n.value instanceof Float64Array?2:1,a=n.size*s,l=n.byteOffset,c=n.startIndices,u=r&&c,h=E(n,e),d=n.isConstant;if(!u&&i>=h)return;const f=d?n.value:n.getBuffer().getData({srcByteOffset:l});if(n.settings.normalized&&!d){const t=o;o=(e,i)=>n.normalizeConstant(t(e,i))}const p=d?(t,e)=>o(f,e):(t,e)=>o(f.subarray(t,t+a),e),g=t.getData({length:i}),m=new Float32Array(h);!function({source:t,target:e,size:n,getData:i,sourceStartIndices:r,targetStartIndices:o}){if(!Array.isArray(o))return b({source:t,target:e,size:n,getData:i}),e;let s=0,a=0;const l=i&&((t,e)=>i(t+a,e)),c=Math.min(r.length,o.length);for(let i=1;i<c;i++){const c=r[i]*n,u=o[i]*n;b({source:t.subarray(s,c),target:e,start:a,end:u,size:n,getData:l}),s=c,a=u}a<e.length&&b({source:[],target:e,start:a,size:n,getData:l})}({source:g,target:m,sourceStartIndices:r,targetStartIndices:c,size:a,getData:p}),t.byteLength<m.byteLength+l&&t.reallocate(m.byteLength+l),t.subData({data:m,offset:l})}class A extends class{constructor(t,e,n){(0,i.Z)(this,"gl",void 0),(0,i.Z)(this,"id",void 0),(0,i.Z)(this,"size",void 0),(0,i.Z)(this,"settings",void 0),(0,i.Z)(this,"value",void 0),(0,i.Z)(this,"doublePrecision",void 0),(0,i.Z)(this,"_buffer",void 0),(0,i.Z)(this,"state",void 0),this.gl=t,this.id=e.id||"",this.size=e.size||1;const r=e.logicalType||e.type,a=5130===r;let l,{defaultValue:c}=e;c=Number.isFinite(c)?[c]:c||new Array(this.size).fill(0),l=a?5126:!r&&e.isIndexed?t&&(0,o.U6)(t,s.h.ELEMENT_INDEX_UINT32)?5125:5123:r||5126;let u=function(t){switch(t){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}(r||l||5126);this.doublePrecision=a,a&&!1===e.fp64&&(u=Float32Array),this.value=null,this.settings={...e,defaultType:u,defaultValue:c,logicalType:r,type:l,size:this.size,bytesPerElement:u.BYTES_PER_ELEMENT},this.state={...n,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1},this._buffer=null}get isConstant(){return this.state.constant}get buffer(){if(!this._buffer){const{isIndexed:t,type:e}=this.settings;this._buffer=new a.Z(this.gl,{id:this.id,target:t?34963:34962,accessor:{type:e}})}return this._buffer}get byteOffset(){const t=this.getAccessor();return t.vertexOffset?t.vertexOffset*d(t):0}get numInstances(){return this.state.numInstances}set numInstances(t){this.state.numInstances=t}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),c.Z.release(this.state.allocatedValue)}getShaderAttributes(t,e){if(this.doublePrecision){const n={},i=this.value instanceof Float64Array,r=function(t,e){const n=f(t,e);return{high:n,low:{...n,offset:n.offset+4*t.size}}}(this.getAccessor(),e||{});return n[t]=new l(this,r.high),n["".concat(t,"64Low")]=i?new l(this,r.low):new Float32Array(this.size),n}if(e){const n=f(this.getAccessor(),e);return{[t]:new l(this,n)}}return{[t]:this}}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let t=null;if(this.state.constant&&this.value){const e=Array.from(this.value);t=[e,e]}else{const{value:e,numInstances:n,size:i}=this,r=n*i;if(e&&r&&e.length>=r){const n=new Array(i).fill(1/0),o=new Array(i).fill(-1/0);for(let t=0;t<r;)for(let r=0;r<i;r++){const i=e[t++];i<n[r]&&(n[r]=i),i>o[r]&&(o[r]=i)}t=[n,o]}}return this.state.bounds=t,t}setData(t){const{state:e}=this;let n;n=ArrayBuffer.isView(t)?{value:t}:t instanceof a.Z?{buffer:t}:t;const i={...this.settings,...n};if(e.bufferAccessor=i,e.bounds=null,n.constant){let t=n.value;if(t=this._normalizeValue(t,[],0),this.settings.normalized&&(t=this.normalizeConstant(t)),e.constant&&this._areValuesEqual(t,this.value))return!1;e.externalBuffer=null,e.constant=!0,this.value=t}else if(n.buffer){const t=n.buffer;e.externalBuffer=t,e.constant=!1,this.value=n.value||null;const r=n.value instanceof Float64Array;i.type=n.type||t.accessor.type,i.bytesPerElement=t.accessor.BYTES_PER_ELEMENT*(r?2:1),i.stride=d(i)}else if(n.value){this._checkExternalBuffer(n);let t=n.value;e.externalBuffer=null,e.constant=!1,this.value=t,i.bytesPerElement=t.BYTES_PER_ELEMENT,i.stride=d(i);const{buffer:r,byteOffset:o}=this;this.doublePrecision&&t instanceof Float64Array&&(t=(0,u.TK)(t,i));const s=t.byteLength+o+2*i.stride;r.byteLength<s&&r.reallocate(s),r.setAccessor(null),r.subData({data:t,offset:o}),i.type=n.type||r.accessor.type}return!0}updateSubBuffer(t={}){this.state.bounds=null;const e=this.value,{startOffset:n=0,endOffset:i}=t;this.buffer.subData({data:this.doublePrecision&&e instanceof Float64Array?(0,u.TK)(e,{size:this.size,startIndex:n,endIndex:i}):e.subarray(n,i),offset:n*e.BYTES_PER_ELEMENT+this.byteOffset})}allocate(t,e=!1){const{state:n}=this,i=n.allocatedValue,r=c.Z.allocate(i,t+1,{size:this.size,type:this.settings.defaultType,copy:e});this.value=r;const{buffer:o,byteOffset:s}=this;return o.byteLength<r.byteLength+s&&(o.reallocate(r.byteLength+s),e&&i&&o.subData({data:i instanceof Float64Array?(0,u.TK)(i,this):i,offset:s})),n.allocatedValue=r,n.constant=!1,n.externalBuffer=null,n.bufferAccessor=this.settings,!0}_checkExternalBuffer(t){const{value:e}=t;if(!ArrayBuffer.isView(e))throw new Error("Attribute ".concat(this.id," value is not TypedArray"));const n=this.settings.defaultType;let i=!1;if(this.doublePrecision&&(i=e.BYTES_PER_ELEMENT<4),i)throw new Error("Attribute ".concat(this.id," does not support ").concat(e.constructor.name));e instanceof n||!this.settings.normalized||"normalized"in t||h.Z.warn("Attribute ".concat(this.id," is normalized"))()}normalizeConstant(t){switch(this.settings.type){case 5120:return new Float32Array(t).map((t=>(t+128)/255*2-1));case 5122:return new Float32Array(t).map((t=>(t+32768)/65535*2-1));case 5121:return new Float32Array(t).map((t=>t/255));case 5123:return new Float32Array(t).map((t=>t/65535));default:return t}}_normalizeValue(t,e,n){const{defaultValue:i,size:r}=this.settings;if(Number.isFinite(t))return e[n]=t,e;if(!t)return e[n]=i[0],e;switch(r){case 4:e[n+3]=Number.isFinite(t[3])?t[3]:i[3];case 3:e[n+2]=Number.isFinite(t[2])?t[2]:i[2];case 2:e[n+1]=Number.isFinite(t[1])?t[1]:i[1];case 1:e[n+0]=Number.isFinite(t[0])?t[0]:i[0];break;default:let o=r;for(;--o>=0;)e[n+o]=Number.isFinite(t[o])?t[o]:i[o]}return e}_areValuesEqual(t,e){if(!t||!e)return!1;const{size:n}=this;for(let i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}}{constructor(t,e){super(t,e,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:v}),(0,i.Z)(this,"constant",!1),this.settings.update=e.update||(e.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(t){this.state.startIndices=t}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:t=!1}={}){const e=this.state.needsRedraw;return this.state.needsRedraw=e&&!t,e}getUpdateTriggers(){const{accessor:t}=this.settings;return[this.id].concat("function"!=typeof t&&t||[])}supportsTransition(){return Boolean(this.settings.transition)}getTransitionSetting(t){if(!t||!this.supportsTransition())return null;const{accessor:e}=this.settings,n=this.settings.transition;return w(Array.isArray(e)?t[e.find((e=>t[e]))]:t[e],n)}setNeedsUpdate(t=this.id,e){if(this.state.needsUpdate=this.state.needsUpdate||t,this.setNeedsRedraw(t),e){const{startRow:t=0,endRow:n=1/0}=e;this.state.updateRanges=function(t,e){if(t===v)return t;if(e[0]<0&&(e[0]=0),e[0]>=e[1])return t;const n=[],i=t.length;let r=0;for(let o=0;o<i;o++){const i=t[o];i[1]<e[0]?(n.push(i),r=o+1):i[0]>e[1]?n.push(i):e=[Math.min(i[0],e[0]),Math.max(i[1],e[1])]}return n.splice(r,0,e),n}(this.state.updateRanges,[t,n])}else this.state.updateRanges=v}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=_}setNeedsRedraw(t=this.id){this.state.needsRedraw=this.state.needsRedraw||t}allocate(t){const{state:e,settings:n}=this;return!n.noAlloc&&!!n.update&&(super.allocate(t,e.updateRanges!==v),!0)}updateBuffer({numInstances:t,data:e,props:n,context:i}){if(!this.needsUpdate())return!1;const{state:{updateRanges:r},settings:{update:o,noAlloc:s}}=this;let a=!0;if(o){for(const[s,a]of r)o.call(i,this,{data:e,startRow:s,endRow:a,props:n,numInstances:t});if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[e,n]of r){const i=Number.isFinite(e)?this.getVertexOffset(e):0,r=Number.isFinite(n)?this.getVertexOffset(n):s||!Number.isFinite(t)?this.value.length:t*this.size;super.updateSubBuffer({startOffset:i,endOffset:r})}this._checkAttributeArray()}else a=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),a}setConstantValue(t){return void 0!==t&&"function"!=typeof t&&(this.setData({constant:!0,value:t})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(t){const{state:e}=this;return t?(this.clearNeedsUpdate(),e.lastExternalBuffer===t||(e.lastExternalBuffer=t,this.setNeedsRedraw(),this.setData(t)),!0):(e.lastExternalBuffer=null,!1)}setBinaryValue(t,e=null){const{state:n,settings:i}=this;if(!t)return n.binaryValue=null,n.binaryAccessor=null,!1;if(i.noAlloc)return!1;if(n.binaryValue===t)return this.clearNeedsUpdate(),!0;if(n.binaryValue=t,this.setNeedsRedraw(),i.transform||e!==this.startIndices){ArrayBuffer.isView(t)&&(t={value:t});const r=t;(0,p.Z)(ArrayBuffer.isView(r.value),"invalid ".concat(i.accessor));const o=Boolean(r.size)&&r.size!==this.size;return n.binaryAccessor=(0,g.jr)(r.value,{size:r.size||this.size,stride:r.stride,offset:r.offset,startIndices:e,nested:o}),!1}return this.clearNeedsUpdate(),this.setData(t),!0}getVertexOffset(t){const{startIndices:e}=this;return(e?t<e.length?e[t]:this.numInstances:t)*this.size}getShaderAttributes(){const t=this.settings.shaderAttributes||{[this.id]:null},e={};for(const n in t)Object.assign(e,super.getShaderAttributes(n,t[n]));return e}_autoUpdater(t,{data:e,startRow:n,endRow:i,props:r,numInstances:o}){if(t.constant)return;const{settings:s,state:a,value:l,size:c,startIndices:u}=t,{accessor:h,transform:d}=s,f=a.binaryAccessor||("function"==typeof h?h:r[h]);(0,p.Z)("function"==typeof f,'accessor "'.concat(h,'" is not a function'));let _=t.getVertexOffset(n);const{iterable:v,objectInfo:b}=(0,g.jB)(e,n,i);for(const e of v){b.index++;let n=f(e,b);if(d&&(n=d.call(this,n)),u){const e=(b.index<u.length-1?u[b.index+1]:o)-u[b.index];if(n&&Array.isArray(n[0])){let e=_;for(const i of n)t._normalizeValue(i,l,e),e+=c}else n&&n.length>c?l.set(n,_):(t._normalizeValue(n,b.target,0),(0,m.k)({target:l,source:b.target,start:_,count:e}));_+=e*c}else t._normalizeValue(n,l,_),_+=c}}_validateAttributeUpdaters(){const{settings:t}=this;if(!t.noAlloc&&"function"!=typeof t.update)throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:t}=this,e=Math.min(4,this.size);if(t&&t.length>=e){let n=!0;switch(e){case 4:n=n&&Number.isFinite(t[3]);case 3:n=n&&Number.isFinite(t[2]);case 2:n=n&&Number.isFinite(t[1]);case 1:n=n&&Number.isFinite(t[0]);break;default:n=!1}if(!n)throw new Error("Illegal attribute generated for ".concat(this.id))}}}var T=n(3803),M=n(9047);const D="void main() {gl_FragColor = vec4(0);}",P="out vec4 transform_output;\nvoid main() {\n  transform_output = vec4(0);\n}",L="#version 300 es\n".concat(P);function R(t,e){e=Array.isArray(e)?e:[e];const n=t.replace(/^\s+/,"").split(/\s+/),[i,r,o]=n;return e.includes(i)&&r&&o?{qualifier:i,type:r,name:o.split(";")[0]}:null}function I(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{version:e=100,input:n,inputType:i,output:r}=t;if(!n)return 300===e?L:e>300?"#version ".concat(e,"\n").concat(P):D;const o=O(n,i);return e>=300?"#version ".concat(e," ").concat(300===e?"es":"","\nin ").concat(i," ").concat(n,";\nout vec4 ").concat(r,";\nvoid main() {\n  ").concat(r," = ").concat(o,";\n}"):"varying ".concat(i," ").concat(n,";\nvoid main() {\n  gl_FragColor = ").concat(o,";\n}")}function O(t,e){switch(e){case"float":return"vec4(".concat(t,", 0.0, 0.0, 1.0)");case"vec2":return"vec4(".concat(t,", 0.0, 1.0)");case"vec3":return"vec4(".concat(t,", 1.0)");case"vec4":return t;default:return(0,M.Z)(!1),null}}var z=n(9450),F=n(1053),B=n(2525);class N{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.gl=t,this.currentIndex=0,this.feedbackMap={},this.varyings=null,this.bindings=[],this.resources={},this._initialize(e),Object.seal(this)}setupResources(t){for(const e of this.bindings)this._setupTransformFeedback(e,t)}updateModelProps(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{varyings:e}=this;return e.length>0&&(t=Object.assign({},t,{varyings:e})),t}getDrawOptions(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e=this.bindings[this.currentIndex],{sourceBuffers:n,transformFeedback:i}=e;return{attributes:Object.assign({},n,t.attributes),transformFeedback:i}}swap(){return!!this.feedbackMap&&(this.currentIndex=this._getNextIndex(),!0)}update(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._setupBuffers(t)}getBuffer(t){const{feedbackBuffers:e}=this.bindings[this.currentIndex],n=t?e[t]:null;return n?n instanceof a.Z?n:n.buffer:null}getData(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{varyingName:e}=t,n=this.getBuffer(e);return n?n.getData():null}delete(){for(const t in this.resources)this.resources[t].delete()}_initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._setupBuffers(t),this.varyings=t.varyings||Object.keys(this.bindings[this.currentIndex].feedbackBuffers),this.varyings.length>0&&(0,B.h)((0,z.D0)(this.gl))}_getFeedbackBuffers(t){const{sourceBuffers:e={}}=t,n={};if(this.bindings[this.currentIndex]&&Object.assign(n,this.bindings[this.currentIndex].feedbackBuffers),this.feedbackMap)for(const t in this.feedbackMap){const i=this.feedbackMap[t];t in e&&(n[i]=t)}Object.assign(n,t.feedbackBuffers);for(const t in n){const i=n[t];if("string"==typeof i){const r=e[i],{byteLength:o,usage:s,accessor:a}=r;n[t]=this._createNewBuffer(t,{byteLength:o,usage:s,accessor:a})}}return n}_setupBuffers(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{sourceBuffers:e=null}=t;Object.assign(this.feedbackMap,t.feedbackMap);const n=this._getFeedbackBuffers(t);this._updateBindings({sourceBuffers:e,feedbackBuffers:n})}_setupTransformFeedback(t,e){let{model:n}=e;const{program:i}=n;t.transformFeedback=new F.Z(this.gl,{program:i,buffers:t.feedbackBuffers})}_updateBindings(t){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],t),this.feedbackMap){const{sourceBuffers:t,feedbackBuffers:e}=this._swapBuffers(this.bindings[this.currentIndex]),n=this._getNextIndex();this.bindings[n]=this._updateBinding(this.bindings[n],{sourceBuffers:t,feedbackBuffers:e})}}_updateBinding(t,e){return t?(Object.assign(t.sourceBuffers,e.sourceBuffers),Object.assign(t.feedbackBuffers,e.feedbackBuffers),t.transformFeedback&&t.transformFeedback.setBuffers(t.feedbackBuffers),t):{sourceBuffers:Object.assign({},e.sourceBuffers),feedbackBuffers:Object.assign({},e.feedbackBuffers)}}_swapBuffers(t){if(!this.feedbackMap)return null;const e=Object.assign({},t.sourceBuffers),n=Object.assign({},t.feedbackBuffers);for(const i in this.feedbackMap){const r=this.feedbackMap[i];e[i]=t.feedbackBuffers[r],n[r]=t.sourceBuffers[i],(0,B.h)(n[r]instanceof a.Z)}return{sourceBuffers:e,feedbackBuffers:n}}_createNewBuffer(t,e){const n=new a.Z(this.gl,e);return this.resources[t]&&this.resources[t].delete(),this.resources[t]=n,n}_getNextIndex(){return(this.currentIndex+1)%2}}var j=n(1953),U=n(4912),V=n(3849),W=n(3028);function H(t){let e=100;const n=t.match(/[^\s]+/g);if(n.length>=2&&"#version"===n[0]){const t=parseInt(n[1],10);Number.isFinite(t)&&(e=t)}return e}var $=n(6713);const Z={name:"transform",vs:"attribute float transform_elementID;\nvec2 transform_getPixelSizeHalf(vec2 size) {\n  return vec2(1.) / (2. * size);\n}\n\nvec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {\n  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);\n  float xIndex = transform_elementID - (yIndex * texSize[0]);\n  return vec2(xIndex, yIndex);\n}\nvec2 transform_getTexCoord(vec2 size) {\n  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);\n  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);\n  vec2 coord = indices / size + pixelSizeHalf;\n  return coord;\n}\nvec2 transform_getPos(vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);\n  return pos;\n}\nvec4 transform_getInput(sampler2D texSampler, vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  vec4 textureColor = texture2D(texSampler, texCoord);\n  return textureColor;\n}\n",fs:null},q="transform_uSize_",G="transform_position";const K={10241:9728,10240:9728,10242:33071,10243:33071};class X{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.gl=t,this.id=this.currentIndex=0,this._swapTexture=null,this.targetTextureVarying=null,this.targetTextureType=null,this.samplerTextureMap=null,this.bindings=[],this.resources={},this._initialize(e),Object.seal(this)}updateModelProps(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e=this._processVertexShader(t);return Object.assign({},t,e)}getDrawOptions(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{sourceBuffers:e,sourceTextures:n,framebuffer:i,targetTexture:r}=this.bindings[this.currentIndex],o=Object.assign({},e,t.attributes),s=Object.assign({},t.uniforms),a=Object.assign({},t.parameters);let l=t.discard;if(this.hasSourceTextures||this.hasTargetTexture){o.transform_elementID=this.elementIDBuffer;for(const t in this.samplerTextureMap){const e=this.samplerTextureMap[t];s[t]=n[e]}this._setSourceTextureParameters();const t=function(t){let{sourceTextureMap:e,targetTextureVarying:n,targetTexture:i}=t;const r={};let o,s;n&&(({width:o,height:s}=i),r["".concat(q).concat(n)]=[o,s]);for(const t in e)({width:o,height:s}=e[t]),r["".concat(q).concat(t)]=[o,s];return r}({sourceTextureMap:n,targetTextureVarying:this.targetTextureVarying,targetTexture:r});Object.assign(s,t)}return this.hasTargetTexture&&(l=!1,a.viewport=[0,0,i.width,i.height]),{attributes:o,framebuffer:i,uniforms:s,discard:l,parameters:a}}swap(){return!!this._swapTexture&&(this.currentIndex=this._getNextIndex(),!0)}update(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._setupTextures(t)}getTargetTexture(){const{targetTexture:t}=this.bindings[this.currentIndex];return t}getData(){let{packed:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{framebuffer:e}=this.bindings[this.currentIndex],n=(0,j.z6)(e);if(!t)return n;const i=n.constructor,r=function(t){switch(t){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return(0,M.Z)(!1),null}}(this.targetTextureType),o=new i(n.length*r/4);let s=0;for(let t=0;t<n.length;t+=4)for(let e=0;e<r;e++)o[s++]=n[t+e];return o}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}delete(){this.ownTexture&&this.ownTexture.delete(),this.elementIDBuffer&&this.elementIDBuffer.delete()}_initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{_targetTextureVarying:e,_swapTexture:n}=t;this._swapTexture=n,this.targetTextureVarying=e,this.hasTargetTexture=e,this._setupTextures(t)}_createTargetTexture(t){const{sourceTextures:e,textureOrReference:n}=t;if(n instanceof U.Z)return n;const i=e[n];return i?(this._targetRefTexName=n,this._createNewTexture(i)):null}_setupTextures(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{sourceBuffers:e,_sourceTextures:n={},_targetTexture:i}=t,r=this._createTargetTexture({sourceTextures:n,textureOrReference:i});this.hasSourceTextures=this.hasSourceTextures||n&&Object.keys(n).length>0,this._updateBindings({sourceBuffers:e,sourceTextures:n,targetTexture:r}),"elementCount"in t&&this._updateElementIDBuffer(t.elementCount)}_updateElementIDBuffer(t){if("number"!=typeof t||this.elementCount>=t)return;const e=new Float32Array(t);e.forEach(((t,e,n)=>{n[e]=e})),this.elementIDBuffer?this.elementIDBuffer.setData({data:e}):this.elementIDBuffer=new a.Z(this.gl,{data:e,accessor:{size:1}}),this.elementCount=t}_updateBindings(t){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],t),this._swapTexture){const{sourceTextures:t,targetTexture:e}=this._swapTextures(this.bindings[this.currentIndex]),n=this._getNextIndex();this.bindings[n]=this._updateBinding(this.bindings[n],{sourceTextures:t,targetTexture:e})}}_updateBinding(t,e){const{sourceBuffers:n,sourceTextures:i,targetTexture:r}=e;if(t||(t={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(t.sourceTextures,i),Object.assign(t.sourceBuffers,n),r){t.targetTexture=r;const{width:e,height:n}=r,{framebuffer:i}=t;i?(i.update({attachments:{36064:r},resizeAttachments:!1}),i.resize({width:e,height:n})):t.framebuffer=new V.Z(this.gl,{id:"transform-framebuffer",width:e,height:n,attachments:{36064:r}})}return t}_setSourceTextureParameters(){const t=this.currentIndex,{sourceTextures:e}=this.bindings[t];for(const t in e)e[t].setParameters(K)}_swapTextures(t){if(!this._swapTexture)return null;const e=Object.assign({},t.sourceTextures);return e[this._swapTexture]=t.targetTexture,{sourceTextures:e,targetTexture:t.sourceTextures[this._swapTexture]}}_createNewTexture(t){const e=(0,W.h)(t,{parameters:{10241:9728,10240:9728,10242:33071,10243:33071},pixelStore:{37440:!1}});return this.ownTexture&&this.ownTexture.delete(),this.ownTexture=e,e}_getNextIndex(){return(this.currentIndex+1)%2}_processVertexShader(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{sourceTextures:e,targetTexture:n}=this.bindings[this.currentIndex],{vs:i,uniforms:r,targetTextureType:o,inject:s,samplerTextureMap:a}=function(t){let{vs:e,sourceTextureMap:n,targetTextureVarying:i,targetTexture:r}=t,o=Object.keys(n).length,s=null;const a={};let l=e,c={};if(o>0||i){const t=l.split("\n"),e=t.slice();if(t.forEach(((t,r,l)=>{if(o>0){const i=function(t,e){const n={},i=function(t){return R(t,["attribute","in"])}(t);if(!i)return null;const{type:r,name:o}=i;if(o&&e[o]){const e="// ".concat(t," => Replaced by Transform with a sampler"),{samplerName:i,sizeName:s,uniformDeclerations:a}=function(t){const e="".concat("transform_uSampler_").concat(t),n="".concat(q).concat(t);return{samplerName:e,sizeName:n,uniformDeclerations:"  uniform sampler2D ".concat(e,";\n  uniform vec2 ").concat(n,";")}}(o),l=function(t){switch(t){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return(0,M.Z)(!1),null}}(r),c="  ".concat(r," ").concat(o," = transform_getInput(").concat(i,", ").concat(s,").").concat(l,";\n");return n[i]=o,{updatedLine:e,inject:{"vs:#decl":a,"vs:#main-start":c},samplerTextureMap:n}}return null}(t,n);if(i){const{updatedLine:t,inject:n}=i;e[r]=t,c=(0,$.Lm)([c,n]),Object.assign(a,i.samplerTextureMap),o--}}i&&!s&&(s=function(t,e){const n=R(t,["varying","out"]);return n&&n.name===e?n.type:null}(t,i))})),i){(0,B.h)(r);const t="".concat(q).concat(i),e={"vs:#decl":"uniform vec2 ".concat(t,";\n"),"vs:#main-start":"     vec2 ".concat(G," = transform_getPos(").concat(t,");\n     gl_Position = vec4(").concat(G,", 0, 1.);\n")};c=(0,$.Lm)([c,e])}l=e.join("\n")}return{vs:l,targetTextureType:s,inject:c,samplerTextureMap:a}}({vs:t.vs,sourceTextureMap:e,targetTextureVarying:this.targetTextureVarying,targetTexture:n}),l=(0,$.Lm)([t.inject||{},s]);return this.targetTextureType=o,this.samplerTextureMap=a,{vs:i,fs:t._fs||I({version:H(i),input:this.targetTextureVarying,inputType:o,output:"transform_output"}),modules:this.hasSourceTextures||this.targetTextureVarying?[Z].concat(t.modules||[]):t.modules,uniforms:r,inject:l}}}var Y=n(8474),Q=n(9769);class J{static isSupported(t){return(0,z.D0)(t)}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.gl=t,this.model=null,this.elementCount=0,this.bufferTransform=null,this.textureTransform=null,this.elementIDBuffer=null,this._initialize(e),Object.seal(this)}delete(){const{model:t,bufferTransform:e,textureTransform:n}=this;t&&t.delete(),e&&e.delete(),n&&n.delete()}run(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{clearRenderTarget:e=!0}=t,n=this._updateDrawOptions(t);e&&n.framebuffer&&n.framebuffer.clear({color:!0}),this.model.transform(n)}swap(){let t=!1;const e=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const n of e)t=t||n.swap();(0,B.h)(t,"Nothing to swap")}getBuffer(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this.bufferTransform&&this.bufferTransform.getBuffer(t)}getData(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const n of e){const e=n.getData(t);if(e)return e}return null}getFramebuffer(){return this.textureTransform&&this.textureTransform.getFramebuffer()}update(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"elementCount"in t&&this.model.setVertexCount(t.elementCount);const e=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const n of e)n.update(t)}_initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{gl:e}=this;this._buildResourceTransforms(e,t),t=this._updateModelProps(t),this.model=new Q.Z(e,Object.assign({},t,{fs:t.fs||I({version:H(t.vs)}),id:t.id||"transform-model",drawMode:t.drawMode||0,vertexCount:t.elementCount})),this.bufferTransform&&this.bufferTransform.setupResources({model:this.model})}_updateModelProps(t){let e=Object.assign({},t);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const t of n)e=t.updateModelProps(e);return e}_buildResourceTransforms(t,e){(function(t){return!((0,Y.nK)(t.feedbackBuffers)&&(0,Y.nK)(t.feedbackMap)&&!(t.varyings&&t.varyings.length>0))})(e)&&(this.bufferTransform=new N(t,e)),function(t){return!((0,Y.nK)(t._sourceTextures)&&!t._targetTexture&&!t._targetTextureVarying)}(e)&&(this.textureTransform=new X(t,e)),(0,B.h)(this.bufferTransform||this.textureTransform,"must provide source/feedback buffers or source/target textures")}_updateDrawOptions(t){let e=Object.assign({},t);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const t of n)e=Object.assign(e,t.getDrawOptions(e));return e}}var tt=n(3630);const et={interpolation:class{constructor({gl:t,attribute:e,timeline:n}){(0,i.Z)(this,"gl",void 0),(0,i.Z)(this,"type","interpolation"),(0,i.Z)(this,"attributeInTransition",void 0),(0,i.Z)(this,"settings",void 0),(0,i.Z)(this,"attribute",void 0),(0,i.Z)(this,"transition",void 0),(0,i.Z)(this,"currentStartIndices",void 0),(0,i.Z)(this,"currentLength",void 0),(0,i.Z)(this,"transform",void 0),(0,i.Z)(this,"buffers",void 0),this.gl=t,this.transition=new tt.Z(n),this.attribute=e,this.attributeInTransition=new A(t,e.settings),this.currentStartIndices=e.startIndices,this.currentLength=0,this.transform=function(t,e){const n=C(e.size);return new J(t,{vs:"\n#define SHADER_NAME interpolation-transition-vertex-shader\n\nuniform float time;\nattribute ATTRIBUTE_TYPE aFrom;\nattribute ATTRIBUTE_TYPE aTo;\nvarying ATTRIBUTE_TYPE vCurrent;\n\nvoid main(void) {\n  vCurrent = mix(aFrom, aTo, time);\n  gl_Position = vec4(0.0);\n}\n",defines:{ATTRIBUTE_TYPE:n},varyings:["vCurrent"]})}(t,e);const r={byteLength:0,usage:35050};this.buffers=[new a.Z(t,r),new a.Z(t,r)]}get inProgress(){return this.transition.inProgress}start(t,e){if(t.duration<=0)return void this.transition.cancel();this.settings=t;const{gl:n,buffers:i,attribute:r}=this;k(i);const o={numInstances:e,attribute:r,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:t.enter};for(const t of i)S({buffer:t,...o});this.currentStartIndices=r.startIndices,this.currentLength=E(r,e),this.attributeInTransition.setData({buffer:i[1],value:r.value}),this.transition.start(t),this.transform.update({elementCount:Math.floor(this.currentLength/r.size),sourceBuffers:{aFrom:i[0],aTo:x(0,r)},feedbackBuffers:{vCurrent:i[1]}})}update(){const t=this.transition.update();if(t){const{duration:t,easing:e}=this.settings,{time:n}=this.transition;let i=n/t;e&&(i=e(i)),this.transform.run({uniforms:{time:i}})}return t}cancel(){this.transition.cancel(),this.transform.delete();for(const t of this.buffers)t.delete();this.buffers.length=0}},spring:class{constructor({gl:t,attribute:e,timeline:n}){(0,i.Z)(this,"gl",void 0),(0,i.Z)(this,"type","spring"),(0,i.Z)(this,"attributeInTransition",void 0),(0,i.Z)(this,"settings",void 0),(0,i.Z)(this,"attribute",void 0),(0,i.Z)(this,"transition",void 0),(0,i.Z)(this,"currentStartIndices",void 0),(0,i.Z)(this,"currentLength",void 0),(0,i.Z)(this,"texture",void 0),(0,i.Z)(this,"framebuffer",void 0),(0,i.Z)(this,"transform",void 0),(0,i.Z)(this,"buffers",void 0),this.gl=t,this.type="spring",this.transition=new tt.Z(n),this.attribute=e,this.attributeInTransition=new A(t,{...e.settings,normalized:!1}),this.currentStartIndices=e.startIndices,this.currentLength=0,this.texture=function(t){return new U.Z(t,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}(t),this.framebuffer=function(t,e){return new V.Z(t,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:{36064:e}})}(t,this.texture),this.transform=function(t,e,n){const i=C(e.size);return new J(t,{framebuffer:n,vs:"\n#define SHADER_NAME spring-transition-vertex-shader\n\n#define EPSILON 0.00001\n\nuniform float stiffness;\nuniform float damping;\nattribute ATTRIBUTE_TYPE aPrev;\nattribute ATTRIBUTE_TYPE aCur;\nattribute ATTRIBUTE_TYPE aTo;\nvarying ATTRIBUTE_TYPE vNext;\nvarying float vIsTransitioningFlag;\n\nATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {\n  ATTRIBUTE_TYPE velocity = cur - prev;\n  ATTRIBUTE_TYPE delta = dest - cur;\n  ATTRIBUTE_TYPE spring = delta * stiffness;\n  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;\n  return spring + damper + velocity + cur;\n}\n\nvoid main(void) {\n  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;\n  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;\n\n  vNext = getNextValue(aCur, aPrev, aTo);\n  gl_Position = vec4(0, 0, 0, 1);\n  gl_PointSize = 100.0;\n}\n",fs:"\n#define SHADER_NAME spring-transition-is-transitioning-fragment-shader\n\nvarying float vIsTransitioningFlag;\n\nvoid main(void) {\n  if (vIsTransitioningFlag == 0.0) {\n    discard;\n  }\n  gl_FragColor = vec4(1.0);\n}",defines:{ATTRIBUTE_TYPE:i},varyings:["vNext"]})}(t,e,this.framebuffer);const r={byteLength:0,usage:35050};this.buffers=[new a.Z(t,r),new a.Z(t,r),new a.Z(t,r)]}get inProgress(){return this.transition.inProgress}start(t,e){const{gl:n,buffers:i,attribute:r}=this,o={numInstances:e,attribute:r,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:t.enter};for(const t of i)S({buffer:t,...o});this.settings=t,this.currentStartIndices=r.startIndices,this.currentLength=E(r,e),this.attributeInTransition.setData({buffer:i[1],value:r.value}),this.transition.start({...t,duration:1/0}),this.transform.update({elementCount:Math.floor(this.currentLength/r.size),sourceBuffers:{aTo:x(0,r)}})}update(){const{buffers:t,transform:e,framebuffer:n,transition:i}=this;if(!i.update())return!1;const r=this.settings;return e.update({sourceBuffers:{aPrev:t[0],aCur:t[1]},feedbackBuffers:{vNext:t[2]}}),e.run({framebuffer:n,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:r.stiffness,damping:r.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),k(t),this.attributeInTransition.setData({buffer:t[1],value:this.attribute.value}),(0,j.z6)(n)[0]>0||i.end(),!0}cancel(){this.transition.cancel(),this.transform.delete();for(const t of this.buffers)t.delete();this.buffers.length=0,this.texture.delete(),this.framebuffer.delete()}}};class nt{constructor(t,{id:e,timeline:n}){(0,i.Z)(this,"id",void 0),(0,i.Z)(this,"isSupported",void 0),(0,i.Z)(this,"gl",void 0),(0,i.Z)(this,"timeline",void 0),(0,i.Z)(this,"transitions",void 0),(0,i.Z)(this,"needsRedraw",void 0),(0,i.Z)(this,"numInstances",void 0),this.id=e,this.gl=t,this.timeline=n,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=J.isSupported(t)}finalize(){for(const t in this.transitions)this._removeTransition(t)}update({attributes:t,transitions:e,numInstances:n}){this.numInstances=n||1;for(const n in t){const i=t[n],r=i.getTransitionSetting(e);r&&this._updateAttribute(n,i,r)}for(const n in this.transitions){const i=t[n];i&&i.getTransitionSetting(e)||this._removeTransition(n)}}hasAttribute(t){const e=this.transitions[t];return e&&e.inProgress}getAttributes(){const t={};for(const e in this.transitions){const n=this.transitions[e];n.inProgress&&(t[e]=n.attributeInTransition)}return t}run(){if(!this.isSupported||0===this.numInstances)return!1;for(const t in this.transitions)this.transitions[t].update()&&(this.needsRedraw=!0);const t=this.needsRedraw;return this.needsRedraw=!1,t}_removeTransition(t){this.transitions[t].cancel(),delete this.transitions[t]}_updateAttribute(t,e,n){const i=this.transitions[t];let r=!i||i.type!==n.type;if(r){if(!this.isSupported)return void h.Z.warn("WebGL2 not supported by this browser. Transition for ".concat(t," is disabled."))();i&&this._removeTransition(t);const o=et[n.type];o?this.transitions[t]=new o({attribute:e,timeline:this.timeline,gl:this.gl}):(h.Z.error("unsupported transition type '".concat(n.type,"'"))(),r=!1)}(r||e.needsRedraw())&&(this.needsRedraw=!0,this.transitions[t].start(n,this.numInstances))}}const it="attributeManager.invalidate";class rt{constructor(t,{id:e="attribute-manager",stats:n,timeline:r}={}){(0,i.Z)(this,"id",void 0),(0,i.Z)(this,"gl",void 0),(0,i.Z)(this,"attributes",void 0),(0,i.Z)(this,"updateTriggers",void 0),(0,i.Z)(this,"needsRedraw",void 0),(0,i.Z)(this,"userData",void 0),(0,i.Z)(this,"stats",void 0),(0,i.Z)(this,"attributeTransitionManager",void 0),this.id=e,this.gl=t,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=n,this.attributeTransitionManager=new nt(t,{id:"".concat(e,"-transitions"),timeline:r}),Object.seal(this)}finalize(){for(const t in this.attributes)this.attributes[t].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(t={clearRedrawFlags:!1}){const e=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!t.clearRedrawFlags,e&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(t){this._add(t)}addInstanced(t){this._add(t,{instanced:1})}remove(t){for(const e of t)void 0!==this.attributes[e]&&(this.attributes[e].delete(),delete this.attributes[e])}invalidate(t,e){const n=this._invalidateTrigger(t,e);(0,T.Z)(it,this,t,n)}invalidateAll(t){for(const e in this.attributes)this.attributes[e].setNeedsUpdate(e,t);(0,T.Z)(it,this,"all")}update({data:t,numInstances:e,startIndices:n=null,transitions:i,props:r={},buffers:o={},context:s={}}){let a=!1;(0,T.Z)("attributeManager.updateStart",this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const i in this.attributes){const l=this.attributes[i],c=l.settings.accessor;l.startIndices=n,l.numInstances=e,r[i]&&h.Z.removed("props.".concat(i),"data.attributes.".concat(i))(),l.setExternalBuffer(o[i])||l.setBinaryValue("string"==typeof c?o[c]:void 0,t.startIndices)||"string"==typeof c&&!o[c]&&l.setConstantValue(r[c])||l.needsUpdate()&&(a=!0,this._updateAttribute({attribute:l,numInstances:e,data:t,props:r,context:s})),this.needsRedraw=this.needsRedraw||l.needsRedraw()}a&&(0,T.Z)("attributeManager.updateEnd",this,e),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:e,transitions:i})}updateTransition(){const{attributeTransitionManager:t}=this,e=t.run();return this.needsRedraw=this.needsRedraw||e,e}getAttributes(){return this.attributes}getChangedAttributes(t={clearChangedFlags:!1}){const{attributes:e,attributeTransitionManager:n}=this,i={...n.getAttributes()};for(const r in e){const o=e[r];o.needsRedraw(t)&&!n.hasAttribute(r)&&(i[r]=o)}return i}getShaderAttributes(t,e={}){t||(t=this.getAttributes());const n={};for(const i in t)e[i]||Object.assign(n,t[i].getShaderAttributes());return n}_add(t,e={}){for(const n in t){const i=t[n];this.attributes[n]=this._createAttribute(n,i,e)}this._mapUpdateTriggersToAttributes()}_createAttribute(t,e,n){const i={...e,id:t,size:(e.isIndexed?1:e.size)||1,divisor:n.instanced?1:e.divisor||0};return new A(this.gl,i)}_mapUpdateTriggersToAttributes(){const t={};for(const e in this.attributes)this.attributes[e].getUpdateTriggers().forEach((n=>{t[n]||(t[n]=[]),t[n].push(e)}));this.updateTriggers=t}_invalidateTrigger(t,e){const{attributes:n,updateTriggers:i}=this,r=i[t];return r&&r.forEach((t=>{const i=n[t];i&&i.setNeedsUpdate(i.id,e)})),r}_updateAttribute(t){const{attribute:e,numInstances:n}=t;(0,T.Z)("attribute.updateStart",e),e.constant?e.setConstantValue(e.value):(e.allocate(n)&&(0,T.Z)("attribute.allocate",e,n),e.updateBuffer(t)&&(this.needsRedraw=!0,(0,T.Z)("attribute.updateEnd",e,n)))}}var ot=n(4034);class st extends tt.Z{get value(){return this._value}_onUpdate(){const{time:t,settings:{fromValue:e,toValue:n,duration:i,easing:r}}=this,o=r(t/i);this._value=(0,ot.t7)(e,n,o)}}const at=1e-5;function lt(t,e,n,i,r){const o=e-t;return(n-e)*r+-o*i+o+e}function ct(t,e){if(Array.isArray(t)){let n=0;for(let i=0;i<t.length;i++){const r=t[i]-e[i];n+=r*r}return Math.sqrt(n)}return Math.abs(t-e)}class ut extends tt.Z{get value(){return this._currValue}_onUpdate(){const{fromValue:t,toValue:e,damping:n,stiffness:i}=this.settings,{_prevValue:r=t,_currValue:o=t}=this;let s=function(t,e,n,i,r){if(Array.isArray(n)){const o=[];for(let s=0;s<n.length;s++)o[s]=lt(t[s],e[s],n[s],i,r);return o}return lt(t,e,n,i,r)}(r,o,e,n,i);const a=ct(s,e),l=ct(s,o);a<at&&l<at&&(s=e,this.end()),this._prevValue=o,this._currValue=s}}const ht={interpolation:st,spring:ut};class dt{constructor(t){this.transitions=new Map,this.timeline=t}get active(){return this.transitions.size>0}add(t,e,n,i){const{transitions:r}=this;if(r.has(t)){const n=r.get(t),{value:i=n.settings.fromValue}=n;e=i,this.remove(t)}if(!(i=w(i)))return;const o=ht[i.type];if(!o)return void h.Z.error("unsupported transition type '".concat(i.type,"'"))();const s=new o(this.timeline);s.start({...i,fromValue:e,toValue:n}),r.set(t,s)}remove(t){const{transitions:e}=this;e.has(t)&&(e.get(t).cancel(),e.delete(t))}update(){const t={};for(const[e,n]of this.transitions)n.update(),t[e]=n.value,n.inProgress||this.remove(e);return t}clear(){for(const t of this.transitions.keys())this.remove(t)}}var ft=n(5409);function pt(t,e){if(!t.transitions)return!1;const n={},i=bt(t);let r=!1;for(const o in t.transitions){const s=i[o],a=s&&s.type;("number"===a||"color"===a||"array"===a)&&mt(t[o],e[o],s)&&(n[o]=!0,r=!0)}return!!r&&n}function gt({newProps:t,oldProps:e,ignoreProps:n={},propTypes:i={},triggerName:r="props"}){if(e===t)return!1;if("object"!=typeof t||null===t)return"".concat(r," changed shallowly");if("object"!=typeof e||null===e)return"".concat(r," changed shallowly");for(const o of Object.keys(t))if(!(o in n)){if(!(o in e))return"".concat(r,".").concat(o," added");const n=mt(t[o],e[o],i[o]);if(n)return"".concat(r,".").concat(o," ").concat(n)}for(const o of Object.keys(e))if(!(o in n)){if(!(o in t))return"".concat(r,".").concat(o," dropped");if(!Object.hasOwnProperty.call(t,o)){const n=mt(t[o],e[o],i[o]);if(n)return"".concat(r,".").concat(o," ").concat(n)}}return!1}function mt(t,e,n){let i=n&&n.equal;return i&&!i(t,e,n)?"changed deeply":i||(i=t&&e&&t.equals,!i||i.call(t,e))?i||e===t?null:"changed shallowly":"changed deeply"}function _t(t,e){if(null===e)return!0;const n=e.extensions,{extensions:i}=t;if(i===n)return!1;if(!n||!i)return!0;if(i.length!==n.length)return!0;for(let t=0;t<i.length;t++)if(!i[t].equals(n[t]))return!0;return!1}function vt(t,e,n){let i=t.updateTriggers[n];i=null==i?{}:i;let r=e.updateTriggers[n];return r=null==r?{}:r,gt({oldProps:r,newProps:i,triggerName:n})}function bt(t){const e=t[ft.fm],n=e&&e.constructor;return n?n._propTypes:{}}var yt=n(8177);function wt(t,e){if(!e)return t;const n={...t,...e};if("defines"in e&&(n.defines={...t.defines,...e.defines}),"modules"in e&&(n.modules=(t.modules||[]).concat(e.modules),e.modules.some((t=>"project64"===t.name)))){const t=n.modules.findIndex((t=>"project32"===t.name));t>=0&&n.modules.splice(t,1)}if("inject"in e)if(t.inject){const i={...t.inject};for(const t in e.inject)i[t]=(i[t]||"")+e.inject[t];n.inject=i}else n.inject=e.inject;return n}var xt=n(8771),Ct=n(9970),kt=n(8333),Et=n(7160),St=n(6018);function At(t,e,n=!1){const i=e.projectPosition(t);if(n&&e instanceof Ct.Z){const[n,r,o=0]=t,s=e.getDistanceScales([n,r]);i[2]=o*s.unitsPerMeter[2]}return i}function Tt(t,{viewport:e,modelMatrix:n,coordinateSystem:i,coordinateOrigin:o,offsetMode:s}){let[a,l,c=0]=t;switch(n&&([a,l,c]=kt.fF([],[a,l,c,1],n)),i){case r.Df.LNGLAT:return At([a,l,c],e,s);case r.Df.LNGLAT_OFFSETS:return At([a+o[0],l+o[1],c+(o[2]||0)],e,s);case r.Df.METER_OFFSETS:return At((0,St.eG)(o,[a,l,c]),e,s);case r.Df.CARTESIAN:default:return e.isGeospatial?[a+o[0],l+o[1],c+o[2]]:e.projectPosition([a,l,c])}}const Mt={10241:9987,10240:9729,10242:33071,10243:33071},Dt={};var Pt=n(6871);const Lt={boolean:{validate:(t,e)=>!0,equal:(t,e,n)=>Boolean(t)===Boolean(e)},number:{validate:(t,e)=>Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)},color:{validate:(t,e)=>e.optional&&!t||zt(t)&&(3===t.length||4===t.length),equal:(t,e,n)=>Rt(t,e)},accessor:{validate(t,e){const n=Ft(t);return"function"===n||n===Ft(e.value)},equal:(t,e,n)=>"function"==typeof e||Rt(t,e)},array:{validate:(t,e)=>e.optional&&!t||zt(t),equal:(t,e,n)=>n.compare?Rt(t,e):t===e},object:{equal:(t,e,n)=>n.compare?(0,Pt.v)(t,e):t===e},function:{validate:(t,e)=>e.optional&&!t||"function"==typeof t,equal:(t,e,n)=>!n.compare||t===e},data:{transform:(t,e,n)=>{const{dataTransform:i}=n.props;return i&&t?i(t):t}},image:{transform:(t,e,n)=>function(t,e){const n=t.context&&t.context.gl;if(!n||!e)return null;if(e instanceof U.Z)return e;e.constructor&&"Object"!==e.constructor.name&&(e={data:e});let i=null;e.compressed&&(i={10241:e.data.length>1?9985:9729});const r=new U.Z(n,{...e,parameters:{...Mt,...i,...t.props.textureParameters}});return Dt[r.id]=!0,r}(n,t),release:t=>{var e;(e=t)&&e instanceof U.Z&&Dt[e.id]&&(e.delete(),delete Dt[e.id])}}};function Rt(t,e){if(t===e)return!0;if(!zt(t)||!zt(e))return!1;const n=t.length;if(n!==e.length)return!1;for(let i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}function It(t,e){switch(Ft(e)){case"object":return Ot(t,e);case"array":return Ot(t,{type:"array",value:e,compare:!1});case"boolean":return Ot(t,{type:"boolean",value:e});case"number":return Ot(t,{type:"number",value:e});case"function":return Ot(t,{type:"function",value:e,compare:!0});default:return{name:t,type:"unknown",value:e}}}function Ot(t,e){return"type"in e?{name:t,...Lt[e.type],...e}:"value"in e?{name:t,type:Ft(e.value),...e}:{name:t,type:"object",value:e}}function zt(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function Ft(t){return zt(t)?"array":null===t?"null":typeof t}function Bt(t){return Ut(t,"_mergedDefaultProps")||(function(t){if(!t.prototype)return;const e=Object.getPrototypeOf(t),n=Bt(e),i=function(t){const e={},n={},i={};for(const[r,o]of Object.entries(t)){const t=null==o?void 0:o.deprecatedFor;if(t)i[r]=Array.isArray(t)?t:[t];else{const t=It(r,o);e[r]=t,n[r]=t.value}}return{propTypes:e,defaultProps:n,deprecatedProps:i}}(Ut(t,"defaultProps")||{}),r=function(t,e,n){const i=Object.create(null);Object.assign(i,e,t);const r=function(t){const e=Ut(t,"layerName")||Ut(t,"componentName");return e||h.Z.once(0,"".concat(t.name,".componentName not specified"))(),e||t.name}(n);return delete t.id,Object.defineProperties(i,{id:{writable:!0,value:r}}),i}(i.defaultProps,n,t),o={...e._propTypes,...i.propTypes};!function(t,e){const n={},i={};for(const t in e){const r=e[t],{name:o,value:s}=r;r.async&&(n[o]=s,i[o]=Nt(o))}t[ft.lY]=n,t[ft.fO]={},Object.defineProperties(t,i)}(r,o);const s={...e._deprecatedProps,...i.deprecatedProps};(function(t,e){for(const n in e)Object.defineProperty(t,n,{enumerable:!1,set(t){const i="".concat(this.id,": ").concat(n);for(const i of e[n])jt(this,i)||(this[i]=t);h.Z.deprecated(i,e[n].join("/"))()}})})(r,s),t._mergedDefaultProps=r,t._propTypes=o,t._deprecatedProps=s}(t),t._mergedDefaultProps)}function Nt(t){return{enumerable:!0,set(e){"string"==typeof e||e instanceof Promise||(0,g.D0)(e)?this[ft.fO][t]=e:this[ft.bN][t]=e},get(){if(this[ft.bN]){if(t in this[ft.bN])return this[ft.bN][t]||this[ft.lY][t];if(t in this[ft.fO]){const e=this[ft.fm]&&this[ft.fm].internalState;if(e&&e.hasAsyncProp(t))return e.getAsyncProp(t)||this[ft.lY][t]}}return this[ft.lY][t]}}}function jt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Ut(t,e){return jt(t,e)&&t[e]}let Vt=0;class Wt{constructor(...t){(0,i.Z)(this,"id",void 0),(0,i.Z)(this,"props",void 0),(0,i.Z)(this,"count",void 0),this.props=function(t,e){const n=Bt(t.constructor),i=Object.create(n);i[ft.fm]=t,i[ft.fO]={},i[ft.bN]={};for(let t=0;t<e.length;++t){const n=e[t];for(const t in n)i[t]=n[t]}return Object.freeze(i),i}(this,t),this.id=this.props.id,this.count=Vt++}clone(t){const{props:e}=this,n={};for(const t in e[ft.lY])t in e[ft.bN]?n[t]=e[ft.bN][t]:t in e[ft.fO]&&(n[t]=e[ft.fO][t]);return new this.constructor({...e,...n,...t})}}(0,i.Z)(Wt,"componentName","Component"),(0,i.Z)(Wt,"defaultProps",{});const Ht=Object.freeze({});class $t extends class{constructor(t){(0,i.Z)(this,"component",void 0),(0,i.Z)(this,"onAsyncPropUpdated",void 0),(0,i.Z)(this,"asyncProps",void 0),(0,i.Z)(this,"oldProps",void 0),(0,i.Z)(this,"oldAsyncProps",void 0),this.component=t,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const t in this.asyncProps){const e=this.asyncProps[t];e&&e.type&&e.type.release&&e.type.release(e.resolvedValue,e.type,this.component)}}getOldProps(){return this.oldAsyncProps||this.oldProps||Ht}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component.props}hasAsyncProp(t){return t in this.asyncProps}getAsyncProp(t){const e=this.asyncProps[t];return e&&e.resolvedValue}isAsyncPropLoading(t){if(t){const e=this.asyncProps[t];return Boolean(e&&e.pendingLoadCount>0&&e.pendingLoadCount!==e.resolvedLoadCount)}for(const t in this.asyncProps)if(this.isAsyncPropLoading(t))return!0;return!1}reloadAsyncProp(t,e){this._watchPromise(t,Promise.resolve(e))}setAsyncProps(t){const e=t[ft.bN]||{},n=t[ft.fO]||t,i=t[ft.lY]||{};for(const t in e){const n=e[t];this._createAsyncPropData(t,i[t]),this._updateAsyncProp(t,n),e[t]=this.getAsyncProp(t)}for(const t in n){const e=n[t];this._createAsyncPropData(t,i[t]),this._updateAsyncProp(t,e)}}_fetch(t,e){return null}_onResolve(t,e){}_onError(t,e){}_updateAsyncProp(t,e){this._didAsyncInputValueChange(t,e)&&("string"==typeof e&&(e=this._fetch(t,e)),e instanceof Promise?this._watchPromise(t,e):(0,g.D0)(e)?this._resolveAsyncIterable(t,e):this._setPropValue(t,e))}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const t in this.asyncProps)Object.defineProperty(this.oldAsyncProps,t,{enumerable:!0,value:this.oldProps[t]})}}_didAsyncInputValueChange(t,e){const n=this.asyncProps[t];return e!==n.resolvedValue&&e!==n.lastValue&&(n.lastValue=e,!0)}_setPropValue(t,e){this._freezeAsyncOldProps();const n=this.asyncProps[t];n&&(e=this._postProcessValue(n,e),n.resolvedValue=e,n.pendingLoadCount++,n.resolvedLoadCount=n.pendingLoadCount)}_setAsyncPropValue(t,e,n){const i=this.asyncProps[t];i&&n>=i.resolvedLoadCount&&void 0!==e&&(this._freezeAsyncOldProps(),i.resolvedValue=e,i.resolvedLoadCount=n,this.onAsyncPropUpdated(t,e))}_watchPromise(t,e){const n=this.asyncProps[t];if(n){n.pendingLoadCount++;const i=n.pendingLoadCount;e.then((e=>{e=this._postProcessValue(n,e),this._setAsyncPropValue(t,e,i),this._onResolve(t,e)})).catch((e=>{this._onError(t,e)}))}}async _resolveAsyncIterable(t,e){if("data"!==t)return void this._setPropValue(t,e);const n=this.asyncProps[t];if(!n)return;n.pendingLoadCount++;const i=n.pendingLoadCount;let r=[],o=0;for await(const n of e){const{dataTransform:e}=this.component.props;r=e?e(n,r):r.concat(n),Object.defineProperty(r,"__diff",{enumerable:!1,value:[{startRow:o,endRow:r.length}]}),o=r.length,this._setAsyncPropValue(t,r,i)}this._onResolve(t,r)}_postProcessValue(t,e){const n=t.type;return n&&(n.release&&n.release(t.resolvedValue,n,this.component),n.transform)?n.transform(e,n,this.component):e}_createAsyncPropData(t,e){if(!this.asyncProps[t]){const n=this.component&&this.component.constructor._propTypes;this.asyncProps[t]={type:n&&n[t],lastValue:null,resolvedValue:e,pendingLoadCount:0,resolvedLoadCount:0}}}}{constructor({attributeManager:t,layer:e}){super(e),(0,i.Z)(this,"attributeManager",void 0),(0,i.Z)(this,"needsRedraw",void 0),(0,i.Z)(this,"needsUpdate",void 0),(0,i.Z)(this,"subLayers",void 0),(0,i.Z)(this,"usesPickingColorCache",void 0),(0,i.Z)(this,"changeFlags",void 0),(0,i.Z)(this,"viewport",void 0),(0,i.Z)(this,"uniformTransitions",void 0),(0,i.Z)(this,"propsInTransition",void 0),this.attributeManager=t,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}set layer(t){this.component=t}_fetch(t,e){const n=this.component.props.fetch;return n?n(e,{propName:t,layer:this.layer}):super._fetch(t,e)}_onResolve(t,e){const n=this.component.props.onDataLoad;"data"===t&&n&&n(e,{propName:t,layer:this.layer})}_onError(t,e){this.layer.raiseError(e,"loading ".concat(t," of ").concat(this.layer))}}var Zt=n(1469);const qt=2**24-1,Gt=Object.freeze([]),Kt=(0,yt.Z)((({oldViewport:t,viewport:e})=>t.equals(e)));let Xt=new Uint8ClampedArray(0);const Yt={data:{type:"data",value:Gt,async:!0},dataComparator:{type:"function",value:null,compare:!1,optional:!0},_dataDiff:{type:"function",value:t=>t&&t.__diff,compare:!1,optional:!0},dataTransform:{type:"function",value:null,compare:!1,optional:!0},onDataLoad:{type:"function",value:null,compare:!1,optional:!0},onError:{type:"function",value:null,compare:!1,optional:!0},fetch:{type:"function",value:(t,{propName:e,layer:n,loaders:i,loadOptions:r,signal:o})=>{const{resourceManager:s}=n.context;var a;r=r||n.getLoadOptions(),i=i||n.props.loaders,o&&(r={...r,fetch:{...null===(a=r)||void 0===a?void 0:a.fetch,signal:o}});let l=s.contains(t);return l||r||(s.add({resourceId:t,data:(0,Zt.z)(t,i),persistent:!1}),l=!0),l?s.subscribe({resourceId:t,onChange:t=>{var i;return null===(i=n.internalState)||void 0===i?void 0:i.reloadAsyncProp(e,t)},consumerId:n.id,requestId:e}):(0,Zt.z)(t,i,r)},compare:!1},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:r.k8.DRAW,onHover:{type:"function",value:null,compare:!1,optional:!0},onClick:{type:"function",value:null,compare:!1,optional:!0},onDragStart:{type:"function",value:null,compare:!1,optional:!0},onDrag:{type:"function",value:null,compare:!1,optional:!0},onDragEnd:{type:"function",value:null,compare:!1,optional:!0},coordinateSystem:r.Df.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,compare:!0},getPolygonOffset:{type:"function",value:({layerIndex:t})=>[0,100*-t],compare:!1},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class Qt extends Wt{constructor(...t){super(...t),(0,i.Z)(this,"internalState",null),(0,i.Z)(this,"lifecycle",ft.dt.NO_STATE),(0,i.Z)(this,"context",void 0),(0,i.Z)(this,"state",void 0),(0,i.Z)(this,"parent",null)}get root(){let t=this;for(;t.parent;)t=t.parent;return t}toString(){const t=this.constructor.layerName||this.constructor.name;return"".concat(t,"({id: '").concat(this.props.id,"'})")}project(t){(0,p.Z)(this.internalState);const e=this.internalState.viewport||this.context.viewport,n=Tt(t,{viewport:e,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[i,r,o]=(0,St.aW)(n,e.pixelProjectionMatrix);return 2===t.length?[i,r]:[i,r,o]}unproject(t){return(0,p.Z)(this.internalState),(this.internalState.viewport||this.context.viewport).unproject(t)}projectPosition(t,e){return(0,p.Z)(this.internalState),function(t,e){const{viewport:n,coordinateSystem:i,coordinateOrigin:o,modelMatrix:s,fromCoordinateSystem:a,fromCoordinateOrigin:l}=function(t){const{viewport:e,modelMatrix:n,coordinateOrigin:i}=t;let{coordinateSystem:o,fromCoordinateSystem:s,fromCoordinateOrigin:a}=t;return o===r.Df.DEFAULT&&(o=e.isGeospatial?r.Df.LNGLAT:r.Df.CARTESIAN),void 0===s&&(s=o),void 0===a&&(a=i),{viewport:e,coordinateSystem:o,coordinateOrigin:i,modelMatrix:n,fromCoordinateSystem:s,fromCoordinateOrigin:a}}(e),{geospatialOrigin:c,shaderCoordinateOrigin:u,offsetMode:h}=(0,xt.v)(n,i,o),d=Tt(t,{viewport:n,modelMatrix:s,coordinateSystem:a,coordinateOrigin:l,offsetMode:h});if(h){const t=n.projectPosition(c||u);Et.lu(d,d,t)}return d}(t,{viewport:this.internalState.viewport||this.context.viewport,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...e})}get isComposite(){return!1}setState(t){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,t),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return!!this.internalState&&!this.internalState.isAsyncPropLoading()}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){return this.state&&(this.state.models||this.state.model&&[this.state.model])||[]}setModuleParameters(t){for(const e of this.getModels())e.updateModuleSettings(t)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:t}=this.props;return t===r.Df.DEFAULT||t===r.Df.LNGLAT||t===r.Df.CARTESIAN}onHover(t,e){return this.props.onHover&&this.props.onHover(t,e)||!1}onClick(t,e){return this.props.onClick&&this.props.onClick(t,e)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(t,e=[]){return e[0]=t+1&255,e[1]=t+1>>8&255,e[2]=t+1>>8>>8&255,e}decodePickingColor(t){(0,p.Z)(t instanceof Uint8Array);const[e,n,i]=t;return e+256*n+65536*i-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&void 0!==this.state.numInstances?this.state.numInstances:function(t){if(null===(e=t)||"object"!=typeof e)throw new Error("count(): argument not an object");var e;if("function"==typeof t.count)return t.count();if(Number.isFinite(t.size))return t.size;if(Number.isFinite(t.length))return t.length;if(function(t){return null!==t&&"object"==typeof t&&t.constructor===Object}(t))return Object.keys(t).length;throw new Error("count(): argument not a container")}(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){var t;const e=this.getAttributeManager();if(!e)return null;const{positions:n,instancePositions:i}=e.attributes;return null===(t=n||i)||void 0===t?void 0:t.getBounds()}getShaders(t){for(const e of this.props.extensions)t=wt(t,e.getShaders.call(this,e));return t}shouldUpdateState(t){return t.changeFlags.propsOrDataChanged}updateState(t){const e=this.getAttributeManager(),{dataChanged:n}=t.changeFlags;if(n&&e)if(Array.isArray(n))for(const t of n)e.invalidateAll(t);else e.invalidateAll();const{props:i,oldProps:r}=t,o=Number.isInteger(r.highlightedObjectIndex)||r.pickable,s=Number.isInteger(i.highlightedObjectIndex)||i.pickable;if(o!==s&&e){const{pickingColors:t,instancePickingColors:n}=e.attributes,i=t||n;i&&(s&&i.constant&&(i.constant=!1,e.invalidate(i.id)),i.value||s||(i.constant=!0,i.value=[0,0,0]))}}finalizeState(t){for(const t of this.getModels())t.delete();const e=this.getAttributeManager();e&&e.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(t){for(const e of this.getModels())e.draw(t)}getPickingInfo({info:t,mode:e,sourceLayer:n}){const{index:i}=t;return i>=0&&Array.isArray(this.props.data)&&(t.object=this.props.data[i]),t}raiseError(t,e){var n,i,r,o;e&&(t.message="".concat(e,": ").concat(t.message)),null!==(n=(i=this.props).onError)&&void 0!==n&&n.call(i,t)||null===(r=this.context)||void 0===r||null===(o=r.onError)||void 0===o||o.call(r,t,this)}getNeedsRedraw(t={clearRedrawFlags:!1}){return this._getNeedsRedraw(t)}needsUpdate(){return!!this.internalState&&(this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()))}hasUniformTransition(){var t;return(null===(t=this.internalState)||void 0===t?void 0:t.uniformTransitions.active)||!1}activateViewport(t){if(!this.internalState)return;const e=this.internalState.viewport;this.internalState.viewport=t,e&&Kt({oldViewport:e,viewport:t})||(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(t="all"){const e=this.getAttributeManager();e&&("all"===t?e.invalidateAll():e.invalidate(t))}updateAttributes(t){for(const e of this.getModels())this._setModelAttributes(e,t)}_updateAttributes(){const t=this.getAttributeManager();if(!t)return;const e=this.props,n=this.getNumInstances(),i=this.getStartIndices();t.update({data:e.data,numInstances:n,startIndices:i,props:e,transitions:e.transitions,buffers:e.data.attributes,context:this});const r=t.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(r)}_updateAttributeTransition(){const t=this.getAttributeManager();t&&t.updateTransition()}_updateUniformTransition(){const{uniformTransitions:t}=this.internalState;if(t.active){const e=t.update(),n=Object.create(this.props);for(const t in e)Object.defineProperty(n,t,{value:e[t]});return n}return this.props}calculateInstancePickingColors(t,{numInstances:e}){if(t.constant)return;const n=Math.floor(Xt.length/3);if(this.internalState.usesPickingColorCache=!0,n<e){e>qt&&h.Z.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),Xt=c.Z.allocate(Xt,e,{size:3,copy:!0,maxCount:Math.max(e,qt)});const t=Math.floor(Xt.length/3),i=[];for(let e=n;e<t;e++)this.encodePickingColor(e,i),Xt[3*e+0]=i[0],Xt[3*e+1]=i[1],Xt[3*e+2]=i[2]}t.value=Xt.subarray(0,3*e)}_setModelAttributes(t,e){const n=this.getAttributeManager(),i=t.userData.excludeAttributes||{},r=n.getShaderAttributes(e,i);t.setAttributes(r)}disablePickingIndex(t){this._disablePickingIndex(t)}_disablePickingIndex(t){const{pickingColors:e,instancePickingColors:n}=this.getAttributeManager().attributes,i=e||n;if(!i)return;const r=i.getVertexOffset(t),o=i.getVertexOffset(t+1);i.buffer.subData({data:new Uint8Array(o-r),offset:r})}restorePickingColors(){const{pickingColors:t,instancePickingColors:e}=this.getAttributeManager().attributes,n=t||e;n&&(this.internalState.usesPickingColorCache&&n.value.buffer!==Xt.buffer&&(n.value=Xt.subarray(0,n.value.length)),n.updateSubBuffer({startOffset:0}))}_initialize(){(0,p.Z)(!this.internalState),(0,p.Z)(Number.isFinite(this.props.coordinateSystem)),(0,T.Z)("layer.initialize",this);const t=this._getAttributeManager();t&&t.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new $t({attributeManager:t,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(h.Z.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),t)}),this.internalState.layer=this,this.internalState.uniformTransitions=new dt(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const t of this.props.extensions)t.initializeState.call(this,this.context,t);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(t){(0,T.Z)("layer.matched",this,this===t);const{state:e,internalState:n}=t;this!==t&&(this.internalState=n,this.internalState.layer=this,this.state=e,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const t=this.needsUpdate();if((0,T.Z)("layer.update",this,t),!t)return;const e=this.props,n=this.context,i=this.internalState,r=n.viewport,o=this._updateUniformTransition();i.propsInTransition=o,n.viewport=i.viewport||r,this.props=o;try{const t=this._getUpdateParams(),o=this.getModels();if(n.gl)this.updateState(t);else try{this.updateState(t)}catch(t){}for(const e of this.props.extensions)e.updateState.call(this,t,e);const s=this.getModels()[0]!==o[0];this._postUpdate(t,s)}finally{n.viewport=r,this.props=e,this._clearChangeFlags(),i.needsUpdate=!1,i.resetOldProps()}}_finalize(){(0,T.Z)("layer.finalize",this),this.finalizeState(this.context);for(const t of this.props.extensions)t.finalizeState.call(this,t)}_drawLayer({moduleParameters:t=null,uniforms:e={},parameters:n={}}){this._updateAttributeTransition();const i=this.props,r=this.context;this.props=this.internalState.propsInTransition||i;const o=this.props.opacity;e.opacity=Math.pow(o,1/2.2);try{t&&this.setModuleParameters(t);const{getPolygonOffset:o}=this.props,s=o&&o(e)||[0,0];(0,z.dR)(r.gl,{polygonOffset:s}),(0,z.s8)(r.gl,n,(()=>{const i={moduleParameters:t,uniforms:e,parameters:n,context:r};for(const t of this.props.extensions)t.draw.call(this,i,t);this.draw(i)}))}finally{this.props=i}}getChangeFlags(){var t;return null===(t=this.internalState)||void 0===t?void 0:t.changeFlags}setChangeFlags(t){if(!this.internalState)return;const{changeFlags:e}=this.internalState;for(const n in t)if(t[n]){let i=!1;if("dataChanged"===n){const r=t[n],o=e[n];r&&Array.isArray(o)&&(e.dataChanged=Array.isArray(r)?o.concat(r):r,i=!0)}e[n]||(e[n]=t[n],i=!0),i&&(0,T.Z)("layer.changeFlag",this,n,t)}const n=Boolean(e.dataChanged||e.updateTriggersChanged||e.propsChanged||e.extensionsChanged);e.propsOrDataChanged=n,e.somethingChanged=n||e.viewportChanged||e.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(t,e){const n=function(t,e){const n=gt({newProps:t,oldProps:e,propTypes:bt(t),ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),i=function(t,e){if(null===e)return"oldProps is null, initial diff";let n=!1;const{dataComparator:i,_dataDiff:r}=t;return i?i(t.data,e.data)||(n="Data comparator detected a change"):t.data!==e.data&&(n="A new data container was supplied"),n&&r&&(n=r(t.data,e.data)||n),n}(t,e);let r=!1;return i||(r=function(t,e){if(null===e)return{all:!0};if("all"in t.updateTriggers&&vt(t,e,"all"))return{all:!0};const n={};let i=!1;for(const r in t.updateTriggers)"all"!==r&&vt(t,e,r)&&(n[r]=!0,i=!0);return!!i&&n}(t,e)),{dataChanged:i,propsChanged:n,updateTriggersChanged:r,extensionsChanged:_t(t,e),transitionsChanged:pt(t,e)}}(t,e);if(n.updateTriggersChanged)for(const t in n.updateTriggersChanged)n.updateTriggersChanged[t]&&this.invalidateAttribute(t);if(n.transitionsChanged)for(const r in n.transitionsChanged){var i;this.internalState.uniformTransitions.add(r,e[r],t[r],null===(i=t.transitions)||void 0===i?void 0:i[r])}return this.setChangeFlags(n)}validateProps(){!function(t){const e=bt(t);for(const n in e){const i=e[n],{validate:r}=i;if(r&&!r(t[n],i))throw new Error("Invalid prop ".concat(n,": ").concat(t[n]))}}(this.props)}updateAutoHighlight(t){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(t)}_updateAutoHighlight(t){const e={pickingSelectedColor:t.picked?t.color:null},{highlightColor:n}=this.props;t.picked&&"function"==typeof n&&(e.pickingHighlightColor=n(t)),this.setModuleParameters(e),this.setNeedsRedraw()}_getAttributeManager(){const t=this.context;return new rt(t.gl,{id:this.props.id,stats:t.stats,timeline:t.timeline})}_postUpdate(t,e){const{props:n,oldProps:i}=t;this.setNeedsRedraw(),this._updateAttributes();const{model:r}=this.state;null==r||r.setInstanceCount(this.getNumInstances());const{autoHighlight:o,highlightedObjectIndex:s,highlightColor:a}=n;if(e||i.autoHighlight!==o||i.highlightedObjectIndex!==s||i.highlightColor!==a){const t={};o||(t.pickingSelectedColor=null),Array.isArray(a)&&(t.pickingHighlightColor=a),Number.isInteger(s)&&(t.pickingSelectedColor=Number.isFinite(s)&&s>=0?this.encodePickingColor(s):null),this.setModuleParameters(t)}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(t){if(!this.internalState)return!1;let e=!1;e=e||this.internalState.needsRedraw&&this.id,this.internalState.needsRedraw=this.internalState.needsRedraw&&!t.clearRedrawFlags;const n=this.getAttributeManager(),i=!!n&&n.getNeedsRedraw(t);return e=e||i,e}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}(0,i.Z)(Qt,"defaultProps",Yt),(0,i.Z)(Qt,"layerName","Layer")},5409:(t,e,n)=>{"use strict";n.d(e,{bN:()=>a,dt:()=>i,fO:()=>s,fm:()=>r,lY:()=>o});const i={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"},r=Symbol.for("component"),o=Symbol.for("asyncPropDefaults"),s=Symbol.for("asyncPropOriginal"),a=Symbol.for("asyncPropResolved")},1331:(t,e,n)=>{"use strict";n.d(e,{Z:()=>r});const i={pickingSelectedColor:null,pickingHighlightColor:new Uint8Array([0,255,255,255]),pickingActive:!1,pickingAttribute:!1},r={inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    // for picking depth values\n    picking_setPickingAttribute(position.z / position.w);\n  ","vs:DECKGL_FILTER_COLOR":"\n  picking_setPickingColor(geometry.pickingColor);\n  ","fs:DECKGL_FILTER_COLOR":{order:99,injection:"\n  // use highlight color if this fragment belongs to the selected object.\n  color = picking_filterHighlightColor(color);\n\n  // use picking color if rendering to picking FBO.\n  color = picking_filterPickingColor(color);\n    "}},name:"picking",vs:"uniform bool picking_uActive;\nuniform bool picking_uAttribute;\nuniform vec3 picking_uSelectedColor;\nuniform bool picking_uSelectedColorValid;\n\nout vec4 picking_vRGBcolor_Avalid;\n\nconst float COLOR_SCALE = 1. / 255.;\n\nbool picking_isColorValid(vec3 color) {\n  return dot(color, vec3(1.0)) > 0.001;\n}\n\nbool isVertexPicked(vec3 vertexColor) {\n  return\n    picking_uSelectedColorValid &&\n    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));\n}\n\nvoid picking_setPickingColor(vec3 pickingColor) {\n  if (picking_uActive) {\n    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));\n\n    if (!picking_uAttribute) {\n      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;\n    }\n  } else {\n    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));\n  }\n}\n\nvoid picking_setPickingAttribute(float value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.r = value;\n  }\n}\nvoid picking_setPickingAttribute(vec2 value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.rg = value;\n  }\n}\nvoid picking_setPickingAttribute(vec3 value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.rgb = value;\n  }\n}\n",fs:"uniform bool picking_uActive;\nuniform vec3 picking_uSelectedColor;\nuniform vec4 picking_uHighlightColor;\n\nin vec4 picking_vRGBcolor_Avalid;\nvec4 picking_filterHighlightColor(vec4 color) {\n  if (picking_uActive) {\n    return color;\n  }\n  bool selected = bool(picking_vRGBcolor_Avalid.a);\n\n  if (selected) {\n    float highLightAlpha = picking_uHighlightColor.a;\n    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);\n    float highLightRatio = highLightAlpha / blendedAlpha;\n\n    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);\n    return vec4(blendedRGB, blendedAlpha);\n  } else {\n    return color;\n  }\n}\nvec4 picking_filterPickingColor(vec4 color) {\n  if (picking_uActive) {\n    if (picking_vRGBcolor_Avalid.a == 0.0) {\n      discard;\n    }\n    return picking_vRGBcolor_Avalid;\n  }\n  return color;\n}\nvec4 picking_filterColor(vec4 color) {\n  vec4 highightColor = picking_filterHighlightColor(color);\n  return picking_filterPickingColor(highightColor);\n}\n\n",getUniforms:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i;const e={};if(void 0!==t.pickingSelectedColor)if(t.pickingSelectedColor){const n=t.pickingSelectedColor.slice(0,3);e.picking_uSelectedColorValid=1,e.picking_uSelectedColor=n}else e.picking_uSelectedColorValid=0;if(t.pickingHighlightColor){const n=Array.from(t.pickingHighlightColor,(t=>t/255));Number.isFinite(n[3])||(n[3]=1),e.picking_uHighlightColor=n}return void 0!==t.pickingActive&&(e.picking_uActive=Boolean(t.pickingActive),e.picking_uAttribute=Boolean(t.pickingAttribute)),e}}},6084:(t,e,n)=>{"use strict";n.d(e,{Z:()=>d});const i="#define SMOOTH_EDGE_RADIUS 0.5",r={name:"geometry",vs:"\n".concat(i,"\n\nstruct VertexGeometry {\n  vec4 position;\n  vec3 worldPosition;\n  vec3 worldPositionAlt;\n  vec3 normal;\n  vec2 uv;\n  vec3 pickingColor;\n} geometry = VertexGeometry(\n  vec4(0.0, 0.0, 1.0, 0.0),\n  vec3(0.0),\n  vec3(0.0),\n  vec3(0.0),\n  vec2(0.0),\n  vec3(0.0)\n);\n"),fs:"\n".concat(i,"\n\nstruct FragmentGeometry {\n  vec2 uv;\n} geometry;\n\nfloat smoothedge(float edge, float x) {\n  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);\n}\n")};var o=n(4088);const s=Object.keys(o.Df).map((t=>"const int COORDINATE_SYSTEM_".concat(t," = ").concat(o.Df[t],";"))).join(""),a=Object.keys(o.zG).map((t=>"const int PROJECTION_MODE_".concat(t," = ").concat(o.zG[t],";"))).join(""),l=Object.keys(o.iI).map((t=>"const int UNIT_".concat(t.toUpperCase()," = ").concat(o.iI[t],";"))).join(""),c="".concat(s,"\n").concat(a,"\n").concat(l,'\n\nuniform int project_uCoordinateSystem;\nuniform int project_uProjectionMode;\nuniform float project_uScale;\nuniform bool project_uWrapLongitude;\nuniform vec3 project_uCommonUnitsPerMeter;\nuniform vec3 project_uCommonUnitsPerWorldUnit;\nuniform vec3 project_uCommonUnitsPerWorldUnit2;\nuniform vec4 project_uCenter;\nuniform mat4 project_uModelMatrix;\nuniform mat4 project_uViewProjectionMatrix;\nuniform vec2 project_uViewportSize;\nuniform float project_uDevicePixelRatio;\nuniform float project_uFocalDistance;\nuniform vec3 project_uCameraPosition;\nuniform vec3 project_uCoordinateOrigin;\nuniform vec3 project_uCommonOrigin;\nuniform bool project_uPseudoMeters;\n\nconst float TILE_SIZE = 512.0;\nconst float PI = 3.1415926536;\nconst float WORLD_SCALE = TILE_SIZE / (PI * 2.0);\nconst vec3 ZERO_64_LOW = vec3(0.0);\nconst float EARTH_RADIUS = 6370972.0; // meters\nconst float GLOBE_RADIUS = 256.0;\n\n// returns an adjustment factor for uCommonUnitsPerMeter\nfloat project_size_at_latitude(float lat) {\n  float y = clamp(lat, -89.9, 89.9);\n  return 1.0 / cos(radians(y));\n}\n\nfloat project_size() {\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR &&\n    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT &&\n    project_uPseudoMeters == false) {\n\n    // uCommonUnitsPerMeter in low-zoom Web Mercator is non-linear\n    // Adjust by 1 / cos(latitude)\n    // If geometry.position (vertex in common space) is populated, use it\n    // Otherwise use geometry.worldPosition (anchor in world space)\n    \n    if (geometry.position.w == 0.0) {\n      return project_size_at_latitude(geometry.worldPosition.y);\n    }\n\n    // latitude from common y: 2.0 * (atan(exp(y / TILE_SIZE * 2.0 * PI - PI)) - PI / 4.0)\n    // Taylor series of 1 / cos(latitude)\n    // Max error < 0.003\n  \n    float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;\n    float y2 = y * y;\n    float y4 = y2 * y2;\n    float y6 = y4 * y2;\n    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;\n  }\n  return 1.0;\n}\n\nfloat project_size_at_latitude(float meters, float lat) {\n  return meters * project_uCommonUnitsPerMeter.z * project_size_at_latitude(lat);\n}\n\n//\n// Scaling offsets - scales meters to "world distance"\n// Note the scalar version of project_size is for scaling the z component only\n//\nfloat project_size(float meters) {\n  return meters * project_uCommonUnitsPerMeter.z * project_size();\n}\n\nvec2 project_size(vec2 meters) {\n  return meters * project_uCommonUnitsPerMeter.xy * project_size();\n}\n\nvec3 project_size(vec3 meters) {\n  return meters * project_uCommonUnitsPerMeter * project_size();\n}\n\nvec4 project_size(vec4 meters) {\n  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);\n}\n\n// Get rotation matrix that aligns the z axis with the given up vector\n// Find 3 unit vectors ux, uy, uz that are perpendicular to each other and uz == up\nmat3 project_get_orientation_matrix(vec3 up) {\n  vec3 uz = normalize(up);\n  // Tangent on XY plane\n  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));\n  vec3 uy = cross(uz, ux);\n  return mat3(ux, uy, uz);\n}\n\nbool project_needs_rotation(vec3 commonPosition, out mat3 transform) {\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    transform = project_get_orientation_matrix(commonPosition);\n    return true;\n  }\n  return false;\n}\n\n//\n// Projecting normal - transform deltas from current coordinate system to\n// normals in the worldspace\n//\nvec3 project_normal(vec3 vector) {\n  // Apply model matrix\n  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);\n  vec3 n = normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);\n  mat3 rotation;\n  if (project_needs_rotation(geometry.position.xyz, rotation)) {\n    n = rotation * n;\n  }\n  return n;\n}\n\nvec4 project_offset_(vec4 offset) {\n  float dy = offset.y;\n  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;\n  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);\n}\n\n//\n// Projecting positions - non-linear projection: lnglats => unit tile [0-1, 0-1]\n//\nvec2 project_mercator_(vec2 lnglat) {\n  float x = lnglat.x;\n  if (project_uWrapLongitude) {\n    x = mod(x + 180., 360.0) - 180.;\n  }\n  float y = clamp(lnglat.y, -89.9, 89.9);\n  return vec2(\n    radians(x) + PI,\n    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))\n  ) * WORLD_SCALE;\n}\n\nvec3 project_globe_(vec3 lnglatz) {\n  float lambda = radians(lnglatz.x);\n  float phi = radians(lnglatz.y);\n  float cosPhi = cos(phi);\n  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;\n\n  return vec3(\n    sin(lambda) * cosPhi,\n    -cos(lambda) * cosPhi,\n    sin(phi)\n  ) * D;\n}\n\n//\n// Projects positions (defined by project_uCoordinateSystem) to common space (defined by project_uProjectionMode)\n//\nvec4 project_position(vec4 position, vec3 position64Low) {\n  vec4 position_world = project_uModelMatrix * position;\n\n  // Work around for a Mac+NVIDIA bug https://github.com/visgl/deck.gl/issues/4145\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4(\n        project_mercator_(position_world.xy),\n        project_size_at_latitude(position_world.z, position_world.y),\n        position_world.w\n      );\n    }\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {\n      position_world.xyz += project_uCoordinateOrigin;\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4(\n        project_globe_(position_world.xyz),\n        position_world.w\n      );\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {\n        // Too far from the projection center for offset mode to be accurate\n        // Only use high parts\n        return vec4(\n          project_mercator_(position_world.xy) - project_uCommonOrigin.xy,\n          project_size(position_world.z),\n          position_world.w\n        );\n      }\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||\n    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&\n    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {\n    // Subtract high part of 64 bit value. Convert remainder to float32, preserving precision.\n    position_world.xyz -= project_uCoordinateOrigin;\n  }\n\n  // Translation is already added to the high parts\n  return project_offset_(position_world + project_uModelMatrix * vec4(position64Low, 0.0));\n}\n\nvec4 project_position(vec4 position) {\n  return project_position(position, ZERO_64_LOW);\n}\n\nvec3 project_position(vec3 position, vec3 position64Low) {\n  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);\n  return projected_position.xyz;\n}\n\nvec3 project_position(vec3 position) {\n  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);\n  return projected_position.xyz;\n}\n\nvec2 project_position(vec2 position) {\n  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);\n  return projected_position.xy;\n}\n\nvec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {\n  return viewProjectionMatrix * position + center;\n}\n\n//\n// Projects from common space coordinates to clip space.\n// Uses project_uViewProjectionMatrix\n//\nvec4 project_common_position_to_clipspace(vec4 position) {\n  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);\n}\n\n// Returns a clip space offset that corresponds to a given number of screen pixels\nvec2 project_pixel_size_to_clipspace(vec2 pixels) {\n  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;\n  return offset * project_uFocalDistance;\n}\n\nfloat project_size_to_pixel(float meters) {\n  return project_size(meters) * project_uScale;\n}\nfloat project_size_to_pixel(float size, int unit) {\n  if (unit == UNIT_METERS) return project_size_to_pixel(size);\n  if (unit == UNIT_COMMON) return size * project_uScale;\n  // UNIT_PIXELS\n  return size;\n}\nfloat project_pixel_size(float pixels) {\n  return pixels / project_uScale;\n}\nvec2 project_pixel_size(vec2 pixels) {\n  return pixels / project_uScale;\n}\n');var u=n(8771);const h={},d={name:"project",dependencies:[{name:"fp32",vs:"#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\nconst float TWO_PI = 6.2831854820251465;\nconst float PI_2 = 1.5707963705062866;\nconst float PI_16 = 0.1963495463132858;\n\nconst float SIN_TABLE_0 = 0.19509032368659973;\nconst float SIN_TABLE_1 = 0.3826834261417389;\nconst float SIN_TABLE_2 = 0.5555702447891235;\nconst float SIN_TABLE_3 = 0.7071067690849304;\n\nconst float COS_TABLE_0 = 0.9807852506637573;\nconst float COS_TABLE_1 = 0.9238795042037964;\nconst float COS_TABLE_2 = 0.8314695954322815;\nconst float COS_TABLE_3 = 0.7071067690849304;\n\nconst float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;\nconst float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;\nconst float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;\nconst float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;\n\nfloat sin_taylor_fp32(float a) {\n  float r, s, t, x;\n\n  if (a == 0.0) {\n    return 0.0;\n  }\n\n  x = -a * a;\n  s = a;\n  r = a;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_3;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_5;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_7;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_9;\n  s = s + t;\n\n  return s;\n}\n\nvoid sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {\n  if (a == 0.0) {\n    sin_t = 0.0;\n    cos_t = 1.0;\n  }\n  sin_t = sin_taylor_fp32(a);\n  cos_t = sqrt(1.0 - sin_t * sin_t);\n}\n\nfloat tan_taylor_fp32(float a) {\n    float sin_a;\n    float cos_a;\n\n    if (a == 0.0) {\n        return 0.0;\n    }\n    float z = floor(a / TWO_PI);\n    float r = a - TWO_PI * z;\n\n    float t;\n    float q = floor(r / PI_2 + 0.5);\n    int j = int(q);\n\n    if (j < -2 || j > 2) {\n        return 1.0 / 0.0;\n    }\n\n    t = r - PI_2 * q;\n\n    q = floor(t / PI_16 + 0.5);\n    int k = int(q);\n    int abs_k = int(abs(float(k)));\n\n    if (abs_k > 4) {\n        return 1.0 / 0.0;\n    } else {\n        t = t - PI_16 * q;\n    }\n\n    float u = 0.0;\n    float v = 0.0;\n\n    float sin_t, cos_t;\n    float s, c;\n    sincos_taylor_fp32(t, sin_t, cos_t);\n\n    if (k == 0) {\n        s = sin_t;\n        c = cos_t;\n    } else {\n        if (abs(float(abs_k) - 1.0) < 0.5) {\n            u = COS_TABLE_0;\n            v = SIN_TABLE_0;\n        } else if (abs(float(abs_k) - 2.0) < 0.5) {\n            u = COS_TABLE_1;\n            v = SIN_TABLE_1;\n        } else if (abs(float(abs_k) - 3.0) < 0.5) {\n            u = COS_TABLE_2;\n            v = SIN_TABLE_2;\n        } else if (abs(float(abs_k) - 4.0) < 0.5) {\n            u = COS_TABLE_3;\n            v = SIN_TABLE_3;\n        }\n        if (k > 0) {\n            s = u * sin_t + v * cos_t;\n            c = u * cos_t - v * sin_t;\n        } else {\n            s = u * sin_t - v * cos_t;\n            c = u * cos_t + v * sin_t;\n        }\n    }\n\n    if (j == 0) {\n        sin_a = s;\n        cos_a = c;\n    } else if (j == 1) {\n        sin_a = c;\n        cos_a = -s;\n    } else if (j == -1) {\n        sin_a = -c;\n        cos_a = s;\n    } else {\n        sin_a = -s;\n        cos_a = -c;\n    }\n    return sin_a / cos_a;\n}\n#endif\n\nfloat tan_fp32(float a) {\n#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\n  return tan_taylor_fp32(a);\n#else\n  return tan(a);\n#endif\n}\n",fs:null},r],vs:c,getUniforms:function(t=h){return"viewport"in t?(0,u.C)(t):{}}}},8771:(t,e,n)=>{"use strict";n.d(e,{C:()=>p,v:()=>f});var i=n(5975),r=n(8333),o=n(4088),s=n(8177);const a=[0,0,0,0],l=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],c=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],u=[0,0,0],h=[0,0,0],d=(0,s.Z)((function({viewport:t,devicePixelRatio:e,coordinateSystem:n,coordinateOrigin:s}){const{projectionCenter:h,viewProjectionMatrix:d,originCommon:p,cameraPosCommon:g,shaderCoordinateOrigin:m,geospatialOrigin:_}=function(t,e,n){const{viewMatrixUncentered:o,projectionMatrix:s}=t;let{viewMatrix:c,viewProjectionMatrix:u}=t,h=a,d=a,p=t.cameraPosition;const{geospatialOrigin:g,shaderCoordinateOrigin:m,offsetMode:_}=f(t,e,n);return _&&(d=t.projectPosition(g||m),p=[p[0]-d[0],p[1]-d[1],p[2]-d[2]],d[3]=1,h=r.fF([],d,u),c=o||c,u=i.Jp([],s,c),u=i.Jp([],u,l)),{viewMatrix:c,viewProjectionMatrix:u,projectionCenter:h,originCommon:d,cameraPosCommon:p,shaderCoordinateOrigin:m,geospatialOrigin:g}}(t,n,s),v=t.getDistanceScales(),b=[t.width*e,t.height*e],y=r.fF([],[0,0,-t.focalDistance,1],t.projectionMatrix)[3]||1,w={project_uCoordinateSystem:n,project_uProjectionMode:t.projectionMode,project_uCoordinateOrigin:m,project_uCommonOrigin:p.slice(0,3),project_uCenter:h,project_uPseudoMeters:Boolean(t._pseudoMeters),project_uViewportSize:b,project_uDevicePixelRatio:e,project_uFocalDistance:y,project_uCommonUnitsPerMeter:v.unitsPerMeter,project_uCommonUnitsPerWorldUnit:v.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:u,project_uScale:t.scale,project_uWrapLongitude:!1,project_uViewProjectionMatrix:d,project_uModelMatrix:c,project_uCameraPosition:g};if(_){const e=t.getDistanceScales(_);switch(n){case o.Df.METER_OFFSETS:w.project_uCommonUnitsPerWorldUnit=e.unitsPerMeter,w.project_uCommonUnitsPerWorldUnit2=e.unitsPerMeter2;break;case o.Df.LNGLAT:case o.Df.LNGLAT_OFFSETS:t._pseudoMeters||(w.project_uCommonUnitsPerMeter=e.unitsPerMeter),w.project_uCommonUnitsPerWorldUnit=e.unitsPerDegree,w.project_uCommonUnitsPerWorldUnit2=e.unitsPerDegree2;break;case o.Df.CARTESIAN:w.project_uCommonUnitsPerWorldUnit=[1,1,e.unitsPerMeter[2]],w.project_uCommonUnitsPerWorldUnit2=[0,0,e.unitsPerMeter2[2]]}}return w}));function f(t,e,n=h){n.length<3&&(n=[n[0],n[1],0]);let i,r=n,s=!0;switch(i=e===o.Df.LNGLAT_OFFSETS||e===o.Df.METER_OFFSETS?n:t.isGeospatial?[Math.fround(t.longitude),Math.fround(t.latitude),0]:null,t.projectionMode){case o.zG.WEB_MERCATOR:e!==o.Df.LNGLAT&&e!==o.Df.CARTESIAN||(i=[0,0,0],s=!1);break;case o.zG.WEB_MERCATOR_AUTO_OFFSET:e===o.Df.LNGLAT?r=i:e===o.Df.CARTESIAN&&(r=[Math.fround(t.center[0]),Math.fround(t.center[1]),0],i=t.unprojectPosition(r),r[0]-=n[0],r[1]-=n[1],r[2]-=n[2]);break;case o.zG.IDENTITY:r=t.position.map(Math.fround),r[2]=r[2]||0;break;case o.zG.GLOBE:s=!1,i=null;break;default:s=!1}return{geospatialOrigin:i,shaderCoordinateOrigin:r,offsetMode:s}}function p({viewport:t,devicePixelRatio:e=1,modelMatrix:n=null,coordinateSystem:i=o.Df.DEFAULT,coordinateOrigin:r=h,autoWrapLongitude:s=!1}){i===o.Df.DEFAULT&&(i=t.isGeospatial?o.Df.LNGLAT:o.Df.CARTESIAN);const a=d({viewport:t,devicePixelRatio:e,coordinateSystem:i,coordinateOrigin:r});return a.project_uWrapLongitude=s,a.project_uModelMatrix=n||c,a}},3844:(t,e,n)=>{"use strict";n.d(e,{Z:()=>i});const i={name:"project32",dependencies:[n(6084).Z],vs:"\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition\n) {\n  vec3 projectedPosition = project_position(position, position64Low);\n  mat3 rotation;\n  if (project_needs_rotation(projectedPosition, rotation)) {\n    // offset is specified as ENU\n    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe\n    offset = rotation * offset;\n  }\n  commonPosition = vec4(projectedPosition + offset, 1.0);\n  return project_common_position_to_clipspace(commonPosition);\n}\n\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset\n) {\n  vec4 commonPosition;\n  return project_position_to_clipspace(position, position64Low, offset, commonPosition);\n}\n"}},9191:(t,e,n)=>{"use strict";n.d(e,{Z:()=>l});var i=n(4942),r=n(4034),o=n(5304);const s=["longitude","latitude","zoom","bearing","pitch"],a=["longitude","latitude","zoom"];class l extends class{constructor(t){(0,i.Z)(this,"_propsToCompare",void 0),(0,i.Z)(this,"_propsToExtract",void 0),(0,i.Z)(this,"_requiredProps",void 0);const{compare:e,extract:n,required:r}=t;this._propsToCompare=e,this._propsToExtract=n||e,this._requiredProps=r}arePropsEqual(t,e){for(const n of this._propsToCompare)if(!(n in t)||!(n in e)||!(0,r.fS)(t[n],e[n]))return!1;return!0}initializeProps(t,e){const n={},i={};for(const r of this._propsToExtract)(r in t||r in e)&&(n[r]=t[r],i[r]=e[r]);return this._checkRequiredProps(n),this._checkRequiredProps(i),{start:n,end:i}}getDuration(t,e){return e.transitionDuration}_checkRequiredProps(t){this._requiredProps&&this._requiredProps.forEach((e=>{const n=t[e];(0,o.Z)(Number.isFinite(n)||Array.isArray(n),"".concat(e," is required for transition"))}))}}{constructor(t={}){const e=Array.isArray(t)?t:t.transitionProps,n=Array.isArray(t)?{}:t;n.transitionProps=Array.isArray(e)?{compare:e,required:e}:e||{compare:s,required:a},super(n.transitionProps),(0,i.Z)(this,"opts",void 0),this.opts=n}initializeProps(t,e){const n=super.initializeProps(t,e),{makeViewport:i,around:r}=this.opts;if(i&&r){const o=i(t),s=i(e),a=o.unproject(r);n.start.around=r,Object.assign(n.end,{around:s.project(a),aroundPosition:a,width:e.width,height:e.height})}return n}interpolateProps(t,e,n){const i={};for(const o of this._propsToExtract)i[o]=(0,r.t7)(t[o]||0,e[o]||0,n);if(e.aroundPosition&&this.opts.makeViewport){const o=this.opts.makeViewport({...e,...i});Object.assign(i,o.panByPosition(e.aroundPosition,(0,r.t7)(t.around,e.around,n)))}return i}}},3630:(t,e,n)=>{"use strict";n.d(e,{Z:()=>r});var i=n(4942);class r{constructor(t){(0,i.Z)(this,"_inProgress",void 0),(0,i.Z)(this,"_handle",void 0),(0,i.Z)(this,"_timeline",void 0),(0,i.Z)(this,"time",void 0),(0,i.Z)(this,"settings",void 0),this._inProgress=!1,this._handle=null,this._timeline=t,this.time=0,this.settings={duration:0}}get inProgress(){return this._inProgress}start(t){var e,n;this.cancel(),this.settings=t,this._inProgress=!0,null===(e=(n=this.settings).onStart)||void 0===e||e.call(n,this)}end(){var t,e;this._inProgress&&(this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,null===(t=(e=this.settings).onEnd)||void 0===t||t.call(e,this))}cancel(){var t,e;this._inProgress&&(null===(t=(e=this.settings).onInterrupt)||void 0===t||t.call(e,this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1)}update(){var t,e;if(!this._inProgress)return!1;if(null===this._handle){const{_timeline:t,settings:e}=this;this._handle=t.addChannel({delay:t.getTime(),duration:e.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),null===(t=(e=this.settings).onUpdate)||void 0===t||t.call(e,this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}},5304:(t,e,n)=>{"use strict";function i(t,e){if(!t)throw new Error(e||"deck.gl: assertion failed.")}n.d(e,{Z:()=>i})},6871:(t,e,n)=>{"use strict";function i(t,e){if(t===e)return!0;if(!t||!e)return!1;for(const n in t){const r=t[n],o=e[n];if(!(r===o||Array.isArray(r)&&Array.isArray(o)&&i(r,o)))return!1}return!0}n.d(e,{v:()=>i})},1855:(t,e,n)=>{"use strict";function i(t,e=(()=>!0)){return Array.isArray(t)?r(t,e,[]):e(t)?[t]:[]}function r(t,e,n){let i=-1;for(;++i<t.length;){const o=t[i];Array.isArray(o)?r(o,e,n):e(o)&&n.push(o)}return n}function o({target:t,source:e,start:n=0,count:i=1}){const r=e.length,o=i*r;let s=0;for(let i=n;s<r;s++)t[i++]=e[s];for(;s<o;)s<o-s?(t.copyWithin(n+s,n,n+s),s*=2):(t.copyWithin(n+s,n,n+o-s),s=o);return t}n.d(e,{k:()=>o,x:()=>i})},8550:(t,e,n)=>{"use strict";n.d(e,{D0:()=>s,jB:()=>o,jr:()=>a});const i=[],r=[];function o(t,e=0,n=1/0){let o=i;const s={index:-1,data:t,target:[]};return t?"function"==typeof t[Symbol.iterator]?o=t:t.length>0&&(r.length=t.length,o=r):o=i,(e>0||Number.isFinite(n))&&(o=(Array.isArray(o)?o:Array.from(o)).slice(e,n),s.index=e-1),{iterable:o,objectInfo:s}}function s(t){return t&&t[Symbol.asyncIterator]}function a(t,e){const{size:n,stride:i,offset:r,startIndices:o,nested:s}=e,a=t.BYTES_PER_ELEMENT,l=i?i/a:n,c=r?r/a:0,u=Math.floor((t.length-c)/l);return(e,{index:i,target:r})=>{if(!o){const e=i*l+c;for(let i=0;i<n;i++)r[i]=t[e+i];return r}const a=o[i],h=o[i+1]||u;let d;if(s){d=new Array(h-a);for(let e=a;e<h;e++){const i=e*l+c;r=new Array(n);for(let e=0;e<n;e++)r[e]=t[i+e];d[e-a]=r}}else if(l===n)d=t.subarray(a*n+c,h*n+c);else{d=new t.constructor((h-a)*n);let e=0;for(let i=a;i<h;i++){const r=i*l+c;for(let i=0;i<n;i++)d[e++]=t[r+i]}}return d}}},744:(t,e,n)=>{"use strict";n.d(e,{Z:()=>i});const i=new(n(9109).Z)({id:"deck"})},5126:(t,e,n)=>{"use strict";n.d(e,{Du:()=>l,TK:()=>d,Xt:()=>a,bS:()=>o,wQ:()=>s});var i=n(6610),r=n(3855);function o(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function s(t,e){const n=t%e;return n<0?e+n:n}function a(t){return[t[12],t[13],t[14]]}function l(t){return{left:u(t[3]+t[0],t[7]+t[4],t[11]+t[8],t[15]+t[12]),right:u(t[3]-t[0],t[7]-t[4],t[11]-t[8],t[15]-t[12]),bottom:u(t[3]+t[1],t[7]+t[5],t[11]+t[9],t[15]+t[13]),top:u(t[3]-t[1],t[7]-t[5],t[11]-t[9],t[15]-t[13]),near:u(t[3]+t[2],t[7]+t[6],t[11]+t[10],t[15]+t[14]),far:u(t[3]-t[2],t[7]-t[6],t[11]-t[10],t[15]-t[14])}}const c=new r.Z;function u(t,e,n,i){c.set(t,e,n);const o=c.len();return{distance:i/o,normal:new r.Z(-t/o,-e/o,-n/o)}}let h;function d(t,e){const{size:n=1,startIndex:r=0}=e,o=void 0!==e.endIndex?e.endIndex:t.length,s=(o-r)/n;h=i.Z.allocate(h,s,{type:Float32Array,size:2*n});let a=r,l=0;for(;a<o;){for(let e=0;e<n;e++){const i=t[a++];h[l+e]=i,h[l+e+n]=(c=i)-Math.fround(c)}l+=2*n}var c;return h.subarray(0,s*n*2)}},8177:(t,e,n)=>{"use strict";function i(t,e){if(t===e)return!0;if(Array.isArray(t)){const n=t.length;if(!e||e.length!==n)return!1;for(let i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}return!1}function r(t){let e,n={};return r=>{for(const o in r)if(!i(r[o],n[o])){e=t(r),n=r;break}return e}}n.d(e,{Z:()=>r})},6610:(t,e,n)=>{"use strict";n.d(e,{Z:()=>r});var i=n(4942);const r=new class{constructor(t={}){(0,i.Z)(this,"_pool",[]),(0,i.Z)(this,"opts",{overAlloc:2,poolSize:100}),this.setOptions(t)}setOptions(t){Object.assign(this.opts,t)}allocate(t,e,{size:n=1,type:i,padding:r=0,copy:o=!1,initialize:s=!1,maxCount:a}){const l=i||t&&t.constructor||Float32Array,c=e*n+r;if(ArrayBuffer.isView(t)){if(c<=t.length)return t;if(c*t.BYTES_PER_ELEMENT<=t.buffer.byteLength)return new l(t.buffer,0,c)}let u=1/0;a&&(u=a*n+r);const h=this._allocate(l,c,s,u);return t&&o?h.set(t):s||h.fill(0,0,4),this._release(t),h}release(t){this._release(t)}_allocate(t,e,n,i){let r=Math.max(Math.ceil(e*this.opts.overAlloc),1);r>i&&(r=i);const o=this._pool,s=t.BYTES_PER_ELEMENT*r,a=o.findIndex((t=>t.byteLength>=s));if(a>=0){const e=new t(o.splice(a,1)[0],0,r);return n&&e.fill(0),e}return new t(r)}_release(t){if(!ArrayBuffer.isView(t))return;const e=this._pool,{buffer:n}=t,{byteLength:i}=n,r=e.findIndex((t=>t.byteLength>=i));r<0?e.push(n):(r>0||e.length<this.opts.poolSize)&&e.splice(r,0,n),e.length>this.opts.poolSize&&e.shift()}}},7013:(t,e,n)=>{"use strict";n.d(e,{Z:()=>m});var i=n(4942),r=n(744),o=n(5126),s=n(5451),a=n(4034),l=n(3855),c=n(5975),u=n(6018),h=n(4088);const d=Math.PI/180,f=(0,o.bS)(),p=[0,0,0],g={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};class m{constructor(t={}){(0,i.Z)(this,"id",void 0),(0,i.Z)(this,"x",void 0),(0,i.Z)(this,"y",void 0),(0,i.Z)(this,"width",void 0),(0,i.Z)(this,"height",void 0),(0,i.Z)(this,"padding",void 0),(0,i.Z)(this,"isGeospatial",void 0),(0,i.Z)(this,"zoom",void 0),(0,i.Z)(this,"focalDistance",void 0),(0,i.Z)(this,"position",void 0),(0,i.Z)(this,"modelMatrix",void 0),(0,i.Z)(this,"distanceScales",void 0),(0,i.Z)(this,"scale",void 0),(0,i.Z)(this,"center",void 0),(0,i.Z)(this,"cameraPosition",void 0),(0,i.Z)(this,"projectionMatrix",void 0),(0,i.Z)(this,"viewMatrix",void 0),(0,i.Z)(this,"viewMatrixUncentered",void 0),(0,i.Z)(this,"viewMatrixInverse",void 0),(0,i.Z)(this,"viewProjectionMatrix",void 0),(0,i.Z)(this,"pixelProjectionMatrix",void 0),(0,i.Z)(this,"pixelUnprojectionMatrix",void 0),(0,i.Z)(this,"resolution",void 0),(0,i.Z)(this,"_frustumPlanes",{}),this.id=t.id||this.constructor.displayName||"viewport",this.x=t.x||0,this.y=t.y||0,this.width=t.width||1,this.height=t.height||1,this.zoom=t.zoom||0,this.padding=t.padding,this.distanceScales=t.distanceScales||g,this.focalDistance=t.focalDistance||1,this.position=t.position||p,this.modelMatrix=t.modelMatrix||null;const{longitude:e,latitude:n}=t;this.isGeospatial=Number.isFinite(n)&&Number.isFinite(e),this._initProps(t),this._initMatrices(t),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?h.zG.WEB_MERCATOR:h.zG.WEB_MERCATOR_AUTO_OFFSET:h.zG.IDENTITY}equals(t){return t instanceof m&&(this===t||t.width===this.width&&t.height===this.height&&t.scale===this.scale&&(0,a.fS)(t.projectionMatrix,this.projectionMatrix)&&(0,a.fS)(t.viewMatrix,this.viewMatrix))}project(t,{topLeft:e=!0}={}){const n=this.projectPosition(t),i=(0,u.aW)(n,this.pixelProjectionMatrix),[r,o]=i,s=e?o:this.height-o;return 2===t.length?[r,s]:[r,s,i[2]]}unproject(t,{topLeft:e=!0,targetZ:n}={}){const[i,r,o]=t,s=e?r:this.height-r,a=n&&n*this.distanceScales.unitsPerMeter[2],l=(0,u.CT)([i,s,o],this.pixelUnprojectionMatrix,a),[c,h,d]=this.unprojectPosition(l);return Number.isFinite(o)?[c,h,d]:Number.isFinite(n)?[c,h,n]:[c,h]}projectPosition(t){const[e,n]=this.projectFlat(t);return[e,n,(t[2]||0)*this.distanceScales.unitsPerMeter[2]]}unprojectPosition(t){const[e,n]=this.unprojectFlat(t);return[e,n,(t[2]||0)*this.distanceScales.metersPerUnit[2]]}projectFlat(t){if(this.isGeospatial){const e=(0,u.w5)(t);return e[1]=(0,a.uZ)(e[1],-318,830),e}return t}unprojectFlat(t){return this.isGeospatial?(0,u.es)(t):t}getBounds(t={}){const e={targetZ:t.z||0},n=this.unproject([0,0],e),i=this.unproject([this.width,0],e),r=this.unproject([0,this.height],e),o=this.unproject([this.width,this.height],e);return[Math.min(n[0],i[0],r[0],o[0]),Math.min(n[1],i[1],r[1],o[1]),Math.max(n[0],i[0],r[0],o[0]),Math.max(n[1],i[1],r[1],o[1])]}getDistanceScales(t){return t?(0,u.ro)({longitude:t[0],latitude:t[1],highPrecision:!0}):this.distanceScales}containsPixel({x:t,y:e,width:n=1,height:i=1}){return t<this.x+this.width&&this.x<t+n&&e<this.y+this.height&&this.y<e+i}getFrustumPlanes(){return this._frustumPlanes.near||Object.assign(this._frustumPlanes,(0,o.Du)(this.viewProjectionMatrix)),this._frustumPlanes}panByPosition(t,e){return null}_initProps(t){const e=t.longitude,n=t.latitude;this.isGeospatial&&(Number.isFinite(t.zoom)||(this.zoom=(0,u.Bf)({latitude:n})+Math.log2(this.focalDistance)),this.distanceScales=t.distanceScales||(0,u.ro)({latitude:n,longitude:e}));const i=Math.pow(2,this.zoom);this.scale=i;const{position:r,modelMatrix:o}=t;let a=p;if(r&&(a=o?new s.Z(o).transformAsVector(r,[]):r),this.isGeospatial){const t=this.projectPosition([e,n,0]);this.center=new l.Z(a).scale(this.distanceScales.unitsPerMeter).add(t)}else this.center=this.projectPosition(a)}_initMatrices(t){const{viewMatrix:e=f,projectionMatrix:n=null,orthographic:i=!1,fovyRadians:u,fovy:h=75,near:p=.1,far:g=1e3,padding:m=null,focalDistance:_=1}=t;this.viewMatrixUncentered=e,this.viewMatrix=(new s.Z).multiplyRight(e).translate(new l.Z(this.center).negate()),this.projectionMatrix=n||function({width:t,height:e,orthographic:n,fovyRadians:i,focalDistance:r,padding:o,near:l,far:c}){const u=t/e,h=n?(new s.Z).orthographic({fovy:i,aspect:u,focalDistance:r,near:l,far:c}):(new s.Z).perspective({fovy:i,aspect:u,near:l,far:c});if(o){const{left:n=0,right:i=0,top:r=0,bottom:s=0}=o,l=(0,a.uZ)((n+t-i)/2,0,t)-t/2,c=(0,a.uZ)((r+e-s)/2,0,e)-e/2;h[8]-=2*l/t,h[9]+=2*c/e}return h}({width:this.width,height:this.height,orthographic:i,fovyRadians:u||h*d,focalDistance:_,padding:m,near:p,far:g});const v=(0,o.bS)();c.Jp(v,v,this.projectionMatrix),c.Jp(v,v,this.viewMatrix),this.viewProjectionMatrix=v,this.viewMatrixInverse=c.U_([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=(0,o.Xt)(this.viewMatrixInverse);const b=(0,o.bS)(),y=(0,o.bS)();c.bA(b,b,[this.width/2,-this.height/2,1]),c.Iu(b,b,[1,-1,0]),c.Jp(y,b,this.viewProjectionMatrix),this.pixelProjectionMatrix=y,this.pixelUnprojectionMatrix=c.U_((0,o.bS)(),this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||r.Z.warn("Pixel project matrix not invertible")()}}(0,i.Z)(m,"displayName","Viewport")},9970:(t,e,n)=>{"use strict";n.d(e,{Z:()=>u});var i=n(4942),r=n(7013),o=n(6018),s=n(1437),a=n(5451);const l=Math.PI/180;function c(t){return 512/4003e4/Math.cos(t*l)}class u extends r.Z{constructor(t={}){const{latitude:e=0,longitude:n=0,zoom:r=0,pitch:s=0,bearing:l=0,nearZMultiplier:c=.1,farZMultiplier:u=1.01,orthographic:h=!1,projectionMatrix:d,repeat:f=!1,worldOffset:p=0,legacyMeterSizes:g=!1}=t;let{width:m,height:_,altitude:v=1.5}=t;const b=Math.pow(2,r);let y;m=m||1,_=_||1;let w=null;d?(v=d[5]/2,y=(0,o.Lu)(v)):(t.fovy?(y=t.fovy,v=(0,o.sj)(y)):y=(0,o.Lu)(v),w=(0,o.wl)({width:m,height:_,pitch:s,fovy:y,nearZMultiplier:c,farZMultiplier:u}));let x=(0,o.lf)({height:_,pitch:s,bearing:l,scale:b,altitude:v});p&&(x=(new a.Z).translate([512*p,0,0]).multiplyLeft(x)),super({...t,width:m,height:_,viewMatrix:x,longitude:n,latitude:e,zoom:r,...w,fovy:y,focalDistance:v}),(0,i.Z)(this,"longitude",void 0),(0,i.Z)(this,"latitude",void 0),(0,i.Z)(this,"pitch",void 0),(0,i.Z)(this,"bearing",void 0),(0,i.Z)(this,"altitude",void 0),(0,i.Z)(this,"fovy",void 0),(0,i.Z)(this,"orthographic",void 0),(0,i.Z)(this,"_subViewports",void 0),(0,i.Z)(this,"_pseudoMeters",void 0),this.latitude=e,this.longitude=n,this.zoom=r,this.pitch=s,this.bearing=l,this.altitude=v,this.fovy=y,this.orthographic=h,this._subViewports=f?[]:null,this._pseudoMeters=g,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const t=this.getBounds(),e=Math.floor((t[0]+180)/360),n=Math.ceil((t[2]-180)/360);for(let t=e;t<=n;t++){const e=t?new u({...this,worldOffset:t}):this;this._subViewports.push(e)}}return this._subViewports}projectPosition(t){if(this._pseudoMeters)return super.projectPosition(t);const[e,n]=this.projectFlat(t);return[e,n,(t[2]||0)*c(t[1])]}unprojectPosition(t){if(this._pseudoMeters)return super.unprojectPosition(t);const[e,n]=this.unprojectFlat(t);return[e,n,(t[2]||0)/c(n)]}addMetersToLngLat(t,e){return(0,o.eG)(t,e)}panByPosition(t,e){const n=(0,o.CT)(e,this.pixelUnprojectionMatrix),i=this.projectFlat(t),r=s.IH([],i,s.tk([],n)),a=s.IH([],this.center,r),[l,c]=this.unprojectFlat(a);return{longitude:l,latitude:c}}getBounds(t={}){const e=(0,o.zX)(this,t.z||0);return[Math.min(e[0][0],e[1][0],e[2][0],e[3][0]),Math.min(e[0][1],e[1][1],e[2][1],e[3][1]),Math.max(e[0][0],e[1][0],e[2][0],e[3][0]),Math.max(e[0][1],e[1][1],e[2][1],e[3][1])]}fitBounds(t,e={}){const{width:n,height:i}=this,{longitude:r,latitude:s,zoom:a}=(0,o.Xg)({width:n,height:i,bounds:t,...e});return new u({width:n,height:i,longitude:r,latitude:s,zoom:a})}}(0,i.Z)(u,"displayName","WebMercatorViewport")},6786:(t,e,n)=>{"use strict";n.d(e,{Z:()=>v});var i=n(4942),r=n(4897),o=n(7013),s=n(5451),a=n(4034),l=n(6018),c=n(1437);const u=(new s.Z).lookAt({eye:[0,0,1]});function h({width:t,height:e,near:n,far:i,padding:r}){let o=-t/2,l=t/2,c=-e/2,u=e/2;if(r){const{left:n=0,right:i=0,top:s=0,bottom:h=0}=r,d=(0,a.uZ)((n+t-i)/2,0,t)-t/2,f=(0,a.uZ)((s+e-h)/2,0,e)-e/2;o-=d,l-=d,c+=f,u+=f}return(new s.Z).ortho({left:o,right:l,bottom:c,top:u,near:n,far:i})}class d extends o.Z{constructor(t){const{width:e,height:n,near:i=.1,far:r=1e3,zoom:o=0,target:s=[0,0,0],padding:a=null,flipY:l=!0}=t,c=Array.isArray(o)?o[0]:o,d=Array.isArray(o)?o[1]:o,f=Math.min(c,d),p=Math.pow(2,f);let g;if(c!==d){const t=Math.pow(2,c),e=Math.pow(2,d);g={unitsPerMeter:[t/p,e/p,1],metersPerUnit:[p/t,p/e,1]}}super({...t,longitude:void 0,position:s,viewMatrix:u.clone().scale([p,p*(l?-1:1),p]),projectionMatrix:h({width:e||1,height:n||1,padding:a,near:i,far:r}),zoom:f,distanceScales:g})}projectFlat([t,e]){const{unitsPerMeter:n}=this.distanceScales;return[t*n[0],e*n[1]]}unprojectFlat([t,e]){const{metersPerUnit:n}=this.distanceScales;return[t*n[0],e*n[1]]}panByPosition(t,e){const n=(0,l.CT)(e,this.pixelUnprojectionMatrix),i=this.projectFlat(t),r=c.IH([],i,c.tk([],n)),o=c.IH([],this.center,r);return{target:this.unprojectFlat(o)}}}var f=n(6688),p=n(7557),g=n(9191);class m extends p.G{constructor(t){super(t),(0,i.Z)(this,"zoomAxis",void 0),this.zoomAxis=t.zoomAxis||"all"}_calculateNewZoom({scale:t,startZoom:e}){const{maxZoom:n,minZoom:i}=this.getViewportProps();void 0===e&&(e=this.getViewportProps().zoom);let r=Math.log2(t);if(Array.isArray(e)){let[t,o]=e;switch(this.zoomAxis){case"X":t=(0,a.uZ)(t+r,i,n);break;case"Y":o=(0,a.uZ)(o+r,i,n);break;default:let e=Math.min(t+r,o+r);e<i&&(r+=i-e),e=Math.max(t+r,o+r),e>n&&(r+=n-e),t+=r,o+=r}return[t,o]}return(0,a.uZ)(e+r,i,n)}}class _ extends f.Z{constructor(...t){super(...t),(0,i.Z)(this,"ControllerState",m),(0,i.Z)(this,"transition",{transitionDuration:300,transitionInterpolator:new g.Z(["target","zoom"])}),(0,i.Z)(this,"dragMode","pan")}_onPanRotate(){return!1}}class v extends r.Z{get ViewportType(){return d}get ControllerType(){return _}}(0,i.Z)(v,"displayName","OrthographicView")},4897:(t,e,n)=>{"use strict";n.d(e,{Z:()=>u});var i=n(4942),r=n(7013);const o=/([0-9]+\.?[0-9]*)(%|px)/;function s(t){switch(typeof t){case"number":return{position:t,relative:!1};case"string":const e=o.exec(t);if(e&&e.length>=3){const t="%"===e[2],n=parseFloat(e[1]);return{position:t?n/100:n,relative:t}}default:throw new Error("Could not parse position string ".concat(t))}}function a(t,e){return t.relative?Math.round(t.position*e):t.position}var l=n(6871),c=n(5304);class u{constructor(t){(0,i.Z)(this,"id",void 0),(0,i.Z)(this,"viewportInstance",void 0),(0,i.Z)(this,"_x",void 0),(0,i.Z)(this,"_y",void 0),(0,i.Z)(this,"_width",void 0),(0,i.Z)(this,"_height",void 0),(0,i.Z)(this,"_padding",void 0),(0,i.Z)(this,"props",void 0);const{id:e,x:n=0,y:o=0,width:a="100%",height:l="100%",padding:u=null,viewportInstance:h}=t||{};(0,c.Z)(!h||h instanceof r.Z),this.viewportInstance=h,this.id=e||this.constructor.displayName||"view",this.props={...t,id:this.id},this._x=s(n),this._y=s(o),this._width=s(a),this._height=s(l),this._padding=u&&{left:s(u.left||0),right:s(u.right||0),top:s(u.top||0),bottom:s(u.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(t){return this===t||(this.viewportInstance?!!t.viewportInstance&&this.viewportInstance.equals(t.viewportInstance):this.ViewportType===t.ViewportType&&(0,l.v)(this.props,t.props))}makeViewport({width:t,height:e,viewState:n}){if(this.viewportInstance)return this.viewportInstance;n=this.filterViewState(n);const i=this.getDimensions({width:t,height:e});return new this.ViewportType({...n,...this.props,...i})}getViewStateId(){const{viewState:t}=this.props;return"string"==typeof t?t:(null==t?void 0:t.id)||this.id}filterViewState(t){if(this.props.viewState&&"object"==typeof this.props.viewState){if(!this.props.viewState.id)return this.props.viewState;const e={...t};for(const t in this.props.viewState)"id"!==t&&(e[t]=this.props.viewState[t]);return e}return t}getDimensions({width:t,height:e}){const n={x:a(this._x,t),y:a(this._y,e),width:a(this._width,t),height:a(this._height,e)};return this._padding&&(n.padding={left:a(this._padding.left,t),top:a(this._padding.top,e),right:a(this._padding.right,t),bottom:a(this._padding.bottom,e)}),n}get controller(){const t=this.props.controller;return t?!0===t?{type:this.ControllerType}:"function"==typeof t?{type:t}:{type:this.ControllerType,...t}:null}}},8569:(t,e,n)=>{"use strict";n.d(e,{Z:()=>d});var i=n(4942),r=n(5522),o=n(3844),s=n(1331),a=n(4088),l=n(9769),c=n(3982);const u=[0,0,0,255],h={radiusUnits:"meters",radiusScale:{type:"number",min:0,value:1},radiusMinPixels:{type:"number",min:0,value:0},radiusMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},lineWidthUnits:"meters",lineWidthScale:{type:"number",min:0,value:1},lineWidthMinPixels:{type:"number",min:0,value:0},lineWidthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},stroked:!1,filled:!0,billboard:!1,antialiasing:!0,getPosition:{type:"accessor",value:t=>t.position},getRadius:{type:"accessor",value:1},getFillColor:{type:"accessor",value:u},getLineColor:{type:"accessor",value:u},getLineWidth:{type:"accessor",value:1},strokeWidth:{deprecatedFor:"getLineWidth"},outline:{deprecatedFor:"stroked"},getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class d extends r.Z{getShaders(){return super.getShaders({vs:"#define SHADER_NAME scatterplot-layer-vertex-shader\n\nattribute vec3 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute float instanceRadius;\nattribute float instanceLineWidths;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\nuniform float opacity;\nuniform float radiusScale;\nuniform float radiusMinPixels;\nuniform float radiusMaxPixels;\nuniform float lineWidthScale;\nuniform float lineWidthMinPixels;\nuniform float lineWidthMaxPixels;\nuniform float stroked;\nuniform bool filled;\nuniform bool antialiasing;\nuniform bool billboard;\nuniform int radiusUnits;\nuniform int lineWidthUnits;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying vec2 unitPosition;\nvarying float innerUnitRadius;\nvarying float outerRadiusPixels;\n\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n\n  // Multiply out radius and clamp to limits\n  outerRadiusPixels = clamp(\n    project_size_to_pixel(radiusScale * instanceRadius, radiusUnits),\n    radiusMinPixels, radiusMaxPixels\n  );\n  \n  // Multiply out line width and clamp to limits\n  float lineWidthPixels = clamp(\n    project_size_to_pixel(lineWidthScale * instanceLineWidths, lineWidthUnits),\n    lineWidthMinPixels, lineWidthMaxPixels\n  );\n\n  // outer radius needs to offset by half stroke width\n  outerRadiusPixels += stroked * lineWidthPixels / 2.0;\n\n  // Expand geometry to accomodate edge smoothing\n  float edgePadding = antialiasing ? (outerRadiusPixels + SMOOTH_EDGE_RADIUS) / outerRadiusPixels : 1.0;\n\n  // position on the containing square in [-1, 1] space\n  unitPosition = edgePadding * positions.xy;\n  geometry.uv = unitPosition;\n  geometry.pickingColor = instancePickingColors;\n\n  innerUnitRadius = 1.0 - stroked * lineWidthPixels / outerRadiusPixels;\n  \n  if (billboard) {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    vec3 offset = edgePadding * positions * outerRadiusPixels;\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n  } else {\n    vec3 offset = edgePadding * positions * project_pixel_size(outerRadiusPixels);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset, geometry.position);\n  }\n\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  // Apply opacity to instance color, or return instance picking color\n  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);\n  DECKGL_FILTER_COLOR(vFillColor, geometry);\n  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);\n  DECKGL_FILTER_COLOR(vLineColor, geometry);\n}\n",fs:"#define SHADER_NAME scatterplot-layer-fragment-shader\n\nprecision highp float;\n\nuniform bool filled;\nuniform float stroked;\nuniform bool antialiasing;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying vec2 unitPosition;\nvarying float innerUnitRadius;\nvarying float outerRadiusPixels;\n\nvoid main(void) {\n  geometry.uv = unitPosition;\n\n  float distToCenter = length(unitPosition) * outerRadiusPixels;\n  float inCircle = antialiasing ? \n    smoothedge(distToCenter, outerRadiusPixels) : \n    step(distToCenter, outerRadiusPixels);\n\n  if (inCircle == 0.0) {\n    discard;\n  }\n\n  if (stroked > 0.5) {\n    float isLine = antialiasing ? \n      smoothedge(innerUnitRadius * outerRadiusPixels, distToCenter) :\n      step(innerUnitRadius * outerRadiusPixels, distToCenter);\n\n    if (filled) {\n      gl_FragColor = mix(vFillColor, vLineColor, isLine);\n    } else {\n      if (isLine == 0.0) {\n        discard;\n      }\n      gl_FragColor = vec4(vLineColor.rgb, vLineColor.a * isLine);\n    }\n  } else if (filled) {\n    gl_FragColor = vFillColor;\n  } else {\n    discard;\n  }\n\n  gl_FragColor.a *= inCircle;\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[o.Z,s.Z]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceRadius:{size:1,transition:!0,accessor:"getRadius",defaultValue:1},instanceFillColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(t){if(super.updateState(t),t.changeFlags.extensionsChanged){var e;const{gl:t}=this.context;null===(e=this.state.model)||void 0===e||e.delete(),this.state.model=this._getModel(t),this.getAttributeManager().invalidateAll()}}draw({uniforms:t}){const{radiusUnits:e,radiusScale:n,radiusMinPixels:i,radiusMaxPixels:r,stroked:o,filled:s,billboard:l,antialiasing:c,lineWidthUnits:u,lineWidthScale:h,lineWidthMinPixels:d,lineWidthMaxPixels:f}=this.props;this.state.model.setUniforms(t).setUniforms({stroked:o?1:0,filled:s,billboard:l,antialiasing:c,radiusUnits:a.iI[e],radiusScale:n,radiusMinPixels:i,radiusMaxPixels:r,lineWidthUnits:a.iI[u],lineWidthScale:h,lineWidthMinPixels:d,lineWidthMaxPixels:f}).draw()}_getModel(t){return new l.Z(t,{...this.getShaders(),id:this.props.id,geometry:new c.Z({drawMode:6,vertexCount:4,attributes:{positions:{size:3,value:new Float32Array([-1,-1,0,1,-1,0,1,1,0,-1,1,0])}}}),isInstanced:!0})}}(0,i.Z)(d,"defaultProps",h),(0,i.Z)(d,"layerName","ScatterplotLayer")},6255:(t,e,n)=>{"use strict";n.d(e,{D0:()=>a,Ew:()=>l,Kn:()=>r,Lj:()=>c,Os:()=>h,Ss:()=>o,TW:()=>s,zH:()=>u});const i=t=>"function"==typeof t,r=t=>null!==t&&"object"==typeof t,o=t=>r(t)&&t.constructor==={}.constructor,s=t=>t&&"function"==typeof t[Symbol.iterator],a=t=>t&&"function"==typeof t[Symbol.asyncIterator],l=t=>"undefined"!=typeof Response&&t instanceof Response||t&&t.arrayBuffer&&t.text&&t.json,c=t=>"undefined"!=typeof Blob&&t instanceof Blob,u=t=>t&&"object"==typeof t&&t.isBuffer,h=t=>(t=>"undefined"!=typeof ReadableStream&&t instanceof ReadableStream||r(t)&&i(t.tee)&&i(t.cancel)&&i(t.getReader))(t)||(t=>r(t)&&i(t.read)&&i(t.pipe)&&(t=>"boolean"==typeof t)(t.readable))(t)},1469:(t,e,n)=>{"use strict";n.d(e,{z:()=>$});var i=n(6255),r=n(2033),o=n(7504);function s(t,e){if(!t)throw new Error(e||"loaders.gl assertion failed.")}"undefined"!=typeof self&&self,"undefined"!=typeof window&&window,void 0!==n.g&&n.g,"undefined"!=typeof document&&document;const a="object"!=typeof process||"[object process]"!==String(process)||process.browser,l="undefined"!=typeof window&&void 0!==window.orientation,c="undefined"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version);c&&parseFloat(c[1]);var u=n(4942);class h{}const d=new Map;function f(t){const e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function p(t,e=!0,n){const i=n||new Set;if(t)if(g(t))i.add(t);else if(g(t.buffer))i.add(t.buffer);else if(ArrayBuffer.isView(t));else if(e&&"object"==typeof t)for(const n in t)p(t[n],e,i);return void 0===n?Array.from(i):[]}function g(t){return!!t&&(t instanceof ArrayBuffer||"undefined"!=typeof MessagePort&&t instanceof MessagePort||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap||"undefined"!=typeof OffscreenCanvas&&t instanceof OffscreenCanvas)}const m=()=>{};class _{static isSupported(){return"undefined"!=typeof Worker&&a||void 0!==h&&!a}constructor(t){(0,u.Z)(this,"name",void 0),(0,u.Z)(this,"source",void 0),(0,u.Z)(this,"url",void 0),(0,u.Z)(this,"terminated",!1),(0,u.Z)(this,"worker",void 0),(0,u.Z)(this,"onMessage",void 0),(0,u.Z)(this,"onError",void 0),(0,u.Z)(this,"_loadableURL","");const{name:e,source:n,url:i}=t;s(n||i),this.name=e,this.source=n,this.url=i,this.onMessage=m,this.onError=t=>console.log(t),this.worker=a?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=m,this.onError=m,this.worker.terminate(),this.terminated=!0}get isRunning(){return Boolean(this.onMessage)}postMessage(t,e){e=e||p(t),this.worker.postMessage(t,e)}_getErrorFromErrorEvent(t){let e="Failed to load ";return e+="worker ".concat(this.name," from ").concat(this.url,". "),t.message&&(e+="".concat(t.message," in ")),t.lineno&&(e+=":".concat(t.lineno,":").concat(t.colno)),new Error(e)}_createBrowserWorker(){this._loadableURL=function(t){s(t.source&&!t.url||!t.source&&t.url);let e=d.get(t.source||t.url);return e||(t.url&&(e=(n=t.url).startsWith("http")?f("try {\n  importScripts('".concat(n,"');\n} catch (error) {\n  console.error(error);\n  throw error;\n}")):n,d.set(t.url,e)),t.source&&(e=f(t.source),d.set(t.source,e))),s(e),e;var n}({source:this.source,url:this.url});const t=new Worker(this._loadableURL,{name:this.name});return t.onmessage=t=>{t.data?this.onMessage(t.data):this.onError(new Error("No data received"))},t.onerror=t=>{this.onError(this._getErrorFromErrorEvent(t)),this.terminated=!0},t.onmessageerror=t=>console.error(t),t}_createNodeWorker(){let t;if(this.url){const e=this.url.includes(":/")||this.url.startsWith("/")?this.url:"./".concat(this.url);t=new h(e,{eval:!1})}else{if(!this.source)throw new Error("no worker");t=new h(this.source,{eval:!0})}return t.on("message",(t=>{this.onMessage(t)})),t.on("error",(t=>{this.onError(t)})),t.on("exit",(t=>{})),t}}class v{constructor(t,e){(0,u.Z)(this,"name",void 0),(0,u.Z)(this,"workerThread",void 0),(0,u.Z)(this,"isRunning",!0),(0,u.Z)(this,"result",void 0),(0,u.Z)(this,"_resolve",(()=>{})),(0,u.Z)(this,"_reject",(()=>{})),this.name=t,this.workerThread=e,this.result=new Promise(((t,e)=>{this._resolve=t,this._reject=e}))}postMessage(t,e){this.workerThread.postMessage({source:"loaders.gl",type:t,payload:e})}done(t){s(this.isRunning),this.isRunning=!1,this._resolve(t)}error(t){s(this.isRunning),this.isRunning=!1,this._reject(t)}}class b{static isSupported(){return _.isSupported()}constructor(t){(0,u.Z)(this,"name","unnamed"),(0,u.Z)(this,"source",void 0),(0,u.Z)(this,"url",void 0),(0,u.Z)(this,"maxConcurrency",1),(0,u.Z)(this,"maxMobileConcurrency",1),(0,u.Z)(this,"onDebug",(()=>{})),(0,u.Z)(this,"reuseWorkers",!0),(0,u.Z)(this,"props",{}),(0,u.Z)(this,"jobQueue",[]),(0,u.Z)(this,"idleQueue",[]),(0,u.Z)(this,"count",0),(0,u.Z)(this,"isDestroyed",!1),this.source=t.source,this.url=t.url,this.setProps(t)}destroy(){this.idleQueue.forEach((t=>t.destroy())),this.isDestroyed=!0}setProps(t){this.props={...this.props,...t},void 0!==t.name&&(this.name=t.name),void 0!==t.maxConcurrency&&(this.maxConcurrency=t.maxConcurrency),void 0!==t.maxMobileConcurrency&&(this.maxMobileConcurrency=t.maxMobileConcurrency),void 0!==t.reuseWorkers&&(this.reuseWorkers=t.reuseWorkers),void 0!==t.onDebug&&(this.onDebug=t.onDebug)}async startJob(t,e=((t,e,n)=>t.done(n)),n=((t,e)=>t.error(e))){const i=new Promise((i=>(this.jobQueue.push({name:t,onMessage:e,onError:n,onStart:i}),this)));return this._startQueuedJob(),await i}async _startQueuedJob(){if(!this.jobQueue.length)return;const t=this._getAvailableWorker();if(!t)return;const e=this.jobQueue.shift();if(e){this.onDebug({message:"Starting job",name:e.name,workerThread:t,backlog:this.jobQueue.length});const n=new v(e.name,t);t.onMessage=t=>e.onMessage(n,t.type,t.payload),t.onError=t=>e.onError(n,t),e.onStart(n);try{await n.result}finally{this.returnWorkerToQueue(t)}}}returnWorkerToQueue(t){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(t.destroy(),this.count--):this.idleQueue.push(t),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const t="".concat(this.name.toLowerCase()," (#").concat(this.count," of ").concat(this.maxConcurrency,")");return new _({name:t,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return l?this.maxMobileConcurrency:this.maxConcurrency}}const y={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class w{static isSupported(){return _.isSupported()}static getWorkerFarm(t={}){return w._workerFarm=w._workerFarm||new w({}),w._workerFarm.setProps(t),w._workerFarm}constructor(t){(0,u.Z)(this,"props",void 0),(0,u.Z)(this,"workerPools",new Map),this.props={...y},this.setProps(t),this.workerPools=new Map}destroy(){for(const t of this.workerPools.values())t.destroy();this.workerPools=new Map}setProps(t){this.props={...this.props,...t};for(const t of this.workerPools.values())t.setProps(this._getWorkerPoolProps())}getWorkerPool(t){const{name:e,source:n,url:i}=t;let r=this.workerPools.get(e);return r||(r=new b({name:e,source:n,url:i}),r.setProps(this._getWorkerPoolProps()),this.workerPools.set(e,r)),r}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}async function x(t,e,n,i,r){const o=t.id,a=function(t,e={}){const n=e[t.id]||{},i="".concat(t.id,"-worker.js");let r=n.workerUrl;if(r||"compression"!==t.id||(r=e.workerUrl),"test"===e._workerType&&(r="modules/".concat(t.module,"/dist/").concat(i)),!r){let e=t.version;"latest"===e&&(e="latest");const n=e?"@".concat(e):"";r="https://unpkg.com/@loaders.gl/".concat(t.module).concat(n,"/dist/").concat(i)}return s(r),r}(t,n),l=w.getWorkerFarm(n).getWorkerPool({name:o,url:a});n=JSON.parse(JSON.stringify(n)),i=JSON.parse(JSON.stringify(i||{}));const c=await l.startJob("process-on-worker",C.bind(null,r));c.postMessage("process",{input:e,options:n,context:i});const u=await c.result;return await u.result}async function C(t,e,n,i){switch(n){case"done":e.done(i);break;case"error":e.error(new Error(i.error));break;case"process":const{id:r,input:o,options:s}=i;try{const n=await t(o,s);e.postMessage("done",{id:r,result:n})}catch(t){const n=t instanceof Error?t.message:"unknown error";e.postMessage("error",{id:r,error:n})}break;default:console.warn("parse-with-worker unknown message ".concat(n))}}function k(t){return t&&"object"==typeof t&&t.isBuffer}function E(t){if(k(t))return k(e=t)?new Uint8Array(e.buffer,e.byteOffset,e.length).slice().buffer:e;var e;if(t instanceof ArrayBuffer)return t;if(ArrayBuffer.isView(t))return 0===t.byteOffset&&t.byteLength===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);if("string"==typeof t){const e=t;return(new TextEncoder).encode(e).buffer}if(t&&"object"==typeof t&&t._toArrayBuffer)return t._toArrayBuffer();throw new Error("toArrayBuffer")}(0,u.Z)(w,"_workerFarm",void 0),n(479);const S=262144;var A=n(4959);function T(t,e){return A.jU?async function*(t,e){const n=t.getReader();let i;try{for(;;){const t=i||n.read();null!=e&&e._streamReadAhead&&(i=n.read());const{done:r,value:o}=await t;if(r)return;yield E(o)}}catch(t){n.releaseLock()}}(t,e):async function*(t,e){for await(const e of t)yield E(e)}(t)}var M=n(7927);const D="Cannot convert supplied data type";async function P(t,e,n){const r=t instanceof ArrayBuffer||ArrayBuffer.isView(t);if("string"==typeof t||r)return function(t,e,n){if(e.text&&"string"==typeof t)return t;if((0,i.zH)(t)&&(t=t.buffer),t instanceof ArrayBuffer){const n=t;return e.text&&!e.binary?new TextDecoder("utf8").decode(n):n}if(ArrayBuffer.isView(t)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(t);let n=t.buffer;const i=t.byteLength||t.length;return 0===t.byteOffset&&i===n.byteLength||(n=n.slice(t.byteOffset,t.byteOffset+i)),n}throw new Error(D)}(t,e);if((0,i.Lj)(t)&&(t=await(0,M.L1)(t)),(0,i.Ew)(t)){const n=t;return await(0,M.mm)(n),e.binary?await n.arrayBuffer():await n.text()}if((0,i.Os)(t)&&(t=function(t,e){if("string"==typeof t)return function*(t,e){const n=(null==e?void 0:e.chunkSize)||262144;let i=0;const r=new TextEncoder;for(;i<t.length;){const e=Math.min(t.length-i,n),o=t.slice(i,i+e);i+=e,yield r.encode(o)}}(t,e);if(t instanceof ArrayBuffer)return function*(t,e={}){const{chunkSize:n=S}=e;let i=0;for(;i<t.byteLength;){const e=Math.min(t.byteLength-i,n),r=new ArrayBuffer(e),o=new Uint8Array(t,i,e);new Uint8Array(r).set(o),i+=e,yield r}}(t,e);if((0,i.Lj)(t))return async function*(t,e){const n=(null==e?void 0:e.chunkSize)||1048576;let i=0;for(;i<t.size;){const e=i+n,r=await t.slice(i,e).arrayBuffer();i=e,yield r}}(t,e);if((0,i.Os)(t))return T(t,e);if((0,i.Ew)(t))return T(t.body,e);throw new Error("makeIterator")}(t,n)),(0,i.TW)(t)||(0,i.D0)(t))return async function(t){const e=[];for await(const n of t)e.push(n);return function(...t){const e=t.map((t=>t instanceof ArrayBuffer?new Uint8Array(t):t)),n=e.reduce(((t,e)=>t+e.byteLength),0),i=new Uint8Array(n);let r=0;for(const t of e)i.set(t,r),r+=t.byteLength;return i.buffer}(...e)}(t);throw new Error(D)}var L=n(9752);const R=new(n(9109).Z)({id:"loaders.gl"});var I=n(6228);const O=/\.([^.]+)$/;function z(t,e=[],n,i){if(!F(t))return null;if(e&&!Array.isArray(e))return(0,r.T)(e);let o=[];e&&(o=o.concat(e)),null!=n&&n.ignoreRegisteredLoaders||o.push(...(0,I.kO)()),function(t){for(const e of t)(0,r.T)(e)}(o);const s=function(t,e,n,i){const{url:r,type:o}=(0,L.l)(t),s=r||(null==i?void 0:i.url);let a=null,l="";var c;return null!=n&&n.mimeType&&(a=N(e,null==n?void 0:n.mimeType),l="match forced by supplied MIME type ".concat(null==n?void 0:n.mimeType)),a=a||function(t,e){const n=e&&O.exec(e),i=n&&n[1];return i?function(t,e){e=e.toLowerCase();for(const n of t)for(const t of n.extensions)if(t.toLowerCase()===e)return n;return null}(t,i):null}(e,s),l=l||(a?"matched url ".concat(s):""),a=a||N(e,o),l=l||(a?"matched MIME type ".concat(o):""),a=a||function(t,e){if(!e)return null;for(const n of t)if("string"==typeof e){if(j(e,n))return n}else if(ArrayBuffer.isView(e)){if(U(e.buffer,e.byteOffset,n))return n}else if(e instanceof ArrayBuffer&&U(e,0,n))return n;return null}(e,t),l=l||(a?"matched initial data ".concat(V(t)):""),a=a||N(e,null==n?void 0:n.fallbackMimeType),l=l||(a?"matched fallback MIME type ".concat(o):""),l&&R.log(1,"selectLoader selected ".concat(null===(c=a)||void 0===c?void 0:c.name,": ").concat(l,".")),a}(t,o,n,i);if(!(s||null!=n&&n.nothrow))throw new Error(B(t));return s}function F(t){return!(t instanceof Response&&204===t.status)}function B(t){const{url:e,type:n}=(0,L.l)(t);let i="No valid loader found (";i+=e?"".concat(function(t){const e=t&&t.lastIndexOf("/");return e>=0?t.substr(e+1):""}(e),", "):"no url provided, ",i+="MIME type: ".concat(n?'"'.concat(n,'"'):"not provided",", ");const r=t?V(t):"";return i+=r?' first bytes: "'.concat(r,'"'):"first bytes: not available",i+=")",i}function N(t,e){for(const n of t){if(n.mimeTypes&&n.mimeTypes.includes(e))return n;if(e==="application/x.".concat(n.id))return n}return null}function j(t,e){return e.testText?e.testText(t):(Array.isArray(e.tests)?e.tests:[e.tests]).some((e=>t.startsWith(e)))}function U(t,e,n){return(Array.isArray(n.tests)?n.tests:[n.tests]).some((i=>function(t,e,n,i){if(i instanceof ArrayBuffer)return function(t,e,n){if(n=n||t.byteLength,t.byteLength<n||e.byteLength<n)return!1;const i=new Uint8Array(t),r=new Uint8Array(e);for(let t=0;t<i.length;++t)if(i[t]!==r[t])return!1;return!0}(i,t,i.byteLength);switch(typeof i){case"function":return i(t,n);case"string":return i===W(t,e,i.length);default:return!1}}(t,e,n,i)))}function V(t,e=5){return"string"==typeof t?t.slice(0,e):ArrayBuffer.isView(t)?W(t.buffer,t.byteOffset,e):t instanceof ArrayBuffer?W(t,0,e):""}function W(t,e,n){if(t.byteLength<e+n)return"";const i=new DataView(t);let r="";for(let t=0;t<n;t++)r+=String.fromCharCode(i.getUint8(e+t));return r}async function H(t,e,n,l){s(!l||"object"==typeof l),!e||Array.isArray(e)||(0,r.C)(e)||(l=void 0,n=e,e=void 0),t=await t,n=n||{};const{url:c}=(0,L.l)(t),u=function(t,e){if(!e&&t&&!Array.isArray(t))return t;let n;if(t&&(n=Array.isArray(t)?t:[t]),e&&e.loaders){const t=Array.isArray(e.loaders)?e.loaders:[e.loaders];n=n?[...n,...t]:t}return n&&n.length?n:null}(e,l),h=await async function(t,e=[],n,r){if(!F(t))return null;let o=z(t,e,{...n,nothrow:!0},r);if(o)return o;if((0,i.Lj)(t)&&(o=z(t=await t.slice(0,10).arrayBuffer(),e,n,r)),!(o||null!=n&&n.nothrow))throw new Error(B(t));return o}(t,u,n);return h?(l=function(t,e,n=null){if(n)return n;const i={fetch:(0,o.bV)(e,t),...t};return Array.isArray(i.loaders)||(i.loaders=null),i}({url:c,parse:H,loaders:u},n=(0,o.GR)(n,h,u,c),l),await async function(t,e,n,r){if(function(t,e="3.2.12"){s(t,"no worker provided");t.version}(t),(0,i.Ew)(e)){const t=e,{ok:n,redirected:i,status:o,statusText:s,type:a,url:l}=t,c=Object.fromEntries(t.headers.entries());r.response={headers:c,ok:n,redirected:i,status:o,statusText:s,type:a,url:l}}if(e=await P(e,t,n),t.parseTextSync&&"string"==typeof e)return n.dataType="text",t.parseTextSync(e,n,r,t);if(function(t,e){return!!w.isSupported()&&!!(a||null!=e&&e._nodeWorkers)&&t.worker&&(null==e?void 0:e.worker)}(t,n))return await x(t,e,n,r,H);if(t.parseText&&"string"==typeof e)return await t.parseText(e,n,r,t);if(t.parse)return await t.parse(e,n,r,t);throw s(!t.parseSync),new Error("".concat(t.id," loader - no parser found and worker is disabled"))}(h,t,n,l)):null}async function $(t,e,n,s){Array.isArray(e)||(0,r.C)(e)||(n=e,e=void 0);const a=(0,o.bV)(n);let l=t;return"string"==typeof t&&(l=await a(t)),(0,i.Lj)(t)&&(l=await a(t)),await H(l,e,n)}},6228:(t,e,n)=>{"use strict";n.d(e,{fh:()=>s,kO:()=>a});var i=n(2033),r=n(7504);const o=()=>{const t=(0,r.rx)();return t.loaderRegistry=t.loaderRegistry||[],t.loaderRegistry};function s(t){const e=o();t=Array.isArray(t)?t:[t];for(const n of t){const t=(0,i.T)(n);e.find((e=>t===e))||e.unshift(t)}}function a(){return o()}},2033:(t,e,n)=>{"use strict";n.d(e,{C:()=>r,T:()=>o});var i=n(6269);function r(t){var e;return!!t&&(Array.isArray(t)&&(t=t[0]),Array.isArray(null===(e=t)||void 0===e?void 0:e.extensions))}function o(t){var e,n;let o;return(0,i.h)(t,"null loader"),(0,i.h)(r(t),"invalid loader"),Array.isArray(t)&&(o=t[1],t=t[0],t={...t,options:{...t.options,...o}}),(null!==(e=t)&&void 0!==e&&e.parseTextSync||null!==(n=t)&&void 0!==n&&n.parseText)&&(t.text=!0),t.text||(t.binary=!0),t}},7504:(t,e,n)=>{"use strict";n.d(e,{bV:()=>m,rx:()=>f,GR:()=>g});var i=n(6255);const r={};var o=n(7927);async function s(t,e){if("string"==typeof t){t=function(t){for(const e in r)if(t.startsWith(e)){const n=r[e];t=t.replace(e,n)}return t.startsWith("http://")||t.startsWith("https://")||(t="".concat("").concat(t)),t}(t);let n=e;return null!=e&&e.fetch&&"function"!=typeof(null==e?void 0:e.fetch)&&(n=e.fetch),await fetch(t,n)}return await(0,o.L1)(t)}var a=n(4942);const l=new(n(9109).Z)({id:"loaders.gl"});class c{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}var u=n(4959);const h={fetch:null,mimeType:void 0,nothrow:!1,log:new class{constructor(){(0,a.Z)(this,"console",void 0),this.console=console}log(...t){return this.console.log.bind(this.console,...t)}info(...t){return this.console.info.bind(this.console,...t)}warn(...t){return this.console.warn.bind(this.console,...t)}error(...t){return this.console.error.bind(this.console,...t)}},CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:u.jU,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},d={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function f(){globalThis.loaders=globalThis.loaders||{};const{loaders:t}=globalThis;return t._state=t._state||{},t._state}const p=()=>{const t=f();return t.globalOptions=t.globalOptions||{...h},t.globalOptions};function g(t,e,n,i){return n=n||[],function(t,e){_(t,null,h,d,e);for(const n of e){const i=t&&t[n.id]||{},r=n.options&&n.options[n.id]||{},o=n.deprecatedOptions&&n.deprecatedOptions[n.id]||{};_(i,n.id,r,o,e)}}(t,n=Array.isArray(n)?n:[n]),function(t,e,n){const i={...t.options||{}};return function(t,e){e&&!("baseUri"in t)&&(t.baseUri=e)}(i,n),null===i.log&&(i.log=new c),b(i,p()),b(i,e),i}(e,t,i)}function m(t,e){const n=p(),r=t||n;return"function"==typeof r.fetch?r.fetch:(0,i.Kn)(r.fetch)?t=>s(t,r):null!=e&&e.fetch?null==e?void 0:e.fetch:s}function _(t,e,n,r,o){const s=e||"Top level",a=e?"".concat(e,"."):"";for(const c in t){const u=!e&&(0,i.Kn)(t[c]),h="baseUri"===c&&!e,d="workerUrl"===c&&e;if(!(c in n)&&!h&&!d)if(c in r)l.warn("".concat(s," loader option '").concat(a).concat(c,"' no longer supported, use '").concat(r[c],"'"))();else if(!u){const t=v(c,o);l.warn("".concat(s," loader option '").concat(a).concat(c,"' not recognized. ").concat(t))()}}}function v(t,e){const n=t.toLowerCase();let i="";for(const r of e)for(const e in r.options){if(t===e)return"Did you mean '".concat(r.id,".").concat(e,"'?");const o=e.toLowerCase();(n.startsWith(o)||o.startsWith(n))&&(i=i||"Did you mean '".concat(r.id,".").concat(e,"'?"))}return i}function b(t,e){for(const n in e)if(n in e){const r=e[n];(0,i.Ss)(r)&&(0,i.Ss)(t[n])?t[n]={...t[n],...e[n]}:t[n]=e[n]}}},9752:(t,e,n)=>{"use strict";n.d(e,{C:()=>u,l:()=>c});var i=n(6255);const r=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,o=/^([-\w.]+\/[-\w.+]+)/;function s(t){const e=o.exec(t);return e?e[1]:t}function a(t){const e=r.exec(t);return e?e[1]:""}const l=/\?.*/;function c(t){if((0,i.Ew)(t)){const e=h(t.url||"");return{url:e,type:s(t.headers.get("content-type")||"")||a(e)}}return(0,i.Lj)(t)?{url:h(t.name||""),type:t.type||""}:"string"==typeof t?{url:h(t),type:a(t)}:{url:"",type:""}}function u(t){return(0,i.Ew)(t)?t.headers["content-length"]||-1:(0,i.Lj)(t)?t.size:"string"==typeof t?t.length:t instanceof ArrayBuffer||ArrayBuffer.isView(t)?t.byteLength:-1}function h(t){return t.replace(l,"")}},7927:(t,e,n)=>{"use strict";n.d(e,{L1:()=>o,mm:()=>s});var i=n(6255),r=n(9752);async function o(t){if((0,i.Ew)(t))return t;const e={},n=(0,r.C)(t);n>=0&&(e["content-length"]=String(n));const{url:o,type:s}=(0,r.l)(t);s&&(e["content-type"]=s);const a=await async function(t){if("string"==typeof t)return"data:,".concat(t.slice(0,5));if(t instanceof Blob){const e=t.slice(0,5);return await new Promise((t=>{const n=new FileReader;n.onload=e=>{var n;return t(null==e||null===(n=e.target)||void 0===n?void 0:n.result)},n.readAsDataURL(e)}))}if(t instanceof ArrayBuffer){const e=function(t){let e="";const n=new Uint8Array(t);for(let t=0;t<n.byteLength;t++)e+=String.fromCharCode(n[t]);return btoa(e)}(t.slice(0,5));return"data:base64,".concat(e)}return null}(t);a&&(e["x-first-bytes"]=a),"string"==typeof t&&(t=(new TextEncoder).encode(t));const l=new Response(t,{headers:e});return Object.defineProperty(l,"url",{value:o}),l}async function s(t){if(!t.ok){const e=await async function(t){let e="Failed to fetch resource ".concat(t.url," (").concat(t.status,"): ");try{const n=t.headers.get("Content-Type");let i=t.statusText;n.includes("application/json")&&(i+=" ".concat(await t.text())),e+=i,e=e.length>60?"".concat(e.slice(0,60),"..."):e}catch(t){}return e}(t);throw new Error(e)}}},3579:(t,e,n)=>{"use strict";n.d(e,{S:()=>x});var i=n(6269),r=n(4959);const{_parseImageNode:o}=globalThis,s="undefined"!=typeof Image,a="undefined"!=typeof ImageBitmap,l=Boolean(o),c=!!r.jU||l;function u(t){const e=function(t){return"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap?"imagebitmap":"undefined"!=typeof Image&&t instanceof Image?"image":t&&"object"==typeof t&&t.data&&t.width&&t.height?"data":null}(t);if(!e)throw new Error("Not an image");return e}const h=/^data:image\/svg\+xml/,d=/\.svg((\?|#).*)?$/;function f(t){return t&&(h.test(t)||d.test(t))}function p(t,e){if(f(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(t)])}async function g(t,e,n){const i=function(t,e){if(f(e)){let e=(new TextDecoder).decode(t);try{"function"==typeof unescape&&"function"==typeof encodeURIComponent&&(e=unescape(encodeURIComponent(e)))}catch(t){throw new Error(t.message)}return"data:image/svg+xml;base64,".concat(btoa(e))}return p(t,e)}(t,n),r=self.URL||self.webkitURL,o="string"!=typeof i&&r.createObjectURL(i);try{return await async function(t,e){const n=new Image;return n.src=t,e.image&&e.image.decode&&n.decode?(await n.decode(),n):await new Promise(((e,i)=>{try{n.onload=()=>e(n),n.onerror=e=>i(new Error("Could not load image ".concat(t,": ").concat(e)))}catch(t){i(t)}}))}(o||i,e)}finally{o&&r.revokeObjectURL(o)}}const m={};let _=!0;const v=!1,b=!0;function y(t){const e=w(t);return function(t){const e=w(t);return e.byteLength>=24&&2303741511===e.getUint32(0,v)?{mimeType:"image/png",width:e.getUint32(16,v),height:e.getUint32(20,v)}:null}(e)||function(t){const e=w(t);if(!(e.byteLength>=3&&65496===e.getUint16(0,v)&&255===e.getUint8(2)))return null;const{tableMarkers:n,sofMarkers:i}=function(){const t=new Set([65499,65476,65484,65501,65534]);for(let e=65504;e<65520;++e)t.add(e);return{tableMarkers:t,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}();let r=2;for(;r+9<e.byteLength;){const t=e.getUint16(r,v);if(i.has(t))return{mimeType:"image/jpeg",height:e.getUint16(r+5,v),width:e.getUint16(r+7,v)};if(!n.has(t))return null;r+=2,r+=e.getUint16(r,v)}return null}(e)||function(t){const e=w(t);return e.byteLength>=10&&1195984440===e.getUint32(0,v)?{mimeType:"image/gif",width:e.getUint16(6,b),height:e.getUint16(8,b)}:null}(e)||function(t){const e=w(t);return e.byteLength>=14&&16973===e.getUint16(0,v)&&e.getUint32(2,b)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,b),height:e.getUint32(22,b)}:null}(e)}function w(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error("toDataView")}const x={id:"image",module:"images",name:"Images",version:"3.2.12",mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],extensions:["png","jpg","jpeg","gif","webp","bmp","ico","svg"],parse:async function(t,e,n){const r=((e=e||{}).image||{}).type||"auto",{url:o}=n||{};let l;switch(function(t){switch(t){case"auto":case"data":return function(){if(a)return"imagebitmap";if(s)return"image";if(c)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}();default:return function(t){switch(t){case"auto":return a||s||c;case"imagebitmap":return a;case"image":return s;case"data":return c;default:throw new Error("@loaders.gl/images: image ".concat(t," not supported in this environment"))}}(t),t}}(r)){case"imagebitmap":l=await async function(t,e,n){let i;i=f(n)?await g(t,e,n):p(t,n);const r=e&&e.imagebitmap;return await async function(t,e=null){if(!function(t){for(const e in t||m)return!1;return!0}(e)&&_||(e=null),e)try{return await createImageBitmap(t,e)}catch(t){console.warn(t),_=!1}return await createImageBitmap(t)}(i,r)}(t,e,o);break;case"image":l=await g(t,e,o);break;case"data":l=await async function(t,e){const{mimeType:n}=y(t)||{},r=globalThis._parseImageNode;return(0,i.h)(r),await r(t,n)}(t);break;default:(0,i.h)(!1)}return"data"===r&&(l=function(t){switch(u(t)){case"data":return t;case"image":case"imagebitmap":const e=document.createElement("canvas"),n=e.getContext("2d");if(!n)throw new Error("getImageData");return e.width=t.width,e.height=t.height,n.drawImage(t,0,0),n.getImageData(0,0,t.width,t.height);default:throw new Error("getImageData")}}(l)),l},tests:[t=>Boolean(y(new DataView(t)))],options:{image:{type:"auto",decode:!0}}}},6269:(t,e,n)=>{"use strict";function i(t,e){if(!t)throw new Error(e||"loader assertion failed.")}n.d(e,{h:()=>i})},4959:(t,e,n)=>{"use strict";n.d(e,{jU:()=>i}),"undefined"!=typeof self&&self,"undefined"!=typeof window&&window,void 0!==n.g&&n.g,"undefined"!=typeof document&&document;const i=Boolean("object"!=typeof process||"[object process]"!==String(process)||process.browser),r="undefined"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version);r&&parseFloat(r[1])},3982:(t,e,n)=>{"use strict";n.d(e,{Z:()=>s});var i=n(8474),r=n(2525);const o={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};class s{static get DRAW_MODE(){return o}constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{id:e=(0,i.hQ)("geometry"),drawMode:n=o.TRIANGLES,attributes:r={},indices:s=null,vertexCount:a=null}=t;this.id=e,this.drawMode=0|n,this.attributes={},this.userData={},this._setAttributes(r,s),this.vertexCount=a||this._calculateVertexCount(this.attributes,this.indices)}get mode(){return this.drawMode}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(t){return"Geometry ".concat(this.id," attribute ").concat(t)}_setAttributes(t,e){e&&(this.indices=ArrayBuffer.isView(e)?{value:e,size:1}:e);for(const e in t){let n=t[e];n=ArrayBuffer.isView(n)?{value:n}:n,(0,r.h)(ArrayBuffer.isView(n.value),"".concat(this._print(e),": must be typed array or object with value as typed array")),"POSITION"!==e&&"positions"!==e||n.size||(n.size=3),"indices"===e?((0,r.h)(!this.indices),this.indices=n):this.attributes[e]=n}return this.indices&&void 0!==this.indices.isIndexed&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this}_calculateVertexCount(t,e){if(e)return e.value.length;let n=1/0;for(const e in t){const i=t[e],{value:r,size:o,constant:s}=i;!s&&r&&o>=1&&(n=Math.min(n,r.length/o))}return(0,r.h)(Number.isFinite(n)),n}}},9769:(t,e,n)=>{"use strict";n.d(e,{Z:()=>I});var i=n(9450),r=n(358),o=n(8474),s=n(2525),a=n(6047),l=n(7944),c=n(4072),u=n(3478),h=n(7577);let d=null;var f=n(3485);class p extends h.Z{get[Symbol.toStringTag](){return"VertexArrayObject"}static isSupported(t){return!(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).constantAttributeZero||(0,i.D0)(t)||"Chrome"===(0,f.Z)()}static getDefaultArray(t){return t.luma=t.luma||{},t.luma.defaultVertexArray||(t.luma.defaultVertexArray=new p(t,{handle:null,isDefaultArray:!0})),t.luma.defaultVertexArray}static getMaxAttributes(t){return p.MAX_ATTRIBUTES=p.MAX_ATTRIBUTES||t.getParameter(34921),p.MAX_ATTRIBUTES}static setConstant(t,e,n){switch(n.constructor){case Float32Array:p._setConstantFloatArray(t,e,n);break;case Int32Array:p._setConstantIntArray(t,e,n);break;case Uint32Array:p._setConstantUintArray(t,e,n);break;default:(0,s.h)(!1)}}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=e.id||e.program&&e.program.id;super(t,Object.assign({},e,{id:n})),this.buffer=null,this.bufferValue=null,this.isDefaultArray=e.isDefaultArray||!1,this.gl2=t,this.initialize(e),Object.seal(this)}delete(){return super.delete(),this.buffer&&this.buffer.delete(),this}get MAX_ATTRIBUTES(){return p.getMaxAttributes(this.gl)}initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.setProps(t)}setProps(t){return this}setElementBuffer(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return(0,s.h)(!t||34963===t.target,"elements must be GL.ELEMENT_ARRAY_BUFFER"),this.bind((()=>{this.gl.bindBuffer(34963,t?t.handle:null)})),this}setBuffer(t,e,n){if(34963===e.target)return this.setElementBuffer(e,n);const{size:r,type:o,stride:a,offset:l,normalized:c,integer:u,divisor:h}=n,{gl:d,gl2:f}=this;return t=Number(t),this.bind((()=>{d.bindBuffer(34962,e.handle),u?((0,s.h)((0,i.D0)(d)),f.vertexAttribIPointer(t,r,o,a,l)):d.vertexAttribPointer(t,r,o,c,a,l),d.enableVertexAttribArray(t),f.vertexAttribDivisor(t,h||0)})),this}enable(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return!e&&0===t&&!p.isSupported(this.gl,{constantAttributeZero:!0})||(t=Number(t),this.bind((()=>e?this.gl.enableVertexAttribArray(t):this.gl.disableVertexAttribArray(t)))),this}getConstantBuffer(t,e){const n=this._normalizeConstantArrayValue(e),i=n.byteLength*t,r=n.length*t;let o=!this.buffer;if(this.buffer=this.buffer||new u.Z(this.gl,i),o=o||this.buffer.reallocate(i),o=o||!this._compareConstantArrayValues(n,this.bufferValue),o){const t=function(t,e){var n;return new t((n=t.BYTES_PER_ELEMENT*e,(!d||d.byteLength<n)&&(d=new ArrayBuffer(n)),d),0,e)}(e.constructor,r);!function(t){let{target:e,source:n,start:i=0,count:r=1}=t;const o=n.length,s=r*o;let a=0;for(let t=i;a<o;a++)e[t++]=n[a];for(;a<s;)a<s-a?(e.copyWithin(i+a,i,i+a),a*=2):(e.copyWithin(i+a,i,i+s-a),a=s)}({target:t,source:n,start:0,count:r}),this.buffer.subData(t),this.bufferValue=e}return this.buffer}_normalizeConstantArrayValue(t){return Array.isArray(t)?new Float32Array(t):t}_compareConstantArrayValues(t,e){if(!t||!e||t.length!==e.length||t.constructor!==e.constructor)return!1;for(let n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0}static _setConstantFloatArray(t,e,n){switch(n.length){case 1:t.vertexAttrib1fv(e,n);break;case 2:t.vertexAttrib2fv(e,n);break;case 3:t.vertexAttrib3fv(e,n);break;case 4:t.vertexAttrib4fv(e,n);break;default:(0,s.h)(!1)}}static _setConstantIntArray(t,e,n){switch((0,s.h)((0,i.D0)(t)),n.length){case 1:t.vertexAttribI1iv(e,n);break;case 2:t.vertexAttribI2iv(e,n);break;case 3:t.vertexAttribI3iv(e,n);break;case 4:t.vertexAttribI4iv(e,n);break;default:(0,s.h)(!1)}}static _setConstantUintArray(t,e,n){switch((0,s.h)((0,i.D0)(t)),n.length){case 1:t.vertexAttribI1uiv(e,n);break;case 2:t.vertexAttribI2uiv(e,n);break;case 3:t.vertexAttribI3uiv(e,n);break;case 4:t.vertexAttribI4uiv(e,n);break;default:(0,s.h)(!1)}}_createHandle(){return this.gl.createVertexArray()}_deleteHandle(t){return this.gl2.deleteVertexArray(t),[this.elements]}_bindHandle(t){this.gl2.bindVertexArray(t)}_getParameter(t,e){let{location:n}=e;return(0,s.h)(Number.isFinite(n)),this.bind((()=>34373===t?this.gl.getVertexAttribOffset(n,t):this.gl.getVertexAttrib(n,t)))}}var g=n(7469);const m=/^(.+)__LOCATION_([0-9]+)$/,_=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];class v{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=e.id||e.program&&e.program.id;this.id=n,this.gl=t,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new p(t),(0,g.F)(this,"VertexArray","v6.0",_),this.initialize(e),Object.seal(this)}delete(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(t)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:t}=this.vertexArrayObject;return this.values=new Array(t).fill(null),this.accessors=new Array(t).fill(null),this.unused={},this.drawParams=null,this}setProps(t){return"program"in t&&(this.configuration=t.program&&t.program.configuration),"configuration"in t&&(this.configuration=t.configuration),"attributes"in t&&this.setAttributes(t.attributes),"elements"in t&&this.setElementBuffer(t.elements),"bindOnUse"in t&&(t=t.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}setAttributes(t){return Object.assign(this.attributes,t),this.vertexArrayObject.bind((()=>{for(const e in t){const n=t[e];this._setAttribute(e,n)}this.gl.bindBuffer(34962,null)})),this}setElementBuffer(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.elements=t,this.elementsAccessor=e,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(t,e),this}setBuffer(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(34963===e.target)return this.setElementBuffer(e,n);const{location:i,accessor:r}=this._resolveLocationAndAccessor(t,e,e.accessor,n);return i>=0&&(this.values[i]=e,this.accessors[i]=r,this.clearDrawParams(),this.vertexArrayObject.setBuffer(i,e,r)),this}setConstant(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{location:i,accessor:r}=this._resolveLocationAndAccessor(t,e,Object.assign({size:e.length},n));return i>=0&&(e=this.vertexArrayObject._normalizeConstantArrayValue(e),this.values[i]=e,this.accessors[i]=r,this.clearDrawParams(),this.vertexArrayObject.enable(i,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind((()=>{this.elements&&this.vertexArrayObject.setElementBuffer(null),this.buffer=this.buffer||new u.Z(this.gl,{accessor:{size:4}});for(let t=0;t<this.vertexArrayObject.MAX_ATTRIBUTES;t++)this.values[t]instanceof u.Z&&(this.gl.disableVertexAttribArray(t),this.gl.bindBuffer(34962,this.buffer.handle),this.gl.vertexAttribPointer(t,1,5126,!1,0,0))})),this}bindBuffers(){return this.vertexArrayObject.bind((()=>{this.elements&&this.setElementBuffer(this.elements);for(let t=0;t<this.vertexArrayObject.MAX_ATTRIBUTES;t++){const e=this.values[t];e instanceof u.Z&&this.setBuffer(t,e)}})),this}bindForDraw(t,e,n){let i;return this.vertexArrayObject.bind((()=>{this._setConstantAttributes(t,e),i=n()})),i}_resolveLocationAndAccessor(t,e,n,r){const o={location:-1,accessor:null},{location:a,name:l}=this._getAttributeIndex(t);if(!Number.isFinite(a)||a<0)return this.unused[t]=e,i.cM.once(3,(()=>"unused value ".concat(t," in ").concat(this.id)))(),o;const u=this._getAttributeInfo(l||a);if(!u)return o;const h=this.accessors[a]||{},d=c.Z.resolve(u.accessor,h,n,r),{size:f,type:p}=d;return(0,s.h)(Number.isFinite(f)&&Number.isFinite(p)),{location:a,accessor:d}}_getAttributeInfo(t){return this.configuration&&this.configuration.getAttributeInfo(t)}_getAttributeIndex(t){const e=Number(t);if(Number.isFinite(e))return{location:e};const n=m.exec(t),i=n?n[1]:t,r=n?Number(n[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(i)+r,name:i}:{location:-1}}_setAttribute(t,e){if(e instanceof u.Z)this.setBuffer(t,e);else if(Array.isArray(e)&&e.length&&e[0]instanceof u.Z){const n=e[0],i=e[1];this.setBuffer(t,n,i)}else if(ArrayBuffer.isView(e)||Array.isArray(e)){const n=e;this.setConstant(t,n)}else{if(!(e.buffer instanceof u.Z))throw new Error("VertexArray: attributes must be Buffers or constants (i.e. typed array)");{const n=e;this.setBuffer(t,n.buffer,n)}}}_setConstantAttributes(t,e){const n=Math.max(0|t,0|e);let i=this.values[0];ArrayBuffer.isView(i)&&this._setConstantAttributeZero(i,n);for(let t=1;t<this.vertexArrayObject.MAX_ATTRIBUTES;t++)i=this.values[t],ArrayBuffer.isView(i)&&this._setConstantAttribute(t,i)}_setConstantAttributeZero(t,e){if(p.isSupported(this.gl,{constantAttributeZero:!0}))return void this._setConstantAttribute(0,t);const n=this.vertexArrayObject.getConstantBuffer(e,t);this.vertexArrayObject.setBuffer(0,n,this.accessors[0])}_setConstantAttribute(t,e){p.setConstant(this.gl,t,e)}_updateDrawParams(){const t={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this._updateDrawParamsForLocation(t,e);return this.elements&&(t.elementCount=this.elements.getElementCount(this.elements.accessor),t.isIndexed=!0,t.indexType=this.elementsAccessor.type||this.elements.accessor.type,t.indexOffset=this.elementsAccessor.offset||0),t.indexCount===1/0&&(t.indexCount=0),t.vertexCount===1/0&&(t.vertexCount=0),t.instanceCount===1/0&&(t.instanceCount=0),t}_updateDrawParamsForLocation(t,e){const n=this.values[e],i=this.accessors[e];if(!n)return;const{divisor:r}=i,o=r>0;if(t.isInstanced=t.isInstanced||o,n instanceof u.Z){const e=n;if(o){const n=e.getVertexCount(i);t.instanceCount=Math.min(t.instanceCount,n)}else{const n=e.getVertexCount(i);t.vertexCount=Math.min(t.vertexCount,n)}}}setElements(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return i.cM.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(t,e)}}var b=n(1053),y=n(9579),w=n(8522);function x(t,e){const{maxElts:n=16,size:i=1}=e;let r="[";for(let o=0;o<t.length&&o<n;++o)o>0&&(r+=",".concat(o%i==0?" ":"")),r+=C(t[o],e);const o=t.length>n?"...":"]";return"".concat(r).concat(o)}function C(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=1e-16,{isInteger:i=!1}=e;if(Array.isArray(t)||ArrayBuffer.isView(t))return x(t,e);if(!Number.isFinite(t))return String(t);if(Math.abs(t)<n)return i?"0":"0.";if(i)return t.toFixed(0);if(Math.abs(t)>100&&Math.abs(t)<1e4)return t.toFixed(0);const r=t.toPrecision(2),o=r.indexOf(".0");return o===r.length-2?r.slice(0,-1):r}function k(t,e,n,i){const{gl:r}=t;if(!e)return{[i]:"null","Format ":"N/A"};let o,s,a,l="NOT PROVIDED",c=1,h=0,d=0;if(n&&(l=n.type,c=n.size,l=String(l).replace("Array",""),o=-1!==l.indexOf("nt")),e instanceof u.Z){const t=e,{data:u,changed:f}=t.getDebugData();let p;if(s=f?"*":"",a=u,d=t.byteLength,h=d/u.BYTES_PER_ELEMENT/c,n){const t=n.divisor>0;p="".concat(t?"I ":"P "," ").concat(h," (x").concat(c,"=").concat(d," bytes ").concat((0,y.km)(r,l),")")}else o=!0,p="".concat(d," bytes");return{[i]:"".concat(s).concat(C(a,{size:c,isInteger:o})),"Format ":p}}return a=e,c=e.length,l=String(e.constructor.name).replace("Array",""),o=-1!==l.indexOf("nt"),{[i]:"".concat(C(a,{size:c,isInteger:o})," (constant)"),"Format ":"".concat(c,"x").concat(l," (constant)")}}function E(t,e){const{type:n,size:i}=e,r=(0,w.jG)(n,i);return r?"".concat(t," (").concat(r.name,")"):t}function S(t){let{header:e="Uniforms",program:n,uniforms:i,undefinedOnly:r=!1}=t;(0,s.h)(n);const o=".*Matrix",a=n._uniformSetters,l={},c=Object.keys(a).sort();let u=0;for(const t of c)t.match(".*_.*")||t.match(o)||A({table:l,header:e,uniforms:i,uniformName:t,undefinedOnly:r})&&u++;for(const t of c)t.match(o)&&A({table:l,header:e,uniforms:i,uniformName:t,undefinedOnly:r})&&u++;for(const t of c)l[t]||A({table:l,header:e,uniforms:i,uniformName:t,undefinedOnly:r})&&u++;let h=0;const d={};if(!r)for(const t in i){const n=i[t];l[t]||(h++,d[t]={Type:"NOT USED: ".concat(n),[e]:C(n)})}return{table:l,count:u,unusedTable:d,unusedCount:h}}function A(t){let{table:e,header:n,uniforms:i,uniformName:r,undefinedOnly:o}=t;const s=i[r],a=function(t){return null!=t}(s);return!(o&&a||(e[r]={[n]:a?C(s):"N/A","Uniform Type":a?s:"NOT PROVIDED"},0))}function T(t){const{type:e,size:n}=t.accessor,i=(0,w.jG)(e,n);return i?"".concat(i.name," ").concat(t.name):t.name}const M={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function D(t,e){const{attributeMap:n=M}=e||{};return n&&n[t]||t}function P(t,e){let n;switch(t){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":n="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":n="vectors"}switch(n){case"vectors":e.size=e.size||3;break;case"uvs":e.size=e.size||2}(0,s.h)(Number.isFinite(e.size),"attribute ".concat(t," needs size"))}const L=()=>{},R={};class I{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{id:n=(0,o.hQ)("model")}=e;(0,s.h)((0,i.UF)(t)),this.id=n,this.gl=t,this.id=e.id||(0,o.hQ)("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(e)}initialize(t){this.props={},this.programManager=t.programManager||r.Z.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;const{program:e=null,vs:n,fs:i,modules:o,defines:a,inject:l,varyings:c,bufferMode:u,transpileToGLSL100:h}=t;this.programProps={program:e,vs:n,fs:i,modules:o,defines:a,inject:l,varyings:c,bufferMode:u,transpileToGLSL100:h},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(t.moduleSettings))),this.drawMode=void 0!==t.drawMode?t.drawMode:4,this.vertexCount=t.vertexCount||0,this.geometryBuffers={},this.isInstanced=t.isInstanced||t.instanced||t.instanceCount>0,this._setModelProps(t),this.geometry={},(0,s.h)(void 0!==this.drawMode&&Number.isFinite(this.vertexCount),"Model needs drawMode and vertexCount")}setProps(t){this._setModelProps(t)}delete(){for(const t in this._attributes)this._attributes[t]!==this.attributes[t]&&this._attributes[t].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}getProgram(){return this.program}setProgram(t){const{program:e,vs:n,fs:i,modules:r,defines:o,inject:s,varyings:a,bufferMode:l,transpileToGLSL100:c}=t;this.programProps={program:e,vs:n,fs:i,modules:r,defines:o,inject:s,varyings:a,bufferMode:l,transpileToGLSL100:c},this._programDirty=!0}getUniforms(){return this.uniforms}setDrawMode(t){return this.drawMode=t,this}setVertexCount(t){return(0,s.h)(Number.isFinite(t)),this.vertexCount=t,this}setInstanceCount(t){return(0,s.h)(Number.isFinite(t)),this.instanceCount=t,this}setGeometry(t){return this.drawMode=t.drawMode,this.vertexCount=t.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=function(t,e,n){const i={};let r=e.indices;for(const n in e.attributes){const o=e.attributes[n],s=D(n,undefined);if("indices"===n)r=o;else if(o.constant)i[s]=o.value;else{const e=o.value,r={...o};delete r.value,i[s]=[new u.Z(t,e),r],P(n,r)}}if(r){const e=r.value||r;(0,s.h)(e instanceof Uint16Array||e instanceof Uint32Array,'attribute array for "indices" must be of integer type');const n={size:1,isIndexed:void 0===r.isIndexed||r.isIndexed};i.indices=[new u.Z(t,{data:e,target:34963}),n]}return i}(this.gl,t),this.vertexArray.setAttributes(this.geometryBuffers),this}setAttributes(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if((0,o.nK)(t))return this;const e={};for(const n in t){const i=t[n];e[n]=i.getValue?i.getValue():i}return this.vertexArray.setAttributes(e),this}setUniforms(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.assign(this.uniforms,t),this}getModuleUniforms(t){this._checkProgram();const e=this.programManager.getUniforms(this.program);return e?e(t):{}}updateModuleSettings(t){const e=this.getModuleUniforms(t||{});return this.setUniforms(e)}clear(t){return(0,a.Z)(this.program.gl,t),this}draw(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._checkProgram();const{moduleSettings:e=null,framebuffer:n,uniforms:r={},attributes:o={},transformFeedback:s=this.transformFeedback,parameters:a={},vertexArray:l=this.vertexArray}=t;let c;this.setAttributes(o),this.updateModuleSettings(e),this.setUniforms(r),i.cM.priority>=2&&(c=this._logDrawCallStart(2));const u=this.vertexArray.getDrawParams(),{isIndexed:h=u.isIndexed,indexType:d=u.indexType,indexOffset:f=u.indexOffset,vertexArrayInstanced:p=u.isInstanced}=this.props;p&&!this.isInstanced&&i.cM.warn("Found instanced attributes on non-instanced model",this.id)();const{isInstanced:g,instanceCount:m}=this,{onBeforeRender:_=L,onAfterRender:v=L}=this.props;_(),this.program.setUniforms(this.uniforms);const b=this.program.draw(Object.assign(R,t,{logPriority:c,uniforms:null,framebuffer:n,parameters:a,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:l,transformFeedback:s,isIndexed:h,indexType:d,isInstanced:g,instanceCount:m,offset:h?f:0}));return v(),i.cM.priority>=2&&this._logDrawCallEnd(c,l,n),b}transform(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{discard:e=!0,feedbackBuffers:n,unbindModels:i=[]}=t;let{parameters:r}=t;n&&this._setFeedbackBuffers(n),e&&(r=Object.assign({},r,{35977:e})),i.forEach((t=>t.vertexArray.unbindBuffers()));try{this.draw(Object.assign({},t,{parameters:r}))}finally{i.forEach((t=>t.vertexArray.bindBuffers()))}return this}render(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i.cM.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(t).draw()}_setModelProps(t){Object.assign(this.props,t),"uniforms"in t&&this.setUniforms(t.uniforms),"pickable"in t&&(this.pickable=t.pickable),"instanceCount"in t&&(this.instanceCount=t.instanceCount),"geometry"in t&&this.setGeometry(t.geometry),"attributes"in t&&this.setAttributes(t.attributes),"_feedbackBuffers"in t&&this._setFeedbackBuffers(t._feedbackBuffers)}_checkProgram(){if(!this._programDirty&&this.programManager.stateHash===this._programManagerState)return;let{program:t}=this.programProps;if(t)this._managedProgram=!1;else{const{vs:e,fs:n,modules:i,inject:r,defines:o,varyings:s,bufferMode:a,transpileToGLSL100:l}=this.programProps;t=this.programManager.get({vs:e,fs:n,modules:i,inject:r,defines:o,varyings:s,bufferMode:a,transpileToGLSL100:l}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}(0,s.h)(t instanceof l.Z,"Model needs a program"),this._programDirty=!1,t!==this.program&&(this.program=t,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new v(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}_deleteGeometryBuffers(){for(const t in this.geometryBuffers){const e=this.geometryBuffers[t][0]||this.geometryBuffers[t];e instanceof u.Z&&e.delete()}}_setAnimationProps(t){this.animated&&(0,s.h)(t,"Model.draw(): animated uniforms but no animationProps")}_setFeedbackBuffers(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if((0,o.nK)(t))return this;const{gl:e}=this.program;return this.transformFeedback=this.transformFeedback||new b.Z(e,{program:this.program}),this.transformFeedback.setBuffers(t),this}_logDrawCallStart(t){const e=t>3?0:1e4;if(!(Date.now()-this.lastLogTime<e))return this.lastLogTime=Date.now(),i.cM.group(2,">>> DRAWING MODEL ".concat(this.id),{collapsed:i.cM.level<=2})(),t}_logDrawCallEnd(t,e,n,r){if(void 0===t)return;const o=function(t){let{vertexArray:e,header:n="Attributes"}=t;if(!e.configuration)return{};const i={};e.elements&&(i.ELEMENT_ARRAY_BUFFER=k(e,e.elements,null,n));const r=e.values;for(const t in r){const o=e._getAttributeInfo(t);if(o){let s="".concat(t,": ").concat(o.name);const a=e.accessors[o.location];a&&(s="".concat(t,": ").concat(E(o.name,a))),i[s]=k(e,r[t],a,n)}}return i}({vertexArray:e,header:"".concat(this.id," attributes"),attributes:this._attributes}),{table:s,unusedTable:a,unusedCount:l}=S({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,n)}),{table:c,count:u}=S({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,n),undefinedOnly:!0});u>0&&i.cM.log("MISSING UNIFORMS",Object.keys(c))(),l>0&&i.cM.log("UNUSED UNIFORMS",Object.keys(a))();const h=function(t){const e={},n="Accessors for ".concat(t.id);for(const i of t.attributeInfos)if(i){const t=T(i);e["in ".concat(t)]={[n]:JSON.stringify(i.accessor)}}for(const i of t.varyingInfos)if(i){const t=T(i);e["out ".concat(t)]={[n]:JSON.stringify(i.accessor)}}return e}(this.vertexArray.configuration);i.cM.table(t,o)(),i.cM.table(t,s)(),i.cM.table(t+1,h)(),r&&r.log({logLevel:2,message:"Rendered to ".concat(r.id)}),i.cM.groupEnd(2)()}}},358:(t,e,n)=>{"use strict";n.d(e,{Z:()=>O});var i=n(5682),r=n(9047);const o={number:{validate:(t,e)=>Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)},array:{validate:(t,e)=>Array.isArray(t)||ArrayBuffer.isView(t)}};function s(t){let e=a(t);return"object"===e?t?"type"in t?Object.assign({},t,o[t.type]):"value"in t?(e=a(t.value),Object.assign({type:e},t,o[e])):{type:"object",value:t}:{type:"object",value:null}:Object.assign({type:e,value:t},o[e])}function a(t){return Array.isArray(t)||ArrayBuffer.isView(t)?"array":typeof t}class l{constructor(t){let{name:e,vs:n,fs:i,dependencies:o=[],uniforms:a,getUniforms:l,deprecations:c=[],defines:u={},inject:h={},vertexShader:d,fragmentShader:f}=t;(0,r.Z)("string"==typeof e),this.name=e,this.vs=n||d,this.fs=i||f,this.getModuleUniforms=l,this.dependencies=o,this.deprecations=this._parseDeprecationDefinitions(c),this.defines=u,this.injections=function(t){const e={vs:{},fs:{}};for(const n in t){let i=t[n];const r=n.slice(0,2);"string"==typeof i&&(i={order:0,injection:i}),e[r][n]=i}return e}(h),a&&(this.uniforms=function(t){const e={};for(const n in t){const i=s(t[n]);e[n]=i}return e}(a))}getModuleSource(t){let e;switch(t){case"vs":e=this.vs||"";break;case"fs":e=this.fs||"";break;default:(0,r.Z)(!1)}return"#define MODULE_".concat(this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_"),"\n").concat(e,"// END MODULE_").concat(this.name,"\n\n")}getUniforms(t,e){return this.getModuleUniforms?this.getModuleUniforms(t,e):this.uniforms?this._defaultGetUniforms(t):{}}getDefines(){return this.defines}checkDeprecations(t,e){this.deprecations.forEach((n=>{n.regex.test(t)&&(n.deprecated?e.deprecated(n.old,n.new)():e.removed(n.old,n.new)())}))}_parseDeprecationDefinitions(t){return t.forEach((t=>{"function"===t.type?t.regex=new RegExp("\\b".concat(t.old,"\\(")):t.regex=new RegExp("".concat(t.type," ").concat(t.old,";"))})),t}_defaultGetUniforms(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e={},n=this.uniforms;for(const i in n){const o=n[i];i in t&&!o.private?(o.validate&&(0,r.Z)(o.validate(t[i],o),"".concat(this.name,": invalid ").concat(i)),e[i]=t[i]):e[i]=o.value}return e}}function c(t){return function(t){const e={},n={};return u({modules:t,level:0,moduleMap:e,moduleDepth:n}),Object.keys(n).sort(((t,e)=>n[e]-n[t])).map((t=>e[t]))}(h(t))}function u(t){let{modules:e,level:n,moduleMap:i,moduleDepth:r}=t;if(n>=5)throw new Error("Possible loop in shader dependency graph");for(const t of e)i[t.name]=t,(void 0===r[t.name]||r[t.name]<n)&&(r[t.name]=n);for(const t of e)t.dependencies&&u({modules:t.dependencies,level:n+1,moduleMap:i,moduleDepth:r})}function h(t,e){return t.map((t=>(t instanceof l||((0,r.Z)("string"!=typeof t,"Shader module use by name is deprecated. Import shader module '".concat(t,"' and use it directly.")),(0,r.Z)(t.name,"shader module has no name"),(t=new l(t)).dependencies=h(t.dependencies)),t)))}function d(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e="undefined"!=typeof window&&window.navigator||{},n=t.userAgent||e.userAgent||"",i=-1!==n.indexOf("MSIE "),r=-1!==n.indexOf("Trident/");return i||r}const f={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},p={};Object.keys(f).forEach((t=>{p[t]=t}));const g={};function m(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=f[e];if((0,r.Z)(i,e),!d(n))return!0;if(e in g)return g[e];const o=i[0],s=n.behavior||"enable",a="#extension GL_".concat(o," : ").concat(s,"\nvoid main(void) {}"),l=t.createShader(35633);t.shaderSource(l,a),t.compileShader(l);const c=t.getShaderParameter(l,35713);return t.deleteShader(l),g[e]=c,c}function _(t,e){return(e=Array.isArray(e)?e:[e]).every((e=>function(t,e){const n=f[e];(0,r.Z)(n,e);const i=function(t){return"undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||Boolean(t&&2===t._version)}(t)&&n[1]||n[0],o="string"==typeof i?Boolean(t.getExtension(i)):i;return(0,r.Z)(!1===o||!0===o),o}(t,e)))}var v=n(6713);function b(t){return new RegExp("\\b".concat(t,"[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)"),"g")}const y=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,"#version 300 es\n"],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],w=[...y,[b("attribute"),"in $1"],[b("varying"),"out $1"]],x=[...y,[b("varying"),"in $1"]],C=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],k=[...C,[b("in"),"attribute $1"],[b("out"),"varying $1"]],E=[...C,[b("in"),"varying $1"]],S="gl_FragColor",A=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,T=/void\s+main\s*\([^)]*\)\s*\{\n?/;function M(t,e){for(const[n,i]of e)t=t.replace(n,i);return t}const D="\n\n".concat(v.O_,"\n\n"),P={[i.H]:"vertex",[i.Y]:"fragment"};function L(t,e){let{id:n,source:o,type:s,modules:a,defines:l={},hookFunctions:c=[],inject:u={},transpileToGLSL100:h=!1,prologue:d=!0,log:f}=e;(0,r.Z)("string"==typeof o,"shader source must be a string");const g=s===i.H,b=o.split("\n");let y=100,C="",L=o;0===b[0].indexOf("#version ")?(y=300,C=b[0],L=b.slice(1).join("\n")):C="#version ".concat(y);const R={};a.forEach((t=>{Object.assign(R,t.getDefines())})),Object.assign(R,l);let I=d?"".concat(C,"\n").concat(function(t){let{id:e,source:n,type:i}=t;return e&&"string"==typeof e&&-1===n.indexOf("SHADER_NAME")?"\n#define SHADER_NAME ".concat(e,"_").concat(P[i],"\n\n"):""}({id:n,source:o,type:s}),"\n").concat(function(t){let{type:e}=t;return"\n#define SHADER_TYPE_".concat(P[e].toUpperCase(),"\n")}({type:s}),"\n").concat(function(t){const e=function(t){const e=t.getExtension("WEBGL_debug_renderer_info"),n=t.getParameter(e&&e.UNMASKED_VENDOR_WEBGL||7936),i=t.getParameter(e&&e.UNMASKED_RENDERER_WEBGL||7937),r=function(t,e){return t.match(/NVIDIA/i)||e.match(/NVIDIA/i)?"NVIDIA":t.match(/INTEL/i)||e.match(/INTEL/i)?"INTEL":t.match(/AMD/i)||e.match(/AMD/i)||t.match(/ATI/i)||e.match(/ATI/i)?"AMD":"UNKNOWN GPU"}(n,i);return{gpuVendor:r,vendor:n,renderer:i,version:t.getParameter(7938),shadingLanguageVersion:t.getParameter(35724)}}(t);switch(e.gpuVendor.toLowerCase()){case"nvidia":return"#define NVIDIA_GPU\n// Nvidia optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n";case"intel":return"#define INTEL_GPU\n// Intel optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n";case"amd":return"#define AMD_GPU\n";default:return"#define DEFAULT_GPU\n// Prevent driver from optimizing away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n"}}(t),"\n").concat(function(t,e,n){let i="#if (__VERSION__ > 120)\n\n# define FEATURE_GLSL_DERIVATIVES\n# define FEATURE_GLSL_DRAW_BUFFERS\n# define FEATURE_GLSL_FRAG_DEPTH\n# define FEATURE_GLSL_TEXTURE_LOD\n\n// DEPRECATED FLAGS, remove in v9\n# define FRAG_DEPTH\n# define DERIVATIVES\n# define DRAW_BUFFERS\n# define TEXTURE_LOD\n\n#endif // __VERSION\n";return _(t,p.GLSL_FRAG_DEPTH)&&(i+="\n// FRAG_DEPTH => gl_FragDepth is available\n#ifdef GL_EXT_frag_depth\n#extension GL_EXT_frag_depth : enable\n# define FEATURE_GLSL_FRAG_DEPTH\n# define FRAG_DEPTH\n# define gl_FragDepth gl_FragDepthEXT\n#endif\n"),_(t,p.GLSL_DERIVATIVES)&&m(t,p.GLSL_DERIVATIVES)&&(i+="\n// DERIVATIVES => dxdF, dxdY and fwidth are available\n#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n# define FEATURE_GLSL_DERIVATIVES\n# define DERIVATIVES\n#endif\n"),_(t,p.GLSL_FRAG_DATA)&&m(t,p.GLSL_FRAG_DATA,{behavior:"require"})&&(i+="\n// DRAW_BUFFERS => gl_FragData[] is available\n#ifdef GL_EXT_draw_buffers\n#extension GL_EXT_draw_buffers : require\n#define FEATURE_GLSL_DRAW_BUFFERS\n#define DRAW_BUFFERS\n#endif\n"),_(t,p.GLSL_TEXTURE_LOD)&&(i+="// TEXTURE_LOD => texture2DLod etc are available\n#ifdef GL_EXT_shader_texture_lod\n#extension GL_EXT_shader_texture_lod : enable\n\n# define FEATURE_GLSL_TEXTURE_LOD\n# define TEXTURE_LOD\n\n#endif\n"),i}(t),"\n").concat(function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=0,n="";for(const i in t){0===e&&(n+="\n// APPLICATION DEFINES\n"),e++;const r=t[i];(r||Number.isFinite(r))&&(n+="#define ".concat(i.toUpperCase()," ").concat(t[i],"\n"))}return 0===e&&(n+="\n"),n}(R),"\n").concat(g?"":"precision highp float;\n\n","\n"):"".concat(C,"\n");const O=function(t){const e={vs:{},fs:{}};return t.forEach((t=>{let n;"string"!=typeof t?(n=t,t=n.hook):n={},t=t.trim();const[i,r]=t.split(":"),o=t.replace(/\(.+/,"");e[i][o]=Object.assign(n,{signature:r})})),e}(c),z={},F={},B={};for(const t in u){const e="string"==typeof u[t]?{injection:u[t],order:0}:u[t],n=t.match(/^(v|f)s:(#)?([\w-]+)$/);if(n){const i=n[2],r=n[3];i?"decl"===r?F[t]=[e]:B[t]=[e]:z[t]=[e]}else B[t]=[e]}for(const t of a){f&&t.checkDeprecations(L,f),I+=t.getModuleSource(s,y);const e=t.injections[s];for(const t in e){const n=t.match(/^(v|f)s:#([\w-]+)$/);if(n){const i="decl"===n[2]?F:B;i[t]=i[t]||[],i[t].push(e[t])}else z[t]=z[t]||[],z[t].push(e[t])}}return I+=D,I=(0,v.ZP)(I,s,F),I+=function(t,e){let n="";for(const i in t){const r=t[i];if(n+="void ".concat(r.signature," {\n"),r.header&&(n+="  ".concat(r.header)),e[i]){const t=e[i];t.sort(((t,e)=>t.order-e.order));for(const e of t)n+="  ".concat(e.injection,"\n")}r.footer&&(n+="  ".concat(r.footer)),n+="}\n"}return n}(O[s],z),I+=L,I=(0,v.ZP)(I,s,B),I=function(t,e,n){switch(e){case 300:return n?M(t,w):function(t){const e=(t=M(t,x)).match(A);if(e){const n=e[1];t=t.replace(new RegExp("\\b".concat(S,"\\b"),"g"),n)}else{const e="fragmentColor";t=t.replace(T,(t=>"out vec4 ".concat(e,";\n").concat(t))).replace(new RegExp("\\b".concat(S,"\\b"),"g"),e)}return t}(t);case 100:return n?M(t,k):function(t){const e=(t=M(t,E)).match(A);if(e){const n=e[1];t=t.replace(A,"").replace(new RegExp("\\b".concat(n,"\\b"),"g"),S)}return t}(t);default:throw new Error("unknown GLSL version ".concat(e))}}(I,h?100:y,g),I}function R(t){return function(e){const n={};for(const i of t){const t=i.getUniforms(e,n);Object.assign(n,t)}return n}}var I=n(7944);class O{static getDefaultProgramManager(t){return t.luma=t.luma||{},t.luma.defaultProgramManager=t.luma.defaultProgramManager||new O(t),t.luma.defaultProgramManager}constructor(t){this.gl=t,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}addDefaultModule(t){this._defaultModules.find((e=>e.name===t.name))||this._defaultModules.push(t),this.stateHash++}removeDefaultModule(t){const e="string"==typeof t?t:t.name;this._defaultModules=this._defaultModules.filter((t=>t.name!==e)),this.stateHash++}addShaderHook(t,e){e&&(t=Object.assign(e,{hook:t})),this._hookFunctions.push(t),this.stateHash++}get(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{vs:e="",fs:n="",defines:r={},inject:o={},varyings:s=[],bufferMode:a=35981,transpileToGLSL100:l=!1}=t,u=this._getModuleList(t.modules),h=this._getHash(e),d=this._getHash(n),f=u.map((t=>this._getHash(t.name))).sort(),p=s.map((t=>this._getHash(t))),g=Object.keys(r).sort(),m=Object.keys(o).sort(),_=[],v=[];for(const t of g)_.push(this._getHash(t)),_.push(this._getHash(r[t]));for(const t of m)v.push(this._getHash(t)),v.push(this._getHash(o[t]));const b="".concat(h,"/").concat(d,"D").concat(_.join("/"),"M").concat(f.join("/"),"I").concat(v.join("/"),"V").concat(p.join("/"),"H").concat(this.stateHash,"B").concat(a).concat(l?"T":"");if(!this._programCache[b]){const t=function(t,e){const{vs:n,fs:r}=e,o=c(e.modules||[]);return{gl:t,vs:L(t,Object.assign({},e,{source:n,type:i.H,modules:o})),fs:L(t,Object.assign({},e,{source:r,type:i.Y,modules:o})),getUniforms:R(o)}}(this.gl,{vs:e,fs:n,modules:u,inject:o,defines:r,hookFunctions:this._hookFunctions,transpileToGLSL100:l});this._programCache[b]=new I.Z(this.gl,{hash:b,vs:t.vs,fs:t.fs,varyings:s,bufferMode:a}),this._getUniforms[b]=t.getUniforms||(t=>{}),this._useCounts[b]=0}return this._useCounts[b]++,this._programCache[b]}getUniforms(t){return this._getUniforms[t.hash]||null}release(t){const e=t.hash;this._useCounts[e]--,0===this._useCounts[e]&&(this._programCache[e].delete(),delete this._programCache[e],delete this._getUniforms[e],delete this._useCounts[e])}_getHash(t){return void 0===this._hashes[t]&&(this._hashes[t]=this._hashCounter++),this._hashes[t]}_getModuleList(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const e=new Array(this._defaultModules.length+t.length),n={};let i=0;for(let t=0,r=this._defaultModules.length;t<r;++t){const r=this._defaultModules[t],o=r.name;e[i++]=r,n[o]=!0}for(let r=0,o=t.length;r<o;++r){const o=t[r],s=o.name;n[s]||(e[i++]=o,n[s]=!0)}return e.length=i,e}}},9450:(t,e,n)=>{"use strict";n.d(e,{KQ:()=>c,JD:()=>l,s9:()=>J,JY:()=>$,w:()=>H,vd:()=>a,yW:()=>tt,UF:()=>o,D0:()=>s,cM:()=>i,kL:()=>V,aQ:()=>et,dR:()=>U,s8:()=>W});const i=new(n(9109).Z)({id:"luma.gl"});function r(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}function o(t){return"undefined"!=typeof WebGLRenderingContext&&t instanceof WebGLRenderingContext||"undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||Boolean(t&&Number.isFinite(t._version))}function s(t){return"undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||Boolean(t&&2===t._version)}function a(t){return s(t)?t:null}function l(t){return r(o(t),"Invalid WebGLRenderingContext"),t}function c(t){return r(s(t),"Requires WebGL2"),t}const u={};const h=function t(e){const n=e.gl;this.ext=e,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(e.maxVertexAttribs);for(let e=0;e<this.attribs.length;e++){const i=new t.VertexAttrib(n);this.attribs[e]=i}this.maxAttrib=0};(h.VertexAttrib=function(t){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()}).prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const d=function(t){const e=this;this.gl=t,function(t){const e=t.getError;t.getError=function(){let n;do{n=e.apply(t),0!==n&&(u[n]=!0)}while(0!==n);for(n in u)if(u[n])return delete u[n],parseInt(n,10);return 0}}(t);const n=this.original={getParameter:t.getParameter,enableVertexAttribArray:t.enableVertexAttribArray,disableVertexAttribArray:t.disableVertexAttribArray,bindBuffer:t.bindBuffer,getVertexAttrib:t.getVertexAttrib,vertexAttribPointer:t.vertexAttribPointer};t.getParameter=function(t){return t===e.VERTEX_ARRAY_BINDING_OES?e.currentVertexArrayObject===e.defaultVertexArrayObject?null:e.currentVertexArrayObject:n.getParameter.apply(this,arguments)},t.enableVertexAttribArray=function(t){const i=e.currentVertexArrayObject;i.maxAttrib=Math.max(i.maxAttrib,t);const r=i.attribs[t];return r.enabled=!0,n.enableVertexAttribArray.apply(this,arguments)},t.disableVertexAttribArray=function(t){const i=e.currentVertexArrayObject;i.maxAttrib=Math.max(i.maxAttrib,t);const r=i.attribs[t];return r.enabled=!1,n.disableVertexAttribArray.apply(this,arguments)},t.bindBuffer=function(t,i){switch(t){case 34962:e.currentArrayBuffer=i;break;case 34963:e.currentVertexArrayObject.elementArrayBuffer=i}return n.bindBuffer.apply(this,arguments)},t.getVertexAttrib=function(t,i){const r=e.currentVertexArrayObject,o=r.attribs[t];switch(i){case 34975:return o.buffer;case 34338:return o.enabled;case 34339:return o.size;case 34340:return o.stride;case 34341:return o.type;case 34922:return o.normalized;default:return n.getVertexAttrib.apply(this,arguments)}},t.vertexAttribPointer=function(t,i,r,o,s,a){const l=e.currentVertexArrayObject;l.maxAttrib=Math.max(l.maxAttrib,t);const c=l.attribs[t];return c.buffer=e.currentArrayBuffer,c.size=i,c.type=r,c.normalized=o,c.stride=s,c.offset=a,c.recache(),n.vertexAttribPointer.apply(this,arguments)},t.instrumentExtension&&t.instrumentExtension(this,"OES_vertex_array_object"),t.canvas&&t.canvas.addEventListener("webglcontextrestored",(()=>{globalThis.console&&globalThis.console.log&&globalThis.console.log("OESVertexArrayObject emulation library context restored"),e.reset_()}),!0),this.reset_()};d.prototype.VERTEX_ARRAY_BINDING_OES=34229,d.prototype.reset_=function(){if(void 0!==this.vertexArrayObjects)for(let t=0;t<this.vertexArrayObjects.length;++t)this.vertexArrayObjects.isAlive=!1;const t=this.gl;this.maxVertexAttribs=t.getParameter(34921),this.defaultVertexArrayObject=new h(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)},d.prototype.createVertexArrayOES=function(){const t=new h(this);return this.vertexArrayObjects.push(t),t},d.prototype.deleteVertexArrayOES=function(t){t.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(t),1),this.currentVertexArrayObject===t&&this.bindVertexArrayOES(null)},d.prototype.isVertexArrayOES=function(t){return!!(t&&t instanceof h&&t.hasBeenBound&&t.ext===this)},d.prototype.bindVertexArrayOES=function(t){const e=this.gl;if(t&&!t.isAlive)return n="bindVertexArrayOES: attempt to bind deleted arrayObject",u[1282]=!0,void(void 0!==n&&(i=n,globalThis.console&&globalThis.console.error&&globalThis.console.error(i)));var n,i;const r=this.original,o=this.currentVertexArrayObject;this.currentVertexArrayObject=t||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const s=this.currentVertexArrayObject;if(o===s)return;o&&s.elementArrayBuffer===o.elementArrayBuffer||r.bindBuffer.call(e,34963,s.elementArrayBuffer);let a=this.currentArrayBuffer;const l=Math.max(o?o.maxAttrib:0,s.maxAttrib);for(let t=0;t<=l;t++){const n=s.attribs[t],i=o?o.attribs[t]:null;if(o&&n.enabled===i.enabled||(n.enabled?r.enableVertexAttribArray.call(e,t):r.disableVertexAttribArray.call(e,t)),n.enabled){let s=!1;o&&n.buffer===i.buffer||(a!==n.buffer&&(r.bindBuffer.call(e,34962,n.buffer),a=n.buffer),s=!0),(s||n.cached!==i.cached)&&r.vertexAttribPointer.call(e,t,n.size,n.type,n.normalized,n.stride,n.offset)}}this.currentArrayBuffer!==a&&r.bindBuffer.call(e,34962,this.currentArrayBuffer)};const f="OES_element_index",p="WEBGL_draw_buffers",g="WEBGL_debug_renderer_info",m=t=>s(t)?void 0:0,_={3074:t=>s(t)?void 0:36064,35723:t=>s(t)?void 0:4352,35977:m,32937:m,36795:(t,e)=>{const n=s(t)?t.getExtension("EXT_disjoint_timer_query_webgl2"):t.getExtension("EXT_disjoint_timer_query");return n&&n.GPU_DISJOINT_EXT?e(n.GPU_DISJOINT_EXT):0},37445:(t,e)=>{const n=t.getExtension(g);return e(n&&n.UNMASKED_VENDOR_WEBGL||7936)},37446:(t,e)=>{const n=t.getExtension(g);return e(n&&n.UNMASKED_RENDERER_WEBGL||7937)},34047:(t,e)=>{const n=t.luma.extensions.EXT_texture_filter_anisotropic;return n?e(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},32883:m,35071:m,37447:m,36063:(t,e)=>{if(!s(t)){const n=t.getExtension(p);return n?e(n.MAX_COLOR_ATTACHMENTS_WEBGL):0}},35379:m,35374:m,35377:m,34852:t=>{if(!s(t)){const e=t.getExtension(p);return e?e.MAX_DRAW_BUFFERS_WEBGL:0}},36203:t=>t.getExtension(f)?2147483647:65535,33001:t=>t.getExtension(f)?16777216:65535,33e3:t=>16777216,37157:m,35373:m,35657:m,36183:m,37137:m,34045:m,35978:m,35979:m,35968:m,35376:m,35375:m,35659:m,37154:m,35371:m,35658:m,35076:m,35077:m,35380:m},v="ANGLE_instanced_arrays",b={OES_vertex_array_object:{meta:{suffix:"OES"},createVertexArray:()=>{r(!1,"VertexArray requires WebGL2 or OES_vertex_array_object extension")},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},[v]:{meta:{suffix:"ANGLE"},vertexAttribDivisor(t,e){r(0===e,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},WEBGL_draw_buffers:{meta:{suffix:"WEBGL"},drawBuffers:()=>{r(!1)}},EXT_disjoint_timer_query:{meta:{suffix:"EXT"},createQuery:()=>{r(!1)},deleteQuery:()=>{r(!1)},beginQuery:()=>{r(!1)},endQuery:()=>{},getQuery(t,e){return this.getQueryObject(t,e)},getQueryParameter(t,e){return this.getQueryObject(t,e)},getQueryObject:()=>{}}},y={readBuffer:(t,e,n)=>{s(t)&&e(n)},getVertexAttrib:(t,e,n,i)=>{const{webgl2:r,ext:o}=function(t,e){return{webgl2:s(t),ext:t.getExtension("ANGLE_instanced_arrays")}}(t);let a;switch(i){case 35069:a=!!r&&void 0;break;case 35070:a=r||o?void 0:0}return void 0!==a?a:e(n,i)},getProgramParameter:(t,e,n,i)=>{if(!s(t))switch(i){case 35967:return 35981;case 35971:case 35382:return 0}return e(n,i)},getInternalformatParameter:(t,e,n,i,r)=>s(t)||32937!==r?t.getInternalformatParameter(n,i,r):new Int32Array([0]),getTexParameter(t,e,n,i){if(34046===i){const{extensions:e}=t.luma,n=e.EXT_texture_filter_anisotropic;i=n&&n.TEXTURE_MAX_ANISOTROPY_EXT||34046}return e(n,i)},getParameter:function(t,e,n){const i=_[n],r="function"==typeof i?i(t,e,n):i;return void 0!==r?r:e(n)},hint:(t,e,n,i)=>e(n,i)};function w(t,e){let{extension:n,target:i,target2:o}=e;const s=b[n];r(s);const{meta:a={}}=s,{suffix:l=""}=a,c=t.getExtension(n);for(const e of Object.keys(s)){const n="".concat(e).concat(l);let r=null;"meta"===e||"function"==typeof t[e]||(c&&"function"==typeof c[n]?r=function(){return c[n](...arguments)}:"function"==typeof s[e]&&(r=s[e].bind(i))),r&&(i[e]=r,o[e]=r)}}globalThis.polyfillContext=function(t){t.luma=t.luma||{};const{luma:e}=t;return e.polyfilled||(function(t){if("function"==typeof t.createVertexArray)return;const e=t.getSupportedExtensions;t.getSupportedExtensions=function(){const t=e.call(this)||[];return t.indexOf("OES_vertex_array_object")<0&&t.push("OES_vertex_array_object"),t};const n=t.getExtension;t.getExtension=function(e){return n.call(this,e)||("OES_vertex_array_object"!==e?null:(t.__OESVertexArrayObject||(this.__OESVertexArrayObject=new d(this)),this.__OESVertexArrayObject))}}(t),function(t){t.luma.extensions={};const e=t.getSupportedExtensions()||[];for(const n of e)t.luma[n]=t.getExtension(n)}(t),function(t,e){for(const n of Object.getOwnPropertyNames(e))"overrides"!==n&&w(t,{extension:n,target:t.luma,target2:t})}(t,b),function(t,e){let{target:n,target2:i}=e;Object.keys(y).forEach((e=>{if("function"==typeof y[e]){const r=t[e]?t[e].bind(t):()=>{},o=y[e].bind(null,t,r);n[e]=o,i[e]=o}}))}(t,{target:e,target2:t}),e.polyfilled=!0),t};const x={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,36006:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],3333:4,3317:4,37440:!1,37441:!1,37443:37444,35723:4352,36010:null,35977:!1,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},C=(t,e,n)=>e?t.enable(n):t.disable(n),k=(t,e,n)=>t.hint(n,e),E=(t,e,n)=>t.pixelStorei(n,e);function S(t){return Array.isArray(t)||ArrayBuffer.isView(t)}const A={3042:C,32773:(t,e)=>t.blendColor(...e),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(t,e)=>t.clearColor(...e),3107:(t,e)=>t.colorMask(...e),2884:C,2885:(t,e)=>t.cullFace(e),2929:C,2931:(t,e)=>t.clearDepth(e),2932:(t,e)=>t.depthFunc(e),2928:(t,e)=>t.depthRange(...e),2930:(t,e)=>t.depthMask(e),3024:C,35723:k,36006:(t,e)=>{const n=s(t)?36009:36160;return t.bindFramebuffer(n,e)},2886:(t,e)=>t.frontFace(e),33170:k,2849:(t,e)=>t.lineWidth(e),32823:C,32824:"polygonOffset",10752:"polygonOffset",35977:C,32938:"sampleCoverage",32939:"sampleCoverage",3089:C,3088:(t,e)=>t.scissor(...e),2960:C,2961:(t,e)=>t.clearStencil(e),2968:(t,e)=>t.stencilMaskSeparate(1028,e),36005:(t,e)=>t.stencilMaskSeparate(1029,e),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(t,e)=>t.viewport(...e),3333:E,3317:E,37440:E,37441:E,37443:E,3330:E,3332:E,3331:E,36010:(t,e)=>t.bindFramebuffer(36008,e),3314:E,32878:E,3316:E,3315:E,32877:E,framebuffer:(t,e)=>{const n=e&&"handle"in e?e.handle:e;return t.bindFramebuffer(36160,n)},blend:(t,e)=>e?t.enable(3042):t.disable(3042),blendColor:(t,e)=>t.blendColor(...e),blendEquation:(t,e)=>{e=S(e)?e:[e,e],t.blendEquationSeparate(...e)},blendFunc:(t,e)=>{e=S(e)&&2===e.length?[...e,...e]:e,t.blendFuncSeparate(...e)},clearColor:(t,e)=>t.clearColor(...e),clearDepth:(t,e)=>t.clearDepth(e),clearStencil:(t,e)=>t.clearStencil(e),colorMask:(t,e)=>t.colorMask(...e),cull:(t,e)=>e?t.enable(2884):t.disable(2884),cullFace:(t,e)=>t.cullFace(e),depthTest:(t,e)=>e?t.enable(2929):t.disable(2929),depthFunc:(t,e)=>t.depthFunc(e),depthMask:(t,e)=>t.depthMask(e),depthRange:(t,e)=>t.depthRange(...e),dither:(t,e)=>e?t.enable(3024):t.disable(3024),derivativeHint:(t,e)=>{t.hint(35723,e)},frontFace:(t,e)=>t.frontFace(e),mipmapHint:(t,e)=>t.hint(33170,e),lineWidth:(t,e)=>t.lineWidth(e),polygonOffsetFill:(t,e)=>e?t.enable(32823):t.disable(32823),polygonOffset:(t,e)=>t.polygonOffset(...e),sampleCoverage:(t,e)=>t.sampleCoverage(...e),scissorTest:(t,e)=>e?t.enable(3089):t.disable(3089),scissor:(t,e)=>t.scissor(...e),stencilTest:(t,e)=>e?t.enable(2960):t.disable(2960),stencilMask:(t,e)=>{e=S(e)?e:[e,e];const[n,i]=e;t.stencilMaskSeparate(1028,n),t.stencilMaskSeparate(1029,i)},stencilFunc:(t,e)=>{e=S(e)&&3===e.length?[...e,...e]:e;const[n,i,r,o,s,a]=e;t.stencilFuncSeparate(1028,n,i,r),t.stencilFuncSeparate(1029,o,s,a)},stencilOp:(t,e)=>{e=S(e)&&3===e.length?[...e,...e]:e;const[n,i,r,o,s,a]=e;t.stencilOpSeparate(1028,n,i,r),t.stencilOpSeparate(1029,o,s,a)},viewport:(t,e)=>t.viewport(...e)};function T(t,e,n){return void 0!==e[t]?e[t]:n[t]}const M={blendEquation:(t,e,n)=>t.blendEquationSeparate(T(32777,e,n),T(34877,e,n)),blendFunc:(t,e,n)=>t.blendFuncSeparate(T(32969,e,n),T(32968,e,n),T(32971,e,n),T(32970,e,n)),polygonOffset:(t,e,n)=>t.polygonOffset(T(32824,e,n),T(10752,e,n)),sampleCoverage:(t,e,n)=>t.sampleCoverage(T(32938,e,n),T(32939,e,n)),stencilFuncFront:(t,e,n)=>t.stencilFuncSeparate(1028,T(2962,e,n),T(2967,e,n),T(2963,e,n)),stencilFuncBack:(t,e,n)=>t.stencilFuncSeparate(1029,T(34816,e,n),T(36003,e,n),T(36004,e,n)),stencilOpFront:(t,e,n)=>t.stencilOpSeparate(1028,T(2964,e,n),T(2965,e,n),T(2966,e,n)),stencilOpBack:(t,e,n)=>t.stencilOpSeparate(1029,T(34817,e,n),T(34818,e,n),T(34819,e,n))},D={enable:(t,e)=>t({[e]:!0}),disable:(t,e)=>t({[e]:!1}),pixelStorei:(t,e,n)=>t({[e]:n}),hint:(t,e,n)=>t({[e]:n}),bindFramebuffer:(t,e,n)=>{switch(e){case 36160:return t({36006:n,36010:n});case 36009:return t({36006:n});case 36008:return t({36010:n});default:return null}},blendColor:(t,e,n,i,r)=>t({32773:new Float32Array([e,n,i,r])}),blendEquation:(t,e)=>t({32777:e,34877:e}),blendEquationSeparate:(t,e,n)=>t({32777:e,34877:n}),blendFunc:(t,e,n)=>t({32969:e,32968:n,32971:e,32970:n}),blendFuncSeparate:(t,e,n,i,r)=>t({32969:e,32968:n,32971:i,32970:r}),clearColor:(t,e,n,i,r)=>t({3106:new Float32Array([e,n,i,r])}),clearDepth:(t,e)=>t({2931:e}),clearStencil:(t,e)=>t({2961:e}),colorMask:(t,e,n,i,r)=>t({3107:[e,n,i,r]}),cullFace:(t,e)=>t({2885:e}),depthFunc:(t,e)=>t({2932:e}),depthRange:(t,e,n)=>t({2928:new Float32Array([e,n])}),depthMask:(t,e)=>t({2930:e}),frontFace:(t,e)=>t({2886:e}),lineWidth:(t,e)=>t({2849:e}),polygonOffset:(t,e,n)=>t({32824:e,10752:n}),sampleCoverage:(t,e,n)=>t({32938:e,32939:n}),scissor:(t,e,n,i,r)=>t({3088:new Int32Array([e,n,i,r])}),stencilMask:(t,e)=>t({2968:e,36005:e}),stencilMaskSeparate:(t,e,n)=>t({[1028===e?2968:36005]:n}),stencilFunc:(t,e,n,i)=>t({2962:e,2967:n,2963:i,34816:e,36003:n,36004:i}),stencilFuncSeparate:(t,e,n,i,r)=>t({[1028===e?2962:34816]:n,[1028===e?2967:36003]:i,[1028===e?2963:36004]:r}),stencilOp:(t,e,n,i)=>t({2964:e,2965:n,2966:i,34817:e,34818:n,34819:i}),stencilOpSeparate:(t,e,n,i,r)=>t({[1028===e?2964:34817]:n,[1028===e?2965:34818]:i,[1028===e?2966:34819]:r}),viewport:(t,e,n,i,r)=>t({2978:[e,n,i,r]})},P=(t,e)=>t.isEnabled(e),L={3042:P,2884:P,2929:P,3024:P,32823:P,32926:P,32928:P,3089:P,2960:P,35977:P};function R(t){for(const e in t)return!1;return!0}function I(t,e){if(t===e)return!0;const n=Array.isArray(t)||ArrayBuffer.isView(t),i=Array.isArray(e)||ArrayBuffer.isView(e);if(n&&i&&t.length===e.length){for(let n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0}return!1}function O(t,e){const n=t[e].bind(t);t[e]=function(){const e=arguments.length<=0?void 0:arguments[0];return e in t.state.cache&&t.state.enable?t.state.cache[e]:n(...arguments)},Object.defineProperty(t[e],"name",{value:"".concat(e,"-from-cache"),configurable:!1})}function z(t,e,n){const i=t[e].bind(t);t[e]=function(){for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];const{valueChanged:s,oldValue:a}=n(t.state._updateCache,...r);return s&&i(...r),a},Object.defineProperty(t[e],"name",{value:"".concat(e,"-to-cache"),configurable:!1})}function F(t){const e=t.useProgram.bind(t);t.useProgram=function(n){t.state.program!==n&&(e(n),t.state.program=n)}}class B{constructor(t){let{copyState:e=!1,log:n=(()=>{})}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.gl=t,this.program=null,this.stateStack=[],this.enable=!0,this.cache=e?function(t,e){if("number"==typeof(e=e||x)){const n=e,i=L[n];return i?i(t,n):t.getParameter(n)}const n=Array.isArray(e)?e:Object.keys(e),i={};for(const e of n){const n=L[e];i[e]=n?n(t,Number(e)):t.getParameter(Number(e))}return i}(t):Object.assign({},x),this.log=n,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(){this.stateStack.push({})}pop(){r(this.stateStack.length>0);const t=this.stateStack[this.stateStack.length-1];U(this.gl,t),this.stateStack.pop()}_updateCache(t){let e,n=!1;const i=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const o in t){r(void 0!==o);const s=t[o],a=this.cache[o];I(s,a)||(n=!0,e=a,i&&!(o in i)&&(i[o]=a),this.cache[o]=s)}return{valueChanged:n,oldValue:e}}}function N(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{enable:n=!0,copyState:i}=e;if(r(void 0!==i),!t.state){const{polyfillContext:e}=globalThis;e&&e(t),t.state=new B(t,{copyState:i}),F(t);for(const e in D)z(t,e,D[e]);O(t,"getParameter"),O(t,"isEnabled")}return t.state.enable=n,t}function j(t){r(t.state),t.state.pop()}function U(t,e){if(r(o(t),"setParameters requires a WebGL context"),R(e))return;const n={};for(const i in e){const r=Number(i),o=A[i];o&&("string"==typeof o?n[o]=!0:o(t,e[i],r))}const i=t.state&&t.state.cache;if(i)for(const r in n)(0,M[r])(t,e,i)}function V(t){U(t,x)}function W(t,e,n){if(R(e))return n(t);const{nocatch:i=!0}=e;let r;if(function(t){t.state||N(t,{copyState:!1}),t.state.push()}(t),U(t,e),i)r=n(t),j(t);else try{r=n(t)}finally{j(t)}return r}function H(t){const{luma:e}=t;if(t.canvas&&e){const{clientWidth:n}=e.canvasSizeInfo;return n?t.drawingBufferWidth/n:1}return 1}function $(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const i=H(t),r=t.drawingBufferWidth,o=t.drawingBufferHeight;return q(e,i,r,o,n)}function Z(t){const e="undefined"==typeof window?1:window.devicePixelRatio||1;return Number.isFinite(t)?t<=0?1:t:t?e:1}function q(t,e,n,i,r){const o=G(t[0],e,n);let s=K(t[1],e,i,r),a=G(t[0]+1,e,n);const l=a===n-1?a:a-1;let c;return a=K(t[1]+1,e,i,r),r?(a=0===a?a:a+1,c=s,s=a):c=a===i-1?a:a-1,{x:o,y:s,width:Math.max(l-o+1,1),height:Math.max(c-s+1,1)}}function G(t,e,n){return Math.min(Math.round(t*e),n-1)}function K(t,e,n,i){return i?Math.max(0,n-1-Math.round(t*e)):Math.min(Math.round(t*e),n-1)}const X=(0,n(3370).Z)(),Y=X&&"undefined"!=typeof document,Q={webgl2:!0,webgl1:!0,throwOnError:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function J(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r(X,"createGLContext only available in the browser.\nCreate your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils"),t=Object.assign({},Q,t);const{width:e,height:n}=t;function i(e){if(t.throwOnError)throw new Error(e);return console.error(e),null}let o;t.onError=i;const{canvas:s}=t,a=it({canvas:s,width:e,height:n,onError:i});return o=nt(a,t),o?(o=tt(o,t),rt(o),o):null}function tt(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!t||t._instrumented)return t;t._version=t._version||ot(t),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{},e=Object.assign({},Q,e);const{manageState:n,debug:r}=e;return n&&N(t,{copyState:!1,log:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return i.log(1,...e)()}}),X&&r&&(globalThis.makeDebugContext?(t=globalThis.makeDebugContext(t,e),i.level=Math.max(i.level,1)):i.warn('WebGL debug mode not activated. import "@luma.gl/debug" to enable.')()),t._instrumented=!0,t}function et(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t.canvas)return void st(t,Z(e.useDevicePixels),e);const n=t.getExtension("STACKGL_resize_drawingbuffer");n&&"width"in e&&"height"in e&&n.resize(e.width,e.height)}function nt(t,e){const{onError:n}=e;let i=null;const r=t=>i=t.statusMessage||i;t.addEventListener("webglcontextcreationerror",r,!1);const{webgl1:o=!0,webgl2:s=!0}=e;let a=null;return s&&(a=a||t.getContext("webgl2",e),a=a||t.getContext("experimental-webgl2",e)),o&&(a=a||t.getContext("webgl",e),a=a||t.getContext("experimental-webgl",e)),t.removeEventListener("webglcontextcreationerror",r,!1),a?(e.onContextLost&&t.addEventListener("webglcontextlost",e.onContextLost,!1),e.onContextRestored&&t.addEventListener("webglcontextrestored",e.onContextRestored,!1),a):n("Failed to create ".concat(s&&!o?"WebGL2":"WebGL"," context: ").concat(i||"Unknown error"))}function it(t){let e,{canvas:n,width:i=800,height:r=600,onError:o}=t;return"string"==typeof n?(Y&&"complete"===document.readyState||o("createGLContext called on canvas '".concat(n,"' before page was loaded")),e=document.getElementById(n)):n?e=n:(e=document.createElement("canvas"),e.id="lumagl-canvas",e.style.width=Number.isFinite(i)?"".concat(i,"px"):"100%",e.style.height=Number.isFinite(r)?"".concat(r,"px"):"100%",document.body.insertBefore(e,document.body.firstChild)),e}function rt(t){const e=s(t)?"WebGL2":"WebGL1",n=function(t){const e=t.getParameter(7936),n=t.getParameter(7937),i=t.getExtension("WEBGL_debug_renderer_info");return{vendor:i&&t.getParameter(i.UNMASKED_VENDOR_WEBGL||7936)||e,renderer:i&&t.getParameter(i.UNMASKED_RENDERER_WEBGL||7937)||n,vendorMasked:e,rendererMasked:n,version:t.getParameter(7938),shadingLanguageVersion:t.getParameter(35724)}}(t),r=n?"(".concat(n.vendor,",").concat(n.renderer,")"):"",o=t.debug?" debug":"";i.info(1,"".concat(e).concat(o," context ").concat(r))()}function ot(t){return"undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext?2:1}function st(t,e,n){let r="width"in n?n.width:t.canvas.clientWidth,o="height"in n?n.height:t.canvas.clientHeight;r&&o||(i.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,r=t.canvas.width||1,o=t.canvas.height||1),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{};const s=t.luma.canvasSizeInfo;if(s.clientWidth!==r||s.clientHeight!==o||s.devicePixelRatio!==e){let n=e;const s=Math.floor(r*n),a=Math.floor(o*n);t.canvas.width=s,t.canvas.height=a,t.drawingBufferWidth===s&&t.drawingBufferHeight===a||(i.warn("Device pixel ratio clamped")(),n=Math.min(t.drawingBufferWidth/r,t.drawingBufferHeight/o),t.canvas.width=Math.floor(r*n),t.canvas.height=Math.floor(o*n)),Object.assign(t.luma.canvasSizeInfo,{clientWidth:r,clientHeight:o,devicePixelRatio:e})}}},5682:(t,e,n)=>{"use strict";n.d(e,{H:()=>i,Y:()=>r});const i="vs",r="fs"},6713:(t,e,n)=>{"use strict";n.d(e,{O_:()=>s,Lm:()=>h,ZP:()=>u});var i=n(5682),r=n(9047);const o={[i.H]:"#ifdef MODULE_LOGDEPTH\n  logdepth_adjustPosition(gl_Position);\n#endif\n",[i.Y]:"#ifdef MODULE_MATERIAL\n  gl_FragColor = material_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LIGHTING\n  gl_FragColor = lighting_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_FOG\n  gl_FragColor = fog_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_PICKING\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LOGDEPTH\n  logdepth_setFragDepth();\n#endif\n"},s="__LUMA_INJECT_DECLARATIONS__",a=/void\s+main\s*\([^)]*\)\s*\{\n?/,l=/}\n?[^{}]*$/,c=[];function u(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const u=e===i.H;for(const e in n){const i=n[e];i.sort(((t,e)=>t.order-e.order)),c.length=i.length;for(let t=0,e=i.length;t<e;++t)c[t]=i[t].injection;const r="".concat(c.join("\n"),"\n");switch(e){case"vs:#decl":u&&(t=t.replace(s,r));break;case"vs:#main-start":u&&(t=t.replace(a,(t=>t+r)));break;case"vs:#main-end":u&&(t=t.replace(l,(t=>r+t)));break;case"fs:#decl":u||(t=t.replace(s,r));break;case"fs:#main-start":u||(t=t.replace(a,(t=>t+r)));break;case"fs:#main-end":u||(t=t.replace(l,(t=>r+t)));break;default:t=t.replace(e,(t=>t+r))}}return t=t.replace(s,""),r&&(t=t.replace(/\}\s*$/,(t=>t+o[e]))),t}function h(t){const e={};return(0,r.Z)(Array.isArray(t)&&t.length>1),t.forEach((t=>{for(const n in t)e[n]=e[n]?"".concat(e[n],"\n").concat(t[n]):t[n]})),e}},9047:(t,e,n)=>{"use strict";function i(t,e){if(!t)throw new Error(e||"shadertools: assertion failed.")}n.d(e,{Z:()=>i})},4072:(t,e,n)=>{"use strict";n.d(e,{Z:()=>l});var i=n(9335),r=n(2525),o=n(2610);const s={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},a={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class l{static getBytesPerElement(t){return(0,i.vN)(t.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(t){return(0,r.h)(t.size),(0,i.vN)(t.type||5126).BYTES_PER_ELEMENT*t.size}static resolve(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new l(...[s,...e])}constructor(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];e.forEach((t=>this._assign(t))),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return l.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return l.getBytesPerVertex(this)}_assign(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t=(0,o.k)("Accessor",t,a),void 0!==t.type&&(this.type=t.type,5124!==t.type&&5125!==t.type||(this.integer=!0)),void 0!==t.size&&(this.size=t.size),void 0!==t.offset&&(this.offset=t.offset),void 0!==t.stride&&(this.stride=t.stride),void 0!==t.normalized&&(this.normalized=t.normalized),void 0!==t.integer&&(this.integer=t.integer),void 0!==t.divisor&&(this.divisor=t.divisor),void 0!==t.buffer&&(this.buffer=t.buffer),void 0!==t.index&&("boolean"==typeof t.index?this.index=t.index?1:0:this.index=t.index),void 0!==t.instanced&&(this.divisor=t.instanced?1:0),void 0!==t.isInstanced&&(this.divisor=t.isInstanced?1:0),this}}},3478:(t,e,n)=>{"use strict";n.d(e,{Z:()=>d});var i=n(7577),r=n(4072),o=n(9335),s=n(9450),a=n(2525),l=n(2610);const c={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},u={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:c},h={removedProps:c};class d extends i.Z{get[Symbol.toStringTag](){return"Buffer"}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(t,e),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=e.target||(this.gl.webgl2?36662:34962),this.initialize(e),Object.seal(this)}getElementCount(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.accessor;return Math.round(this.byteLength/r.Z.getBytesPerElement(t))}getVertexCount(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.accessor;return Math.round(this.byteLength/r.Z.getBytesPerVertex(t))}initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return ArrayBuffer.isView(t)&&(t={data:t}),Number.isFinite(t)&&(t={byteLength:t}),t=(0,l.k)("Buffer",t,u),this.usage=t.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},t,t.accessor)),t.data?this._setData(t.data,t.offset,t.byteLength):this._setByteLength(t.byteLength||0),this}setProps(t){return"accessor"in(t=(0,l.k)("Buffer",t,h))&&this.setAccessor(t.accessor),this}setAccessor(t){return delete(t=Object.assign({},t)).buffer,this.accessor=new r.Z(t),this}reallocate(t){return t>this.byteLength?(this._setByteLength(t),!0):(this.bytesUsed=t,!1)}setData(t){return this.initialize(t)}subData(t){ArrayBuffer.isView(t)&&(t={data:t});const{data:e,offset:n=0,srcOffset:i=0}=t,r=t.byteLength||t.length;(0,a.h)(e);const o=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(o,this.handle),0!==i||void 0!==r?((0,s.KQ)(this.gl),this.gl.bufferSubData(this.target,n,e,i,r)):this.gl.bufferSubData(o,n,e),this.gl.bindBuffer(o,null),this.debugData=null,this._inferType(e),this}copyData(t){let{sourceBuffer:e,readOffset:n=0,writeOffset:i=0,size:r}=t;const{gl:o}=this;return(0,s.KQ)(o),o.bindBuffer(36662,e.handle),o.bindBuffer(36663,this.handle),o.copyBufferSubData(36662,36663,n,i,r),o.bindBuffer(36662,null),o.bindBuffer(36663,null),this.debugData=null,this}getData(){let{dstData:t=null,srcByteOffset:e=0,dstOffset:n=0,length:i=0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,s.KQ)(this.gl);const r=(0,o.vN)(this.accessor.type||5126,{clamped:!1}),l=this._getAvailableElementCount(e),c=n;let u,h;t?(h=t.length,u=h-c):(u=Math.min(l,i||l),h=c+u);const d=Math.min(l,u);return i=i||d,(0,a.h)(i<=d),t=t||new r(h),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,e,t,n,i),this.gl.bindBuffer(36662,null),t}bind(){let{target:t=this.target,index:e=this.accessor&&this.accessor.index,offset:n=0,size:i}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return 35345===t||35982===t?void 0!==i?this.gl.bindBufferRange(t,e,this.handle,n,i):((0,a.h)(0===n),this.gl.bindBufferBase(t,e,this.handle)):this.gl.bindBuffer(t,this.handle),this}unbind(){let{target:t=this.target,index:e=this.accessor&&this.accessor.index}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return 35345===t||35982===t?this.gl.bindBufferBase(t,e,null):this.gl.bindBuffer(t,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(10,this.byteLength)}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.byteLength+e;(0,a.h)(ArrayBuffer.isView(t)),this._trackDeallocatedMemory();const i=this._getTarget();this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,n,this.usage),this.gl.bufferSubData(i,e,t),this.gl.bindBuffer(i,null),this.debugData=t.slice(0,10),this.bytesUsed=n,this._trackAllocatedMemory(n);const s=(0,o.O)(t);return(0,a.h)(s),this.setAccessor(new r.Z(this.accessor,{type:s})),this}_setByteLength(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.usage;(0,a.h)(t>=0),this._trackDeallocatedMemory();let n=t;0===t&&(n=new Float32Array(0));const i=this._getTarget();return this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,n,e),this.gl.bindBuffer(i,null),this.usage=e,this.debugData=null,this.bytesUsed=t,this._trackAllocatedMemory(t),this}_getTarget(){return this.gl.webgl2?36663:this.target}_getAvailableElementCount(t){const e=t/(0,o.vN)(this.accessor.type||5126,{clamped:!1}).BYTES_PER_ELEMENT;return this.getElementCount()-e}_inferType(t){this.accessor.type||this.setAccessor(new r.Z(this.accessor,{type:(0,o.O)(t)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}_getParameter(t){this.gl.bindBuffer(this.target,this.handle);const e=this.gl.getBufferParameter(this.target,t);return this.gl.bindBuffer(this.target,null),e}get type(){return s.cM.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return s.cM.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(t){return s.cM.deprecated("setByteLength","reallocate")(),this.reallocate(t)}updateAccessor(t){return s.cM.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new r.Z(this.accessor,t),this}}},6047:(t,e,n)=>{"use strict";n.d(e,{$:()=>h,Z:()=>u});var i=n(9450),r=n(2525);const o=6144,s=6145,a=6146,l=34041,c="clear: bad arguments";function u(t){let{framebuffer:e=null,color:n=null,depth:o=null,stencil:s=null}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const a={};e&&(a.framebuffer=e);let l=0;n&&(l|=16384,!0!==n&&(a.clearColor=n)),o&&(l|=256,!0!==o&&(a.clearDepth=o)),s&&(l|=1024,!0!==o&&(a.clearStencil=o)),(0,r.h)(0!==l,c),(0,i.s8)(t,a,(()=>{t.clear(l)}))}function h(t){let{framebuffer:e=null,buffer:n=o,drawBuffer:u=0,value:h=[0,0,0,0]}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,i.KQ)(t),(0,i.s8)(t,{framebuffer:e},(()=>{switch(n){case o:switch(h.constructor){case Int32Array:t.clearBufferiv(n,u,h);break;case Uint32Array:t.clearBufferuiv(n,u,h);break;case Float32Array:default:t.clearBufferfv(n,u,h)}break;case s:t.clearBufferfv(s,0,[h]);break;case a:t.clearBufferiv(a,0,[h]);break;case l:const[e,i]=h;t.clearBufferfi(l,0,e,i);break;default:(0,r.h)(!1,c)}}))}},1953:(t,e,n)=>{"use strict";n.d(e,{Km:()=>u,Lv:()=>h,z6:()=>c});var i=n(3849),r=n(5008),o=n(9450),s=n(9335),a=n(2525),l=n(3028);function c(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{sourceX:n=0,sourceY:i=0,sourceFormat:r=6408}=e;let{sourceAttachment:o=36064,target:l=null,sourceWidth:c,sourceHeight:u,sourceType:h}=e;const{framebuffer:p,deleteFramebuffer:g}=d(t);(0,a.h)(p);const{gl:m,handle:_,attachments:v}=p;c=c||p.width,u=u||p.height,36064===o&&null===_&&(o=1028),(0,a.h)(v[o]),h=h||v[o].type,l=f(l,h,r,c,u),h=h||(0,s.O)(l);const b=m.bindFramebuffer(36160,_);return m.readPixels(n,i,c,u,r,h,l),m.bindFramebuffer(36160,b||null),g&&p.delete(),l}function u(t){let{sourceAttachment:e=36064,targetMaxHeight:n=Number.MAX_SAFE_INTEGER}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=c(t,{sourceAttachment:e}),{width:r,height:o}=t;for(;o>n;)({data:i,width:r,height:o}=(0,s.KS)({data:i,width:r,height:o}));(0,s.c$)({data:i,width:r,height:o});const a=document.createElement("canvas");a.width=r,a.height=o;const l=a.getContext("2d"),u=l.createImageData(r,o);return u.data.set(i),l.putImageData(u,0,0),a.toDataURL()}function h(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{sourceX:i=0,sourceY:s=0,targetMipmaplevel:l=0,targetInternalFormat:c=6408}=n;let{targetX:u,targetY:h,targetZ:f,width:p,height:g}=n;const{framebuffer:m,deleteFramebuffer:_}=d(t);(0,a.h)(m);const{gl:v,handle:b}=m,y=void 0!==u||void 0!==h||void 0!==f;u=u||0,h=h||0,f=f||0;const w=v.bindFramebuffer(36160,b);(0,a.h)(e);let x=null;if(e instanceof r.Z&&(x=e,p=Number.isFinite(p)?p:x.width,g=Number.isFinite(g)?g:x.height,x.bind(0),e=x.target),y)switch(e){case 3553:case 34067:v.copyTexSubImage2D(e,l,u,h,i,s,p,g);break;case 35866:case 32879:(0,o.KQ)(v).copyTexSubImage3D(e,l,u,h,f,i,s,p,g)}else v.copyTexImage2D(e,l,c,i,s,p,g,0);return x&&x.unbind(),v.bindFramebuffer(36160,w||null),_&&m.delete(),x}function d(t){return t instanceof i.Z?{framebuffer:t,deleteFramebuffer:!1}:{framebuffer:(0,l.Y)(t),deleteFramebuffer:!0}}function f(t,e,n,i,r){if(t)return t;e=e||5121;const o=(0,s.vN)(e,{clamped:!1}),l=function(t){switch(t){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return(0,a.h)(!1),0}}(n);return new o(i*r*l)}},3849:(t,e,n)=>{"use strict";n.d(e,{Z:()=>f});var i=n(9450),r=n(7577),o=n(4912),s=n(9830),a=n(6047),l=n(1953),c=n(8271),u=n(9579),h=n(2525);const d="Multiple render targets not supported";class f extends r.Z{get[Symbol.toStringTag](){return"Framebuffer"}static isSupported(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{colorBufferFloat:n,colorBufferHalfFloat:i}=e;let r=!0;return n&&(r=Boolean(t.getExtension("EXT_color_buffer_float")||t.getExtension("WEBGL_color_buffer_float")||t.getExtension("OES_texture_float"))),i&&(r=r&&Boolean(t.getExtension("EXT_color_buffer_float")||t.getExtension("EXT_color_buffer_half_float"))),r}static getDefaultFramebuffer(t){return t.luma=t.luma||{},t.luma.defaultFramebuffer=t.luma.defaultFramebuffer||new f(t,{id:"default-framebuffer",handle:null,attachments:{}}),t.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){const t=(0,i.KQ)(this.gl);return t.getParameter(t.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){const t=(0,i.KQ)(this.gl);return t.getParameter(t.MAX_DRAW_BUFFERS)}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(t,e),this.width=null,this.height=null,this.attachments={},this.readBuffer=36064,this.drawBuffers=[36064],this.ownResources=[],this.initialize(e),Object.seal(this)}get color(){return this.attachments[36064]||null}get texture(){return this.attachments[36064]||null}get depth(){return this.attachments[36096]||this.attachments[33306]||null}get stencil(){return this.attachments[36128]||this.attachments[33306]||null}initialize(t){let{width:e=1,height:n=1,attachments:i=null,color:r=!0,depth:o=!0,stencil:s=!1,check:a=!0,readBuffer:l,drawBuffers:c}=t;if((0,h.h)(e>=0&&n>=0,"Width and height need to be integers"),this.width=e,this.height=n,i)for(const t in i){const r=i[t];(Array.isArray(r)?r[0]:r).resize({width:e,height:n})}else i=this._createDefaultAttachments(r,o,s,e,n);this.update({clearAttachments:!0,attachments:i,readBuffer:l,drawBuffers:c}),i&&a&&this.checkStatus()}delete(){for(const t of this.ownResources)t.delete();return super.delete(),this}update(t){let{attachments:e={},readBuffer:n,drawBuffers:i,clearAttachments:r=!1,resizeAttachments:o=!0}=t;this.attach(e,{clearAttachments:r,resizeAttachments:o});const{gl:s}=this,a=s.bindFramebuffer(36160,this.handle);return n&&this._setReadBuffer(n),i&&this._setDrawBuffers(i),s.bindFramebuffer(36160,a||null),this}resize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{width:e,height:n}=t;if(null===this.handle)return(0,h.h)(void 0===e&&void 0===n),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;void 0===e&&(e=this.gl.drawingBufferWidth),void 0===n&&(n=this.gl.drawingBufferHeight),e!==this.width&&n!==this.height&&i.cM.log(2,"Resizing framebuffer ".concat(this.id," to ").concat(e,"x").concat(n))();for(const t in this.attachments)this.attachments[t].resize({width:e,height:n});return this.width=e,this.height=n,this}attach(t){let{clearAttachments:e=!1,resizeAttachments:n=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i={};e&&Object.keys(this.attachments).forEach((t=>{i[t]=null})),Object.assign(i,t);const r=this.gl.bindFramebuffer(36160,this.handle);for(const t in i){(0,h.h)(void 0!==t,"Misspelled framebuffer binding point?");const e=Number(t),r=i[e];let o=r;if(o)if(o instanceof s.Z)this._attachRenderbuffer({attachment:e,renderbuffer:o});else if(Array.isArray(r)){const[t,n=0,i=0]=r;o=t,this._attachTexture({attachment:e,texture:t,layer:n,level:i})}else this._attachTexture({attachment:e,texture:o,layer:0,level:0});else this._unattach(e);n&&o&&o.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,r||null),Object.assign(this.attachments,t),Object.keys(this.attachments).filter((t=>!this.attachments[t])).forEach((t=>{delete this.attachments[t]}))}checkStatus(){const{gl:t}=this,e=this.getStatus();if(36053!==e)throw new Error(function(t){return(f.STATUS||{})[t]||"Framebuffer error ".concat(t)}(e));return this}getStatus(){const{gl:t}=this,e=t.bindFramebuffer(36160,this.handle),n=t.checkFramebufferStatus(36160);return t.bindFramebuffer(36160,e||null),n}clear(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{color:e,depth:n,stencil:i,drawBuffers:r=[]}=t,o=this.gl.bindFramebuffer(36160,this.handle);return(e||n||i)&&(0,a.Z)(this.gl,{color:e,depth:n,stencil:i}),r.forEach(((t,e)=>{(0,a.$)(this.gl,{drawBuffer:e,value:t})})),this.gl.bindFramebuffer(36160,o||null),this}readPixels(){return i.cM.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(){return i.cM.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(){return i.cM.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(){return i.cM.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(){return i.cM.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(){return i.cM.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate(t){let{attachments:e=[],x:n=0,y:r=0,width:o,height:s}=t;const a=(0,i.KQ)(this.gl),l=a.bindFramebuffer(36008,this.handle);return 0===n&&0===r&&void 0===o&&void 0===s?a.invalidateFramebuffer(36008,e):a.invalidateFramebuffer(36008,e,n,r,o,s),a.bindFramebuffer(36008,l),this}getAttachmentParameter(t,e,n){let i=this._getAttachmentParameterFallback(e);return null===i&&(this.gl.bindFramebuffer(36160,this.handle),i=this.gl.getFramebufferAttachmentParameter(36160,t,e),this.gl.bindFramebuffer(36160,null)),n&&i>1e3&&(i=(0,u.km)(this.gl,i)),i}getAttachmentParameters(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:36064,e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.constructor.ATTACHMENT_PARAMETERS||[];const i={};for(const r of n)i[e?(0,u.km)(this.gl,r):r]=this.getAttachmentParameter(t,r,e);return i}getParameters(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const e=Object.keys(this.attachments),n={};for(const i of e){const e=Number(i);n[t?(0,u.km)(this.gl,e):e]=this.getAttachmentParameters(e,t)}return n}show(){return"undefined"!=typeof window&&window.open((0,l.Km)(this),"luma-debug-texture"),this}log(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(t>i.cM.level||"undefined"==typeof window)return this;e=e||"Framebuffer ".concat(this.id);const n=(0,l.Km)(this,{targetMaxHeight:100});return i.cM.image({logLevel:t,message:e,image:n},e)(),this}bind(){let{target:t=36160}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.gl.bindFramebuffer(t,this.handle),this}unbind(){let{target:t=36160}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.gl.bindFramebuffer(t,null),this}_createDefaultAttachments(t,e,n,i,r){let a=null;return t&&(a=a||{},a[36064]=new o.Z(this.gl,{id:"".concat(this.id,"-color0"),pixels:null,format:6408,type:5121,width:i,height:r,mipmaps:!1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.ownResources.push(a[36064])),e&&n?(a=a||{},a[33306]=new s.Z(this.gl,{id:"".concat(this.id,"-depth-stencil"),format:35056,width:i,height:111}),this.ownResources.push(a[33306])):e?(a=a||{},a[36096]=new s.Z(this.gl,{id:"".concat(this.id,"-depth"),format:33189,width:i,height:r}),this.ownResources.push(a[36096])):n&&(0,h.h)(!1),a}_unattach(t){const e=this.attachments[t];e&&(e instanceof s.Z?this.gl.framebufferRenderbuffer(36160,t,36161,null):this.gl.framebufferTexture2D(36160,t,3553,null,0),delete this.attachments[t])}_attachRenderbuffer(t){let{attachment:e=36064,renderbuffer:n}=t;const{gl:i}=this;i.framebufferRenderbuffer(36160,e,36161,n.handle),this.attachments[e]=n}_attachTexture(t){let{attachment:e=36064,texture:n,layer:r,level:o}=t;const{gl:s}=this;switch(s.bindTexture(n.target,n.handle),n.target){case 35866:case 32879:(0,i.KQ)(s).framebufferTextureLayer(36160,e,n.target,o,r);break;case 34067:const t=function(t){return t<34069?t+34069:t}(r);s.framebufferTexture2D(36160,e,t,n.handle,o);break;case 3553:s.framebufferTexture2D(36160,e,3553,n.handle,o);break;default:(0,h.h)(!1,"Illegal texture type")}s.bindTexture(n.target,null),this.attachments[e]=n}_setReadBuffer(t){const e=(0,i.vd)(this.gl);e?e.readBuffer(t):(0,h.h)(36064===t||1029===t,d),this.readBuffer=t}_setDrawBuffers(t){const{gl:e}=this,n=(0,i.KQ)(e);if(n)n.drawBuffers(t);else{const n=e.getExtension("WEBGL_draw_buffers");n?n.drawBuffersWEBGL(t):(0,h.h)(1===t.length&&(36064===t[0]||1029===t[0]),d)}this.drawBuffers=t}_getAttachmentParameterFallback(t){const e=(0,c.N$)(this.gl);switch(t){case 36052:return e.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return e.WEBGL2?null:8;case 33297:return e.WEBGL2?null:5125;case 33296:return e.WEBGL2||e.EXT_sRGB?null:9729;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(t){return this.gl.bindFramebuffer(36160,t)}}f.ATTACHMENT_PARAMETERS=[36049,36048,33296,33298,33299,33300,33301,33302,33303]},7944:(t,e,n)=>{"use strict";n.d(e,{Z:()=>N});var i=n(7577),r=n(5008),o=n(3849),s=n(9450),a=n(9830),l=n(2525);const c={5126:C.bind(null,"uniform1fv",g,1,k),35664:C.bind(null,"uniform2fv",g,2,k),35665:C.bind(null,"uniform3fv",g,3,k),35666:C.bind(null,"uniform4fv",g,4,k),5124:C.bind(null,"uniform1iv",m,1,k),35667:C.bind(null,"uniform2iv",m,2,k),35668:C.bind(null,"uniform3iv",m,3,k),35669:C.bind(null,"uniform4iv",m,4,k),35670:C.bind(null,"uniform1iv",m,1,k),35671:C.bind(null,"uniform2iv",m,2,k),35672:C.bind(null,"uniform3iv",m,3,k),35673:C.bind(null,"uniform4iv",m,4,k),35674:C.bind(null,"uniformMatrix2fv",g,4,E),35675:C.bind(null,"uniformMatrix3fv",g,9,E),35676:C.bind(null,"uniformMatrix4fv",g,16,E),35678:x,35680:x,5125:C.bind(null,"uniform1uiv",_,1,k),36294:C.bind(null,"uniform2uiv",_,2,k),36295:C.bind(null,"uniform3uiv",_,3,k),36296:C.bind(null,"uniform4uiv",_,4,k),35685:C.bind(null,"uniformMatrix2x3fv",g,6,E),35686:C.bind(null,"uniformMatrix2x4fv",g,8,E),35687:C.bind(null,"uniformMatrix3x2fv",g,6,E),35688:C.bind(null,"uniformMatrix3x4fv",g,12,E),35689:C.bind(null,"uniformMatrix4x2fv",g,8,E),35690:C.bind(null,"uniformMatrix4x3fv",g,12,E),35678:x,35680:x,35679:x,35682:x,36289:x,36292:x,36293:x,36298:x,36299:x,36300:x,36303:x,36306:x,36307:x,36308:x,36311:x},u={},h={},d={},f=[0];function p(t,e,n,i){1===e&&"boolean"==typeof t&&(t=t?1:0),Number.isFinite(t)&&(f[0]=t,t=f);const r=t.length;if(r%e&&s.cM.warn("Uniform size should be multiples of ".concat(e),t)(),t instanceof n)return t;let o=i[r];o||(o=new n(r),i[r]=o);for(let e=0;e<r;e++)o[e]=t[e];return o}function g(t,e){return p(t,e,Float32Array,u)}function m(t,e){return p(t,e,Int32Array,h)}function _(t,e){return p(t,e,Uint32Array,d)}function v(t,e,n){const i=c[n.type];if(!i)throw new Error("Unknown GLSL uniform type ".concat(n.type));return i().bind(null,t,e)}function b(t){if("]"!==t[t.length-1])return{name:t,length:1,isArray:!1};const e=t.match(/([^[]*)(\[[0-9]+\])?/);if(!e||e.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(t));return{name:e[1],length:e[2]||1,isArray:Boolean(e[2])}}function y(t){return Array.isArray(t)||ArrayBuffer.isView(t)?function(t){if(0===t.length)return!1;const e=Math.min(t.length,16);for(let n=0;n<e;++n)if(!Number.isFinite(t[n]))return!1;return!0}(t):!!isFinite(t)||!0===t||!1===t||t instanceof r.Z||t instanceof a.Z||t instanceof o.Z&&Boolean(t.texture)}function w(t,e,n){if(Array.isArray(n)||ArrayBuffer.isView(n))if(t[e]){const i=t[e];for(let t=0,e=n.length;t<e;++t)i[t]=n[t]}else t[e]=n.slice();else t[e]=n}function x(){let t=null;return(e,n,i)=>{const r=t!==i;return r&&(e.uniform1i(n,i),t=i),r}}function C(t,e,n,i){let r=null,o=null;return(s,a,c)=>{const u=e(c,n),h=u.length;let d=!1;if(null===r)r=new Float32Array(h),o=h,d=!0;else{(0,l.h)(o===h,"Uniform length cannot change.");for(let t=0;t<h;++t)if(u[t]!==r[t]){d=!0;break}}return d&&(i(s,t,a,u),r.set(u)),d}}function k(t,e,n,i){t[e](n,i)}function E(t,e,n,i){t[e](n,!1,i)}function S(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"unnamed";const n=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/,i=t.match(n);return i?i[1]:e}function A(t,e){let n="";for(let i=0;i<e.length;i++){const r=e[i];if((t[i+3]||t[i+2]||t[i+1])&&(n+="".concat(r,"\n"),t[i+1])){const e=t[i+1],r=e.split(":",3),o=r[0],s=parseInt(r[1],10)||0,a=e.substring(r.join(":").length+1).trim();n+=T("^^^ ".concat(o,": ").concat(a,"\n\n"),s)}}return n}function T(t,e){let n="";for(let t=0;t<e;++t)n+=" ";return"".concat(n).concat(t)}var M=n(8474);class D extends i.Z{get[Symbol.toStringTag](){return"Shader"}static getTypeName(t){switch(t){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return(0,l.h)(!1),"unknown"}}constructor(t,e){(0,s.JD)(t),(0,l.h)("string"==typeof e.source,"Shader: GLSL source code must be a JavaScript string"),super(t,{id:S(e.source,null)||e.id||(0,M.hQ)("unnamed ".concat(D.getTypeName(e.shaderType)))}),this.shaderType=e.shaderType,this.source=e.source,this.initialize(e)}initialize(t){let{source:e}=t;const n=S(e,null);n&&(this.id=(0,M.hQ)(n)),this._compile(e)}getParameter(t){return this.gl.getShaderParameter(this.handle,t)}toString(){return"".concat(D.getTypeName(this.shaderType),":").concat(this.id)}getName(){return S(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const t=this.gl.getExtension("WEBGL_debug_shaders");return t?t.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}_compile(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.source;if(t.startsWith("#version ")||(t="#version 100\n".concat(t)),this.source=t,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle),!this.getParameter(35713)){const t=this.gl.getShaderInfoLog(this.handle),{shaderName:e,errors:n,warnings:i}=function(t,e,n,i){const r=t.split(/\r?\n/),o={},s={},a=i||S(e)||"(unnamed)",l="".concat(function(t){switch(t){case 35632:return"fragment";case 35633:return"vertex";default:return"unknown type"}}(n)," shader ").concat(a);for(let e=0;e<r.length;e++){const n=r[e];if(n.length<=1)continue;const i=n.split(":"),a=i[0],c=parseInt(i[2],10);if(isNaN(c))throw new Error("GLSL compilation error in ".concat(l,": ").concat(t));"WARNING"!==a?o[c]=n:s[c]=n}const c=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:": ";const i=t.split(/\r?\n/),r=String(i.length+e-1).length;return i.map(((t,i)=>{const o=String(i+e),s=o.length;return T(o,r-s)+n+t}))}(e);return{shaderName:l,errors:A(o,c),warnings:A(s,c)}}(t,this.source,this.shaderType,this.id);throw s.cM.error("GLSL compilation errors in ".concat(e,"\n").concat(n))(),s.cM.warn("GLSL compilation warnings in ".concat(e,"\n").concat(i))(),new Error("GLSL compilation errors in ".concat(e))}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(35663),source:this.getSource()}}}class P extends D{get[Symbol.toStringTag](){return"VertexShader"}constructor(t,e){"string"==typeof e&&(e={source:e}),super(t,Object.assign({},e,{shaderType:35633}))}_createHandle(){return this.gl.createShader(35633)}}class L extends D{get[Symbol.toStringTag](){return"FragmentShader"}constructor(t,e){"string"==typeof e&&(e={source:e}),super(t,Object.assign({},e,{shaderType:35632}))}_createHandle(){return this.gl.createShader(35632)}}var R=n(4072),I=n(8522);class O{constructor(t){this.id=t.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(t),this._readVaryingsFromProgram(t)}getAttributeInfo(t){const e=Number(t);return Number.isFinite(e)?this.attributeInfosByLocation[e]:this.attributeInfosByName[t]||null}getAttributeLocation(t){const e=this.getAttributeInfo(t);return e?e.location:-1}getAttributeAccessor(t){const e=this.getAttributeInfo(t);return e?e.accessor:null}getVaryingInfo(t){const e=Number(t);return Number.isFinite(e)?this.varyingInfos[e]:this.varyingInfosByName[t]||null}getVaryingIndex(t){const e=this.getVaryingInfo();return e?e.location:-1}getVaryingAccessor(t){const e=this.getVaryingInfo();return e?e.accessor:null}_readAttributesFromProgram(t){const{gl:e}=t,n=e.getProgramParameter(t.handle,35721);for(let i=0;i<n;i++){const{name:n,type:r,size:o}=e.getActiveAttrib(t.handle,i),s=e.getAttribLocation(t.handle,n);s>=0&&this._addAttribute(s,n,r,o)}this.attributeInfos.sort(((t,e)=>t.location-e.location))}_readVaryingsFromProgram(t){const{gl:e}=t;if(!(0,s.D0)(e))return;const n=e.getProgramParameter(t.handle,35971);for(let i=0;i<n;i++){const{name:n,type:r,size:o}=e.getTransformFeedbackVarying(t.handle,i);this._addVarying(i,n,r,o)}this.varyingInfos.sort(((t,e)=>t.location-e.location))}_addAttribute(t,e,n,i){const{type:r,components:o}=(0,I.hJ)(n),s={type:r,size:i*o};this._inferProperties(t,e,s);const a={location:t,name:e,accessor:new R.Z(s)};this.attributeInfos.push(a),this.attributeInfosByLocation[t]=a,this.attributeInfosByName[a.name]=a}_inferProperties(t,e,n){/instance/i.test(e)&&(n.divisor=1)}_addVarying(t,e,n,i){const{type:r,components:o}=(0,I.hJ)(n),s={location:t,name:e,accessor:new R.Z({type:r,size:i*o})};this.varyingInfos.push(s),this.varyingInfosByName[s.name]=s}}var z=n(9579);const F=35981,B=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];class N extends i.Z{get[Symbol.toStringTag](){return"Program"}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(t,e),this.stubRemovedMethods("Program","v6.0",B),this._isCached=!1,this.initialize(e),Object.seal(this),this._setId(e.id)}initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{hash:e,vs:n,fs:i,varyings:r,bufferMode:o=F}=t;return this.hash=e||"",this.vs="string"==typeof n?new P(this.gl,{id:"".concat(t.id,"-vs"),source:n}):n,this.fs="string"==typeof i?new L(this.gl,{id:"".concat(t.id,"-fs"),source:i}):i,(0,l.h)(this.vs instanceof P),(0,l.h)(this.fs instanceof L),this.uniforms={},this._textureUniforms={},r&&r.length>0&&((0,s.KQ)(this.gl),this.varyings=r,this.gl2.transformFeedbackVaryings(this.handle,r,o)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new O(this),this.setProps(t)}delete(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._isCached?this:super.delete(t)}setProps(t){return"uniforms"in t&&this.setUniforms(t.uniforms),this}draw(t){let{logPriority:e,drawMode:n=4,vertexCount:i,offset:r=0,start:o,end:a,isIndexed:c=!1,indexType:u=5123,instanceCount:h=0,isInstanced:d=h>0,vertexArray:f=null,transformFeedback:p,framebuffer:g,parameters:m={},uniforms:_,samplers:v}=t;if((_||v)&&(s.cM.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(_||{})),s.cM.priority>=e){const t=g?g.id:"default",r="mode=".concat((0,z.km)(this.gl,n)," verts=").concat(i," ")+"instances=".concat(h," indexType=").concat((0,z.km)(this.gl,u)," ")+"isInstanced=".concat(d," isIndexed=").concat(c," ")+"Framebuffer=".concat(t);s.cM.log(e,r)()}return(0,l.h)(f),this.gl.useProgram(this.handle),!(!this._areTexturesRenderable()||0===i||d&&0===h||(f.bindForDraw(i,h,(()=>{if(void 0!==g&&(m=Object.assign({},m,{framebuffer:g})),p){const t=(0,I.$Z)(n);p.begin(t)}this._bindTextures(),(0,s.s8)(this.gl,m,(()=>{c&&d?this.gl2.drawElementsInstanced(n,i,u,r,h):c&&(0,s.D0)(this.gl)&&!isNaN(o)&&!isNaN(a)?this.gl2.drawRangeElements(n,o,a,i,u,r):c?this.gl.drawElements(n,i,u,r):d?this.gl2.drawArraysInstanced(n,r,i,h):this.gl.drawArrays(n,r,i)})),p&&p.end()})),0))}setUniforms(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};s.cM.priority>=2&&function(t,e,n){for(const i in t){const r=t[i];if((!n||Boolean(n[i]))&&!y(r))throw e=e?"".concat(e," "):"",console.error("".concat(e," Bad uniform ").concat(i),r),new Error("".concat(e," Bad uniform ").concat(i))}}(t,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(const e in t){const n=t[e],i=this._uniformSetters[e];if(i){let t=n,s=!1;if(t instanceof o.Z&&(t=t.texture),t instanceof r.Z)if(s=this.uniforms[e]!==n,s){void 0===i.textureIndex&&(i.textureIndex=this._textureIndexCounter++);const n=t,{textureIndex:r}=i;n.bind(r),t=r,this._textureUniforms[e]=n}else t=i.textureIndex;else this._textureUniforms[e]&&delete this._textureUniforms[e];(i(t)||s)&&w(this.uniforms,e,n)}}return this}_areTexturesRenderable(){let t=!0;for(const e in this._textureUniforms){const n=this._textureUniforms[e];n.update(),t=t&&n.loaded}return t}_bindTextures(){for(const t in this._textureUniforms){const e=this._uniformSetters[t].textureIndex;this._textureUniforms[t].bind(e)}}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(t){const e=this.gl.getAttachedShaders(t),n={};for(const t of e)switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:n.vs=new P({handle:t});break;case 35632:n.fs=new L({handle:t})}return n}_getParameter(t){return this.gl.getProgramParameter(this.handle,t)}_setId(t){if(!t){const t=this._getName();this.id=(0,M.hQ)(t)}}_getName(){let t=this.vs.getName()||this.fs.getName();return t=t.replace(/shader/i,""),t=t?"".concat(t,"-program"):"program",t}_compileAndLink(){const{gl:t}=this;if(t.attachShader(this.handle,this.vs.handle),t.attachShader(this.handle,this.fs.handle),s.cM.time(4,"linkProgram for ".concat(this._getName()))(),t.linkProgram(this.handle),s.cM.timeEnd(4,"linkProgram for ".concat(this._getName()))(),t.debug||s.cM.level>0){if(!t.getProgramParameter(this.handle,35714))throw new Error("Error linking: ".concat(t.getProgramInfoLog(this.handle)));if(t.validateProgram(this.handle),!t.getProgramParameter(this.handle,35715))throw new Error("Error validating: ".concat(t.getProgramInfoLog(this.handle)))}}_readUniformLocationsFromLinkedProgram(){const{gl:t}=this;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(let e=0;e<this._uniformCount;e++){const n=this.gl.getActiveUniform(this.handle,e),{name:i}=b(n.name);let r=t.getUniformLocation(this.handle,i);if(this._uniformSetters[i]=v(t,r,n),n.size>1)for(let e=0;e<n.size;e++)r=t.getUniformLocation(this.handle,"".concat(i,"[").concat(e,"]")),this._uniformSetters["".concat(i,"[").concat(e,"]")]=v(t,r,n)}this._textureIndexCounter=0}getActiveUniforms(t,e){return this.gl2.getActiveUniforms(this.handle,t,e)}getUniformBlockIndex(t){return this.gl2.getUniformBlockIndex(this.handle,t)}getActiveUniformBlockParameter(t,e){return this.gl2.getActiveUniformBlockParameter(this.handle,t,e)}uniformBlockBinding(t,e){this.gl2.uniformBlockBinding(this.handle,t,e)}}},9830:(t,e,n)=>{"use strict";n.d(e,{Z:()=>l});var i=n(7577);const r="EXT_color_buffer_float",o={33189:{bpp:2},33190:{gl2:!0,bpp:3},36012:{gl2:!0,bpp:4},36168:{bpp:1},34041:{bpp:4},35056:{gl2:!0,bpp:4},36013:{gl2:!0,bpp:5},32854:{bpp:2},36194:{bpp:2},32855:{bpp:2},33321:{gl2:!0,bpp:1},33330:{gl2:!0,bpp:1},33329:{gl2:!0,bpp:1},33332:{gl2:!0,bpp:2},33331:{gl2:!0,bpp:2},33334:{gl2:!0,bpp:4},33333:{gl2:!0,bpp:4},33323:{gl2:!0,bpp:2},33336:{gl2:!0,bpp:2},33335:{gl2:!0,bpp:2},33338:{gl2:!0,bpp:4},33337:{gl2:!0,bpp:4},33340:{gl2:!0,bpp:8},33339:{gl2:!0,bpp:8},32849:{gl2:!0,bpp:3},32856:{gl2:!0,bpp:4},32857:{gl2:!0,bpp:4},36220:{gl2:!0,bpp:4},36238:{gl2:!0,bpp:4},36975:{gl2:!0,bpp:4},36214:{gl2:!0,bpp:8},36232:{gl2:!0,bpp:8},36226:{gl2:!0,bpp:16},36208:{gl2:!0,bpp:16},33325:{gl2:r,bpp:2},33327:{gl2:r,bpp:4},34842:{gl2:r,bpp:8},33326:{gl2:r,bpp:4},33328:{gl2:r,bpp:8},34836:{gl2:r,bpp:16},35898:{gl2:r,bpp:4}};var s=n(9450),a=n(2525);class l extends i.Z{get[Symbol.toStringTag](){return"Renderbuffer"}static isSupported(t){let{format:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{format:null};return!e||function(t,e,n){const i=n[e];if(!i)return!1;const r=(0,s.D0)(t)&&i.gl2||i.gl1;return"string"==typeof r?t.getExtension(r):r}(t,e,o)}static getSamplesForFormat(t,e){let{format:n}=e;return t.getInternalformatParameter(36161,n,32937)}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(t,e),this.initialize(e),Object.seal(this)}initialize(t){let{format:e,width:n=1,height:i=1,samples:r=0}=t;return(0,a.h)(e,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),0!==r&&(0,s.D0)(this.gl)?this.gl.renderbufferStorageMultisample(36161,r,e,n,i):this.gl.renderbufferStorage(36161,e,n,i),this.format=e,this.width=n,this.height=i,this.samples=r,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*o[this.format].bpp),this}resize(t){let{width:e,height:n}=t;return e!==this.width||n!==this.height?this.initialize({width:e,height:n,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}_bindHandle(t){this.gl.bindRenderbuffer(36161,t)}_syncHandle(t){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}_getParameter(t){return this.gl.bindRenderbuffer(36161,this.handle),this.gl.getRenderbufferParameter(36161,t)}}},7577:(t,e,n)=>{"use strict";n.d(e,{Z:()=>u});var i=n(9450),r=n(9835),o=n(9579),s=n(2525),a=n(8474),l=n(7469);const c="Resource subclass must define virtual methods";class u{get[Symbol.toStringTag](){return"Resource"}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,i.JD)(t);const{id:n,userData:r={}}=e;this.gl=t,this.gl2=t,this.id=n||(0,a.hQ)(this[Symbol.toStringTag]),this.userData=r,this._bound=!1,this._handle=e.handle,void 0===this._handle&&(this._handle=this._createHandle()),this.byteLength=0,this._initStats(),this._addStats()}toString(){return"".concat(this[Symbol.toStringTag]||this.constructor.name,"(").concat(this.id,")")}get handle(){return this._handle}delete(){let{deleteChildren:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,e&&t&&e.filter(Boolean).forEach((t=>t.delete())),this}bind(){let t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.handle;return"function"!=typeof e?(this._bindHandle(e),this):(this._bound?t=e():(this._bindHandle(this.handle),this._bound=!0,t=e(),this._bound=!1,this._bindHandle(null)),t)}unbind(){this.bind(null)}getParameter(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t=(0,o.sF)(this.gl,t),(0,s.h)(t);const n=(this.constructor.PARAMETERS||{})[t];if(n){const t=(0,i.D0)(this.gl);if("webgl2"in n&&!t||"extension"in n&&!this.gl.getExtension(n.extension)){const e=n.webgl1,i="webgl2"in n?n.webgl2:n.webgl1;return t?i:e}}return this._getParameter(t,e)}getParameters(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{parameters:e,keys:n}=t,r=this.constructor.PARAMETERS||{},s=(0,i.D0)(this.gl),a={},l=e||Object.keys(r);for(const e of l){const i=r[e];if(i&&(!("webgl2"in i)||s)&&(!("extension"in i)||this.gl.getExtension(i.extension))){const r=n?(0,o.km)(this.gl,e):e;a[r]=this.getParameter(e,t),n&&"GLenum"===i.type&&(a[r]=(0,o.km)(this.gl,a[r]))}}return a}setParameter(t,e){t=(0,o.sF)(this.gl,t),(0,s.h)(t);const n=(this.constructor.PARAMETERS||{})[t];if(n){const t=(0,i.D0)(this.gl);if("webgl2"in n&&!t||"extension"in n&&!this.gl.getExtension(n.extension))throw new Error("Parameter not available on this platform");"GLenum"===n.type&&(e=(0,o.sF)(e))}return this._setParameter(t,e),this}setParameters(t){for(const e in t)this.setParameter(e,t[e]);return this}stubRemovedMethods(t,e,n){return(0,l.F)(this,t,e,n)}initialize(t){}_createHandle(){throw new Error(c)}_deleteHandle(){throw new Error(c)}_bindHandle(t){throw new Error(c)}_getOptsFromHandle(){throw new Error(c)}_getParameter(t,e){throw new Error(c)}_setParameter(t,e){throw new Error(c)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_initStats(){this.gl.stats=this.gl.stats||new r.Zj}_addStats(){const t=this[Symbol.toStringTag],e=r.lR.get("Resource Counts");e.get("Resources Created").incrementCount(),e.get("".concat(t,"s Created")).incrementCount(),e.get("".concat(t,"s Active")).incrementCount()}_removeStats(){const t=this[Symbol.toStringTag];r.lR.get("Resource Counts").get("".concat(t,"s Active")).decrementCount()}_trackAllocatedMemory(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this[Symbol.toStringTag];this._doTrackAllocatedMemory(t,e),this._doTrackAllocatedMemory(t,e,this.gl.stats.get("Memory Usage"))}_doTrackAllocatedMemory(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this[Symbol.toStringTag],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r.lR.get("Memory Usage");n.get("GPU Memory").addCount(t),n.get("".concat(e," Memory")).addCount(t),this.byteLength=t}_trackDeallocatedMemory(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this[Symbol.toStringTag];this._doTrackDeallocatedMemory(t),this._doTrackDeallocatedMemory(t,this.gl.stats.get("Memory Usage"))}_doTrackDeallocatedMemory(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this[Symbol.toStringTag],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.lR.get("Memory Usage");e.get("GPU Memory").subtractCount(this.byteLength),e.get("".concat(t," Memory")).subtractCount(this.byteLength),this.byteLength=0}}},4912:(t,e,n)=>{"use strict";n.d(e,{Z:()=>s});var i=n(9450),r=n(5008),o=n(2525);class s extends r.Z{get[Symbol.toStringTag](){return"Texture2D"}static isSupported(t,e){return r.Z.isSupported(t,e)}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n;(0,i.JD)(t),(e instanceof Promise||"string"==typeof e)&&(e={data:e}),"string"==typeof e.data&&(e=Object.assign({},e,{data:(n=e.data,(0,o.h)("string"==typeof n),n=""+n,new Promise(((t,e)=>{try{const i=new Image;i.onload=()=>t(i),i.onerror=()=>e(new Error("Could not load image ".concat(n,"."))),i.crossOrigin="anonymous",i.src=n}catch(t){e(t)}})))})),super(t,Object.assign({},e,{target:3553})),this.initialize(e),Object.seal(this)}}},1319:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});var i=n(9450),r=n(5008),o=n(3889),s=n(3478);class a extends r.Z{get[Symbol.toStringTag](){return"Texture3D"}static isSupported(t){return(0,i.D0)(t)}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,i.KQ)(t),e=Object.assign({depth:1},e,{target:32879,unpackFlipY:!1}),super(t,e),this.initialize(e),Object.seal(this)}setImageData(t){let{level:e=0,dataFormat:n=6408,width:r,height:a,depth:l=1,border:c=0,format:u,type:h=5121,offset:d=0,data:f,parameters:p={}}=t;if(this._trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle),(0,i.s8)(this.gl,p,(()=>{ArrayBuffer.isView(f)&&this.gl.texImage3D(this.target,e,n,r,a,l,c,u,h,f),f instanceof s.Z&&(this.gl.bindBuffer(35052,f.handle),this.gl.texImage3D(this.target,e,n,r,a,l,c,u,h,d))})),f&&f.byteLength)this._trackAllocatedMemory(f.byteLength,"Texture");else{const t=o.C[this.dataFormat]||4,e=o.pH[this.type]||1;this._trackAllocatedMemory(this.width*this.height*this.depth*t*e,"Texture")}return this.loaded=!0,this}}},3889:(t,e,n)=>{"use strict";n.d(e,{C:()=>o,KR:()=>l,ae:()=>r,br:()=>a,pH:()=>s});var i=n(9450);const r={6407:{dataFormat:6407,types:[5121,33635]},6408:{dataFormat:6408,types:[5121,32819,32820]},6406:{dataFormat:6406,types:[5121]},6409:{dataFormat:6409,types:[5121]},6410:{dataFormat:6410,types:[5121]},33326:{dataFormat:6403,types:[5126],gl2:!0},33328:{dataFormat:33319,types:[5126],gl2:!0},34837:{dataFormat:6407,types:[5126],gl2:!0},34836:{dataFormat:6408,types:[5126],gl2:!0}},o={6403:1,36244:1,33319:2,33320:2,6407:3,36248:3,6408:4,36249:4,6402:1,34041:1,6406:1,6409:1,6410:2},s={5126:4,5125:4,5124:4,5123:2,5122:2,5131:2,5120:1,5121:1};function a(t,e){const n=r[e];if(!n)return!1;if(void 0===n.gl1&&void 0===n.gl2)return!0;const o=(0,i.D0)(t)&&n.gl2||n.gl1;return"string"==typeof o?t.getExtension(o):o}function l(t,e){const n=r[e];switch(n&&n.types[0]){case 5126:return t.getExtension("OES_texture_float_linear");case 5131:return t.getExtension("OES_texture_half_float_linear");default:return!0}}},5008:(t,e,n)=>{"use strict";n.d(e,{Z:()=>h});var i=n(9450),r=n(7577),o=n(3478),s=n(3889),a=n(2525),l=n(8474);const c=[9729,9728],u=globalThis.WebGLBuffer||function(){};class h extends r.Z{get[Symbol.toStringTag](){return"Texture"}static isSupported(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{format:n,linearFiltering:i}=e;let r=!0;return n&&(r=r&&(0,s.br)(t,n),r=r&&(!i||(0,s.KR)(t,n))),r}constructor(t,e){const{id:n=(0,l.hQ)("texture"),handle:i,target:r}=e;super(t,{id:n,handle:i}),this.target=r,this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.depth=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return"Texture(".concat(this.id,",").concat(this.width,"x").concat(this.height,")")}initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.data;if(e instanceof Promise)return e.then((e=>this.initialize(Object.assign({},t,{pixels:e,data:e})))),this;const n="undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement;if(n&&e.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,e.addEventListener("loadeddata",(()=>this.initialize(t))),this;const{pixels:r=null,format:o=6408,border:s=0,recreate:a=!1,parameters:l={},pixelStore:c={},textureUnit:u}=t;e||(e=r);let{width:h,height:d,dataFormat:f,type:p,compressed:g=!1,mipmaps:m=!0}=t;const{depth:_=0}=t;return({width:h,height:d,compressed:g,dataFormat:f,type:p}=this._deduceParameters({format:o,type:p,dataFormat:f,compressed:g,data:e,width:h,height:d})),this.width=h,this.height=d,this.depth=_,this.format=o,this.type=p,this.dataFormat=f,this.border=s,this.textureUnit=u,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),m&&this._isNPOT()&&(i.cM.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),m=!1,this._updateForNPOT(l)),this.mipmaps=m,this.setImageData({data:e,width:h,height:d,depth:_,format:o,type:p,dataFormat:f,border:s,mipmaps:m,parameters:c,compressed:g}),m&&this.generateMipmap(),this.setParameters(l),a&&(this.data=e),n&&(this._video={video:e,parameters:l,lastTime:e.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?e.currentTime:-1}),this}update(){if(this._video){const{video:t,parameters:e,lastTime:n}=this._video;if(n===t.currentTime||t.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:t,parameters:e}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=t.currentTime}}resize(t){let{height:e,width:n,mipmaps:i=!1}=t;return n!==this.width||e!==this.height?this.initialize({width:n,height:e,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:i}):this}generateMipmap(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._isNPOT()?(i.cM.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),(0,i.s8)(this.gl,t,(()=>{this.gl.generateMipmap(this.target)})),this.gl.bindTexture(this.target,null),this)}setImageData(t){this._trackDeallocatedMemory("Texture");const{target:e=this.target,pixels:n=null,level:r=0,format:o=this.format,border:l=this.border,offset:c=0,parameters:u={}}=t;let{data:h=null,type:d=this.type,width:f=this.width,height:p=this.height,dataFormat:g=this.dataFormat,compressed:m=!1}=t;h||(h=n),({type:d,dataFormat:g,compressed:m,width:f,height:p}=this._deduceParameters({format:o,type:d,dataFormat:g,compressed:m,data:h,width:f,height:p}));const{gl:_}=this;_.bindTexture(this.target,this.handle);let v,b=null;({data:h,dataType:b}=this._getDataType({data:h,compressed:m}));let y=0;if((0,i.s8)(this.gl,u,(()=>{switch(b){case"null":_.texImage2D(e,r,o,f,p,l,g,d,h);break;case"typed-array":_.texImage2D(e,r,o,f,p,l,g,d,h,c);break;case"buffer":v=(0,i.KQ)(_),v.bindBuffer(35052,h.handle||h),v.texImage2D(e,r,o,f,p,l,g,d,c),v.bindBuffer(35052,null);break;case"browser-object":(0,i.D0)(_)?_.texImage2D(e,r,o,f,p,l,g,d,h):_.texImage2D(e,r,o,g,d,h);break;case"compressed":for(const[t,n]of h.entries())_.compressedTexImage2D(e,t,n.format,n.width,n.height,l,n.data),y+=n.levelSize;break;default:(0,a.h)(!1,"Unknown image data type")}})),"compressed"===b)this._trackAllocatedMemory(y,"Texture");else if(h&&h.byteLength)this._trackAllocatedMemory(h.byteLength,"Texture");else{const t=s.C[this.dataFormat]||4,e=s.pH[this.type]||1;this._trackAllocatedMemory(this.width*this.height*t*e,"Texture")}return this.loaded=!0,this}setSubImageData(t){let{target:e=this.target,pixels:n=null,data:r=null,x:s=0,y:l=0,width:c=this.width,height:h=this.height,level:d=0,format:f=this.format,type:p=this.type,dataFormat:g=this.dataFormat,compressed:m=!1,offset:_=0,border:v=this.border,parameters:b={}}=t;if(({type:p,dataFormat:g,compressed:m,width:c,height:h}=this._deduceParameters({format:f,type:p,dataFormat:g,compressed:m,data:r,width:c,height:h})),(0,a.h)(0===this.depth,"texSubImage not supported for 3D textures"),r||(r=n),r&&r.data){const t=r;r=t.data,c=t.shape[0],h=t.shape[1]}r instanceof o.Z&&(r=r.handle),this.gl.bindTexture(this.target,this.handle),(0,i.s8)(this.gl,b,(()=>{if(m)this.gl.compressedTexSubImage2D(e,d,s,l,c,h,f,r);else if(null===r)this.gl.texSubImage2D(e,d,s,l,c,h,g,p,null);else if(ArrayBuffer.isView(r))this.gl.texSubImage2D(e,d,s,l,c,h,g,p,r,_);else if(r instanceof u){const t=(0,i.KQ)(this.gl);t.bindBuffer(35052,r),t.texSubImage2D(e,d,s,l,c,h,g,p,_),t.bindBuffer(35052,null)}else(0,i.D0)(this.gl)?(0,i.KQ)(this.gl).texSubImage2D(e,d,s,l,c,h,g,p,r):this.gl.texSubImage2D(e,d,s,l,g,p,r)})),this.gl.bindTexture(this.target,null)}copyFramebuffer(){return i.cM.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.textureUnit;const{gl:e}=this;return void 0!==t&&(this.textureUnit=t,e.activeTexture(33984+t)),e.bindTexture(this.target,this.handle),t}unbind(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.textureUnit;const{gl:e}=this;return void 0!==t&&(this.textureUnit=t,e.activeTexture(33984+t)),e.bindTexture(this.target,null),t}_getDataType(t){let{data:e,compressed:n=!1}=t;return n?{data:e,dataType:"compressed"}:null===e?{data:e,dataType:"null"}:ArrayBuffer.isView(e)?{data:e,dataType:"typed-array"}:e instanceof o.Z?{data:e.handle,dataType:"buffer"}:e instanceof u?{data:e,dataType:"buffer"}:{data:e,dataType:"browser-object"}}_deduceParameters(t){const{format:e,data:n}=t;let{width:i,height:r,dataFormat:o,type:a,compressed:l}=t;const c=s.ae[e];return o=o||c&&c.dataFormat,a=a||c&&c.types[0],l=l||c&&c.compressed,({width:i,height:r}=this._deduceImageSize(n,i,r)),{dataFormat:o,type:a,compressed:l,width:i,height:r,format:e,data:n}}_deduceImageSize(t,e,n){let i;return i="undefined"!=typeof ImageData&&t instanceof ImageData?{width:t.width,height:t.height}:"undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement?{width:t.naturalWidth,height:t.naturalHeight}:"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap?{width:t.width,height:t.height}:"undefined"!=typeof HTMLVideoElement&&t instanceof HTMLVideoElement?{width:t.videoWidth,height:t.videoHeight}:t?{width:e,height:n}:{width:e>=0?e:1,height:n>=0?n:1},(0,a.h)(i,"Could not deduced texture size"),(0,a.h)(void 0===e||i.width===e,"Deduced texture width does not match supplied width"),(0,a.h)(void 0===n||i.height===n,"Deduced texture height does not match supplied height"),i}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}_getParameter(t){switch(t){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);const e=this.gl.getTexParameter(this.target,t);return this.gl.bindTexture(this.target,null),e}}_setParameter(t,e){switch(this.gl.bindTexture(this.target,this.handle),e=this._getNPOTParam(t,e),t){case 33082:case 33083:this.gl.texParameterf(this.handle,t,e);break;case 4096:case 4097:(0,a.h)(!1);break;default:this.gl.texParameteri(this.target,t,e)}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return!((0,i.D0)(this.gl)||!this.width||!this.height||(0,l.wt)(this.width)&&(0,l.wt)(this.height))}_updateForNPOT(t){void 0===t[this.gl.TEXTURE_MIN_FILTER]&&(t[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),void 0===t[this.gl.TEXTURE_WRAP_S]&&(t[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),void 0===t[this.gl.TEXTURE_WRAP_T]&&(t[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(t,e){if(this._isNPOT())switch(t){case 10241:-1===c.indexOf(e)&&(e=9729);break;case 10242:case 10243:33071!==e&&(e=33071)}return e}}},1053:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});var i=n(9450),r=n(7577),o=n(3478),s=n(8474);class a extends r.Z{get[Symbol.toStringTag](){return"TransformFeedback"}static isSupported(t){return(0,i.D0)(t)}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,i.KQ)(t),super(t,e),this.initialize(e),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,(0,s.nK)(this.buffers)||this.bind((()=>this._unbindBuffers())),this.setProps(t),this}setProps(t){"program"in t&&(this.configuration=t.program&&t.program.configuration),"configuration"in t&&(this.configuration=t.configuration),"bindOnUse"in t&&(t=t.bindOnUse),"buffers"in t&&this.setBuffers(t.buffers)}setBuffers(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.bind((()=>{for(const e in t)this.setBuffer(e,t[e])})),this}setBuffer(t,e){const n=this._getVaryingIndex(t),{buffer:r,byteSize:o,byteOffset:s}=this._getBufferParams(e);return n<0?(this.unused[t]=r,i.cM.warn("".concat(this.id," unused varying buffer ").concat(t))(),this):(this.buffers[n]=e,this.bindOnUse||this._bindBuffer(n,r,s,o),this)}begin(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(t),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}_getBufferParams(t){let e,n,i;return t instanceof o.Z==0?(i=t.buffer,n=t.byteSize,e=t.byteOffset):i=t,void 0===e&&void 0===n||(e=e||0,n=n||i.byteLength-e),{buffer:i,byteOffset:e,byteSize:n}}_getVaryingInfo(t){return this.configuration&&this.configuration.getVaryingInfo(t)}_getVaryingIndex(t){if(this.configuration)return this.configuration.getVaryingInfo(t).location;const e=Number(t);return Number.isFinite(e)?e:-1}_bindBuffers(){if(this.bindOnUse)for(const t in this.buffers){const{buffer:e,byteSize:n,byteOffset:i}=this._getBufferParams(this.buffers[t]);this._bindBuffer(t,e,i,n)}}_unbindBuffers(){if(this.bindOnUse)for(const t in this.buffers)this._bindBuffer(t,null)}_bindBuffer(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0;const r=e&&e.handle;return r&&void 0!==i?this.gl.bindBufferRange(35982,t,r,n,i):this.gl.bindBufferBase(35982,t,r),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(t){this.gl.bindTransformFeedback(36386,this.handle)}}},8271:(t,e,n)=>{"use strict";n.d(e,{N$:()=>l,U6:()=>s,ag:()=>a});var i=n(6948),r=n(9450),o=n(2525);function s(t,e){return a(t,e)}function a(t,e){return(e=Array.isArray(e)?e:[e]).every((e=>c(t,e)))}function l(t){t.luma=t.luma||{},t.luma.caps=t.luma.caps||{};for(const e in i.Z)void 0===t.luma.caps[e]&&(t.luma.caps[e]=c(t,e));return t.luma.caps}function c(t,e){return t.luma=t.luma||{},t.luma.caps=t.luma.caps||{},void 0===t.luma.caps[e]&&(t.luma.caps[e]=function(t,e){const n=i.Z[e];let s;(0,o.h)(n,e);const a=(0,r.D0)(t)&&n[1]||n[0];if("function"==typeof a)s=a(t);else if(Array.isArray(a)){s=!0;for(const e of a)s=s&&Boolean(t.getExtension(e))}else"string"==typeof a?s=Boolean(t.getExtension(a)):"boolean"==typeof a?s=a:(0,o.h)(!1);return s}(t,e)),t.luma.caps[e]||r.cM.log(2,"Feature: ".concat(e," not supported"))(),t.luma.caps[e]}},6948:(t,e,n)=>{"use strict";n.d(e,{Z:()=>s,h:()=>o});var i=n(3849),r=n(4912);const o={WEBGL2:"WEBGL2",VERTEX_ARRAY_OBJECT:"VERTEX_ARRAY_OBJECT",TIMER_QUERY:"TIMER_QUERY",INSTANCED_RENDERING:"INSTANCED_RENDERING",MULTIPLE_RENDER_TARGETS:"MULTIPLE_RENDER_TARGETS",ELEMENT_INDEX_UINT32:"ELEMENT_INDEX_UINT32",BLEND_EQUATION_MINMAX:"BLEND_EQUATION_MINMAX",FLOAT_BLEND:"FLOAT_BLEND",COLOR_ENCODING_SRGB:"COLOR_ENCODING_SRGB",TEXTURE_DEPTH:"TEXTURE_DEPTH",TEXTURE_FLOAT:"TEXTURE_FLOAT",TEXTURE_HALF_FLOAT:"TEXTURE_HALF_FLOAT",TEXTURE_FILTER_LINEAR_FLOAT:"TEXTURE_FILTER_LINEAR_FLOAT",TEXTURE_FILTER_LINEAR_HALF_FLOAT:"TEXTURE_FILTER_LINEAR_HALF_FLOAT",TEXTURE_FILTER_ANISOTROPIC:"TEXTURE_FILTER_ANISOTROPIC",COLOR_ATTACHMENT_RGBA32F:"COLOR_ATTACHMENT_RGBA32F",COLOR_ATTACHMENT_FLOAT:"COLOR_ATTACHMENT_FLOAT",COLOR_ATTACHMENT_HALF_FLOAT:"COLOR_ATTACHMENT_HALF_FLOAT",GLSL_FRAG_DATA:"GLSL_FRAG_DATA",GLSL_FRAG_DEPTH:"GLSL_FRAG_DEPTH",GLSL_DERIVATIVES:"GLSL_DERIVATIVES",GLSL_TEXTURE_LOD:"GLSL_TEXTURE_LOD"},s={[o.WEBGL2]:[!1,!0],[o.VERTEX_ARRAY_OBJECT]:["OES_vertex_array_object",!0],[o.TIMER_QUERY]:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],[o.INSTANCED_RENDERING]:["ANGLE_instanced_arrays",!0],[o.MULTIPLE_RENDER_TARGETS]:["WEBGL_draw_buffers",!0],[o.ELEMENT_INDEX_UINT32]:["OES_element_index_uint",!0],[o.BLEND_EQUATION_MINMAX]:["EXT_blend_minmax",!0],[o.FLOAT_BLEND]:["EXT_float_blend"],[o.COLOR_ENCODING_SRGB]:["EXT_sRGB",!0],[o.TEXTURE_DEPTH]:["WEBGL_depth_texture",!0],[o.TEXTURE_FLOAT]:["OES_texture_float",!0],[o.TEXTURE_HALF_FLOAT]:["OES_texture_half_float",!0],[o.TEXTURE_FILTER_LINEAR_FLOAT]:["OES_texture_float_linear"],[o.TEXTURE_FILTER_LINEAR_HALF_FLOAT]:["OES_texture_half_float_linear"],[o.TEXTURE_FILTER_ANISOTROPIC]:["EXT_texture_filter_anisotropic"],[o.COLOR_ATTACHMENT_RGBA32F]:[function(t){const e=new r.Z(t,{format:6408,type:5126,dataFormat:6408}),n=new i.Z(t,{id:"test-framebuffer",check:!1,attachments:{36064:e}}),o=n.getStatus();return e.delete(),n.delete(),36053===o},"EXT_color_buffer_float"],[o.COLOR_ATTACHMENT_FLOAT]:[!1,"EXT_color_buffer_float"],[o.COLOR_ATTACHMENT_HALF_FLOAT]:["EXT_color_buffer_half_float"],[o.GLSL_FRAG_DATA]:["WEBGL_draw_buffers",!0],[o.GLSL_FRAG_DEPTH]:["EXT_frag_depth",!0],[o.GLSL_DERIVATIVES]:["OES_standard_derivatives",!0],[o.GLSL_TEXTURE_LOD]:["EXT_shader_texture_lod",!0]}},9835:(t,e,n)=>{"use strict";n.d(e,{Zj:()=>a,lR:()=>l});var i=n(9450),r=n(8295),o=n(3370);const s="8.5.16";class a{constructor(){this.stats=new Map}get(t){return this.stats.has(t)||this.stats.set(t,new r.Z({id:t})),this.stats.get(t)}}const l=new a;if(globalThis.luma&&globalThis.luma.VERSION!==s)throw new Error("luma.gl - multiple VERSIONs detected: ".concat(globalThis.luma.VERSION," vs ").concat(s));globalThis.luma||((0,o.Z)()&&i.cM.log(1,"luma.gl ".concat(s," - ").concat("set luma.log.level=1 (or higher) to trace rendering"))(),globalThis.luma=globalThis.luma||{VERSION:s,version:s,log:i.cM,stats:l,globals:{modules:{},nodeIO:{}}}),globalThis.luma},2525:(t,e,n)=>{"use strict";function i(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}n.d(e,{h:()=>i})},2610:(t,e,n)=>{"use strict";n.d(e,{k:()=>r});var i=n(9450);function r(t,e,n){const{removedProps:r={},deprecatedProps:o={},replacedProps:s={}}=n;for(const n in r)if(n in e){const e=r[n]?"".concat(t,".").concat(r[n]):"N/A";i.cM.removed("".concat(t,".").concat(n),e)()}for(const n in o)if(n in e){const e=o[n];i.cM.deprecated("".concat(t,".").concat(n),"".concat(t,".").concat(e))()}let a=null;for(const n in s)if(n in e){const r=s[n];i.cM.deprecated("".concat(t,".").concat(n),"".concat(t,".").concat(r))(),a=a||Object.assign({},e),a[r]=e[n],delete a[n]}return a||e}},7469:(t,e,n)=>{"use strict";n.d(e,{F:()=>r});var i=n(9450);function r(t,e,n,r){const o="See luma.gl ".concat(n," Upgrade Guide at https://luma.gl/docs/upgrade-guide"),s=Object.getPrototypeOf(t);r.forEach((t=>{s.methodName||(s[t]=()=>{throw i.cM.removed("Calling removed method ".concat(e,".").concat(t,": "),o)(),new Error(t)})}))}},8474:(t,e,n)=>{"use strict";n.d(e,{hQ:()=>o,nK:()=>a,wt:()=>s});var i=n(2525);const r={};function o(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"id";r[t]=r[t]||1;const e=r[t]++;return"".concat(t,"-").concat(e)}function s(t){return(0,i.h)("number"==typeof t,"Input must be a number"),t&&0==(t&t-1)}function a(t){let e=!0;for(const n in t){e=!1;break}return e}},8522:(t,e,n)=>{"use strict";n.d(e,{$Z:()=>l,hJ:()=>c,jG:()=>u});var i=n(2525);const r=5126,o=5124,s=5125,a={[r]:[r,1,"float"],35664:[r,2,"vec2"],35665:[r,3,"vec3"],35666:[r,4,"vec4"],[o]:[o,1,"int"],35667:[o,2,"ivec2"],35668:[o,3,"ivec3"],35669:[o,4,"ivec4"],[s]:[s,1,"uint"],36294:[s,2,"uvec2"],36295:[s,3,"uvec3"],36296:[s,4,"uvec4"],35670:[r,1,"bool"],35671:[r,2,"bvec2"],35672:[r,3,"bvec3"],35673:[r,4,"bvec4"],35674:[r,8,"mat2"],35685:[r,8,"mat2x3"],35686:[r,8,"mat2x4"],35675:[r,12,"mat3"],35687:[r,12,"mat3x2"],35688:[r,12,"mat3x4"],35676:[r,16,"mat4"],35689:[r,16,"mat4x2"],35690:[r,16,"mat4x3"]};function l(t){switch(t){case 0:return 0;case 1:case 3:case 2:return 1;case 4:case 5:case 6:return 4;default:return(0,i.h)(!1),0}}function c(t){const e=a[t];if(!e)return null;const[n,i]=e;return{type:n,components:i}}function u(t,e){switch(t){case 5120:case 5121:case 5122:case 5123:t=r}for(const n in a){const[i,r,o]=a[n];if(i===t&&r===e)return{glType:n,name:o}}return null}},9579:(t,e,n)=>{"use strict";n.d(e,{km:()=>o,sF:()=>r});var i=n(2525);function r(t,e){if("string"!=typeof e)return e;const n=Number(e);if(!isNaN(n))return n;const r=t[e=e.replace(/^.*\./,"")];return(0,i.h)(void 0!==r,"Accessing undefined constant GL.".concat(e)),r}function o(t,e){e=Number(e);for(const n in t)if(t[n]===e)return"GL.".concat(n);return String(e)}},3028:(t,e,n)=>{"use strict";n.d(e,{h:()=>h,Y:()=>d});var i=n(4912),r=n(9450),o=n(5008);const s=[34069,34070,34071,34072,34073,34074];class a extends o.Z{get[Symbol.toStringTag](){return"TextureCube"}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,r.JD)(t),super(t,Object.assign({},e,{target:34067})),this.initialize(e),Object.seal(this)}initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{mipmaps:e=!0,parameters:n={}}=t;return this.opts=t,this.setCubeMapImageData(t).then((()=>{this.loaded=!0,e&&this.generateMipmap(t),this.setParameters(n)})),this}subImage(t){let{face:e,data:n,x:i=0,y:r=0,mipmapLevel:o=0}=t;return this._subImage({target:e,data:n,x:i,y:r,mipmapLevel:o})}async setCubeMapImageData(t){let{width:e,height:n,pixels:i,data:o,border:a=0,format:l=6408,type:c=5121}=t;const{gl:u}=this,h=i||o,d=await Promise.all(s.map((t=>{const e=h[t];return Promise.all(Array.isArray(e)?e:[e])})));this.bind(),s.forEach(((t,i)=>{d[i].length>1&&!1!==this.opts.mipmaps&&r.cM.warn("".concat(this.id," has mipmap and multiple LODs."))(),d[i].forEach(((i,r)=>{e&&n?u.texImage2D(t,r,l,e,n,a,l,c,i):u.texImage2D(t,r,l,l,c,i)}))})),this.unbind()}setImageDataForFace(t){const{face:e,width:n,height:i,pixels:r,data:o,border:s=0,format:a=6408,type:l=5121}=t,{gl:c}=this,u=r||o;return this.bind(),u instanceof Promise?u.then((n=>this.setImageDataForFace(Object.assign({},t,{face:e,data:n,pixels:n})))):this.width||this.height?c.texImage2D(e,0,a,n,i,s,a,l,u):c.texImage2D(e,0,a,a,l,u),this}}a.FACES=s;var l=n(1319),c=n(3849),u=n(2525);function h(t,e){(0,u.h)(t instanceof i.Z||t instanceof a||t instanceof l.Z);const n=t.constructor,{gl:r,width:o,height:s,format:c,type:h,dataFormat:d,border:f,mipmaps:p}=t;return new n(r,Object.assign({width:o,height:s,format:c,type:h,dataFormat:d,border:f,mipmaps:p},e))}function d(t,e){const{gl:n,width:i,height:r,id:o}=t;return new c.Z(n,Object.assign({},e,{id:"framebuffer-for-".concat(o),width:i,height:r,attachments:{36064:t}}))}},9335:(t,e,n)=>{"use strict";function i(t){switch(ArrayBuffer.isView(t)?t.constructor:t){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error("Failed to deduce GL constant from typed array")}}function r(t){let{clamped:e=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return e?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function o(t){let{data:e,width:n,height:i,bytesPerPixel:r=4,temp:o}=t;const s=n*r;o=o||new Uint8Array(s);for(let t=0;t<i/2;++t){const n=t*s,r=(i-t-1)*s;o.set(e.subarray(n,n+s)),e.copyWithin(n,r,r+s),e.set(o,r)}}function s(t){let{data:e,width:n,height:i}=t;const r=Math.round(n/2),o=Math.round(i/2),s=new Uint8Array(r*o*4);for(let t=0;t<o;t++)for(let i=0;i<r;i++)for(let o=0;o<4;o++)s[4*(t*r+i)+o]=e[4*(2*t*n+2*i)+o];return{data:s,width:r,height:o}}n.d(e,{KS:()=>s,O:()=>i,c$:()=>o,vN:()=>r})},6357:(t,e,n)=>{"use strict";n.d(e,{Z:()=>r});var i=n(4034);class r extends(function(t){function e(){var e=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(e,Object.getPrototypeOf(this)),e}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}(Array)){clone(){return(new this.constructor).copy(this)}fromArray(t,e=0){for(let n=0;n<this.ELEMENTS;++n)this[n]=t[n+e];return this.check()}toArray(t=[],e=0){for(let n=0;n<this.ELEMENTS;++n)t[e+n]=this[n];return t}from(t){return Array.isArray(t)?this.copy(t):this.fromObject(t)}to(t){return t===this?this:(0,i.kJ)(t)?this.toArray(t):this.toObject(t)}toTarget(t){return t?this.to(t):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(i.vc)}formatString(t){let e="";for(let n=0;n<this.ELEMENTS;++n)e+=(n>0?", ":"")+(0,i.Bw)(this[n],t);return"".concat(t.printTypes?this.constructor.name:"","[").concat(e,"]")}equals(t){if(!t||this.length!==t.length)return!1;for(let e=0;e<this.ELEMENTS;++e)if(!(0,i.fS)(this[e],t[e]))return!1;return!0}exactEquals(t){if(!t||this.length!==t.length)return!1;for(let e=0;e<this.ELEMENTS;++e)if(this[e]!==t[e])return!1;return!0}negate(){for(let t=0;t<this.ELEMENTS;++t)this[t]=-this[t];return this.check()}lerp(t,e,n){if(void 0===n)return this.lerp(this,t,e);for(let i=0;i<this.ELEMENTS;++i){const r=t[i];this[i]=r+n*(e[i]-r)}return this.check()}min(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=Math.min(t[e],this[e]);return this.check()}max(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=Math.max(t[e],this[e]);return this.check()}clamp(t,e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t[n]),e[n]);return this.check()}add(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]+=e[t];return this.check()}subtract(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]-=e[t];return this.check()}scale(t){if("number"==typeof t)for(let e=0;e<this.ELEMENTS;++e)this[e]*=t;else for(let e=0;e<this.ELEMENTS&&e<t.length;++e)this[e]*=t[e];return this.check()}multiplyByScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}check(){if(i.vc.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let t=this.length===this.ELEMENTS;for(let e=0;e<this.ELEMENTS;++e)t=t&&Number.isFinite(this[e]);return t}sub(t){return this.subtract(t)}setScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=t;return this.check()}addScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]+=t;return this.check()}subScalar(t){return this.addScalar(-t)}multiplyScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}divideScalar(t){return this.multiplyByScalar(1/t)}clampScalar(t,e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t),e);return this.check()}get elements(){return this}}},1e3:(t,e,n)=>{"use strict";n.d(e,{Z:()=>s});var i=n(6357),r=n(6281),o=n(4034);class s extends i.Z{toString(){let t="[";if(o.vc.printRowMajor){t+="row-major:";for(let e=0;e<this.RANK;++e)for(let n=0;n<this.RANK;++n)t+=" ".concat(this[n*this.RANK+e])}else{t+="column-major:";for(let e=0;e<this.ELEMENTS;++e)t+=" ".concat(this[e])}return t+="]",t}getElementIndex(t,e){return e*this.RANK+t}getElement(t,e){return this[e*this.RANK+t]}setElement(t,e,n){return this[e*this.RANK+t]=(0,r.u5)(n),this}getColumn(t,e=new Array(this.RANK).fill(-0)){const n=t*this.RANK;for(let t=0;t<this.RANK;++t)e[t]=this[n+t];return e}setColumn(t,e){const n=t*this.RANK;for(let t=0;t<this.RANK;++t)this[n+t]=e[t];return this}}},9521:(t,e,n)=>{"use strict";n.d(e,{Z:()=>s});var i=n(6357),r=n(6281),o=n(394);class s extends i.Z{get x(){return this[0]}set x(t){this[0]=(0,r.u5)(t)}get y(){return this[1]}set y(t){this[1]=(0,r.u5)(t)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let t=0;for(let e=0;e<this.ELEMENTS;++e)t+=this[e]*this[e];return t}magnitudeSquared(){return this.lengthSquared()}distance(t){return Math.sqrt(this.distanceSquared(t))}distanceSquared(t){let e=0;for(let n=0;n<this.ELEMENTS;++n){const i=this[n]-t[n];e+=i*i}return(0,r.u5)(e)}dot(t){let e=0;for(let n=0;n<this.ELEMENTS;++n)e+=this[n]*t[n];return(0,r.u5)(e)}normalize(){const t=this.magnitude();if(0!==t)for(let e=0;e<this.ELEMENTS;++e)this[e]/=t;return this.check()}multiply(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]*=e[t];return this.check()}divide(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]/=e[t];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(t){return this.distance(t)}distanceToSquared(t){return this.distanceSquared(t)}getComponent(t){return(0,o.Z)(t>=0&&t<this.ELEMENTS,"index is out of range"),(0,r.u5)(this[t])}setComponent(t,e){return(0,o.Z)(t>=0&&t<this.ELEMENTS,"index is out of range"),this[t]=e,this.check()}addVectors(t,e){return this.copy(t).add(e)}subVectors(t,e){return this.copy(t).subtract(e)}multiplyVectors(t,e){return this.copy(t).multiply(e)}addScaledVector(t,e){return this.add(new this.constructor(t).multiplyScalar(e))}}},5451:(t,e,n)=>{"use strict";n.d(e,{Z:()=>m});var i,r=n(1e3),o=n(6281),s=n(3858),a=n(5975),l=n(1437),c=n(7160),u=n(8333);!function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL0ROW3=3]="COL0ROW3",t[t.COL1ROW0=4]="COL1ROW0",t[t.COL1ROW1=5]="COL1ROW1",t[t.COL1ROW2=6]="COL1ROW2",t[t.COL1ROW3=7]="COL1ROW3",t[t.COL2ROW0=8]="COL2ROW0",t[t.COL2ROW1=9]="COL2ROW1",t[t.COL2ROW2=10]="COL2ROW2",t[t.COL2ROW3=11]="COL2ROW3",t[t.COL3ROW0=12]="COL3ROW0",t[t.COL3ROW1=13]="COL3ROW1",t[t.COL3ROW2=14]="COL3ROW2",t[t.COL3ROW3=15]="COL3ROW3"}(i||(i={}));const h=45*Math.PI/180,d=1,f=.1,p=500,g=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class m extends r.Z{static get IDENTITY(){return v||(v=new m,Object.freeze(v)),v}static get ZERO(){return _||(_=new m([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(_)),_}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return i}constructor(t){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(t)?this.copy(t):this.identity()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this[9]=t[9],this[10]=t[10],this[11]=t[11],this[12]=t[12],this[13]=t[13],this[14]=t[14],this[15]=t[15],this.check()}set(t,e,n,i,r,o,s,a,l,c,u,h,d,f,p,g){return this[0]=t,this[1]=e,this[2]=n,this[3]=i,this[4]=r,this[5]=o,this[6]=s,this[7]=a,this[8]=l,this[9]=c,this[10]=u,this[11]=h,this[12]=d,this[13]=f,this[14]=p,this[15]=g,this.check()}setRowMajor(t,e,n,i,r,o,s,a,l,c,u,h,d,f,p,g){return this[0]=t,this[1]=r,this[2]=l,this[3]=d,this[4]=e,this[5]=o,this[6]=c,this[7]=f,this[8]=n,this[9]=s,this[10]=u,this[11]=p,this[12]=i,this[13]=a,this[14]=h,this[15]=g,this.check()}toRowMajor(t){return t[0]=this[0],t[1]=this[4],t[2]=this[8],t[3]=this[12],t[4]=this[1],t[5]=this[5],t[6]=this[9],t[7]=this[13],t[8]=this[2],t[9]=this[6],t[10]=this[10],t[11]=this[14],t[12]=this[3],t[13]=this[7],t[14]=this[11],t[15]=this[15],t}identity(){return this.copy(g)}fromObject(t){return this.check()}fromQuaternion(t){return a.en(this,t),this.check()}frustum(t){const{left:e,right:n,bottom:i,top:r,near:o=f,far:s=p}=t;return s===1/0?function(t,e,n,i,r,o){const s=2*o/(n-e),a=2*o/(r-i),l=(n+e)/(n-e),c=(r+i)/(r-i),u=-2*o;t[0]=s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=l,t[9]=c,t[10]=-1,t[11]=-1,t[12]=0,t[13]=0,t[14]=u,t[15]=0}(this,e,n,i,r,o):a.oy(this,e,n,i,r,o,s),this.check()}lookAt(t){const{eye:e,center:n=[0,0,0],up:i=[0,1,0]}=t;return a.zB(this,e,n,i),this.check()}ortho(t){const{left:e,right:n,bottom:i,top:r,near:o=f,far:s=p}=t;return a.M5(this,e,n,i,r,o,s),this.check()}orthographic(t){const{fovy:e=h,aspect:n=d,focalDistance:i=1,near:r=f,far:o=p}=t;b(e);const s=e/2,a=i*Math.tan(s),l=a*n;return this.ortho({left:-l,right:l,bottom:-a,top:a,near:r,far:o})}perspective(t){const{fovy:e=45*Math.PI/180,aspect:n=1,near:i=.1,far:r=500}=t;return b(e),a.G3(this,e,n,i,r),this.check()}determinant(){return a.GH(this)}getScale(t=[-0,-0,-0]){return t[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),t[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),t[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),t}getTranslation(t=[-0,-0,-0]){return t[0]=this[12],t[1]=this[13],t[2]=this[14],t}getRotation(t,e){t=t||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],e=e||[-0,-0,-0];const n=this.getScale(e),i=1/n[0],r=1/n[1],o=1/n[2];return t[0]=this[0]*i,t[1]=this[1]*r,t[2]=this[2]*o,t[3]=0,t[4]=this[4]*i,t[5]=this[5]*r,t[6]=this[6]*o,t[7]=0,t[8]=this[8]*i,t[9]=this[9]*r,t[10]=this[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}getRotationMatrix3(t,e){t=t||[-0,-0,-0,-0,-0,-0,-0,-0,-0],e=e||[-0,-0,-0];const n=this.getScale(e),i=1/n[0],r=1/n[1],o=1/n[2];return t[0]=this[0]*i,t[1]=this[1]*r,t[2]=this[2]*o,t[3]=this[4]*i,t[4]=this[5]*r,t[5]=this[6]*o,t[6]=this[8]*i,t[7]=this[9]*r,t[8]=this[10]*o,t}transpose(){return a.p4(this,this),this.check()}invert(){return a.U_(this,this),this.check()}multiplyLeft(t){return a.Jp(this,t,this),this.check()}multiplyRight(t){return a.Jp(this,this,t),this.check()}rotateX(t){return a.lM(this,this,t),this.check()}rotateY(t){return a.uD(this,this,t),this.check()}rotateZ(t){return a.jI(this,this,t),this.check()}rotateXYZ(t){return this.rotateX(t[0]).rotateY(t[1]).rotateZ(t[2])}rotateAxis(t,e){return a.U1(this,this,t,e),this.check()}scale(t){return a.bA(this,this,Array.isArray(t)?t:[t,t,t]),this.check()}translate(t){return a.Iu(this,this,t),this.check()}transform(t,e){return 4===t.length?(e=u.fF(e||[-0,-0,-0,-0],t,this),(0,o.IL)(e,4),e):this.transformAsPoint(t,e)}transformAsPoint(t,e){const{length:n}=t;let i;switch(n){case 2:i=l.fF(e||[-0,-0],t,this);break;case 3:i=c.fF(e||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return(0,o.IL)(i,t.length),i}transformAsVector(t,e){let n;switch(t.length){case 2:n=(0,s.pb)(e||[-0,-0],t,this);break;case 3:n=(0,s.pL)(e||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return(0,o.IL)(n,t.length),n}transformPoint(t,e){return this.transformAsPoint(t,e)}transformVector(t,e){return this.transformAsPoint(t,e)}transformDirection(t,e){return this.transformAsVector(t,e)}makeRotationX(t){return this.identity().rotateX(t)}makeTranslation(t,e,n){return this.identity().translate([t,e,n])}}let _,v;function b(t){if(t>2*Math.PI)throw Error("expected radians")}},3855:(t,e,n)=>{"use strict";n.d(e,{Z:()=>u});var i=n(9521),r=n(4034),o=n(6281),s=n(7160),a=n(3858);const l=[0,0,0];let c;class u extends i.Z{static get ZERO(){return c||(c=new u(0,0,0),Object.freeze(c)),c}constructor(t=0,e=0,n=0){super(-0,-0,-0),1===arguments.length&&(0,r.kJ)(t)?this.copy(t):(r.vc.debug&&((0,o.u5)(t),(0,o.u5)(e),(0,o.u5)(n)),this[0]=t,this[1]=e,this[2]=n)}set(t,e,n){return this[0]=t,this[1]=e,this[2]=n,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this.check()}fromObject(t){return r.vc.debug&&((0,o.u5)(t.x),(0,o.u5)(t.y),(0,o.u5)(t.z)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this.check()}toObject(t){return t.x=this[0],t.y=this[1],t.z=this[2],t}get ELEMENTS(){return 3}get z(){return this[2]}set z(t){this[2]=(0,o.u5)(t)}angle(t){return s.EU(this,t)}cross(t){return s.kC(this,this,t),this.check()}rotateX({radians:t,origin:e=l}){return s.lM(this,this,e,t),this.check()}rotateY({radians:t,origin:e=l}){return s.uD(this,this,e,t),this.check()}rotateZ({radians:t,origin:e=l}){return s.jI(this,this,e,t),this.check()}transform(t){return this.transformAsPoint(t)}transformAsPoint(t){return s.fF(this,this,t),this.check()}transformAsVector(t){return(0,a.pL)(this,this,t),this.check()}transformByMatrix3(t){return s.kK(this,this,t),this.check()}transformByMatrix2(t){return(0,a.eQ)(this,this,t),this.check()}transformByQuaternion(t){return s.VC(this,this,t),this.check()}}},394:(t,e,n)=>{"use strict";function i(t,e){if(!t)throw new Error("math.gl assertion ".concat(e))}n.d(e,{Z:()=>i})},4034:(t,e,n)=>{"use strict";n.d(e,{Bw:()=>r,fS:()=>l,kJ:()=>o,t7:()=>a,uZ:()=>s,vc:()=>i}),Math.PI,Math.PI;const i={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0};function r(t,{precision:e=i.precision}={}){return t=function(t){return Math.round(t/i.EPSILON)*i.EPSILON}(t),"".concat(parseFloat(t.toPrecision(e)))}function o(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function s(t,e,n){return function(t,e,n){if(o(t)){const i=t;n=n||function(t){return t.clone?t.clone():new Array(t.length)}(i);for(let r=0;r<n.length&&r<i.length;++r)n[r]=e(t[r],r,n);return n}return e(t)}(t,(t=>Math.max(e,Math.min(n,t))))}function a(t,e,n){return o(t)?t.map(((t,i)=>a(t,e[i],n))):n*e+(1-n)*t}function l(t,e,n){const r=i.EPSILON;n&&(i.EPSILON=n);try{if(t===e)return!0;if(o(t)&&o(e)){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!l(t[n],e[n]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):"number"==typeof t&&"number"==typeof e&&Math.abs(t-e)<=i.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))}finally{i.EPSILON=r}}},3858:(t,e,n)=>{"use strict";function i(t,e,n){const i=e[0],r=e[1],o=n[3]*i+n[7]*r||1;return t[0]=(n[0]*i+n[4]*r)/o,t[1]=(n[1]*i+n[5]*r)/o,t}function r(t,e,n){const i=e[0],r=e[1],o=e[2],s=n[3]*i+n[7]*r+n[11]*o||1;return t[0]=(n[0]*i+n[4]*r+n[8]*o)/s,t[1]=(n[1]*i+n[5]*r+n[9]*o)/s,t[2]=(n[2]*i+n[6]*r+n[10]*o)/s,t}function o(t,e,n){const i=e[0],r=e[1];return t[0]=n[0]*i+n[2]*r,t[1]=n[1]*i+n[3]*r,t[2]=e[2],t}function s(t,e,n){const i=e[0],r=e[1];return t[0]=n[0]*i+n[2]*r,t[1]=n[1]*i+n[3]*r,t[2]=e[2],t[3]=e[3],t}function a(t,e,n){const i=e[0],r=e[1],o=e[2];return t[0]=n[0]*i+n[3]*r+n[6]*o,t[1]=n[1]*i+n[4]*r+n[7]*o,t[2]=n[2]*i+n[5]*r+n[8]*o,t[3]=e[3],t}n.d(e,{G7:()=>s,_x:()=>a,eQ:()=>o,pL:()=>r,pb:()=>i})},6281:(t,e,n)=>{"use strict";n.d(e,{IL:()=>o,u5:()=>r});var i=n(4034);function r(t){if(!Number.isFinite(t))throw new Error("Invalid number ".concat(t));return t}function o(t,e,n=""){if(i.vc.debug&&!function(t,e){if(t.length!==e)return!1;for(let e=0;e<t.length;++e)if(!Number.isFinite(t[e]))return!1;return!0}(t,e))throw new Error("math.gl: ".concat(n," some fields set to invalid numbers'"));return t}},6018:(t,e,n)=>{"use strict";n.d(e,{eG:()=>C,Lu:()=>S,Xg:()=>D,sj:()=>A,zX:()=>L,ro:()=>x,Bf:()=>w,wl:()=>E,lf:()=>k,w5:()=>b,QA:()=>I,CT:()=>M,es:()=>y,aW:()=>T});var i=n(8333);function r(t,e){const n=(0,i.fF)([],e,t);return(0,i.bA)(n,n,1/n[3]),n}function o(t,e){const n=t%e;return n<0?e+n:n}function s(t,e,n){return t<e?e:t>n?n:t}const a=Math.log2||function(t){return Math.log(t)*Math.LOG2E};var l=n(5975),c=n(1437),u=n(7160);function h(t,e){if(!t)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const d=Math.PI,f=d/4,p=d/180,g=180/d,m=512,_=85.051129,v=1.5;function b(t){const[e,n]=t;h(Number.isFinite(e)),h(Number.isFinite(n)&&n>=-90&&n<=90,"invalid latitude");const i=n*p;return[m*(e*p+d)/(2*d),m*(d+Math.log(Math.tan(f+.5*i)))/(2*d)]}function y(t){const[e,n]=t,i=e/m*(2*d)-d,r=2*(Math.atan(Math.exp(n/m*(2*d)-d))-f);return[i*g,r*g]}function w(t){const{latitude:e}=t;h(Number.isFinite(e));const n=Math.cos(e*p);return a(4003e4*n)-9}function x(t){const{latitude:e,longitude:n,highPrecision:i=!1}=t;h(Number.isFinite(e)&&Number.isFinite(n));const r=Math.cos(e*p),o=512/360,s=o/r,a=12790407194604047e-21/r,l={unitsPerMeter:[a,a,a],metersPerUnit:[1/a,1/a,1/a],unitsPerDegree:[o,s,a],degreesPerUnit:[.703125,1/s,1/a]};if(i){const t=p*Math.tan(e*p)/r,n=o*t/2,i=12790407194604047e-21*t,c=i/s*a;l.unitsPerDegree2=[0,n,i],l.unitsPerMeter2=[c,0,c]}return l}function C(t,e){const[n,i,r]=t,[o,s,a]=e,{unitsPerMeter:l,unitsPerMeter2:c}=x({longitude:n,latitude:i,highPrecision:!0}),u=b(t);u[0]+=o*(l[0]+c[0]*s),u[1]+=s*(l[1]+c[1]*s);const h=y(u),d=(r||0)+(a||0);return Number.isFinite(r)||Number.isFinite(a)?[h[0],h[1],d]:h}function k(t){const{height:e,pitch:n,bearing:i,altitude:r,scale:o,center:s}=t,a=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];l.Iu(a,a,[0,0,-r]),l.lM(a,a,-n*p),l.jI(a,a,i*p);const c=o/e;return l.bA(a,a,[c,c,c]),s&&l.Iu(a,a,u.tk([],s)),a}function E(t){const{width:e,height:n,altitude:i,pitch:r=0,offset:o,center:a,scale:l,nearZMultiplier:c=1,farZMultiplier:u=1}=t;let{fovy:h=S(v)}=t;void 0!==i&&(h=S(i));const d=h*p,f=r*p,g=A(h);let m=g;a&&(m+=a[2]*l/Math.cos(f)/n);const _=d*(.5+(o?o[1]:0)/n),b=Math.sin(_)*m/Math.sin(s(Math.PI/2-f-_,.01,Math.PI-.01)),y=Math.sin(f)*b+m,w=10*m;return{fov:d,aspect:e/n,focalDistance:g,near:c,far:Math.min(y*u,w)}}function S(t){return 2*Math.atan(.5/t)*g}function A(t){return.5/Math.tan(.5*t*p)}function T(t,e){const[n,i,o=0]=t;return h(Number.isFinite(n)&&Number.isFinite(i)&&Number.isFinite(o)),r(e,[n,i,o,1])}function M(t,e,n=0){const[i,o,s]=t;if(h(Number.isFinite(i)&&Number.isFinite(o),"invalid pixel coordinate"),Number.isFinite(s))return r(e,[i,o,s,1]);const a=r(e,[i,o,0,1]),l=r(e,[i,o,1,1]),u=a[2],d=l[2],f=u===d?0:((n||0)-u)/(d-u);return c.t7([],a,l,f)}function D(t){const{width:e,height:n,bounds:i,minExtent:r=0,maxZoom:o=24,offset:l=[0,0]}=t,[[c,u],[d,f]]=i,p=function(t=0){return"number"==typeof t?{top:t,bottom:t,left:t,right:t}:(h(Number.isFinite(t.top)&&Number.isFinite(t.bottom)&&Number.isFinite(t.left)&&Number.isFinite(t.right)),t)}(t.padding),g=b([c,s(f,-85.051129,_)]),m=b([d,s(u,-85.051129,_)]),v=[Math.max(Math.abs(m[0]-g[0]),r),Math.max(Math.abs(m[1]-g[1]),r)],w=[e-p.left-p.right-2*Math.abs(l[0]),n-p.top-p.bottom-2*Math.abs(l[1])];h(w[0]>0&&w[1]>0);const x=w[0]/v[0],C=w[1]/v[1],k=(p.right-p.left)/2/x,E=(p.top-p.bottom)/2/C,S=y([(m[0]+g[0])/2+k,(m[1]+g[1])/2+E]),A=Math.min(o,a(Math.abs(Math.min(x,C))));return h(Number.isFinite(A)),{longitude:S[0],latitude:S[1],zoom:A}}const P=Math.PI/180;function L(t,e=0){const{width:n,height:i,unproject:r}=t,o={targetZ:e},s=r([0,i],o),a=r([n,i],o);let l,c;return(t.fovy?.5*t.fovy*P:Math.atan(.5/t.altitude))>(90-t.pitch)*P-.01?(l=R(t,0,e),c=R(t,n,e)):(l=r([0,0],o),c=r([n,0],o)),[s,a,c,l]}function R(t,e,n){const{pixelUnprojectionMatrix:i}=t,o=r(i,[e,0,1,1]),s=r(i,[e,t.height,1,1]),a=(n*t.distanceScales.unitsPerMeter[2]-o[2])/(s[2]-o[2]),l=y(c.t7([],o,s,a));return l.push(n),l}function I(t){const{width:e,height:n,pitch:i=0}=t;let{longitude:r,latitude:s,zoom:l,bearing:c=0}=t;(r<-180||r>180)&&(r=o(r+180,360)-180),(c<-180||c>180)&&(c=o(c+180,360)-180);const u=a(n/512);if(l<=u)l=u,s=0;else{const t=n/2/Math.pow(2,l),e=y([0,t])[1];if(s<e)s=e;else{const e=y([0,512-t])[1];s>e&&(s=e)}}return{width:e,height:n,longitude:r,latitude:s,zoom:l,pitch:i,bearing:c}}},3485:(t,e,n)=>{"use strict";n.d(e,{Z:()=>s});var i=n(3370),r=n(2363);const o=globalThis;function s(t){if(!t&&!(0,i.Z)())return"Node";if((0,r.Z)(t))return"Electron";const e="undefined"!=typeof navigator?navigator:{},n=t||e.userAgent||"";if(n.indexOf("Edge")>-1)return"Edge";const s=-1!==n.indexOf("MSIE "),a=-1!==n.indexOf("Trident/");return s||a?"IE":o.chrome?"Chrome":o.safari?"Safari":o.mozInnerScreenX?"Firefox":"Unknown"}},3370:(t,e,n)=>{"use strict";n.d(e,{Z:()=>r});var i=n(2363);function r(){return!("object"==typeof process&&"[object process]"===String(process)&&!process.browser)||(0,i.Z)()}},2363:(t,e,n)=>{"use strict";function i(t){if("undefined"!=typeof window&&"object"==typeof window.process&&"renderer"===window.process.type)return!0;if("undefined"!=typeof process&&"object"==typeof process.versions&&Boolean(process.versions.electron))return!0;const e="object"==typeof navigator&&"string"==typeof navigator.userAgent&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}n.d(e,{Z:()=>i})},9109:(t,e,n)=>{"use strict";n.d(e,{Z:()=>w});var i=n(4942),r=n(3370);const o="undefined"!=typeof __VERSION__?__VERSION__:"untranspiled source";(0,r.Z)();class s{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"sessionStorage";(0,i.Z)(this,"storage",void 0),(0,i.Z)(this,"id",void 0),(0,i.Z)(this,"config",{}),this.storage=function(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch(t){return null}}(n),this.id=t,this.config={},Object.assign(this.config,e),this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(t){return this.config={},this.updateConfiguration(t)}updateConfiguration(t){if(Object.assign(this.config,t),this.storage){const t=JSON.stringify(this.config);this.storage.setItem(this.id,t)}return this}_loadConfiguration(){let t={};if(this.storage){const e=this.storage.getItem(this.id);t=e?JSON.parse(e):{}}return Object.assign(this.config,t),this}}function a(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:600;const r=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>i&&(n=Math.min(n,i/t.width));const o=t.width*n,s=t.height*n,a=["font-size:1px;","padding:".concat(Math.floor(s/2),"px ").concat(Math.floor(o/2),"px;"),"line-height:".concat(s,"px;"),"background:url(".concat(r,");"),"background-size:".concat(o,"px ").concat(s,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),a]}let l;function c(t){return"string"==typeof t?l[t.toUpperCase()]||l.WHITE:t}function u(t,e){if(!t)throw new Error(e||"Assertion failed")}!function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"}(l||(l={}));const h={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:void 0!==n.g&&n.g,document:"undefined"!=typeof document&&document,process:"object"==typeof process&&process},d=(globalThis,h.window||h.self||h.global),f=h.process||{};function p(){let t;var e,n;if(r.Z&&"performance"in d)t=null==d||null===(e=d.performance)||void 0===e||null===(n=e.now)||void 0===n?void 0:n.call(e);else if("hrtime"in f){var i;const e=null==f||null===(i=f.hrtime)||void 0===i?void 0:i.call(f);t=1e3*e[0]+e[1]/1e6}else t=Date.now();return t}console;var g=n(2249);const m={debug:r.Z&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},_={enabled:!0,level:0};function v(){}const b={},y={once:!0};class w{constructor(){let{id:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{id:""};(0,i.Z)(this,"id",void 0),(0,i.Z)(this,"VERSION",o),(0,i.Z)(this,"_startTs",p()),(0,i.Z)(this,"_deltaTs",p()),(0,i.Z)(this,"_storage",void 0),(0,i.Z)(this,"userData",{}),(0,i.Z)(this,"LOG_THROTTLE_TIMEOUT",0),this.id=t,this._storage=new s("__probe-".concat(this.id,"__"),_),this.userData={},this.timeStamp("".concat(this.id," started")),function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),i=Object.getOwnPropertyNames(n);for(const n of i)"function"==typeof t[n]&&(e.find((t=>n===t))||(t[n]=t[n].bind(t)))}(this),Object.seal(this)}set level(t){this.setLevel(t)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((p()-this._startTs).toPrecision(10))}getDelta(){return Number((p()-this._deltaTs).toPrecision(10))}set priority(t){this.level=t}get priority(){return this.level}getPriority(){return this.level}enable(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._storage.updateConfiguration({enabled:t}),this}setLevel(t){return this._storage.updateConfiguration({level:t}),this}get(t){return this._storage.config[t]}set(t,e){this._storage.updateConfiguration({[t]:e})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(t,e){u(t,e)}warn(t){return this._getLogFunction(0,t,m.warn,arguments,y)}error(t){return this._getLogFunction(0,t,m.error,arguments)}deprecated(t,e){return this.warn("`".concat(t,"` is deprecated and will be removed in a later version. Use `").concat(e,"` instead"))}removed(t,e){return this.error("`".concat(t,"` has been removed. Use `").concat(e,"` instead"))}probe(t,e){return this._getLogFunction(t,e,m.log,arguments,{time:!0,once:!0})}log(t,e){return this._getLogFunction(t,e,m.debug,arguments)}info(t,e){return this._getLogFunction(t,e,console.info,arguments)}once(t,e){for(var n=arguments.length,i=new Array(n>2?n-2:0),r=2;r<n;r++)i[r-2]=arguments[r];return this._getLogFunction(t,e,m.debug||m.info,arguments,y)}table(t,e,n){return e?this._getLogFunction(t,e,console.table||v,n&&[n],{tag:k(e)}):v}image(t){let{logLevel:e,priority:n,image:i,message:o="",scale:s=1}=t;return this._shouldLog(e||n)?r.Z?function(t){let{image:e,message:n="",scale:i=1}=t;if("string"==typeof e){const t=new Image;return t.onload=()=>{const e=a(t,n,i);console.log(...e)},t.src=e,v}const r=e.nodeName||"";if("img"===r.toLowerCase())return console.log(...a(e,n,i)),v;if("canvas"===r.toLowerCase()){const t=new Image;return t.onload=()=>console.log(...a(t,n,i)),t.src=e.toDataURL(),v}return v}({image:i,message:o,scale:s}):function(t){let{image:e,message:n="",scale:i=1}=t;return g.nodeAsciifyImage({image:e,message:n,scale:i}),v}({image:i,message:o,scale:s}):v}time(t,e){return this._getLogFunction(t,e,console.time?console.time:console.info)}timeEnd(t,e){return this._getLogFunction(t,e,console.timeEnd?console.timeEnd:console.info)}timeStamp(t,e){return this._getLogFunction(t,e,console.timeStamp||v)}group(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{collapsed:!1};const i=C({logLevel:t,message:e,opts:n}),{collapsed:r}=n;return i.method=(r?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.group(t,e,Object.assign({},n,{collapsed:!0}))}groupEnd(t){return this._getLogFunction(t,"",console.groupEnd||v)}withGroup(t,e,n){this.group(t,e)();try{n()}finally{this.groupEnd(t)()}}trace(){console.trace&&console.trace()}_shouldLog(t){return this.isEnabled()&&this.getLevel()>=x(t)}_getLogFunction(t,e,n,i,o){if(this._shouldLog(t)){o=C({logLevel:t,message:e,args:i,opts:o}),u(n=n||o.method),o.total=this.getTotal(),o.delta=this.getDelta(),this._deltaTs=p();const s=o.tag||o.message;if(o.once){if(b[s])return v;b[s]=p()}return e=function(t,e,n){if("string"==typeof e){const a=n.time?function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}(function(t){let e;return e=t<10?"".concat(t.toFixed(2),"ms"):t<100?"".concat(t.toFixed(1),"ms"):t<1e3?"".concat(t.toFixed(0),"ms"):"".concat((t/1e3).toFixed(2),"s"),e}(n.total)):"";i=e=n.time?"".concat(t,": ").concat(a,"  ").concat(e):"".concat(t,": ").concat(e),o=n.color,s=n.background,r.Z||"string"!=typeof i||(o&&(o=c(o),i="[".concat(o,"m").concat(i,"[39m")),s&&(o=c(s),i="[".concat(s+10,"m").concat(i,"[49m"))),e=i}var i,o,s;return e}(this.id,o.message,o),n.bind(console,e,...o.args)}return v}}function x(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return u(Number.isFinite(e)&&e>=0),e}function C(t){const{logLevel:e,message:n}=t;t.logLevel=x(e);const i=t.args?Array.from(t.args):[];for(;i.length&&i.shift()!==n;);switch(typeof e){case"string":case"function":void 0!==n&&i.unshift(n),t.message=e;break;case"object":Object.assign(t,e)}"function"==typeof t.message&&(t.message=t.message());const r=typeof t.message;return u("string"===r||"object"===r),Object.assign(t,{args:i},t.opts)}function k(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}(0,i.Z)(w,"VERSION",o)},8295:(t,e,n)=>{"use strict";n.d(e,{Z:()=>s});var i=n(4942);function r(){let t;if("undefined"!=typeof window&&window.performance)t=window.performance.now();else if("undefined"!=typeof process&&process.hrtime){const e=process.hrtime();t=1e3*e[0]+e[1]/1e6}else t=Date.now();return t}class o{constructor(t,e){(0,i.Z)(this,"name",void 0),(0,i.Z)(this,"type",void 0),(0,i.Z)(this,"sampleSize",1),(0,i.Z)(this,"time",void 0),(0,i.Z)(this,"count",void 0),(0,i.Z)(this,"samples",void 0),(0,i.Z)(this,"lastTiming",void 0),(0,i.Z)(this,"lastSampleTime",void 0),(0,i.Z)(this,"lastSampleCount",void 0),(0,i.Z)(this,"_count",0),(0,i.Z)(this,"_time",0),(0,i.Z)(this,"_samples",0),(0,i.Z)(this,"_startTime",0),(0,i.Z)(this,"_timerPending",!1),this.name=t,this.type=e,this.reset()}setSampleSize(t){return this.sampleSize=t,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(t){return this._count+=t,this._samples++,this._checkSampling(),this}subtractCount(t){return this._count-=t,this._samples++,this._checkSampling(),this}addTime(t){return this._time+=t,this.lastTiming=t,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=r(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(r()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class s{constructor(t){(0,i.Z)(this,"id",void 0),(0,i.Z)(this,"stats",{}),this.id=t.id,this.stats={},this._initializeStats(t.stats),Object.seal(this)}get(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"count";return this._getOrCreate({name:t,type:e})}get size(){return Object.keys(this.stats).length}reset(){for(const t in this.stats)this.stats[t].reset();return this}forEach(t){for(const e in this.stats)t(this.stats[e])}getTable(){const t={};return this.forEach((e=>{t[e.name]={time:e.time||0,count:e.count||0,average:e.getAverageTime()||0,hz:e.getHz()||0}})),t}_initializeStats(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach((t=>this._getOrCreate(t)))}_getOrCreate(t){if(!t||!t.name)return null;const{name:e,type:n}=t;return this.stats[e]||(this.stats[e]=t instanceof o?t:new o(e,n)),this.stats[e]}}},9863:(t,e,n)=>{"use strict";n.d(e,{Z:()=>d});var i=n(8081),r=n.n(i),o=n(3645),s=n.n(o),a=n(1667),l=n.n(a),c=new URL(n(2810),n.b),u=s()(r()),h=l()(c);u.push([t.id,":root .grid-stack-item>.ui-resizable-handle{filter:none}.grid-stack{position:relative}.grid-stack.grid-stack-rtl{direction:ltr}.grid-stack.grid-stack-rtl>.grid-stack-item{direction:rtl}.grid-stack .grid-stack-placeholder>.placeholder-content{background-color:rgba(0,0,0,.1);margin:0;position:absolute;width:auto;z-index:0!important;text-align:center}.grid-stack>.grid-stack-item{min-width:8.3333333333%;position:absolute;padding:0}.grid-stack>.grid-stack-item>.grid-stack-item-content{margin:0;position:absolute;width:auto;overflow-x:hidden;overflow-y:auto}.grid-stack>.grid-stack-item>.ui-resizable-handle{position:absolute;font-size:.1px;display:block;-ms-touch-action:none;touch-action:none}.grid-stack>.grid-stack-item.ui-resizable-autohide>.ui-resizable-handle,.grid-stack>.grid-stack-item.ui-resizable-disabled>.ui-resizable-handle{display:none}.grid-stack>.grid-stack-item>.ui-resizable-se,.grid-stack>.grid-stack-item>.ui-resizable-sw{background-image:url("+h+');background-repeat:no-repeat;background-position:center;-webkit-transform:rotate(45deg);-moz-transform:rotate(45deg);-ms-transform:rotate(45deg);-o-transform:rotate(45deg);transform:rotate(45deg)}.grid-stack>.grid-stack-item>.ui-resizable-se{-webkit-transform:rotate(-45deg);-moz-transform:rotate(-45deg);-ms-transform:rotate(-45deg);-o-transform:rotate(-45deg);transform:rotate(-45deg)}.grid-stack>.grid-stack-item>.ui-resizable-nw{cursor:nw-resize;width:20px;height:20px;top:0}.grid-stack>.grid-stack-item>.ui-resizable-n{cursor:n-resize;height:10px;top:0;left:25px;right:25px}.grid-stack>.grid-stack-item>.ui-resizable-ne{cursor:ne-resize;width:20px;height:20px;top:0}.grid-stack>.grid-stack-item>.ui-resizable-e{cursor:e-resize;width:10px;top:15px;bottom:15px}.grid-stack>.grid-stack-item>.ui-resizable-se{cursor:se-resize;width:20px;height:20px}.grid-stack>.grid-stack-item>.ui-resizable-s{cursor:s-resize;height:10px;left:25px;bottom:0;right:25px}.grid-stack>.grid-stack-item>.ui-resizable-sw{cursor:sw-resize;width:20px;height:20px}.grid-stack>.grid-stack-item>.ui-resizable-w{cursor:w-resize;width:10px;top:15px;bottom:15px}.grid-stack>.grid-stack-item.ui-draggable-dragging>.ui-resizable-handle{display:none!important}.grid-stack>.grid-stack-item[gs-w="0"]{width:0%}.grid-stack>.grid-stack-item[gs-x="0"]{left:0}.grid-stack>.grid-stack-item[gs-min-w="0"]{min-width:0}.grid-stack>.grid-stack-item[gs-max-w="0"]{max-width:0%}.grid-stack>.grid-stack-item[gs-w="1"]{width:8.3333333333%}.grid-stack>.grid-stack-item[gs-x="1"]{left:8.3333333333%}.grid-stack>.grid-stack-item[gs-min-w="1"]{min-width:8.3333333333%}.grid-stack>.grid-stack-item[gs-max-w="1"]{max-width:8.3333333333%}.grid-stack>.grid-stack-item[gs-w="2"]{width:16.6666666667%}.grid-stack>.grid-stack-item[gs-x="2"]{left:16.6666666667%}.grid-stack>.grid-stack-item[gs-min-w="2"]{min-width:16.6666666667%}.grid-stack>.grid-stack-item[gs-max-w="2"]{max-width:16.6666666667%}.grid-stack>.grid-stack-item[gs-w="3"]{width:25%}.grid-stack>.grid-stack-item[gs-x="3"]{left:25%}.grid-stack>.grid-stack-item[gs-min-w="3"]{min-width:25%}.grid-stack>.grid-stack-item[gs-max-w="3"]{max-width:25%}.grid-stack>.grid-stack-item[gs-w="4"]{width:33.3333333333%}.grid-stack>.grid-stack-item[gs-x="4"]{left:33.3333333333%}.grid-stack>.grid-stack-item[gs-min-w="4"]{min-width:33.3333333333%}.grid-stack>.grid-stack-item[gs-max-w="4"]{max-width:33.3333333333%}.grid-stack>.grid-stack-item[gs-w="5"]{width:41.6666666667%}.grid-stack>.grid-stack-item[gs-x="5"]{left:41.6666666667%}.grid-stack>.grid-stack-item[gs-min-w="5"]{min-width:41.6666666667%}.grid-stack>.grid-stack-item[gs-max-w="5"]{max-width:41.6666666667%}.grid-stack>.grid-stack-item[gs-w="6"]{width:50%}.grid-stack>.grid-stack-item[gs-x="6"]{left:50%}.grid-stack>.grid-stack-item[gs-min-w="6"]{min-width:50%}.grid-stack>.grid-stack-item[gs-max-w="6"]{max-width:50%}.grid-stack>.grid-stack-item[gs-w="7"]{width:58.3333333333%}.grid-stack>.grid-stack-item[gs-x="7"]{left:58.3333333333%}.grid-stack>.grid-stack-item[gs-min-w="7"]{min-width:58.3333333333%}.grid-stack>.grid-stack-item[gs-max-w="7"]{max-width:58.3333333333%}.grid-stack>.grid-stack-item[gs-w="8"]{width:66.6666666667%}.grid-stack>.grid-stack-item[gs-x="8"]{left:66.6666666667%}.grid-stack>.grid-stack-item[gs-min-w="8"]{min-width:66.6666666667%}.grid-stack>.grid-stack-item[gs-max-w="8"]{max-width:66.6666666667%}.grid-stack>.grid-stack-item[gs-w="9"]{width:75%}.grid-stack>.grid-stack-item[gs-x="9"]{left:75%}.grid-stack>.grid-stack-item[gs-min-w="9"]{min-width:75%}.grid-stack>.grid-stack-item[gs-max-w="9"]{max-width:75%}.grid-stack>.grid-stack-item[gs-w="10"]{width:83.3333333333%}.grid-stack>.grid-stack-item[gs-x="10"]{left:83.3333333333%}.grid-stack>.grid-stack-item[gs-min-w="10"]{min-width:83.3333333333%}.grid-stack>.grid-stack-item[gs-max-w="10"]{max-width:83.3333333333%}.grid-stack>.grid-stack-item[gs-w="11"]{width:91.6666666667%}.grid-stack>.grid-stack-item[gs-x="11"]{left:91.6666666667%}.grid-stack>.grid-stack-item[gs-min-w="11"]{min-width:91.6666666667%}.grid-stack>.grid-stack-item[gs-max-w="11"]{max-width:91.6666666667%}.grid-stack>.grid-stack-item[gs-w="12"]{width:100%}.grid-stack>.grid-stack-item[gs-x="12"]{left:100%}.grid-stack>.grid-stack-item[gs-min-w="12"]{min-width:100%}.grid-stack>.grid-stack-item[gs-max-w="12"]{max-width:100%}.grid-stack.grid-stack-1>.grid-stack-item{min-width:100%}.grid-stack.grid-stack-1>.grid-stack-item[gs-w="1"]{width:100%}.grid-stack.grid-stack-1>.grid-stack-item[gs-x="1"]{left:100%}.grid-stack.grid-stack-1>.grid-stack-item[gs-min-w="1"]{min-width:100%}.grid-stack.grid-stack-1>.grid-stack-item[gs-max-w="1"]{max-width:100%}.grid-stack.grid-stack-animate,.grid-stack.grid-stack-animate .grid-stack-item{-webkit-transition:left .3s,top .3s,height .3s,width .3s;-moz-transition:left .3s,top .3s,height .3s,width .3s;-ms-transition:left .3s,top .3s,height .3s,width .3s;-o-transition:left .3s,top .3s,height .3s,width .3s;transition:left .3s,top .3s,height .3s,width .3s}.grid-stack.grid-stack-animate .grid-stack-item.grid-stack-placeholder,.grid-stack.grid-stack-animate .grid-stack-item.ui-draggable-dragging,.grid-stack.grid-stack-animate .grid-stack-item.ui-resizable-resizing{-webkit-transition:left 0s,top 0s,height 0s,width 0s;-moz-transition:left 0s,top 0s,height 0s,width 0s;-ms-transition:left 0s,top 0s,height 0s,width 0s;-o-transition:left 0s,top 0s,height 0s,width 0s;transition:left 0s,top 0s,height 0s,width 0s}.ui-draggable-dragging,.ui-resizable-resizing{z-index:100}.ui-draggable-dragging>.grid-stack-item-content,.ui-resizable-resizing>.grid-stack-item-content{box-shadow:1px 4px 6px rgba(0,0,0,.2);opacity:.8}.ui-draggable-dragging{will-change:left,top;cursor:move}.ui-resizable-resizing{will-change:width,height}',""]);const d=u},6499:(t,e,n)=>{"use strict";n.d(e,{Z:()=>v});var i=n(8081),r=n.n(i),o=n(3645),s=n.n(o),a=n(1667),l=n.n(a),c=new URL(n(9854),n.b),u=new URL(n(1627),n.b),h=new URL(n(8260),n.b),d=new URL(n(8261),n.b),f=s()(r()),p=l()(c),g=l()(u),m=l()(h),_=l()(d);f.push([t.id,'/* -------------------------------------------------------------------\n  Microtip\n\n  Modern, lightweight css-only tooltips\n  Just 1kb minified and gzipped\n\n  @author Ghosh\n  @package Microtip\n\n----------------------------------------------------------------------\n  1. Base Styles\n  2. Direction Modifiers\n  3. Position Modifiers\n--------------------------------------------------------------------*/\n[aria-label][role~="tooltip"]{position:relative}[aria-label][role~="tooltip"]::before,[aria-label][role~="tooltip"]::after{transform:translate3d(0,0,0);-webkit-backface-visibility:hidden;backface-visibility:hidden;will-change:transform;opacity:0;pointer-events:none;transition:all var(--microtip-transition-duration,.18s) var(--microtip-transition-easing,ease-in-out) var(--microtip-transition-delay,0s);position:absolute;box-sizing:border-box;z-index:10;transform-origin:top}[aria-label][role~="tooltip"]::before{background-size:100% auto!important;content:""}[aria-label][role~="tooltip"]::after{background:rgba(17,17,17,.9);border-radius:4px;color:#fff;content:attr(aria-label);font-size:var(--microtip-font-size,13px);font-weight:var(--microtip-font-weight,normal);text-transform:var(--microtip-text-transform,none);padding:.5em 1em;white-space:nowrap;box-sizing:content-box}[aria-label][role~="tooltip"]:hover::before,[aria-label][role~="tooltip"]:hover::after,[aria-label][role~="tooltip"]:focus::before,[aria-label][role~="tooltip"]:focus::after{opacity:1;pointer-events:auto}[role~="tooltip"][data-microtip-position|="top"]::before{background:url('+p+') no-repeat;height:6px;width:18px;margin-bottom:5px}[role~="tooltip"][data-microtip-position|="top"]::after{margin-bottom:11px}[role~="tooltip"][data-microtip-position|="top"]::before{transform:translate3d(-50%,0,0);bottom:100%;left:50%}[role~="tooltip"][data-microtip-position|="top"]:hover::before{transform:translate3d(-50%,-5px,0)}[role~="tooltip"][data-microtip-position|="top"]::after{transform:translate3d(-50%,0,0);bottom:100%;left:50%}[role~="tooltip"][data-microtip-position="top"]:hover::after{transform:translate3d(-50%,-5px,0)}[role~="tooltip"][data-microtip-position="top-left"]::after{transform:translate3d(calc(-100% + 16px),0,0);bottom:100%}[role~="tooltip"][data-microtip-position="top-left"]:hover::after{transform:translate3d(calc(-100% + 16px),-5px,0)}[role~="tooltip"][data-microtip-position="top-right"]::after{transform:translate3d(calc(0% + -16px),0,0);bottom:100%}[role~="tooltip"][data-microtip-position="top-right"]:hover::after{transform:translate3d(calc(0% + -16px),-5px,0)}[role~="tooltip"][data-microtip-position|="bottom"]::before{background:url('+g+') no-repeat;height:6px;width:18px;margin-top:5px;margin-bottom:0}[role~="tooltip"][data-microtip-position|="bottom"]::after{margin-top:11px}[role~="tooltip"][data-microtip-position|="bottom"]::before{transform:translate3d(-50%,-10px,0);bottom:auto;left:50%;top:100%}[role~="tooltip"][data-microtip-position|="bottom"]:hover::before{transform:translate3d(-50%,0,0)}[role~="tooltip"][data-microtip-position|="bottom"]::after{transform:translate3d(-50%,-10px,0);top:100%;left:50%}[role~="tooltip"][data-microtip-position="bottom"]:hover::after{transform:translate3d(-50%,0,0)}[role~="tooltip"][data-microtip-position="bottom-left"]::after{transform:translate3d(calc(-100% + 16px),-10px,0);top:100%}[role~="tooltip"][data-microtip-position="bottom-left"]:hover::after{transform:translate3d(calc(-100% + 16px),0,0)}[role~="tooltip"][data-microtip-position="bottom-right"]::after{transform:translate3d(calc(0% + -16px),-10px,0);top:100%}[role~="tooltip"][data-microtip-position="bottom-right"]:hover::after{transform:translate3d(calc(0% + -16px),0,0)}[role~="tooltip"][data-microtip-position="left"]::before,[role~="tooltip"][data-microtip-position="left"]::after{bottom:auto;left:auto;right:100%;top:50%;transform:translate3d(10px,-50%,0)}[role~="tooltip"][data-microtip-position="left"]::before{background:url('+m+') no-repeat;height:18px;width:6px;margin-right:5px;margin-bottom:0}[role~="tooltip"][data-microtip-position="left"]::after{margin-right:11px}[role~="tooltip"][data-microtip-position="left"]:hover::before,[role~="tooltip"][data-microtip-position="left"]:hover::after{transform:translate3d(0,-50%,0)}[role~="tooltip"][data-microtip-position="right"]::before,[role~="tooltip"][data-microtip-position="right"]::after{bottom:auto;left:100%;top:50%;transform:translate3d(-10px,-50%,0)}[role~="tooltip"][data-microtip-position="right"]::before{background:url('+_+') no-repeat;height:18px;width:6px;margin-bottom:0;margin-left:5px}[role~="tooltip"][data-microtip-position="right"]::after{margin-left:11px}[role~="tooltip"][data-microtip-position="right"]:hover::before,[role~="tooltip"][data-microtip-position="right"]:hover::after{transform:translate3d(0,-50%,0)}[role~="tooltip"][data-microtip-size="small"]::after{white-space:initial;width:80px}[role~="tooltip"][data-microtip-size="medium"]::after{white-space:initial;width:150px}[role~="tooltip"][data-microtip-size="large"]::after{white-space:initial;width:260px}',""]);const v=f},1171:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});var i=n(8081),r=n.n(i),o=n(3645),s=n.n(o)()(r());s.push([t.id,'.noUi-target,.noUi-target *{-webkit-touch-callout:none;-webkit-tap-highlight-color:transparent;-webkit-user-select:none;-ms-touch-action:none;touch-action:none;-ms-user-select:none;-moz-user-select:none;user-select:none;-moz-box-sizing:border-box;box-sizing:border-box}.noUi-target{position:relative}.noUi-base,.noUi-connects{width:100%;height:100%;position:relative;z-index:1}.noUi-connects{overflow:hidden;z-index:0}.noUi-connect,.noUi-origin{will-change:transform;position:absolute;z-index:1;top:0;right:0;height:100%;width:100%;-ms-transform-origin:0 0;-webkit-transform-origin:0 0;-webkit-transform-style:preserve-3d;transform-origin:0 0;transform-style:flat}.noUi-txt-dir-rtl.noUi-horizontal .noUi-origin{left:0;right:auto}.noUi-vertical .noUi-origin{top:-100%;width:0}.noUi-horizontal .noUi-origin{height:0}.noUi-handle{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute}.noUi-touch-area{height:100%;width:100%}.noUi-state-tap .noUi-connect,.noUi-state-tap .noUi-origin{-webkit-transition:transform .3s;transition:transform .3s}.noUi-state-drag *{cursor:inherit!important}.noUi-horizontal{height:18px}.noUi-horizontal .noUi-handle{width:34px;height:28px;right:-17px;top:-6px}.noUi-vertical{width:18px}.noUi-vertical .noUi-handle{width:28px;height:34px;right:-6px;bottom:-17px}.noUi-txt-dir-rtl.noUi-horizontal .noUi-handle{left:-17px;right:auto}.noUi-target{background:#FAFAFA;border-radius:4px;border:1px solid #D3D3D3;box-shadow:inset 0 1px 1px #F0F0F0,0 3px 6px -5px #BBB}.noUi-connects{border-radius:3px}.noUi-connect{background:#3FB8AF}.noUi-draggable{cursor:ew-resize}.noUi-vertical .noUi-draggable{cursor:ns-resize}.noUi-handle{border:1px solid #D9D9D9;border-radius:3px;background:#FFF;cursor:default;box-shadow:inset 0 0 1px #FFF,inset 0 1px 7px #EBEBEB,0 3px 6px -3px #BBB}.noUi-active{box-shadow:inset 0 0 1px #FFF,inset 0 1px 7px #DDD,0 3px 6px -3px #BBB}.noUi-handle:after,.noUi-handle:before{content:"";display:block;position:absolute;height:14px;width:1px;background:#E8E7E6;left:14px;top:6px}.noUi-handle:after{left:17px}.noUi-vertical .noUi-handle:after,.noUi-vertical .noUi-handle:before{width:14px;height:1px;left:6px;top:14px}.noUi-vertical .noUi-handle:after{top:17px}[disabled] .noUi-connect{background:#B8B8B8}[disabled] .noUi-handle,[disabled].noUi-handle,[disabled].noUi-target{cursor:not-allowed}.noUi-pips,.noUi-pips *{-moz-box-sizing:border-box;box-sizing:border-box}.noUi-pips{position:absolute;color:#999}.noUi-value{position:absolute;white-space:nowrap;text-align:center}.noUi-value-sub{color:#ccc;font-size:10px}.noUi-marker{position:absolute;background:#CCC}.noUi-marker-sub{background:#AAA}.noUi-marker-large{background:#AAA}.noUi-pips-horizontal{padding:10px 0;height:80px;top:100%;left:0;width:100%}.noUi-value-horizontal{-webkit-transform:translate(-50%,50%);transform:translate(-50%,50%)}.noUi-rtl .noUi-value-horizontal{-webkit-transform:translate(50%,50%);transform:translate(50%,50%)}.noUi-marker-horizontal.noUi-marker{margin-left:-1px;width:2px;height:5px}.noUi-marker-horizontal.noUi-marker-sub{height:10px}.noUi-marker-horizontal.noUi-marker-large{height:15px}.noUi-pips-vertical{padding:0 10px;height:100%;top:0;left:100%}.noUi-value-vertical{-webkit-transform:translate(0,-50%);transform:translate(0,-50%);padding-left:25px}.noUi-rtl .noUi-value-vertical{-webkit-transform:translate(0,50%);transform:translate(0,50%)}.noUi-marker-vertical.noUi-marker{width:5px;height:2px;margin-top:-1px}.noUi-marker-vertical.noUi-marker-sub{width:10px}.noUi-marker-vertical.noUi-marker-large{width:15px}.noUi-tooltip{display:block;position:absolute;border:1px solid #D9D9D9;border-radius:3px;background:#fff;color:#000;padding:5px;text-align:center;white-space:nowrap}.noUi-horizontal .noUi-tooltip{-webkit-transform:translate(-50%,0);transform:translate(-50%,0);left:50%;bottom:120%}.noUi-vertical .noUi-tooltip{-webkit-transform:translate(0,-50%);transform:translate(0,-50%);top:50%;right:120%}.noUi-horizontal .noUi-origin>.noUi-tooltip{-webkit-transform:translate(50%,0);transform:translate(50%,0);left:auto;bottom:10px}.noUi-vertical .noUi-origin>.noUi-tooltip{-webkit-transform:translate(0,-18px);transform:translate(0,-18px);top:auto;right:28px}',""]);const a=s},1451:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});var i=n(8081),r=n.n(i),o=n(3645),s=n.n(o)()(r());s.push([t.id,".panel-track-label{\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    max-width:100px;\n    position:absolute;\n    right:5px;\n    display:none;\n    background-color: white;\n    color:black;\n    font-size:13px;\n    cursor:pointer\n\n}\n\n\n\n.panel-track-label:hover {\n    font-weight:bold;\n}\n\n\n.panel-loading-icon{\n    display:block;\n    position:absolute;\n    margin: 0;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n    font-size:30px;\n}\n\n\n.panel-error-message{\n    display:none;\n    position:absolute;\n    margin: 0;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n    font-size:20px;\n    color:#721c24;\n    background:#f8d7da;\n    border: 1px solid #f5c6cb;\n}\n\n",""]);const a=s},8520:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});var i=n(8081),r=n.n(i),o=n(3645),s=n.n(o)()(r());s.push([t.id,"@media (prefers-color-scheme: dark) {\n    :root {\n        --title_bar_color: #222;\n        --main_panel_color: black;\n        --text_color: white;\n        --background_color: rgb(51, 51, 51);\n        --input_border_color: #222;\n        --input_background_color: #222;\n        --dlg_background_color: #111;\n        --menu-gradient: linear-gradient(#444, #222);\n    }\n}\n@media (prefers-color-scheme: light) {\n    :root {\n        --title_bar_color: white;\n        --main_panel_color: #f1f1f1;\n        --text_color: black;\n        --background_color: rgb(186, 186, 186);\n        --input_border_color: rgb(230, 230, 230);\n        --input_background_color: rgb(230, 230, 230);\n        --dlg_background_color: white;\n        --menu-gradient: linear-gradient(white, darkgray);\n    }\n}\n\n.Dark {\n    --title_bar_color: #222;\n    --main_panel_color: black;\n    --text_color: white;\n    --background_color: rgb(51, 51, 51);\n    --input_border_color: #222;\n    --input_background_color: #222;\n    --dlg_background_color: #111;\n    --menu-gradient: linear-gradient(#444, #222);\n}\n\n.Light {\n    --title_bar_color: white;\n    --main_panel_color: #f1f1f1;\n    --text_color: black;\n    --background_color: rgb(186, 186, 186);\n    --input_border_color: rgb(230, 230, 230);\n    --input_background_color: rgb(230, 230, 230);\n    --dlg_background_color: white;\n    --menu-gradient: linear-gradient(white, darkgray);\n}\n:root {\n    font-family: Inter, Avenir, Helvetica, Arial, sans-serif;\n    --button_color: #1266f1;\n}\n.Dark a {\n    color: #1266f1;\n}\nselect, input, textarea {\n    border: 0.1em solid var(--input_border_color);\n    border-radius: 4px;\n    background-color: var(--input_background_color);\n}\n.mdv-select{\n    border-radius: 3px;\n    font-size:0.8em;\n    margin:2px;\n}\n\n.mdv-divider{\n    margin-left:6px;\n    margin-right:6px;\n}\n\n.mdv-select:focus{\n\n    box-shadow:0px 0px 3px 2px #088AFF;\n    outline: 0 none;\n}\n\n.mdv-info-text{\n    font-size:0.9em;\n    opacity:0.7;\n    display:block;\n\n}\n\n.mdv-section{\n    padding:4px;\n}\n\n.mdv-section-header{\n    background-color:var(--background_color);\n    font-weight: bold;\n}\n.mdv-section-value{\n    white-space:pre-wrap;\n}\n\n.mdv-image-holder{\n    margin:5px;\n    border:1px solid black;\n    position:relative;\n    overflow:hidden;\n}\n\n\n.mdv-checkbox{\n    transform:scale(1.2);\n    vertical-align: middle;\n}\n\n\n.mdv-flex-dynamic{\n    overflow:hidden;\n    white-space:nowrap;\n    text-overflow:ellipsis;\n    flex-grow:1;\n    min-width:0;\n}\n\n.mdv-flex-fixed{\n    flex-shrink:0;\n    flex-grow:0;\n}\n\n.grid-stack  .ciview-chart-panel {\n    box-shadow: none;\n    /* nb changing box-sizing,  adjusted width in _getContentDimensions()...\n    otherwise VolumeView was overflowing.\n    Left 'overflow: hidden' for now anyway.\n    */\n    overflow: hidden;\n    box-sizing: border-box;\n    border: 4px solid var(--background_color);\n}\n.grid-stack-placeholder {\n    background-color: rgba(0, 0, 0, 0.3);\n}\n\n.grid-stack {\n    overflow-x: hidden !important;\n}\n\n.Dark .gridLock {\n    border-color: #101010;\n}\n.Light .gridLock {\n    border-color: #888;\n}\n\n.ciview-chart-panel{\n    display:flex;\n    flex-flow:column;\n    border-radius:5px;\n    box-shadow: 0 0 1em #888;\n}\n/*  */\n/* .ciview-chart-panel::-webkit-resizer {\n    z-index: 0;\n    display: inline-block;\n    position: relative;\n    bottom: 0px;\n    right: 0px;\n    background-color: green;\n    width: 100px;\n    height: 100px;\n} */\n.resizer-both {\n  width: 15px;\n  height: 15px;\n  background: transparent;\n  z-index: 10;\n  position: absolute;\n  right: 0;\n  bottom: 0;\n  cursor: nw-resize;\n}\n\n.ciview-chart-titlebar{\n    display:flex;\n    padding:4px;\n    background: var(--title_bar_color);\n    color: var(--text_color);\n    flex:0 0 auto;\n    font-size:14px;\n}\n\n.ciview-contentDiv {\n    background-color: var(--background_color);\n}\n\n.ciview-chart-title{\n    flex-grow:1;\n    text-overflow:ellipsis;\n    overflow:hidden;\n    white-space:nowrap;\n    margin-left: 0.2em;\n}\n.ciview-chart-menuspace{\n    flex-grow:0;\n    white-space:nowrap;\n    display:flex;\n    flex-flow: row-reverse;\n    align-items: center;\n}\n\n/*[aria-label][role~=\"tooltip\"]::after{\n    background-color: #155724;\n}*/\n\n.ciview-chart-content{\n    flex:1 1 auto;\n    position:relative;\n    z-index: 0;\n    min-height:1px;\n    background-color: var(--main_panel_color);\n    color: var(--text_color);\n}\n\n.legend-container {\n    backdrop-filter: blur(1px);\n    padding: 0.4em;\n    transition: backdrop-filter 0.2s ease-in-out;\n    z-index: 2;\n    /* changing var(--background_color) to rgb() didn't help */\n    /* background-color: rgba(var(--background_color), 0.7); */\n}\n.legend-container:hover {\n    backdrop-filter: blur(20px);\n}\n.Dark .legend-container {\n    background-color: rgba(51, 51, 51, 0.3);\n}\n.Light .legend-container {\n    background-color: rgba(186, 186, 186, 0.3);\n}\n\n.row-bar{\n    cursor:pointer;\n}\n\n\n.pie-arc{\n    cursor:pointer;\n}\n\n.row-text{\n    cursor:pointer;\n}\n\n.ciview-button{\n    background: var(--button_color);\n    padding:5px 8px;\n    border-radius:5px;\n    cursor:pointer;\n    color:white;\n    border: 0;\n}\n\n.ciview-button-sm{\n    background: var(--button_color);\n    padding:3px 6px;\n    border-radius:5px;\n    cursor:pointer;\n    color:white;\n    font-size:0.8em;\n    margin: 0px 3px;\n    text-align: center;\n    border: 0;\n}\n\n\n\n.ciview-button-disabled{\n    background: var(--button_color);\n    padding:5px 8px;\n    border-radius:5px;\n    opacity:0.6;\n    color:white;\n    pointer-events:none;\n   \n}\n\n.ciview-disabled{\n    pointer-events:none;\n    opacity:0.6;\n}\n\n\n\n\n.ciview-center{\n    display: flex;\n    justify-content: center;\n    align-items: center;\n}\n\n\n\n\n\n.ciview-title-div{\n    font-size:16px;\n    font-weight:bold;\n    padding:5px;\n}\n\n.ciview-padded-div{\n    padding:4px;\n}\n\n.ciview-main-menu-bar{\n    height:30px;\n    color: var(--text_color);\n    background-color: var(--background_color);\n}\n\n\n\n.ciview-button:hover{\n    box-shadow: 0 2px 5px 0 rgb(0 0 0 / 20%);\n}\n\n.ciview-button-sm:hover{\n    box-shadow: 0 2px 5px 0 rgb(0 0 0 / 20%);\n}\n\n.row-bar:hover{\n    opacity:0.6;\n}\n\n.pie-arc:hover{\n    opacity:0.6;\n}\n\n\n.ciview-info-alert{\n    padding:8px;\n    width:250px;\n    position:absolute;\n    font-size:18px;\n    z-index:5;\n\n}\n.ttt{\n   float:right;\n}\n.ciview-alert-info{\n    color:#155724;\n    background:#d4edda;\n    border: 1px solid #c3e6cb;\n}\n\n.ciview-alert-danger{\n    color:#721c24;\n    background:#f8d7da;\n    border: 1px solid #f5c6cb;\n}\n\n.ciview-alert-warning{\n    color:#856404;\n    background:#fff3cd;\n    border: 1px solid #ffeeba;\n}\n\n\n.civ-dg-div{\n    padding:5px;\n}\n\n.ciview-info-alert-spin{\n    font-size:18px;\n    float:right\n\n}\n\n\n\n.civew-chart-resetbutton{\n    visibility:hidden;\n    \n}\n\n\n\n.ciview-chart-icon{\n    cursor:pointer;\n    margin: 0px 2px;\n}\n\n.annotationDialog h2 {\n    font-weight: 400;\n    line-height: 1.2em;\n}\n\n.annotationDialog ul {\n    list-style: none;\n    display: flex;\n    gap: 0.5em;\n    font-size: small;\n}\n\n.annotationDialog li {\n    padding: 0.4em;\n    border-radius: 0.5em;\n    background-color: var(--button_color);\n}\n\n.annotationDialog .allTagged {\n    \n}\n.annotationDialog .someTagged {\n    filter: saturate(20%);\n}\n\n\n.mdv-image-label {\n    position:absolute;\n    text-align: center;\n}\n/* messes up border color...\n.Dark .mlv-tile-missing {\n    filter: invert();\n} */",""]);const a=s},5175:(t,e,n)=>{"use strict";n.d(e,{Z:()=>W});var i=n(8081),r=n.n(i),o=n(3645),s=n.n(o),a=n(1667),l=n.n(a),c=new URL(n(5258),n.b),u=new URL(n(8073),n.b),h=new URL(n(1293),n.b),d=new URL(n(9710),n.b),f=new URL(n(197),n.b),p=new URL(n(848),n.b),g=new URL(n(6859),n.b),m=new URL(n(4821),n.b),_=new URL(n(5860),n.b),v=new URL(n(7094),n.b),b=new URL(n(6203),n.b),y=new URL(n(8681),n.b),w=new URL(n(1029),n.b),x=new URL(n(142),n.b),C=new URL(n(8498),n.b),k=s()(r()),E=l()(c),S=l()(c,{hash:"?#iefix"}),A=l()(u),T=l()(h),M=l()(d),D=l()(f,{hash:"#fontawesome"}),P=l()(p),L=l()(p,{hash:"?#iefix"}),R=l()(g),I=l()(m),O=l()(_),z=l()(v,{hash:"#fontawesome"}),F=l()(b),B=l()(b,{hash:"?#iefix"}),N=l()(y),j=l()(w),U=l()(x),V=l()(C,{hash:"#fontawesome"});k.push([t.id,'/*!\n * Font Awesome Free 5.15.3 by @fontawesome - https://fontawesome.com\n * License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)\n */\n.fa,.fab,.fad,.fal,.far,.fas{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;display:inline-block;font-style:normal;font-variant:normal;text-rendering:auto;line-height:1}.fa-lg{font-size:1.33333em;line-height:.75em;vertical-align:-.0667em}.fa-xs{font-size:.75em}.fa-sm{font-size:.875em}.fa-1x{font-size:1em}.fa-2x{font-size:2em}.fa-3x{font-size:3em}.fa-4x{font-size:4em}.fa-5x{font-size:5em}.fa-6x{font-size:6em}.fa-7x{font-size:7em}.fa-8x{font-size:8em}.fa-9x{font-size:9em}.fa-10x{font-size:10em}.fa-fw{text-align:center;width:1.25em}.fa-ul{list-style-type:none;margin-left:2.5em;padding-left:0}.fa-ul>li{position:relative}.fa-li{left:-2em;position:absolute;text-align:center;width:2em;line-height:inherit}.fa-border{border:.08em solid #eee;border-radius:.1em;padding:.2em .25em .15em}.fa-pull-left{float:left}.fa-pull-right{float:right}.fa.fa-pull-left,.fab.fa-pull-left,.fal.fa-pull-left,.far.fa-pull-left,.fas.fa-pull-left{margin-right:.3em}.fa.fa-pull-right,.fab.fa-pull-right,.fal.fa-pull-right,.far.fa-pull-right,.fas.fa-pull-right{margin-left:.3em}.fa-spin{-webkit-animation:fa-spin 2s linear infinite;animation:fa-spin 2s linear infinite}.fa-pulse{-webkit-animation:fa-spin 1s steps(8) infinite;animation:fa-spin 1s steps(8) infinite}@-webkit-keyframes fa-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes fa-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}.fa-rotate-90{-ms-filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation=1)";-webkit-transform:rotate(90deg);transform:rotate(90deg)}.fa-rotate-180{-ms-filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation=2)";-webkit-transform:rotate(180deg);transform:rotate(180deg)}.fa-rotate-270{-ms-filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation=3)";-webkit-transform:rotate(270deg);transform:rotate(270deg)}.fa-flip-horizontal{-ms-filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation=0, mirror=1)";-webkit-transform:scaleX(-1);transform:scaleX(-1)}.fa-flip-vertical{-webkit-transform:scaleY(-1);transform:scaleY(-1)}.fa-flip-both,.fa-flip-horizontal.fa-flip-vertical,.fa-flip-vertical{-ms-filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1)"}.fa-flip-both,.fa-flip-horizontal.fa-flip-vertical{-webkit-transform:scale(-1);transform:scale(-1)}:root .fa-flip-both,:root .fa-flip-horizontal,:root .fa-flip-vertical,:root .fa-rotate-90,:root .fa-rotate-180,:root .fa-rotate-270{-webkit-filter:none;filter:none}.fa-stack{display:inline-block;height:2em;line-height:2em;position:relative;vertical-align:middle;width:2.5em}.fa-stack-1x,.fa-stack-2x{left:0;position:absolute;text-align:center;width:100%}.fa-stack-1x{line-height:inherit}.fa-stack-2x{font-size:2em}.fa-inverse{color:#fff}.fa-500px:before{content:"\\f26e"}.fa-accessible-icon:before{content:"\\f368"}.fa-accusoft:before{content:"\\f369"}.fa-acquisitions-incorporated:before{content:"\\f6af"}.fa-ad:before{content:"\\f641"}.fa-address-book:before{content:"\\f2b9"}.fa-address-card:before{content:"\\f2bb"}.fa-adjust:before{content:"\\f042"}.fa-adn:before{content:"\\f170"}.fa-adversal:before{content:"\\f36a"}.fa-affiliatetheme:before{content:"\\f36b"}.fa-air-freshener:before{content:"\\f5d0"}.fa-airbnb:before{content:"\\f834"}.fa-algolia:before{content:"\\f36c"}.fa-align-center:before{content:"\\f037"}.fa-align-justify:before{content:"\\f039"}.fa-align-left:before{content:"\\f036"}.fa-align-right:before{content:"\\f038"}.fa-alipay:before{content:"\\f642"}.fa-allergies:before{content:"\\f461"}.fa-amazon:before{content:"\\f270"}.fa-amazon-pay:before{content:"\\f42c"}.fa-ambulance:before{content:"\\f0f9"}.fa-american-sign-language-interpreting:before{content:"\\f2a3"}.fa-amilia:before{content:"\\f36d"}.fa-anchor:before{content:"\\f13d"}.fa-android:before{content:"\\f17b"}.fa-angellist:before{content:"\\f209"}.fa-angle-double-down:before{content:"\\f103"}.fa-angle-double-left:before{content:"\\f100"}.fa-angle-double-right:before{content:"\\f101"}.fa-angle-double-up:before{content:"\\f102"}.fa-angle-down:before{content:"\\f107"}.fa-angle-left:before{content:"\\f104"}.fa-angle-right:before{content:"\\f105"}.fa-angle-up:before{content:"\\f106"}.fa-angry:before{content:"\\f556"}.fa-angrycreative:before{content:"\\f36e"}.fa-angular:before{content:"\\f420"}.fa-ankh:before{content:"\\f644"}.fa-app-store:before{content:"\\f36f"}.fa-app-store-ios:before{content:"\\f370"}.fa-apper:before{content:"\\f371"}.fa-apple:before{content:"\\f179"}.fa-apple-alt:before{content:"\\f5d1"}.fa-apple-pay:before{content:"\\f415"}.fa-archive:before{content:"\\f187"}.fa-archway:before{content:"\\f557"}.fa-arrow-alt-circle-down:before{content:"\\f358"}.fa-arrow-alt-circle-left:before{content:"\\f359"}.fa-arrow-alt-circle-right:before{content:"\\f35a"}.fa-arrow-alt-circle-up:before{content:"\\f35b"}.fa-arrow-circle-down:before{content:"\\f0ab"}.fa-arrow-circle-left:before{content:"\\f0a8"}.fa-arrow-circle-right:before{content:"\\f0a9"}.fa-arrow-circle-up:before{content:"\\f0aa"}.fa-arrow-down:before{content:"\\f063"}.fa-arrow-left:before{content:"\\f060"}.fa-arrow-right:before{content:"\\f061"}.fa-arrow-up:before{content:"\\f062"}.fa-arrows-alt:before{content:"\\f0b2"}.fa-arrows-alt-h:before{content:"\\f337"}.fa-arrows-alt-v:before{content:"\\f338"}.fa-artstation:before{content:"\\f77a"}.fa-assistive-listening-systems:before{content:"\\f2a2"}.fa-asterisk:before{content:"\\f069"}.fa-asymmetrik:before{content:"\\f372"}.fa-at:before{content:"\\f1fa"}.fa-atlas:before{content:"\\f558"}.fa-atlassian:before{content:"\\f77b"}.fa-atom:before{content:"\\f5d2"}.fa-audible:before{content:"\\f373"}.fa-audio-description:before{content:"\\f29e"}.fa-autoprefixer:before{content:"\\f41c"}.fa-avianex:before{content:"\\f374"}.fa-aviato:before{content:"\\f421"}.fa-award:before{content:"\\f559"}.fa-aws:before{content:"\\f375"}.fa-baby:before{content:"\\f77c"}.fa-baby-carriage:before{content:"\\f77d"}.fa-backspace:before{content:"\\f55a"}.fa-backward:before{content:"\\f04a"}.fa-bacon:before{content:"\\f7e5"}.fa-bacteria:before{content:"\\e059"}.fa-bacterium:before{content:"\\e05a"}.fa-bahai:before{content:"\\f666"}.fa-balance-scale:before{content:"\\f24e"}.fa-balance-scale-left:before{content:"\\f515"}.fa-balance-scale-right:before{content:"\\f516"}.fa-ban:before{content:"\\f05e"}.fa-band-aid:before{content:"\\f462"}.fa-bandcamp:before{content:"\\f2d5"}.fa-barcode:before{content:"\\f02a"}.fa-bars:before{content:"\\f0c9"}.fa-baseball-ball:before{content:"\\f433"}.fa-basketball-ball:before{content:"\\f434"}.fa-bath:before{content:"\\f2cd"}.fa-battery-empty:before{content:"\\f244"}.fa-battery-full:before{content:"\\f240"}.fa-battery-half:before{content:"\\f242"}.fa-battery-quarter:before{content:"\\f243"}.fa-battery-three-quarters:before{content:"\\f241"}.fa-battle-net:before{content:"\\f835"}.fa-bed:before{content:"\\f236"}.fa-beer:before{content:"\\f0fc"}.fa-behance:before{content:"\\f1b4"}.fa-behance-square:before{content:"\\f1b5"}.fa-bell:before{content:"\\f0f3"}.fa-bell-slash:before{content:"\\f1f6"}.fa-bezier-curve:before{content:"\\f55b"}.fa-bible:before{content:"\\f647"}.fa-bicycle:before{content:"\\f206"}.fa-biking:before{content:"\\f84a"}.fa-bimobject:before{content:"\\f378"}.fa-binoculars:before{content:"\\f1e5"}.fa-biohazard:before{content:"\\f780"}.fa-birthday-cake:before{content:"\\f1fd"}.fa-bitbucket:before{content:"\\f171"}.fa-bitcoin:before{content:"\\f379"}.fa-bity:before{content:"\\f37a"}.fa-black-tie:before{content:"\\f27e"}.fa-blackberry:before{content:"\\f37b"}.fa-blender:before{content:"\\f517"}.fa-blender-phone:before{content:"\\f6b6"}.fa-blind:before{content:"\\f29d"}.fa-blog:before{content:"\\f781"}.fa-blogger:before{content:"\\f37c"}.fa-blogger-b:before{content:"\\f37d"}.fa-bluetooth:before{content:"\\f293"}.fa-bluetooth-b:before{content:"\\f294"}.fa-bold:before{content:"\\f032"}.fa-bolt:before{content:"\\f0e7"}.fa-bomb:before{content:"\\f1e2"}.fa-bone:before{content:"\\f5d7"}.fa-bong:before{content:"\\f55c"}.fa-book:before{content:"\\f02d"}.fa-book-dead:before{content:"\\f6b7"}.fa-book-medical:before{content:"\\f7e6"}.fa-book-open:before{content:"\\f518"}.fa-book-reader:before{content:"\\f5da"}.fa-bookmark:before{content:"\\f02e"}.fa-bootstrap:before{content:"\\f836"}.fa-border-all:before{content:"\\f84c"}.fa-border-none:before{content:"\\f850"}.fa-border-style:before{content:"\\f853"}.fa-bowling-ball:before{content:"\\f436"}.fa-box:before{content:"\\f466"}.fa-box-open:before{content:"\\f49e"}.fa-box-tissue:before{content:"\\e05b"}.fa-boxes:before{content:"\\f468"}.fa-braille:before{content:"\\f2a1"}.fa-brain:before{content:"\\f5dc"}.fa-bread-slice:before{content:"\\f7ec"}.fa-briefcase:before{content:"\\f0b1"}.fa-briefcase-medical:before{content:"\\f469"}.fa-broadcast-tower:before{content:"\\f519"}.fa-broom:before{content:"\\f51a"}.fa-brush:before{content:"\\f55d"}.fa-btc:before{content:"\\f15a"}.fa-buffer:before{content:"\\f837"}.fa-bug:before{content:"\\f188"}.fa-building:before{content:"\\f1ad"}.fa-bullhorn:before{content:"\\f0a1"}.fa-bullseye:before{content:"\\f140"}.fa-burn:before{content:"\\f46a"}.fa-buromobelexperte:before{content:"\\f37f"}.fa-bus:before{content:"\\f207"}.fa-bus-alt:before{content:"\\f55e"}.fa-business-time:before{content:"\\f64a"}.fa-buy-n-large:before{content:"\\f8a6"}.fa-buysellads:before{content:"\\f20d"}.fa-calculator:before{content:"\\f1ec"}.fa-calendar:before{content:"\\f133"}.fa-calendar-alt:before{content:"\\f073"}.fa-calendar-check:before{content:"\\f274"}.fa-calendar-day:before{content:"\\f783"}.fa-calendar-minus:before{content:"\\f272"}.fa-calendar-plus:before{content:"\\f271"}.fa-calendar-times:before{content:"\\f273"}.fa-calendar-week:before{content:"\\f784"}.fa-camera:before{content:"\\f030"}.fa-camera-retro:before{content:"\\f083"}.fa-campground:before{content:"\\f6bb"}.fa-canadian-maple-leaf:before{content:"\\f785"}.fa-candy-cane:before{content:"\\f786"}.fa-cannabis:before{content:"\\f55f"}.fa-capsules:before{content:"\\f46b"}.fa-car:before{content:"\\f1b9"}.fa-car-alt:before{content:"\\f5de"}.fa-car-battery:before{content:"\\f5df"}.fa-car-crash:before{content:"\\f5e1"}.fa-car-side:before{content:"\\f5e4"}.fa-caravan:before{content:"\\f8ff"}.fa-caret-down:before{content:"\\f0d7"}.fa-caret-left:before{content:"\\f0d9"}.fa-caret-right:before{content:"\\f0da"}.fa-caret-square-down:before{content:"\\f150"}.fa-caret-square-left:before{content:"\\f191"}.fa-caret-square-right:before{content:"\\f152"}.fa-caret-square-up:before{content:"\\f151"}.fa-caret-up:before{content:"\\f0d8"}.fa-carrot:before{content:"\\f787"}.fa-cart-arrow-down:before{content:"\\f218"}.fa-cart-plus:before{content:"\\f217"}.fa-cash-register:before{content:"\\f788"}.fa-cat:before{content:"\\f6be"}.fa-cc-amazon-pay:before{content:"\\f42d"}.fa-cc-amex:before{content:"\\f1f3"}.fa-cc-apple-pay:before{content:"\\f416"}.fa-cc-diners-club:before{content:"\\f24c"}.fa-cc-discover:before{content:"\\f1f2"}.fa-cc-jcb:before{content:"\\f24b"}.fa-cc-mastercard:before{content:"\\f1f1"}.fa-cc-paypal:before{content:"\\f1f4"}.fa-cc-stripe:before{content:"\\f1f5"}.fa-cc-visa:before{content:"\\f1f0"}.fa-centercode:before{content:"\\f380"}.fa-centos:before{content:"\\f789"}.fa-certificate:before{content:"\\f0a3"}.fa-chair:before{content:"\\f6c0"}.fa-chalkboard:before{content:"\\f51b"}.fa-chalkboard-teacher:before{content:"\\f51c"}.fa-charging-station:before{content:"\\f5e7"}.fa-chart-area:before{content:"\\f1fe"}.fa-chart-bar:before{content:"\\f080"}.fa-chart-line:before{content:"\\f201"}.fa-chart-pie:before{content:"\\f200"}.fa-check:before{content:"\\f00c"}.fa-check-circle:before{content:"\\f058"}.fa-check-double:before{content:"\\f560"}.fa-check-square:before{content:"\\f14a"}.fa-cheese:before{content:"\\f7ef"}.fa-chess:before{content:"\\f439"}.fa-chess-bishop:before{content:"\\f43a"}.fa-chess-board:before{content:"\\f43c"}.fa-chess-king:before{content:"\\f43f"}.fa-chess-knight:before{content:"\\f441"}.fa-chess-pawn:before{content:"\\f443"}.fa-chess-queen:before{content:"\\f445"}.fa-chess-rook:before{content:"\\f447"}.fa-chevron-circle-down:before{content:"\\f13a"}.fa-chevron-circle-left:before{content:"\\f137"}.fa-chevron-circle-right:before{content:"\\f138"}.fa-chevron-circle-up:before{content:"\\f139"}.fa-chevron-down:before{content:"\\f078"}.fa-chevron-left:before{content:"\\f053"}.fa-chevron-right:before{content:"\\f054"}.fa-chevron-up:before{content:"\\f077"}.fa-child:before{content:"\\f1ae"}.fa-chrome:before{content:"\\f268"}.fa-chromecast:before{content:"\\f838"}.fa-church:before{content:"\\f51d"}.fa-circle:before{content:"\\f111"}.fa-circle-notch:before{content:"\\f1ce"}.fa-city:before{content:"\\f64f"}.fa-clinic-medical:before{content:"\\f7f2"}.fa-clipboard:before{content:"\\f328"}.fa-clipboard-check:before{content:"\\f46c"}.fa-clipboard-list:before{content:"\\f46d"}.fa-clock:before{content:"\\f017"}.fa-clone:before{content:"\\f24d"}.fa-closed-captioning:before{content:"\\f20a"}.fa-cloud:before{content:"\\f0c2"}.fa-cloud-download-alt:before{content:"\\f381"}.fa-cloud-meatball:before{content:"\\f73b"}.fa-cloud-moon:before{content:"\\f6c3"}.fa-cloud-moon-rain:before{content:"\\f73c"}.fa-cloud-rain:before{content:"\\f73d"}.fa-cloud-showers-heavy:before{content:"\\f740"}.fa-cloud-sun:before{content:"\\f6c4"}.fa-cloud-sun-rain:before{content:"\\f743"}.fa-cloud-upload-alt:before{content:"\\f382"}.fa-cloudflare:before{content:"\\e07d"}.fa-cloudscale:before{content:"\\f383"}.fa-cloudsmith:before{content:"\\f384"}.fa-cloudversify:before{content:"\\f385"}.fa-cocktail:before{content:"\\f561"}.fa-code:before{content:"\\f121"}.fa-code-branch:before{content:"\\f126"}.fa-codepen:before{content:"\\f1cb"}.fa-codiepie:before{content:"\\f284"}.fa-coffee:before{content:"\\f0f4"}.fa-cog:before{content:"\\f013"}.fa-cogs:before{content:"\\f085"}.fa-coins:before{content:"\\f51e"}.fa-columns:before{content:"\\f0db"}.fa-comment:before{content:"\\f075"}.fa-comment-alt:before{content:"\\f27a"}.fa-comment-dollar:before{content:"\\f651"}.fa-comment-dots:before{content:"\\f4ad"}.fa-comment-medical:before{content:"\\f7f5"}.fa-comment-slash:before{content:"\\f4b3"}.fa-comments:before{content:"\\f086"}.fa-comments-dollar:before{content:"\\f653"}.fa-compact-disc:before{content:"\\f51f"}.fa-compass:before{content:"\\f14e"}.fa-compress:before{content:"\\f066"}.fa-compress-alt:before{content:"\\f422"}.fa-compress-arrows-alt:before{content:"\\f78c"}.fa-concierge-bell:before{content:"\\f562"}.fa-confluence:before{content:"\\f78d"}.fa-connectdevelop:before{content:"\\f20e"}.fa-contao:before{content:"\\f26d"}.fa-cookie:before{content:"\\f563"}.fa-cookie-bite:before{content:"\\f564"}.fa-copy:before{content:"\\f0c5"}.fa-copyright:before{content:"\\f1f9"}.fa-cotton-bureau:before{content:"\\f89e"}.fa-couch:before{content:"\\f4b8"}.fa-cpanel:before{content:"\\f388"}.fa-creative-commons:before{content:"\\f25e"}.fa-creative-commons-by:before{content:"\\f4e7"}.fa-creative-commons-nc:before{content:"\\f4e8"}.fa-creative-commons-nc-eu:before{content:"\\f4e9"}.fa-creative-commons-nc-jp:before{content:"\\f4ea"}.fa-creative-commons-nd:before{content:"\\f4eb"}.fa-creative-commons-pd:before{content:"\\f4ec"}.fa-creative-commons-pd-alt:before{content:"\\f4ed"}.fa-creative-commons-remix:before{content:"\\f4ee"}.fa-creative-commons-sa:before{content:"\\f4ef"}.fa-creative-commons-sampling:before{content:"\\f4f0"}.fa-creative-commons-sampling-plus:before{content:"\\f4f1"}.fa-creative-commons-share:before{content:"\\f4f2"}.fa-creative-commons-zero:before{content:"\\f4f3"}.fa-credit-card:before{content:"\\f09d"}.fa-critical-role:before{content:"\\f6c9"}.fa-crop:before{content:"\\f125"}.fa-crop-alt:before{content:"\\f565"}.fa-cross:before{content:"\\f654"}.fa-crosshairs:before{content:"\\f05b"}.fa-crow:before{content:"\\f520"}.fa-crown:before{content:"\\f521"}.fa-crutch:before{content:"\\f7f7"}.fa-css3:before{content:"\\f13c"}.fa-css3-alt:before{content:"\\f38b"}.fa-cube:before{content:"\\f1b2"}.fa-cubes:before{content:"\\f1b3"}.fa-cut:before{content:"\\f0c4"}.fa-cuttlefish:before{content:"\\f38c"}.fa-d-and-d:before{content:"\\f38d"}.fa-d-and-d-beyond:before{content:"\\f6ca"}.fa-dailymotion:before{content:"\\e052"}.fa-dashcube:before{content:"\\f210"}.fa-database:before{content:"\\f1c0"}.fa-deaf:before{content:"\\f2a4"}.fa-deezer:before{content:"\\e077"}.fa-delicious:before{content:"\\f1a5"}.fa-democrat:before{content:"\\f747"}.fa-deploydog:before{content:"\\f38e"}.fa-deskpro:before{content:"\\f38f"}.fa-desktop:before{content:"\\f108"}.fa-dev:before{content:"\\f6cc"}.fa-deviantart:before{content:"\\f1bd"}.fa-dharmachakra:before{content:"\\f655"}.fa-dhl:before{content:"\\f790"}.fa-diagnoses:before{content:"\\f470"}.fa-diaspora:before{content:"\\f791"}.fa-dice:before{content:"\\f522"}.fa-dice-d20:before{content:"\\f6cf"}.fa-dice-d6:before{content:"\\f6d1"}.fa-dice-five:before{content:"\\f523"}.fa-dice-four:before{content:"\\f524"}.fa-dice-one:before{content:"\\f525"}.fa-dice-six:before{content:"\\f526"}.fa-dice-three:before{content:"\\f527"}.fa-dice-two:before{content:"\\f528"}.fa-digg:before{content:"\\f1a6"}.fa-digital-ocean:before{content:"\\f391"}.fa-digital-tachograph:before{content:"\\f566"}.fa-directions:before{content:"\\f5eb"}.fa-discord:before{content:"\\f392"}.fa-discourse:before{content:"\\f393"}.fa-disease:before{content:"\\f7fa"}.fa-divide:before{content:"\\f529"}.fa-dizzy:before{content:"\\f567"}.fa-dna:before{content:"\\f471"}.fa-dochub:before{content:"\\f394"}.fa-docker:before{content:"\\f395"}.fa-dog:before{content:"\\f6d3"}.fa-dollar-sign:before{content:"\\f155"}.fa-dolly:before{content:"\\f472"}.fa-dolly-flatbed:before{content:"\\f474"}.fa-donate:before{content:"\\f4b9"}.fa-door-closed:before{content:"\\f52a"}.fa-door-open:before{content:"\\f52b"}.fa-dot-circle:before{content:"\\f192"}.fa-dove:before{content:"\\f4ba"}.fa-download:before{content:"\\f019"}.fa-draft2digital:before{content:"\\f396"}.fa-drafting-compass:before{content:"\\f568"}.fa-dragon:before{content:"\\f6d5"}.fa-draw-polygon:before{content:"\\f5ee"}.fa-dribbble:before{content:"\\f17d"}.fa-dribbble-square:before{content:"\\f397"}.fa-dropbox:before{content:"\\f16b"}.fa-drum:before{content:"\\f569"}.fa-drum-steelpan:before{content:"\\f56a"}.fa-drumstick-bite:before{content:"\\f6d7"}.fa-drupal:before{content:"\\f1a9"}.fa-dumbbell:before{content:"\\f44b"}.fa-dumpster:before{content:"\\f793"}.fa-dumpster-fire:before{content:"\\f794"}.fa-dungeon:before{content:"\\f6d9"}.fa-dyalog:before{content:"\\f399"}.fa-earlybirds:before{content:"\\f39a"}.fa-ebay:before{content:"\\f4f4"}.fa-edge:before{content:"\\f282"}.fa-edge-legacy:before{content:"\\e078"}.fa-edit:before{content:"\\f044"}.fa-egg:before{content:"\\f7fb"}.fa-eject:before{content:"\\f052"}.fa-elementor:before{content:"\\f430"}.fa-ellipsis-h:before{content:"\\f141"}.fa-ellipsis-v:before{content:"\\f142"}.fa-ello:before{content:"\\f5f1"}.fa-ember:before{content:"\\f423"}.fa-empire:before{content:"\\f1d1"}.fa-envelope:before{content:"\\f0e0"}.fa-envelope-open:before{content:"\\f2b6"}.fa-envelope-open-text:before{content:"\\f658"}.fa-envelope-square:before{content:"\\f199"}.fa-envira:before{content:"\\f299"}.fa-equals:before{content:"\\f52c"}.fa-eraser:before{content:"\\f12d"}.fa-erlang:before{content:"\\f39d"}.fa-ethereum:before{content:"\\f42e"}.fa-ethernet:before{content:"\\f796"}.fa-etsy:before{content:"\\f2d7"}.fa-euro-sign:before{content:"\\f153"}.fa-evernote:before{content:"\\f839"}.fa-exchange-alt:before{content:"\\f362"}.fa-exclamation:before{content:"\\f12a"}.fa-exclamation-circle:before{content:"\\f06a"}.fa-exclamation-triangle:before{content:"\\f071"}.fa-expand:before{content:"\\f065"}.fa-expand-alt:before{content:"\\f424"}.fa-expand-arrows-alt:before{content:"\\f31e"}.fa-expeditedssl:before{content:"\\f23e"}.fa-external-link-alt:before{content:"\\f35d"}.fa-external-link-square-alt:before{content:"\\f360"}.fa-eye:before{content:"\\f06e"}.fa-eye-dropper:before{content:"\\f1fb"}.fa-eye-slash:before{content:"\\f070"}.fa-facebook:before{content:"\\f09a"}.fa-facebook-f:before{content:"\\f39e"}.fa-facebook-messenger:before{content:"\\f39f"}.fa-facebook-square:before{content:"\\f082"}.fa-fan:before{content:"\\f863"}.fa-fantasy-flight-games:before{content:"\\f6dc"}.fa-fast-backward:before{content:"\\f049"}.fa-fast-forward:before{content:"\\f050"}.fa-faucet:before{content:"\\e005"}.fa-fax:before{content:"\\f1ac"}.fa-feather:before{content:"\\f52d"}.fa-feather-alt:before{content:"\\f56b"}.fa-fedex:before{content:"\\f797"}.fa-fedora:before{content:"\\f798"}.fa-female:before{content:"\\f182"}.fa-fighter-jet:before{content:"\\f0fb"}.fa-figma:before{content:"\\f799"}.fa-file:before{content:"\\f15b"}.fa-file-alt:before{content:"\\f15c"}.fa-file-archive:before{content:"\\f1c6"}.fa-file-audio:before{content:"\\f1c7"}.fa-file-code:before{content:"\\f1c9"}.fa-file-contract:before{content:"\\f56c"}.fa-file-csv:before{content:"\\f6dd"}.fa-file-download:before{content:"\\f56d"}.fa-file-excel:before{content:"\\f1c3"}.fa-file-export:before{content:"\\f56e"}.fa-file-image:before{content:"\\f1c5"}.fa-file-import:before{content:"\\f56f"}.fa-file-invoice:before{content:"\\f570"}.fa-file-invoice-dollar:before{content:"\\f571"}.fa-file-medical:before{content:"\\f477"}.fa-file-medical-alt:before{content:"\\f478"}.fa-file-pdf:before{content:"\\f1c1"}.fa-file-powerpoint:before{content:"\\f1c4"}.fa-file-prescription:before{content:"\\f572"}.fa-file-signature:before{content:"\\f573"}.fa-file-upload:before{content:"\\f574"}.fa-file-video:before{content:"\\f1c8"}.fa-file-word:before{content:"\\f1c2"}.fa-fill:before{content:"\\f575"}.fa-fill-drip:before{content:"\\f576"}.fa-film:before{content:"\\f008"}.fa-filter:before{content:"\\f0b0"}.fa-fingerprint:before{content:"\\f577"}.fa-fire:before{content:"\\f06d"}.fa-fire-alt:before{content:"\\f7e4"}.fa-fire-extinguisher:before{content:"\\f134"}.fa-firefox:before{content:"\\f269"}.fa-firefox-browser:before{content:"\\e007"}.fa-first-aid:before{content:"\\f479"}.fa-first-order:before{content:"\\f2b0"}.fa-first-order-alt:before{content:"\\f50a"}.fa-firstdraft:before{content:"\\f3a1"}.fa-fish:before{content:"\\f578"}.fa-fist-raised:before{content:"\\f6de"}.fa-flag:before{content:"\\f024"}.fa-flag-checkered:before{content:"\\f11e"}.fa-flag-usa:before{content:"\\f74d"}.fa-flask:before{content:"\\f0c3"}.fa-flickr:before{content:"\\f16e"}.fa-flipboard:before{content:"\\f44d"}.fa-flushed:before{content:"\\f579"}.fa-fly:before{content:"\\f417"}.fa-folder:before{content:"\\f07b"}.fa-folder-minus:before{content:"\\f65d"}.fa-folder-open:before{content:"\\f07c"}.fa-folder-plus:before{content:"\\f65e"}.fa-font:before{content:"\\f031"}.fa-font-awesome:before{content:"\\f2b4"}.fa-font-awesome-alt:before{content:"\\f35c"}.fa-font-awesome-flag:before{content:"\\f425"}.fa-font-awesome-logo-full:before{content:"\\f4e6"}.fa-fonticons:before{content:"\\f280"}.fa-fonticons-fi:before{content:"\\f3a2"}.fa-football-ball:before{content:"\\f44e"}.fa-fort-awesome:before{content:"\\f286"}.fa-fort-awesome-alt:before{content:"\\f3a3"}.fa-forumbee:before{content:"\\f211"}.fa-forward:before{content:"\\f04e"}.fa-foursquare:before{content:"\\f180"}.fa-free-code-camp:before{content:"\\f2c5"}.fa-freebsd:before{content:"\\f3a4"}.fa-frog:before{content:"\\f52e"}.fa-frown:before{content:"\\f119"}.fa-frown-open:before{content:"\\f57a"}.fa-fulcrum:before{content:"\\f50b"}.fa-funnel-dollar:before{content:"\\f662"}.fa-futbol:before{content:"\\f1e3"}.fa-galactic-republic:before{content:"\\f50c"}.fa-galactic-senate:before{content:"\\f50d"}.fa-gamepad:before{content:"\\f11b"}.fa-gas-pump:before{content:"\\f52f"}.fa-gavel:before{content:"\\f0e3"}.fa-gem:before{content:"\\f3a5"}.fa-genderless:before{content:"\\f22d"}.fa-get-pocket:before{content:"\\f265"}.fa-gg:before{content:"\\f260"}.fa-gg-circle:before{content:"\\f261"}.fa-ghost:before{content:"\\f6e2"}.fa-gift:before{content:"\\f06b"}.fa-gifts:before{content:"\\f79c"}.fa-git:before{content:"\\f1d3"}.fa-git-alt:before{content:"\\f841"}.fa-git-square:before{content:"\\f1d2"}.fa-github:before{content:"\\f09b"}.fa-github-alt:before{content:"\\f113"}.fa-github-square:before{content:"\\f092"}.fa-gitkraken:before{content:"\\f3a6"}.fa-gitlab:before{content:"\\f296"}.fa-gitter:before{content:"\\f426"}.fa-glass-cheers:before{content:"\\f79f"}.fa-glass-martini:before{content:"\\f000"}.fa-glass-martini-alt:before{content:"\\f57b"}.fa-glass-whiskey:before{content:"\\f7a0"}.fa-glasses:before{content:"\\f530"}.fa-glide:before{content:"\\f2a5"}.fa-glide-g:before{content:"\\f2a6"}.fa-globe:before{content:"\\f0ac"}.fa-globe-africa:before{content:"\\f57c"}.fa-globe-americas:before{content:"\\f57d"}.fa-globe-asia:before{content:"\\f57e"}.fa-globe-europe:before{content:"\\f7a2"}.fa-gofore:before{content:"\\f3a7"}.fa-golf-ball:before{content:"\\f450"}.fa-goodreads:before{content:"\\f3a8"}.fa-goodreads-g:before{content:"\\f3a9"}.fa-google:before{content:"\\f1a0"}.fa-google-drive:before{content:"\\f3aa"}.fa-google-pay:before{content:"\\e079"}.fa-google-play:before{content:"\\f3ab"}.fa-google-plus:before{content:"\\f2b3"}.fa-google-plus-g:before{content:"\\f0d5"}.fa-google-plus-square:before{content:"\\f0d4"}.fa-google-wallet:before{content:"\\f1ee"}.fa-gopuram:before{content:"\\f664"}.fa-graduation-cap:before{content:"\\f19d"}.fa-gratipay:before{content:"\\f184"}.fa-grav:before{content:"\\f2d6"}.fa-greater-than:before{content:"\\f531"}.fa-greater-than-equal:before{content:"\\f532"}.fa-grimace:before{content:"\\f57f"}.fa-grin:before{content:"\\f580"}.fa-grin-alt:before{content:"\\f581"}.fa-grin-beam:before{content:"\\f582"}.fa-grin-beam-sweat:before{content:"\\f583"}.fa-grin-hearts:before{content:"\\f584"}.fa-grin-squint:before{content:"\\f585"}.fa-grin-squint-tears:before{content:"\\f586"}.fa-grin-stars:before{content:"\\f587"}.fa-grin-tears:before{content:"\\f588"}.fa-grin-tongue:before{content:"\\f589"}.fa-grin-tongue-squint:before{content:"\\f58a"}.fa-grin-tongue-wink:before{content:"\\f58b"}.fa-grin-wink:before{content:"\\f58c"}.fa-grip-horizontal:before{content:"\\f58d"}.fa-grip-lines:before{content:"\\f7a4"}.fa-grip-lines-vertical:before{content:"\\f7a5"}.fa-grip-vertical:before{content:"\\f58e"}.fa-gripfire:before{content:"\\f3ac"}.fa-grunt:before{content:"\\f3ad"}.fa-guilded:before{content:"\\e07e"}.fa-guitar:before{content:"\\f7a6"}.fa-gulp:before{content:"\\f3ae"}.fa-h-square:before{content:"\\f0fd"}.fa-hacker-news:before{content:"\\f1d4"}.fa-hacker-news-square:before{content:"\\f3af"}.fa-hackerrank:before{content:"\\f5f7"}.fa-hamburger:before{content:"\\f805"}.fa-hammer:before{content:"\\f6e3"}.fa-hamsa:before{content:"\\f665"}.fa-hand-holding:before{content:"\\f4bd"}.fa-hand-holding-heart:before{content:"\\f4be"}.fa-hand-holding-medical:before{content:"\\e05c"}.fa-hand-holding-usd:before{content:"\\f4c0"}.fa-hand-holding-water:before{content:"\\f4c1"}.fa-hand-lizard:before{content:"\\f258"}.fa-hand-middle-finger:before{content:"\\f806"}.fa-hand-paper:before{content:"\\f256"}.fa-hand-peace:before{content:"\\f25b"}.fa-hand-point-down:before{content:"\\f0a7"}.fa-hand-point-left:before{content:"\\f0a5"}.fa-hand-point-right:before{content:"\\f0a4"}.fa-hand-point-up:before{content:"\\f0a6"}.fa-hand-pointer:before{content:"\\f25a"}.fa-hand-rock:before{content:"\\f255"}.fa-hand-scissors:before{content:"\\f257"}.fa-hand-sparkles:before{content:"\\e05d"}.fa-hand-spock:before{content:"\\f259"}.fa-hands:before{content:"\\f4c2"}.fa-hands-helping:before{content:"\\f4c4"}.fa-hands-wash:before{content:"\\e05e"}.fa-handshake:before{content:"\\f2b5"}.fa-handshake-alt-slash:before{content:"\\e05f"}.fa-handshake-slash:before{content:"\\e060"}.fa-hanukiah:before{content:"\\f6e6"}.fa-hard-hat:before{content:"\\f807"}.fa-hashtag:before{content:"\\f292"}.fa-hat-cowboy:before{content:"\\f8c0"}.fa-hat-cowboy-side:before{content:"\\f8c1"}.fa-hat-wizard:before{content:"\\f6e8"}.fa-hdd:before{content:"\\f0a0"}.fa-head-side-cough:before{content:"\\e061"}.fa-head-side-cough-slash:before{content:"\\e062"}.fa-head-side-mask:before{content:"\\e063"}.fa-head-side-virus:before{content:"\\e064"}.fa-heading:before{content:"\\f1dc"}.fa-headphones:before{content:"\\f025"}.fa-headphones-alt:before{content:"\\f58f"}.fa-headset:before{content:"\\f590"}.fa-heart:before{content:"\\f004"}.fa-heart-broken:before{content:"\\f7a9"}.fa-heartbeat:before{content:"\\f21e"}.fa-helicopter:before{content:"\\f533"}.fa-highlighter:before{content:"\\f591"}.fa-hiking:before{content:"\\f6ec"}.fa-hippo:before{content:"\\f6ed"}.fa-hips:before{content:"\\f452"}.fa-hire-a-helper:before{content:"\\f3b0"}.fa-history:before{content:"\\f1da"}.fa-hive:before{content:"\\e07f"}.fa-hockey-puck:before{content:"\\f453"}.fa-holly-berry:before{content:"\\f7aa"}.fa-home:before{content:"\\f015"}.fa-hooli:before{content:"\\f427"}.fa-hornbill:before{content:"\\f592"}.fa-horse:before{content:"\\f6f0"}.fa-horse-head:before{content:"\\f7ab"}.fa-hospital:before{content:"\\f0f8"}.fa-hospital-alt:before{content:"\\f47d"}.fa-hospital-symbol:before{content:"\\f47e"}.fa-hospital-user:before{content:"\\f80d"}.fa-hot-tub:before{content:"\\f593"}.fa-hotdog:before{content:"\\f80f"}.fa-hotel:before{content:"\\f594"}.fa-hotjar:before{content:"\\f3b1"}.fa-hourglass:before{content:"\\f254"}.fa-hourglass-end:before{content:"\\f253"}.fa-hourglass-half:before{content:"\\f252"}.fa-hourglass-start:before{content:"\\f251"}.fa-house-damage:before{content:"\\f6f1"}.fa-house-user:before{content:"\\e065"}.fa-houzz:before{content:"\\f27c"}.fa-hryvnia:before{content:"\\f6f2"}.fa-html5:before{content:"\\f13b"}.fa-hubspot:before{content:"\\f3b2"}.fa-i-cursor:before{content:"\\f246"}.fa-ice-cream:before{content:"\\f810"}.fa-icicles:before{content:"\\f7ad"}.fa-icons:before{content:"\\f86d"}.fa-id-badge:before{content:"\\f2c1"}.fa-id-card:before{content:"\\f2c2"}.fa-id-card-alt:before{content:"\\f47f"}.fa-ideal:before{content:"\\e013"}.fa-igloo:before{content:"\\f7ae"}.fa-image:before{content:"\\f03e"}.fa-images:before{content:"\\f302"}.fa-imdb:before{content:"\\f2d8"}.fa-inbox:before{content:"\\f01c"}.fa-indent:before{content:"\\f03c"}.fa-industry:before{content:"\\f275"}.fa-infinity:before{content:"\\f534"}.fa-info:before{content:"\\f129"}.fa-info-circle:before{content:"\\f05a"}.fa-innosoft:before{content:"\\e080"}.fa-instagram:before{content:"\\f16d"}.fa-instagram-square:before{content:"\\e055"}.fa-instalod:before{content:"\\e081"}.fa-intercom:before{content:"\\f7af"}.fa-internet-explorer:before{content:"\\f26b"}.fa-invision:before{content:"\\f7b0"}.fa-ioxhost:before{content:"\\f208"}.fa-italic:before{content:"\\f033"}.fa-itch-io:before{content:"\\f83a"}.fa-itunes:before{content:"\\f3b4"}.fa-itunes-note:before{content:"\\f3b5"}.fa-java:before{content:"\\f4e4"}.fa-jedi:before{content:"\\f669"}.fa-jedi-order:before{content:"\\f50e"}.fa-jenkins:before{content:"\\f3b6"}.fa-jira:before{content:"\\f7b1"}.fa-joget:before{content:"\\f3b7"}.fa-joint:before{content:"\\f595"}.fa-joomla:before{content:"\\f1aa"}.fa-journal-whills:before{content:"\\f66a"}.fa-js:before{content:"\\f3b8"}.fa-js-square:before{content:"\\f3b9"}.fa-jsfiddle:before{content:"\\f1cc"}.fa-kaaba:before{content:"\\f66b"}.fa-kaggle:before{content:"\\f5fa"}.fa-key:before{content:"\\f084"}.fa-keybase:before{content:"\\f4f5"}.fa-keyboard:before{content:"\\f11c"}.fa-keycdn:before{content:"\\f3ba"}.fa-khanda:before{content:"\\f66d"}.fa-kickstarter:before{content:"\\f3bb"}.fa-kickstarter-k:before{content:"\\f3bc"}.fa-kiss:before{content:"\\f596"}.fa-kiss-beam:before{content:"\\f597"}.fa-kiss-wink-heart:before{content:"\\f598"}.fa-kiwi-bird:before{content:"\\f535"}.fa-korvue:before{content:"\\f42f"}.fa-landmark:before{content:"\\f66f"}.fa-language:before{content:"\\f1ab"}.fa-laptop:before{content:"\\f109"}.fa-laptop-code:before{content:"\\f5fc"}.fa-laptop-house:before{content:"\\e066"}.fa-laptop-medical:before{content:"\\f812"}.fa-laravel:before{content:"\\f3bd"}.fa-lastfm:before{content:"\\f202"}.fa-lastfm-square:before{content:"\\f203"}.fa-laugh:before{content:"\\f599"}.fa-laugh-beam:before{content:"\\f59a"}.fa-laugh-squint:before{content:"\\f59b"}.fa-laugh-wink:before{content:"\\f59c"}.fa-layer-group:before{content:"\\f5fd"}.fa-leaf:before{content:"\\f06c"}.fa-leanpub:before{content:"\\f212"}.fa-lemon:before{content:"\\f094"}.fa-less:before{content:"\\f41d"}.fa-less-than:before{content:"\\f536"}.fa-less-than-equal:before{content:"\\f537"}.fa-level-down-alt:before{content:"\\f3be"}.fa-level-up-alt:before{content:"\\f3bf"}.fa-life-ring:before{content:"\\f1cd"}.fa-lightbulb:before{content:"\\f0eb"}.fa-line:before{content:"\\f3c0"}.fa-link:before{content:"\\f0c1"}.fa-linkedin:before{content:"\\f08c"}.fa-linkedin-in:before{content:"\\f0e1"}.fa-linode:before{content:"\\f2b8"}.fa-linux:before{content:"\\f17c"}.fa-lira-sign:before{content:"\\f195"}.fa-list:before{content:"\\f03a"}.fa-list-alt:before{content:"\\f022"}.fa-list-ol:before{content:"\\f0cb"}.fa-list-ul:before{content:"\\f0ca"}.fa-location-arrow:before{content:"\\f124"}.fa-lock:before{content:"\\f023"}.fa-lock-open:before{content:"\\f3c1"}.fa-long-arrow-alt-down:before{content:"\\f309"}.fa-long-arrow-alt-left:before{content:"\\f30a"}.fa-long-arrow-alt-right:before{content:"\\f30b"}.fa-long-arrow-alt-up:before{content:"\\f30c"}.fa-low-vision:before{content:"\\f2a8"}.fa-luggage-cart:before{content:"\\f59d"}.fa-lungs:before{content:"\\f604"}.fa-lungs-virus:before{content:"\\e067"}.fa-lyft:before{content:"\\f3c3"}.fa-magento:before{content:"\\f3c4"}.fa-magic:before{content:"\\f0d0"}.fa-magnet:before{content:"\\f076"}.fa-mail-bulk:before{content:"\\f674"}.fa-mailchimp:before{content:"\\f59e"}.fa-male:before{content:"\\f183"}.fa-mandalorian:before{content:"\\f50f"}.fa-map:before{content:"\\f279"}.fa-map-marked:before{content:"\\f59f"}.fa-map-marked-alt:before{content:"\\f5a0"}.fa-map-marker:before{content:"\\f041"}.fa-map-marker-alt:before{content:"\\f3c5"}.fa-map-pin:before{content:"\\f276"}.fa-map-signs:before{content:"\\f277"}.fa-markdown:before{content:"\\f60f"}.fa-marker:before{content:"\\f5a1"}.fa-mars:before{content:"\\f222"}.fa-mars-double:before{content:"\\f227"}.fa-mars-stroke:before{content:"\\f229"}.fa-mars-stroke-h:before{content:"\\f22b"}.fa-mars-stroke-v:before{content:"\\f22a"}.fa-mask:before{content:"\\f6fa"}.fa-mastodon:before{content:"\\f4f6"}.fa-maxcdn:before{content:"\\f136"}.fa-mdb:before{content:"\\f8ca"}.fa-medal:before{content:"\\f5a2"}.fa-medapps:before{content:"\\f3c6"}.fa-medium:before{content:"\\f23a"}.fa-medium-m:before{content:"\\f3c7"}.fa-medkit:before{content:"\\f0fa"}.fa-medrt:before{content:"\\f3c8"}.fa-meetup:before{content:"\\f2e0"}.fa-megaport:before{content:"\\f5a3"}.fa-meh:before{content:"\\f11a"}.fa-meh-blank:before{content:"\\f5a4"}.fa-meh-rolling-eyes:before{content:"\\f5a5"}.fa-memory:before{content:"\\f538"}.fa-mendeley:before{content:"\\f7b3"}.fa-menorah:before{content:"\\f676"}.fa-mercury:before{content:"\\f223"}.fa-meteor:before{content:"\\f753"}.fa-microblog:before{content:"\\e01a"}.fa-microchip:before{content:"\\f2db"}.fa-microphone:before{content:"\\f130"}.fa-microphone-alt:before{content:"\\f3c9"}.fa-microphone-alt-slash:before{content:"\\f539"}.fa-microphone-slash:before{content:"\\f131"}.fa-microscope:before{content:"\\f610"}.fa-microsoft:before{content:"\\f3ca"}.fa-minus:before{content:"\\f068"}.fa-minus-circle:before{content:"\\f056"}.fa-minus-square:before{content:"\\f146"}.fa-mitten:before{content:"\\f7b5"}.fa-mix:before{content:"\\f3cb"}.fa-mixcloud:before{content:"\\f289"}.fa-mixer:before{content:"\\e056"}.fa-mizuni:before{content:"\\f3cc"}.fa-mobile:before{content:"\\f10b"}.fa-mobile-alt:before{content:"\\f3cd"}.fa-modx:before{content:"\\f285"}.fa-monero:before{content:"\\f3d0"}.fa-money-bill:before{content:"\\f0d6"}.fa-money-bill-alt:before{content:"\\f3d1"}.fa-money-bill-wave:before{content:"\\f53a"}.fa-money-bill-wave-alt:before{content:"\\f53b"}.fa-money-check:before{content:"\\f53c"}.fa-money-check-alt:before{content:"\\f53d"}.fa-monument:before{content:"\\f5a6"}.fa-moon:before{content:"\\f186"}.fa-mortar-pestle:before{content:"\\f5a7"}.fa-mosque:before{content:"\\f678"}.fa-motorcycle:before{content:"\\f21c"}.fa-mountain:before{content:"\\f6fc"}.fa-mouse:before{content:"\\f8cc"}.fa-mouse-pointer:before{content:"\\f245"}.fa-mug-hot:before{content:"\\f7b6"}.fa-music:before{content:"\\f001"}.fa-napster:before{content:"\\f3d2"}.fa-neos:before{content:"\\f612"}.fa-network-wired:before{content:"\\f6ff"}.fa-neuter:before{content:"\\f22c"}.fa-newspaper:before{content:"\\f1ea"}.fa-nimblr:before{content:"\\f5a8"}.fa-node:before{content:"\\f419"}.fa-node-js:before{content:"\\f3d3"}.fa-not-equal:before{content:"\\f53e"}.fa-notes-medical:before{content:"\\f481"}.fa-npm:before{content:"\\f3d4"}.fa-ns8:before{content:"\\f3d5"}.fa-nutritionix:before{content:"\\f3d6"}.fa-object-group:before{content:"\\f247"}.fa-object-ungroup:before{content:"\\f248"}.fa-octopus-deploy:before{content:"\\e082"}.fa-odnoklassniki:before{content:"\\f263"}.fa-odnoklassniki-square:before{content:"\\f264"}.fa-oil-can:before{content:"\\f613"}.fa-old-republic:before{content:"\\f510"}.fa-om:before{content:"\\f679"}.fa-opencart:before{content:"\\f23d"}.fa-openid:before{content:"\\f19b"}.fa-opera:before{content:"\\f26a"}.fa-optin-monster:before{content:"\\f23c"}.fa-orcid:before{content:"\\f8d2"}.fa-osi:before{content:"\\f41a"}.fa-otter:before{content:"\\f700"}.fa-outdent:before{content:"\\f03b"}.fa-page4:before{content:"\\f3d7"}.fa-pagelines:before{content:"\\f18c"}.fa-pager:before{content:"\\f815"}.fa-paint-brush:before{content:"\\f1fc"}.fa-paint-roller:before{content:"\\f5aa"}.fa-palette:before{content:"\\f53f"}.fa-palfed:before{content:"\\f3d8"}.fa-pallet:before{content:"\\f482"}.fa-paper-plane:before{content:"\\f1d8"}.fa-paperclip:before{content:"\\f0c6"}.fa-parachute-box:before{content:"\\f4cd"}.fa-paragraph:before{content:"\\f1dd"}.fa-parking:before{content:"\\f540"}.fa-passport:before{content:"\\f5ab"}.fa-pastafarianism:before{content:"\\f67b"}.fa-paste:before{content:"\\f0ea"}.fa-patreon:before{content:"\\f3d9"}.fa-pause:before{content:"\\f04c"}.fa-pause-circle:before{content:"\\f28b"}.fa-paw:before{content:"\\f1b0"}.fa-paypal:before{content:"\\f1ed"}.fa-peace:before{content:"\\f67c"}.fa-pen:before{content:"\\f304"}.fa-pen-alt:before{content:"\\f305"}.fa-pen-fancy:before{content:"\\f5ac"}.fa-pen-nib:before{content:"\\f5ad"}.fa-pen-square:before{content:"\\f14b"}.fa-pencil-alt:before{content:"\\f303"}.fa-pencil-ruler:before{content:"\\f5ae"}.fa-penny-arcade:before{content:"\\f704"}.fa-people-arrows:before{content:"\\e068"}.fa-people-carry:before{content:"\\f4ce"}.fa-pepper-hot:before{content:"\\f816"}.fa-perbyte:before{content:"\\e083"}.fa-percent:before{content:"\\f295"}.fa-percentage:before{content:"\\f541"}.fa-periscope:before{content:"\\f3da"}.fa-person-booth:before{content:"\\f756"}.fa-phabricator:before{content:"\\f3db"}.fa-phoenix-framework:before{content:"\\f3dc"}.fa-phoenix-squadron:before{content:"\\f511"}.fa-phone:before{content:"\\f095"}.fa-phone-alt:before{content:"\\f879"}.fa-phone-slash:before{content:"\\f3dd"}.fa-phone-square:before{content:"\\f098"}.fa-phone-square-alt:before{content:"\\f87b"}.fa-phone-volume:before{content:"\\f2a0"}.fa-photo-video:before{content:"\\f87c"}.fa-php:before{content:"\\f457"}.fa-pied-piper:before{content:"\\f2ae"}.fa-pied-piper-alt:before{content:"\\f1a8"}.fa-pied-piper-hat:before{content:"\\f4e5"}.fa-pied-piper-pp:before{content:"\\f1a7"}.fa-pied-piper-square:before{content:"\\e01e"}.fa-piggy-bank:before{content:"\\f4d3"}.fa-pills:before{content:"\\f484"}.fa-pinterest:before{content:"\\f0d2"}.fa-pinterest-p:before{content:"\\f231"}.fa-pinterest-square:before{content:"\\f0d3"}.fa-pizza-slice:before{content:"\\f818"}.fa-place-of-worship:before{content:"\\f67f"}.fa-plane:before{content:"\\f072"}.fa-plane-arrival:before{content:"\\f5af"}.fa-plane-departure:before{content:"\\f5b0"}.fa-plane-slash:before{content:"\\e069"}.fa-play:before{content:"\\f04b"}.fa-play-circle:before{content:"\\f144"}.fa-playstation:before{content:"\\f3df"}.fa-plug:before{content:"\\f1e6"}.fa-plus:before{content:"\\f067"}.fa-plus-circle:before{content:"\\f055"}.fa-plus-square:before{content:"\\f0fe"}.fa-podcast:before{content:"\\f2ce"}.fa-poll:before{content:"\\f681"}.fa-poll-h:before{content:"\\f682"}.fa-poo:before{content:"\\f2fe"}.fa-poo-storm:before{content:"\\f75a"}.fa-poop:before{content:"\\f619"}.fa-portrait:before{content:"\\f3e0"}.fa-pound-sign:before{content:"\\f154"}.fa-power-off:before{content:"\\f011"}.fa-pray:before{content:"\\f683"}.fa-praying-hands:before{content:"\\f684"}.fa-prescription:before{content:"\\f5b1"}.fa-prescription-bottle:before{content:"\\f485"}.fa-prescription-bottle-alt:before{content:"\\f486"}.fa-print:before{content:"\\f02f"}.fa-procedures:before{content:"\\f487"}.fa-product-hunt:before{content:"\\f288"}.fa-project-diagram:before{content:"\\f542"}.fa-pump-medical:before{content:"\\e06a"}.fa-pump-soap:before{content:"\\e06b"}.fa-pushed:before{content:"\\f3e1"}.fa-puzzle-piece:before{content:"\\f12e"}.fa-python:before{content:"\\f3e2"}.fa-qq:before{content:"\\f1d6"}.fa-qrcode:before{content:"\\f029"}.fa-question:before{content:"\\f128"}.fa-question-circle:before{content:"\\f059"}.fa-quidditch:before{content:"\\f458"}.fa-quinscape:before{content:"\\f459"}.fa-quora:before{content:"\\f2c4"}.fa-quote-left:before{content:"\\f10d"}.fa-quote-right:before{content:"\\f10e"}.fa-quran:before{content:"\\f687"}.fa-r-project:before{content:"\\f4f7"}.fa-radiation:before{content:"\\f7b9"}.fa-radiation-alt:before{content:"\\f7ba"}.fa-rainbow:before{content:"\\f75b"}.fa-random:before{content:"\\f074"}.fa-raspberry-pi:before{content:"\\f7bb"}.fa-ravelry:before{content:"\\f2d9"}.fa-react:before{content:"\\f41b"}.fa-reacteurope:before{content:"\\f75d"}.fa-readme:before{content:"\\f4d5"}.fa-rebel:before{content:"\\f1d0"}.fa-receipt:before{content:"\\f543"}.fa-record-vinyl:before{content:"\\f8d9"}.fa-recycle:before{content:"\\f1b8"}.fa-red-river:before{content:"\\f3e3"}.fa-reddit:before{content:"\\f1a1"}.fa-reddit-alien:before{content:"\\f281"}.fa-reddit-square:before{content:"\\f1a2"}.fa-redhat:before{content:"\\f7bc"}.fa-redo:before{content:"\\f01e"}.fa-redo-alt:before{content:"\\f2f9"}.fa-registered:before{content:"\\f25d"}.fa-remove-format:before{content:"\\f87d"}.fa-renren:before{content:"\\f18b"}.fa-reply:before{content:"\\f3e5"}.fa-reply-all:before{content:"\\f122"}.fa-replyd:before{content:"\\f3e6"}.fa-republican:before{content:"\\f75e"}.fa-researchgate:before{content:"\\f4f8"}.fa-resolving:before{content:"\\f3e7"}.fa-restroom:before{content:"\\f7bd"}.fa-retweet:before{content:"\\f079"}.fa-rev:before{content:"\\f5b2"}.fa-ribbon:before{content:"\\f4d6"}.fa-ring:before{content:"\\f70b"}.fa-road:before{content:"\\f018"}.fa-robot:before{content:"\\f544"}.fa-rocket:before{content:"\\f135"}.fa-rocketchat:before{content:"\\f3e8"}.fa-rockrms:before{content:"\\f3e9"}.fa-route:before{content:"\\f4d7"}.fa-rss:before{content:"\\f09e"}.fa-rss-square:before{content:"\\f143"}.fa-ruble-sign:before{content:"\\f158"}.fa-ruler:before{content:"\\f545"}.fa-ruler-combined:before{content:"\\f546"}.fa-ruler-horizontal:before{content:"\\f547"}.fa-ruler-vertical:before{content:"\\f548"}.fa-running:before{content:"\\f70c"}.fa-rupee-sign:before{content:"\\f156"}.fa-rust:before{content:"\\e07a"}.fa-sad-cry:before{content:"\\f5b3"}.fa-sad-tear:before{content:"\\f5b4"}.fa-safari:before{content:"\\f267"}.fa-salesforce:before{content:"\\f83b"}.fa-sass:before{content:"\\f41e"}.fa-satellite:before{content:"\\f7bf"}.fa-satellite-dish:before{content:"\\f7c0"}.fa-save:before{content:"\\f0c7"}.fa-schlix:before{content:"\\f3ea"}.fa-school:before{content:"\\f549"}.fa-screwdriver:before{content:"\\f54a"}.fa-scribd:before{content:"\\f28a"}.fa-scroll:before{content:"\\f70e"}.fa-sd-card:before{content:"\\f7c2"}.fa-search:before{content:"\\f002"}.fa-search-dollar:before{content:"\\f688"}.fa-search-location:before{content:"\\f689"}.fa-search-minus:before{content:"\\f010"}.fa-search-plus:before{content:"\\f00e"}.fa-searchengin:before{content:"\\f3eb"}.fa-seedling:before{content:"\\f4d8"}.fa-sellcast:before{content:"\\f2da"}.fa-sellsy:before{content:"\\f213"}.fa-server:before{content:"\\f233"}.fa-servicestack:before{content:"\\f3ec"}.fa-shapes:before{content:"\\f61f"}.fa-share:before{content:"\\f064"}.fa-share-alt:before{content:"\\f1e0"}.fa-share-alt-square:before{content:"\\f1e1"}.fa-share-square:before{content:"\\f14d"}.fa-shekel-sign:before{content:"\\f20b"}.fa-shield-alt:before{content:"\\f3ed"}.fa-shield-virus:before{content:"\\e06c"}.fa-ship:before{content:"\\f21a"}.fa-shipping-fast:before{content:"\\f48b"}.fa-shirtsinbulk:before{content:"\\f214"}.fa-shoe-prints:before{content:"\\f54b"}.fa-shopify:before{content:"\\e057"}.fa-shopping-bag:before{content:"\\f290"}.fa-shopping-basket:before{content:"\\f291"}.fa-shopping-cart:before{content:"\\f07a"}.fa-shopware:before{content:"\\f5b5"}.fa-shower:before{content:"\\f2cc"}.fa-shuttle-van:before{content:"\\f5b6"}.fa-sign:before{content:"\\f4d9"}.fa-sign-in-alt:before{content:"\\f2f6"}.fa-sign-language:before{content:"\\f2a7"}.fa-sign-out-alt:before{content:"\\f2f5"}.fa-signal:before{content:"\\f012"}.fa-signature:before{content:"\\f5b7"}.fa-sim-card:before{content:"\\f7c4"}.fa-simplybuilt:before{content:"\\f215"}.fa-sink:before{content:"\\e06d"}.fa-sistrix:before{content:"\\f3ee"}.fa-sitemap:before{content:"\\f0e8"}.fa-sith:before{content:"\\f512"}.fa-skating:before{content:"\\f7c5"}.fa-sketch:before{content:"\\f7c6"}.fa-skiing:before{content:"\\f7c9"}.fa-skiing-nordic:before{content:"\\f7ca"}.fa-skull:before{content:"\\f54c"}.fa-skull-crossbones:before{content:"\\f714"}.fa-skyatlas:before{content:"\\f216"}.fa-skype:before{content:"\\f17e"}.fa-slack:before{content:"\\f198"}.fa-slack-hash:before{content:"\\f3ef"}.fa-slash:before{content:"\\f715"}.fa-sleigh:before{content:"\\f7cc"}.fa-sliders-h:before{content:"\\f1de"}.fa-slideshare:before{content:"\\f1e7"}.fa-smile:before{content:"\\f118"}.fa-smile-beam:before{content:"\\f5b8"}.fa-smile-wink:before{content:"\\f4da"}.fa-smog:before{content:"\\f75f"}.fa-smoking:before{content:"\\f48d"}.fa-smoking-ban:before{content:"\\f54d"}.fa-sms:before{content:"\\f7cd"}.fa-snapchat:before{content:"\\f2ab"}.fa-snapchat-ghost:before{content:"\\f2ac"}.fa-snapchat-square:before{content:"\\f2ad"}.fa-snowboarding:before{content:"\\f7ce"}.fa-snowflake:before{content:"\\f2dc"}.fa-snowman:before{content:"\\f7d0"}.fa-snowplow:before{content:"\\f7d2"}.fa-soap:before{content:"\\e06e"}.fa-socks:before{content:"\\f696"}.fa-solar-panel:before{content:"\\f5ba"}.fa-sort:before{content:"\\f0dc"}.fa-sort-alpha-down:before{content:"\\f15d"}.fa-sort-alpha-down-alt:before{content:"\\f881"}.fa-sort-alpha-up:before{content:"\\f15e"}.fa-sort-alpha-up-alt:before{content:"\\f882"}.fa-sort-amount-down:before{content:"\\f160"}.fa-sort-amount-down-alt:before{content:"\\f884"}.fa-sort-amount-up:before{content:"\\f161"}.fa-sort-amount-up-alt:before{content:"\\f885"}.fa-sort-down:before{content:"\\f0dd"}.fa-sort-numeric-down:before{content:"\\f162"}.fa-sort-numeric-down-alt:before{content:"\\f886"}.fa-sort-numeric-up:before{content:"\\f163"}.fa-sort-numeric-up-alt:before{content:"\\f887"}.fa-sort-up:before{content:"\\f0de"}.fa-soundcloud:before{content:"\\f1be"}.fa-sourcetree:before{content:"\\f7d3"}.fa-spa:before{content:"\\f5bb"}.fa-space-shuttle:before{content:"\\f197"}.fa-speakap:before{content:"\\f3f3"}.fa-speaker-deck:before{content:"\\f83c"}.fa-spell-check:before{content:"\\f891"}.fa-spider:before{content:"\\f717"}.fa-spinner:before{content:"\\f110"}.fa-splotch:before{content:"\\f5bc"}.fa-spotify:before{content:"\\f1bc"}.fa-spray-can:before{content:"\\f5bd"}.fa-square:before{content:"\\f0c8"}.fa-square-full:before{content:"\\f45c"}.fa-square-root-alt:before{content:"\\f698"}.fa-squarespace:before{content:"\\f5be"}.fa-stack-exchange:before{content:"\\f18d"}.fa-stack-overflow:before{content:"\\f16c"}.fa-stackpath:before{content:"\\f842"}.fa-stamp:before{content:"\\f5bf"}.fa-star:before{content:"\\f005"}.fa-star-and-crescent:before{content:"\\f699"}.fa-star-half:before{content:"\\f089"}.fa-star-half-alt:before{content:"\\f5c0"}.fa-star-of-david:before{content:"\\f69a"}.fa-star-of-life:before{content:"\\f621"}.fa-staylinked:before{content:"\\f3f5"}.fa-steam:before{content:"\\f1b6"}.fa-steam-square:before{content:"\\f1b7"}.fa-steam-symbol:before{content:"\\f3f6"}.fa-step-backward:before{content:"\\f048"}.fa-step-forward:before{content:"\\f051"}.fa-stethoscope:before{content:"\\f0f1"}.fa-sticker-mule:before{content:"\\f3f7"}.fa-sticky-note:before{content:"\\f249"}.fa-stop:before{content:"\\f04d"}.fa-stop-circle:before{content:"\\f28d"}.fa-stopwatch:before{content:"\\f2f2"}.fa-stopwatch-20:before{content:"\\e06f"}.fa-store:before{content:"\\f54e"}.fa-store-alt:before{content:"\\f54f"}.fa-store-alt-slash:before{content:"\\e070"}.fa-store-slash:before{content:"\\e071"}.fa-strava:before{content:"\\f428"}.fa-stream:before{content:"\\f550"}.fa-street-view:before{content:"\\f21d"}.fa-strikethrough:before{content:"\\f0cc"}.fa-stripe:before{content:"\\f429"}.fa-stripe-s:before{content:"\\f42a"}.fa-stroopwafel:before{content:"\\f551"}.fa-studiovinari:before{content:"\\f3f8"}.fa-stumbleupon:before{content:"\\f1a4"}.fa-stumbleupon-circle:before{content:"\\f1a3"}.fa-subscript:before{content:"\\f12c"}.fa-subway:before{content:"\\f239"}.fa-suitcase:before{content:"\\f0f2"}.fa-suitcase-rolling:before{content:"\\f5c1"}.fa-sun:before{content:"\\f185"}.fa-superpowers:before{content:"\\f2dd"}.fa-superscript:before{content:"\\f12b"}.fa-supple:before{content:"\\f3f9"}.fa-surprise:before{content:"\\f5c2"}.fa-suse:before{content:"\\f7d6"}.fa-swatchbook:before{content:"\\f5c3"}.fa-swift:before{content:"\\f8e1"}.fa-swimmer:before{content:"\\f5c4"}.fa-swimming-pool:before{content:"\\f5c5"}.fa-symfony:before{content:"\\f83d"}.fa-synagogue:before{content:"\\f69b"}.fa-sync:before{content:"\\f021"}.fa-sync-alt:before{content:"\\f2f1"}.fa-syringe:before{content:"\\f48e"}.fa-table:before{content:"\\f0ce"}.fa-table-tennis:before{content:"\\f45d"}.fa-tablet:before{content:"\\f10a"}.fa-tablet-alt:before{content:"\\f3fa"}.fa-tablets:before{content:"\\f490"}.fa-tachometer-alt:before{content:"\\f3fd"}.fa-tag:before{content:"\\f02b"}.fa-tags:before{content:"\\f02c"}.fa-tape:before{content:"\\f4db"}.fa-tasks:before{content:"\\f0ae"}.fa-taxi:before{content:"\\f1ba"}.fa-teamspeak:before{content:"\\f4f9"}.fa-teeth:before{content:"\\f62e"}.fa-teeth-open:before{content:"\\f62f"}.fa-telegram:before{content:"\\f2c6"}.fa-telegram-plane:before{content:"\\f3fe"}.fa-temperature-high:before{content:"\\f769"}.fa-temperature-low:before{content:"\\f76b"}.fa-tencent-weibo:before{content:"\\f1d5"}.fa-tenge:before{content:"\\f7d7"}.fa-terminal:before{content:"\\f120"}.fa-text-height:before{content:"\\f034"}.fa-text-width:before{content:"\\f035"}.fa-th:before{content:"\\f00a"}.fa-th-large:before{content:"\\f009"}.fa-th-list:before{content:"\\f00b"}.fa-the-red-yeti:before{content:"\\f69d"}.fa-theater-masks:before{content:"\\f630"}.fa-themeco:before{content:"\\f5c6"}.fa-themeisle:before{content:"\\f2b2"}.fa-thermometer:before{content:"\\f491"}.fa-thermometer-empty:before{content:"\\f2cb"}.fa-thermometer-full:before{content:"\\f2c7"}.fa-thermometer-half:before{content:"\\f2c9"}.fa-thermometer-quarter:before{content:"\\f2ca"}.fa-thermometer-three-quarters:before{content:"\\f2c8"}.fa-think-peaks:before{content:"\\f731"}.fa-thumbs-down:before{content:"\\f165"}.fa-thumbs-up:before{content:"\\f164"}.fa-thumbtack:before{content:"\\f08d"}.fa-ticket-alt:before{content:"\\f3ff"}.fa-tiktok:before{content:"\\e07b"}.fa-times:before{content:"\\f00d"}.fa-times-circle:before{content:"\\f057"}.fa-tint:before{content:"\\f043"}.fa-tint-slash:before{content:"\\f5c7"}.fa-tired:before{content:"\\f5c8"}.fa-toggle-off:before{content:"\\f204"}.fa-toggle-on:before{content:"\\f205"}.fa-toilet:before{content:"\\f7d8"}.fa-toilet-paper:before{content:"\\f71e"}.fa-toilet-paper-slash:before{content:"\\e072"}.fa-toolbox:before{content:"\\f552"}.fa-tools:before{content:"\\f7d9"}.fa-tooth:before{content:"\\f5c9"}.fa-torah:before{content:"\\f6a0"}.fa-torii-gate:before{content:"\\f6a1"}.fa-tractor:before{content:"\\f722"}.fa-trade-federation:before{content:"\\f513"}.fa-trademark:before{content:"\\f25c"}.fa-traffic-light:before{content:"\\f637"}.fa-trailer:before{content:"\\e041"}.fa-train:before{content:"\\f238"}.fa-tram:before{content:"\\f7da"}.fa-transgender:before{content:"\\f224"}.fa-transgender-alt:before{content:"\\f225"}.fa-trash:before{content:"\\f1f8"}.fa-trash-alt:before{content:"\\f2ed"}.fa-trash-restore:before{content:"\\f829"}.fa-trash-restore-alt:before{content:"\\f82a"}.fa-tree:before{content:"\\f1bb"}.fa-trello:before{content:"\\f181"}.fa-tripadvisor:before{content:"\\f262"}.fa-trophy:before{content:"\\f091"}.fa-truck:before{content:"\\f0d1"}.fa-truck-loading:before{content:"\\f4de"}.fa-truck-monster:before{content:"\\f63b"}.fa-truck-moving:before{content:"\\f4df"}.fa-truck-pickup:before{content:"\\f63c"}.fa-tshirt:before{content:"\\f553"}.fa-tty:before{content:"\\f1e4"}.fa-tumblr:before{content:"\\f173"}.fa-tumblr-square:before{content:"\\f174"}.fa-tv:before{content:"\\f26c"}.fa-twitch:before{content:"\\f1e8"}.fa-twitter:before{content:"\\f099"}.fa-twitter-square:before{content:"\\f081"}.fa-typo3:before{content:"\\f42b"}.fa-uber:before{content:"\\f402"}.fa-ubuntu:before{content:"\\f7df"}.fa-uikit:before{content:"\\f403"}.fa-umbraco:before{content:"\\f8e8"}.fa-umbrella:before{content:"\\f0e9"}.fa-umbrella-beach:before{content:"\\f5ca"}.fa-uncharted:before{content:"\\e084"}.fa-underline:before{content:"\\f0cd"}.fa-undo:before{content:"\\f0e2"}.fa-undo-alt:before{content:"\\f2ea"}.fa-uniregistry:before{content:"\\f404"}.fa-unity:before{content:"\\e049"}.fa-universal-access:before{content:"\\f29a"}.fa-university:before{content:"\\f19c"}.fa-unlink:before{content:"\\f127"}.fa-unlock:before{content:"\\f09c"}.fa-unlock-alt:before{content:"\\f13e"}.fa-unsplash:before{content:"\\e07c"}.fa-untappd:before{content:"\\f405"}.fa-upload:before{content:"\\f093"}.fa-ups:before{content:"\\f7e0"}.fa-usb:before{content:"\\f287"}.fa-user:before{content:"\\f007"}.fa-user-alt:before{content:"\\f406"}.fa-user-alt-slash:before{content:"\\f4fa"}.fa-user-astronaut:before{content:"\\f4fb"}.fa-user-check:before{content:"\\f4fc"}.fa-user-circle:before{content:"\\f2bd"}.fa-user-clock:before{content:"\\f4fd"}.fa-user-cog:before{content:"\\f4fe"}.fa-user-edit:before{content:"\\f4ff"}.fa-user-friends:before{content:"\\f500"}.fa-user-graduate:before{content:"\\f501"}.fa-user-injured:before{content:"\\f728"}.fa-user-lock:before{content:"\\f502"}.fa-user-md:before{content:"\\f0f0"}.fa-user-minus:before{content:"\\f503"}.fa-user-ninja:before{content:"\\f504"}.fa-user-nurse:before{content:"\\f82f"}.fa-user-plus:before{content:"\\f234"}.fa-user-secret:before{content:"\\f21b"}.fa-user-shield:before{content:"\\f505"}.fa-user-slash:before{content:"\\f506"}.fa-user-tag:before{content:"\\f507"}.fa-user-tie:before{content:"\\f508"}.fa-user-times:before{content:"\\f235"}.fa-users:before{content:"\\f0c0"}.fa-users-cog:before{content:"\\f509"}.fa-users-slash:before{content:"\\e073"}.fa-usps:before{content:"\\f7e1"}.fa-ussunnah:before{content:"\\f407"}.fa-utensil-spoon:before{content:"\\f2e5"}.fa-utensils:before{content:"\\f2e7"}.fa-vaadin:before{content:"\\f408"}.fa-vector-square:before{content:"\\f5cb"}.fa-venus:before{content:"\\f221"}.fa-venus-double:before{content:"\\f226"}.fa-venus-mars:before{content:"\\f228"}.fa-vest:before{content:"\\e085"}.fa-vest-patches:before{content:"\\e086"}.fa-viacoin:before{content:"\\f237"}.fa-viadeo:before{content:"\\f2a9"}.fa-viadeo-square:before{content:"\\f2aa"}.fa-vial:before{content:"\\f492"}.fa-vials:before{content:"\\f493"}.fa-viber:before{content:"\\f409"}.fa-video:before{content:"\\f03d"}.fa-video-slash:before{content:"\\f4e2"}.fa-vihara:before{content:"\\f6a7"}.fa-vimeo:before{content:"\\f40a"}.fa-vimeo-square:before{content:"\\f194"}.fa-vimeo-v:before{content:"\\f27d"}.fa-vine:before{content:"\\f1ca"}.fa-virus:before{content:"\\e074"}.fa-virus-slash:before{content:"\\e075"}.fa-viruses:before{content:"\\e076"}.fa-vk:before{content:"\\f189"}.fa-vnv:before{content:"\\f40b"}.fa-voicemail:before{content:"\\f897"}.fa-volleyball-ball:before{content:"\\f45f"}.fa-volume-down:before{content:"\\f027"}.fa-volume-mute:before{content:"\\f6a9"}.fa-volume-off:before{content:"\\f026"}.fa-volume-up:before{content:"\\f028"}.fa-vote-yea:before{content:"\\f772"}.fa-vr-cardboard:before{content:"\\f729"}.fa-vuejs:before{content:"\\f41f"}.fa-walking:before{content:"\\f554"}.fa-wallet:before{content:"\\f555"}.fa-warehouse:before{content:"\\f494"}.fa-watchman-monitoring:before{content:"\\e087"}.fa-water:before{content:"\\f773"}.fa-wave-square:before{content:"\\f83e"}.fa-waze:before{content:"\\f83f"}.fa-weebly:before{content:"\\f5cc"}.fa-weibo:before{content:"\\f18a"}.fa-weight:before{content:"\\f496"}.fa-weight-hanging:before{content:"\\f5cd"}.fa-weixin:before{content:"\\f1d7"}.fa-whatsapp:before{content:"\\f232"}.fa-whatsapp-square:before{content:"\\f40c"}.fa-wheelchair:before{content:"\\f193"}.fa-whmcs:before{content:"\\f40d"}.fa-wifi:before{content:"\\f1eb"}.fa-wikipedia-w:before{content:"\\f266"}.fa-wind:before{content:"\\f72e"}.fa-window-close:before{content:"\\f410"}.fa-window-maximize:before{content:"\\f2d0"}.fa-window-minimize:before{content:"\\f2d1"}.fa-window-restore:before{content:"\\f2d2"}.fa-windows:before{content:"\\f17a"}.fa-wine-bottle:before{content:"\\f72f"}.fa-wine-glass:before{content:"\\f4e3"}.fa-wine-glass-alt:before{content:"\\f5ce"}.fa-wix:before{content:"\\f5cf"}.fa-wizards-of-the-coast:before{content:"\\f730"}.fa-wodu:before{content:"\\e088"}.fa-wolf-pack-battalion:before{content:"\\f514"}.fa-won-sign:before{content:"\\f159"}.fa-wordpress:before{content:"\\f19a"}.fa-wordpress-simple:before{content:"\\f411"}.fa-wpbeginner:before{content:"\\f297"}.fa-wpexplorer:before{content:"\\f2de"}.fa-wpforms:before{content:"\\f298"}.fa-wpressr:before{content:"\\f3e4"}.fa-wrench:before{content:"\\f0ad"}.fa-x-ray:before{content:"\\f497"}.fa-xbox:before{content:"\\f412"}.fa-xing:before{content:"\\f168"}.fa-xing-square:before{content:"\\f169"}.fa-y-combinator:before{content:"\\f23b"}.fa-yahoo:before{content:"\\f19e"}.fa-yammer:before{content:"\\f840"}.fa-yandex:before{content:"\\f413"}.fa-yandex-international:before{content:"\\f414"}.fa-yarn:before{content:"\\f7e3"}.fa-yelp:before{content:"\\f1e9"}.fa-yen-sign:before{content:"\\f157"}.fa-yin-yang:before{content:"\\f6ad"}.fa-yoast:before{content:"\\f2b1"}.fa-youtube:before{content:"\\f167"}.fa-youtube-square:before{content:"\\f431"}.fa-zhihu:before{content:"\\f63f"}.sr-only{border:0;clip:rect(0,0,0,0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px}.sr-only-focusable:active,.sr-only-focusable:focus{clip:auto;height:auto;margin:0;overflow:visible;position:static;width:auto}@font-face{font-family:"Font Awesome 5 Brands";font-style:normal;font-weight:400;font-display:block;src:url('+E+");src:url("+S+') format("embedded-opentype"),url('+A+') format("woff2"),url('+T+') format("woff"),url('+M+') format("truetype"),url('+D+') format("svg")}.fab{font-family:"Font Awesome 5 Brands"}@font-face{font-family:"Font Awesome 5 Free";font-style:normal;font-weight:400;font-display:block;src:url('+P+");src:url("+L+') format("embedded-opentype"),url('+R+') format("woff2"),url('+I+') format("woff"),url('+O+') format("truetype"),url('+z+') format("svg")}.fab,.far{font-weight:400}@font-face{font-family:"Font Awesome 5 Free";font-style:normal;font-weight:900;font-display:block;src:url('+F+");src:url("+B+') format("embedded-opentype"),url('+N+') format("woff2"),url('+j+') format("woff"),url('+U+') format("truetype"),url('+V+') format("svg")}.fa,.far,.fas{font-family:"Font Awesome 5 Free"}.fa,.fas{font-weight:900}',""]);const W=k},7745:(t,e,n)=>{"use strict";n.d(e,{Z:()=>S});var i=n(8081),r=n.n(i),o=n(3645),s=n.n(o),a=n(1667),l=n.n(a),c=new URL(n(4413),n.b),u=new URL(n(6912),n.b),h=new URL(n(8712),n.b),d=new URL(n(6908),n.b),f=new URL(n(996),n.b),p=new URL(n(9513),n.b),g=new URL(n(1679),n.b),m=new URL(n(6710),n.b),_=s()(r()),v=l()(c),b=l()(u),y=l()(h),w=l()(d),x=l()(f),C=l()(p),k=l()(g),E=l()(m);_.push([t.id,".header-overlay, .cell-overlay, .selection-cell-overlay\n{\n\n    display: block;\n    position: absolute;\n    z-index: 999;\n}\n.header-overlay {\n  background-color: #217346;\n}\n\n.cell-overlay, .selection-cell-overlay {\n  background-color: #217346;\n}\n\n.mlv-tile{\n  position:absolute;\n  box-sizing: border-box;\n  \n}\n\ninput.editor-text {\n  font: 11pt Calibri, 'Segoe UI',Arial,Verdana,Sans-Serif;\n  background: none;\n  border: 0 none;\n  margin: 0;\n  outline: 0 none;\n  padding: 0;\n  width: 100%;\n}\n\n.handle-overlay {\n  border: 1px solid white;\n  padding: 2px;\n  background-color: #217346;\n  position: absolute;\n  width: 1px;\n  z-index: 1000;\n  cursor: crosshair;\n}\n\n.overlay-handle-decorator {\n  border: 2px solid #217346;\n  z-index: 1000;\n}\n\n.image-table-selected {\n  border: 4px solid goldenrod;\n}\n\n\n\n/*\nIMPORTANT:\nIn order to preserve the uniform grid appearance, all cell styles need to have padding, margin and border sizes.\nNo built-in (selected, editable, highlight, flashing, invalid, loading, :focus) or user-specified CSS\nclasses should alter those!\n*/\n\n.slick-header.ui-state-default, .slick-headerrow.ui-state-default, .slick-footerrow.ui-state-default, .slick-top-panel-scroller.ui-state-default, .slick-group-header.ui-state-default {\n    width: 100%;\n    overflow: auto;\n    position: relative;\n    border-left: 0px !important;\n  }\n  \n  .slick-header.ui-state-default {\n    overflow: inherit;\n  }\n  \n  .slick-header::-webkit-scrollbar,  .slick-headerrow::-webkit-scrollbar, .slick-footerrow::-webkit-scrollbar {\n    display: none\n  }\n  \n  .slick-header-columns, .slick-headerrow-columns, .slick-footerrow-columns, .slick-group-header-columns {\n    position: relative;\n    white-space: nowrap;\n    cursor: default;\n    overflow: hidden;\n  }\n  \n  .slick-header-column.ui-state-default, .slick-group-header-column.ui-state-default {\n    position: relative;\n    display: inline-block;\n    box-sizing: content-box !important; /* this here only for Firefox! */ \n    overflow: hidden;\n    -o-text-overflow: ellipsis;\n    text-overflow: ellipsis;\n    height: 16px;\n    line-height: 16px;\n    margin: 0;\n    padding: 4px;\n    border-right: 1px solid silver;\n    border-left: 0px !important;\n    border-top: 0px !important;\n    border-bottom: 0px !important;\n    float: left;\n  }\n  \n  .slick-footerrow-column.ui-state-default {\n    -o-text-overflow: ellipsis;\n    text-overflow: ellipsis;\n    margin: 0;\n    padding: 4px;\n    border-right: 1px solid silver;\n    border-left: 0px;\n    border-top: 0px;\n    border-bottom: 0px;\n    float: left;\n    line-height: 20px;\n    vertical-align: middle;\n  }\n  \n  .slick-headerrow-column.ui-state-default, .slick-footerrow-column.ui-state-default {\n    padding: 4px;\n  }\n  \n  .slick-header-column-sorted {\n    font-style: italic;\n  }\n  \n  .slick-sort-indicator {\n    display: inline-block;\n    width: 8px;\n    height: 5px;\n    margin-left: 4px;\n    margin-top: 6px;\n    float: left;\n  }\n  \n  .slick-sort-indicator-numbered {\n    display: inline-block;\n    width: 8px;\n    height: 5px;\n    margin-left: 4px;\n    margin-top: 0;\n    line-height: 20px;\n    float: left;\n    font-family: Arial;\n    font-style: normal;\n    font-weight: bold;\n    color: #6190CD;\n  }\n  \n  .slick-sort-indicator-desc {\n    background: url("+v+");\n  }\n  \n  .slick-sort-indicator-asc {\n    background: url("+b+");\n  }\n  \n  .slick-resizable-handle {\n    position: absolute;\n    font-size: 0.1px;\n    display: block;\n    cursor: col-resize;\n    width: 9px;\n    right: -5px;\n    top: 0;\n    height: 100%;\n    z-index: 1;\n  }\n\n \n  .slick-sortable-placeholder {\n    background: silver;\n  }\n\n  .selected{\n     background:beige;\n  }\n  \n  .grid-canvas {\n    position: relative;\n    outline: 0;\n  }\n  \n  .slick-row.ui-widget-content, .slick-row.ui-state-active {\n    position: absolute;\n    border: 0px;\n    width: 100%;\n  }\n  \n  .slick-cell, .slick-headerrow-column , .slick-footerrow-column{\n    position: absolute;\n    border: 1px solid transparent;\n    border-right: 1px dotted silver;\n    border-bottom-color: silver;\n    overflow: hidden;\n    -o-text-overflow: ellipsis;\n    text-overflow: ellipsis;\n    vertical-align: middle;\n    z-index: 0;\n    padding: 1px 2px 2px 1px;\n    margin: 0;\n    white-space: nowrap;\n    cursor: default;\n  }\n  .slick-cell, .slick-headerrow-column{\n    border-bottom-color: silver;\n  }\n  .slick-footerrow-column {\n    border-top-color: silver;\n  }\n\n  \n  .slick-group {\n  }\n  \n  .slick-group-toggle {\n    display: inline-block;\n  }\n  \n  .slick-cell.highlighted {\n    background: lightskyblue;\n    background: rgba(0, 0, 255, 0.2);\n    -webkit-transition: all 0.5s;\n    -moz-transition: all 0.5s;\n    -o-transition: all 0.5s;\n    transition: all 0.5s;\n  }\n  \n  .slick-cell.flashing {\n    border: 1px solid red !important;\n  }\n  \n  .slick-cell.editable {\n    z-index: 11;\n    overflow: visible;\n    background: white;\n    border-color: black;\n    border-style: solid;\n  }\n  \n  .slick-cell:focus {\n    outline: none;\n  }\n  \n  .slick-reorder-proxy {\n    display: inline-block;\n    background: blue;\n    opacity: 0.15;\n    filter: alpha(opacity = 15);\n    cursor: move;\n  }\n  \n  .slick-reorder-guide {\n    display: inline-block;\n    height: 2px;\n    background: blue;\n    opacity: 0.7;\n    filter: alpha(opacity = 70);\n  }\n  \n  .slick-selection {\n    z-index: 10;\n    position: absolute;\n    border: 2px dashed black;\n  }\n  \n  .slick-pane {\n    position: absolute;\n    outline: 0;\n    overflow: hidden;\n    width: 100%;\n  }\n  \n  .slick-pane-header {\n    display: block;\n  }\n  \n  .slick-header {\n    overflow: hidden;\n    position: relative;\n  }\n  \n  .slick-headerrow {\n    overflow: hidden;\n    position: relative;\n  }\n  \n  .slick-top-panel-scroller {\n    overflow: hidden;\n    position: relative;\n  }\n  \n  .slick-top-panel {\n    width: 10000px\n  }\n  \n  .slick-viewport {\n    position: relative;\n    outline: 0;\n    width: 100%;\n  }\n\n  .slick-header{\n    background:lightgray;\n  }\n   .slick-header-column{\n     border-color:white;\n   }\n\n\n   .slick-header-columns {\n    background: url("+y+") repeat-x center bottom;\n    border-bottom: 1px solid silver;\n  }\n  \n  .slick-header-column {\n    background: url("+y+") repeat-x center bottom;\n    border-right: 1px solid silver;\n  }\n  \n  .slick-header-column:hover, .slick-header-column-active {\n    background: white url("+w+") repeat-x center bottom;\n  }\n  \n  .slick-headerrow {\n    background: #fafafa;\n  }\n  \n  .slick-headerrow-column {\n    background: #fafafa;\n    border-bottom: 0;\n    height: 100%;\n  }\n  \n  .slick-row.ui-state-active {\n    background: #F5F7D7;\n  }\n  \n  .slick-row {\n    position: absolute;\n    background: white;\n    border: 0px;\n    line-height: 20px;\n  }\n  \n  .slick-row.selected {\n    z-index: 10;\n    background: #DFE8F6;\n  }\n  \n  .slick-cell {\n    padding-left: 4px;\n    padding-right: 4px;\n  }\n  \n  .slick-group {\n    border-bottom: 2px solid silver;\n  }\n  \n  .slick-group-toggle {\n    width: 9px;\n    height: 9px;\n    margin-right: 5px;\n  }\n  \n  .slick-group-toggle.expanded {\n    background: url("+x+") no-repeat center center;\n  }\n  \n  .slick-group-toggle.collapsed {\n    background: url("+C+") no-repeat center center;\n  }\n  \n  .slick-group-totals {\n    color: gray;\n    background: white;\n  }\n  \n  .slick-group-select-checkbox {\n    width: 13px;\n    height: 13px;\n    margin: 3px 10px 0 0;\n    display: inline-block;\n  }\n  .slick-group-select-checkbox.checked {\n    background: url("+k+") no-repeat center center;\n  }\n  \n  .slick-group-select-checkbox.unchecked {\n    background: url("+E+") no-repeat center center;\n  }\n  \n  .slick-cell.selected {\n    background-color: beige;\n  }\n  \n  .slick-cell.active {\n    border-color: gray;\n    border-style: solid;\n  }\n  \n  .slick-sortable-placeholder {\n    background: silver !important;\n  }\n  \n  .slick-row.odd {\n    background: #fafafa;\n  }\n  \n  .slick-row.ui-state-active {\n    background: #F5F7D7;\n  }\n  \n  .slick-row.loading {\n    opacity: 0.5;\n    filter: alpha(opacity = 50);\n  }\n\n  /*.active{\n    background: beige !important;\n  }*/\n  \n  .slick-cell.invalid {\n    border-color: red;\n    -moz-animation-duration: 0.2s;\n    -webkit-animation-duration: 0.2s;\n    -moz-animation-name: slickgrid-invalid-hilite;\n    -webkit-animation-name: slickgrid-invalid-hilite;  \n  }\n  \n  @-moz-keyframes slickgrid-invalid-hilite {\n    from { box-shadow: 0 0 6px red; }\n    to { box-shadow: none; }\n  }\n  \n  @-webkit-keyframes slickgrid-invalid-hilite {\n    from { box-shadow: 0 0 6px red; }\n    to { box-shadow: none; }\n  }\n\n  .slick-font-size{\n    font-size:10px;\n  }\n",""]);const S=_},7047:(t,e,n)=>{"use strict";n.d(e,{Z:()=>d});var i=n(8081),r=n.n(i),o=n(3645),s=n.n(o),a=n(1667),l=n.n(a),c=new URL(n(9855),n.b),u=s()(r()),h=l()(c);u.push([t.id,'.u-tree-list{\n  list-style-type: none;\n}\n\n.u-tree-selected{\n  background: #888;\n}\n\n.Dark .slick-row.odd{\n  background:#303030;\n}\n\n.Dark .ui-widget-content{\n  color:white;\n}\n\n.Dark .even{\n  background:#404040\n}\n\n.Dark .slick-header-column{\n  background:black;\n  color:white;\n}\n.Dark .slick-header-column:hover {\n  background: var(--menu-gradient);\n}\n.Dark .slick-header-columns{\n  background:black\n}\n.Dark .slick-header{\n  background:black\n}\n\n.Dark .slick-viewport::-webkit-scrollbar-track {\n  background: #585858;        /* color of the tracking area */\n}\n\n.Dark .slick-viewport::-webkit-scrollbar {\n  width: 12px;\n}\n.Dark .slick-viewport::-webkit-scrollbar-thumb {\n  background-color:\tblack ;\n\n}\n\n.Dark .slick-cell.selected{\n  background:\t#5c3434\n}\n\n.mdv-progress-outer{\n  background-color:gray;\n  height:16px;\n  border-radius:5px;\n  position:relative;\n}\n\n.mdv-progress-inner{\n  background-color:blue;\n  height:16px;\n  border-radius:5px; \n}\n\n.mdv-progress-text{\n \n  position: absolute;\n  top: 1px;\n  color:white;\n  width: 100%;\n  text-align: center;\n  font-size: 14px;\n  overflow:hidden,\n\n\n}\n\n.mdv-dark-mode{\n  background-color: black;\n  color:white;\n}\n\n\n\n\n.noUi-handle:after, .noUi-handle:before{\n    visibility:hidden;\n    left:-10px;\n   \n}\n.ciview-tooltip{\n  display:none;\n  position:absolute;\n  border-radius:6px;\n  padding:4px;\n  background:burlywood;\n  z-index:5;\n\n}\n\n.noUi-tooltip {\n  display: none;\n}\n.noUi-active .noUi-tooltip {\n  display: block;\n}\n\n.noUi-horizontal .noUi-handle {\n  /* fugly. also doubleslider behaviour is a bit broken I think. */\n    width: 8px;\n    height: 20px;\n    right: -4px;\n    top: -8px;\n    border-radius:20px;\n    background: rgba(73, 69, 78);\n    box-shadow: none;\n    transition: border-width 0.5s;\n}\n.noUi-handle:hover, .noUi-handle:active {\n  border-width: 0.15em;\n  transition: border-width 0.2s;\n}\n.noUi-horizontal {\n  /* top: 4px; */\n  height: 6px;\n  /* margin: 6px 10px 14px 10px; */\n}\n\n* {\n  -webkit-user-select: none;\n  -khtml-user-select: none;\n  -moz-user-select: -moz-none;\n  -o-user-select: none;\n  user-select: none;\n}\n\n.ciview-menu-icon{\n  font-weight:"bold";\n  cursor:"pointer";\n  margin:2px 4px;\n  cursor:pointer;\n}\n\n\n.ciview-menu-bar{\n  flex:0 0 auto;\n  padding:3px 20px;\n  background-image: var(--menu-gradient);\n  color: var(--text_color);\n\n}\n\n.ciview-ctm-main{\n\tposition:absolute;\n\tz-index:1000;\n\tborder:1px solid black;\n  background:white;\n\n   }\n   .ciview-ctm-active{\n       cursor:pointer\n   }\n   .ciview-ctm-selected{\n       background-color:lightgray;\n   }\n   .ciview-ctm-active:hover{\n       background-color:lightgray;\n   }\n   .ciview-ctm-item{\n       padding:4px;\n       white-space:nowrap;\n\n     \n   }\n    .ciview-ctm-item span{\n        margin-right:5px;\n        white-space:nowrap;\n    }\n\n    .ciview-ctm-left-icon{\n   \t margin-right:5px;\n   }\n\n   .ciview-ctm-ghosted{\n   \t opacity:0.5\n   }\n\n   .ciview-ctm-right-icon{\n   \t float:right\n   }\n\n   .legend-body::-webkit-scrollbar-track {\n    background: #f1f1f1; \n  }\n   \n  /* Handle */\n  .legend-body::-webkit-scrollbar-thumb {\n    background: #888; \n  }\n  \n  /* Handle on hover */\n  .legend-body::-webkit-scrollbar-thumb:hover {\n    background: #555; \n  }\n  .legend-body::-webkit-scrollbar {\n    width: 8px;\n    height:8px;\n  }\n  \n  .ciview-dlg-outer {\n  position: absolute;\n  z-index: 1100;\n  background-color: var(--background_color);\n  color: var(--text_color);\n  border: 1px solid #d3d3d3;\n  overflow:auto;\n  display:flex;\n  flex-flow:column;\n}\n\n.ciview-dlg-content {\n  font-size: 0.8rem;\n  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif;\n  background-color: var(--dlg_background_color);\n}\n.ciview-dlg-content > * {\n  display: flex;\n  flex-wrap: wrap;\n  align-items: center;\n  padding: 2px;\n}\n.ciview-dlg-content label {\n  margin-right: 0.4rem;\n  min-width: 42%;\n  flex-shrink: 0;\n}\n.ciview-dlg-content select {\n  /* width: 5em; */\n  /* flex-shrink: 1; */\n  min-width: 5em;\n  /* flex-grow: 1; nb flex-direction is now column */\n}\n.ciview-dlg-content .ciview-button {\n  display: inline-block;\n  margin: 8px;\n}\n.ciview-dlg-content .noUi-horizontal {\n  min-width: 30%;\n  flex-grow: 1;\n}\n/* .ciview-dlg-content .noUi-target {\n  background-color: var(--input_background_color);\n} */\n.ciview-radio-group {\n  display: flex;\n  flex-wrap: wrap;\n  align-items: center;\n  padding: 2px;\n  padding-left: 6px;\n  padding-bottom: 4px;\n  background-color: var(--input_background_color);\n  border-radius: 8px;\n}\n\nselect, input, textarea {\n  color: var(--text_color);\n  background-color: var(--background_color);\n}\n  \n   .gutter-horizontal{\n     float:left;\n     height:100%;\n     background-color:silver;\n     cursor:col-resize;\n   }\n\n   .split-horizontal{\n    float:left;\n    height:100%;\n   }\n  .ciview-dlg-close-icon{\n      cursor:pointer;\n      color:#eee;\n      font-size:20px;\n      margin-left:auto;\n      margin-bottom:8px;\n      position:absolute;\n      top:3px;\n      right:7px\n  }\n\n  .ciview-dlg-content{ \n        overflow-X:hidden;\n        overflow-Y:auto;\n        flex:1 1 auto;\n        padding:5px;\n  }\n  \n  .ciview-dlg-header {\n    padding: 6px;\n    cursor: move;\n    background-color: #2196F3;\n    color: #fff;\n    text-overflow: ellipsis;\n    overflow:hidden;\n    flex:0 0 auto;\n    /* margin-bottom: 0.2em; */\n  }\n\n  .ciview-dlg-header-text{\n      white-space:nowrap;\n      text-overflow: ellipsis;\n  }\n\n\n  .autocomplete-items {\n    position: absolute;\n    border: 1px solid #d4d4d4;\n    border-bottom: none;\n    border-top: none;\n    z-index: 99;\n    /*position the autocomplete items to be the same width as the container:*/\n  }\n  \n  .autocomplete-items div {\n    padding: 2px;\n    cursor: pointer;\n    background-color: #fff;\n    border-bottom: 1px solid #d4d4d4;\n    font-size:0.8em;\n  }\n  .autocomplete-items div:hover {\n    /*when hovering an item:*/\n    background-color: #e9e9e9;\n  }\n  .autocomplete-active {\n    /*when navigating through the items using the arrow keys:*/\n    background-color: DodgerBlue !important;\n    color: #ffffff;\n  }\n\n  .mdv-grid-2-columns {\n    display:grid;\n    grid-template-columns:1fr 1fr;\n    grid-template-rows:1fr 10px;\n    justify-items:left;\n  }\n\n  .mdv-grid-footer{\n    grid-area:-2 / 1 / -1 /-1; \n  }\n\n  .mdv-section {\n    white-space: nowrap;\n    padding:5px;\n  }\n\n  .mdv-disabled {\n    pointer-events:"none";\n    color:gray;\n  }\n\n  .mdv-element-dragged {\n    border: 1px solid var(--text_color);\n  }\n\n  .multiselect-dropdown{\n    white-space:normal;\n    padding: 2px 5px 0px 5px;\n    border-radius: 4px;\n    border: solid 1px #ced4da;\n    background-color: var(--input_background_color);\n    position: relative;\n    background-image: url('+h+");\n    background-repeat: no-repeat;\n    background-position: right .75rem center;\n    background-size: 16px 12px;\n  }\n  .multiselect-dropdown span.optext, .multiselect-dropdown span.placeholder{\n    margin-right:0.5em; \n    margin-bottom:2px;\n    padding:1px 0; \n    border-radius: 4px; \n    display:inline-block;\n  }\n  .multiselect-dropdown span.optext{\n    background-color:var(--background_color);\n    padding:1px 0.75em; \n    font-size:0.9em;\n  }\n  .multiselect-dropdown span.optext .optdel {\n    float: right;\n    margin: 0 -6px 1px 5px;\n    font-size: 0.7em;\n    margin-top: 2px;\n    cursor: pointer;\n    color: var(--text_color);\n  }\n  .multiselect-dropdown span.optext .optdel:hover { color: #c66;}\n  .multiselect-dropdown span.placeholder{\n    color:dimgray;\n  }\n  .multiselect-dropdown-list-wrapper{\n    box-shadow: gray 0 3px 8px;\n    z-index: 100;\n    padding:2px;\n    border-radius: 4px;\n    border: solid 1px #ced4da;\n    background-color:var(--input_background_color);\n    margin: -1px;\n    position: absolute;\n    color:var(--text_color);\n  }\n  .multiselect-dropdown-list-wrapper button{\n      margin:3px;\n      padding:2px 3px;\n      font-size:0.9em;\n  }\n  .multiselect-dropdown-list-wrapper .multiselect-dropdown-search{\n    margin-bottom:5px;\n    background:var(--input_background_color);\n    min-height:200px;\n    max-height:300px;\n  }\n  .multiselect-dropdown-list{\n    padding:2px;\n    overflow-y:auto;\n    overflow-x: hidden;\n  }\n  .multiselect-dropdown-list::-webkit-scrollbar {\n    width: 6px;\n  }\n  .multiselect-dropdown-list::-webkit-scrollbar-thumb {\n    background-color: #bec4ca;\n    border-radius:3px;\n  }\n  \n  .multiselect-dropdown-list div{\n    padding: 2px;\n    font-size:0.9em;\n    white-space:nowrap;\n  }\n  .multiselect-dropdown-list input{\n    height: 1.15em;\n    width: 1.15em;\n    margin-right: 0.35em;  \n  }\n\n  .multiselect-dropdown-list label{\n    margin-bottom:0px; \n  }\n  .multiselect-dropdown-list div.checked{\n  }\n  .multiselect-dropdown-list div:hover{\n    background-color:darkgray;\n  }\n  .multiselect-dropdown span.maxselected {width:100%;}\n  .multiselect-dropdown-all-selector {border-bottom:solid 1px #999;}\n  \n",""]);const d=u},9719:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});var i=n(8081),r=n.n(i),o=n(3645),s=n.n(o)()(r());s.push([t.id,".wgl2di-brush{\n    height:0px;\n    width:0px;\n    cursor:move;\n\tbackground-color:gray;\n    opacity:0.2;\n    position:absolute;\n}",""]);const a=s},3645:t=>{"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",i=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),i&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),i&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,i,r,o){"string"==typeof t&&(t=[[null,t,void 0]]);var s={};if(i)for(var a=0;a<this.length;a++){var l=this[a][0];null!=l&&(s[l]=!0)}for(var c=0;c<t.length;c++){var u=[].concat(t[c]);i&&s[u[0]]||(void 0!==o&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=o),n&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=n):u[2]=n),r&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=r):u[4]="".concat(r)),e.push(u))}},e}},1667:t=>{"use strict";t.exports=function(t,e){return e||(e={}),t?(t=String(t.__esModule?t.default:t),/^['"].*['"]$/.test(t)&&(t=t.slice(1,-1)),e.hash&&(t+=e.hash),/["'() \t\n]|(%20)/.test(t)||e.needQuotes?'"'.concat(t.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):t):t}},8081:t=>{"use strict";t.exports=function(t){return t[1]}},2921:(t,e,n)=>{"use strict";function i(t){return null===t?NaN:+t}n.d(e,{Z:()=>i})},9685:(t,e,n)=>{"use strict";n.d(e,{Ib:()=>i,WT:()=>r});var i=1e-6,r="undefined"!=typeof Float32Array?Float32Array:Array;Math.random,Math.PI,Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)})},5975:(t,e,n)=>{"use strict";n.d(e,{G3:()=>v,GH:()=>a,Iu:()=>c,Jp:()=>l,M5:()=>b,Q$:()=>g,U1:()=>h,U_:()=>s,bA:()=>u,en:()=>m,jI:()=>p,lM:()=>d,oy:()=>_,p4:()=>o,uD:()=>f,yR:()=>r,zB:()=>y});var i=n(9685);function r(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function o(t,e){if(t===e){var n=e[1],i=e[2],r=e[3],o=e[6],s=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=i,t[9]=o,t[11]=e[14],t[12]=r,t[13]=s,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function s(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],s=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=e[9],d=e[10],f=e[11],p=e[12],g=e[13],m=e[14],_=e[15],v=n*a-i*s,b=n*l-r*s,y=n*c-o*s,w=i*l-r*a,x=i*c-o*a,C=r*c-o*l,k=u*g-h*p,E=u*m-d*p,S=u*_-f*p,A=h*m-d*g,T=h*_-f*g,M=d*_-f*m,D=v*M-b*T+y*A+w*S-x*E+C*k;return D?(D=1/D,t[0]=(a*M-l*T+c*A)*D,t[1]=(r*T-i*M-o*A)*D,t[2]=(g*C-m*x+_*w)*D,t[3]=(d*x-h*C-f*w)*D,t[4]=(l*S-s*M-c*E)*D,t[5]=(n*M-r*S+o*E)*D,t[6]=(m*y-p*C-_*b)*D,t[7]=(u*C-d*y+f*b)*D,t[8]=(s*T-a*S+c*k)*D,t[9]=(i*S-n*T-o*k)*D,t[10]=(p*x-g*y+_*v)*D,t[11]=(h*y-u*x-f*v)*D,t[12]=(a*E-s*A-l*k)*D,t[13]=(n*A-i*E+r*k)*D,t[14]=(g*b-p*w-m*v)*D,t[15]=(u*w-h*b+d*v)*D,t):null}function a(t){var e=t[0],n=t[1],i=t[2],r=t[3],o=t[4],s=t[5],a=t[6],l=t[7],c=t[8],u=t[9],h=t[10],d=t[11],f=t[12],p=t[13],g=t[14],m=t[15];return(e*s-n*o)*(h*m-d*g)-(e*a-i*o)*(u*m-d*p)+(e*l-r*o)*(u*g-h*p)+(n*a-i*s)*(c*m-d*f)-(n*l-r*s)*(c*g-h*f)+(i*l-r*a)*(c*p-u*f)}function l(t,e,n){var i=e[0],r=e[1],o=e[2],s=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],d=e[9],f=e[10],p=e[11],g=e[12],m=e[13],_=e[14],v=e[15],b=n[0],y=n[1],w=n[2],x=n[3];return t[0]=b*i+y*a+w*h+x*g,t[1]=b*r+y*l+w*d+x*m,t[2]=b*o+y*c+w*f+x*_,t[3]=b*s+y*u+w*p+x*v,b=n[4],y=n[5],w=n[6],x=n[7],t[4]=b*i+y*a+w*h+x*g,t[5]=b*r+y*l+w*d+x*m,t[6]=b*o+y*c+w*f+x*_,t[7]=b*s+y*u+w*p+x*v,b=n[8],y=n[9],w=n[10],x=n[11],t[8]=b*i+y*a+w*h+x*g,t[9]=b*r+y*l+w*d+x*m,t[10]=b*o+y*c+w*f+x*_,t[11]=b*s+y*u+w*p+x*v,b=n[12],y=n[13],w=n[14],x=n[15],t[12]=b*i+y*a+w*h+x*g,t[13]=b*r+y*l+w*d+x*m,t[14]=b*o+y*c+w*f+x*_,t[15]=b*s+y*u+w*p+x*v,t}function c(t,e,n){var i,r,o,s,a,l,c,u,h,d,f,p,g=n[0],m=n[1],_=n[2];return e===t?(t[12]=e[0]*g+e[4]*m+e[8]*_+e[12],t[13]=e[1]*g+e[5]*m+e[9]*_+e[13],t[14]=e[2]*g+e[6]*m+e[10]*_+e[14],t[15]=e[3]*g+e[7]*m+e[11]*_+e[15]):(i=e[0],r=e[1],o=e[2],s=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],d=e[9],f=e[10],p=e[11],t[0]=i,t[1]=r,t[2]=o,t[3]=s,t[4]=a,t[5]=l,t[6]=c,t[7]=u,t[8]=h,t[9]=d,t[10]=f,t[11]=p,t[12]=i*g+a*m+h*_+e[12],t[13]=r*g+l*m+d*_+e[13],t[14]=o*g+c*m+f*_+e[14],t[15]=s*g+u*m+p*_+e[15]),t}function u(t,e,n){var i=n[0],r=n[1],o=n[2];return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function h(t,e,n,r){var o,s,a,l,c,u,h,d,f,p,g,m,_,v,b,y,w,x,C,k,E,S,A,T,M=r[0],D=r[1],P=r[2],L=Math.hypot(M,D,P);return L<i.Ib?null:(M*=L=1/L,D*=L,P*=L,o=Math.sin(n),a=1-(s=Math.cos(n)),l=e[0],c=e[1],u=e[2],h=e[3],d=e[4],f=e[5],p=e[6],g=e[7],m=e[8],_=e[9],v=e[10],b=e[11],y=M*M*a+s,w=D*M*a+P*o,x=P*M*a-D*o,C=M*D*a-P*o,k=D*D*a+s,E=P*D*a+M*o,S=M*P*a+D*o,A=D*P*a-M*o,T=P*P*a+s,t[0]=l*y+d*w+m*x,t[1]=c*y+f*w+_*x,t[2]=u*y+p*w+v*x,t[3]=h*y+g*w+b*x,t[4]=l*C+d*k+m*E,t[5]=c*C+f*k+_*E,t[6]=u*C+p*k+v*E,t[7]=h*C+g*k+b*E,t[8]=l*S+d*A+m*T,t[9]=c*S+f*A+_*T,t[10]=u*S+p*A+v*T,t[11]=h*S+g*A+b*T,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function d(t,e,n){var i=Math.sin(n),r=Math.cos(n),o=e[4],s=e[5],a=e[6],l=e[7],c=e[8],u=e[9],h=e[10],d=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*r+c*i,t[5]=s*r+u*i,t[6]=a*r+h*i,t[7]=l*r+d*i,t[8]=c*r-o*i,t[9]=u*r-s*i,t[10]=h*r-a*i,t[11]=d*r-l*i,t}function f(t,e,n){var i=Math.sin(n),r=Math.cos(n),o=e[0],s=e[1],a=e[2],l=e[3],c=e[8],u=e[9],h=e[10],d=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*r-c*i,t[1]=s*r-u*i,t[2]=a*r-h*i,t[3]=l*r-d*i,t[8]=o*i+c*r,t[9]=s*i+u*r,t[10]=a*i+h*r,t[11]=l*i+d*r,t}function p(t,e,n){var i=Math.sin(n),r=Math.cos(n),o=e[0],s=e[1],a=e[2],l=e[3],c=e[4],u=e[5],h=e[6],d=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*r+c*i,t[1]=s*r+u*i,t[2]=a*r+h*i,t[3]=l*r+d*i,t[4]=c*r-o*i,t[5]=u*r-s*i,t[6]=h*r-a*i,t[7]=d*r-l*i,t}function g(t,e){var n=e[0],i=e[1],r=e[2],o=e[4],s=e[5],a=e[6],l=e[8],c=e[9],u=e[10];return t[0]=Math.hypot(n,i,r),t[1]=Math.hypot(o,s,a),t[2]=Math.hypot(l,c,u),t}function m(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],s=n+n,a=i+i,l=r+r,c=n*s,u=i*s,h=i*a,d=r*s,f=r*a,p=r*l,g=o*s,m=o*a,_=o*l;return t[0]=1-h-p,t[1]=u+_,t[2]=d-m,t[3]=0,t[4]=u-_,t[5]=1-c-p,t[6]=f+g,t[7]=0,t[8]=d+m,t[9]=f-g,t[10]=1-c-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function _(t,e,n,i,r,o,s){var a=1/(n-e),l=1/(r-i),c=1/(o-s);return t[0]=2*o*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*l,t[6]=0,t[7]=0,t[8]=(n+e)*a,t[9]=(r+i)*l,t[10]=(s+o)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=s*o*2*c,t[15]=0,t}var v=function(t,e,n,i,r){var o,s=1/Math.tan(e/2);return t[0]=s/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=r&&r!==1/0?(o=1/(i-r),t[10]=(r+i)*o,t[14]=2*r*i*o):(t[10]=-1,t[14]=-2*i),t},b=function(t,e,n,i,r,o,s){var a=1/(e-n),l=1/(i-r),c=1/(o-s);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*a,t[13]=(r+i)*l,t[14]=(s+o)*c,t[15]=1,t};function y(t,e,n,o){var s,a,l,c,u,h,d,f,p,g,m=e[0],_=e[1],v=e[2],b=o[0],y=o[1],w=o[2],x=n[0],C=n[1],k=n[2];return Math.abs(m-x)<i.Ib&&Math.abs(_-C)<i.Ib&&Math.abs(v-k)<i.Ib?r(t):(d=m-x,f=_-C,p=v-k,s=y*(p*=g=1/Math.hypot(d,f,p))-w*(f*=g),a=w*(d*=g)-b*p,l=b*f-y*d,(g=Math.hypot(s,a,l))?(s*=g=1/g,a*=g,l*=g):(s=0,a=0,l=0),c=f*l-p*a,u=p*s-d*l,h=d*a-f*s,(g=Math.hypot(c,u,h))?(c*=g=1/g,u*=g,h*=g):(c=0,u=0,h=0),t[0]=s,t[1]=c,t[2]=d,t[3]=0,t[4]=a,t[5]=u,t[6]=f,t[7]=0,t[8]=l,t[9]=h,t[10]=p,t[11]=0,t[12]=-(s*m+a*_+l*v),t[13]=-(c*m+u*_+h*v),t[14]=-(d*m+f*_+p*v),t[15]=1,t)}},1437:(t,e,n)=>{"use strict";n.d(e,{IH:()=>o,fF:()=>c,kK:()=>l,t7:()=>a,tk:()=>s});var i,r=n(9685);function o(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function s(t,e){return t[0]=-e[0],t[1]=-e[1],t}function a(t,e,n,i){var r=e[0],o=e[1];return t[0]=r+i*(n[0]-r),t[1]=o+i*(n[1]-o),t}function l(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[3]*r+n[6],t[1]=n[1]*i+n[4]*r+n[7],t}function c(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[4]*r+n[12],t[1]=n[1]*i+n[5]*r+n[13],t}i=new r.WT(2),r.WT!=Float32Array&&(i[0]=0,i[1]=0)},7160:(t,e,n)=>{"use strict";n.d(e,{AK:()=>l,EU:()=>_,Fv:()=>a,Ue:()=>r,VC:()=>f,Zh:()=>b,al:()=>o,fF:()=>h,jI:()=>m,kC:()=>c,kK:()=>d,lM:()=>p,lu:()=>v,t7:()=>u,tk:()=>s,uD:()=>g,x9:()=>y});var i=n(9685);function r(){var t=new i.WT(3);return i.WT!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function o(t,e,n){var r=new i.WT(3);return r[0]=t,r[1]=e,r[2]=n,r}function s(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function a(t,e){var n=e[0],i=e[1],r=e[2],o=n*n+i*i+r*r;return o>0&&(o=1/Math.sqrt(o)),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o,t}function l(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function c(t,e,n){var i=e[0],r=e[1],o=e[2],s=n[0],a=n[1],l=n[2];return t[0]=r*l-o*a,t[1]=o*s-i*l,t[2]=i*a-r*s,t}function u(t,e,n,i){var r=e[0],o=e[1],s=e[2];return t[0]=r+i*(n[0]-r),t[1]=o+i*(n[1]-o),t[2]=s+i*(n[2]-s),t}function h(t,e,n){var i=e[0],r=e[1],o=e[2],s=n[3]*i+n[7]*r+n[11]*o+n[15];return s=s||1,t[0]=(n[0]*i+n[4]*r+n[8]*o+n[12])/s,t[1]=(n[1]*i+n[5]*r+n[9]*o+n[13])/s,t[2]=(n[2]*i+n[6]*r+n[10]*o+n[14])/s,t}function d(t,e,n){var i=e[0],r=e[1],o=e[2];return t[0]=i*n[0]+r*n[3]+o*n[6],t[1]=i*n[1]+r*n[4]+o*n[7],t[2]=i*n[2]+r*n[5]+o*n[8],t}function f(t,e,n){var i=n[0],r=n[1],o=n[2],s=n[3],a=e[0],l=e[1],c=e[2],u=r*c-o*l,h=o*a-i*c,d=i*l-r*a,f=r*d-o*h,p=o*u-i*d,g=i*h-r*u,m=2*s;return u*=m,h*=m,d*=m,f*=2,p*=2,g*=2,t[0]=a+u+f,t[1]=l+h+p,t[2]=c+d+g,t}function p(t,e,n,i){var r=[],o=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],o[0]=r[0],o[1]=r[1]*Math.cos(i)-r[2]*Math.sin(i),o[2]=r[1]*Math.sin(i)+r[2]*Math.cos(i),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function g(t,e,n,i){var r=[],o=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],o[0]=r[2]*Math.sin(i)+r[0]*Math.cos(i),o[1]=r[1],o[2]=r[2]*Math.cos(i)-r[0]*Math.sin(i),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function m(t,e,n,i){var r=[],o=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],o[0]=r[0]*Math.cos(i)-r[1]*Math.sin(i),o[1]=r[0]*Math.sin(i)+r[1]*Math.cos(i),o[2]=r[2],t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function _(t,e){var n=t[0],i=t[1],r=t[2],o=e[0],s=e[1],a=e[2],c=Math.sqrt(n*n+i*i+r*r)*Math.sqrt(o*o+s*s+a*a),u=c&&l(t,e)/c;return Math.acos(Math.min(Math.max(u,-1),1))}var v=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t},b=function(t){var e=t[0],n=t[1],i=t[2];return Math.hypot(e,n,i)},y=function(t){var e=t[0],n=t[1],i=t[2];return e*e+n*n+i*i};r()},8333:(t,e,n)=>{"use strict";n.d(e,{AK:()=>p,Fv:()=>f,I6:()=>v,IH:()=>c,JG:()=>a,VC:()=>_,al:()=>s,bA:()=>u,d9:()=>o,fF:()=>m,fS:()=>b,kE:()=>h,t7:()=>g,t8:()=>l,we:()=>d});var i,r=n(9685);function o(t){var e=new r.WT(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function s(t,e,n,i){var o=new r.WT(4);return o[0]=t,o[1]=e,o[2]=n,o[3]=i,o}function a(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function l(t,e,n,i,r){return t[0]=e,t[1]=n,t[2]=i,t[3]=r,t}function c(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function u(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function h(t){var e=t[0],n=t[1],i=t[2],r=t[3];return Math.hypot(e,n,i,r)}function d(t){var e=t[0],n=t[1],i=t[2],r=t[3];return e*e+n*n+i*i+r*r}function f(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],s=n*n+i*i+r*r+o*o;return s>0&&(s=1/Math.sqrt(s)),t[0]=n*s,t[1]=i*s,t[2]=r*s,t[3]=o*s,t}function p(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function g(t,e,n,i){var r=e[0],o=e[1],s=e[2],a=e[3];return t[0]=r+i*(n[0]-r),t[1]=o+i*(n[1]-o),t[2]=s+i*(n[2]-s),t[3]=a+i*(n[3]-a),t}function m(t,e,n){var i=e[0],r=e[1],o=e[2],s=e[3];return t[0]=n[0]*i+n[4]*r+n[8]*o+n[12]*s,t[1]=n[1]*i+n[5]*r+n[9]*o+n[13]*s,t[2]=n[2]*i+n[6]*r+n[10]*o+n[14]*s,t[3]=n[3]*i+n[7]*r+n[11]*o+n[15]*s,t}function _(t,e,n){var i=e[0],r=e[1],o=e[2],s=n[0],a=n[1],l=n[2],c=n[3],u=c*i+a*o-l*r,h=c*r+l*i-s*o,d=c*o+s*r-a*i,f=-s*i-a*r-l*o;return t[0]=u*c+f*-s+h*-l-d*-a,t[1]=h*c+f*-a+d*-s-u*-l,t[2]=d*c+f*-l+u*-a-h*-s,t[3]=e[3],t}function v(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function b(t,e){var n=t[0],i=t[1],o=t[2],s=t[3],a=e[0],l=e[1],c=e[2],u=e[3];return Math.abs(n-a)<=r.Ib*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(i-l)<=r.Ib*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(o-c)<=r.Ib*Math.max(1,Math.abs(o),Math.abs(c))&&Math.abs(s-u)<=r.Ib*Math.max(1,Math.abs(s),Math.abs(u))}i=new r.WT(4),r.WT!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0,i[3]=0)},249:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DDBaseImplement=void 0,e.DDBaseImplement=class{constructor(){this._eventRegister={}}get disabled(){return this._disabled}on(t,e){this._eventRegister[t]=e}off(t){delete this._eventRegister[t]}enable(){this._disabled=!1}disable(){this._disabled=!0}destroy(){delete this._eventRegister}triggerEvent(t,e){if(!this.disabled&&this._eventRegister&&this._eventRegister[t])return this._eventRegister[t](e)}}},6529:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DDDraggable=void 0;const i=n(427),r=n(9284),o=n(249),s=n(168);class a extends o.DDBaseImplement{constructor(t,e={}){super(),this.el=t,this.option=e;let n=e.handle.substring(1);this.dragEl=t.classList.contains(n)?t:t.querySelector(e.handle)||t,this._mouseDown=this._mouseDown.bind(this),this._mouseMove=this._mouseMove.bind(this),this._mouseUp=this._mouseUp.bind(this),this.enable()}on(t,e){super.on(t,e)}off(t){super.off(t)}enable(){!1!==this.disabled&&(super.enable(),this.dragEl.addEventListener("mousedown",this._mouseDown),s.isTouch&&(this.dragEl.addEventListener("touchstart",s.touchstart),this.dragEl.addEventListener("pointerdown",s.pointerdown)),this.el.classList.remove("ui-draggable-disabled"),this.el.classList.add("ui-draggable"))}disable(t=!1){!0!==this.disabled&&(super.disable(),this.dragEl.removeEventListener("mousedown",this._mouseDown),s.isTouch&&(this.dragEl.removeEventListener("touchstart",s.touchstart),this.dragEl.removeEventListener("pointerdown",s.pointerdown)),this.el.classList.remove("ui-draggable"),t||this.el.classList.add("ui-draggable-disabled"))}destroy(){this.dragTimeout&&window.clearTimeout(this.dragTimeout),delete this.dragTimeout,this.dragging&&this._mouseUp(this.mouseDownEvent),this.disable(!0),delete this.el,delete this.helper,delete this.option,super.destroy()}updateOption(t){return Object.keys(t).forEach((e=>this.option[e]=t[e])),this}_mouseDown(t){if(i.DDManager.mouseHandled)return;if(0!==t.button)return!0;const e=t.target.nodeName.toLowerCase();return["input","textarea","button","select","option"].find((t=>t===e))||t.target.closest('[contenteditable="true"]')||(this.mouseDownEvent=t,delete this.dragging,delete i.DDManager.dragElement,delete i.DDManager.dropElement,document.addEventListener("mousemove",this._mouseMove,!0),document.addEventListener("mouseup",this._mouseUp,!0),s.isTouch&&(this.dragEl.addEventListener("touchmove",s.touchmove),this.dragEl.addEventListener("touchend",s.touchend)),t.preventDefault(),document.activeElement&&document.activeElement.blur(),i.DDManager.mouseHandled=!0),!0}_callDrag(t){if(!this.dragging)return;const e=r.Utils.initEvent(t,{target:this.el,type:"drag"});this.option.drag&&this.option.drag(e,this.ui()),this.triggerEvent("drag",e)}_mouseMove(t){var e;let n=this.mouseDownEvent;if(this.dragging)if(this._dragFollow(t),i.DDManager.pauseDrag){const e=Number.isInteger(i.DDManager.pauseDrag)?i.DDManager.pauseDrag:100;this.dragTimeout&&window.clearTimeout(this.dragTimeout),this.dragTimeout=window.setTimeout((()=>this._callDrag(t)),e)}else this._callDrag(t);else if(Math.abs(t.x-n.x)+Math.abs(t.y-n.y)>3){this.dragging=!0,i.DDManager.dragElement=this;let n=null===(e=this.el.gridstackNode)||void 0===e?void 0:e.grid;n?i.DDManager.dropElement=n.el.ddElement.ddDroppable:delete i.DDManager.dropElement,this.helper=this._createHelper(t),this._setupHelperContainmentStyle(),this.dragOffset=this._getDragOffset(t,this.el,this.helperContainment);const o=r.Utils.initEvent(t,{target:this.el,type:"dragstart"});this._setupHelperStyle(t),this.option.start&&this.option.start(o,this.ui()),this.triggerEvent("dragstart",o)}return t.preventDefault(),!0}_mouseUp(t){var e;if(document.removeEventListener("mousemove",this._mouseMove,!0),document.removeEventListener("mouseup",this._mouseUp,!0),s.isTouch&&(this.dragEl.removeEventListener("touchmove",s.touchmove,!0),this.dragEl.removeEventListener("touchend",s.touchend,!0)),this.dragging){delete this.dragging,(null===(e=i.DDManager.dropElement)||void 0===e?void 0:e.el)===this.el.parentElement&&delete i.DDManager.dropElement,this.helperContainment.style.position=this.parentOriginStylePosition||null,this.helper===this.el?this._removeHelperStyle():this.helper.remove();const n=r.Utils.initEvent(t,{target:this.el,type:"dragstop"});this.option.stop&&this.option.stop(n),this.triggerEvent("dragstop",n),i.DDManager.dropElement&&i.DDManager.dropElement.drop(t)}delete this.helper,delete this.mouseDownEvent,delete i.DDManager.dragElement,delete i.DDManager.dropElement,delete i.DDManager.mouseHandled,t.preventDefault()}_createHelper(t){let e=this.el;return"function"==typeof this.option.helper?e=this.option.helper(t):"clone"===this.option.helper&&(e=r.Utils.cloneNode(this.el)),document.body.contains(e)||r.Utils.appendTo(e,"parent"===this.option.appendTo?this.el.parentNode:this.option.appendTo),e===this.el&&(this.dragElementOriginStyle=a.originStyleProp.map((t=>this.el.style[t]))),e}_setupHelperStyle(t){this.helper.classList.add("ui-draggable-dragging");const e=this.helper.style;return e.pointerEvents="none",e["min-width"]=0,e.width=this.dragOffset.width+"px",e.height=this.dragOffset.height+"px",e.willChange="left, top",e.position="fixed",this._dragFollow(t),e.transition="none",setTimeout((()=>{this.helper&&(e.transition=null)}),0),this}_removeHelperStyle(){var t;this.helper.classList.remove("ui-draggable-dragging");let e=null===(t=this.helper)||void 0===t?void 0:t.gridstackNode;if(this.dragElementOriginStyle&&(!e||!e._isAboutToRemove)){let t=this.helper,e=this.dragElementOriginStyle.transition||null;t.style.transition=this.dragElementOriginStyle.transition="none",a.originStyleProp.forEach((e=>t.style[e]=this.dragElementOriginStyle[e]||null)),setTimeout((()=>t.style.transition=e),50)}return delete this.dragElementOriginStyle,this}_dragFollow(t){const e=this.helper.style,n=this.dragOffset;e.left=t.clientX+n.offsetLeft-0+"px",e.top=t.clientY+n.offsetTop-0+"px"}_setupHelperContainmentStyle(){return this.helperContainment=this.helper.parentElement,"fixed"!==this.helper.style.position&&(this.parentOriginStylePosition=this.helperContainment.style.position,window.getComputedStyle(this.helperContainment).position.match(/static/)&&(this.helperContainment.style.position="relative")),this}_getDragOffset(t,e,n){let i=0,o=0;if(n){const t=document.createElement("div");r.Utils.addElStyles(t,{opacity:"0",position:"fixed",top:"0px",left:"0px",width:"1px",height:"1px",zIndex:"-999999"}),n.appendChild(t);const e=t.getBoundingClientRect();n.removeChild(t),i=e.left,o=e.top}const s=e.getBoundingClientRect();return{left:s.left,top:s.top,offsetLeft:-t.clientX+s.left-i,offsetTop:-t.clientY+s.top-o,width:s.width,height:s.height}}ui(){const t=this.el.parentElement.getBoundingClientRect(),e=this.helper.getBoundingClientRect();return{position:{top:e.top-t.top,left:e.left-t.left}}}}e.DDDraggable=a,a.originStyleProp=["transition","pointerEvents","position","left","top"]},2514:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DDDroppable=void 0;const i=n(427),r=n(249),o=n(9284),s=n(168);class a extends r.DDBaseImplement{constructor(t,e={}){super(),this.el=t,this.option=e,this._mouseEnter=this._mouseEnter.bind(this),this._mouseLeave=this._mouseLeave.bind(this),this.enable(),this._setupAccept()}on(t,e){super.on(t,e)}off(t){super.off(t)}enable(){!1!==this.disabled&&(super.enable(),this.el.classList.add("ui-droppable"),this.el.classList.remove("ui-droppable-disabled"),this.el.addEventListener("mouseenter",this._mouseEnter),this.el.addEventListener("mouseleave",this._mouseLeave),s.isTouch&&(this.el.addEventListener("pointerenter",s.pointerenter),this.el.addEventListener("pointerleave",s.pointerleave)))}disable(t=!1){!0!==this.disabled&&(super.disable(),this.el.classList.remove("ui-droppable"),t||this.el.classList.add("ui-droppable-disabled"),this.el.removeEventListener("mouseenter",this._mouseEnter),this.el.removeEventListener("mouseleave",this._mouseLeave),s.isTouch&&(this.el.removeEventListener("pointerenter",s.pointerenter),this.el.removeEventListener("pointerleave",s.pointerleave)))}destroy(){this.disable(!0),this.el.classList.remove("ui-droppable"),this.el.classList.remove("ui-droppable-disabled"),super.destroy()}updateOption(t){return Object.keys(t).forEach((e=>this.option[e]=t[e])),this._setupAccept(),this}_mouseEnter(t){if(!i.DDManager.dragElement)return;if(!this._canDrop(i.DDManager.dragElement.el))return;t.preventDefault(),t.stopPropagation(),i.DDManager.dropElement&&i.DDManager.dropElement!==this&&i.DDManager.dropElement._mouseLeave(t),i.DDManager.dropElement=this;const e=o.Utils.initEvent(t,{target:this.el,type:"dropover"});this.option.over&&this.option.over(e,this._ui(i.DDManager.dragElement)),this.triggerEvent("dropover",e),this.el.classList.add("ui-droppable-over")}_mouseLeave(t){var e;if(!i.DDManager.dragElement||i.DDManager.dropElement!==this)return;t.preventDefault(),t.stopPropagation();const n=o.Utils.initEvent(t,{target:this.el,type:"dropout"});if(this.option.out&&this.option.out(n,this._ui(i.DDManager.dragElement)),this.triggerEvent("dropout",n),i.DDManager.dropElement===this){let n;delete i.DDManager.dropElement;let r=this.el.parentElement;for(;!n&&r;)n=null===(e=r.ddElement)||void 0===e?void 0:e.ddDroppable,r=r.parentElement;n&&n._mouseEnter(t)}}drop(t){t.preventDefault();const e=o.Utils.initEvent(t,{target:this.el,type:"drop"});this.option.drop&&this.option.drop(e,this._ui(i.DDManager.dragElement)),this.triggerEvent("drop",e)}_canDrop(t){return t&&(!this.accept||this.accept(t))}_setupAccept(){return this.option.accept?("string"==typeof this.option.accept?this.accept=t=>t.matches(this.option.accept):this.accept=this.option.accept,this):this}_ui(t){return Object.assign({draggable:t.el},t.ui())}}e.DDDroppable=a},4474:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DDElement=void 0;const i=n(3945),r=n(6529),o=n(2514);class s{constructor(t){this.el=t}static init(t){return t.ddElement||(t.ddElement=new s(t)),t.ddElement}on(t,e){return this.ddDraggable&&["drag","dragstart","dragstop"].indexOf(t)>-1?this.ddDraggable.on(t,e):this.ddDroppable&&["drop","dropover","dropout"].indexOf(t)>-1?this.ddDroppable.on(t,e):this.ddResizable&&["resizestart","resize","resizestop"].indexOf(t)>-1&&this.ddResizable.on(t,e),this}off(t){return this.ddDraggable&&["drag","dragstart","dragstop"].indexOf(t)>-1?this.ddDraggable.off(t):this.ddDroppable&&["drop","dropover","dropout"].indexOf(t)>-1?this.ddDroppable.off(t):this.ddResizable&&["resizestart","resize","resizestop"].indexOf(t)>-1&&this.ddResizable.off(t),this}setupDraggable(t){return this.ddDraggable?this.ddDraggable.updateOption(t):this.ddDraggable=new r.DDDraggable(this.el,t),this}cleanDraggable(){return this.ddDraggable&&(this.ddDraggable.destroy(),delete this.ddDraggable),this}setupResizable(t){return this.ddResizable?this.ddResizable.updateOption(t):this.ddResizable=new i.DDResizable(this.el,t),this}cleanResizable(){return this.ddResizable&&(this.ddResizable.destroy(),delete this.ddResizable),this}setupDroppable(t){return this.ddDroppable?this.ddDroppable.updateOption(t):this.ddDroppable=new o.DDDroppable(this.el,t),this}cleanDroppable(){return this.ddDroppable&&(this.ddDroppable.destroy(),delete this.ddDroppable),this}}e.DDElement=s},6470:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DDGridStack=void 0;const i=n(7523),r=n(5929),o=n(9284),s=n(427),a=n(4474);class l{static get(){return c}resizable(t,e,n,i){return this._getDDElements(t).forEach((t=>{if("disable"===e||"enable"===e)t.ddResizable&&t.ddResizable[e]();else if("destroy"===e)t.ddResizable&&t.cleanResizable();else if("option"===e)t.setupResizable({[n]:i});else{const n=t.el.gridstackNode.grid;let i=t.el.getAttribute("gs-resize-handles")?t.el.getAttribute("gs-resize-handles"):n.opts.resizable.handles,r=!n.opts.alwaysShowResizeHandle;t.setupResizable(Object.assign(Object.assign(Object.assign({},n.opts.resizable),{handles:i,autoHide:r}),{start:e.start,stop:e.stop,resize:e.resize}))}})),this}draggable(t,e,n,i){return this._getDDElements(t).forEach((t=>{if("disable"===e||"enable"===e)t.ddDraggable&&t.ddDraggable[e]();else if("destroy"===e)t.ddDraggable&&t.cleanDraggable();else if("option"===e)t.setupDraggable({[n]:i});else{const n=t.el.gridstackNode.grid;t.setupDraggable(Object.assign(Object.assign({},n.opts.draggable),{start:e.start,stop:e.stop,drag:e.drag}))}})),this}dragIn(t,e){return this._getDDElements(t).forEach((t=>t.setupDraggable(e))),this}droppable(t,e,n,i){return"function"!=typeof e.accept||e._accept||(e._accept=e.accept,e.accept=t=>e._accept(t)),this._getDDElements(t).forEach((t=>{"disable"===e||"enable"===e?t.ddDroppable&&t.ddDroppable[e]():"destroy"===e?t.ddDroppable&&t.cleanDroppable():"option"===e?t.setupDroppable({[n]:i}):t.setupDroppable(e)})),this}isDroppable(t){return!(!(t&&t.ddElement&&t.ddElement.ddDroppable)||t.ddElement.ddDroppable.disabled)}isDraggable(t){return!(!(t&&t.ddElement&&t.ddElement.ddDraggable)||t.ddElement.ddDraggable.disabled)}isResizable(t){return!(!(t&&t.ddElement&&t.ddElement.ddResizable)||t.ddElement.ddResizable.disabled)}on(t,e,n){return this._getDDElements(t).forEach((t=>t.on(e,(t=>{n(t,s.DDManager.dragElement?s.DDManager.dragElement.el:t.target,s.DDManager.dragElement?s.DDManager.dragElement.helper:null)})))),this}off(t,e){return this._getDDElements(t).forEach((t=>t.off(e))),this}_getDDElements(t,e=!0){let n=o.Utils.getElements(t);if(!n.length)return[];let i=n.map((t=>t.ddElement||(e?a.DDElement.init(t):null)));return e||i.filter((t=>t)),i}}e.DDGridStack=l;const c=new l;function u(t,e){let n=t?t.gridstackNode:void 0;n&&n.grid&&(e?n._isAboutToRemove=!0:delete n._isAboutToRemove,e?t.classList.add("grid-stack-item-removing"):t.classList.remove("grid-stack-item-removing"))}r.GridStack.prototype._setupAcceptWidget=function(){if(this.opts.staticGrid||!this.opts.acceptWidgets&&!this.opts.removable)return c.droppable(this.el,"destroy"),this;let t,e,n=(n,i,r)=>{let s=i.gridstackNode;if(!s)return;r=r||i;let a=this.el.getBoundingClientRect(),{top:l,left:u}=r.getBoundingClientRect();u-=a.left,l-=a.top;let h={position:{top:l,left:u}};if(s._temporaryRemoved){if(s.x=Math.max(0,Math.round(u/e)),s.y=Math.max(0,Math.round(l/t)),delete s.autoPosition,this.engine.nodeBoundFix(s),!this.engine.willItFit(s)){if(s.autoPosition=!0,!this.engine.willItFit(s))return void c.off(i,"drag");s._willFitPos&&(o.Utils.copyPos(s,s._willFitPos),delete s._willFitPos)}this._onStartMoving(r,n,h,s,e,t)}else this._dragOrResize(r,n,h,s,e,t)};return c.droppable(this.el,{accept:t=>{let e=t.gridstackNode;if((null==e?void 0:e.grid)===this)return!0;if(!this.opts.acceptWidgets)return!1;let n=!0;if("function"==typeof this.opts.acceptWidgets)n=this.opts.acceptWidgets(t);else{let e=!0===this.opts.acceptWidgets?".grid-stack-item":this.opts.acceptWidgets;n=t.matches(e)}if(n&&e&&this.opts.maxRow){let t={w:e.w,h:e.h,minW:e.minW,minH:e.minH};n=this.engine.willItFit(t)}return n}}).on(this.el,"dropover",((i,r,o)=>{let s=r.gridstackNode;if((null==s?void 0:s.grid)===this&&!s._temporaryRemoved)return!1;(null==s?void 0:s.grid)&&s.grid!==this&&!s._temporaryRemoved&&s.grid._leave(r,o),e=this.cellWidth(),t=this.getCellHeight(!0),s||(s=this._readAttr(r)),s.grid||(s._isExternal=!0,r.gridstackNode=s),o=o||r;let a=s.w||Math.round(o.offsetWidth/e)||1,l=s.h||Math.round(o.offsetHeight/t)||1;return s.grid&&s.grid!==this?(r._gridstackNodeOrig||(r._gridstackNodeOrig=s),r.gridstackNode=s=Object.assign(Object.assign({},s),{w:a,h:l,grid:this}),this.engine.cleanupNode(s).nodeBoundFix(s),s._initDD=s._isExternal=s._temporaryRemoved=!0):(s.w=a,s.h=l,s._temporaryRemoved=!0),u(s.el,!1),c.on(r,"drag",n),n(i,r,o),!1})).on(this.el,"dropout",((t,e,n)=>{let i=e.gridstackNode;return!!i&&(i.grid&&i.grid!==this||(this._leave(e,n),this._isTemp&&this.removeAsSubGrid(i)),!1)})).on(this.el,"drop",((t,e,n)=>{var i,r;let s=e.gridstackNode;if((null==s?void 0:s.grid)===this&&!s._isExternal)return!1;let a=!!this.placeholder.parentElement;this.placeholder.remove();let l=e._gridstackNodeOrig;if(delete e._gridstackNodeOrig,a&&(null==l?void 0:l.grid)&&l.grid!==this){let t=l.grid;t.engine.removedNodes.push(l),t._triggerRemoveEvent(),t.parentGridItem&&!t.engine.nodes.length&&t.opts.subGridDynamic&&t.removeAsSubGrid()}if(!s)return!1;if(a&&(this.engine.cleanupNode(s),s.grid=this),c.off(e,"drag"),n!==e?(n.remove(),e.gridstackNode=l,a&&(e=e.cloneNode(!0))):(e.remove(),this._removeDD(e)),!a)return!1;e.gridstackNode=s,s.el=e;let u=null===(r=null===(i=s.subGrid)||void 0===i?void 0:i.el)||void 0===r?void 0:r.gridstack;return o.Utils.copyPos(s,this._readAttr(this.placeholder)),o.Utils.removePositioningStyles(e),this._writeAttr(e,s),this.el.appendChild(e),u&&(u.parentGridItem=s,u.opts.styleInHead||u._updateStyles(!0)),this._updateContainerHeight(),this.engine.addedNodes.push(s),this._triggerAddEvent(),this._triggerChangeEvent(),this.engine.endUpdate(),this._gsEventHandler.dropped&&this._gsEventHandler.dropped(Object.assign(Object.assign({},t),{type:"dropped"}),l&&l.grid?l:void 0,s),window.setTimeout((()=>{s.el&&s.el.parentElement?this._prepareDragDropByNode(s):this.engine.removeNode(s),delete s.grid._isTemp})),!1})),this},r.GridStack.prototype._setupRemoveDrop=function(){if(!this.opts.staticGrid&&"string"==typeof this.opts.removable){let t=document.querySelector(this.opts.removable);if(!t)return this;c.isDroppable(t)||c.droppable(t,this.opts.removableOptions).on(t,"dropover",((t,e)=>u(e,!0))).on(t,"dropout",((t,e)=>u(e,!1)))}return this},r.GridStack.setupDragIn=function(t,e){void 0!==(null==e?void 0:e.pause)&&(s.DDManager.pauseDrag=e.pause),"string"==typeof t&&(e=Object.assign(Object.assign({},i.dragInDefaultOptions),e||{}),o.Utils.getElements(t).forEach((t=>{c.isDraggable(t)||c.dragIn(t,e)})))},r.GridStack.prototype._prepareDragDropByNode=function(t){let e=t.el;const n=t.noMove||this.opts.disableDrag,i=t.noResize||this.opts.disableResize;if(this.opts.staticGrid||n&&i)return t._initDD&&(this._removeDD(e),delete t._initDD),e.classList.add("ui-draggable-disabled","ui-resizable-disabled"),this;if(!t._initDD){let n,i,r=(r,o)=>{this._gsEventHandler[r.type]&&this._gsEventHandler[r.type](r,r.target),n=this.cellWidth(),i=this.getCellHeight(!0),this._onStartMoving(e,r,o,t,n,i)},s=(r,o)=>{this._dragOrResize(e,r,o,t,n,i)},a=n=>{this.placeholder.remove(),delete t._moving,delete t._event,delete t._lastTried;let i=n.target;if(i.gridstackNode&&i.gridstackNode.grid===this){if(t.el=i,t._isAboutToRemove){let r=e.gridstackNode.grid;r._gsEventHandler[n.type]&&r._gsEventHandler[n.type](n,i),this._removeDD(e),r.engine.removedNodes.push(t),r._triggerRemoveEvent(),delete e.gridstackNode,delete t.el,e.remove()}else o.Utils.removePositioningStyles(i),t._temporaryRemoved?(o.Utils.copyPos(t,t._orig),this._writePosAttr(i,t),this.engine.addNode(t)):this._writePosAttr(i,t),this._gsEventHandler[n.type]&&this._gsEventHandler[n.type](n,i);this._extraDragRow=0,this._updateContainerHeight(),this._triggerChangeEvent(),this.engine.endUpdate()}};c.draggable(e,{start:r,stop:a,drag:s}).resizable(e,{start:r,stop:a,resize:s}),t._initDD=!0}return c.draggable(e,n?"disable":"enable").resizable(e,i?"disable":"enable"),this},r.GridStack.prototype._onStartMoving=function(t,e,n,i,r,o){this.engine.cleanNodes().beginUpdate(i),this._writePosAttr(this.placeholder,i),this.el.appendChild(this.placeholder),i.el=this.placeholder,i._lastUiPosition=n.position,i._prevYPix=n.position.top,i._moving="dragstart"===e.type,delete i._lastTried,"dropover"===e.type&&i._temporaryRemoved&&(this.engine.addNode(i),i._moving=!0),this.engine.cacheRects(r,o,this.opts.marginTop,this.opts.marginRight,this.opts.marginBottom,this.opts.marginLeft),"resizestart"===e.type&&(c.resizable(t,"option","minWidth",r*(i.minW||1)).resizable(t,"option","minHeight",o*(i.minH||1)),i.maxW&&c.resizable(t,"option","maxWidth",r*i.maxW),i.maxH&&c.resizable(t,"option","maxHeight",o*i.maxH))},r.GridStack.prototype._leave=function(t,e){let n=t.gridstackNode;n&&(c.off(t,"drag"),n._temporaryRemoved||(n._temporaryRemoved=!0,this.engine.removeNode(n),n.el=n._isExternal&&e?e:t,!0===this.opts.removable&&u(t,!0),t._gridstackNodeOrig?(t.gridstackNode=t._gridstackNodeOrig,delete t._gridstackNodeOrig):n._isExternal&&(delete n.el,delete t.gridstackNode,this.engine.restoreInitial())))},r.GridStack.prototype._dragOrResize=function(t,e,n,i,r,s){let a,l=Object.assign({},i._orig),c=this.opts.marginLeft,u=this.opts.marginRight,h=this.opts.marginTop,d=this.opts.marginBottom,f=Math.round(.1*s),p=Math.round(.1*r);if(c=Math.min(c,p),u=Math.min(u,p),h=Math.min(h,f),d=Math.min(d,f),"drag"===e.type){if(i._temporaryRemoved)return;let e=n.position.top-i._prevYPix;i._prevYPix=n.position.top,o.Utils.updateScrollPosition(t,n.position,e);let a=n.position.left+(n.position.left>i._lastUiPosition.left?-u:c),f=n.position.top+(n.position.top>i._lastUiPosition.top?-d:h);l.x=Math.round(a/r),l.y=Math.round(f/s);let p=this._extraDragRow;if(this.engine.collide(i,l)){let t=this.getRow(),e=Math.max(0,l.y+i.h-t);this.opts.maxRow&&t+e>this.opts.maxRow&&(e=Math.max(0,this.opts.maxRow-t)),this._extraDragRow=e}else this._extraDragRow=0;if(this._extraDragRow!==p&&this._updateContainerHeight(),i.x===l.x&&i.y===l.y)return}else if("resize"===e.type){if(l.x<0)return;if(o.Utils.updateScrollResize(e,t,s),l.w=Math.round((n.size.width-c)/r),l.h=Math.round((n.size.height-h)/s),i.w===l.w&&i.h===l.h)return;if(i._lastTried&&i._lastTried.w===l.w&&i._lastTried.h===l.h)return;let u=n.position.left+c,d=n.position.top+h;l.x=Math.round(u/r),l.y=Math.round(d/s),a=!0}i._event=e,i._lastTried=l;let g={x:n.position.left+c,y:n.position.top+h,w:(n.size?n.size.width:i.w*r)-c-u,h:(n.size?n.size.height:i.h*s)-h-d};if(this.engine.moveNodeCheck(i,Object.assign(Object.assign({},l),{cellWidth:r,cellHeight:s,rect:g,resizing:a}))){i._lastUiPosition=n.position,this.engine.cacheRects(r,s,h,u,d,c),delete i._skipDown,a&&i.subGrid&&i.subGrid.onParentResize(),this._extraDragRow=0,this._updateContainerHeight();let t=e.target;this._writePosAttr(t,i),this._gsEventHandler[e.type]&&this._gsEventHandler[e.type](e,t)}},r.GridStack.prototype.movable=function(t,e){return this.opts.staticGrid||r.GridStack.getElements(t).forEach((t=>{let n=t.gridstackNode;n&&(e?delete n.noMove:n.noMove=!0,this._prepareDragDropByNode(n))})),this},r.GridStack.prototype.resizable=function(t,e){return this.opts.staticGrid||r.GridStack.getElements(t).forEach((t=>{let n=t.gridstackNode;n&&(e?delete n.noResize:n.noResize=!0,this._prepareDragDropByNode(n))})),this},r.GridStack.prototype.disable=function(){if(!this.opts.staticGrid)return this.enableMove(!1),this.enableResize(!1),this._triggerEvent("disable"),this},r.GridStack.prototype.enable=function(){if(!this.opts.staticGrid)return this.enableMove(!0),this.enableResize(!0),this._triggerEvent("enable"),this},r.GridStack.prototype.enableMove=function(t){return this.opts.staticGrid||(this.opts.disableDrag=!t,this.engine.nodes.forEach((e=>this.movable(e.el,t)))),this},r.GridStack.prototype.enableResize=function(t){return this.opts.staticGrid||(this.opts.disableResize=!t,this.engine.nodes.forEach((e=>this.resizable(e.el,t)))),this},r.GridStack.prototype._removeDD=function(t){return c.draggable(t,"destroy").resizable(t,"destroy"),t.gridstackNode&&delete t.gridstackNode._initDD,delete t.ddElement,this}},427:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DDManager=void 0,e.DDManager=class{}},4952:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DDResizableHandle=void 0;const i=n(168);class r{constructor(t,e,n){this.moving=!1,this.host=t,this.dir=e,this.option=n,this._mouseDown=this._mouseDown.bind(this),this._mouseMove=this._mouseMove.bind(this),this._mouseUp=this._mouseUp.bind(this),this._init()}_init(){const t=document.createElement("div");return t.classList.add("ui-resizable-handle"),t.classList.add(`${r.prefix}${this.dir}`),t.style.zIndex="100",t.style.userSelect="none",this.el=t,this.host.appendChild(this.el),this.el.addEventListener("mousedown",this._mouseDown),i.isTouch&&(this.el.addEventListener("touchstart",i.touchstart),this.el.addEventListener("pointerdown",i.pointerdown)),this}destroy(){return this.moving&&this._mouseUp(this.mouseDownEvent),this.el.removeEventListener("mousedown",this._mouseDown),i.isTouch&&(this.el.removeEventListener("touchstart",i.touchstart),this.el.removeEventListener("pointerdown",i.pointerdown)),this.host.removeChild(this.el),delete this.el,delete this.host,this}_mouseDown(t){this.mouseDownEvent=t,document.addEventListener("mousemove",this._mouseMove,!0),document.addEventListener("mouseup",this._mouseUp,!0),i.isTouch&&(this.el.addEventListener("touchmove",i.touchmove),this.el.addEventListener("touchend",i.touchend)),t.stopPropagation(),t.preventDefault()}_mouseMove(t){let e=this.mouseDownEvent;this.moving?this._triggerEvent("move",t):Math.abs(t.x-e.x)+Math.abs(t.y-e.y)>2&&(this.moving=!0,this._triggerEvent("start",this.mouseDownEvent),this._triggerEvent("move",t)),t.stopPropagation(),t.preventDefault()}_mouseUp(t){this.moving&&this._triggerEvent("stop",t),document.removeEventListener("mousemove",this._mouseMove,!0),document.removeEventListener("mouseup",this._mouseUp,!0),i.isTouch&&(this.el.removeEventListener("touchmove",i.touchmove),this.el.removeEventListener("touchend",i.touchend)),delete this.moving,delete this.mouseDownEvent,t.stopPropagation(),t.preventDefault()}_triggerEvent(t,e){return this.option[t]&&this.option[t](e),this}}e.DDResizableHandle=r,r.prefix="ui-resizable-"},3945:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DDResizable=void 0;const i=n(4952),r=n(249),o=n(9284),s=n(427);class a extends r.DDBaseImplement{constructor(t,e={}){super(),this._ui=()=>{const t=this.el.parentElement.getBoundingClientRect(),e={width:this.originalRect.width,height:this.originalRect.height+this.scrolled,left:this.originalRect.left,top:this.originalRect.top-this.scrolled},n=this.temporalRect||e;return{position:{left:n.left-t.left,top:n.top-t.top},size:{width:n.width,height:n.height}}},this.el=t,this.option=e,this._mouseOver=this._mouseOver.bind(this),this._mouseOut=this._mouseOut.bind(this),this.enable(),this._setupAutoHide(this.option.autoHide),this._setupHandlers()}on(t,e){super.on(t,e)}off(t){super.off(t)}enable(){super.enable(),this.el.classList.add("ui-resizable"),this.el.classList.remove("ui-resizable-disabled"),this._setupAutoHide(this.option.autoHide)}disable(){super.disable(),this.el.classList.add("ui-resizable-disabled"),this.el.classList.remove("ui-resizable"),this._setupAutoHide(!1)}destroy(){this._removeHandlers(),this._setupAutoHide(!1),this.el.classList.remove("ui-resizable"),delete this.el,super.destroy()}updateOption(t){let e=t.handles&&t.handles!==this.option.handles,n=t.autoHide&&t.autoHide!==this.option.autoHide;return Object.keys(t).forEach((e=>this.option[e]=t[e])),e&&(this._removeHandlers(),this._setupHandlers()),n&&this._setupAutoHide(this.option.autoHide),this}_setupAutoHide(t){return t?(this.el.classList.add("ui-resizable-autohide"),this.el.addEventListener("mouseover",this._mouseOver),this.el.addEventListener("mouseout",this._mouseOut)):(this.el.classList.remove("ui-resizable-autohide"),this.el.removeEventListener("mouseover",this._mouseOver),this.el.removeEventListener("mouseout",this._mouseOut),s.DDManager.overResizeElement===this&&delete s.DDManager.overResizeElement),this}_mouseOver(t){s.DDManager.overResizeElement||s.DDManager.dragElement||(s.DDManager.overResizeElement=this,this.el.classList.remove("ui-resizable-autohide"))}_mouseOut(t){s.DDManager.overResizeElement===this&&(delete s.DDManager.overResizeElement,this.el.classList.add("ui-resizable-autohide"))}_setupHandlers(){let t=this.option.handles||"e,s,se";return"all"===t&&(t="n,e,s,w,se,sw,ne,nw"),this.handlers=t.split(",").map((t=>t.trim())).map((t=>new i.DDResizableHandle(this.el,t,{start:t=>{this._resizeStart(t)},stop:t=>{this._resizeStop(t)},move:e=>{this._resizing(e,t)}}))),this}_resizeStart(t){this.originalRect=this.el.getBoundingClientRect(),this.scrollEl=o.Utils.getScrollElement(this.el),this.scrollY=this.scrollEl.scrollTop,this.scrolled=0,this.startEvent=t,this._setupHelper(),this._applyChange();const e=o.Utils.initEvent(t,{type:"resizestart",target:this.el});return this.option.start&&this.option.start(e,this._ui()),this.el.classList.add("ui-resizable-resizing"),this.triggerEvent("resizestart",e),this}_resizing(t,e){this.scrolled=this.scrollEl.scrollTop-this.scrollY,this.temporalRect=this._getChange(t,e),this._applyChange();const n=o.Utils.initEvent(t,{type:"resize",target:this.el});return this.option.resize&&this.option.resize(n,this._ui()),this.triggerEvent("resize",n),this}_resizeStop(t){const e=o.Utils.initEvent(t,{type:"resizestop",target:this.el});return this.option.stop&&this.option.stop(e),this.el.classList.remove("ui-resizable-resizing"),this.triggerEvent("resizestop",e),this._cleanHelper(),delete this.startEvent,delete this.originalRect,delete this.temporalRect,delete this.scrollY,delete this.scrolled,this}_setupHelper(){return this.elOriginStyleVal=a._originStyleProp.map((t=>this.el.style[t])),this.parentOriginStylePosition=this.el.parentElement.style.position,window.getComputedStyle(this.el.parentElement).position.match(/static/)&&(this.el.parentElement.style.position="relative"),this.el.style.position="absolute",this.el.style.opacity="0.8",this}_cleanHelper(){return a._originStyleProp.forEach(((t,e)=>{this.el.style[t]=this.elOriginStyleVal[e]||null})),this.el.parentElement.style.position=this.parentOriginStylePosition||null,this}_getChange(t,e){const n=this.startEvent,i={width:this.originalRect.width,height:this.originalRect.height+this.scrolled,left:this.originalRect.left,top:this.originalRect.top-this.scrolled},r=t.clientX-n.clientX,o=t.clientY-n.clientY;e.indexOf("e")>-1?i.width+=r:e.indexOf("w")>-1&&(i.width-=r,i.left+=r),e.indexOf("s")>-1?i.height+=o:e.indexOf("n")>-1&&(i.height-=o,i.top+=o);const s=this._constrainSize(i.width,i.height);return Math.round(i.width)!==Math.round(s.width)&&(e.indexOf("w")>-1&&(i.left+=i.width-s.width),i.width=s.width),Math.round(i.height)!==Math.round(s.height)&&(e.indexOf("n")>-1&&(i.top+=i.height-s.height),i.height=s.height),i}_constrainSize(t,e){const n=this.option.maxWidth||Number.MAX_SAFE_INTEGER,i=this.option.minWidth||t,r=this.option.maxHeight||Number.MAX_SAFE_INTEGER,o=this.option.minHeight||e;return{width:Math.min(n,Math.max(i,t)),height:Math.min(r,Math.max(o,e))}}_applyChange(){let t={left:0,top:0,width:0,height:0};if("absolute"===this.el.style.position){const e=this.el.parentElement,{left:n,top:i}=e.getBoundingClientRect();t={left:n,top:i,width:0,height:0}}return this.temporalRect?(Object.keys(this.temporalRect).forEach((e=>{const n=this.temporalRect[e];this.el.style[e]=n-t[e]+"px"})),this):this}_removeHandlers(){return this.handlers.forEach((t=>t.destroy())),delete this.handlers,this}}e.DDResizable=a,a._originStyleProp=["width","height","position","left","top","opacity","zIndex"]},168:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.pointerleave=e.pointerenter=e.pointerdown=e.touchend=e.touchmove=e.touchstart=e.isTouch=void 0;const i=n(427);e.isTouch="undefined"!=typeof window&&"undefined"!=typeof document&&("ontouchstart"in document||"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0);class r{}function o(t,e){if(t.touches.length>1)return;t.cancelable&&t.preventDefault();const n=t.changedTouches[0],i=document.createEvent("MouseEvents");i.initMouseEvent(e,!0,!0,window,1,n.screenX,n.screenY,n.clientX,n.clientY,!1,!1,!1,!1,0,null),t.target.dispatchEvent(i)}function s(t,e){t.cancelable&&t.preventDefault();const n=document.createEvent("MouseEvents");n.initMouseEvent(e,!0,!0,window,1,t.screenX,t.screenY,t.clientX,t.clientY,!1,!1,!1,!1,0,null),t.target.dispatchEvent(n)}e.touchstart=function(t){r.touchHandled||(r.touchHandled=!0,o(t,"mousedown"))},e.touchmove=function(t){r.touchHandled&&o(t,"mousemove")},e.touchend=function(t){if(!r.touchHandled)return;r.pointerLeaveTimeout&&(window.clearTimeout(r.pointerLeaveTimeout),delete r.pointerLeaveTimeout);const e=!!i.DDManager.dragElement;o(t,"mouseup"),e||o(t,"click"),r.touchHandled=!1},e.pointerdown=function(t){t.target.releasePointerCapture(t.pointerId)},e.pointerenter=function(t){i.DDManager.dragElement&&s(t,"mouseenter")},e.pointerleave=function(t){i.DDManager.dragElement&&(r.pointerLeaveTimeout=window.setTimeout((()=>{delete r.pointerLeaveTimeout,s(t,"mouseleave")}),10))}},6935:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GridStackEngine=void 0;const i=n(9284);class r{constructor(t={}){this.addedNodes=[],this.removedNodes=[],this.column=t.column||12,this.maxRow=t.maxRow,this._float=t.float,this.nodes=t.nodes||[],this.onChange=t.onChange}batchUpdate(t=!0){return!!this.batchMode===t||(this.batchMode=t,t?(this._prevFloat=this._float,this._float=!0,this.saveInitial()):(this._float=this._prevFloat,delete this._prevFloat,this._packNodes()._notify())),this}_useEntireRowArea(t,e){return!this.float&&!this._hasLocked&&(!t._moving||t._skipDown||e.y<=t.y)}_fixCollisions(t,e=t,n,r={}){if(this.sortNodes(-1),!(n=n||this.collide(t,e)))return!1;if(t._moving&&!r.nested&&!this.float&&this.swap(t,n))return!0;let o=e;this._useEntireRowArea(t,e)&&(o={x:0,w:this.column,y:e.y,h:e.h},n=this.collide(t,o,r.skip));let s=!1,a={nested:!0,pack:!1};for(;n=n||this.collide(t,o,r.skip);){let o;if(n.locked||t._moving&&!t._skipDown&&e.y>t.y&&!this.float&&(!this.collide(n,Object.assign(Object.assign({},n),{y:t.y}),t)||!this.collide(n,Object.assign(Object.assign({},n),{y:e.y-n.h}),t))?(t._skipDown=t._skipDown||e.y>t.y,o=this.moveNode(t,Object.assign(Object.assign(Object.assign({},e),{y:n.y+n.h}),a)),n.locked&&o?i.Utils.copyPos(e,t):!n.locked&&o&&r.pack&&(this._packNodes(),e.y=n.y+n.h,i.Utils.copyPos(t,e)),s=s||o):o=this.moveNode(n,Object.assign(Object.assign(Object.assign({},n),{y:e.y+e.h,skip:t}),a)),!o)return s;n=void 0}return s}collide(t,e=t,n){return this.nodes.find((r=>r!==t&&r!==n&&i.Utils.isIntercepted(r,e)))}collideAll(t,e=t,n){return this.nodes.filter((r=>r!==t&&r!==n&&i.Utils.isIntercepted(r,e)))}directionCollideCoverage(t,e,n){if(!e.rect||!t._rect)return;let i,r=t._rect,o=Object.assign({},e.rect);return o.y>r.y?(o.h+=o.y-r.y,o.y=r.y):o.h+=r.y-o.y,o.x>r.x?(o.w+=o.x-r.x,o.x=r.x):o.w+=r.x-o.x,n.forEach((t=>{if(t.locked||!t._rect)return;let e=t._rect,n=Number.MAX_VALUE,s=Number.MAX_VALUE,a=.5;r.y<e.y?n=(o.y+o.h-e.y)/e.h:r.y+r.h>e.y+e.h&&(n=(e.y+e.h-o.y)/e.h),r.x<e.x?s=(o.x+o.w-e.x)/e.w:r.x+r.w>e.x+e.w&&(s=(e.x+e.w-o.x)/e.w);let l=Math.min(s,n);l>a&&(a=l,i=t)})),e.collide=i,i}cacheRects(t,e,n,i,r,o){return this.nodes.forEach((s=>s._rect={y:s.y*e+n,x:s.x*t+o,w:s.w*t-o-i,h:s.h*e-n-r})),this}swap(t,e){if(!e||e.locked||!t||t.locked)return!1;function n(){let n=e.x,i=e.y;return e.x=t.x,e.y=t.y,t.h!=e.h?(t.x=n,t.y=e.y+e.h):t.w!=e.w?(t.x=e.x+e.w,t.y=i):(t.x=n,t.y=i),t._dirty=e._dirty=!0,!0}let r;if(t.w===e.w&&t.h===e.h&&(t.x===e.x||t.y===e.y)&&(r=i.Utils.isTouching(t,e)))return n();if(!1!==r){if(t.w===e.w&&t.x===e.x&&(r||(r=i.Utils.isTouching(t,e)))){if(e.y<t.y){let n=t;t=e,e=n}return n()}if(!1!==r){if(t.h===e.h&&t.y===e.y&&(r||(r=i.Utils.isTouching(t,e)))){if(e.x<t.x){let n=t;t=e,e=n}return n()}return!1}}}isAreaEmpty(t,e,n,i){let r={x:t||0,y:e||0,w:n||1,h:i||1};return!this.collide(r)}compact(){if(0===this.nodes.length)return this;this.batchUpdate().sortNodes();let t=this.nodes;return this.nodes=[],t.forEach((t=>{t.locked||(t.autoPosition=!0),this.addNode(t,!1),t._dirty=!0})),this.batchUpdate(!1)}set float(t){this._float!==t&&(this._float=t||!1,t||this._packNodes()._notify())}get float(){return this._float||!1}sortNodes(t){return this.nodes=i.Utils.sort(this.nodes,t,this.column),this}_packNodes(){return this.batchMode||(this.sortNodes(),this.float?this.nodes.forEach((t=>{if(t._updating||void 0===t._orig||t.y===t._orig.y)return;let e=t.y;for(;e>t._orig.y;)--e,this.collide(t,{x:t.x,y:e,w:t.w,h:t.h})||(t._dirty=!0,t.y=e)})):this.nodes.forEach(((t,e)=>{if(!t.locked)for(;t.y>0;){let n=0===e?0:t.y-1;if(0!==e&&this.collide(t,{x:t.x,y:n,w:t.w,h:t.h}))break;t._dirty=t.y!==n,t.y=n}}))),this}prepareNode(t,e){(t=t||{})._id=t._id||r._idSeq++,void 0!==t.x&&void 0!==t.y&&null!==t.x&&null!==t.y||(t.autoPosition=!0);let n={x:0,y:0,w:1,h:1};return i.Utils.defaults(t,n),t.autoPosition||delete t.autoPosition,t.noResize||delete t.noResize,t.noMove||delete t.noMove,"string"==typeof t.x&&(t.x=Number(t.x)),"string"==typeof t.y&&(t.y=Number(t.y)),"string"==typeof t.w&&(t.w=Number(t.w)),"string"==typeof t.h&&(t.h=Number(t.h)),isNaN(t.x)&&(t.x=n.x,t.autoPosition=!0),isNaN(t.y)&&(t.y=n.y,t.autoPosition=!0),isNaN(t.w)&&(t.w=n.w),isNaN(t.h)&&(t.h=n.h),this.nodeBoundFix(t,e)}nodeBoundFix(t,e){let n=t._orig||i.Utils.copyPos({},t);if(t.maxW&&(t.w=Math.min(t.w,t.maxW)),t.maxH&&(t.h=Math.min(t.h,t.maxH)),t.minW&&t.minW<=this.column&&(t.w=Math.max(t.w,t.minW)),t.minH&&(t.h=Math.max(t.h,t.minH)),(1===this.column||t.x+t.w>this.column)&&this.column<12&&!this._inColumnResize&&!t.autoPosition&&t._id&&-1===this.findCacheLayout(t,12)){let e=Object.assign({},t);e.x=Math.min(11,e.x),e.w=Math.min(12,e.w),this.cacheOneLayout(e,12)}return t.w>this.column?t.w=this.column:t.w<1&&(t.w=1),this.maxRow&&t.h>this.maxRow?t.h=this.maxRow:t.h<1&&(t.h=1),t.x<0&&(t.x=0),t.y<0&&(t.y=0),t.x+t.w>this.column&&(e?t.w=this.column-t.x:t.x=this.column-t.w),this.maxRow&&t.y+t.h>this.maxRow&&(e?t.h=this.maxRow-t.y:t.y=this.maxRow-t.h),i.Utils.samePos(t,n)||(t._dirty=!0),t}getDirtyNodes(t){return t?this.nodes.filter((t=>t._dirty&&!i.Utils.samePos(t,t._orig))):this.nodes.filter((t=>t._dirty))}_notify(t){if(this.batchMode||!this.onChange)return this;let e=(t||[]).concat(this.getDirtyNodes());return this.onChange(e),this}cleanNodes(){return this.batchMode||this.nodes.forEach((t=>{delete t._dirty,delete t._lastTried})),this}saveInitial(){return this.nodes.forEach((t=>{t._orig=i.Utils.copyPos({},t),delete t._dirty})),this._hasLocked=this.nodes.some((t=>t.locked)),this}restoreInitial(){return this.nodes.forEach((t=>{i.Utils.samePos(t,t._orig)||(i.Utils.copyPos(t,t._orig),t._dirty=!0)})),this._notify(),this}findEmptyPosition(t){this.sortNodes();let e=!1;for(let n=0;!e;++n){let r=n%this.column,o=Math.floor(n/this.column);if(r+t.w>this.column)continue;let s={x:r,y:o,w:t.w,h:t.h};this.nodes.find((t=>i.Utils.isIntercepted(s,t)))||(t.x=r,t.y=o,e=!0)}return e}addNode(t,e=!1){return this.nodes.find((e=>e._id===t._id))||(delete(t=this._inColumnResize?this.nodeBoundFix(t):this.prepareNode(t))._temporaryRemoved,delete t._removeDOM,t.autoPosition&&this.findEmptyPosition(t)&&delete t.autoPosition,this.nodes.push(t),e&&this.addedNodes.push(t),this._fixCollisions(t),this.batchMode||this._packNodes()._notify(),t)}removeNode(t,e=!0,n=!1){return this.nodes.find((e=>e===t))?(n&&this.removedNodes.push(t),e&&(t._removeDOM=!0),this.nodes=this.nodes.filter((e=>e!==t)),this._packNodes()._notify([t])):this}removeAll(t=!0){return delete this._layouts,0===this.nodes.length?this:(t&&this.nodes.forEach((t=>t._removeDOM=!0)),this.removedNodes=this.nodes,this.nodes=[],this._notify(this.removedNodes))}moveNodeCheck(t,e){if(!this.changedPosConstrain(t,e))return!1;if(e.pack=!0,!this.maxRow)return this.moveNode(t,e);let n,o=new r({column:this.column,float:this.float,nodes:this.nodes.map((e=>e===t?(n=Object.assign({},e),n):Object.assign({},e)))});if(!n)return!1;let s=o.moveNode(n,e)&&o.getRow()<=this.maxRow;if(!s&&!e.resizing&&e.collide){let n=e.collide.el.gridstackNode;if(this.swap(t,n))return this._notify(),!0}return!!s&&(o.nodes.filter((t=>t._dirty)).forEach((t=>{let e=this.nodes.find((e=>e._id===t._id));e&&(i.Utils.copyPos(e,t),e._dirty=!0)})),this._notify(),!0)}willItFit(t){if(delete t._willFitPos,!this.maxRow)return!0;let e=new r({column:this.column,float:this.float,nodes:this.nodes.map((t=>Object.assign({},t)))}),n=Object.assign({},t);return this.cleanupNode(n),delete n.el,delete n._id,delete n.content,delete n.grid,e.addNode(n),e.getRow()<=this.maxRow&&(t._willFitPos=i.Utils.copyPos({},n),!0)}changedPosConstrain(t,e){return e.w=e.w||t.w,e.h=e.h||t.h,t.x!==e.x||t.y!==e.y||(t.maxW&&(e.w=Math.min(e.w,t.maxW)),t.maxH&&(e.h=Math.min(e.h,t.maxH)),t.minW&&(e.w=Math.max(e.w,t.minW)),t.minH&&(e.h=Math.max(e.h,t.minH)),t.w!==e.w||t.h!==e.h)}moveNode(t,e){var n,r;if(!t||!e)return!1;let o;void 0===e.pack&&(o=e.pack=!0),"number"!=typeof e.x&&(e.x=t.x),"number"!=typeof e.y&&(e.y=t.y),"number"!=typeof e.w&&(e.w=t.w),"number"!=typeof e.h&&(e.h=t.h);let s=t.w!==e.w||t.h!==e.h,a=i.Utils.copyPos({},t,!0);if(i.Utils.copyPos(a,e),a=this.nodeBoundFix(a,s),i.Utils.copyPos(e,a),i.Utils.samePos(t,e))return!1;let l=i.Utils.copyPos({},t),c=this.collideAll(t,a,e.skip),u=!0;if(c.length){let s=t._moving&&!e.nested,l=s?this.directionCollideCoverage(t,e,c):c[0];if(s&&l&&(null===(r=null===(n=t.grid)||void 0===n?void 0:n.opts)||void 0===r?void 0:r.subGridDynamic)&&!t.grid._isTemp){let n=i.Utils.areaIntercept(e.rect,l._rect),r=i.Utils.area(e.rect),o=i.Utils.area(l._rect);n/(r<o?r:o)>.8&&(l.grid.makeSubGrid(l.el,void 0,t),l=void 0)}l?u=!this._fixCollisions(t,a,l,e):(u=!1,o&&delete e.pack)}return u&&(t._dirty=!0,i.Utils.copyPos(t,a)),e.pack&&this._packNodes()._notify(),!i.Utils.samePos(t,l)}getRow(){return this.nodes.reduce(((t,e)=>Math.max(t,e.y+e.h)),0)}beginUpdate(t){return t._updating||(t._updating=!0,delete t._skipDown,this.batchMode||this.saveInitial()),this}endUpdate(){let t=this.nodes.find((t=>t._updating));return t&&(delete t._updating,delete t._skipDown),this}save(t=!0){var e;let n=null===(e=this._layouts)||void 0===e?void 0:e.length,r=n&&this.column!==n-1?this._layouts[n-1]:null,o=[];return this.sortNodes(),this.nodes.forEach((e=>{let n=null==r?void 0:r.find((t=>t._id===e._id)),s=Object.assign({},e);n&&(s.x=n.x,s.y=n.y,s.w=n.w),i.Utils.removeInternalForSave(s,!t),o.push(s)})),o}layoutsNodesChange(t){return!this._layouts||this._inColumnResize||this._layouts.forEach(((e,n)=>{if(!e||n===this.column)return this;if(n<this.column)this._layouts[n]=void 0;else{let i=n/this.column;t.forEach((t=>{if(!t._orig)return;let n=e.find((e=>e._id===t._id));n&&(t.y!==t._orig.y&&(n.y+=t.y-t._orig.y),t.x!==t._orig.x&&(n.x=Math.round(t.x*i)),t.w!==t._orig.w&&(n.w=Math.round(t.w*i)))}))}})),this}updateNodeWidths(t,e,n,r="moveScale"){var o;if(!this.nodes.length||!e||t===e)return this;this.cacheLayout(this.nodes,t),this.batchUpdate();let s=[],a=!1;if(1===e&&(null==n?void 0:n.length)){a=!0;let t=0;n.forEach((e=>{e.x=0,e.w=1,e.y=Math.max(e.y,t),t=e.y+e.h})),s=n,n=[]}else n=i.Utils.sort(this.nodes,-1,t);let l=[];if(e>t){l=this._layouts[e]||[];let i=this._layouts.length-1;!l.length&&t!==i&&(null===(o=this._layouts[i])||void 0===o?void 0:o.length)&&(t=i,this._layouts[i].forEach((t=>{let e=n.find((e=>e._id===t._id));e&&(e.x=t.x,e.y=t.y,e.w=t.w)})))}if(l.forEach((t=>{let e=n.findIndex((e=>e._id===t._id));-1!==e&&(n[e].x=t.x,n[e].y=t.y,n[e].w=t.w,s.push(n[e]),n.splice(e,1))})),n.length)if("function"==typeof r)r(e,t,s,n);else if(!a){let i=e/t,o="move"===r||"moveScale"===r,a="scale"===r||"moveScale"===r;n.forEach((n=>{n.x=1===e?0:o?Math.round(n.x*i):Math.min(n.x,e-1),n.w=1===e||1===t?1:a?Math.round(n.w*i)||1:Math.min(n.w,e),s.push(n)})),n=[]}return a||(s=i.Utils.sort(s,-1,e)),this._inColumnResize=!0,this.nodes=[],s.forEach((t=>{this.addNode(t,!1),delete t._orig})),this.batchUpdate(!1),delete this._inColumnResize,this}cacheLayout(t,e,n=!1){let i=[];return t.forEach(((t,e)=>{t._id=t._id||r._idSeq++,i[e]={x:t.x,y:t.y,w:t.w,_id:t._id}})),this._layouts=n?[]:this._layouts||[],this._layouts[e]=i,this}cacheOneLayout(t,e){t._id=t._id||r._idSeq++;let n={x:t.x,y:t.y,w:t.w,_id:t._id};this._layouts=this._layouts||[],this._layouts[e]=this._layouts[e]||[];let i=this.findCacheLayout(t,e);return-1===i?this._layouts[e].push(n):this._layouts[e][i]=n,this}findCacheLayout(t,e){var n,i,r;return null!==(r=null===(i=null===(n=this._layouts)||void 0===n?void 0:n[e])||void 0===i?void 0:i.findIndex((e=>e._id===t._id)))&&void 0!==r?r:-1}cleanupNode(t){for(let e in t)"_"===e[0]&&"_id"!==e&&delete t[e];return this}}e.GridStackEngine=r,r._idSeq=1},5929:function(t,e,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,i){void 0===i&&(i=n),t[i]=e[n]}),r=this&&this.__exportStar||function(t,e){for(var n in t)"default"===n||e.hasOwnProperty(n)||i(e,t,n)};Object.defineProperty(e,"__esModule",{value:!0}),e.GridStack=void 0;const o=n(6935),s=n(9284),a=n(7523);r(n(7523),e),r(n(9284),e),r(n(6935),e);class l{constructor(t,e={}){var n,i;this._gsEventHandler={},this._extraDragRow=0,this.el=t,(e=e||{}).row&&(e.minRow=e.maxRow=e.row,delete e.row);let r=s.Utils.toNumber(t.getAttribute("gs-row"));"auto"===e.column&&delete e.column;let h=e;void 0!==h.minWidth&&(e.oneColumnSize=e.oneColumnSize||h.minWidth,delete h.minWidth),void 0!==e.alwaysShowResizeHandle&&(e._alwaysShowResizeHandle=e.alwaysShowResizeHandle);let d=Object.assign(Object.assign({},s.Utils.cloneDeep(a.gridDefaults)),{column:s.Utils.toNumber(t.getAttribute("gs-column"))||a.gridDefaults.column,minRow:r||s.Utils.toNumber(t.getAttribute("gs-min-row"))||a.gridDefaults.minRow,maxRow:r||s.Utils.toNumber(t.getAttribute("gs-max-row"))||a.gridDefaults.maxRow,staticGrid:s.Utils.toBool(t.getAttribute("gs-static"))||a.gridDefaults.staticGrid,draggable:{handle:(e.handleClass?"."+e.handleClass:e.handle?e.handle:"")||a.gridDefaults.draggable.handle},removableOptions:{accept:e.itemClass?"."+e.itemClass:a.gridDefaults.removableOptions.accept}});t.getAttribute("gs-animate")&&(d.animate=s.Utils.toBool(t.getAttribute("gs-animate"))),this.opts=s.Utils.defaults(e,d),e=null,this._initMargin(),1!==this.opts.column&&!this.opts.disableOneColumnMode&&this._widthOrContainer()<=this.opts.oneColumnSize&&(this._prevColumn=this.getColumn(),this.opts.column=1),"auto"===this.opts.rtl&&(this.opts.rtl="rtl"===t.style.direction),this.opts.rtl&&this.el.classList.add("grid-stack-rtl");let f=null===(n=s.Utils.closestUpByClass(this.el,a.gridDefaults.itemClass))||void 0===n?void 0:n.gridstackNode;f&&(f.subGrid=this,this.parentGridItem=f,this.el.classList.add("grid-stack-nested"),f.el.classList.add("grid-stack-sub-grid")),this._isAutoCellHeight="auto"===this.opts.cellHeight,this._isAutoCellHeight||"initial"===this.opts.cellHeight?this.cellHeight(void 0,!1):("number"==typeof this.opts.cellHeight&&this.opts.cellHeightUnit&&this.opts.cellHeightUnit!==a.gridDefaults.cellHeightUnit&&(this.opts.cellHeight=this.opts.cellHeight+this.opts.cellHeightUnit,delete this.opts.cellHeightUnit),this.cellHeight(this.opts.cellHeight,!1)),"mobile"===this.opts.alwaysShowResizeHandle&&(this.opts.alwaysShowResizeHandle=c.isTouch),this._styleSheetClass="grid-stack-instance-"+o.GridStackEngine._idSeq++,this.el.classList.add(this._styleSheetClass),this._setStaticClass();let p=this.opts.engineClass||l.engineClass||o.GridStackEngine;if(this.engine=new p({column:this.getColumn(),float:this.opts.float,maxRow:this.opts.maxRow,onChange:t=>{let e=0;this.engine.nodes.forEach((t=>{e=Math.max(e,t.y+t.h)})),t.forEach((t=>{let e=t.el;e&&(t._removeDOM?(e&&e.remove(),delete t._removeDOM):this._writePosAttr(e,t))})),this._updateStyles(!1,e)}}),this.opts.auto){this.batchUpdate();let t=[],e=this.getColumn();1===e&&this._prevColumn&&(e=this._prevColumn),this.getGridItems().forEach((n=>{let i=parseInt(n.getAttribute("gs-x")),r=parseInt(n.getAttribute("gs-y"));t.push({el:n,i:(Number.isNaN(i)?1e3:i)+(Number.isNaN(r)?1e3:r)*e})})),t.sort(((t,e)=>e.i-t.i)).forEach((t=>this._prepareElement(t.el))),this.batchUpdate(!1)}this.setAnimation(this.opts.animate),this._updateStyles(),12!=this.opts.column&&this.el.classList.add("grid-stack-"+this.opts.column),this.opts.dragIn&&l.setupDragIn(this.opts.dragIn,this.opts.dragInOptions),delete this.opts.dragIn,delete this.opts.dragInOptions,this.opts.subGridDynamic&&!u.DDManager.pauseDrag&&(u.DDManager.pauseDrag=!0),void 0!==(null===(i=this.opts.draggable)||void 0===i?void 0:i.pause)&&(u.DDManager.pauseDrag=this.opts.draggable.pause),this._setupRemoveDrop(),this._setupAcceptWidget(),this._updateWindowResizeEvent()}static init(t={},e=".grid-stack"){let n=l.getGridElement(e);return n?(n.gridstack||(n.gridstack=new l(n,s.Utils.cloneDeep(t))),n.gridstack):("string"==typeof e?console.error('GridStack.initAll() no grid was found with selector "'+e+'" - element missing or wrong selector ?\nNote: ".grid-stack" is required for proper CSS styling and drag/drop, and is the default selector.'):console.error("GridStack.init() no grid element was passed."),null)}static initAll(t={},e=".grid-stack"){let n=[];return l.getGridElements(e).forEach((e=>{e.gridstack||(e.gridstack=new l(e,s.Utils.cloneDeep(t)),delete t.dragIn,delete t.dragInOptions),n.push(e.gridstack)})),0===n.length&&console.error('GridStack.initAll() no grid was found with selector "'+e+'" - element missing or wrong selector ?\nNote: ".grid-stack" is required for proper CSS styling and drag/drop, and is the default selector.'),n}static addGrid(t,e={}){if(!t)return null;let n=t;if(!t.classList.contains("grid-stack")){let i=document.implementation.createHTMLDocument("");i.body.innerHTML=`<div class="grid-stack ${e.class||""}"></div>`,n=i.body.children[0],t.appendChild(n)}let i=l.init(e,n);if(i.opts.children){let t=i.opts.children;delete i.opts.children,i.load(t)}return i}static registerEngine(t){l.engineClass=t}get placeholder(){if(!this._placeholder){let t=document.createElement("div");t.className="placeholder-content",this.opts.placeholderText&&(t.innerHTML=this.opts.placeholderText),this._placeholder=document.createElement("div"),this._placeholder.classList.add(this.opts.placeholderClass,a.gridDefaults.itemClass,this.opts.itemClass),this.placeholder.appendChild(t)}return this._placeholder}addWidget(t,e){let n;if("string"==typeof t){let e=document.implementation.createHTMLDocument("");e.body.innerHTML=t,n=e.body.children[0]}else if(0===arguments.length||1===arguments.length&&(void 0!==(i=t).x||void 0!==i.y||void 0!==i.w||void 0!==i.h||void 0!==i.content)){let i=t&&t.content||"";e=t;let r=document.implementation.createHTMLDocument("");r.body.innerHTML=`<div class="grid-stack-item ${this.opts.itemClass||""}"><div class="grid-stack-item-content">${i}</div></div>`,n=r.body.children[0]}else n=t;var i;let r=this._readAttr(n);e=s.Utils.cloneDeep(e)||{},s.Utils.defaults(e,r);let o=this.engine.prepareNode(e);return this._writeAttr(n,e),this._insertNotAppend?this.el.prepend(n):this.el.appendChild(n),this._prepareElement(n,!0,e),this._updateContainerHeight(),o.subGrid&&this.makeSubGrid(o.el,void 0,void 0,!1),this._prevColumn&&1===this.opts.column&&(this._ignoreLayoutsNodeChange=!0),this._triggerAddEvent(),this._triggerChangeEvent(),delete this._ignoreLayoutsNodeChange,n}makeSubGrid(t,e,n,i=!0){var r;let o,a=t.gridstackNode;if(a||(a=this.makeWidget(t).gridstackNode),null===(r=a.subGrid)||void 0===r?void 0:r.el)return a.subGrid;(e=s.Utils.cloneDeep(e||a.subGrid||Object.assign(Object.assign({},this.opts.subGrid),{children:void 0}))).subGrid=s.Utils.cloneDeep(e),a.subGrid=e,"auto"===e.column&&(o=!0,e.column=Math.max(a.w||1,(null==n?void 0:n.w)||1),e.disableOneColumnMode=!0);let c,u,h=a.el.querySelector(".grid-stack-item-content");if(i){this._removeDD(a.el);let t=document.implementation.createHTMLDocument("");t.body.innerHTML='<div class="grid-stack-item"></div>',c=t.body.children[0],c.appendChild(h),u=Object.assign(Object.assign({},a),{x:0,y:0}),s.Utils.removeInternalForSave(u),delete u.subGrid,a.content&&(u.content=a.content,delete a.content),t.body.innerHTML='<div class="grid-stack-item-content"></div>',h=t.body.children[0],a.el.appendChild(h),this._prepareDragDropByNode(a)}if(n){let t=o?e.column:a.w,i=a.h+n.h,r=a.el.style;r.transition="none",this.update(a.el,{w:t,h:i}),setTimeout((()=>r.transition=null))}let d=a.subGrid=l.addGrid(h,e);return(null==n?void 0:n._moving)&&(d._isTemp=!0),o&&(d._autoColumn=!0),i&&d.addWidget(c,u),n&&(n._moving?window.setTimeout((()=>s.Utils.simulateMouseEvent(n._event,"mouseenter",d.el)),0):d.addWidget(a.el,a)),d}removeAsSubGrid(t){var e;let n=null===(e=this.parentGridItem)||void 0===e?void 0:e.grid;n&&(n.batchUpdate(),n.removeWidget(this.parentGridItem.el,!0,!0),this.engine.nodes.forEach((t=>{t.x+=this.parentGridItem.x,t.y+=this.parentGridItem.y,n.addWidget(t.el,t)})),n.batchUpdate(!1),delete this.parentGridItem,t&&window.setTimeout((()=>s.Utils.simulateMouseEvent(t._event,"mouseenter",n.el)),0))}save(t=!0,e=!1){let n=this.engine.save(t);if(n.forEach((e=>{if(t&&e.el&&!e.subGrid){let t=e.el.querySelector(".grid-stack-item-content");e.content=t?t.innerHTML:void 0,e.content||delete e.content}else t||delete e.content,e.subGrid&&(e.subGrid=e.subGrid.save(t,!0));delete e.el})),e){let t=s.Utils.cloneDeep(this.opts);t.marginBottom===t.marginTop&&t.marginRight===t.marginLeft&&t.marginTop===t.marginRight&&(t.margin=t.marginTop,delete t.marginTop,delete t.marginRight,delete t.marginBottom,delete t.marginLeft),t.rtl===("rtl"===this.el.style.direction)&&(t.rtl="auto"),this._isAutoCellHeight&&(t.cellHeight="auto"),this._autoColumn&&(t.column="auto",delete t.disableOneColumnMode);const e=t._alwaysShowResizeHandle;return delete t._alwaysShowResizeHandle,void 0!==e?t.alwaysShowResizeHandle=e:delete t.alwaysShowResizeHandle,s.Utils.removeInternalAndSame(t,a.gridDefaults),t.children=n,t}return n}load(t,e=!0){let n=l.Utils.sort([...t],-1,this._prevColumn||this.getColumn());this._insertNotAppend=!0,this._prevColumn&&this._prevColumn!==this.opts.column&&n.some((t=>t.x+t.w>this.opts.column))&&(this._ignoreLayoutsNodeChange=!0,this.engine.cacheLayout(n,this._prevColumn,!0));let i=[];return this.batchUpdate(),e&&[...this.engine.nodes].forEach((t=>{n.find((e=>t.id===e.id))||("function"==typeof e?e(this,t,!1):(i.push(t),this.removeWidget(t.el,!0,!1)))})),n.forEach((t=>{let n=t.id||0===t.id?this.engine.nodes.find((e=>e.id===t.id)):void 0;if(n){if(this.update(n.el,t),t.subGrid&&t.subGrid.children){let e=n.el.querySelector(".grid-stack");e&&e.gridstack&&(e.gridstack.load(t.subGrid.children),this._insertNotAppend=!0)}}else e&&(t="function"==typeof e?e(this,t,!0).gridstackNode:this.addWidget(t).gridstackNode)})),this.engine.removedNodes=i,this.batchUpdate(!1),delete this._ignoreLayoutsNodeChange,delete this._insertNotAppend,this}batchUpdate(t=!0){return this.engine.batchUpdate(t),t||(this._triggerRemoveEvent(),this._triggerAddEvent(),this._triggerChangeEvent()),this}getCellHeight(t=!1){if(this.opts.cellHeight&&"auto"!==this.opts.cellHeight&&(!t||!this.opts.cellHeightUnit||"px"===this.opts.cellHeightUnit))return this.opts.cellHeight;let e=this.el.querySelector("."+this.opts.itemClass);if(e){let t=s.Utils.toNumber(e.getAttribute("gs-h"));return Math.round(e.offsetHeight/t)}let n=parseInt(this.el.getAttribute("gs-current-row"));return n?Math.round(this.el.getBoundingClientRect().height/n):this.opts.cellHeight}cellHeight(t,e=!0){if(e&&void 0!==t&&this._isAutoCellHeight!==("auto"===t)&&(this._isAutoCellHeight="auto"===t,this._updateWindowResizeEvent()),"initial"!==t&&"auto"!==t||(t=void 0),void 0===t){let e=-this.opts.marginRight-this.opts.marginLeft+this.opts.marginTop+this.opts.marginBottom;t=this.cellWidth()+e}let n=s.Utils.parseHeight(t);return this.opts.cellHeightUnit===n.unit&&this.opts.cellHeight===n.h||(this.opts.cellHeightUnit=n.unit,this.opts.cellHeight=n.h,e&&this._updateStyles(!0)),this}cellWidth(){return this._widthOrContainer()/this.getColumn()}_widthOrContainer(){return this.el.clientWidth||this.el.parentElement.clientWidth||window.innerWidth}compact(){return this.engine.compact(),this._triggerChangeEvent(),this}column(t,e="moveScale"){if(t<1||this.opts.column===t)return this;let n,i=this.getColumn();return 1===t?this._prevColumn=i:delete this._prevColumn,this.el.classList.remove("grid-stack-"+i),this.el.classList.add("grid-stack-"+t),this.opts.column=this.engine.column=t,1===t&&this.opts.oneColumnModeDomSort&&(n=[],this.getGridItems().forEach((t=>{t.gridstackNode&&n.push(t.gridstackNode)})),n.length||(n=void 0)),this.engine.updateNodeWidths(i,t,n,e),this._isAutoCellHeight&&this.cellHeight(),this._ignoreLayoutsNodeChange=!0,this._triggerChangeEvent(),delete this._ignoreLayoutsNodeChange,this}getColumn(){return this.opts.column}getGridItems(){return Array.from(this.el.children).filter((t=>t.matches("."+this.opts.itemClass)&&!t.matches("."+this.opts.placeholderClass)))}destroy(t=!0){if(this.el)return this._updateWindowResizeEvent(!0),this.setStatic(!0,!1),this.setAnimation(!1),t?this.el.parentNode.removeChild(this.el):(this.removeAll(t),this.el.classList.remove(this._styleSheetClass)),this._removeStylesheet(),this.el.removeAttribute("gs-current-row"),delete this.parentGridItem,delete this.opts,delete this._placeholder,delete this.engine,delete this.el.gridstack,delete this.el,this}float(t){return this.opts.float!==t&&(this.opts.float=this.engine.float=t,this._triggerChangeEvent()),this}getFloat(){return this.engine.float}getCellFromPixel(t,e=!1){let n,i=this.el.getBoundingClientRect();n=e?{top:i.top+document.documentElement.scrollTop,left:i.left}:{top:this.el.offsetTop,left:this.el.offsetLeft};let r=t.left-n.left,o=t.top-n.top,s=i.width/this.getColumn(),a=i.height/parseInt(this.el.getAttribute("gs-current-row"));return{x:Math.floor(r/s),y:Math.floor(o/a)}}getRow(){return Math.max(this.engine.getRow(),this.opts.minRow)}isAreaEmpty(t,e,n,i){return this.engine.isAreaEmpty(t,e,n,i)}makeWidget(t){let e=l.getElement(t);return this._prepareElement(e,!0),this._updateContainerHeight(),this._triggerAddEvent(),this._triggerChangeEvent(),e}on(t,e){if(-1!==t.indexOf(" "))return t.split(" ").forEach((t=>this.on(t,e))),this;if("change"===t||"added"===t||"removed"===t||"enable"===t||"disable"===t){let n="enable"===t||"disable"===t;this._gsEventHandler[t]=n?t=>e(t):t=>e(t,t.detail),this.el.addEventListener(t,this._gsEventHandler[t])}else"drag"===t||"dragstart"===t||"dragstop"===t||"resizestart"===t||"resize"===t||"resizestop"===t||"dropped"===t?this._gsEventHandler[t]=e:console.log("GridStack.on("+t+') event not supported, but you can still use $(".grid-stack").on(...) while jquery-ui is still used internally.');return this}off(t){return-1!==t.indexOf(" ")?(t.split(" ").forEach((t=>this.off(t))),this):("change"!==t&&"added"!==t&&"removed"!==t&&"enable"!==t&&"disable"!==t||this._gsEventHandler[t]&&this.el.removeEventListener(t,this._gsEventHandler[t]),delete this._gsEventHandler[t],this)}removeWidget(t,e=!0,n=!0){return l.getElements(t).forEach((t=>{if(t.parentElement&&t.parentElement!==this.el)return;let i=t.gridstackNode;i||(i=this.engine.nodes.find((e=>t===e.el))),i&&(delete t.gridstackNode,this._removeDD(t),this.engine.removeNode(i,e,n),e&&t.parentElement&&t.remove())})),n&&(this._triggerRemoveEvent(),this._triggerChangeEvent()),this}removeAll(t=!0){return this.engine.nodes.forEach((t=>{delete t.el.gridstackNode,this._removeDD(t.el)})),this.engine.removeAll(t),this._triggerRemoveEvent(),this}setAnimation(t){return t?this.el.classList.add("grid-stack-animate"):this.el.classList.remove("grid-stack-animate"),this}setStatic(t,e=!0){return this.opts.staticGrid===t||(this.opts.staticGrid=t,this._setupRemoveDrop(),this._setupAcceptWidget(),this.engine.nodes.forEach((t=>this._prepareDragDropByNode(t))),e&&this._setStaticClass()),this}update(t,e){if(arguments.length>2){console.warn("gridstack.ts: `update(el, x, y, w, h)` is deprecated. Use `update(el, {x, w, content, ...})`. It will be removed soon");let n=arguments,i=1;return e={x:n[i++],y:n[i++],w:n[i++],h:n[i++]},this.update(t,e)}return l.getElements(t).forEach((t=>{if(!t||!t.gridstackNode)return;let n=t.gridstackNode,i=s.Utils.cloneDeep(e);delete i.autoPosition;let r,o=["x","y","w","h"];if(o.some((t=>void 0!==i[t]&&i[t]!==n[t]))&&(r={},o.forEach((t=>{r[t]=void 0!==i[t]?i[t]:n[t],delete i[t]}))),!r&&(i.minW||i.minH||i.maxW||i.maxH)&&(r={}),i.content){let e=t.querySelector(".grid-stack-item-content");e&&e.innerHTML!==i.content&&(e.innerHTML=i.content),delete i.content}let a=!1,l=!1;for(const t in i)"_"!==t[0]&&n[t]!==i[t]&&(n[t]=i[t],a=!0,l=l||!this.opts.staticGrid&&("noResize"===t||"noMove"===t||"locked"===t));r&&(this.engine.cleanNodes().beginUpdate(n).moveNode(n,r),this._updateContainerHeight(),this._triggerChangeEvent(),this.engine.endUpdate()),a&&this._writeAttr(t,n),l&&this._prepareDragDropByNode(n)})),this}margin(t){if(!("string"==typeof t&&t.split(" ").length>1)){let e=s.Utils.parseHeight(t);if(this.opts.marginUnit===e.unit&&this.opts.margin===e.h)return}return this.opts.margin=t,this.opts.marginTop=this.opts.marginBottom=this.opts.marginLeft=this.opts.marginRight=void 0,this._initMargin(),this._updateStyles(!0),this}getMargin(){return this.opts.margin}willItFit(t){if(arguments.length>1){console.warn("gridstack.ts: `willItFit(x,y,w,h,autoPosition)` is deprecated. Use `willItFit({x, y,...})`. It will be removed soon");let t=arguments,e=0,n={x:t[e++],y:t[e++],w:t[e++],h:t[e++],autoPosition:t[e++]};return this.willItFit(n)}return this.engine.willItFit(t)}_triggerChangeEvent(){if(this.engine.batchMode)return this;let t=this.engine.getDirtyNodes(!0);return t&&t.length&&(this._ignoreLayoutsNodeChange||this.engine.layoutsNodesChange(t),this._triggerEvent("change",t)),this.engine.saveInitial(),this}_triggerAddEvent(){return this.engine.batchMode||this.engine.addedNodes&&this.engine.addedNodes.length>0&&(this._ignoreLayoutsNodeChange||this.engine.layoutsNodesChange(this.engine.addedNodes),this.engine.addedNodes.forEach((t=>{delete t._dirty})),this._triggerEvent("added",this.engine.addedNodes),this.engine.addedNodes=[]),this}_triggerRemoveEvent(){return this.engine.batchMode||this.engine.removedNodes&&this.engine.removedNodes.length>0&&(this._triggerEvent("removed",this.engine.removedNodes),this.engine.removedNodes=[]),this}_triggerEvent(t,e){let n=e?new CustomEvent(t,{bubbles:!1,detail:e}):new Event(t);return this.el.dispatchEvent(n),this}_removeStylesheet(){return this._styles&&(s.Utils.removeStylesheet(this._styleSheetClass),delete this._styles),this}_updateStyles(t=!1,e){if(t&&this._removeStylesheet(),e||(e=this.getRow()),this._updateContainerHeight(),0===this.opts.cellHeight)return this;let n=this.opts.cellHeight,i=this.opts.cellHeightUnit,r=`.${this._styleSheetClass} > .${this.opts.itemClass}`;if(!this._styles){let t=this.opts.styleInHead?void 0:this.el.parentNode;if(this._styles=s.Utils.createStylesheet(this._styleSheetClass,t),!this._styles)return this;this._styles._max=0,s.Utils.addCSSRule(this._styles,r,`min-height: ${n}${i}`);let e=this.opts.marginTop+this.opts.marginUnit,o=this.opts.marginBottom+this.opts.marginUnit,a=this.opts.marginRight+this.opts.marginUnit,l=this.opts.marginLeft+this.opts.marginUnit,c=`${r} > .grid-stack-item-content`,u=`.${this._styleSheetClass} > .grid-stack-placeholder > .placeholder-content`;s.Utils.addCSSRule(this._styles,c,`top: ${e}; right: ${a}; bottom: ${o}; left: ${l};`),s.Utils.addCSSRule(this._styles,u,`top: ${e}; right: ${a}; bottom: ${o}; left: ${l};`),s.Utils.addCSSRule(this._styles,`${r} > .ui-resizable-ne`,`right: ${a}`),s.Utils.addCSSRule(this._styles,`${r} > .ui-resizable-e`,`right: ${a}`),s.Utils.addCSSRule(this._styles,`${r} > .ui-resizable-se`,`right: ${a}; bottom: ${o}`),s.Utils.addCSSRule(this._styles,`${r} > .ui-resizable-nw`,`left: ${l}`),s.Utils.addCSSRule(this._styles,`${r} > .ui-resizable-w`,`left: ${l}`),s.Utils.addCSSRule(this._styles,`${r} > .ui-resizable-sw`,`left: ${l}; bottom: ${o}`)}if((e=e||this._styles._max)>this._styles._max){let t=t=>n*t+i;for(let n=this._styles._max+1;n<=e;n++){let e=t(n);s.Utils.addCSSRule(this._styles,`${r}[gs-y="${n-1}"]`,`top: ${t(n-1)}`),s.Utils.addCSSRule(this._styles,`${r}[gs-h="${n}"]`,`height: ${e}`),s.Utils.addCSSRule(this._styles,`${r}[gs-min-h="${n}"]`,`min-height: ${e}`),s.Utils.addCSSRule(this._styles,`${r}[gs-max-h="${n}"]`,`max-height: ${e}`)}this._styles._max=e}return this}_updateContainerHeight(){if(!this.engine||this.engine.batchMode)return this;let t=this.getRow()+this._extraDragRow;if(this.el.setAttribute("gs-current-row",String(t)),0===t)return this.el.style.removeProperty("min-height"),this;let e=this.opts.cellHeight,n=this.opts.cellHeightUnit;return e?(this.el.style.minHeight=t*e+n,this):this}_prepareElement(t,e=!1,n){n||(t.classList.add(this.opts.itemClass),n=this._readAttr(t)),t.gridstackNode=n,n.el=t,n.grid=this;let i=Object.assign({},n);return n=this.engine.addNode(n,e),s.Utils.same(n,i)||this._writeAttr(t,n),this._prepareDragDropByNode(n),this}_writePosAttr(t,e){return void 0!==e.x&&null!==e.x&&t.setAttribute("gs-x",String(e.x)),void 0!==e.y&&null!==e.y&&t.setAttribute("gs-y",String(e.y)),e.w&&t.setAttribute("gs-w",String(e.w)),e.h&&t.setAttribute("gs-h",String(e.h)),this}_writeAttr(t,e){if(!e)return this;this._writePosAttr(t,e);let n={autoPosition:"gs-auto-position",minW:"gs-min-w",minH:"gs-min-h",maxW:"gs-max-w",maxH:"gs-max-h",noResize:"gs-no-resize",noMove:"gs-no-move",locked:"gs-locked",id:"gs-id",resizeHandles:"gs-resize-handles"};for(const i in n)e[i]?t.setAttribute(n[i],String(e[i])):t.removeAttribute(n[i]);return this}_readAttr(t){let e={};e.x=s.Utils.toNumber(t.getAttribute("gs-x")),e.y=s.Utils.toNumber(t.getAttribute("gs-y")),e.w=s.Utils.toNumber(t.getAttribute("gs-w")),e.h=s.Utils.toNumber(t.getAttribute("gs-h")),e.maxW=s.Utils.toNumber(t.getAttribute("gs-max-w")),e.minW=s.Utils.toNumber(t.getAttribute("gs-min-w")),e.maxH=s.Utils.toNumber(t.getAttribute("gs-max-h")),e.minH=s.Utils.toNumber(t.getAttribute("gs-min-h")),e.autoPosition=s.Utils.toBool(t.getAttribute("gs-auto-position")),e.noResize=s.Utils.toBool(t.getAttribute("gs-no-resize")),e.noMove=s.Utils.toBool(t.getAttribute("gs-no-move")),e.locked=s.Utils.toBool(t.getAttribute("gs-locked")),e.resizeHandles=t.getAttribute("gs-resize-handles"),e.id=t.getAttribute("gs-id");for(const t in e){if(!e.hasOwnProperty(t))return;e[t]||0===e[t]||delete e[t]}return e}_setStaticClass(){let t=["grid-stack-static"];return this.opts.staticGrid?(this.el.classList.add(...t),this.el.setAttribute("gs-static","true")):(this.el.classList.remove(...t),this.el.removeAttribute("gs-static")),this}onParentResize(){if(!this.el||!this.el.clientWidth)return;let t=!1;if(this._autoColumn&&this.parentGridItem)this.opts.column!==this.parentGridItem.w&&(t=!0,this.column(this.parentGridItem.w,"none"));else{let e=!this.opts.disableOneColumnMode&&this.el.clientWidth<=this.opts.oneColumnSize;1===this.opts.column!==e&&(t=!0,this.opts.animate&&this.setAnimation(!1),this.column(e?1:this._prevColumn),this.opts.animate&&this.setAnimation(!0))}return this._isAutoCellHeight&&(!t&&this.opts.cellHeightThrottle?(this._cellHeightThrottle||(this._cellHeightThrottle=s.Utils.throttle((()=>this.cellHeight()),this.opts.cellHeightThrottle)),this._cellHeightThrottle()):this.cellHeight()),this.engine.nodes.forEach((t=>{t.subGrid&&t.subGrid.onParentResize()})),this}_updateWindowResizeEvent(t=!1){const e=(this._isAutoCellHeight||!this.opts.disableOneColumnMode)&&!this.parentGridItem;return t||!e||this._windowResizeBind?!t&&e||!this._windowResizeBind||(window.removeEventListener("resize",this._windowResizeBind),delete this._windowResizeBind):(this._windowResizeBind=this.onParentResize.bind(this),window.addEventListener("resize",this._windowResizeBind)),this}static getElement(t=".grid-stack-item"){return s.Utils.getElement(t)}static getElements(t=".grid-stack-item"){return s.Utils.getElements(t)}static getGridElement(t){return l.getElement(t)}static getGridElements(t){return s.Utils.getElements(t)}_initMargin(){let t,e=0,n=[];return"string"==typeof this.opts.margin&&(n=this.opts.margin.split(" ")),2===n.length?(this.opts.marginTop=this.opts.marginBottom=n[0],this.opts.marginLeft=this.opts.marginRight=n[1]):4===n.length?(this.opts.marginTop=n[0],this.opts.marginRight=n[1],this.opts.marginBottom=n[2],this.opts.marginLeft=n[3]):(t=s.Utils.parseHeight(this.opts.margin),this.opts.marginUnit=t.unit,e=this.opts.margin=t.h),void 0===this.opts.marginTop?this.opts.marginTop=e:(t=s.Utils.parseHeight(this.opts.marginTop),this.opts.marginTop=t.h,delete this.opts.margin),void 0===this.opts.marginBottom?this.opts.marginBottom=e:(t=s.Utils.parseHeight(this.opts.marginBottom),this.opts.marginBottom=t.h,delete this.opts.margin),void 0===this.opts.marginRight?this.opts.marginRight=e:(t=s.Utils.parseHeight(this.opts.marginRight),this.opts.marginRight=t.h,delete this.opts.margin),void 0===this.opts.marginLeft?this.opts.marginLeft=e:(t=s.Utils.parseHeight(this.opts.marginLeft),this.opts.marginLeft=t.h,delete this.opts.margin),this.opts.marginUnit=t.unit,this.opts.marginTop===this.opts.marginBottom&&this.opts.marginLeft===this.opts.marginRight&&this.opts.marginTop===this.opts.marginRight&&(this.opts.margin=this.opts.marginTop),this}static setupDragIn(t,e){}movable(t,e){return this}resizable(t,e){return this}disable(){return this}enable(){return this}enableMove(t){return this}enableResize(t){return this}_removeDD(t){return this}_setupAcceptWidget(){return this}_setupRemoveDrop(){return this}_prepareDragDropByNode(t){return this}_onStartMoving(t,e,n,i,r,o){}_dragOrResize(t,e,n,i,r,o){}_leave(t,e){}commit(){return s.obsolete(this,this.batchUpdate(!1),"commit","batchUpdate","5.2"),this}}e.GridStack=l,l.Utils=s.Utils,l.Engine=o.GridStackEngine,l.GDRev="7.1.1";const c=n(168),u=n(427);r(n(6470),e)},7523:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.dragInDefaultOptions=e.gridDefaults=void 0,e.gridDefaults={alwaysShowResizeHandle:"mobile",animate:!0,auto:!0,cellHeight:"auto",cellHeightThrottle:100,cellHeightUnit:"px",column:12,draggable:{handle:".grid-stack-item-content",appendTo:"body"},handle:".grid-stack-item-content",itemClass:"grid-stack-item",margin:10,marginUnit:"px",maxRow:0,minRow:0,oneColumnSize:768,placeholderClass:"grid-stack-placeholder",placeholderText:"",removableOptions:{accept:".grid-stack-item"},resizable:{handles:"se"},rtl:"auto"},e.dragInDefaultOptions={handle:".grid-stack-item-content",appendTo:"body"}},9284:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Utils=e.obsoleteAttr=e.obsoleteOptsDel=e.obsoleteOpts=e.obsolete=void 0,e.obsolete=function(t,e,n,i,r){let o=(...o)=>(console.warn("gridstack.js: Function `"+n+"` is deprecated in "+r+" and has been replaced with `"+i+"`. It will be **removed** in a future release"),e.apply(t,o));return o.prototype=e.prototype,o},e.obsoleteOpts=function(t,e,n,i){void 0!==t[e]&&(t[n]=t[e],console.warn("gridstack.js: Option `"+e+"` is deprecated in "+i+" and has been replaced with `"+n+"`. It will be **removed** in a future release"))},e.obsoleteOptsDel=function(t,e,n,i){void 0!==t[e]&&console.warn("gridstack.js: Option `"+e+"` is deprecated in "+n+i)},e.obsoleteAttr=function(t,e,n,i){let r=t.getAttribute(e);null!==r&&(t.setAttribute(n,r),console.warn("gridstack.js: attribute `"+e+"`="+r+" is deprecated on this object in "+i+" and has been replaced with `"+n+"`. It will be **removed** in a future release"))};class n{static getElements(t){if("string"==typeof t){let e=document.querySelectorAll(t);return e.length||"."===t[0]||"#"===t[0]||(e=document.querySelectorAll("."+t),e.length||(e=document.querySelectorAll("#"+t))),Array.from(e)}return[t]}static getElement(t){if("string"==typeof t){if(!t.length)return null;if("#"===t[0])return document.getElementById(t.substring(1));if("."===t[0]||"["===t[0])return document.querySelector(t);if(!isNaN(+t[0]))return document.getElementById(t);let e=document.querySelector(t);return e||(e=document.getElementById(t)),e||(e=document.querySelector("."+t)),e}return t}static isIntercepted(t,e){return!(t.y>=e.y+e.h||t.y+t.h<=e.y||t.x+t.w<=e.x||t.x>=e.x+e.w)}static isTouching(t,e){return n.isIntercepted(t,{x:e.x-.5,y:e.y-.5,w:e.w+1,h:e.h+1})}static areaIntercept(t,e){let n=t.x>e.x?t.x:e.x,i=t.x+t.w<e.x+e.w?t.x+t.w:e.x+e.w;if(i<=n)return 0;let r=t.y>e.y?t.y:e.y,o=t.y+t.h<e.y+e.h?t.y+t.h:e.y+e.h;return o<=r?0:(i-n)*(o-r)}static area(t){return t.w*t.h}static sort(t,e,n){return n=n||t.reduce(((t,e)=>Math.max(e.x+e.w,t)),0)||12,-1===e?t.sort(((t,e)=>e.x+e.y*n-(t.x+t.y*n))):t.sort(((t,e)=>t.x+t.y*n-(e.x+e.y*n)))}static createStylesheet(t,e){let n=document.createElement("style");return n.setAttribute("type","text/css"),n.setAttribute("gs-style-id",t),n.styleSheet?n.styleSheet.cssText="":n.appendChild(document.createTextNode("")),e?e.insertBefore(n,e.firstChild):(e=document.getElementsByTagName("head")[0]).appendChild(n),n.sheet}static removeStylesheet(t){let e=document.querySelector("STYLE[gs-style-id="+t+"]");e&&e.parentNode&&e.remove()}static addCSSRule(t,e,n){"function"==typeof t.addRule?t.addRule(e,n):"function"==typeof t.insertRule&&t.insertRule(`${e}{${n}}`)}static toBool(t){return"boolean"==typeof t?t:"string"==typeof t?!(""===(t=t.toLowerCase())||"no"===t||"false"===t||"0"===t):Boolean(t)}static toNumber(t){return null===t||0===t.length?void 0:Number(t)}static parseHeight(t){let e,n="px";if("string"==typeof t){let i=t.match(/^(-[0-9]+\.[0-9]+|[0-9]*\.[0-9]+|-[0-9]+|[0-9]+)(px|em|rem|vh|vw|%)?$/);if(!i)throw new Error("Invalid height");n=i[2]||"px",e=parseFloat(i[1])}else e=t;return{h:e,unit:n}}static defaults(t,...e){return e.forEach((e=>{for(const n in e){if(!e.hasOwnProperty(n))return;null===t[n]||void 0===t[n]?t[n]=e[n]:"object"==typeof e[n]&&"object"==typeof t[n]&&this.defaults(t[n],e[n])}})),t}static same(t,e){if("object"!=typeof t)return t==e;if(typeof t!=typeof e)return!1;if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(t[n]!==e[n])return!1;return!0}static copyPos(t,e,n=!1){return t.x=e.x,t.y=e.y,t.w=e.w,t.h=e.h,n&&(e.minW&&(t.minW=e.minW),e.minH&&(t.minH=e.minH),e.maxW&&(t.maxW=e.maxW),e.maxH&&(t.maxH=e.maxH)),t}static samePos(t,e){return t&&e&&t.x===e.x&&t.y===e.y&&t.w===e.w&&t.h===e.h}static removeInternalAndSame(t,e){if("object"==typeof t&&"object"==typeof e)for(let n in t){let i=t[n];if("_"===n[0]||i===e[n])delete t[n];else if(i&&"object"==typeof i&&void 0!==e[n]){for(let t in i)i[t]!==e[n][t]&&"_"!==t[0]||delete i[t];Object.keys(i).length||delete t[n]}}}static removeInternalForSave(t,e=!0){for(let e in t)"_"!==e[0]&&null!==t[e]&&void 0!==t[e]||delete t[e];delete t.grid,e&&delete t.el,t.autoPosition||delete t.autoPosition,t.noResize||delete t.noResize,t.noMove||delete t.noMove,t.locked||delete t.locked,1!==t.w&&t.w!==t.minW||delete t.w,1!==t.h&&t.h!==t.minH||delete t.h}static closestUpByClass(t,e){for(;t;){if(t.classList.contains(e))return t;t=t.parentElement}return null}static throttle(t,e){let n=!1;return(...i)=>{n||(n=!0,setTimeout((()=>{t(...i),n=!1}),e))}}static removePositioningStyles(t){let e=t.style;e.position&&e.removeProperty("position"),e.left&&e.removeProperty("left"),e.top&&e.removeProperty("top"),e.width&&e.removeProperty("width"),e.height&&e.removeProperty("height")}static getScrollElement(t){if(!t)return document.scrollingElement||document.documentElement;const e=getComputedStyle(t);return/(auto|scroll)/.test(e.overflow+e.overflowY)?t:this.getScrollElement(t.parentElement)}static updateScrollPosition(t,e,n){let i=t.getBoundingClientRect(),r=window.innerHeight||document.documentElement.clientHeight;if(i.top<0||i.bottom>r){let o=i.bottom-r,s=i.top,a=this.getScrollElement(t);if(null!==a){let l=a.scrollTop;i.top<0&&n<0?t.offsetHeight>r?a.scrollTop+=n:a.scrollTop+=Math.abs(s)>Math.abs(n)?n:s:n>0&&(t.offsetHeight>r?a.scrollTop+=n:a.scrollTop+=o>n?n:o),e.top+=a.scrollTop-l}}}static updateScrollResize(t,e,n){const i=this.getScrollElement(e),r=i.clientHeight,o=i===this.getScrollElement()?0:i.getBoundingClientRect().top,s=t.clientY-o,a=s>r-n;s<n?i.scrollBy({behavior:"smooth",top:s-n}):a&&i.scrollBy({behavior:"smooth",top:n-(r-s)})}static clone(t){return null==t||"object"!=typeof t?t:t instanceof Array?[...t]:Object.assign({},t)}static cloneDeep(t){const e=["parentGrid","el","grid","subGrid","engine"],i=n.clone(t);for(const r in i)i.hasOwnProperty(r)&&"object"==typeof i[r]&&"__"!==r.substring(0,2)&&!e.find((t=>t===r))&&(i[r]=n.cloneDeep(t[r]));return i}static cloneNode(t){const e=t.cloneNode(!0);return e.removeAttribute("id"),e}static appendTo(t,e){let n;n="string"==typeof e?document.querySelector(e):e,n&&n.appendChild(t)}static addElStyles(t,e){if(e instanceof Object)for(const n in e)e.hasOwnProperty(n)&&(Array.isArray(e[n])?e[n].forEach((e=>{t.style[n]=e})):t.style[n]=e[n])}static initEvent(t,e){const n={type:e.type},i={button:0,which:0,buttons:1,bubbles:!0,cancelable:!0,target:e.target?e.target:t.target};return t.dataTransfer&&(n.dataTransfer=t.dataTransfer),["altKey","ctrlKey","metaKey","shiftKey"].forEach((e=>n[e]=t[e])),["pageX","pageY","clientX","clientY","screenX","screenY"].forEach((e=>n[e]=t[e])),Object.assign(Object.assign({},n),i)}static simulateMouseEvent(t,e,n){const i=document.createEvent("MouseEvents");i.initMouseEvent(e,!0,!0,window,1,t.screenX,t.screenY,t.clientX,t.clientY,t.ctrlKey,t.altKey,t.shiftKey,t.metaKey,0,t.target),(n||t.target).dispatchEvent(i)}}e.Utils=n},840:(t,e,n)=>{var i;!function(r,o,s,a){"use strict";var l,c=["","webkit","Moz","MS","ms","o"],u=o.createElement("div"),h=Math.round,d=Math.abs,f=Date.now;function p(t,e,n){return setTimeout(w(t,n),e)}function g(t,e,n){return!!Array.isArray(t)&&(m(t,n[e],n),!0)}function m(t,e,n){var i;if(t)if(t.forEach)t.forEach(e,n);else if(t.length!==a)for(i=0;i<t.length;)e.call(n,t[i],i,t),i++;else for(i in t)t.hasOwnProperty(i)&&e.call(n,t[i],i,t)}function _(t,e,n){var i="DEPRECATED METHOD: "+e+"\n"+n+" AT \n";return function(){var e=new Error("get-stack-trace"),n=e&&e.stack?e.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",o=r.console&&(r.console.warn||r.console.log);return o&&o.call(r.console,i,n),t.apply(this,arguments)}}l="function"!=typeof Object.assign?function(t){if(t===a||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var i=arguments[n];if(i!==a&&null!==i)for(var r in i)i.hasOwnProperty(r)&&(e[r]=i[r])}return e}:Object.assign;var v=_((function(t,e,n){for(var i=Object.keys(e),r=0;r<i.length;)(!n||n&&t[i[r]]===a)&&(t[i[r]]=e[i[r]]),r++;return t}),"extend","Use `assign`."),b=_((function(t,e){return v(t,e,!0)}),"merge","Use `assign`.");function y(t,e,n){var i,r=e.prototype;(i=t.prototype=Object.create(r)).constructor=t,i._super=r,n&&l(i,n)}function w(t,e){return function(){return t.apply(e,arguments)}}function x(t,e){return"function"==typeof t?t.apply(e&&e[0]||a,e):t}function C(t,e){return t===a?e:t}function k(t,e,n){m(T(e),(function(e){t.addEventListener(e,n,!1)}))}function E(t,e,n){m(T(e),(function(e){t.removeEventListener(e,n,!1)}))}function S(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1}function A(t,e){return t.indexOf(e)>-1}function T(t){return t.trim().split(/\s+/g)}function M(t,e,n){if(t.indexOf&&!n)return t.indexOf(e);for(var i=0;i<t.length;){if(n&&t[i][n]==e||!n&&t[i]===e)return i;i++}return-1}function D(t){return Array.prototype.slice.call(t,0)}function P(t,e,n){for(var i=[],r=[],o=0;o<t.length;){var s=e?t[o][e]:t[o];M(r,s)<0&&i.push(t[o]),r[o]=s,o++}return n&&(i=e?i.sort((function(t,n){return t[e]>n[e]})):i.sort()),i}function L(t,e){for(var n,i,r=e[0].toUpperCase()+e.slice(1),o=0;o<c.length;){if((i=(n=c[o])?n+r:e)in t)return i;o++}return a}var R=1;function I(t){var e=t.ownerDocument||t;return e.defaultView||e.parentWindow||r}var O="ontouchstart"in r,z=L(r,"PointerEvent")!==a,F=O&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),B="touch",N="mouse",j=["x","y"],U=["clientX","clientY"];function V(t,e){var n=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){x(t.options.enable,[t])&&n.handler(e)},this.init()}function W(t,e,n){var i=n.pointers.length,r=n.changedPointers.length,o=1&e&&i-r==0,s=12&e&&i-r==0;n.isFirst=!!o,n.isFinal=!!s,o&&(t.session={}),n.eventType=e,function(t,e){var n=t.session,i=e.pointers,r=i.length;n.firstInput||(n.firstInput=H(e)),r>1&&!n.firstMultiple?n.firstMultiple=H(e):1===r&&(n.firstMultiple=!1);var o=n.firstInput,s=n.firstMultiple,l=s?s.center:o.center,c=e.center=$(i);e.timeStamp=f(),e.deltaTime=e.timeStamp-o.timeStamp,e.angle=K(l,c),e.distance=G(l,c),function(t,e){var n=e.center,i=t.offsetDelta||{},r=t.prevDelta||{},o=t.prevInput||{};1!==e.eventType&&4!==o.eventType||(r=t.prevDelta={x:o.deltaX||0,y:o.deltaY||0},i=t.offsetDelta={x:n.x,y:n.y}),e.deltaX=r.x+(n.x-i.x),e.deltaY=r.y+(n.y-i.y)}(n,e),e.offsetDirection=q(e.deltaX,e.deltaY);var u,h,p=Z(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=p.x,e.overallVelocityY=p.y,e.overallVelocity=d(p.x)>d(p.y)?p.x:p.y,e.scale=s?(u=s.pointers,G((h=i)[0],h[1],U)/G(u[0],u[1],U)):1,e.rotation=s?function(t,e){return K(e[1],e[0],U)+K(t[1],t[0],U)}(s.pointers,i):0,e.maxPointers=n.prevInput?e.pointers.length>n.prevInput.maxPointers?e.pointers.length:n.prevInput.maxPointers:e.pointers.length,function(t,e){var n,i,r,o,s=t.lastInterval||e,l=e.timeStamp-s.timeStamp;if(8!=e.eventType&&(l>25||s.velocity===a)){var c=e.deltaX-s.deltaX,u=e.deltaY-s.deltaY,h=Z(l,c,u);i=h.x,r=h.y,n=d(h.x)>d(h.y)?h.x:h.y,o=q(c,u),t.lastInterval=e}else n=s.velocity,i=s.velocityX,r=s.velocityY,o=s.direction;e.velocity=n,e.velocityX=i,e.velocityY=r,e.direction=o}(n,e);var g=t.element;S(e.srcEvent.target,g)&&(g=e.srcEvent.target),e.target=g}(t,n),t.emit("hammer.input",n),t.recognize(n),t.session.prevInput=n}function H(t){for(var e=[],n=0;n<t.pointers.length;)e[n]={clientX:h(t.pointers[n].clientX),clientY:h(t.pointers[n].clientY)},n++;return{timeStamp:f(),pointers:e,center:$(e),deltaX:t.deltaX,deltaY:t.deltaY}}function $(t){var e=t.length;if(1===e)return{x:h(t[0].clientX),y:h(t[0].clientY)};for(var n=0,i=0,r=0;r<e;)n+=t[r].clientX,i+=t[r].clientY,r++;return{x:h(n/e),y:h(i/e)}}function Z(t,e,n){return{x:e/t||0,y:n/t||0}}function q(t,e){return t===e?1:d(t)>=d(e)?t<0?2:4:e<0?8:16}function G(t,e,n){n||(n=j);var i=e[n[0]]-t[n[0]],r=e[n[1]]-t[n[1]];return Math.sqrt(i*i+r*r)}function K(t,e,n){n||(n=j);var i=e[n[0]]-t[n[0]],r=e[n[1]]-t[n[1]];return 180*Math.atan2(r,i)/Math.PI}V.prototype={handler:function(){},init:function(){this.evEl&&k(this.element,this.evEl,this.domHandler),this.evTarget&&k(this.target,this.evTarget,this.domHandler),this.evWin&&k(I(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&E(this.element,this.evEl,this.domHandler),this.evTarget&&E(this.target,this.evTarget,this.domHandler),this.evWin&&E(I(this.element),this.evWin,this.domHandler)}};var X={mousedown:1,mousemove:2,mouseup:4},Y="mousedown",Q="mousemove mouseup";function J(){this.evEl=Y,this.evWin=Q,this.pressed=!1,V.apply(this,arguments)}y(J,V,{handler:function(t){var e=X[t.type];1&e&&0===t.button&&(this.pressed=!0),2&e&&1!==t.which&&(e=4),this.pressed&&(4&e&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:N,srcEvent:t}))}});var tt={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},et={2:B,3:"pen",4:N,5:"kinect"},nt="pointerdown",it="pointermove pointerup pointercancel";function rt(){this.evEl=nt,this.evWin=it,V.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}r.MSPointerEvent&&!r.PointerEvent&&(nt="MSPointerDown",it="MSPointerMove MSPointerUp MSPointerCancel"),y(rt,V,{handler:function(t){var e=this.store,n=!1,i=t.type.toLowerCase().replace("ms",""),r=tt[i],o=et[t.pointerType]||t.pointerType,s=o==B,a=M(e,t.pointerId,"pointerId");1&r&&(0===t.button||s)?a<0&&(e.push(t),a=e.length-1):12&r&&(n=!0),a<0||(e[a]=t,this.callback(this.manager,r,{pointers:e,changedPointers:[t],pointerType:o,srcEvent:t}),n&&e.splice(a,1))}});var ot={touchstart:1,touchmove:2,touchend:4,touchcancel:8},st="touchstart",at="touchstart touchmove touchend touchcancel";function lt(){this.evTarget=st,this.evWin=at,this.started=!1,V.apply(this,arguments)}function ct(t,e){var n=D(t.touches),i=D(t.changedTouches);return 12&e&&(n=P(n.concat(i),"identifier",!0)),[n,i]}y(lt,V,{handler:function(t){var e=ot[t.type];if(1===e&&(this.started=!0),this.started){var n=ct.call(this,t,e);12&e&&n[0].length-n[1].length==0&&(this.started=!1),this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:B,srcEvent:t})}}});var ut={touchstart:1,touchmove:2,touchend:4,touchcancel:8},ht="touchstart touchmove touchend touchcancel";function dt(){this.evTarget=ht,this.targetIds={},V.apply(this,arguments)}function ft(t,e){var n=D(t.touches),i=this.targetIds;if(3&e&&1===n.length)return i[n[0].identifier]=!0,[n,n];var r,o,s=D(t.changedTouches),a=[],l=this.target;if(o=n.filter((function(t){return S(t.target,l)})),1===e)for(r=0;r<o.length;)i[o[r].identifier]=!0,r++;for(r=0;r<s.length;)i[s[r].identifier]&&a.push(s[r]),12&e&&delete i[s[r].identifier],r++;return a.length?[P(o.concat(a),"identifier",!0),a]:void 0}function pt(){V.apply(this,arguments);var t=w(this.handler,this);this.touch=new dt(this.manager,t),this.mouse=new J(this.manager,t),this.primaryTouch=null,this.lastTouches=[]}function gt(t,e){1&t?(this.primaryTouch=e.changedPointers[0].identifier,mt.call(this,e)):12&t&&mt.call(this,e)}function mt(t){var e=t.changedPointers[0];if(e.identifier===this.primaryTouch){var n={x:e.clientX,y:e.clientY};this.lastTouches.push(n);var i=this.lastTouches;setTimeout((function(){var t=i.indexOf(n);t>-1&&i.splice(t,1)}),2500)}}function _t(t){for(var e=t.srcEvent.clientX,n=t.srcEvent.clientY,i=0;i<this.lastTouches.length;i++){var r=this.lastTouches[i],o=Math.abs(e-r.x),s=Math.abs(n-r.y);if(o<=25&&s<=25)return!0}return!1}y(dt,V,{handler:function(t){var e=ut[t.type],n=ft.call(this,t,e);n&&this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:B,srcEvent:t})}}),y(pt,V,{handler:function(t,e,n){var i=n.pointerType==B,r=n.pointerType==N;if(!(r&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if(i)gt.call(this,e,n);else if(r&&_t.call(this,n))return;this.callback(t,e,n)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var vt=L(u.style,"touchAction"),bt=vt!==a,yt="compute",wt="auto",xt="manipulation",Ct="none",kt="pan-x",Et="pan-y",St=function(){if(!bt)return!1;var t={},e=r.CSS&&r.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach((function(n){t[n]=!e||r.CSS.supports("touch-action",n)})),t}();function At(t,e){this.manager=t,this.set(e)}At.prototype={set:function(t){t==yt&&(t=this.compute()),bt&&this.manager.element.style&&St[t]&&(this.manager.element.style[vt]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return m(this.manager.recognizers,(function(e){x(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))})),function(t){if(A(t,Ct))return Ct;var e=A(t,kt),n=A(t,Et);return e&&n?Ct:e||n?e?kt:Et:A(t,xt)?xt:wt}(t.join(" "))},preventDefaults:function(t){var e=t.srcEvent,n=t.offsetDirection;if(this.manager.session.prevented)e.preventDefault();else{var i=this.actions,r=A(i,Ct)&&!St.none,o=A(i,Et)&&!St["pan-y"],s=A(i,kt)&&!St["pan-x"];if(r){var a=1===t.pointers.length,l=t.distance<2,c=t.deltaTime<250;if(a&&l&&c)return}if(!s||!o)return r||o&&6&n||s&&24&n?this.preventSrc(e):void 0}},preventSrc:function(t){this.manager.session.prevented=!0,t.preventDefault()}};var Tt=32;function Mt(t){this.options=l({},this.defaults,t||{}),this.id=R++,this.manager=null,this.options.enable=C(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function Dt(t){return 16&t?"cancel":8&t?"end":4&t?"move":2&t?"start":""}function Pt(t){return 16==t?"down":8==t?"up":2==t?"left":4==t?"right":""}function Lt(t,e){var n=e.manager;return n?n.get(t):t}function Rt(){Mt.apply(this,arguments)}function It(){Rt.apply(this,arguments),this.pX=null,this.pY=null}function Ot(){Rt.apply(this,arguments)}function zt(){Mt.apply(this,arguments),this._timer=null,this._input=null}function Ft(){Rt.apply(this,arguments)}function Bt(){Rt.apply(this,arguments)}function Nt(){Mt.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function jt(t,e){return(e=e||{}).recognizers=C(e.recognizers,jt.defaults.preset),new Ut(t,e)}function Ut(t,e){this.options=l({},jt.defaults,e||{}),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=t,this.input=new(this.options.inputClass||(z?rt:F?dt:O?pt:J))(this,W),this.touchAction=new At(this,this.options.touchAction),Vt(this,!0),m(this.options.recognizers,(function(t){var e=this.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])}),this)}function Vt(t,e){var n,i=t.element;i.style&&(m(t.options.cssProps,(function(r,o){n=L(i.style,o),e?(t.oldCssProps[n]=i.style[n],i.style[n]=r):i.style[n]=t.oldCssProps[n]||""})),e||(t.oldCssProps={}))}Mt.prototype={defaults:{},set:function(t){return l(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(g(t,"recognizeWith",this))return this;var e=this.simultaneous;return e[(t=Lt(t,this)).id]||(e[t.id]=t,t.recognizeWith(this)),this},dropRecognizeWith:function(t){return g(t,"dropRecognizeWith",this)||(t=Lt(t,this),delete this.simultaneous[t.id]),this},requireFailure:function(t){if(g(t,"requireFailure",this))return this;var e=this.requireFail;return-1===M(e,t=Lt(t,this))&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(g(t,"dropRequireFailure",this))return this;t=Lt(t,this);var e=M(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(t){var e=this,n=this.state;function i(n){e.manager.emit(n,t)}n<8&&i(e.options.event+Dt(n)),i(e.options.event),t.additionalEvent&&i(t.additionalEvent),n>=8&&i(e.options.event+Dt(n))},tryEmit:function(t){if(this.canEmit())return this.emit(t);this.state=Tt},canEmit:function(){for(var t=0;t<this.requireFail.length;){if(!(33&this.requireFail[t].state))return!1;t++}return!0},recognize:function(t){var e=l({},t);if(!x(this.options.enable,[this,e]))return this.reset(),void(this.state=Tt);56&this.state&&(this.state=1),this.state=this.process(e),30&this.state&&this.tryEmit(e)},process:function(t){},getTouchAction:function(){},reset:function(){}},y(Rt,Mt,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},process:function(t){var e=this.state,n=t.eventType,i=6&e,r=this.attrTest(t);return i&&(8&n||!r)?16|e:i||r?4&n?8|e:2&e?4|e:2:Tt}}),y(It,Rt,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var t=this.options.direction,e=[];return 6&t&&e.push(Et),24&t&&e.push(kt),e},directionTest:function(t){var e=this.options,n=!0,i=t.distance,r=t.direction,o=t.deltaX,s=t.deltaY;return r&e.direction||(6&e.direction?(r=0===o?1:o<0?2:4,n=o!=this.pX,i=Math.abs(t.deltaX)):(r=0===s?1:s<0?8:16,n=s!=this.pY,i=Math.abs(t.deltaY))),t.direction=r,n&&i>e.threshold&&r&e.direction},attrTest:function(t){return Rt.prototype.attrTest.call(this,t)&&(2&this.state||!(2&this.state)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=Pt(t.direction);e&&(t.additionalEvent=this.options.event+e),this._super.emit.call(this,t)}}),y(Ot,Rt,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Ct]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||2&this.state)},emit:function(t){if(1!==t.scale){var e=t.scale<1?"in":"out";t.additionalEvent=this.options.event+e}this._super.emit.call(this,t)}}),y(zt,Mt,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[wt]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,i=t.distance<e.threshold,r=t.deltaTime>e.time;if(this._input=t,!i||!n||12&t.eventType&&!r)this.reset();else if(1&t.eventType)this.reset(),this._timer=p((function(){this.state=8,this.tryEmit()}),e.time,this);else if(4&t.eventType)return 8;return Tt},reset:function(){clearTimeout(this._timer)},emit:function(t){8===this.state&&(t&&4&t.eventType?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=f(),this.manager.emit(this.options.event,this._input)))}}),y(Ft,Rt,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Ct]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||2&this.state)}}),y(Bt,Rt,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return It.prototype.getTouchAction.call(this)},attrTest:function(t){var e,n=this.options.direction;return 30&n?e=t.overallVelocity:6&n?e=t.overallVelocityX:24&n&&(e=t.overallVelocityY),this._super.attrTest.call(this,t)&&n&t.offsetDirection&&t.distance>this.options.threshold&&t.maxPointers==this.options.pointers&&d(e)>this.options.velocity&&4&t.eventType},emit:function(t){var e=Pt(t.offsetDirection);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}}),y(Nt,Mt,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[xt]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,i=t.distance<e.threshold,r=t.deltaTime<e.time;if(this.reset(),1&t.eventType&&0===this.count)return this.failTimeout();if(i&&r&&n){if(4!=t.eventType)return this.failTimeout();var o=!this.pTime||t.timeStamp-this.pTime<e.interval,s=!this.pCenter||G(this.pCenter,t.center)<e.posThreshold;if(this.pTime=t.timeStamp,this.pCenter=t.center,s&&o?this.count+=1:this.count=1,this._input=t,0==this.count%e.taps)return this.hasRequireFailures()?(this._timer=p((function(){this.state=8,this.tryEmit()}),e.interval,this),2):8}return Tt},failTimeout:function(){return this._timer=p((function(){this.state=Tt}),this.options.interval,this),Tt},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),jt.VERSION="2.0.7",jt.defaults={domEvents:!1,touchAction:yt,enable:!0,inputTarget:null,inputClass:null,preset:[[Ft,{enable:!1}],[Ot,{enable:!1},["rotate"]],[Bt,{direction:6}],[It,{direction:6},["swipe"]],[Nt],[Nt,{event:"doubletap",taps:2},["tap"]],[zt]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},Ut.prototype={set:function(t){return l(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?2:1},recognize:function(t){var e=this.session;if(!e.stopped){var n;this.touchAction.preventDefaults(t);var i=this.recognizers,r=e.curRecognizer;(!r||r&&8&r.state)&&(r=e.curRecognizer=null);for(var o=0;o<i.length;)n=i[o],2===e.stopped||r&&n!=r&&!n.canRecognizeWith(r)?n.reset():n.recognize(t),!r&&14&n.state&&(r=e.curRecognizer=n),o++}},get:function(t){if(t instanceof Mt)return t;for(var e=this.recognizers,n=0;n<e.length;n++)if(e[n].options.event==t)return e[n];return null},add:function(t){if(g(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},remove:function(t){if(g(t,"remove",this))return this;if(t=this.get(t)){var e=this.recognizers,n=M(e,t);-1!==n&&(e.splice(n,1),this.touchAction.update())}return this},on:function(t,e){if(t!==a&&e!==a){var n=this.handlers;return m(T(t),(function(t){n[t]=n[t]||[],n[t].push(e)})),this}},off:function(t,e){if(t!==a){var n=this.handlers;return m(T(t),(function(t){e?n[t]&&n[t].splice(M(n[t],e),1):delete n[t]})),this}},emit:function(t,e){this.options.domEvents&&function(t,e){var n=o.createEvent("Event");n.initEvent(t,!0,!0),n.gesture=e,e.target.dispatchEvent(n)}(t,e);var n=this.handlers[t]&&this.handlers[t].slice();if(n&&n.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var i=0;i<n.length;)n[i](e),i++}},destroy:function(){this.element&&Vt(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},l(jt,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:Tt,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:24,DIRECTION_ALL:30,Manager:Ut,Input:V,TouchAction:At,TouchInput:dt,MouseInput:J,PointerEventInput:rt,TouchMouseInput:pt,SingleTouchInput:lt,Recognizer:Mt,AttrRecognizer:Rt,Tap:Nt,Pan:It,Swipe:Bt,Pinch:Ot,Rotate:Ft,Press:zt,on:k,off:E,each:m,merge:b,extend:v,assign:l,inherit:y,bindFn:w,prefixed:L}),(void 0!==r?r:"undefined"!=typeof self?self:{}).Hammer=jt,(i=function(){return jt}.call(e,n,e,t))===a||(t.exports=i)}(window,document)},9755:function(t,e){var n;!function(e,n){"use strict";"object"==typeof t.exports?t.exports=e.document?n(e,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return n(t)}:n(e)}("undefined"!=typeof window?window:this,(function(i,r){"use strict";var o=[],s=Object.getPrototypeOf,a=o.slice,l=o.flat?function(t){return o.flat.call(t)}:function(t){return o.concat.apply([],t)},c=o.push,u=o.indexOf,h={},d=h.toString,f=h.hasOwnProperty,p=f.toString,g=p.call(Object),m={},_=function(t){return"function"==typeof t&&"number"!=typeof t.nodeType&&"function"!=typeof t.item},v=function(t){return null!=t&&t===t.window},b=i.document,y={type:!0,src:!0,nonce:!0,noModule:!0};function w(t,e,n){var i,r,o=(n=n||b).createElement("script");if(o.text=t,e)for(i in y)(r=e[i]||e.getAttribute&&e.getAttribute(i))&&o.setAttribute(i,r);n.head.appendChild(o).parentNode.removeChild(o)}function x(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?h[d.call(t)]||"object":typeof t}var C="3.6.1",k=function(t,e){return new k.fn.init(t,e)};function E(t){var e=!!t&&"length"in t&&t.length,n=x(t);return!_(t)&&!v(t)&&("array"===n||0===e||"number"==typeof e&&e>0&&e-1 in t)}k.fn=k.prototype={jquery:C,constructor:k,length:0,toArray:function(){return a.call(this)},get:function(t){return null==t?a.call(this):t<0?this[t+this.length]:this[t]},pushStack:function(t){var e=k.merge(this.constructor(),t);return e.prevObject=this,e},each:function(t){return k.each(this,t)},map:function(t){return this.pushStack(k.map(this,(function(e,n){return t.call(e,n,e)})))},slice:function(){return this.pushStack(a.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(k.grep(this,(function(t,e){return(e+1)%2})))},odd:function(){return this.pushStack(k.grep(this,(function(t,e){return e%2})))},eq:function(t){var e=this.length,n=+t+(t<0?e:0);return this.pushStack(n>=0&&n<e?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:c,sort:o.sort,splice:o.splice},k.extend=k.fn.extend=function(){var t,e,n,i,r,o,s=arguments[0]||{},a=1,l=arguments.length,c=!1;for("boolean"==typeof s&&(c=s,s=arguments[a]||{},a++),"object"==typeof s||_(s)||(s={}),a===l&&(s=this,a--);a<l;a++)if(null!=(t=arguments[a]))for(e in t)i=t[e],"__proto__"!==e&&s!==i&&(c&&i&&(k.isPlainObject(i)||(r=Array.isArray(i)))?(n=s[e],o=r&&!Array.isArray(n)?[]:r||k.isPlainObject(n)?n:{},r=!1,s[e]=k.extend(c,o,i)):void 0!==i&&(s[e]=i));return s},k.extend({expando:"jQuery"+(C+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isPlainObject:function(t){var e,n;return!(!t||"[object Object]"!==d.call(t)||(e=s(t))&&("function"!=typeof(n=f.call(e,"constructor")&&e.constructor)||p.call(n)!==g))},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},globalEval:function(t,e,n){w(t,{nonce:e&&e.nonce},n)},each:function(t,e){var n,i=0;if(E(t))for(n=t.length;i<n&&!1!==e.call(t[i],i,t[i]);i++);else for(i in t)if(!1===e.call(t[i],i,t[i]))break;return t},makeArray:function(t,e){var n=e||[];return null!=t&&(E(Object(t))?k.merge(n,"string"==typeof t?[t]:t):c.call(n,t)),n},inArray:function(t,e,n){return null==e?-1:u.call(e,t,n)},merge:function(t,e){for(var n=+e.length,i=0,r=t.length;i<n;i++)t[r++]=e[i];return t.length=r,t},grep:function(t,e,n){for(var i=[],r=0,o=t.length,s=!n;r<o;r++)!e(t[r],r)!==s&&i.push(t[r]);return i},map:function(t,e,n){var i,r,o=0,s=[];if(E(t))for(i=t.length;o<i;o++)null!=(r=e(t[o],o,n))&&s.push(r);else for(o in t)null!=(r=e(t[o],o,n))&&s.push(r);return l(s)},guid:1,support:m}),"function"==typeof Symbol&&(k.fn[Symbol.iterator]=o[Symbol.iterator]),k.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),(function(t,e){h["[object "+e+"]"]=e.toLowerCase()}));var S=function(t){var e,n,i,r,o,s,a,l,c,u,h,d,f,p,g,m,_,v,b,y="sizzle"+1*new Date,w=t.document,x=0,C=0,k=lt(),E=lt(),S=lt(),A=lt(),T=function(t,e){return t===e&&(h=!0),0},M={}.hasOwnProperty,D=[],P=D.pop,L=D.push,R=D.push,I=D.slice,O=function(t,e){for(var n=0,i=t.length;n<i;n++)if(t[n]===e)return n;return-1},z="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",F="[\\x20\\t\\r\\n\\f]",B="(?:\\\\[\\da-fA-F]{1,6}[\\x20\\t\\r\\n\\f]?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",N="\\[[\\x20\\t\\r\\n\\f]*("+B+")(?:"+F+"*([*^$|!~]?=)"+F+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+B+"))|)"+F+"*\\]",j=":("+B+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+N+")*)|.*)\\)|)",U=new RegExp(F+"+","g"),V=new RegExp("^[\\x20\\t\\r\\n\\f]+|((?:^|[^\\\\])(?:\\\\.)*)[\\x20\\t\\r\\n\\f]+$","g"),W=new RegExp("^[\\x20\\t\\r\\n\\f]*,[\\x20\\t\\r\\n\\f]*"),H=new RegExp("^[\\x20\\t\\r\\n\\f]*([>+~]|[\\x20\\t\\r\\n\\f])[\\x20\\t\\r\\n\\f]*"),$=new RegExp(F+"|>"),Z=new RegExp(j),q=new RegExp("^"+B+"$"),G={ID:new RegExp("^#("+B+")"),CLASS:new RegExp("^\\.("+B+")"),TAG:new RegExp("^("+B+"|[*])"),ATTR:new RegExp("^"+N),PSEUDO:new RegExp("^"+j),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\([\\x20\\t\\r\\n\\f]*(even|odd|(([+-]|)(\\d*)n|)[\\x20\\t\\r\\n\\f]*(?:([+-]|)[\\x20\\t\\r\\n\\f]*(\\d+)|))[\\x20\\t\\r\\n\\f]*\\)|)","i"),bool:new RegExp("^(?:"+z+")$","i"),needsContext:new RegExp("^[\\x20\\t\\r\\n\\f]*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\([\\x20\\t\\r\\n\\f]*((?:-\\d)?\\d*)[\\x20\\t\\r\\n\\f]*\\)|)(?=[^-]|$)","i")},K=/HTML$/i,X=/^(?:input|select|textarea|button)$/i,Y=/^h\d$/i,Q=/^[^{]+\{\s*\[native \w/,J=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,tt=/[+~]/,et=new RegExp("\\\\[\\da-fA-F]{1,6}[\\x20\\t\\r\\n\\f]?|\\\\([^\\r\\n\\f])","g"),nt=function(t,e){var n="0x"+t.slice(1)-65536;return e||(n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320))},it=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,rt=function(t,e){return e?"\0"===t?"�":t.slice(0,-1)+"\\"+t.charCodeAt(t.length-1).toString(16)+" ":"\\"+t},ot=function(){d()},st=yt((function(t){return!0===t.disabled&&"fieldset"===t.nodeName.toLowerCase()}),{dir:"parentNode",next:"legend"});try{R.apply(D=I.call(w.childNodes),w.childNodes),D[w.childNodes.length].nodeType}catch(t){R={apply:D.length?function(t,e){L.apply(t,I.call(e))}:function(t,e){for(var n=t.length,i=0;t[n++]=e[i++];);t.length=n-1}}}function at(t,e,i,r){var o,a,c,u,h,p,_,v=e&&e.ownerDocument,w=e?e.nodeType:9;if(i=i||[],"string"!=typeof t||!t||1!==w&&9!==w&&11!==w)return i;if(!r&&(d(e),e=e||f,g)){if(11!==w&&(h=J.exec(t)))if(o=h[1]){if(9===w){if(!(c=e.getElementById(o)))return i;if(c.id===o)return i.push(c),i}else if(v&&(c=v.getElementById(o))&&b(e,c)&&c.id===o)return i.push(c),i}else{if(h[2])return R.apply(i,e.getElementsByTagName(t)),i;if((o=h[3])&&n.getElementsByClassName&&e.getElementsByClassName)return R.apply(i,e.getElementsByClassName(o)),i}if(n.qsa&&!A[t+" "]&&(!m||!m.test(t))&&(1!==w||"object"!==e.nodeName.toLowerCase())){if(_=t,v=e,1===w&&($.test(t)||H.test(t))){for((v=tt.test(t)&&_t(e.parentNode)||e)===e&&n.scope||((u=e.getAttribute("id"))?u=u.replace(it,rt):e.setAttribute("id",u=y)),a=(p=s(t)).length;a--;)p[a]=(u?"#"+u:":scope")+" "+bt(p[a]);_=p.join(",")}try{return R.apply(i,v.querySelectorAll(_)),i}catch(e){A(t,!0)}finally{u===y&&e.removeAttribute("id")}}}return l(t.replace(V,"$1"),e,i,r)}function lt(){var t=[];return function e(n,r){return t.push(n+" ")>i.cacheLength&&delete e[t.shift()],e[n+" "]=r}}function ct(t){return t[y]=!0,t}function ut(t){var e=f.createElement("fieldset");try{return!!t(e)}catch(t){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function ht(t,e){for(var n=t.split("|"),r=n.length;r--;)i.attrHandle[n[r]]=e}function dt(t,e){var n=e&&t,i=n&&1===t.nodeType&&1===e.nodeType&&t.sourceIndex-e.sourceIndex;if(i)return i;if(n)for(;n=n.nextSibling;)if(n===e)return-1;return t?1:-1}function ft(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}function pt(t){return function(e){var n=e.nodeName.toLowerCase();return("input"===n||"button"===n)&&e.type===t}}function gt(t){return function(e){return"form"in e?e.parentNode&&!1===e.disabled?"label"in e?"label"in e.parentNode?e.parentNode.disabled===t:e.disabled===t:e.isDisabled===t||e.isDisabled!==!t&&st(e)===t:e.disabled===t:"label"in e&&e.disabled===t}}function mt(t){return ct((function(e){return e=+e,ct((function(n,i){for(var r,o=t([],n.length,e),s=o.length;s--;)n[r=o[s]]&&(n[r]=!(i[r]=n[r]))}))}))}function _t(t){return t&&void 0!==t.getElementsByTagName&&t}for(e in n=at.support={},o=at.isXML=function(t){var e=t&&t.namespaceURI,n=t&&(t.ownerDocument||t).documentElement;return!K.test(e||n&&n.nodeName||"HTML")},d=at.setDocument=function(t){var e,r,s=t?t.ownerDocument||t:w;return s!=f&&9===s.nodeType&&s.documentElement?(p=(f=s).documentElement,g=!o(f),w!=f&&(r=f.defaultView)&&r.top!==r&&(r.addEventListener?r.addEventListener("unload",ot,!1):r.attachEvent&&r.attachEvent("onunload",ot)),n.scope=ut((function(t){return p.appendChild(t).appendChild(f.createElement("div")),void 0!==t.querySelectorAll&&!t.querySelectorAll(":scope fieldset div").length})),n.attributes=ut((function(t){return t.className="i",!t.getAttribute("className")})),n.getElementsByTagName=ut((function(t){return t.appendChild(f.createComment("")),!t.getElementsByTagName("*").length})),n.getElementsByClassName=Q.test(f.getElementsByClassName),n.getById=ut((function(t){return p.appendChild(t).id=y,!f.getElementsByName||!f.getElementsByName(y).length})),n.getById?(i.filter.ID=function(t){var e=t.replace(et,nt);return function(t){return t.getAttribute("id")===e}},i.find.ID=function(t,e){if(void 0!==e.getElementById&&g){var n=e.getElementById(t);return n?[n]:[]}}):(i.filter.ID=function(t){var e=t.replace(et,nt);return function(t){var n=void 0!==t.getAttributeNode&&t.getAttributeNode("id");return n&&n.value===e}},i.find.ID=function(t,e){if(void 0!==e.getElementById&&g){var n,i,r,o=e.getElementById(t);if(o){if((n=o.getAttributeNode("id"))&&n.value===t)return[o];for(r=e.getElementsByName(t),i=0;o=r[i++];)if((n=o.getAttributeNode("id"))&&n.value===t)return[o]}return[]}}),i.find.TAG=n.getElementsByTagName?function(t,e){return void 0!==e.getElementsByTagName?e.getElementsByTagName(t):n.qsa?e.querySelectorAll(t):void 0}:function(t,e){var n,i=[],r=0,o=e.getElementsByTagName(t);if("*"===t){for(;n=o[r++];)1===n.nodeType&&i.push(n);return i}return o},i.find.CLASS=n.getElementsByClassName&&function(t,e){if(void 0!==e.getElementsByClassName&&g)return e.getElementsByClassName(t)},_=[],m=[],(n.qsa=Q.test(f.querySelectorAll))&&(ut((function(t){var e;p.appendChild(t).innerHTML="<a id='"+y+"'></a><select id='"+y+"-\r\\' msallowcapture=''><option selected=''></option></select>",t.querySelectorAll("[msallowcapture^='']").length&&m.push("[*^$]=[\\x20\\t\\r\\n\\f]*(?:''|\"\")"),t.querySelectorAll("[selected]").length||m.push("\\[[\\x20\\t\\r\\n\\f]*(?:value|"+z+")"),t.querySelectorAll("[id~="+y+"-]").length||m.push("~="),(e=f.createElement("input")).setAttribute("name",""),t.appendChild(e),t.querySelectorAll("[name='']").length||m.push("\\[[\\x20\\t\\r\\n\\f]*name[\\x20\\t\\r\\n\\f]*=[\\x20\\t\\r\\n\\f]*(?:''|\"\")"),t.querySelectorAll(":checked").length||m.push(":checked"),t.querySelectorAll("a#"+y+"+*").length||m.push(".#.+[+~]"),t.querySelectorAll("\\\f"),m.push("[\\r\\n\\f]")})),ut((function(t){t.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var e=f.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&m.push("name[\\x20\\t\\r\\n\\f]*[*^$|!~]?="),2!==t.querySelectorAll(":enabled").length&&m.push(":enabled",":disabled"),p.appendChild(t).disabled=!0,2!==t.querySelectorAll(":disabled").length&&m.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),m.push(",.*:")}))),(n.matchesSelector=Q.test(v=p.matches||p.webkitMatchesSelector||p.mozMatchesSelector||p.oMatchesSelector||p.msMatchesSelector))&&ut((function(t){n.disconnectedMatch=v.call(t,"*"),v.call(t,"[s!='']:x"),_.push("!=",j)})),m=m.length&&new RegExp(m.join("|")),_=_.length&&new RegExp(_.join("|")),e=Q.test(p.compareDocumentPosition),b=e||Q.test(p.contains)?function(t,e){var n=9===t.nodeType?t.documentElement:t,i=e&&e.parentNode;return t===i||!(!i||1!==i.nodeType||!(n.contains?n.contains(i):t.compareDocumentPosition&&16&t.compareDocumentPosition(i)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},T=e?function(t,e){if(t===e)return h=!0,0;var i=!t.compareDocumentPosition-!e.compareDocumentPosition;return i||(1&(i=(t.ownerDocument||t)==(e.ownerDocument||e)?t.compareDocumentPosition(e):1)||!n.sortDetached&&e.compareDocumentPosition(t)===i?t==f||t.ownerDocument==w&&b(w,t)?-1:e==f||e.ownerDocument==w&&b(w,e)?1:u?O(u,t)-O(u,e):0:4&i?-1:1)}:function(t,e){if(t===e)return h=!0,0;var n,i=0,r=t.parentNode,o=e.parentNode,s=[t],a=[e];if(!r||!o)return t==f?-1:e==f?1:r?-1:o?1:u?O(u,t)-O(u,e):0;if(r===o)return dt(t,e);for(n=t;n=n.parentNode;)s.unshift(n);for(n=e;n=n.parentNode;)a.unshift(n);for(;s[i]===a[i];)i++;return i?dt(s[i],a[i]):s[i]==w?-1:a[i]==w?1:0},f):f},at.matches=function(t,e){return at(t,null,null,e)},at.matchesSelector=function(t,e){if(d(t),n.matchesSelector&&g&&!A[e+" "]&&(!_||!_.test(e))&&(!m||!m.test(e)))try{var i=v.call(t,e);if(i||n.disconnectedMatch||t.document&&11!==t.document.nodeType)return i}catch(t){A(e,!0)}return at(e,f,null,[t]).length>0},at.contains=function(t,e){return(t.ownerDocument||t)!=f&&d(t),b(t,e)},at.attr=function(t,e){(t.ownerDocument||t)!=f&&d(t);var r=i.attrHandle[e.toLowerCase()],o=r&&M.call(i.attrHandle,e.toLowerCase())?r(t,e,!g):void 0;return void 0!==o?o:n.attributes||!g?t.getAttribute(e):(o=t.getAttributeNode(e))&&o.specified?o.value:null},at.escape=function(t){return(t+"").replace(it,rt)},at.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},at.uniqueSort=function(t){var e,i=[],r=0,o=0;if(h=!n.detectDuplicates,u=!n.sortStable&&t.slice(0),t.sort(T),h){for(;e=t[o++];)e===t[o]&&(r=i.push(o));for(;r--;)t.splice(i[r],1)}return u=null,t},r=at.getText=function(t){var e,n="",i=0,o=t.nodeType;if(o){if(1===o||9===o||11===o){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)n+=r(t)}else if(3===o||4===o)return t.nodeValue}else for(;e=t[i++];)n+=r(e);return n},i=at.selectors={cacheLength:50,createPseudo:ct,match:G,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(et,nt),t[3]=(t[3]||t[4]||t[5]||"").replace(et,nt),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||at.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&at.error(t[0]),t},PSEUDO:function(t){var e,n=!t[6]&&t[2];return G.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":n&&Z.test(n)&&(e=s(n,!0))&&(e=n.indexOf(")",n.length-e)-n.length)&&(t[0]=t[0].slice(0,e),t[2]=n.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(et,nt).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=k[t+" "];return e||(e=new RegExp("(^|[\\x20\\t\\r\\n\\f])"+t+"("+F+"|$)"))&&k(t,(function(t){return e.test("string"==typeof t.className&&t.className||void 0!==t.getAttribute&&t.getAttribute("class")||"")}))},ATTR:function(t,e,n){return function(i){var r=at.attr(i,t);return null==r?"!="===e:!e||(r+="","="===e?r===n:"!="===e?r!==n:"^="===e?n&&0===r.indexOf(n):"*="===e?n&&r.indexOf(n)>-1:"$="===e?n&&r.slice(-n.length)===n:"~="===e?(" "+r.replace(U," ")+" ").indexOf(n)>-1:"|="===e&&(r===n||r.slice(0,n.length+1)===n+"-"))}},CHILD:function(t,e,n,i,r){var o="nth"!==t.slice(0,3),s="last"!==t.slice(-4),a="of-type"===e;return 1===i&&0===r?function(t){return!!t.parentNode}:function(e,n,l){var c,u,h,d,f,p,g=o!==s?"nextSibling":"previousSibling",m=e.parentNode,_=a&&e.nodeName.toLowerCase(),v=!l&&!a,b=!1;if(m){if(o){for(;g;){for(d=e;d=d[g];)if(a?d.nodeName.toLowerCase()===_:1===d.nodeType)return!1;p=g="only"===t&&!p&&"nextSibling"}return!0}if(p=[s?m.firstChild:m.lastChild],s&&v){for(b=(f=(c=(u=(h=(d=m)[y]||(d[y]={}))[d.uniqueID]||(h[d.uniqueID]={}))[t]||[])[0]===x&&c[1])&&c[2],d=f&&m.childNodes[f];d=++f&&d&&d[g]||(b=f=0)||p.pop();)if(1===d.nodeType&&++b&&d===e){u[t]=[x,f,b];break}}else if(v&&(b=f=(c=(u=(h=(d=e)[y]||(d[y]={}))[d.uniqueID]||(h[d.uniqueID]={}))[t]||[])[0]===x&&c[1]),!1===b)for(;(d=++f&&d&&d[g]||(b=f=0)||p.pop())&&((a?d.nodeName.toLowerCase()!==_:1!==d.nodeType)||!++b||(v&&((u=(h=d[y]||(d[y]={}))[d.uniqueID]||(h[d.uniqueID]={}))[t]=[x,b]),d!==e)););return(b-=r)===i||b%i==0&&b/i>=0}}},PSEUDO:function(t,e){var n,r=i.pseudos[t]||i.setFilters[t.toLowerCase()]||at.error("unsupported pseudo: "+t);return r[y]?r(e):r.length>1?(n=[t,t,"",e],i.setFilters.hasOwnProperty(t.toLowerCase())?ct((function(t,n){for(var i,o=r(t,e),s=o.length;s--;)t[i=O(t,o[s])]=!(n[i]=o[s])})):function(t){return r(t,0,n)}):r}},pseudos:{not:ct((function(t){var e=[],n=[],i=a(t.replace(V,"$1"));return i[y]?ct((function(t,e,n,r){for(var o,s=i(t,null,r,[]),a=t.length;a--;)(o=s[a])&&(t[a]=!(e[a]=o))})):function(t,r,o){return e[0]=t,i(e,null,o,n),e[0]=null,!n.pop()}})),has:ct((function(t){return function(e){return at(t,e).length>0}})),contains:ct((function(t){return t=t.replace(et,nt),function(e){return(e.textContent||r(e)).indexOf(t)>-1}})),lang:ct((function(t){return q.test(t||"")||at.error("unsupported lang: "+t),t=t.replace(et,nt).toLowerCase(),function(e){var n;do{if(n=g?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(n=n.toLowerCase())===t||0===n.indexOf(t+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}})),target:function(e){var n=t.location&&t.location.hash;return n&&n.slice(1)===e.id},root:function(t){return t===p},focus:function(t){return t===f.activeElement&&(!f.hasFocus||f.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:gt(!1),disabled:gt(!0),checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,!0===t.selected},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!i.pseudos.empty(t)},header:function(t){return Y.test(t.nodeName)},input:function(t){return X.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:mt((function(){return[0]})),last:mt((function(t,e){return[e-1]})),eq:mt((function(t,e,n){return[n<0?n+e:n]})),even:mt((function(t,e){for(var n=0;n<e;n+=2)t.push(n);return t})),odd:mt((function(t,e){for(var n=1;n<e;n+=2)t.push(n);return t})),lt:mt((function(t,e,n){for(var i=n<0?n+e:n>e?e:n;--i>=0;)t.push(i);return t})),gt:mt((function(t,e,n){for(var i=n<0?n+e:n;++i<e;)t.push(i);return t}))}},i.pseudos.nth=i.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})i.pseudos[e]=ft(e);for(e in{submit:!0,reset:!0})i.pseudos[e]=pt(e);function vt(){}function bt(t){for(var e=0,n=t.length,i="";e<n;e++)i+=t[e].value;return i}function yt(t,e,n){var i=e.dir,r=e.next,o=r||i,s=n&&"parentNode"===o,a=C++;return e.first?function(e,n,r){for(;e=e[i];)if(1===e.nodeType||s)return t(e,n,r);return!1}:function(e,n,l){var c,u,h,d=[x,a];if(l){for(;e=e[i];)if((1===e.nodeType||s)&&t(e,n,l))return!0}else for(;e=e[i];)if(1===e.nodeType||s)if(u=(h=e[y]||(e[y]={}))[e.uniqueID]||(h[e.uniqueID]={}),r&&r===e.nodeName.toLowerCase())e=e[i]||e;else{if((c=u[o])&&c[0]===x&&c[1]===a)return d[2]=c[2];if(u[o]=d,d[2]=t(e,n,l))return!0}return!1}}function wt(t){return t.length>1?function(e,n,i){for(var r=t.length;r--;)if(!t[r](e,n,i))return!1;return!0}:t[0]}function xt(t,e,n,i,r){for(var o,s=[],a=0,l=t.length,c=null!=e;a<l;a++)(o=t[a])&&(n&&!n(o,i,r)||(s.push(o),c&&e.push(a)));return s}function Ct(t,e,n,i,r,o){return i&&!i[y]&&(i=Ct(i)),r&&!r[y]&&(r=Ct(r,o)),ct((function(o,s,a,l){var c,u,h,d=[],f=[],p=s.length,g=o||function(t,e,n){for(var i=0,r=e.length;i<r;i++)at(t,e[i],n);return n}(e||"*",a.nodeType?[a]:a,[]),m=!t||!o&&e?g:xt(g,d,t,a,l),_=n?r||(o?t:p||i)?[]:s:m;if(n&&n(m,_,a,l),i)for(c=xt(_,f),i(c,[],a,l),u=c.length;u--;)(h=c[u])&&(_[f[u]]=!(m[f[u]]=h));if(o){if(r||t){if(r){for(c=[],u=_.length;u--;)(h=_[u])&&c.push(m[u]=h);r(null,_=[],c,l)}for(u=_.length;u--;)(h=_[u])&&(c=r?O(o,h):d[u])>-1&&(o[c]=!(s[c]=h))}}else _=xt(_===s?_.splice(p,_.length):_),r?r(null,s,_,l):R.apply(s,_)}))}function kt(t){for(var e,n,r,o=t.length,s=i.relative[t[0].type],a=s||i.relative[" "],l=s?1:0,u=yt((function(t){return t===e}),a,!0),h=yt((function(t){return O(e,t)>-1}),a,!0),d=[function(t,n,i){var r=!s&&(i||n!==c)||((e=n).nodeType?u(t,n,i):h(t,n,i));return e=null,r}];l<o;l++)if(n=i.relative[t[l].type])d=[yt(wt(d),n)];else{if((n=i.filter[t[l].type].apply(null,t[l].matches))[y]){for(r=++l;r<o&&!i.relative[t[r].type];r++);return Ct(l>1&&wt(d),l>1&&bt(t.slice(0,l-1).concat({value:" "===t[l-2].type?"*":""})).replace(V,"$1"),n,l<r&&kt(t.slice(l,r)),r<o&&kt(t=t.slice(r)),r<o&&bt(t))}d.push(n)}return wt(d)}return vt.prototype=i.filters=i.pseudos,i.setFilters=new vt,s=at.tokenize=function(t,e){var n,r,o,s,a,l,c,u=E[t+" "];if(u)return e?0:u.slice(0);for(a=t,l=[],c=i.preFilter;a;){for(s in n&&!(r=W.exec(a))||(r&&(a=a.slice(r[0].length)||a),l.push(o=[])),n=!1,(r=H.exec(a))&&(n=r.shift(),o.push({value:n,type:r[0].replace(V," ")}),a=a.slice(n.length)),i.filter)!(r=G[s].exec(a))||c[s]&&!(r=c[s](r))||(n=r.shift(),o.push({value:n,type:s,matches:r}),a=a.slice(n.length));if(!n)break}return e?a.length:a?at.error(t):E(t,l).slice(0)},a=at.compile=function(t,e){var n,r=[],o=[],a=S[t+" "];if(!a){for(e||(e=s(t)),n=e.length;n--;)(a=kt(e[n]))[y]?r.push(a):o.push(a);a=S(t,function(t,e){var n=e.length>0,r=t.length>0,o=function(o,s,a,l,u){var h,p,m,_=0,v="0",b=o&&[],y=[],w=c,C=o||r&&i.find.TAG("*",u),k=x+=null==w?1:Math.random()||.1,E=C.length;for(u&&(c=s==f||s||u);v!==E&&null!=(h=C[v]);v++){if(r&&h){for(p=0,s||h.ownerDocument==f||(d(h),a=!g);m=t[p++];)if(m(h,s||f,a)){l.push(h);break}u&&(x=k)}n&&((h=!m&&h)&&_--,o&&b.push(h))}if(_+=v,n&&v!==_){for(p=0;m=e[p++];)m(b,y,s,a);if(o){if(_>0)for(;v--;)b[v]||y[v]||(y[v]=P.call(l));y=xt(y)}R.apply(l,y),u&&!o&&y.length>0&&_+e.length>1&&at.uniqueSort(l)}return u&&(x=k,c=w),b};return n?ct(o):o}(o,r)),a.selector=t}return a},l=at.select=function(t,e,n,r){var o,l,c,u,h,d="function"==typeof t&&t,f=!r&&s(t=d.selector||t);if(n=n||[],1===f.length){if((l=f[0]=f[0].slice(0)).length>2&&"ID"===(c=l[0]).type&&9===e.nodeType&&g&&i.relative[l[1].type]){if(!(e=(i.find.ID(c.matches[0].replace(et,nt),e)||[])[0]))return n;d&&(e=e.parentNode),t=t.slice(l.shift().value.length)}for(o=G.needsContext.test(t)?0:l.length;o--&&(c=l[o],!i.relative[u=c.type]);)if((h=i.find[u])&&(r=h(c.matches[0].replace(et,nt),tt.test(l[0].type)&&_t(e.parentNode)||e))){if(l.splice(o,1),!(t=r.length&&bt(l)))return R.apply(n,r),n;break}}return(d||a(t,f))(r,e,!g,n,!e||tt.test(t)&&_t(e.parentNode)||e),n},n.sortStable=y.split("").sort(T).join("")===y,n.detectDuplicates=!!h,d(),n.sortDetached=ut((function(t){return 1&t.compareDocumentPosition(f.createElement("fieldset"))})),ut((function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")}))||ht("type|href|height|width",(function(t,e,n){if(!n)return t.getAttribute(e,"type"===e.toLowerCase()?1:2)})),n.attributes&&ut((function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")}))||ht("value",(function(t,e,n){if(!n&&"input"===t.nodeName.toLowerCase())return t.defaultValue})),ut((function(t){return null==t.getAttribute("disabled")}))||ht(z,(function(t,e,n){var i;if(!n)return!0===t[e]?e.toLowerCase():(i=t.getAttributeNode(e))&&i.specified?i.value:null})),at}(i);k.find=S,k.expr=S.selectors,k.expr[":"]=k.expr.pseudos,k.uniqueSort=k.unique=S.uniqueSort,k.text=S.getText,k.isXMLDoc=S.isXML,k.contains=S.contains,k.escapeSelector=S.escape;var A=function(t,e,n){for(var i=[],r=void 0!==n;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(r&&k(t).is(n))break;i.push(t)}return i},T=function(t,e){for(var n=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&n.push(t);return n},M=k.expr.match.needsContext;function D(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()}var P=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function L(t,e,n){return _(e)?k.grep(t,(function(t,i){return!!e.call(t,i,t)!==n})):e.nodeType?k.grep(t,(function(t){return t===e!==n})):"string"!=typeof e?k.grep(t,(function(t){return u.call(e,t)>-1!==n})):k.filter(e,t,n)}k.filter=function(t,e,n){var i=e[0];return n&&(t=":not("+t+")"),1===e.length&&1===i.nodeType?k.find.matchesSelector(i,t)?[i]:[]:k.find.matches(t,k.grep(e,(function(t){return 1===t.nodeType})))},k.fn.extend({find:function(t){var e,n,i=this.length,r=this;if("string"!=typeof t)return this.pushStack(k(t).filter((function(){for(e=0;e<i;e++)if(k.contains(r[e],this))return!0})));for(n=this.pushStack([]),e=0;e<i;e++)k.find(t,r[e],n);return i>1?k.uniqueSort(n):n},filter:function(t){return this.pushStack(L(this,t||[],!1))},not:function(t){return this.pushStack(L(this,t||[],!0))},is:function(t){return!!L(this,"string"==typeof t&&M.test(t)?k(t):t||[],!1).length}});var R,I=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(k.fn.init=function(t,e,n){var i,r;if(!t)return this;if(n=n||R,"string"==typeof t){if(!(i="<"===t[0]&&">"===t[t.length-1]&&t.length>=3?[null,t,null]:I.exec(t))||!i[1]&&e)return!e||e.jquery?(e||n).find(t):this.constructor(e).find(t);if(i[1]){if(e=e instanceof k?e[0]:e,k.merge(this,k.parseHTML(i[1],e&&e.nodeType?e.ownerDocument||e:b,!0)),P.test(i[1])&&k.isPlainObject(e))for(i in e)_(this[i])?this[i](e[i]):this.attr(i,e[i]);return this}return(r=b.getElementById(i[2]))&&(this[0]=r,this.length=1),this}return t.nodeType?(this[0]=t,this.length=1,this):_(t)?void 0!==n.ready?n.ready(t):t(k):k.makeArray(t,this)}).prototype=k.fn,R=k(b);var O=/^(?:parents|prev(?:Until|All))/,z={children:!0,contents:!0,next:!0,prev:!0};function F(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}k.fn.extend({has:function(t){var e=k(t,this),n=e.length;return this.filter((function(){for(var t=0;t<n;t++)if(k.contains(this,e[t]))return!0}))},closest:function(t,e){var n,i=0,r=this.length,o=[],s="string"!=typeof t&&k(t);if(!M.test(t))for(;i<r;i++)for(n=this[i];n&&n!==e;n=n.parentNode)if(n.nodeType<11&&(s?s.index(n)>-1:1===n.nodeType&&k.find.matchesSelector(n,t))){o.push(n);break}return this.pushStack(o.length>1?k.uniqueSort(o):o)},index:function(t){return t?"string"==typeof t?u.call(k(t),this[0]):u.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(k.uniqueSort(k.merge(this.get(),k(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),k.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return A(t,"parentNode")},parentsUntil:function(t,e,n){return A(t,"parentNode",n)},next:function(t){return F(t,"nextSibling")},prev:function(t){return F(t,"previousSibling")},nextAll:function(t){return A(t,"nextSibling")},prevAll:function(t){return A(t,"previousSibling")},nextUntil:function(t,e,n){return A(t,"nextSibling",n)},prevUntil:function(t,e,n){return A(t,"previousSibling",n)},siblings:function(t){return T((t.parentNode||{}).firstChild,t)},children:function(t){return T(t.firstChild)},contents:function(t){return null!=t.contentDocument&&s(t.contentDocument)?t.contentDocument:(D(t,"template")&&(t=t.content||t),k.merge([],t.childNodes))}},(function(t,e){k.fn[t]=function(n,i){var r=k.map(this,e,n);return"Until"!==t.slice(-5)&&(i=n),i&&"string"==typeof i&&(r=k.filter(i,r)),this.length>1&&(z[t]||k.uniqueSort(r),O.test(t)&&r.reverse()),this.pushStack(r)}}));var B=/[^\x20\t\r\n\f]+/g;function N(t){return t}function j(t){throw t}function U(t,e,n,i){var r;try{t&&_(r=t.promise)?r.call(t).done(e).fail(n):t&&_(r=t.then)?r.call(t,e,n):e.apply(void 0,[t].slice(i))}catch(t){n.apply(void 0,[t])}}k.Callbacks=function(t){t="string"==typeof t?function(t){var e={};return k.each(t.match(B)||[],(function(t,n){e[n]=!0})),e}(t):k.extend({},t);var e,n,i,r,o=[],s=[],a=-1,l=function(){for(r=r||t.once,i=e=!0;s.length;a=-1)for(n=s.shift();++a<o.length;)!1===o[a].apply(n[0],n[1])&&t.stopOnFalse&&(a=o.length,n=!1);t.memory||(n=!1),e=!1,r&&(o=n?[]:"")},c={add:function(){return o&&(n&&!e&&(a=o.length-1,s.push(n)),function e(n){k.each(n,(function(n,i){_(i)?t.unique&&c.has(i)||o.push(i):i&&i.length&&"string"!==x(i)&&e(i)}))}(arguments),n&&!e&&l()),this},remove:function(){return k.each(arguments,(function(t,e){for(var n;(n=k.inArray(e,o,n))>-1;)o.splice(n,1),n<=a&&a--})),this},has:function(t){return t?k.inArray(t,o)>-1:o.length>0},empty:function(){return o&&(o=[]),this},disable:function(){return r=s=[],o=n="",this},disabled:function(){return!o},lock:function(){return r=s=[],n||e||(o=n=""),this},locked:function(){return!!r},fireWith:function(t,n){return r||(n=[t,(n=n||[]).slice?n.slice():n],s.push(n),e||l()),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!i}};return c},k.extend({Deferred:function(t){var e=[["notify","progress",k.Callbacks("memory"),k.Callbacks("memory"),2],["resolve","done",k.Callbacks("once memory"),k.Callbacks("once memory"),0,"resolved"],["reject","fail",k.Callbacks("once memory"),k.Callbacks("once memory"),1,"rejected"]],n="pending",r={state:function(){return n},always:function(){return o.done(arguments).fail(arguments),this},catch:function(t){return r.then(null,t)},pipe:function(){var t=arguments;return k.Deferred((function(n){k.each(e,(function(e,i){var r=_(t[i[4]])&&t[i[4]];o[i[1]]((function(){var t=r&&r.apply(this,arguments);t&&_(t.promise)?t.promise().progress(n.notify).done(n.resolve).fail(n.reject):n[i[0]+"With"](this,r?[t]:arguments)}))})),t=null})).promise()},then:function(t,n,r){var o=0;function s(t,e,n,r){return function(){var a=this,l=arguments,c=function(){var i,c;if(!(t<o)){if((i=n.apply(a,l))===e.promise())throw new TypeError("Thenable self-resolution");c=i&&("object"==typeof i||"function"==typeof i)&&i.then,_(c)?r?c.call(i,s(o,e,N,r),s(o,e,j,r)):(o++,c.call(i,s(o,e,N,r),s(o,e,j,r),s(o,e,N,e.notifyWith))):(n!==N&&(a=void 0,l=[i]),(r||e.resolveWith)(a,l))}},u=r?c:function(){try{c()}catch(i){k.Deferred.exceptionHook&&k.Deferred.exceptionHook(i,u.stackTrace),t+1>=o&&(n!==j&&(a=void 0,l=[i]),e.rejectWith(a,l))}};t?u():(k.Deferred.getStackHook&&(u.stackTrace=k.Deferred.getStackHook()),i.setTimeout(u))}}return k.Deferred((function(i){e[0][3].add(s(0,i,_(r)?r:N,i.notifyWith)),e[1][3].add(s(0,i,_(t)?t:N)),e[2][3].add(s(0,i,_(n)?n:j))})).promise()},promise:function(t){return null!=t?k.extend(t,r):r}},o={};return k.each(e,(function(t,i){var s=i[2],a=i[5];r[i[1]]=s.add,a&&s.add((function(){n=a}),e[3-t][2].disable,e[3-t][3].disable,e[0][2].lock,e[0][3].lock),s.add(i[3].fire),o[i[0]]=function(){return o[i[0]+"With"](this===o?void 0:this,arguments),this},o[i[0]+"With"]=s.fireWith})),r.promise(o),t&&t.call(o,o),o},when:function(t){var e=arguments.length,n=e,i=Array(n),r=a.call(arguments),o=k.Deferred(),s=function(t){return function(n){i[t]=this,r[t]=arguments.length>1?a.call(arguments):n,--e||o.resolveWith(i,r)}};if(e<=1&&(U(t,o.done(s(n)).resolve,o.reject,!e),"pending"===o.state()||_(r[n]&&r[n].then)))return o.then();for(;n--;)U(r[n],s(n),o.reject);return o.promise()}});var V=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;k.Deferred.exceptionHook=function(t,e){i.console&&i.console.warn&&t&&V.test(t.name)&&i.console.warn("jQuery.Deferred exception: "+t.message,t.stack,e)},k.readyException=function(t){i.setTimeout((function(){throw t}))};var W=k.Deferred();function H(){b.removeEventListener("DOMContentLoaded",H),i.removeEventListener("load",H),k.ready()}k.fn.ready=function(t){return W.then(t).catch((function(t){k.readyException(t)})),this},k.extend({isReady:!1,readyWait:1,ready:function(t){(!0===t?--k.readyWait:k.isReady)||(k.isReady=!0,!0!==t&&--k.readyWait>0||W.resolveWith(b,[k]))}}),k.ready.then=W.then,"complete"===b.readyState||"loading"!==b.readyState&&!b.documentElement.doScroll?i.setTimeout(k.ready):(b.addEventListener("DOMContentLoaded",H),i.addEventListener("load",H));var $=function(t,e,n,i,r,o,s){var a=0,l=t.length,c=null==n;if("object"===x(n))for(a in r=!0,n)$(t,e,a,n[a],!0,o,s);else if(void 0!==i&&(r=!0,_(i)||(s=!0),c&&(s?(e.call(t,i),e=null):(c=e,e=function(t,e,n){return c.call(k(t),n)})),e))for(;a<l;a++)e(t[a],n,s?i:i.call(t[a],a,e(t[a],n)));return r?t:c?e.call(t):l?e(t[0],n):o},Z=/^-ms-/,q=/-([a-z])/g;function G(t,e){return e.toUpperCase()}function K(t){return t.replace(Z,"ms-").replace(q,G)}var X=function(t){return 1===t.nodeType||9===t.nodeType||!+t.nodeType};function Y(){this.expando=k.expando+Y.uid++}Y.uid=1,Y.prototype={cache:function(t){var e=t[this.expando];return e||(e={},X(t)&&(t.nodeType?t[this.expando]=e:Object.defineProperty(t,this.expando,{value:e,configurable:!0}))),e},set:function(t,e,n){var i,r=this.cache(t);if("string"==typeof e)r[K(e)]=n;else for(i in e)r[K(i)]=e[i];return r},get:function(t,e){return void 0===e?this.cache(t):t[this.expando]&&t[this.expando][K(e)]},access:function(t,e,n){return void 0===e||e&&"string"==typeof e&&void 0===n?this.get(t,e):(this.set(t,e,n),void 0!==n?n:e)},remove:function(t,e){var n,i=t[this.expando];if(void 0!==i){if(void 0!==e){n=(e=Array.isArray(e)?e.map(K):(e=K(e))in i?[e]:e.match(B)||[]).length;for(;n--;)delete i[e[n]]}(void 0===e||k.isEmptyObject(i))&&(t.nodeType?t[this.expando]=void 0:delete t[this.expando])}},hasData:function(t){var e=t[this.expando];return void 0!==e&&!k.isEmptyObject(e)}};var Q=new Y,J=new Y,tt=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,et=/[A-Z]/g;function nt(t,e,n){var i;if(void 0===n&&1===t.nodeType)if(i="data-"+e.replace(et,"-$&").toLowerCase(),"string"==typeof(n=t.getAttribute(i))){try{n=function(t){return"true"===t||"false"!==t&&("null"===t?null:t===+t+""?+t:tt.test(t)?JSON.parse(t):t)}(n)}catch(t){}J.set(t,e,n)}else n=void 0;return n}k.extend({hasData:function(t){return J.hasData(t)||Q.hasData(t)},data:function(t,e,n){return J.access(t,e,n)},removeData:function(t,e){J.remove(t,e)},_data:function(t,e,n){return Q.access(t,e,n)},_removeData:function(t,e){Q.remove(t,e)}}),k.fn.extend({data:function(t,e){var n,i,r,o=this[0],s=o&&o.attributes;if(void 0===t){if(this.length&&(r=J.get(o),1===o.nodeType&&!Q.get(o,"hasDataAttrs"))){for(n=s.length;n--;)s[n]&&0===(i=s[n].name).indexOf("data-")&&(i=K(i.slice(5)),nt(o,i,r[i]));Q.set(o,"hasDataAttrs",!0)}return r}return"object"==typeof t?this.each((function(){J.set(this,t)})):$(this,(function(e){var n;if(o&&void 0===e)return void 0!==(n=J.get(o,t))||void 0!==(n=nt(o,t))?n:void 0;this.each((function(){J.set(this,t,e)}))}),null,e,arguments.length>1,null,!0)},removeData:function(t){return this.each((function(){J.remove(this,t)}))}}),k.extend({queue:function(t,e,n){var i;if(t)return e=(e||"fx")+"queue",i=Q.get(t,e),n&&(!i||Array.isArray(n)?i=Q.access(t,e,k.makeArray(n)):i.push(n)),i||[]},dequeue:function(t,e){e=e||"fx";var n=k.queue(t,e),i=n.length,r=n.shift(),o=k._queueHooks(t,e);"inprogress"===r&&(r=n.shift(),i--),r&&("fx"===e&&n.unshift("inprogress"),delete o.stop,r.call(t,(function(){k.dequeue(t,e)}),o)),!i&&o&&o.empty.fire()},_queueHooks:function(t,e){var n=e+"queueHooks";return Q.get(t,n)||Q.access(t,n,{empty:k.Callbacks("once memory").add((function(){Q.remove(t,[e+"queue",n])}))})}}),k.fn.extend({queue:function(t,e){var n=2;return"string"!=typeof t&&(e=t,t="fx",n--),arguments.length<n?k.queue(this[0],t):void 0===e?this:this.each((function(){var n=k.queue(this,t,e);k._queueHooks(this,t),"fx"===t&&"inprogress"!==n[0]&&k.dequeue(this,t)}))},dequeue:function(t){return this.each((function(){k.dequeue(this,t)}))},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){var n,i=1,r=k.Deferred(),o=this,s=this.length,a=function(){--i||r.resolveWith(o,[o])};for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";s--;)(n=Q.get(o[s],t+"queueHooks"))&&n.empty&&(i++,n.empty.add(a));return a(),r.promise(e)}});var it=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,rt=new RegExp("^(?:([+-])=|)("+it+")([a-z%]*)$","i"),ot=["Top","Right","Bottom","Left"],st=b.documentElement,at=function(t){return k.contains(t.ownerDocument,t)},lt={composed:!0};st.getRootNode&&(at=function(t){return k.contains(t.ownerDocument,t)||t.getRootNode(lt)===t.ownerDocument});var ct=function(t,e){return"none"===(t=e||t).style.display||""===t.style.display&&at(t)&&"none"===k.css(t,"display")};function ut(t,e,n,i){var r,o,s=20,a=i?function(){return i.cur()}:function(){return k.css(t,e,"")},l=a(),c=n&&n[3]||(k.cssNumber[e]?"":"px"),u=t.nodeType&&(k.cssNumber[e]||"px"!==c&&+l)&&rt.exec(k.css(t,e));if(u&&u[3]!==c){for(l/=2,c=c||u[3],u=+l||1;s--;)k.style(t,e,u+c),(1-o)*(1-(o=a()/l||.5))<=0&&(s=0),u/=o;u*=2,k.style(t,e,u+c),n=n||[]}return n&&(u=+u||+l||0,r=n[1]?u+(n[1]+1)*n[2]:+n[2],i&&(i.unit=c,i.start=u,i.end=r)),r}var ht={};function dt(t){var e,n=t.ownerDocument,i=t.nodeName,r=ht[i];return r||(e=n.body.appendChild(n.createElement(i)),r=k.css(e,"display"),e.parentNode.removeChild(e),"none"===r&&(r="block"),ht[i]=r,r)}function ft(t,e){for(var n,i,r=[],o=0,s=t.length;o<s;o++)(i=t[o]).style&&(n=i.style.display,e?("none"===n&&(r[o]=Q.get(i,"display")||null,r[o]||(i.style.display="")),""===i.style.display&&ct(i)&&(r[o]=dt(i))):"none"!==n&&(r[o]="none",Q.set(i,"display",n)));for(o=0;o<s;o++)null!=r[o]&&(t[o].style.display=r[o]);return t}k.fn.extend({show:function(){return ft(this,!0)},hide:function(){return ft(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each((function(){ct(this)?k(this).show():k(this).hide()}))}});var pt,gt,mt=/^(?:checkbox|radio)$/i,_t=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,vt=/^$|^module$|\/(?:java|ecma)script/i;pt=b.createDocumentFragment().appendChild(b.createElement("div")),(gt=b.createElement("input")).setAttribute("type","radio"),gt.setAttribute("checked","checked"),gt.setAttribute("name","t"),pt.appendChild(gt),m.checkClone=pt.cloneNode(!0).cloneNode(!0).lastChild.checked,pt.innerHTML="<textarea>x</textarea>",m.noCloneChecked=!!pt.cloneNode(!0).lastChild.defaultValue,pt.innerHTML="<option></option>",m.option=!!pt.lastChild;var bt={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function yt(t,e){var n;return n=void 0!==t.getElementsByTagName?t.getElementsByTagName(e||"*"):void 0!==t.querySelectorAll?t.querySelectorAll(e||"*"):[],void 0===e||e&&D(t,e)?k.merge([t],n):n}function wt(t,e){for(var n=0,i=t.length;n<i;n++)Q.set(t[n],"globalEval",!e||Q.get(e[n],"globalEval"))}bt.tbody=bt.tfoot=bt.colgroup=bt.caption=bt.thead,bt.th=bt.td,m.option||(bt.optgroup=bt.option=[1,"<select multiple='multiple'>","</select>"]);var xt=/<|&#?\w+;/;function Ct(t,e,n,i,r){for(var o,s,a,l,c,u,h=e.createDocumentFragment(),d=[],f=0,p=t.length;f<p;f++)if((o=t[f])||0===o)if("object"===x(o))k.merge(d,o.nodeType?[o]:o);else if(xt.test(o)){for(s=s||h.appendChild(e.createElement("div")),a=(_t.exec(o)||["",""])[1].toLowerCase(),l=bt[a]||bt._default,s.innerHTML=l[1]+k.htmlPrefilter(o)+l[2],u=l[0];u--;)s=s.lastChild;k.merge(d,s.childNodes),(s=h.firstChild).textContent=""}else d.push(e.createTextNode(o));for(h.textContent="",f=0;o=d[f++];)if(i&&k.inArray(o,i)>-1)r&&r.push(o);else if(c=at(o),s=yt(h.appendChild(o),"script"),c&&wt(s),n)for(u=0;o=s[u++];)vt.test(o.type||"")&&n.push(o);return h}var kt=/^([^.]*)(?:\.(.+)|)/;function Et(){return!0}function St(){return!1}function At(t,e){return t===function(){try{return b.activeElement}catch(t){}}()==("focus"===e)}function Tt(t,e,n,i,r,o){var s,a;if("object"==typeof e){for(a in"string"!=typeof n&&(i=i||n,n=void 0),e)Tt(t,a,n,i,e[a],o);return t}if(null==i&&null==r?(r=n,i=n=void 0):null==r&&("string"==typeof n?(r=i,i=void 0):(r=i,i=n,n=void 0)),!1===r)r=St;else if(!r)return t;return 1===o&&(s=r,r=function(t){return k().off(t),s.apply(this,arguments)},r.guid=s.guid||(s.guid=k.guid++)),t.each((function(){k.event.add(this,e,r,i,n)}))}function Mt(t,e,n){n?(Q.set(t,e,!1),k.event.add(t,e,{namespace:!1,handler:function(t){var i,r,o=Q.get(this,e);if(1&t.isTrigger&&this[e]){if(o.length)(k.event.special[e]||{}).delegateType&&t.stopPropagation();else if(o=a.call(arguments),Q.set(this,e,o),i=n(this,e),this[e](),o!==(r=Q.get(this,e))||i?Q.set(this,e,!1):r={},o!==r)return t.stopImmediatePropagation(),t.preventDefault(),r&&r.value}else o.length&&(Q.set(this,e,{value:k.event.trigger(k.extend(o[0],k.Event.prototype),o.slice(1),this)}),t.stopImmediatePropagation())}})):void 0===Q.get(t,e)&&k.event.add(t,e,Et)}k.event={global:{},add:function(t,e,n,i,r){var o,s,a,l,c,u,h,d,f,p,g,m=Q.get(t);if(X(t))for(n.handler&&(n=(o=n).handler,r=o.selector),r&&k.find.matchesSelector(st,r),n.guid||(n.guid=k.guid++),(l=m.events)||(l=m.events=Object.create(null)),(s=m.handle)||(s=m.handle=function(e){return void 0!==k&&k.event.triggered!==e.type?k.event.dispatch.apply(t,arguments):void 0}),c=(e=(e||"").match(B)||[""]).length;c--;)f=g=(a=kt.exec(e[c])||[])[1],p=(a[2]||"").split(".").sort(),f&&(h=k.event.special[f]||{},f=(r?h.delegateType:h.bindType)||f,h=k.event.special[f]||{},u=k.extend({type:f,origType:g,data:i,handler:n,guid:n.guid,selector:r,needsContext:r&&k.expr.match.needsContext.test(r),namespace:p.join(".")},o),(d=l[f])||((d=l[f]=[]).delegateCount=0,h.setup&&!1!==h.setup.call(t,i,p,s)||t.addEventListener&&t.addEventListener(f,s)),h.add&&(h.add.call(t,u),u.handler.guid||(u.handler.guid=n.guid)),r?d.splice(d.delegateCount++,0,u):d.push(u),k.event.global[f]=!0)},remove:function(t,e,n,i,r){var o,s,a,l,c,u,h,d,f,p,g,m=Q.hasData(t)&&Q.get(t);if(m&&(l=m.events)){for(c=(e=(e||"").match(B)||[""]).length;c--;)if(f=g=(a=kt.exec(e[c])||[])[1],p=(a[2]||"").split(".").sort(),f){for(h=k.event.special[f]||{},d=l[f=(i?h.delegateType:h.bindType)||f]||[],a=a[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),s=o=d.length;o--;)u=d[o],!r&&g!==u.origType||n&&n.guid!==u.guid||a&&!a.test(u.namespace)||i&&i!==u.selector&&("**"!==i||!u.selector)||(d.splice(o,1),u.selector&&d.delegateCount--,h.remove&&h.remove.call(t,u));s&&!d.length&&(h.teardown&&!1!==h.teardown.call(t,p,m.handle)||k.removeEvent(t,f,m.handle),delete l[f])}else for(f in l)k.event.remove(t,f+e[c],n,i,!0);k.isEmptyObject(l)&&Q.remove(t,"handle events")}},dispatch:function(t){var e,n,i,r,o,s,a=new Array(arguments.length),l=k.event.fix(t),c=(Q.get(this,"events")||Object.create(null))[l.type]||[],u=k.event.special[l.type]||{};for(a[0]=l,e=1;e<arguments.length;e++)a[e]=arguments[e];if(l.delegateTarget=this,!u.preDispatch||!1!==u.preDispatch.call(this,l)){for(s=k.event.handlers.call(this,l,c),e=0;(r=s[e++])&&!l.isPropagationStopped();)for(l.currentTarget=r.elem,n=0;(o=r.handlers[n++])&&!l.isImmediatePropagationStopped();)l.rnamespace&&!1!==o.namespace&&!l.rnamespace.test(o.namespace)||(l.handleObj=o,l.data=o.data,void 0!==(i=((k.event.special[o.origType]||{}).handle||o.handler).apply(r.elem,a))&&!1===(l.result=i)&&(l.preventDefault(),l.stopPropagation()));return u.postDispatch&&u.postDispatch.call(this,l),l.result}},handlers:function(t,e){var n,i,r,o,s,a=[],l=e.delegateCount,c=t.target;if(l&&c.nodeType&&!("click"===t.type&&t.button>=1))for(;c!==this;c=c.parentNode||this)if(1===c.nodeType&&("click"!==t.type||!0!==c.disabled)){for(o=[],s={},n=0;n<l;n++)void 0===s[r=(i=e[n]).selector+" "]&&(s[r]=i.needsContext?k(r,this).index(c)>-1:k.find(r,this,null,[c]).length),s[r]&&o.push(i);o.length&&a.push({elem:c,handlers:o})}return c=this,l<e.length&&a.push({elem:c,handlers:e.slice(l)}),a},addProp:function(t,e){Object.defineProperty(k.Event.prototype,t,{enumerable:!0,configurable:!0,get:_(e)?function(){if(this.originalEvent)return e(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[t]},set:function(e){Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}})},fix:function(t){return t[k.expando]?t:new k.Event(t)},special:{load:{noBubble:!0},click:{setup:function(t){var e=this||t;return mt.test(e.type)&&e.click&&D(e,"input")&&Mt(e,"click",Et),!1},trigger:function(t){var e=this||t;return mt.test(e.type)&&e.click&&D(e,"input")&&Mt(e,"click"),!0},_default:function(t){var e=t.target;return mt.test(e.type)&&e.click&&D(e,"input")&&Q.get(e,"click")||D(e,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}}},k.removeEvent=function(t,e,n){t.removeEventListener&&t.removeEventListener(e,n)},k.Event=function(t,e){if(!(this instanceof k.Event))return new k.Event(t,e);t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&!1===t.returnValue?Et:St,this.target=t.target&&3===t.target.nodeType?t.target.parentNode:t.target,this.currentTarget=t.currentTarget,this.relatedTarget=t.relatedTarget):this.type=t,e&&k.extend(this,e),this.timeStamp=t&&t.timeStamp||Date.now(),this[k.expando]=!0},k.Event.prototype={constructor:k.Event,isDefaultPrevented:St,isPropagationStopped:St,isImmediatePropagationStopped:St,isSimulated:!1,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=Et,t&&!this.isSimulated&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=Et,t&&!this.isSimulated&&t.stopPropagation()},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=Et,t&&!this.isSimulated&&t.stopImmediatePropagation(),this.stopPropagation()}},k.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},k.event.addProp),k.each({focus:"focusin",blur:"focusout"},(function(t,e){k.event.special[t]={setup:function(){return Mt(this,t,At),!1},trigger:function(){return Mt(this,t),!0},_default:function(e){return Q.get(e.target,t)},delegateType:e}})),k.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},(function(t,e){k.event.special[t]={delegateType:e,bindType:e,handle:function(t){var n,i=this,r=t.relatedTarget,o=t.handleObj;return r&&(r===i||k.contains(i,r))||(t.type=o.origType,n=o.handler.apply(this,arguments),t.type=e),n}}})),k.fn.extend({on:function(t,e,n,i){return Tt(this,t,e,n,i)},one:function(t,e,n,i){return Tt(this,t,e,n,i,1)},off:function(t,e,n){var i,r;if(t&&t.preventDefault&&t.handleObj)return i=t.handleObj,k(t.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==typeof t){for(r in t)this.off(r,e,t[r]);return this}return!1!==e&&"function"!=typeof e||(n=e,e=void 0),!1===n&&(n=St),this.each((function(){k.event.remove(this,t,n,e)}))}});var Dt=/<script|<style|<link/i,Pt=/checked\s*(?:[^=]|=\s*.checked.)/i,Lt=/^\s*<!\[CDATA\[|\]\]>\s*$/g;function Rt(t,e){return D(t,"table")&&D(11!==e.nodeType?e:e.firstChild,"tr")&&k(t).children("tbody")[0]||t}function It(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function Ot(t){return"true/"===(t.type||"").slice(0,5)?t.type=t.type.slice(5):t.removeAttribute("type"),t}function zt(t,e){var n,i,r,o,s,a;if(1===e.nodeType){if(Q.hasData(t)&&(a=Q.get(t).events))for(r in Q.remove(e,"handle events"),a)for(n=0,i=a[r].length;n<i;n++)k.event.add(e,r,a[r][n]);J.hasData(t)&&(o=J.access(t),s=k.extend({},o),J.set(e,s))}}function Ft(t,e){var n=e.nodeName.toLowerCase();"input"===n&&mt.test(t.type)?e.checked=t.checked:"input"!==n&&"textarea"!==n||(e.defaultValue=t.defaultValue)}function Bt(t,e,n,i){e=l(e);var r,o,s,a,c,u,h=0,d=t.length,f=d-1,p=e[0],g=_(p);if(g||d>1&&"string"==typeof p&&!m.checkClone&&Pt.test(p))return t.each((function(r){var o=t.eq(r);g&&(e[0]=p.call(this,r,o.html())),Bt(o,e,n,i)}));if(d&&(o=(r=Ct(e,t[0].ownerDocument,!1,t,i)).firstChild,1===r.childNodes.length&&(r=o),o||i)){for(a=(s=k.map(yt(r,"script"),It)).length;h<d;h++)c=r,h!==f&&(c=k.clone(c,!0,!0),a&&k.merge(s,yt(c,"script"))),n.call(t[h],c,h);if(a)for(u=s[s.length-1].ownerDocument,k.map(s,Ot),h=0;h<a;h++)c=s[h],vt.test(c.type||"")&&!Q.access(c,"globalEval")&&k.contains(u,c)&&(c.src&&"module"!==(c.type||"").toLowerCase()?k._evalUrl&&!c.noModule&&k._evalUrl(c.src,{nonce:c.nonce||c.getAttribute("nonce")},u):w(c.textContent.replace(Lt,""),c,u))}return t}function Nt(t,e,n){for(var i,r=e?k.filter(e,t):t,o=0;null!=(i=r[o]);o++)n||1!==i.nodeType||k.cleanData(yt(i)),i.parentNode&&(n&&at(i)&&wt(yt(i,"script")),i.parentNode.removeChild(i));return t}k.extend({htmlPrefilter:function(t){return t},clone:function(t,e,n){var i,r,o,s,a=t.cloneNode(!0),l=at(t);if(!(m.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||k.isXMLDoc(t)))for(s=yt(a),i=0,r=(o=yt(t)).length;i<r;i++)Ft(o[i],s[i]);if(e)if(n)for(o=o||yt(t),s=s||yt(a),i=0,r=o.length;i<r;i++)zt(o[i],s[i]);else zt(t,a);return(s=yt(a,"script")).length>0&&wt(s,!l&&yt(t,"script")),a},cleanData:function(t){for(var e,n,i,r=k.event.special,o=0;void 0!==(n=t[o]);o++)if(X(n)){if(e=n[Q.expando]){if(e.events)for(i in e.events)r[i]?k.event.remove(n,i):k.removeEvent(n,i,e.handle);n[Q.expando]=void 0}n[J.expando]&&(n[J.expando]=void 0)}}}),k.fn.extend({detach:function(t){return Nt(this,t,!0)},remove:function(t){return Nt(this,t)},text:function(t){return $(this,(function(t){return void 0===t?k.text(this):this.empty().each((function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=t)}))}),null,t,arguments.length)},append:function(){return Bt(this,arguments,(function(t){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||Rt(this,t).appendChild(t)}))},prepend:function(){return Bt(this,arguments,(function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=Rt(this,t);e.insertBefore(t,e.firstChild)}}))},before:function(){return Bt(this,arguments,(function(t){this.parentNode&&this.parentNode.insertBefore(t,this)}))},after:function(){return Bt(this,arguments,(function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)}))},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)1===t.nodeType&&(k.cleanData(yt(t,!1)),t.textContent="");return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map((function(){return k.clone(this,t,e)}))},html:function(t){return $(this,(function(t){var e=this[0]||{},n=0,i=this.length;if(void 0===t&&1===e.nodeType)return e.innerHTML;if("string"==typeof t&&!Dt.test(t)&&!bt[(_t.exec(t)||["",""])[1].toLowerCase()]){t=k.htmlPrefilter(t);try{for(;n<i;n++)1===(e=this[n]||{}).nodeType&&(k.cleanData(yt(e,!1)),e.innerHTML=t);e=0}catch(t){}}e&&this.empty().append(t)}),null,t,arguments.length)},replaceWith:function(){var t=[];return Bt(this,arguments,(function(e){var n=this.parentNode;k.inArray(this,t)<0&&(k.cleanData(yt(this)),n&&n.replaceChild(e,this))}),t)}}),k.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},(function(t,e){k.fn[t]=function(t){for(var n,i=[],r=k(t),o=r.length-1,s=0;s<=o;s++)n=s===o?this:this.clone(!0),k(r[s])[e](n),c.apply(i,n.get());return this.pushStack(i)}}));var jt=new RegExp("^("+it+")(?!px)[a-z%]+$","i"),Ut=/^--/,Vt=function(t){var e=t.ownerDocument.defaultView;return e&&e.opener||(e=i),e.getComputedStyle(t)},Wt=function(t,e,n){var i,r,o={};for(r in e)o[r]=t.style[r],t.style[r]=e[r];for(r in i=n.call(t),e)t.style[r]=o[r];return i},Ht=new RegExp(ot.join("|"),"i"),$t=new RegExp("^[\\x20\\t\\r\\n\\f]+|((?:^|[^\\\\])(?:\\\\.)*)[\\x20\\t\\r\\n\\f]+$","g");function Zt(t,e,n){var i,r,o,s,a=Ut.test(e),l=t.style;return(n=n||Vt(t))&&(s=n.getPropertyValue(e)||n[e],a&&(s=s.replace($t,"$1")),""!==s||at(t)||(s=k.style(t,e)),!m.pixelBoxStyles()&&jt.test(s)&&Ht.test(e)&&(i=l.width,r=l.minWidth,o=l.maxWidth,l.minWidth=l.maxWidth=l.width=s,s=n.width,l.width=i,l.minWidth=r,l.maxWidth=o)),void 0!==s?s+"":s}function qt(t,e){return{get:function(){if(!t())return(this.get=e).apply(this,arguments);delete this.get}}}!function(){function t(){if(u){c.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",u.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",st.appendChild(c).appendChild(u);var t=i.getComputedStyle(u);n="1%"!==t.top,l=12===e(t.marginLeft),u.style.right="60%",s=36===e(t.right),r=36===e(t.width),u.style.position="absolute",o=12===e(u.offsetWidth/3),st.removeChild(c),u=null}}function e(t){return Math.round(parseFloat(t))}var n,r,o,s,a,l,c=b.createElement("div"),u=b.createElement("div");u.style&&(u.style.backgroundClip="content-box",u.cloneNode(!0).style.backgroundClip="",m.clearCloneStyle="content-box"===u.style.backgroundClip,k.extend(m,{boxSizingReliable:function(){return t(),r},pixelBoxStyles:function(){return t(),s},pixelPosition:function(){return t(),n},reliableMarginLeft:function(){return t(),l},scrollboxSize:function(){return t(),o},reliableTrDimensions:function(){var t,e,n,r;return null==a&&(t=b.createElement("table"),e=b.createElement("tr"),n=b.createElement("div"),t.style.cssText="position:absolute;left:-11111px;border-collapse:separate",e.style.cssText="border:1px solid",e.style.height="1px",n.style.height="9px",n.style.display="block",st.appendChild(t).appendChild(e).appendChild(n),r=i.getComputedStyle(e),a=parseInt(r.height,10)+parseInt(r.borderTopWidth,10)+parseInt(r.borderBottomWidth,10)===e.offsetHeight,st.removeChild(t)),a}}))}();var Gt=["Webkit","Moz","ms"],Kt=b.createElement("div").style,Xt={};function Yt(t){return k.cssProps[t]||Xt[t]||(t in Kt?t:Xt[t]=function(t){for(var e=t[0].toUpperCase()+t.slice(1),n=Gt.length;n--;)if((t=Gt[n]+e)in Kt)return t}(t)||t)}var Qt=/^(none|table(?!-c[ea]).+)/,Jt={position:"absolute",visibility:"hidden",display:"block"},te={letterSpacing:"0",fontWeight:"400"};function ee(t,e,n){var i=rt.exec(e);return i?Math.max(0,i[2]-(n||0))+(i[3]||"px"):e}function ne(t,e,n,i,r,o){var s="width"===e?1:0,a=0,l=0;if(n===(i?"border":"content"))return 0;for(;s<4;s+=2)"margin"===n&&(l+=k.css(t,n+ot[s],!0,r)),i?("content"===n&&(l-=k.css(t,"padding"+ot[s],!0,r)),"margin"!==n&&(l-=k.css(t,"border"+ot[s]+"Width",!0,r))):(l+=k.css(t,"padding"+ot[s],!0,r),"padding"!==n?l+=k.css(t,"border"+ot[s]+"Width",!0,r):a+=k.css(t,"border"+ot[s]+"Width",!0,r));return!i&&o>=0&&(l+=Math.max(0,Math.ceil(t["offset"+e[0].toUpperCase()+e.slice(1)]-o-l-a-.5))||0),l}function ie(t,e,n){var i=Vt(t),r=(!m.boxSizingReliable()||n)&&"border-box"===k.css(t,"boxSizing",!1,i),o=r,s=Zt(t,e,i),a="offset"+e[0].toUpperCase()+e.slice(1);if(jt.test(s)){if(!n)return s;s="auto"}return(!m.boxSizingReliable()&&r||!m.reliableTrDimensions()&&D(t,"tr")||"auto"===s||!parseFloat(s)&&"inline"===k.css(t,"display",!1,i))&&t.getClientRects().length&&(r="border-box"===k.css(t,"boxSizing",!1,i),(o=a in t)&&(s=t[a])),(s=parseFloat(s)||0)+ne(t,e,n||(r?"border":"content"),o,i,s)+"px"}function re(t,e,n,i,r){return new re.prototype.init(t,e,n,i,r)}k.extend({cssHooks:{opacity:{get:function(t,e){if(e){var n=Zt(t,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(t,e,n,i){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var r,o,s,a=K(e),l=Ut.test(e),c=t.style;if(l||(e=Yt(a)),s=k.cssHooks[e]||k.cssHooks[a],void 0===n)return s&&"get"in s&&void 0!==(r=s.get(t,!1,i))?r:c[e];"string"==(o=typeof n)&&(r=rt.exec(n))&&r[1]&&(n=ut(t,e,r),o="number"),null!=n&&n==n&&("number"!==o||l||(n+=r&&r[3]||(k.cssNumber[a]?"":"px")),m.clearCloneStyle||""!==n||0!==e.indexOf("background")||(c[e]="inherit"),s&&"set"in s&&void 0===(n=s.set(t,n,i))||(l?c.setProperty(e,n):c[e]=n))}},css:function(t,e,n,i){var r,o,s,a=K(e);return Ut.test(e)||(e=Yt(a)),(s=k.cssHooks[e]||k.cssHooks[a])&&"get"in s&&(r=s.get(t,!0,n)),void 0===r&&(r=Zt(t,e,i)),"normal"===r&&e in te&&(r=te[e]),""===n||n?(o=parseFloat(r),!0===n||isFinite(o)?o||0:r):r}}),k.each(["height","width"],(function(t,e){k.cssHooks[e]={get:function(t,n,i){if(n)return!Qt.test(k.css(t,"display"))||t.getClientRects().length&&t.getBoundingClientRect().width?ie(t,e,i):Wt(t,Jt,(function(){return ie(t,e,i)}))},set:function(t,n,i){var r,o=Vt(t),s=!m.scrollboxSize()&&"absolute"===o.position,a=(s||i)&&"border-box"===k.css(t,"boxSizing",!1,o),l=i?ne(t,e,i,a,o):0;return a&&s&&(l-=Math.ceil(t["offset"+e[0].toUpperCase()+e.slice(1)]-parseFloat(o[e])-ne(t,e,"border",!1,o)-.5)),l&&(r=rt.exec(n))&&"px"!==(r[3]||"px")&&(t.style[e]=n,n=k.css(t,e)),ee(0,n,l)}}})),k.cssHooks.marginLeft=qt(m.reliableMarginLeft,(function(t,e){if(e)return(parseFloat(Zt(t,"marginLeft"))||t.getBoundingClientRect().left-Wt(t,{marginLeft:0},(function(){return t.getBoundingClientRect().left})))+"px"})),k.each({margin:"",padding:"",border:"Width"},(function(t,e){k.cssHooks[t+e]={expand:function(n){for(var i=0,r={},o="string"==typeof n?n.split(" "):[n];i<4;i++)r[t+ot[i]+e]=o[i]||o[i-2]||o[0];return r}},"margin"!==t&&(k.cssHooks[t+e].set=ee)})),k.fn.extend({css:function(t,e){return $(this,(function(t,e,n){var i,r,o={},s=0;if(Array.isArray(e)){for(i=Vt(t),r=e.length;s<r;s++)o[e[s]]=k.css(t,e[s],!1,i);return o}return void 0!==n?k.style(t,e,n):k.css(t,e)}),t,e,arguments.length>1)}}),k.Tween=re,re.prototype={constructor:re,init:function(t,e,n,i,r,o){this.elem=t,this.prop=n,this.easing=r||k.easing._default,this.options=e,this.start=this.now=this.cur(),this.end=i,this.unit=o||(k.cssNumber[n]?"":"px")},cur:function(){var t=re.propHooks[this.prop];return t&&t.get?t.get(this):re.propHooks._default.get(this)},run:function(t){var e,n=re.propHooks[this.prop];return this.options.duration?this.pos=e=k.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):this.pos=e=t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):re.propHooks._default.set(this),this}},re.prototype.init.prototype=re.prototype,re.propHooks={_default:{get:function(t){var e;return 1!==t.elem.nodeType||null!=t.elem[t.prop]&&null==t.elem.style[t.prop]?t.elem[t.prop]:(e=k.css(t.elem,t.prop,""))&&"auto"!==e?e:0},set:function(t){k.fx.step[t.prop]?k.fx.step[t.prop](t):1!==t.elem.nodeType||!k.cssHooks[t.prop]&&null==t.elem.style[Yt(t.prop)]?t.elem[t.prop]=t.now:k.style(t.elem,t.prop,t.now+t.unit)}}},re.propHooks.scrollTop=re.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},k.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2},_default:"swing"},k.fx=re.prototype.init,k.fx.step={};var oe,se,ae=/^(?:toggle|show|hide)$/,le=/queueHooks$/;function ce(){se&&(!1===b.hidden&&i.requestAnimationFrame?i.requestAnimationFrame(ce):i.setTimeout(ce,k.fx.interval),k.fx.tick())}function ue(){return i.setTimeout((function(){oe=void 0})),oe=Date.now()}function he(t,e){var n,i=0,r={height:t};for(e=e?1:0;i<4;i+=2-e)r["margin"+(n=ot[i])]=r["padding"+n]=t;return e&&(r.opacity=r.width=t),r}function de(t,e,n){for(var i,r=(fe.tweeners[e]||[]).concat(fe.tweeners["*"]),o=0,s=r.length;o<s;o++)if(i=r[o].call(n,e,t))return i}function fe(t,e,n){var i,r,o=0,s=fe.prefilters.length,a=k.Deferred().always((function(){delete l.elem})),l=function(){if(r)return!1;for(var e=oe||ue(),n=Math.max(0,c.startTime+c.duration-e),i=1-(n/c.duration||0),o=0,s=c.tweens.length;o<s;o++)c.tweens[o].run(i);return a.notifyWith(t,[c,i,n]),i<1&&s?n:(s||a.notifyWith(t,[c,1,0]),a.resolveWith(t,[c]),!1)},c=a.promise({elem:t,props:k.extend({},e),opts:k.extend(!0,{specialEasing:{},easing:k.easing._default},n),originalProperties:e,originalOptions:n,startTime:oe||ue(),duration:n.duration,tweens:[],createTween:function(e,n){var i=k.Tween(t,c.opts,e,n,c.opts.specialEasing[e]||c.opts.easing);return c.tweens.push(i),i},stop:function(e){var n=0,i=e?c.tweens.length:0;if(r)return this;for(r=!0;n<i;n++)c.tweens[n].run(1);return e?(a.notifyWith(t,[c,1,0]),a.resolveWith(t,[c,e])):a.rejectWith(t,[c,e]),this}}),u=c.props;for(function(t,e){var n,i,r,o,s;for(n in t)if(r=e[i=K(n)],o=t[n],Array.isArray(o)&&(r=o[1],o=t[n]=o[0]),n!==i&&(t[i]=o,delete t[n]),(s=k.cssHooks[i])&&"expand"in s)for(n in o=s.expand(o),delete t[i],o)n in t||(t[n]=o[n],e[n]=r);else e[i]=r}(u,c.opts.specialEasing);o<s;o++)if(i=fe.prefilters[o].call(c,t,u,c.opts))return _(i.stop)&&(k._queueHooks(c.elem,c.opts.queue).stop=i.stop.bind(i)),i;return k.map(u,de,c),_(c.opts.start)&&c.opts.start.call(t,c),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always),k.fx.timer(k.extend(l,{elem:t,anim:c,queue:c.opts.queue})),c}k.Animation=k.extend(fe,{tweeners:{"*":[function(t,e){var n=this.createTween(t,e);return ut(n.elem,t,rt.exec(e),n),n}]},tweener:function(t,e){_(t)?(e=t,t=["*"]):t=t.match(B);for(var n,i=0,r=t.length;i<r;i++)n=t[i],fe.tweeners[n]=fe.tweeners[n]||[],fe.tweeners[n].unshift(e)},prefilters:[function(t,e,n){var i,r,o,s,a,l,c,u,h="width"in e||"height"in e,d=this,f={},p=t.style,g=t.nodeType&&ct(t),m=Q.get(t,"fxshow");for(i in n.queue||(null==(s=k._queueHooks(t,"fx")).unqueued&&(s.unqueued=0,a=s.empty.fire,s.empty.fire=function(){s.unqueued||a()}),s.unqueued++,d.always((function(){d.always((function(){s.unqueued--,k.queue(t,"fx").length||s.empty.fire()}))}))),e)if(r=e[i],ae.test(r)){if(delete e[i],o=o||"toggle"===r,r===(g?"hide":"show")){if("show"!==r||!m||void 0===m[i])continue;g=!0}f[i]=m&&m[i]||k.style(t,i)}if((l=!k.isEmptyObject(e))||!k.isEmptyObject(f))for(i in h&&1===t.nodeType&&(n.overflow=[p.overflow,p.overflowX,p.overflowY],null==(c=m&&m.display)&&(c=Q.get(t,"display")),"none"===(u=k.css(t,"display"))&&(c?u=c:(ft([t],!0),c=t.style.display||c,u=k.css(t,"display"),ft([t]))),("inline"===u||"inline-block"===u&&null!=c)&&"none"===k.css(t,"float")&&(l||(d.done((function(){p.display=c})),null==c&&(u=p.display,c="none"===u?"":u)),p.display="inline-block")),n.overflow&&(p.overflow="hidden",d.always((function(){p.overflow=n.overflow[0],p.overflowX=n.overflow[1],p.overflowY=n.overflow[2]}))),l=!1,f)l||(m?"hidden"in m&&(g=m.hidden):m=Q.access(t,"fxshow",{display:c}),o&&(m.hidden=!g),g&&ft([t],!0),d.done((function(){for(i in g||ft([t]),Q.remove(t,"fxshow"),f)k.style(t,i,f[i])}))),l=de(g?m[i]:0,i,d),i in m||(m[i]=l.start,g&&(l.end=l.start,l.start=0))}],prefilter:function(t,e){e?fe.prefilters.unshift(t):fe.prefilters.push(t)}}),k.speed=function(t,e,n){var i=t&&"object"==typeof t?k.extend({},t):{complete:n||!n&&e||_(t)&&t,duration:t,easing:n&&e||e&&!_(e)&&e};return k.fx.off?i.duration=0:"number"!=typeof i.duration&&(i.duration in k.fx.speeds?i.duration=k.fx.speeds[i.duration]:i.duration=k.fx.speeds._default),null!=i.queue&&!0!==i.queue||(i.queue="fx"),i.old=i.complete,i.complete=function(){_(i.old)&&i.old.call(this),i.queue&&k.dequeue(this,i.queue)},i},k.fn.extend({fadeTo:function(t,e,n,i){return this.filter(ct).css("opacity",0).show().end().animate({opacity:e},t,n,i)},animate:function(t,e,n,i){var r=k.isEmptyObject(t),o=k.speed(e,n,i),s=function(){var e=fe(this,k.extend({},t),o);(r||Q.get(this,"finish"))&&e.stop(!0)};return s.finish=s,r||!1===o.queue?this.each(s):this.queue(o.queue,s)},stop:function(t,e,n){var i=function(t){var e=t.stop;delete t.stop,e(n)};return"string"!=typeof t&&(n=e,e=t,t=void 0),e&&this.queue(t||"fx",[]),this.each((function(){var e=!0,r=null!=t&&t+"queueHooks",o=k.timers,s=Q.get(this);if(r)s[r]&&s[r].stop&&i(s[r]);else for(r in s)s[r]&&s[r].stop&&le.test(r)&&i(s[r]);for(r=o.length;r--;)o[r].elem!==this||null!=t&&o[r].queue!==t||(o[r].anim.stop(n),e=!1,o.splice(r,1));!e&&n||k.dequeue(this,t)}))},finish:function(t){return!1!==t&&(t=t||"fx"),this.each((function(){var e,n=Q.get(this),i=n[t+"queue"],r=n[t+"queueHooks"],o=k.timers,s=i?i.length:0;for(n.finish=!0,k.queue(this,t,[]),r&&r.stop&&r.stop.call(this,!0),e=o.length;e--;)o[e].elem===this&&o[e].queue===t&&(o[e].anim.stop(!0),o.splice(e,1));for(e=0;e<s;e++)i[e]&&i[e].finish&&i[e].finish.call(this);delete n.finish}))}}),k.each(["toggle","show","hide"],(function(t,e){var n=k.fn[e];k.fn[e]=function(t,i,r){return null==t||"boolean"==typeof t?n.apply(this,arguments):this.animate(he(e,!0),t,i,r)}})),k.each({slideDown:he("show"),slideUp:he("hide"),slideToggle:he("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},(function(t,e){k.fn[t]=function(t,n,i){return this.animate(e,t,n,i)}})),k.timers=[],k.fx.tick=function(){var t,e=0,n=k.timers;for(oe=Date.now();e<n.length;e++)(t=n[e])()||n[e]!==t||n.splice(e--,1);n.length||k.fx.stop(),oe=void 0},k.fx.timer=function(t){k.timers.push(t),k.fx.start()},k.fx.interval=13,k.fx.start=function(){se||(se=!0,ce())},k.fx.stop=function(){se=null},k.fx.speeds={slow:600,fast:200,_default:400},k.fn.delay=function(t,e){return t=k.fx&&k.fx.speeds[t]||t,e=e||"fx",this.queue(e,(function(e,n){var r=i.setTimeout(e,t);n.stop=function(){i.clearTimeout(r)}}))},function(){var t=b.createElement("input"),e=b.createElement("select").appendChild(b.createElement("option"));t.type="checkbox",m.checkOn=""!==t.value,m.optSelected=e.selected,(t=b.createElement("input")).value="t",t.type="radio",m.radioValue="t"===t.value}();var pe,ge=k.expr.attrHandle;k.fn.extend({attr:function(t,e){return $(this,k.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each((function(){k.removeAttr(this,t)}))}}),k.extend({attr:function(t,e,n){var i,r,o=t.nodeType;if(3!==o&&8!==o&&2!==o)return void 0===t.getAttribute?k.prop(t,e,n):(1===o&&k.isXMLDoc(t)||(r=k.attrHooks[e.toLowerCase()]||(k.expr.match.bool.test(e)?pe:void 0)),void 0!==n?null===n?void k.removeAttr(t,e):r&&"set"in r&&void 0!==(i=r.set(t,n,e))?i:(t.setAttribute(e,n+""),n):r&&"get"in r&&null!==(i=r.get(t,e))?i:null==(i=k.find.attr(t,e))?void 0:i)},attrHooks:{type:{set:function(t,e){if(!m.radioValue&&"radio"===e&&D(t,"input")){var n=t.value;return t.setAttribute("type",e),n&&(t.value=n),e}}}},removeAttr:function(t,e){var n,i=0,r=e&&e.match(B);if(r&&1===t.nodeType)for(;n=r[i++];)t.removeAttribute(n)}}),pe={set:function(t,e,n){return!1===e?k.removeAttr(t,n):t.setAttribute(n,n),n}},k.each(k.expr.match.bool.source.match(/\w+/g),(function(t,e){var n=ge[e]||k.find.attr;ge[e]=function(t,e,i){var r,o,s=e.toLowerCase();return i||(o=ge[s],ge[s]=r,r=null!=n(t,e,i)?s:null,ge[s]=o),r}}));var me=/^(?:input|select|textarea|button)$/i,_e=/^(?:a|area)$/i;function ve(t){return(t.match(B)||[]).join(" ")}function be(t){return t.getAttribute&&t.getAttribute("class")||""}function ye(t){return Array.isArray(t)?t:"string"==typeof t&&t.match(B)||[]}k.fn.extend({prop:function(t,e){return $(this,k.prop,t,e,arguments.length>1)},removeProp:function(t){return this.each((function(){delete this[k.propFix[t]||t]}))}}),k.extend({prop:function(t,e,n){var i,r,o=t.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&k.isXMLDoc(t)||(e=k.propFix[e]||e,r=k.propHooks[e]),void 0!==n?r&&"set"in r&&void 0!==(i=r.set(t,n,e))?i:t[e]=n:r&&"get"in r&&null!==(i=r.get(t,e))?i:t[e]},propHooks:{tabIndex:{get:function(t){var e=k.find.attr(t,"tabindex");return e?parseInt(e,10):me.test(t.nodeName)||_e.test(t.nodeName)&&t.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),m.optSelected||(k.propHooks.selected={get:function(t){var e=t.parentNode;return e&&e.parentNode&&e.parentNode.selectedIndex,null},set:function(t){var e=t.parentNode;e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex)}}),k.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],(function(){k.propFix[this.toLowerCase()]=this})),k.fn.extend({addClass:function(t){var e,n,i,r,o,s;return _(t)?this.each((function(e){k(this).addClass(t.call(this,e,be(this)))})):(e=ye(t)).length?this.each((function(){if(i=be(this),n=1===this.nodeType&&" "+ve(i)+" "){for(o=0;o<e.length;o++)r=e[o],n.indexOf(" "+r+" ")<0&&(n+=r+" ");s=ve(n),i!==s&&this.setAttribute("class",s)}})):this},removeClass:function(t){var e,n,i,r,o,s;return _(t)?this.each((function(e){k(this).removeClass(t.call(this,e,be(this)))})):arguments.length?(e=ye(t)).length?this.each((function(){if(i=be(this),n=1===this.nodeType&&" "+ve(i)+" "){for(o=0;o<e.length;o++)for(r=e[o];n.indexOf(" "+r+" ")>-1;)n=n.replace(" "+r+" "," ");s=ve(n),i!==s&&this.setAttribute("class",s)}})):this:this.attr("class","")},toggleClass:function(t,e){var n,i,r,o,s=typeof t,a="string"===s||Array.isArray(t);return _(t)?this.each((function(n){k(this).toggleClass(t.call(this,n,be(this),e),e)})):"boolean"==typeof e&&a?e?this.addClass(t):this.removeClass(t):(n=ye(t),this.each((function(){if(a)for(o=k(this),r=0;r<n.length;r++)i=n[r],o.hasClass(i)?o.removeClass(i):o.addClass(i);else void 0!==t&&"boolean"!==s||((i=be(this))&&Q.set(this,"__className__",i),this.setAttribute&&this.setAttribute("class",i||!1===t?"":Q.get(this,"__className__")||""))})))},hasClass:function(t){var e,n,i=0;for(e=" "+t+" ";n=this[i++];)if(1===n.nodeType&&(" "+ve(be(n))+" ").indexOf(e)>-1)return!0;return!1}});var we=/\r/g;k.fn.extend({val:function(t){var e,n,i,r=this[0];return arguments.length?(i=_(t),this.each((function(n){var r;1===this.nodeType&&(null==(r=i?t.call(this,n,k(this).val()):t)?r="":"number"==typeof r?r+="":Array.isArray(r)&&(r=k.map(r,(function(t){return null==t?"":t+""}))),(e=k.valHooks[this.type]||k.valHooks[this.nodeName.toLowerCase()])&&"set"in e&&void 0!==e.set(this,r,"value")||(this.value=r))}))):r?(e=k.valHooks[r.type]||k.valHooks[r.nodeName.toLowerCase()])&&"get"in e&&void 0!==(n=e.get(r,"value"))?n:"string"==typeof(n=r.value)?n.replace(we,""):null==n?"":n:void 0}}),k.extend({valHooks:{option:{get:function(t){var e=k.find.attr(t,"value");return null!=e?e:ve(k.text(t))}},select:{get:function(t){var e,n,i,r=t.options,o=t.selectedIndex,s="select-one"===t.type,a=s?null:[],l=s?o+1:r.length;for(i=o<0?l:s?o:0;i<l;i++)if(((n=r[i]).selected||i===o)&&!n.disabled&&(!n.parentNode.disabled||!D(n.parentNode,"optgroup"))){if(e=k(n).val(),s)return e;a.push(e)}return a},set:function(t,e){for(var n,i,r=t.options,o=k.makeArray(e),s=r.length;s--;)((i=r[s]).selected=k.inArray(k.valHooks.option.get(i),o)>-1)&&(n=!0);return n||(t.selectedIndex=-1),o}}}}),k.each(["radio","checkbox"],(function(){k.valHooks[this]={set:function(t,e){if(Array.isArray(e))return t.checked=k.inArray(k(t).val(),e)>-1}},m.checkOn||(k.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})})),m.focusin="onfocusin"in i;var xe=/^(?:focusinfocus|focusoutblur)$/,Ce=function(t){t.stopPropagation()};k.extend(k.event,{trigger:function(t,e,n,r){var o,s,a,l,c,u,h,d,p=[n||b],g=f.call(t,"type")?t.type:t,m=f.call(t,"namespace")?t.namespace.split("."):[];if(s=d=a=n=n||b,3!==n.nodeType&&8!==n.nodeType&&!xe.test(g+k.event.triggered)&&(g.indexOf(".")>-1&&(m=g.split("."),g=m.shift(),m.sort()),c=g.indexOf(":")<0&&"on"+g,(t=t[k.expando]?t:new k.Event(g,"object"==typeof t&&t)).isTrigger=r?2:3,t.namespace=m.join("."),t.rnamespace=t.namespace?new RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=n),e=null==e?[t]:k.makeArray(e,[t]),h=k.event.special[g]||{},r||!h.trigger||!1!==h.trigger.apply(n,e))){if(!r&&!h.noBubble&&!v(n)){for(l=h.delegateType||g,xe.test(l+g)||(s=s.parentNode);s;s=s.parentNode)p.push(s),a=s;a===(n.ownerDocument||b)&&p.push(a.defaultView||a.parentWindow||i)}for(o=0;(s=p[o++])&&!t.isPropagationStopped();)d=s,t.type=o>1?l:h.bindType||g,(u=(Q.get(s,"events")||Object.create(null))[t.type]&&Q.get(s,"handle"))&&u.apply(s,e),(u=c&&s[c])&&u.apply&&X(s)&&(t.result=u.apply(s,e),!1===t.result&&t.preventDefault());return t.type=g,r||t.isDefaultPrevented()||h._default&&!1!==h._default.apply(p.pop(),e)||!X(n)||c&&_(n[g])&&!v(n)&&((a=n[c])&&(n[c]=null),k.event.triggered=g,t.isPropagationStopped()&&d.addEventListener(g,Ce),n[g](),t.isPropagationStopped()&&d.removeEventListener(g,Ce),k.event.triggered=void 0,a&&(n[c]=a)),t.result}},simulate:function(t,e,n){var i=k.extend(new k.Event,n,{type:t,isSimulated:!0});k.event.trigger(i,null,e)}}),k.fn.extend({trigger:function(t,e){return this.each((function(){k.event.trigger(t,e,this)}))},triggerHandler:function(t,e){var n=this[0];if(n)return k.event.trigger(t,e,n,!0)}}),m.focusin||k.each({focus:"focusin",blur:"focusout"},(function(t,e){var n=function(t){k.event.simulate(e,t.target,k.event.fix(t))};k.event.special[e]={setup:function(){var i=this.ownerDocument||this.document||this,r=Q.access(i,e);r||i.addEventListener(t,n,!0),Q.access(i,e,(r||0)+1)},teardown:function(){var i=this.ownerDocument||this.document||this,r=Q.access(i,e)-1;r?Q.access(i,e,r):(i.removeEventListener(t,n,!0),Q.remove(i,e))}}}));var ke=i.location,Ee={guid:Date.now()},Se=/\?/;k.parseXML=function(t){var e,n;if(!t||"string"!=typeof t)return null;try{e=(new i.DOMParser).parseFromString(t,"text/xml")}catch(t){}return n=e&&e.getElementsByTagName("parsererror")[0],e&&!n||k.error("Invalid XML: "+(n?k.map(n.childNodes,(function(t){return t.textContent})).join("\n"):t)),e};var Ae=/\[\]$/,Te=/\r?\n/g,Me=/^(?:submit|button|image|reset|file)$/i,De=/^(?:input|select|textarea|keygen)/i;function Pe(t,e,n,i){var r;if(Array.isArray(e))k.each(e,(function(e,r){n||Ae.test(t)?i(t,r):Pe(t+"["+("object"==typeof r&&null!=r?e:"")+"]",r,n,i)}));else if(n||"object"!==x(e))i(t,e);else for(r in e)Pe(t+"["+r+"]",e[r],n,i)}k.param=function(t,e){var n,i=[],r=function(t,e){var n=_(e)?e():e;i[i.length]=encodeURIComponent(t)+"="+encodeURIComponent(null==n?"":n)};if(null==t)return"";if(Array.isArray(t)||t.jquery&&!k.isPlainObject(t))k.each(t,(function(){r(this.name,this.value)}));else for(n in t)Pe(n,t[n],e,r);return i.join("&")},k.fn.extend({serialize:function(){return k.param(this.serializeArray())},serializeArray:function(){return this.map((function(){var t=k.prop(this,"elements");return t?k.makeArray(t):this})).filter((function(){var t=this.type;return this.name&&!k(this).is(":disabled")&&De.test(this.nodeName)&&!Me.test(t)&&(this.checked||!mt.test(t))})).map((function(t,e){var n=k(this).val();return null==n?null:Array.isArray(n)?k.map(n,(function(t){return{name:e.name,value:t.replace(Te,"\r\n")}})):{name:e.name,value:n.replace(Te,"\r\n")}})).get()}});var Le=/%20/g,Re=/#.*$/,Ie=/([?&])_=[^&]*/,Oe=/^(.*?):[ \t]*([^\r\n]*)$/gm,ze=/^(?:GET|HEAD)$/,Fe=/^\/\//,Be={},Ne={},je="*/".concat("*"),Ue=b.createElement("a");function Ve(t){return function(e,n){"string"!=typeof e&&(n=e,e="*");var i,r=0,o=e.toLowerCase().match(B)||[];if(_(n))for(;i=o[r++];)"+"===i[0]?(i=i.slice(1)||"*",(t[i]=t[i]||[]).unshift(n)):(t[i]=t[i]||[]).push(n)}}function We(t,e,n,i){var r={},o=t===Ne;function s(a){var l;return r[a]=!0,k.each(t[a]||[],(function(t,a){var c=a(e,n,i);return"string"!=typeof c||o||r[c]?o?!(l=c):void 0:(e.dataTypes.unshift(c),s(c),!1)})),l}return s(e.dataTypes[0])||!r["*"]&&s("*")}function He(t,e){var n,i,r=k.ajaxSettings.flatOptions||{};for(n in e)void 0!==e[n]&&((r[n]?t:i||(i={}))[n]=e[n]);return i&&k.extend(!0,t,i),t}Ue.href=ke.href,k.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:ke.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(ke.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":je,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":k.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?He(He(t,k.ajaxSettings),e):He(k.ajaxSettings,t)},ajaxPrefilter:Ve(Be),ajaxTransport:Ve(Ne),ajax:function(t,e){"object"==typeof t&&(e=t,t=void 0),e=e||{};var n,r,o,s,a,l,c,u,h,d,f=k.ajaxSetup({},e),p=f.context||f,g=f.context&&(p.nodeType||p.jquery)?k(p):k.event,m=k.Deferred(),_=k.Callbacks("once memory"),v=f.statusCode||{},y={},w={},x="canceled",C={readyState:0,getResponseHeader:function(t){var e;if(c){if(!s)for(s={};e=Oe.exec(o);)s[e[1].toLowerCase()+" "]=(s[e[1].toLowerCase()+" "]||[]).concat(e[2]);e=s[t.toLowerCase()+" "]}return null==e?null:e.join(", ")},getAllResponseHeaders:function(){return c?o:null},setRequestHeader:function(t,e){return null==c&&(t=w[t.toLowerCase()]=w[t.toLowerCase()]||t,y[t]=e),this},overrideMimeType:function(t){return null==c&&(f.mimeType=t),this},statusCode:function(t){var e;if(t)if(c)C.always(t[C.status]);else for(e in t)v[e]=[v[e],t[e]];return this},abort:function(t){var e=t||x;return n&&n.abort(e),E(0,e),this}};if(m.promise(C),f.url=((t||f.url||ke.href)+"").replace(Fe,ke.protocol+"//"),f.type=e.method||e.type||f.method||f.type,f.dataTypes=(f.dataType||"*").toLowerCase().match(B)||[""],null==f.crossDomain){l=b.createElement("a");try{l.href=f.url,l.href=l.href,f.crossDomain=Ue.protocol+"//"+Ue.host!=l.protocol+"//"+l.host}catch(t){f.crossDomain=!0}}if(f.data&&f.processData&&"string"!=typeof f.data&&(f.data=k.param(f.data,f.traditional)),We(Be,f,e,C),c)return C;for(h in(u=k.event&&f.global)&&0==k.active++&&k.event.trigger("ajaxStart"),f.type=f.type.toUpperCase(),f.hasContent=!ze.test(f.type),r=f.url.replace(Re,""),f.hasContent?f.data&&f.processData&&0===(f.contentType||"").indexOf("application/x-www-form-urlencoded")&&(f.data=f.data.replace(Le,"+")):(d=f.url.slice(r.length),f.data&&(f.processData||"string"==typeof f.data)&&(r+=(Se.test(r)?"&":"?")+f.data,delete f.data),!1===f.cache&&(r=r.replace(Ie,"$1"),d=(Se.test(r)?"&":"?")+"_="+Ee.guid+++d),f.url=r+d),f.ifModified&&(k.lastModified[r]&&C.setRequestHeader("If-Modified-Since",k.lastModified[r]),k.etag[r]&&C.setRequestHeader("If-None-Match",k.etag[r])),(f.data&&f.hasContent&&!1!==f.contentType||e.contentType)&&C.setRequestHeader("Content-Type",f.contentType),C.setRequestHeader("Accept",f.dataTypes[0]&&f.accepts[f.dataTypes[0]]?f.accepts[f.dataTypes[0]]+("*"!==f.dataTypes[0]?", "+je+"; q=0.01":""):f.accepts["*"]),f.headers)C.setRequestHeader(h,f.headers[h]);if(f.beforeSend&&(!1===f.beforeSend.call(p,C,f)||c))return C.abort();if(x="abort",_.add(f.complete),C.done(f.success),C.fail(f.error),n=We(Ne,f,e,C)){if(C.readyState=1,u&&g.trigger("ajaxSend",[C,f]),c)return C;f.async&&f.timeout>0&&(a=i.setTimeout((function(){C.abort("timeout")}),f.timeout));try{c=!1,n.send(y,E)}catch(t){if(c)throw t;E(-1,t)}}else E(-1,"No Transport");function E(t,e,s,l){var h,d,b,y,w,x=e;c||(c=!0,a&&i.clearTimeout(a),n=void 0,o=l||"",C.readyState=t>0?4:0,h=t>=200&&t<300||304===t,s&&(y=function(t,e,n){for(var i,r,o,s,a=t.contents,l=t.dataTypes;"*"===l[0];)l.shift(),void 0===i&&(i=t.mimeType||e.getResponseHeader("Content-Type"));if(i)for(r in a)if(a[r]&&a[r].test(i)){l.unshift(r);break}if(l[0]in n)o=l[0];else{for(r in n){if(!l[0]||t.converters[r+" "+l[0]]){o=r;break}s||(s=r)}o=o||s}if(o)return o!==l[0]&&l.unshift(o),n[o]}(f,C,s)),!h&&k.inArray("script",f.dataTypes)>-1&&k.inArray("json",f.dataTypes)<0&&(f.converters["text script"]=function(){}),y=function(t,e,n,i){var r,o,s,a,l,c={},u=t.dataTypes.slice();if(u[1])for(s in t.converters)c[s.toLowerCase()]=t.converters[s];for(o=u.shift();o;)if(t.responseFields[o]&&(n[t.responseFields[o]]=e),!l&&i&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),l=o,o=u.shift())if("*"===o)o=l;else if("*"!==l&&l!==o){if(!(s=c[l+" "+o]||c["* "+o]))for(r in c)if((a=r.split(" "))[1]===o&&(s=c[l+" "+a[0]]||c["* "+a[0]])){!0===s?s=c[r]:!0!==c[r]&&(o=a[0],u.unshift(a[1]));break}if(!0!==s)if(s&&t.throws)e=s(e);else try{e=s(e)}catch(t){return{state:"parsererror",error:s?t:"No conversion from "+l+" to "+o}}}return{state:"success",data:e}}(f,y,C,h),h?(f.ifModified&&((w=C.getResponseHeader("Last-Modified"))&&(k.lastModified[r]=w),(w=C.getResponseHeader("etag"))&&(k.etag[r]=w)),204===t||"HEAD"===f.type?x="nocontent":304===t?x="notmodified":(x=y.state,d=y.data,h=!(b=y.error))):(b=x,!t&&x||(x="error",t<0&&(t=0))),C.status=t,C.statusText=(e||x)+"",h?m.resolveWith(p,[d,x,C]):m.rejectWith(p,[C,x,b]),C.statusCode(v),v=void 0,u&&g.trigger(h?"ajaxSuccess":"ajaxError",[C,f,h?d:b]),_.fireWith(p,[C,x]),u&&(g.trigger("ajaxComplete",[C,f]),--k.active||k.event.trigger("ajaxStop")))}return C},getJSON:function(t,e,n){return k.get(t,e,n,"json")},getScript:function(t,e){return k.get(t,void 0,e,"script")}}),k.each(["get","post"],(function(t,e){k[e]=function(t,n,i,r){return _(n)&&(r=r||i,i=n,n=void 0),k.ajax(k.extend({url:t,type:e,dataType:r,data:n,success:i},k.isPlainObject(t)&&t))}})),k.ajaxPrefilter((function(t){var e;for(e in t.headers)"content-type"===e.toLowerCase()&&(t.contentType=t.headers[e]||"")})),k._evalUrl=function(t,e,n){return k.ajax({url:t,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(t){k.globalEval(t,e,n)}})},k.fn.extend({wrapAll:function(t){var e;return this[0]&&(_(t)&&(t=t.call(this[0])),e=k(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map((function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t})).append(this)),this},wrapInner:function(t){return _(t)?this.each((function(e){k(this).wrapInner(t.call(this,e))})):this.each((function(){var e=k(this),n=e.contents();n.length?n.wrapAll(t):e.append(t)}))},wrap:function(t){var e=_(t);return this.each((function(n){k(this).wrapAll(e?t.call(this,n):t)}))},unwrap:function(t){return this.parent(t).not("body").each((function(){k(this).replaceWith(this.childNodes)})),this}}),k.expr.pseudos.hidden=function(t){return!k.expr.pseudos.visible(t)},k.expr.pseudos.visible=function(t){return!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)},k.ajaxSettings.xhr=function(){try{return new i.XMLHttpRequest}catch(t){}};var $e={0:200,1223:204},Ze=k.ajaxSettings.xhr();m.cors=!!Ze&&"withCredentials"in Ze,m.ajax=Ze=!!Ze,k.ajaxTransport((function(t){var e,n;if(m.cors||Ze&&!t.crossDomain)return{send:function(r,o){var s,a=t.xhr();if(a.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(s in t.xhrFields)a[s]=t.xhrFields[s];for(s in t.mimeType&&a.overrideMimeType&&a.overrideMimeType(t.mimeType),t.crossDomain||r["X-Requested-With"]||(r["X-Requested-With"]="XMLHttpRequest"),r)a.setRequestHeader(s,r[s]);e=function(t){return function(){e&&(e=n=a.onload=a.onerror=a.onabort=a.ontimeout=a.onreadystatechange=null,"abort"===t?a.abort():"error"===t?"number"!=typeof a.status?o(0,"error"):o(a.status,a.statusText):o($e[a.status]||a.status,a.statusText,"text"!==(a.responseType||"text")||"string"!=typeof a.responseText?{binary:a.response}:{text:a.responseText},a.getAllResponseHeaders()))}},a.onload=e(),n=a.onerror=a.ontimeout=e("error"),void 0!==a.onabort?a.onabort=n:a.onreadystatechange=function(){4===a.readyState&&i.setTimeout((function(){e&&n()}))},e=e("abort");try{a.send(t.hasContent&&t.data||null)}catch(t){if(e)throw t}},abort:function(){e&&e()}}})),k.ajaxPrefilter((function(t){t.crossDomain&&(t.contents.script=!1)})),k.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(t){return k.globalEval(t),t}}}),k.ajaxPrefilter("script",(function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET")})),k.ajaxTransport("script",(function(t){var e,n;if(t.crossDomain||t.scriptAttrs)return{send:function(i,r){e=k("<script>").attr(t.scriptAttrs||{}).prop({charset:t.scriptCharset,src:t.url}).on("load error",n=function(t){e.remove(),n=null,t&&r("error"===t.type?404:200,t.type)}),b.head.appendChild(e[0])},abort:function(){n&&n()}}}));var qe,Ge=[],Ke=/(=)\?(?=&|$)|\?\?/;k.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=Ge.pop()||k.expando+"_"+Ee.guid++;return this[t]=!0,t}}),k.ajaxPrefilter("json jsonp",(function(t,e,n){var r,o,s,a=!1!==t.jsonp&&(Ke.test(t.url)?"url":"string"==typeof t.data&&0===(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&Ke.test(t.data)&&"data");if(a||"jsonp"===t.dataTypes[0])return r=t.jsonpCallback=_(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,a?t[a]=t[a].replace(Ke,"$1"+r):!1!==t.jsonp&&(t.url+=(Se.test(t.url)?"&":"?")+t.jsonp+"="+r),t.converters["script json"]=function(){return s||k.error(r+" was not called"),s[0]},t.dataTypes[0]="json",o=i[r],i[r]=function(){s=arguments},n.always((function(){void 0===o?k(i).removeProp(r):i[r]=o,t[r]&&(t.jsonpCallback=e.jsonpCallback,Ge.push(r)),s&&_(o)&&o(s[0]),s=o=void 0})),"script"})),m.createHTMLDocument=((qe=b.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===qe.childNodes.length),k.parseHTML=function(t,e,n){return"string"!=typeof t?[]:("boolean"==typeof e&&(n=e,e=!1),e||(m.createHTMLDocument?((i=(e=b.implementation.createHTMLDocument("")).createElement("base")).href=b.location.href,e.head.appendChild(i)):e=b),o=!n&&[],(r=P.exec(t))?[e.createElement(r[1])]:(r=Ct([t],e,o),o&&o.length&&k(o).remove(),k.merge([],r.childNodes)));var i,r,o},k.fn.load=function(t,e,n){var i,r,o,s=this,a=t.indexOf(" ");return a>-1&&(i=ve(t.slice(a)),t=t.slice(0,a)),_(e)?(n=e,e=void 0):e&&"object"==typeof e&&(r="POST"),s.length>0&&k.ajax({url:t,type:r||"GET",dataType:"html",data:e}).done((function(t){o=arguments,s.html(i?k("<div>").append(k.parseHTML(t)).find(i):t)})).always(n&&function(t,e){s.each((function(){n.apply(this,o||[t.responseText,e,t])}))}),this},k.expr.pseudos.animated=function(t){return k.grep(k.timers,(function(e){return t===e.elem})).length},k.offset={setOffset:function(t,e,n){var i,r,o,s,a,l,c=k.css(t,"position"),u=k(t),h={};"static"===c&&(t.style.position="relative"),a=u.offset(),o=k.css(t,"top"),l=k.css(t,"left"),("absolute"===c||"fixed"===c)&&(o+l).indexOf("auto")>-1?(s=(i=u.position()).top,r=i.left):(s=parseFloat(o)||0,r=parseFloat(l)||0),_(e)&&(e=e.call(t,n,k.extend({},a))),null!=e.top&&(h.top=e.top-a.top+s),null!=e.left&&(h.left=e.left-a.left+r),"using"in e?e.using.call(t,h):u.css(h)}},k.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each((function(e){k.offset.setOffset(this,t,e)}));var e,n,i=this[0];return i?i.getClientRects().length?(e=i.getBoundingClientRect(),n=i.ownerDocument.defaultView,{top:e.top+n.pageYOffset,left:e.left+n.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var t,e,n,i=this[0],r={top:0,left:0};if("fixed"===k.css(i,"position"))e=i.getBoundingClientRect();else{for(e=this.offset(),n=i.ownerDocument,t=i.offsetParent||n.documentElement;t&&(t===n.body||t===n.documentElement)&&"static"===k.css(t,"position");)t=t.parentNode;t&&t!==i&&1===t.nodeType&&((r=k(t).offset()).top+=k.css(t,"borderTopWidth",!0),r.left+=k.css(t,"borderLeftWidth",!0))}return{top:e.top-r.top-k.css(i,"marginTop",!0),left:e.left-r.left-k.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map((function(){for(var t=this.offsetParent;t&&"static"===k.css(t,"position");)t=t.offsetParent;return t||st}))}}),k.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},(function(t,e){var n="pageYOffset"===e;k.fn[t]=function(i){return $(this,(function(t,i,r){var o;if(v(t)?o=t:9===t.nodeType&&(o=t.defaultView),void 0===r)return o?o[e]:t[i];o?o.scrollTo(n?o.pageXOffset:r,n?r:o.pageYOffset):t[i]=r}),t,i,arguments.length)}})),k.each(["top","left"],(function(t,e){k.cssHooks[e]=qt(m.pixelPosition,(function(t,n){if(n)return n=Zt(t,e),jt.test(n)?k(t).position()[e]+"px":n}))})),k.each({Height:"height",Width:"width"},(function(t,e){k.each({padding:"inner"+t,content:e,"":"outer"+t},(function(n,i){k.fn[i]=function(r,o){var s=arguments.length&&(n||"boolean"!=typeof r),a=n||(!0===r||!0===o?"margin":"border");return $(this,(function(e,n,r){var o;return v(e)?0===i.indexOf("outer")?e["inner"+t]:e.document.documentElement["client"+t]:9===e.nodeType?(o=e.documentElement,Math.max(e.body["scroll"+t],o["scroll"+t],e.body["offset"+t],o["offset"+t],o["client"+t])):void 0===r?k.css(e,n,a):k.style(e,n,r,a)}),e,s?r:void 0,s)}}))})),k.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],(function(t,e){k.fn[e]=function(t){return this.on(e,t)}})),k.fn.extend({bind:function(t,e,n){return this.on(t,null,e,n)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,n,i){return this.on(e,t,n,i)},undelegate:function(t,e,n){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",n)},hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)}}),k.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),(function(t,e){k.fn[e]=function(t,n){return arguments.length>0?this.on(e,null,t,n):this.trigger(e)}}));var Xe=/^[\s\uFEFF\xA0]+|([^\s\uFEFF\xA0])[\s\uFEFF\xA0]+$/g;k.proxy=function(t,e){var n,i,r;if("string"==typeof e&&(n=t[e],e=t,t=n),_(t))return i=a.call(arguments,2),r=function(){return t.apply(e||this,i.concat(a.call(arguments)))},r.guid=t.guid=t.guid||k.guid++,r},k.holdReady=function(t){t?k.readyWait++:k.ready(!0)},k.isArray=Array.isArray,k.parseJSON=JSON.parse,k.nodeName=D,k.isFunction=_,k.isWindow=v,k.camelCase=K,k.type=x,k.now=Date.now,k.isNumeric=function(t){var e=k.type(t);return("number"===e||"string"===e)&&!isNaN(t-parseFloat(t))},k.trim=function(t){return null==t?"":(t+"").replace(Xe,"$1")},void 0===(n=function(){return k}.apply(e,[]))||(t.exports=n);var Ye=i.jQuery,Qe=i.$;return k.noConflict=function(t){return i.$===k&&(i.$=Qe),t&&i.jQuery===k&&(i.jQuery=Ye),k},void 0===r&&(i.jQuery=i.$=k),k}))},4211:function(t,e){!function(t){"use strict";function e(t){return"object"==typeof t&&"function"==typeof t.to}function n(t){t.parentElement.removeChild(t)}function i(t){return null!=t}function r(t){t.preventDefault()}function o(t){return"number"==typeof t&&!isNaN(t)&&isFinite(t)}function s(t,e,n){n>0&&(u(t,e),setTimeout((function(){h(t,e)}),n))}function a(t){return Math.max(Math.min(t,100),0)}function l(t){return Array.isArray(t)?t:[t]}function c(t){var e=(t=String(t)).split(".");return e.length>1?e[1].length:0}function u(t,e){t.classList&&!/\s/.test(e)?t.classList.add(e):t.className+=" "+e}function h(t,e){t.classList&&!/\s/.test(e)?t.classList.remove(e):t.className=t.className.replace(new RegExp("(^|\\b)"+e.split(" ").join("|")+"(\\b|$)","gi")," ")}function d(t){var e=void 0!==window.pageXOffset,n="CSS1Compat"===(t.compatMode||"");return{x:e?window.pageXOffset:n?t.documentElement.scrollLeft:t.body.scrollLeft,y:e?window.pageYOffset:n?t.documentElement.scrollTop:t.body.scrollTop}}function f(t,e){return 100/(e-t)}function p(t,e,n){return 100*e/(t[n+1]-t[n])}function g(t,e){for(var n=1;t>=e[n];)n+=1;return n}function m(t,e,n){if(n>=t.slice(-1)[0])return 100;var i=g(n,t),r=t[i-1],o=t[i],s=e[i-1],a=e[i];return s+function(t,e){return p(t,t[0]<0?e+Math.abs(t[0]):e-t[0],0)}([r,o],n)/f(s,a)}function _(t,e,n,i){if(100===i)return i;var r=g(i,t),o=t[r-1],s=t[r];return n?i-o>(s-o)/2?s:o:e[r-1]?t[r-1]+function(t,e){return Math.round(t/e)*e}(i-t[r-1],e[r-1]):i}var v,b;t.PipsMode=void 0,(b=t.PipsMode||(t.PipsMode={})).Range="range",b.Steps="steps",b.Positions="positions",b.Count="count",b.Values="values",t.PipsType=void 0,(v=t.PipsType||(t.PipsType={}))[v.None=-1]="None",v[v.NoValue=0]="NoValue",v[v.LargeValue=1]="LargeValue",v[v.SmallValue=2]="SmallValue";var y=function(){function t(t,e,n){var i;this.xPct=[],this.xVal=[],this.xSteps=[],this.xNumSteps=[],this.xHighestCompleteStep=[],this.xSteps=[n||!1],this.xNumSteps=[!1],this.snap=e;var r=[];for(Object.keys(t).forEach((function(e){r.push([l(t[e]),e])})),r.sort((function(t,e){return t[0][0]-e[0][0]})),i=0;i<r.length;i++)this.handleEntryPoint(r[i][1],r[i][0]);for(this.xNumSteps=this.xSteps.slice(0),i=0;i<this.xNumSteps.length;i++)this.handleStepPoint(i,this.xNumSteps[i])}return t.prototype.getDistance=function(t){for(var e=[],n=0;n<this.xNumSteps.length-1;n++)e[n]=p(this.xVal,t,n);return e},t.prototype.getAbsoluteDistance=function(t,e,n){var i,r=0;if(t<this.xPct[this.xPct.length-1])for(;t>this.xPct[r+1];)r++;else t===this.xPct[this.xPct.length-1]&&(r=this.xPct.length-2);n||t!==this.xPct[r+1]||r++,null===e&&(e=[]);var o=1,s=e[r],a=0,l=0,c=0,u=0;for(i=n?(t-this.xPct[r])/(this.xPct[r+1]-this.xPct[r]):(this.xPct[r+1]-t)/(this.xPct[r+1]-this.xPct[r]);s>0;)a=this.xPct[r+1+u]-this.xPct[r+u],e[r+u]*o+100-100*i>100?(l=a*i,o=(s-100*i)/e[r+u],i=1):(l=e[r+u]*a/100*o,o=0),n?(c-=l,this.xPct.length+u>=1&&u--):(c+=l,this.xPct.length-u>=1&&u++),s=e[r+u]*o;return t+c},t.prototype.toStepping=function(t){return m(this.xVal,this.xPct,t)},t.prototype.fromStepping=function(t){return function(t,e,n){if(n>=100)return t.slice(-1)[0];var i=g(n,e),r=t[i-1],o=t[i],s=e[i-1];return function(t,e){return e*(t[1]-t[0])/100+t[0]}([r,o],(n-s)*f(s,e[i]))}(this.xVal,this.xPct,t)},t.prototype.getStep=function(t){return _(this.xPct,this.xSteps,this.snap,t)},t.prototype.getDefaultStep=function(t,e,n){var i=g(t,this.xPct);return(100===t||e&&t===this.xPct[i-1])&&(i=Math.max(i-1,1)),(this.xVal[i]-this.xVal[i-1])/n},t.prototype.getNearbySteps=function(t){var e=g(t,this.xPct);return{stepBefore:{startValue:this.xVal[e-2],step:this.xNumSteps[e-2],highestStep:this.xHighestCompleteStep[e-2]},thisStep:{startValue:this.xVal[e-1],step:this.xNumSteps[e-1],highestStep:this.xHighestCompleteStep[e-1]},stepAfter:{startValue:this.xVal[e],step:this.xNumSteps[e],highestStep:this.xHighestCompleteStep[e]}}},t.prototype.countStepDecimals=function(){var t=this.xNumSteps.map(c);return Math.max.apply(null,t)},t.prototype.hasNoSize=function(){return this.xVal[0]===this.xVal[this.xVal.length-1]},t.prototype.convert=function(t){return this.getStep(this.toStepping(t))},t.prototype.handleEntryPoint=function(t,e){var n;if(!o(n="min"===t?0:"max"===t?100:parseFloat(t))||!o(e[0]))throw new Error("noUiSlider: 'range' value isn't numeric.");this.xPct.push(n),this.xVal.push(e[0]);var i=Number(e[1]);n?this.xSteps.push(!isNaN(i)&&i):isNaN(i)||(this.xSteps[0]=i),this.xHighestCompleteStep.push(0)},t.prototype.handleStepPoint=function(t,e){if(e)if(this.xVal[t]!==this.xVal[t+1]){this.xSteps[t]=p([this.xVal[t],this.xVal[t+1]],e,0)/f(this.xPct[t],this.xPct[t+1]);var n=(this.xVal[t+1]-this.xVal[t])/this.xNumSteps[t],i=Math.ceil(Number(n.toFixed(3))-1),r=this.xVal[t]+this.xNumSteps[t]*i;this.xHighestCompleteStep[t]=r}else this.xSteps[t]=this.xHighestCompleteStep[t]=this.xVal[t]},t}(),w={to:function(t){return void 0===t?"":t.toFixed(2)},from:Number},x={target:"target",base:"base",origin:"origin",handle:"handle",handleLower:"handle-lower",handleUpper:"handle-upper",touchArea:"touch-area",horizontal:"horizontal",vertical:"vertical",background:"background",connect:"connect",connects:"connects",ltr:"ltr",rtl:"rtl",textDirectionLtr:"txt-dir-ltr",textDirectionRtl:"txt-dir-rtl",draggable:"draggable",drag:"state-drag",tap:"state-tap",active:"active",tooltip:"tooltip",pips:"pips",pipsHorizontal:"pips-horizontal",pipsVertical:"pips-vertical",marker:"marker",markerHorizontal:"marker-horizontal",markerVertical:"marker-vertical",markerNormal:"marker-normal",markerLarge:"marker-large",markerSub:"marker-sub",value:"value",valueHorizontal:"value-horizontal",valueVertical:"value-vertical",valueNormal:"value-normal",valueLarge:"value-large",valueSub:"value-sub"},C=".__tooltips",k=".__aria";function E(t,e){if(!o(e))throw new Error("noUiSlider: 'step' is not numeric.");t.singleStep=e}function S(t,e){if(!o(e))throw new Error("noUiSlider: 'keyboardPageMultiplier' is not numeric.");t.keyboardPageMultiplier=e}function A(t,e){if(!o(e))throw new Error("noUiSlider: 'keyboardMultiplier' is not numeric.");t.keyboardMultiplier=e}function T(t,e){if(!o(e))throw new Error("noUiSlider: 'keyboardDefaultStep' is not numeric.");t.keyboardDefaultStep=e}function M(t,e){if("object"!=typeof e||Array.isArray(e))throw new Error("noUiSlider: 'range' is not an object.");if(void 0===e.min||void 0===e.max)throw new Error("noUiSlider: Missing 'min' or 'max' in 'range'.");t.spectrum=new y(e,t.snap||!1,t.singleStep)}function D(t,e){if(e=l(e),!Array.isArray(e)||!e.length)throw new Error("noUiSlider: 'start' option is incorrect.");t.handles=e.length,t.start=e}function P(t,e){if("boolean"!=typeof e)throw new Error("noUiSlider: 'snap' option must be a boolean.");t.snap=e}function L(t,e){if("boolean"!=typeof e)throw new Error("noUiSlider: 'animate' option must be a boolean.");t.animate=e}function R(t,e){if("number"!=typeof e)throw new Error("noUiSlider: 'animationDuration' option must be a number.");t.animationDuration=e}function I(t,e){var n,i=[!1];if("lower"===e?e=[!0,!1]:"upper"===e&&(e=[!1,!0]),!0===e||!1===e){for(n=1;n<t.handles;n++)i.push(e);i.push(!1)}else{if(!Array.isArray(e)||!e.length||e.length!==t.handles+1)throw new Error("noUiSlider: 'connect' option doesn't match handle count.");i=e}t.connect=i}function O(t,e){switch(e){case"horizontal":t.ort=0;break;case"vertical":t.ort=1;break;default:throw new Error("noUiSlider: 'orientation' option is invalid.")}}function z(t,e){if(!o(e))throw new Error("noUiSlider: 'margin' option must be numeric.");0!==e&&(t.margin=t.spectrum.getDistance(e))}function F(t,e){if(!o(e))throw new Error("noUiSlider: 'limit' option must be numeric.");if(t.limit=t.spectrum.getDistance(e),!t.limit||t.handles<2)throw new Error("noUiSlider: 'limit' option is only supported on linear sliders with 2 or more handles.")}function B(t,e){var n;if(!o(e)&&!Array.isArray(e))throw new Error("noUiSlider: 'padding' option must be numeric or array of exactly 2 numbers.");if(Array.isArray(e)&&2!==e.length&&!o(e[0])&&!o(e[1]))throw new Error("noUiSlider: 'padding' option must be numeric or array of exactly 2 numbers.");if(0!==e){for(Array.isArray(e)||(e=[e,e]),t.padding=[t.spectrum.getDistance(e[0]),t.spectrum.getDistance(e[1])],n=0;n<t.spectrum.xNumSteps.length-1;n++)if(t.padding[0][n]<0||t.padding[1][n]<0)throw new Error("noUiSlider: 'padding' option must be a positive number(s).");var i=e[0]+e[1],r=t.spectrum.xVal[0];if(i/(t.spectrum.xVal[t.spectrum.xVal.length-1]-r)>1)throw new Error("noUiSlider: 'padding' option must not exceed 100% of the range.")}}function N(t,e){switch(e){case"ltr":t.dir=0;break;case"rtl":t.dir=1;break;default:throw new Error("noUiSlider: 'direction' option was not recognized.")}}function j(t,e){if("string"!=typeof e)throw new Error("noUiSlider: 'behaviour' must be a string containing options.");var n=e.indexOf("tap")>=0,i=e.indexOf("drag")>=0,r=e.indexOf("fixed")>=0,o=e.indexOf("snap")>=0,s=e.indexOf("hover")>=0,a=e.indexOf("unconstrained")>=0,l=e.indexOf("drag-all")>=0,c=e.indexOf("smooth-steps")>=0;if(r){if(2!==t.handles)throw new Error("noUiSlider: 'fixed' behaviour must be used with 2 handles");z(t,t.start[1]-t.start[0])}if(a&&(t.margin||t.limit))throw new Error("noUiSlider: 'unconstrained' behaviour cannot be used with margin or limit");t.events={tap:n||o,drag:i,dragAll:l,smoothSteps:c,fixed:r,snap:o,hover:s,unconstrained:a}}function U(t,n){if(!1!==n)if(!0===n||e(n)){t.tooltips=[];for(var i=0;i<t.handles;i++)t.tooltips.push(n)}else{if((n=l(n)).length!==t.handles)throw new Error("noUiSlider: must pass a formatter for all handles.");n.forEach((function(t){if("boolean"!=typeof t&&!e(t))throw new Error("noUiSlider: 'tooltips' must be passed a formatter or 'false'.")})),t.tooltips=n}}function V(t,e){if(e.length!==t.handles)throw new Error("noUiSlider: must pass a attributes for all handles.");t.handleAttributes=e}function W(t,n){if(!e(n))throw new Error("noUiSlider: 'ariaFormat' requires 'to' method.");t.ariaFormat=n}function H(t,n){if(!function(t){return e(t)&&"function"==typeof t.from}(n))throw new Error("noUiSlider: 'format' requires 'to' and 'from' methods.");t.format=n}function $(t,e){if("boolean"!=typeof e)throw new Error("noUiSlider: 'keyboardSupport' option must be a boolean.");t.keyboardSupport=e}function Z(t,e){t.documentElement=e}function q(t,e){if("string"!=typeof e&&!1!==e)throw new Error("noUiSlider: 'cssPrefix' must be a string or `false`.");t.cssPrefix=e}function G(t,e){if("object"!=typeof e)throw new Error("noUiSlider: 'cssClasses' must be an object.");"string"==typeof t.cssPrefix?(t.cssClasses={},Object.keys(e).forEach((function(n){t.cssClasses[n]=t.cssPrefix+e[n]}))):t.cssClasses=e}function K(t){var e={margin:null,limit:null,padding:null,animate:!0,animationDuration:300,ariaFormat:w,format:w},n={step:{r:!1,t:E},keyboardPageMultiplier:{r:!1,t:S},keyboardMultiplier:{r:!1,t:A},keyboardDefaultStep:{r:!1,t:T},start:{r:!0,t:D},connect:{r:!0,t:I},direction:{r:!0,t:N},snap:{r:!1,t:P},animate:{r:!1,t:L},animationDuration:{r:!1,t:R},range:{r:!0,t:M},orientation:{r:!1,t:O},margin:{r:!1,t:z},limit:{r:!1,t:F},padding:{r:!1,t:B},behaviour:{r:!0,t:j},ariaFormat:{r:!1,t:W},format:{r:!1,t:H},tooltips:{r:!1,t:U},keyboardSupport:{r:!0,t:$},documentElement:{r:!1,t:Z},cssPrefix:{r:!0,t:q},cssClasses:{r:!0,t:G},handleAttributes:{r:!1,t:V}},r={connect:!1,direction:"ltr",behaviour:"tap",orientation:"horizontal",keyboardSupport:!0,cssPrefix:"noUi-",cssClasses:x,keyboardPageMultiplier:5,keyboardMultiplier:1,keyboardDefaultStep:10};t.format&&!t.ariaFormat&&(t.ariaFormat=t.format),Object.keys(n).forEach((function(o){if(i(t[o])||void 0!==r[o])n[o].t(e,i(t[o])?t[o]:r[o]);else if(n[o].r)throw new Error("noUiSlider: '"+o+"' is required.")})),e.pips=t.pips;var o=document.createElement("div"),s=void 0!==o.style.msTransform,a=void 0!==o.style.transform;e.transformRule=a?"transform":s?"msTransform":"webkitTransform";return e.style=[["left","top"],["right","bottom"]][e.dir][e.ort],e}function X(e,o,c){var f,p,g,m,_,v,b,y=window.navigator.pointerEnabled?{start:"pointerdown",move:"pointermove",end:"pointerup"}:window.navigator.msPointerEnabled?{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}:{start:"mousedown touchstart",move:"mousemove touchmove",end:"mouseup touchend"},w=window.CSS&&CSS.supports&&CSS.supports("touch-action","none")&&function(){var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("test",null,e)}catch(t){}return t}(),x=e,E=o.spectrum,S=[],A=[],T=[],M=0,D={},P=e.ownerDocument,L=o.documentElement||P.documentElement,R=P.body,I="rtl"===P.dir||1===o.ort?0:100;function O(t,e){var n=P.createElement("div");return e&&u(n,e),t.appendChild(n),n}function z(t,e){var n=O(t,o.cssClasses.origin),i=O(n,o.cssClasses.handle);if(O(i,o.cssClasses.touchArea),i.setAttribute("data-handle",String(e)),o.keyboardSupport&&(i.setAttribute("tabindex","0"),i.addEventListener("keydown",(function(t){return function(t,e){if(N()||j(e))return!1;var n=["Left","Right"],i=["Down","Up"],r=["PageDown","PageUp"],s=["Home","End"];o.dir&&!o.ort?n.reverse():o.ort&&!o.dir&&(i.reverse(),r.reverse());var a,l=t.key.replace("Arrow",""),c=l===r[0],u=l===r[1],h=l===i[0]||l===n[0]||c,d=l===i[1]||l===n[1]||u,f=l===s[0],p=l===s[1];if(!(h||d||f||p))return!0;if(t.preventDefault(),d||h){var g=h?0:1,m=_t(e)[g];if(null===m)return!1;!1===m&&(m=E.getDefaultStep(A[e],h,o.keyboardDefaultStep)),m*=u||c?o.keyboardPageMultiplier:o.keyboardMultiplier,m=Math.max(m,1e-7),m*=h?-1:1,a=S[e]+m}else a=p?o.spectrum.xVal[o.spectrum.xVal.length-1]:o.spectrum.xVal[0];return dt(e,E.toStepping(a),!0,!0),st("slide",e),st("update",e),st("change",e),st("set",e),!1}(t,e)}))),void 0!==o.handleAttributes){var r=o.handleAttributes[e];Object.keys(r).forEach((function(t){i.setAttribute(t,r[t])}))}return i.setAttribute("role","slider"),i.setAttribute("aria-orientation",o.ort?"vertical":"horizontal"),0===e?u(i,o.cssClasses.handleLower):e===o.handles-1&&u(i,o.cssClasses.handleUpper),n}function F(t,e){return!!e&&O(t,o.cssClasses.connect)}function B(t,e){return!(!o.tooltips||!o.tooltips[e])&&O(t.firstChild,o.cssClasses.tooltip)}function N(){return x.hasAttribute("disabled")}function j(t){return p[t].hasAttribute("disabled")}function U(){_&&(ot("update"+C),_.forEach((function(t){t&&n(t)})),_=null)}function V(){U(),_=p.map(B),rt("update"+C,(function(t,e,n){if(_&&o.tooltips&&!1!==_[e]){var i=t[e];!0!==o.tooltips[e]&&(i=o.tooltips[e].to(n[e])),_[e].innerHTML=i}}))}function W(t,e){return t.map((function(t){return E.fromStepping(e?E.getStep(t):t)}))}function H(e){var n,i=function(e){if(e.mode===t.PipsMode.Range||e.mode===t.PipsMode.Steps)return E.xVal;if(e.mode===t.PipsMode.Count){if(e.values<2)throw new Error("noUiSlider: 'values' (>= 2) required for mode 'count'.");for(var n=e.values-1,i=100/n,r=[];n--;)r[n]=n*i;return r.push(100),W(r,e.stepped)}return e.mode===t.PipsMode.Positions?W(e.values,e.stepped):e.mode===t.PipsMode.Values?e.stepped?e.values.map((function(t){return E.fromStepping(E.getStep(E.toStepping(t)))})):e.values:[]}(e),r={},o=E.xVal[0],s=E.xVal[E.xVal.length-1],a=!1,l=!1,c=0;return(n=i.slice().sort((function(t,e){return t-e})),i=n.filter((function(t){return!this[t]&&(this[t]=!0)}),{}))[0]!==o&&(i.unshift(o),a=!0),i[i.length-1]!==s&&(i.push(s),l=!0),i.forEach((function(n,o){var s,u,h,d,f,p,g,m,_,v,b=n,y=i[o+1],w=e.mode===t.PipsMode.Steps;for(w&&(s=E.xNumSteps[o]),s||(s=y-b),void 0===y&&(y=b),s=Math.max(s,1e-7),u=b;u<=y;u=Number((u+s).toFixed(7))){for(m=(f=(d=E.toStepping(u))-c)/(e.density||1),v=f/(_=Math.round(m)),h=1;h<=_;h+=1)r[(p=c+h*v).toFixed(5)]=[E.fromStepping(p),0];g=i.indexOf(u)>-1?t.PipsType.LargeValue:w?t.PipsType.SmallValue:t.PipsType.NoValue,!o&&a&&u!==y&&(g=0),u===y&&l||(r[d.toFixed(5)]=[u,g]),c=d}})),r}function $(e,n,i){var r,s,a=P.createElement("div"),l=((r={})[t.PipsType.None]="",r[t.PipsType.NoValue]=o.cssClasses.valueNormal,r[t.PipsType.LargeValue]=o.cssClasses.valueLarge,r[t.PipsType.SmallValue]=o.cssClasses.valueSub,r),c=((s={})[t.PipsType.None]="",s[t.PipsType.NoValue]=o.cssClasses.markerNormal,s[t.PipsType.LargeValue]=o.cssClasses.markerLarge,s[t.PipsType.SmallValue]=o.cssClasses.markerSub,s),h=[o.cssClasses.valueHorizontal,o.cssClasses.valueVertical],d=[o.cssClasses.markerHorizontal,o.cssClasses.markerVertical];function f(t,e){var n=e===o.cssClasses.value,i=n?l:c;return e+" "+(n?h:d)[o.ort]+" "+i[t]}return u(a,o.cssClasses.pips),u(a,0===o.ort?o.cssClasses.pipsHorizontal:o.cssClasses.pipsVertical),Object.keys(e).forEach((function(r){!function(e,r,s){if((s=n?n(r,s):s)!==t.PipsType.None){var l=O(a,!1);l.className=f(s,o.cssClasses.marker),l.style[o.style]=e+"%",s>t.PipsType.NoValue&&((l=O(a,!1)).className=f(s,o.cssClasses.value),l.setAttribute("data-value",String(r)),l.style[o.style]=e+"%",l.innerHTML=String(i.to(r)))}}(r,e[r][0],e[r][1])})),a}function Z(){m&&(n(m),m=null)}function q(t){Z();var e=H(t),n=t.filter,i=t.format||{to:function(t){return String(Math.round(t))}};return m=x.appendChild($(e,n,i))}function G(){var t=f.getBoundingClientRect(),e="offset"+["Width","Height"][o.ort];return 0===o.ort?t.width||f[e]:t.height||f[e]}function X(t,e,n,i){var r=function(r){var s,a,l=function(t,e,n){var i=0===t.type.indexOf("touch"),r=0===t.type.indexOf("mouse"),o=0===t.type.indexOf("pointer"),s=0,a=0;if(0===t.type.indexOf("MSPointer")&&(o=!0),"mousedown"===t.type&&!t.buttons&&!t.touches)return!1;if(i){var l=function(e){var i=e.target;return i===n||n.contains(i)||t.composed&&t.composedPath().shift()===n};if("touchstart"===t.type){var c=Array.prototype.filter.call(t.touches,l);if(c.length>1)return!1;s=c[0].pageX,a=c[0].pageY}else{var u=Array.prototype.find.call(t.changedTouches,l);if(!u)return!1;s=u.pageX,a=u.pageY}}return e=e||d(P),(r||o)&&(s=t.clientX+e.x,a=t.clientY+e.y),t.pageOffset=e,t.points=[s,a],t.cursor=r||o,t}(r,i.pageOffset,i.target||e);return!!l&&!(N()&&!i.doNotReject)&&(s=x,a=o.cssClasses.tap,!((s.classList?s.classList.contains(a):new RegExp("\\b"+a+"\\b").test(s.className))&&!i.doNotReject))&&!(t===y.start&&void 0!==l.buttons&&l.buttons>1)&&(!i.hover||!l.buttons)&&(w||l.preventDefault(),l.calcPoint=l.points[o.ort],void n(l,i))},s=[];return t.split(" ").forEach((function(t){e.addEventListener(t,r,!!w&&{passive:!0}),s.push([t,r])})),s}function Y(t){var e,n,i,r,s,l,c=100*(t-(e=f,n=o.ort,i=e.getBoundingClientRect(),r=e.ownerDocument,s=r.documentElement,l=d(r),/webkit.*Chrome.*Mobile/i.test(navigator.userAgent)&&(l.x=0),n?i.top+l.y-s.clientTop:i.left+l.x-s.clientLeft))/G();return c=a(c),o.dir?100-c:c}function Q(t,e){"mouseout"===t.type&&"HTML"===t.target.nodeName&&null===t.relatedTarget&&tt(t,e)}function J(t,e){if(-1===navigator.appVersion.indexOf("MSIE 9")&&0===t.buttons&&0!==e.buttonsProperty)return tt(t,e);var n=(o.dir?-1:1)*(t.calcPoint-e.startCalcPoint);ct(n>0,100*n/e.baseSize,e.locations,e.handleNumbers,e.connect)}function tt(t,e){e.handle&&(h(e.handle,o.cssClasses.active),M-=1),e.listeners.forEach((function(t){L.removeEventListener(t[0],t[1])})),0===M&&(h(x,o.cssClasses.drag),ht(),t.cursor&&(R.style.cursor="",R.removeEventListener("selectstart",r))),o.events.smoothSteps&&(e.handleNumbers.forEach((function(t){dt(t,A[t],!0,!0,!1,!1)})),e.handleNumbers.forEach((function(t){st("update",t)}))),e.handleNumbers.forEach((function(t){st("change",t),st("set",t),st("end",t)}))}function et(t,e){if(!e.handleNumbers.some(j)){var n;1===e.handleNumbers.length&&(n=p[e.handleNumbers[0]].children[0],M+=1,u(n,o.cssClasses.active)),t.stopPropagation();var i=[],s=X(y.move,L,J,{target:t.target,handle:n,connect:e.connect,listeners:i,startCalcPoint:t.calcPoint,baseSize:G(),pageOffset:t.pageOffset,handleNumbers:e.handleNumbers,buttonsProperty:t.buttons,locations:A.slice()}),a=X(y.end,L,tt,{target:t.target,handle:n,listeners:i,doNotReject:!0,handleNumbers:e.handleNumbers}),l=X("mouseout",L,Q,{target:t.target,handle:n,listeners:i,doNotReject:!0,handleNumbers:e.handleNumbers});i.push.apply(i,s.concat(a,l)),t.cursor&&(R.style.cursor=getComputedStyle(t.target).cursor,p.length>1&&u(x,o.cssClasses.drag),R.addEventListener("selectstart",r,!1)),e.handleNumbers.forEach((function(t){st("start",t)}))}}function nt(t){t.stopPropagation();var e=Y(t.calcPoint),n=function(t){var e=100,n=!1;return p.forEach((function(i,r){if(!j(r)){var o=A[r],s=Math.abs(o-t);(s<e||s<=e&&t>o||100===s&&100===e)&&(n=r,e=s)}})),n}(e);!1!==n&&(o.events.snap||s(x,o.cssClasses.tap,o.animationDuration),dt(n,e,!0,!0),ht(),st("slide",n,!0),st("update",n,!0),o.events.snap?et(t,{handleNumbers:[n]}):(st("change",n,!0),st("set",n,!0)))}function it(t){var e=Y(t.calcPoint),n=E.getStep(e),i=E.fromStepping(n);Object.keys(D).forEach((function(t){"hover"===t.split(".")[0]&&D[t].forEach((function(t){t.call(vt,i)}))}))}function rt(t,e){D[t]=D[t]||[],D[t].push(e),"update"===t.split(".")[0]&&p.forEach((function(t,e){st("update",e)}))}function ot(t){var e=t&&t.split(".")[0],n=e?t.substring(e.length):t;Object.keys(D).forEach((function(t){var i=t.split(".")[0],r=t.substring(i.length);e&&e!==i||n&&n!==r||function(t){return t===k||t===C}(r)&&n!==r||delete D[t]}))}function st(t,e,n){Object.keys(D).forEach((function(i){var r=i.split(".")[0];t===r&&D[i].forEach((function(t){t.call(vt,S.map(o.format.to),e,S.slice(),n||!1,A.slice(),vt)}))}))}function at(t,e,n,i,r,s,l){var c;return p.length>1&&!o.events.unconstrained&&(i&&e>0&&(c=E.getAbsoluteDistance(t[e-1],o.margin,!1),n=Math.max(n,c)),r&&e<p.length-1&&(c=E.getAbsoluteDistance(t[e+1],o.margin,!0),n=Math.min(n,c))),p.length>1&&o.limit&&(i&&e>0&&(c=E.getAbsoluteDistance(t[e-1],o.limit,!1),n=Math.min(n,c)),r&&e<p.length-1&&(c=E.getAbsoluteDistance(t[e+1],o.limit,!0),n=Math.max(n,c))),o.padding&&(0===e&&(c=E.getAbsoluteDistance(0,o.padding[0],!1),n=Math.max(n,c)),e===p.length-1&&(c=E.getAbsoluteDistance(100,o.padding[1],!0),n=Math.min(n,c))),l||(n=E.getStep(n)),!((n=a(n))===t[e]&&!s)&&n}function lt(t,e){var n=o.ort;return(n?e:t)+", "+(n?t:e)}function ct(t,e,n,i,r){var s=n.slice(),a=i[0],l=o.events.smoothSteps,c=[!t,t],u=[t,!t];i=i.slice(),t&&i.reverse(),i.length>1?i.forEach((function(t,n){var i=at(s,t,s[t]+e,c[n],u[n],!1,l);!1===i?e=0:(e=i-s[t],s[t]=i)})):c=u=[!0];var h=!1;i.forEach((function(t,i){h=dt(t,n[t]+e,c[i],u[i],!1,l)||h})),h&&(i.forEach((function(t){st("update",t),st("slide",t)})),null!=r&&st("drag",a))}function ut(t,e){return o.dir?100-t-e:t}function ht(){T.forEach((function(t){var e=A[t]>50?-1:1,n=3+(p.length+e*t);p[t].style.zIndex=String(n)}))}function dt(t,e,n,i,r,s){return r||(e=at(A,t,e,n,i,!1,s)),!1!==e&&(function(t,e){A[t]=e,S[t]=E.fromStepping(e);var n="translate("+lt(ut(e,0)-I+"%","0")+")";p[t].style[o.transformRule]=n,ft(t),ft(t+1)}(t,e),!0)}function ft(t){if(g[t]){var e=0,n=100;0!==t&&(e=A[t-1]),t!==g.length-1&&(n=A[t]);var i=n-e,r="translate("+lt(ut(e,i)+"%","0")+")",s="scale("+lt(i/100,"1")+")";g[t].style[o.transformRule]=r+" "+s}}function pt(t,e){return null===t||!1===t||void 0===t?A[e]:("number"==typeof t&&(t=String(t)),!1!==(t=o.format.from(t))&&(t=E.toStepping(t)),!1===t||isNaN(t)?A[e]:t)}function gt(t,e,n){var i=l(t),r=void 0===A[0];e=void 0===e||e,o.animate&&!r&&s(x,o.cssClasses.tap,o.animationDuration),T.forEach((function(t){dt(t,pt(i[t],t),!0,!1,n)}));var a=1===T.length?0:1;if(r&&E.hasNoSize()&&(n=!0,A[0]=0,T.length>1)){var c=100/(T.length-1);T.forEach((function(t){A[t]=t*c}))}for(;a<T.length;++a)T.forEach((function(t){dt(t,A[t],!0,!0,n)}));ht(),T.forEach((function(t){st("update",t),null!==i[t]&&e&&st("set",t)}))}function mt(t){if(void 0===t&&(t=!1),t)return 1===S.length?S[0]:S.slice(0);var e=S.map(o.format.to);return 1===e.length?e[0]:e}function _t(t){var e=A[t],n=E.getNearbySteps(e),i=S[t],r=n.thisStep.step,s=null;if(o.snap)return[i-n.stepBefore.startValue||null,n.stepAfter.startValue-i||null];!1!==r&&i+r>n.stepAfter.startValue&&(r=n.stepAfter.startValue-i),s=i>n.thisStep.startValue?n.thisStep.step:!1!==n.stepBefore.step&&i-n.stepBefore.highestStep,100===e?r=null:0===e&&(s=null);var a=E.countStepDecimals();return null!==r&&!1!==r&&(r=Number(r.toFixed(a))),null!==s&&!1!==s&&(s=Number(s.toFixed(a))),[s,r]}u(b=x,o.cssClasses.target),0===o.dir?u(b,o.cssClasses.ltr):u(b,o.cssClasses.rtl),0===o.ort?u(b,o.cssClasses.horizontal):u(b,o.cssClasses.vertical),u(b,"rtl"===getComputedStyle(b).direction?o.cssClasses.textDirectionRtl:o.cssClasses.textDirectionLtr),f=O(b,o.cssClasses.base),function(t,e){var n=O(e,o.cssClasses.connects);p=[],(g=[]).push(F(n,t[0]));for(var i=0;i<o.handles;i++)p.push(z(e,i)),T[i]=i,g.push(F(n,t[i+1]))}(o.connect,f),(v=o.events).fixed||p.forEach((function(t,e){X(y.start,t.children[0],et,{handleNumbers:[e]})})),v.tap&&X(y.start,f,nt,{}),v.hover&&X(y.move,f,it,{hover:!0}),v.drag&&g.forEach((function(t,e){if(!1!==t&&0!==e&&e!==g.length-1){var n=p[e-1],i=p[e],r=[t],s=[n,i],a=[e-1,e];u(t,o.cssClasses.draggable),v.fixed&&(r.push(n.children[0]),r.push(i.children[0])),v.dragAll&&(s=p,a=T),r.forEach((function(e){X(y.start,e,et,{handles:s,handleNumbers:a,connect:t})}))}})),gt(o.start),o.pips&&q(o.pips),o.tooltips&&V(),ot("update"+k),rt("update"+k,(function(t,e,n,i,r){T.forEach((function(t){var e=p[t],i=at(A,t,0,!0,!0,!0),s=at(A,t,100,!0,!0,!0),a=r[t],l=String(o.ariaFormat.to(n[t]));i=E.fromStepping(i).toFixed(1),s=E.fromStepping(s).toFixed(1),a=E.fromStepping(a).toFixed(1),e.children[0].setAttribute("aria-valuemin",i),e.children[0].setAttribute("aria-valuemax",s),e.children[0].setAttribute("aria-valuenow",a),e.children[0].setAttribute("aria-valuetext",l)}))}));var vt={destroy:function(){for(ot(k),ot(C),Object.keys(o.cssClasses).forEach((function(t){h(x,o.cssClasses[t])}));x.firstChild;)x.removeChild(x.firstChild);delete x.noUiSlider},steps:function(){return T.map(_t)},on:rt,off:ot,get:mt,set:gt,setHandle:function(t,e,n,i){if(!((t=Number(t))>=0&&t<T.length))throw new Error("noUiSlider: invalid handle number, got: "+t);dt(t,pt(e,t),!0,!0,i),st("update",t),n&&st("set",t)},reset:function(t){gt(o.start,t)},__moveHandles:function(t,e,n){ct(t,e,A,n)},options:c,updateOptions:function(t,e){var n=mt(),r=["margin","limit","padding","range","animate","snap","step","format","pips","tooltips"];r.forEach((function(e){void 0!==t[e]&&(c[e]=t[e])}));var s=K(c);r.forEach((function(e){void 0!==t[e]&&(o[e]=s[e])})),E=s.spectrum,o.margin=s.margin,o.limit=s.limit,o.padding=s.padding,o.pips?q(o.pips):Z(),o.tooltips?V():U(),A=[],gt(i(t.start)?t.start:n,e)},target:x,removePips:Z,removeTooltips:U,getPositions:function(){return A.slice()},getTooltips:function(){return _},getOrigins:function(){return p},pips:q};return vt}function Y(t,e){if(!t||!t.nodeName)throw new Error("noUiSlider: create requires a single element, got: "+t);if(t.noUiSlider)throw new Error("noUiSlider: Slider was already initialized.");var n=X(t,K(e),e);return t.noUiSlider=n,n}var Q={__spectrum:y,cssClasses:x,create:Y};t.create=Y,t.cssClasses=x,t.default=Q,Object.defineProperty(t,"__esModule",{value:!0})}(e)},1550:function(t){t.exports=function(){"use strict";var t=function(t){return t instanceof Uint8Array||t instanceof Uint16Array||t instanceof Uint32Array||t instanceof Int8Array||t instanceof Int16Array||t instanceof Int32Array||t instanceof Float32Array||t instanceof Float64Array||t instanceof Uint8ClampedArray},e=function(t,e){for(var n=Object.keys(e),i=0;i<n.length;++i)t[n[i]]=e[n[i]];return t},n="\n";function i(t){var e=new Error("(regl) "+t);throw console.error(e),e}function r(t,e){t||i(e)}function o(t){return t?": "+t:""}function s(t,e){switch(e){case"number":return"number"==typeof t;case"object":return"object"==typeof t;case"string":return"string"==typeof t;case"boolean":return"boolean"==typeof t;case"function":return"function"==typeof t;case"undefined":return void 0===t;case"symbol":return"symbol"==typeof t}}function a(t,e,n){e.indexOf(t)<0&&i("invalid value"+o(n)+". must be one of: "+e)}var l=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function c(t,e){for(t+="";t.length<e;)t=" "+t;return t}function u(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function h(t,e){this.number=t,this.line=e,this.errors=[]}function d(t,e,n){this.file=t,this.line=e,this.message=n}function f(){var t=new Error,e=(t.stack||t).toString(),n=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(e);if(n)return n[1];var i=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(e);return i?i[1]:"unknown"}function p(){var t=new Error,e=(t.stack||t).toString(),n=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(e);if(n)return n[1];var i=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(e);return i?i[1]:"unknown"}function g(t,e){var n,i=t.split("\n"),r=1,o=0,s={unknown:new u,0:new u};s.unknown.name=s[0].name=e||f(),s.unknown.lines.push(new h(0,""));for(var a=0;a<i.length;++a){var l=i[a],c=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(l);if(c)switch(c[1]){case"line":var d=/(\d+)(\s+\d+)?/.exec(c[2]);d&&(r=0|d[1],d[2]&&((o=0|d[2])in s||(s[o]=new u)));break;case"define":var p=/SHADER_NAME(_B64)?\s+(.*)$/.exec(c[2]);p&&(s[o].name=p[1]?(n=p[2],"undefined"!=typeof atob?atob(n):"base64:"+n):p[2])}s[o].lines.push(new h(r++,l))}return Object.keys(s).forEach((function(t){var e=s[t];e.lines.forEach((function(t){e.index[t.number]=t}))})),s}function m(t){t._commandRef=f()}function _(t,e){var n=p();i(t+" in command "+(e||f())+("unknown"===n?"":" called from "+n))}function v(t,e,n,i){s(t,e)||_("invalid parameter type"+o(n)+". expected "+e+", got "+typeof t,i||f())}var b=33071,y={};function w(t,e){return 32820===t||32819===t||33635===t?2:34042===t?4:y[t]*e}function x(t){return!(t&t-1||!t)}y[5120]=y[5121]=1,y[5122]=y[5123]=y[36193]=y[33635]=y[32819]=y[32820]=2,y[5124]=y[5125]=y[5126]=y[34042]=4;var C=e(r,{optional:function(t){t()},raise:i,commandRaise:_,command:function(t,e,n){t||_(e,n||f())},parameter:function(t,e,n){t in e||i("unknown parameter ("+t+")"+o(n)+". possible values: "+Object.keys(e).join())},commandParameter:function(t,e,n,i){t in e||_("unknown parameter ("+t+")"+o(n)+". possible values: "+Object.keys(e).join(),i||f())},constructor:function(t){Object.keys(t).forEach((function(t){l.indexOf(t)<0&&i('invalid regl constructor argument "'+t+'". must be one of '+l)}))},type:function(t,e,n){s(t,e)||i("invalid parameter type"+o(n)+". expected "+e+", got "+typeof t)},commandType:v,isTypedArray:function(e,n){t(e)||i("invalid parameter type"+o(n)+". must be a typed array")},nni:function(t,e){t>=0&&(0|t)===t||i("invalid parameter type, ("+t+")"+o(e)+". must be a nonnegative integer")},oneOf:a,shaderError:function(t,e,i,o,s){if(!t.getShaderParameter(e,t.COMPILE_STATUS)){var a=t.getShaderInfoLog(e),l=o===t.FRAGMENT_SHADER?"fragment":"vertex";v(i,"string",l+" shader source must be a string",s);var u=g(i,s),h=function(t){var e=[];return t.split("\n").forEach((function(t){if(!(t.length<5)){var n=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(t);n?e.push(new d(0|n[1],0|n[2],n[3].trim())):t.length>0&&e.push(new d("unknown",0,t))}})),e}(a);(function(t,e){e.forEach((function(e){var n=t[e.file];if(n){var i=n.index[e.line];if(i)return i.errors.push(e),void(n.hasErrors=!0)}t.unknown.hasErrors=!0,t.unknown.lines[0].errors.push(e)}))})(u,h),Object.keys(u).forEach((function(t){var e=u[t];if(e.hasErrors){var i=[""],r=[""];o("file number "+t+": "+e.name+"\n","color:red;text-decoration:underline;font-weight:bold"),e.lines.forEach((function(t){if(t.errors.length>0){o(c(t.number,4)+"|  ","background-color:yellow; font-weight:bold"),o(t.line+n,"color:red; background-color:yellow; font-weight:bold");var e=0;t.errors.forEach((function(i){var r=i.message,s=/^\s*'(.*)'\s*:\s*(.*)$/.exec(r);if(s){var a=s[1];r=s[2],"assign"===a&&(a="="),e=Math.max(t.line.indexOf(a,e),0)}else e=0;o(c("| ",6)),o(c("^^^",e+3)+n,"font-weight:bold"),o(c("| ",6)),o(r+n,"font-weight:bold")})),o(c("| ",6)+n)}else o(c(t.number,4)+"|  "),o(t.line+n,"color:red")})),"undefined"==typeof document||window.chrome?console.log(i.join("")):(r[0]=i.join("%c"),console.log.apply(console,r))}function o(t,e){i.push(t),r.push(e||"")}})),r.raise("Error compiling "+l+" shader, "+u[0].name)}},linkError:function(t,e,i,o,s){if(!t.getProgramParameter(e,t.LINK_STATUS)){var a=t.getProgramInfoLog(e),l=g(i,s),c='Error linking program with vertex shader, "'+g(o,s)[0].name+'", and fragment shader "'+l[0].name+'"';"undefined"!=typeof document?console.log("%c"+c+"\n%c"+a,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(c+n+a),r.raise(c)}},callSite:p,saveCommandRef:m,saveDrawInfo:function(t,e,n,i){function r(t){return t?i.id(t):0}function o(t,e){Object.keys(e).forEach((function(e){t[i.id(e)]=!0}))}m(t),t._fragId=r(t.static.frag),t._vertId=r(t.static.vert);var s=t._uniformSet={};o(s,e.static),o(s,e.dynamic);var a=t._attributeSet={};o(a,n.static),o(a,n.dynamic),t._hasCount="count"in t.static||"count"in t.dynamic||"elements"in t.static||"elements"in t.dynamic},framebufferFormat:function(t,e,n){t.texture?a(t.texture._texture.internalformat,e,"unsupported texture format for attachment"):a(t.renderbuffer._renderbuffer.format,n,"unsupported renderbuffer format for attachment")},guessCommand:f,texture2D:function(t,e,n){var i,o=e.width,s=e.height,a=e.channels;r(o>0&&o<=n.maxTextureSize&&s>0&&s<=n.maxTextureSize,"invalid texture shape"),t.wrapS===b&&t.wrapT===b||r(x(o)&&x(s),"incompatible wrap mode for texture, both width and height must be power of 2"),1===e.mipmask?1!==o&&1!==s&&r(9984!==t.minFilter&&9986!==t.minFilter&&9985!==t.minFilter&&9987!==t.minFilter,"min filter requires mipmap"):(r(x(o)&&x(s),"texture must be a square power of 2 to support mipmapping"),r(e.mipmask===(o<<1)-1,"missing or incomplete mipmap data")),5126===e.type&&(n.extensions.indexOf("oes_texture_float_linear")<0&&r(9728===t.minFilter&&9728===t.magFilter,"filter not supported, must enable oes_texture_float_linear"),r(!t.genMipmaps,"mipmap generation not supported with float textures"));var l=e.images;for(i=0;i<16;++i)if(l[i]){var c=o>>i,u=s>>i;r(e.mipmask&1<<i,"missing mipmap data");var h=l[i];if(r(h.width===c&&h.height===u,"invalid shape for mip images"),r(h.format===e.format&&h.internalformat===e.internalformat&&h.type===e.type,"incompatible type for mip image"),h.compressed);else if(h.data){var d=Math.ceil(w(h.type,a)*c/h.unpackAlignment)*h.unpackAlignment;r(h.data.byteLength===d*u,"invalid data for image, buffer size is inconsistent with image format")}else h.element||h.copy}else t.genMipmaps||r(0==(e.mipmask&1<<i),"extra mipmap data");e.compressed&&r(!t.genMipmaps,"mipmap generation for compressed images not supported")},textureCube:function(t,e,n,i){var o=t.width,s=t.height,a=t.channels;r(o>0&&o<=i.maxTextureSize&&s>0&&s<=i.maxTextureSize,"invalid texture shape"),r(o===s,"cube map must be square"),r(e.wrapS===b&&e.wrapT===b,"wrap mode not supported by cube map");for(var l=0;l<n.length;++l){var c=n[l];r(c.width===o&&c.height===s,"inconsistent cube map face shape"),e.genMipmaps&&(r(!c.compressed,"can not generate mipmap for compressed textures"),r(1===c.mipmask,"can not specify mipmaps and generate mipmaps"));for(var u=c.images,h=0;h<16;++h){var d=u[h];if(d){var f=o>>h,p=s>>h;r(c.mipmask&1<<h,"missing mipmap data"),r(d.width===f&&d.height===p,"invalid shape for mip images"),r(d.format===t.format&&d.internalformat===t.internalformat&&d.type===t.type,"incompatible type for mip image"),d.compressed||(d.data?r(d.data.byteLength===f*p*Math.max(w(d.type,a),d.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):d.element||d.copy)}}}}}),k=0;function E(t,e){this.id=k++,this.type=t,this.data=e}function S(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function A(t){if(0===t.length)return[];var e=t.charAt(0),n=t.charAt(t.length-1);if(t.length>1&&e===n&&('"'===e||"'"===e))return['"'+S(t.substr(1,t.length-2))+'"'];var i=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(t);if(i)return A(t.substr(0,i.index)).concat(A(i[1])).concat(A(t.substr(i.index+i[0].length)));var r=t.split(".");if(1===r.length)return['"'+S(t)+'"'];for(var o=[],s=0;s<r.length;++s)o=o.concat(A(r[s]));return o}function T(t){return"["+A(t).join("][")+"]"}var M={DynamicVariable:E,define:function(t,e){return new E(t,T(e+""))},isDynamic:function(t){return"function"==typeof t&&!t._reglType||t instanceof E},unbox:function t(e,n){return"function"==typeof e?new E(0,e):"number"==typeof e||"boolean"==typeof e?new E(5,e):Array.isArray(e)?new E(6,e.map((function(e,i){return t(e,n+"["+i+"]")}))):e instanceof E?e:void C(!1,"invalid option type in uniform "+n)},accessor:T},D={next:"function"==typeof requestAnimationFrame?function(t){return requestAnimationFrame(t)}:function(t){return setTimeout(t,16)},cancel:"function"==typeof cancelAnimationFrame?function(t){return cancelAnimationFrame(t)}:clearTimeout},P="undefined"!=typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date};function L(t){return"string"==typeof t?t.split():(C(Array.isArray(t),"invalid extension array"),t)}function R(t){return"string"==typeof t?(C("undefined"!=typeof document,"not supported outside of DOM"),document.querySelector(t)):t}function I(t){var n,i,r,o,s,a=t||{},l={},c=[],u=[],h="undefined"==typeof window?1:window.devicePixelRatio,d=!1,f=function(t){t&&C.raise(t)},p=function(){};if("string"==typeof a?(C("undefined"!=typeof document,"selector queries only supported in DOM enviroments"),n=document.querySelector(a),C(n,"invalid query string for element")):"object"==typeof a?"string"==typeof(s=a).nodeName&&"function"==typeof s.appendChild&&"function"==typeof s.getBoundingClientRect?n=a:function(t){return"function"==typeof t.drawArrays||"function"==typeof t.drawElements}(a)?r=(o=a).canvas:(C.constructor(a),"gl"in a?o=a.gl:"canvas"in a?r=R(a.canvas):"container"in a&&(i=R(a.container)),"attributes"in a&&(l=a.attributes,C.type(l,"object","invalid context attributes")),"extensions"in a&&(c=L(a.extensions)),"optionalExtensions"in a&&(u=L(a.optionalExtensions)),"onDone"in a&&(C.type(a.onDone,"function","invalid or missing onDone callback"),f=a.onDone),"profile"in a&&(d=!!a.profile),"pixelRatio"in a&&(h=+a.pixelRatio,C(h>0,"invalid pixel ratio"))):C.raise("invalid arguments to regl"),n&&("canvas"===n.nodeName.toLowerCase()?r=n:i=n),!o){if(!r){C("undefined"!=typeof document,"must manually specify webgl context outside of DOM environments");var g=function(t,n,i){var r,o=document.createElement("canvas");function s(){var e=window.innerWidth,n=window.innerHeight;if(t!==document.body){var r=o.getBoundingClientRect();e=r.right-r.left,n=r.bottom-r.top}o.width=i*e,o.height=i*n}return e(o.style,{border:0,margin:0,padding:0,top:0,left:0,width:"100%",height:"100%"}),t.appendChild(o),t===document.body&&(o.style.position="absolute",e(t.style,{margin:0,padding:0})),t!==document.body&&"function"==typeof ResizeObserver?(r=new ResizeObserver((function(){setTimeout(s)}))).observe(t):window.addEventListener("resize",s,!1),s(),{canvas:o,onDestroy:function(){r?r.disconnect():window.removeEventListener("resize",s),t.removeChild(o)}}}(i||document.body,0,h);if(!g)return null;r=g.canvas,p=g.onDestroy}void 0===l.premultipliedAlpha&&(l.premultipliedAlpha=!0),o=function(t,e){function n(n){try{return t.getContext(n,e)}catch(t){return null}}return n("webgl")||n("experimental-webgl")||n("webgl-experimental")}(r,l)}return o?{gl:o,canvas:r,container:i,extensions:c,optionalExtensions:u,pixelRatio:h,profile:d,onDone:f,onDestroy:p}:(p(),f("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function O(t,e){for(var n=Array(t),i=0;i<t;++i)n[i]=e(i);return n}function z(t){var e,n;return e=(t>65535)<<4,e|=n=((t>>>=e)>255)<<3,e|=n=((t>>>=n)>15)<<2,(e|=n=((t>>>=n)>3)<<1)|(t>>>=n)>>1}function F(){var t=O(8,(function(){return[]}));function e(e){var n=function(t){for(var e=16;e<=1<<28;e*=16)if(t<=e)return e;return 0}(e),i=t[z(n)>>2];return i.length>0?i.pop():new ArrayBuffer(n)}function n(e){t[z(e.byteLength)>>2].push(e)}return{alloc:e,free:n,allocType:function(t,n){var i=null;switch(t){case 5120:i=new Int8Array(e(n),0,n);break;case 5121:i=new Uint8Array(e(n),0,n);break;case 5122:i=new Int16Array(e(2*n),0,n);break;case 5123:i=new Uint16Array(e(2*n),0,n);break;case 5124:i=new Int32Array(e(4*n),0,n);break;case 5125:i=new Uint32Array(e(4*n),0,n);break;case 5126:i=new Float32Array(e(4*n),0,n);break;default:return null}return i.length!==n?i.subarray(0,n):i},freeType:function(t){n(t.buffer)}}}var B=F();B.zero=F();var N=3553,j=6408,U=5126,V=36160;function W(e){return!!e&&"object"==typeof e&&Array.isArray(e.shape)&&Array.isArray(e.stride)&&"number"==typeof e.offset&&e.shape.length===e.stride.length&&(Array.isArray(e.data)||t(e.data))}var H=function(t){return Object.keys(t).map((function(e){return t[e]}))},$={shape:function(t){for(var e=[],n=t;n.length;n=n[0])e.push(n.length);return e},flatten:function(t,e,n,i){var r=1;if(e.length)for(var o=0;o<e.length;++o)r*=e[o];else r=0;var s=i||B.allocType(n,r);switch(e.length){case 0:break;case 1:!function(t,e,n){for(var i=0;i<e;++i)n[i]=t[i]}(t,e[0],s);break;case 2:!function(t,e,n,i){for(var r=0,o=0;o<e;++o)for(var s=t[o],a=0;a<n;++a)i[r++]=s[a]}(t,e[0],e[1],s);break;case 3:Z(t,e[0],e[1],e[2],s,0);break;default:q(t,e,0,s,0)}return s}};function Z(t,e,n,i,r,o){for(var s=o,a=0;a<e;++a)for(var l=t[a],c=0;c<n;++c)for(var u=l[c],h=0;h<i;++h)r[s++]=u[h]}function q(t,e,n,i,r){for(var o=1,s=n+1;s<e.length;++s)o*=e[s];var a=e[n];if(e.length-n==4){var l=e[n+1],c=e[n+2],u=e[n+3];for(s=0;s<a;++s)Z(t[s],l,c,u,i,r),r+=o}else for(s=0;s<a;++s)q(t[s],e,n+1,i,r),r+=o}var G={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},K={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,float:5126,float32:5126},X={dynamic:35048,stream:35040,static:35044},Y=$.flatten,Q=$.shape,J=5121,tt=5126,et=[];function nt(t){return 0|G[Object.prototype.toString.call(t)]}function it(t,e){for(var n=0;n<e.length;++n)t[n]=e[n]}function rt(t,e,n,i,r,o,s){for(var a=0,l=0;l<n;++l)for(var c=0;c<i;++c)t[a++]=e[r*l+o*c+s]}et[5120]=1,et[5122]=2,et[5124]=4,et[5121]=1,et[5123]=2,et[5125]=4,et[5126]=4;var ot={points:0,point:0,lines:1,line:1,triangles:4,triangle:4,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},st=5121,at=5123,lt=5125,ct=34963;var ut=new Float32Array(1),ht=new Uint32Array(ut.buffer);function dt(t){for(var e=B.allocType(5123,t.length),n=0;n<t.length;++n)if(isNaN(t[n]))e[n]=65535;else if(t[n]===1/0)e[n]=31744;else if(t[n]===-1/0)e[n]=64512;else{ut[0]=t[n];var i=ht[0],r=i>>>31<<15,o=(i<<1>>>24)-127,s=i>>13&1023;if(o<-24)e[n]=r;else if(o<-14){var a=-14-o;e[n]=r+(s+1024>>a)}else e[n]=o>15?r+31744:r+(o+15<<10)+s}return e}function ft(e){return Array.isArray(e)||t(e)}var pt=function(t){return!(t&t-1||!t)},gt=3553,mt=34067,_t=34069,vt=6408,bt=6406,yt=6407,wt=6409,xt=6410,Ct=32855,kt=6402,Et=34041,St=35904,At=35906,Tt=36193,Mt=33776,Dt=33777,Pt=33778,Lt=33779,Rt=5121,It=5123,Ot=5125,zt=5126,Ft=33071,Bt=9728,Nt=9984,jt=9987,Ut=4352,Vt=33984,Wt=[Nt,9986,9985,jt],Ht=[0,wt,xt,yt,vt],$t={};function Zt(t){return"[object "+t+"]"}$t[6409]=$t[6406]=$t[6402]=1,$t[34041]=$t[6410]=2,$t[6407]=$t[35904]=3,$t[6408]=$t[35906]=4;var qt=Zt("HTMLCanvasElement"),Gt=Zt("OffscreenCanvas"),Kt=Zt("CanvasRenderingContext2D"),Xt=Zt("ImageBitmap"),Yt=Zt("HTMLImageElement"),Qt=Zt("HTMLVideoElement"),Jt=Object.keys(G).concat([qt,Gt,Kt,Xt,Yt,Qt]),te=[];te[5121]=1,te[5126]=4,te[36193]=2,te[5123]=2,te[5125]=4;var ee=[];function ne(t){return Array.isArray(t)&&(0===t.length||"number"==typeof t[0])}function ie(t){return!!Array.isArray(t)&&!(0===t.length||!ft(t[0]))}function re(t){return Object.prototype.toString.call(t)}function oe(t){return re(t)===qt}function se(t){return re(t)===Gt}function ae(t){if(!t)return!1;var e=re(t);return Jt.indexOf(e)>=0||ne(t)||ie(t)||W(t)}function le(t){return 0|G[Object.prototype.toString.call(t)]}function ce(t,e){return B.allocType(t.type===Tt?zt:t.type,e)}function ue(t,e){t.type===Tt?(t.data=dt(e),B.freeType(e)):t.data=e}function he(t,e,n,i,r,o){var s;if(s=void 0!==ee[t]?ee[t]:$t[t]*te[e],o&&(s*=6),r){for(var a=0,l=n;l>=1;)a+=s*l*l,l/=2;return a}return s*n*i}function de(n,i,r,o,s,a,l){var c={"don't care":Ut,"dont care":Ut,nice:4354,fast:4353},u={repeat:10497,clamp:Ft,mirror:33648},h={nearest:Bt,linear:9729},d=e({mipmap:jt,"nearest mipmap nearest":Nt,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":jt},h),f={none:0,browser:37444},p={uint8:Rt,rgba4:32819,rgb565:33635,"rgb5 a1":32820},g={alpha:bt,luminance:wt,"luminance alpha":xt,rgb:yt,rgba:vt,rgba4:32854,"rgb5 a1":Ct,rgb565:36194},m={};i.ext_srgb&&(g.srgb=St,g.srgba=At),i.oes_texture_float&&(p.float32=p.float=zt),i.oes_texture_half_float&&(p.float16=p["half float"]=Tt),i.webgl_depth_texture&&(e(g,{depth:kt,"depth stencil":Et}),e(p,{uint16:It,uint32:Ot,"depth stencil":34042})),i.webgl_compressed_texture_s3tc&&e(m,{"rgb s3tc dxt1":Mt,"rgba s3tc dxt1":Dt,"rgba s3tc dxt3":Pt,"rgba s3tc dxt5":Lt}),i.webgl_compressed_texture_atc&&e(m,{"rgb atc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798}),i.webgl_compressed_texture_pvrtc&&e(m,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843}),i.webgl_compressed_texture_etc1&&(m["rgb etc1"]=36196);var _=Array.prototype.slice.call(n.getParameter(34467));Object.keys(m).forEach((function(t){var e=m[t];_.indexOf(e)>=0&&(g[t]=e)}));var v=Object.keys(g);r.textureFormats=v;var b=[];Object.keys(g).forEach((function(t){var e=g[t];b[e]=t}));var y=[];Object.keys(p).forEach((function(t){var e=p[t];y[e]=t}));var w=[];Object.keys(h).forEach((function(t){w[h[t]]=t}));var x=[];Object.keys(d).forEach((function(t){var e=d[t];x[e]=t}));var k=[];Object.keys(u).forEach((function(t){k[u[t]]=t}));var E=v.reduce((function(t,e){var n=g[e];return n===wt||n===bt||n===wt||n===xt||n===kt||n===Et||i.ext_srgb&&(n===St||n===At)?t[n]=n:n===Ct||e.indexOf("rgba")>=0?t[n]=vt:t[n]=yt,t}),{});function S(){this.internalformat=vt,this.format=vt,this.type=Rt,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=37444,this.width=0,this.height=0,this.channels=0}function A(t,e){t.internalformat=e.internalformat,t.format=e.format,t.type=e.type,t.compressed=e.compressed,t.premultiplyAlpha=e.premultiplyAlpha,t.flipY=e.flipY,t.unpackAlignment=e.unpackAlignment,t.colorSpace=e.colorSpace,t.width=e.width,t.height=e.height,t.channels=e.channels}function T(t,e){if("object"==typeof e&&e){if("premultiplyAlpha"in e&&(C.type(e.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),t.premultiplyAlpha=e.premultiplyAlpha),"flipY"in e&&(C.type(e.flipY,"boolean","invalid texture flip"),t.flipY=e.flipY),"alignment"in e&&(C.oneOf(e.alignment,[1,2,4,8],"invalid texture unpack alignment"),t.unpackAlignment=e.alignment),"colorSpace"in e&&(C.parameter(e.colorSpace,f,"invalid colorSpace"),t.colorSpace=f[e.colorSpace]),"type"in e){var n=e.type;C(i.oes_texture_float||!("float"===n||"float32"===n),"you must enable the OES_texture_float extension in order to use floating point textures."),C(i.oes_texture_half_float||!("half float"===n||"float16"===n),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),C(i.webgl_depth_texture||!("uint16"===n||"uint32"===n||"depth stencil"===n),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),C.parameter(n,p,"invalid texture type"),t.type=p[n]}var o=t.width,s=t.height,a=t.channels,l=!1;"shape"in e?(C(Array.isArray(e.shape)&&e.shape.length>=2,"shape must be an array"),o=e.shape[0],s=e.shape[1],3===e.shape.length&&(a=e.shape[2],C(a>0&&a<=4,"invalid number of channels"),l=!0),C(o>=0&&o<=r.maxTextureSize,"invalid width"),C(s>=0&&s<=r.maxTextureSize,"invalid height")):("radius"in e&&(o=s=e.radius,C(o>=0&&o<=r.maxTextureSize,"invalid radius")),"width"in e&&(o=e.width,C(o>=0&&o<=r.maxTextureSize,"invalid width")),"height"in e&&(s=e.height,C(s>=0&&s<=r.maxTextureSize,"invalid height")),"channels"in e&&(a=e.channels,C(a>0&&a<=4,"invalid number of channels"),l=!0)),t.width=0|o,t.height=0|s,t.channels=0|a;var c=!1;if("format"in e){var u=e.format;C(i.webgl_depth_texture||!("depth"===u||"depth stencil"===u),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),C.parameter(u,g,"invalid texture format");var h=t.internalformat=g[u];t.format=E[h],u in p&&("type"in e||(t.type=p[u])),u in m&&(t.compressed=!0),c=!0}!l&&c?t.channels=$t[t.format]:l&&!c?t.channels!==Ht[t.format]&&(t.format=t.internalformat=Ht[t.channels]):c&&l&&C(t.channels===$t[t.format],"number of channels inconsistent with specified format")}}function M(t){n.pixelStorei(37440,t.flipY),n.pixelStorei(37441,t.premultiplyAlpha),n.pixelStorei(37443,t.colorSpace),n.pixelStorei(3317,t.unpackAlignment)}function D(){S.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function P(e,n){var i=null;if(ae(n)?i=n:n&&(C.type(n,"object","invalid pixel data type"),T(e,n),"x"in n&&(e.xOffset=0|n.x),"y"in n&&(e.yOffset=0|n.y),ae(n.data)&&(i=n.data)),C(!e.compressed||i instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),n.copy){C(!i,"can not specify copy and data field for the same texture");var o=s.viewportWidth,a=s.viewportHeight;e.width=e.width||o-e.xOffset,e.height=e.height||a-e.yOffset,e.needsCopy=!0,C(e.xOffset>=0&&e.xOffset<o&&e.yOffset>=0&&e.yOffset<a&&e.width>0&&e.width<=o&&e.height>0&&e.height<=a,"copy texture read out of bounds")}else if(i){if(t(i))e.channels=e.channels||4,e.data=i,"type"in n||e.type!==Rt||(e.type=le(i));else if(ne(i))e.channels=e.channels||4,function(t,e){var n=e.length;switch(t.type){case Rt:case It:case Ot:case zt:var i=B.allocType(t.type,n);i.set(e),t.data=i;break;case Tt:t.data=dt(e);break;default:C.raise("unsupported texture type, must specify a typed array")}}(e,i),e.alignment=1,e.needsFree=!0;else if(W(i)){var l=i.data;Array.isArray(l)||e.type!==Rt||(e.type=le(l));var c,u,h,d,f,p,g=i.shape,m=i.stride;3===g.length?(h=g[2],p=m[2]):(C(2===g.length,"invalid ndarray pixel data, must be 2 or 3D"),h=1,p=1),c=g[0],u=g[1],d=m[0],f=m[1],e.alignment=1,e.width=c,e.height=u,e.channels=h,e.format=e.internalformat=Ht[h],e.needsFree=!0,function(t,e,n,i,r,o){for(var s=t.width,a=t.height,l=t.channels,c=ce(t,s*a*l),u=0,h=0;h<a;++h)for(var d=0;d<s;++d)for(var f=0;f<l;++f)c[u++]=e[n*d+i*h+r*f+o];ue(t,c)}(e,l,d,f,p,i.offset)}else if(oe(i)||se(i)||re(i)===Kt)oe(i)||se(i)?e.element=i:e.element=i.canvas,e.width=e.element.width,e.height=e.element.height,e.channels=4;else if(function(t){return re(t)===Xt}(i))e.element=i,e.width=i.width,e.height=i.height,e.channels=4;else if(function(t){return re(t)===Yt}(i))e.element=i,e.width=i.naturalWidth,e.height=i.naturalHeight,e.channels=4;else if(function(t){return re(t)===Qt}(i))e.element=i,e.width=i.videoWidth,e.height=i.videoHeight,e.channels=4;else if(ie(i)){var _=e.width||i[0].length,v=e.height||i.length,b=e.channels;b=ft(i[0][0])?b||i[0][0].length:b||1;for(var y=$.shape(i),w=1,x=0;x<y.length;++x)w*=y[x];var k=ce(e,w);$.flatten(i,y,"",k),ue(e,k),e.alignment=1,e.width=_,e.height=v,e.channels=b,e.format=e.internalformat=Ht[b],e.needsFree=!0}}else e.width=e.width||1,e.height=e.height||1,e.channels=e.channels||4;e.type===zt?C(r.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):e.type===Tt&&C(r.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function L(t,e,i){var r=t.element,s=t.data,a=t.internalformat,l=t.format,c=t.type,u=t.width,h=t.height;M(t),r?n.texImage2D(e,i,l,l,c,r):t.compressed?n.compressedTexImage2D(e,i,a,u,h,0,s):t.needsCopy?(o(),n.copyTexImage2D(e,i,l,t.xOffset,t.yOffset,u,h,0)):n.texImage2D(e,i,l,u,h,0,l,c,s||null)}function R(t,e,i,r,s){var a=t.element,l=t.data,c=t.internalformat,u=t.format,h=t.type,d=t.width,f=t.height;M(t),a?n.texSubImage2D(e,s,i,r,u,h,a):t.compressed?n.compressedTexSubImage2D(e,s,i,r,c,d,f,l):t.needsCopy?(o(),n.copyTexSubImage2D(e,s,i,r,t.xOffset,t.yOffset,d,f)):n.texSubImage2D(e,s,i,r,d,f,u,h,l)}var I=[];function O(){return I.pop()||new D}function z(t){t.needsFree&&B.freeType(t.data),D.call(t),I.push(t)}function F(){S.call(this),this.genMipmaps=!1,this.mipmapHint=Ut,this.mipmask=0,this.images=Array(16)}function N(t,e,n){var i=t.images[0]=O();t.mipmask=1,i.width=t.width=e,i.height=t.height=n,i.channels=t.channels=4}function j(t,e){var n=null;if(ae(e))A(n=t.images[0]=O(),t),P(n,e),t.mipmask=1;else if(T(t,e),Array.isArray(e.mipmap))for(var i=e.mipmap,r=0;r<i.length;++r)A(n=t.images[r]=O(),t),n.width>>=r,n.height>>=r,P(n,i[r]),t.mipmask|=1<<r;else A(n=t.images[0]=O(),t),P(n,e),t.mipmask=1;A(t,t.images[0]),!t.compressed||t.internalformat!==Mt&&t.internalformat!==Dt&&t.internalformat!==Pt&&t.internalformat!==Lt||C(t.width%4==0&&t.height%4==0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function U(t,e){for(var n=t.images,i=0;i<n.length;++i){if(!n[i])return;L(n[i],e,i)}}var V=[];function Z(){var t=V.pop()||new F;S.call(t),t.mipmask=0;for(var e=0;e<16;++e)t.images[e]=null;return t}function q(t){for(var e=t.images,n=0;n<e.length;++n)e[n]&&z(e[n]),e[n]=null;V.push(t)}function G(){this.minFilter=Bt,this.magFilter=Bt,this.wrapS=Ft,this.wrapT=Ft,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=Ut}function K(t,e){if("min"in e){var n=e.min;C.parameter(n,d),t.minFilter=d[n],Wt.indexOf(t.minFilter)>=0&&!("faces"in e)&&(t.genMipmaps=!0)}if("mag"in e){var i=e.mag;C.parameter(i,h),t.magFilter=h[i]}var o=t.wrapS,s=t.wrapT;if("wrap"in e){var a=e.wrap;"string"==typeof a?(C.parameter(a,u),o=s=u[a]):Array.isArray(a)&&(C.parameter(a[0],u),C.parameter(a[1],u),o=u[a[0]],s=u[a[1]])}else{if("wrapS"in e){var l=e.wrapS;C.parameter(l,u),o=u[l]}if("wrapT"in e){var f=e.wrapT;C.parameter(f,u),s=u[f]}}if(t.wrapS=o,t.wrapT=s,"anisotropic"in e){var p=e.anisotropic;C("number"==typeof p&&p>=1&&p<=r.maxAnisotropic,"aniso samples must be between 1 and "),t.anisotropic=e.anisotropic}if("mipmap"in e){var g=!1;switch(typeof e.mipmap){case"string":C.parameter(e.mipmap,c,"invalid mipmap hint"),t.mipmapHint=c[e.mipmap],t.genMipmaps=!0,g=!0;break;case"boolean":g=t.genMipmaps=e.mipmap;break;case"object":C(Array.isArray(e.mipmap),"invalid mipmap type"),t.genMipmaps=!1,g=!0;break;default:C.raise("invalid mipmap type")}g&&!("min"in e)&&(t.minFilter=Nt)}}function X(t,e){n.texParameteri(e,10241,t.minFilter),n.texParameteri(e,10240,t.magFilter),n.texParameteri(e,10242,t.wrapS),n.texParameteri(e,10243,t.wrapT),i.ext_texture_filter_anisotropic&&n.texParameteri(e,34046,t.anisotropic),t.genMipmaps&&(n.hint(33170,t.mipmapHint),n.generateMipmap(e))}var Y=0,Q={},J=r.maxTextureUnits,tt=Array(J).map((function(){return null}));function et(t){S.call(this),this.mipmask=0,this.internalformat=vt,this.id=Y++,this.refCount=1,this.target=t,this.texture=n.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new G,l.profile&&(this.stats={size:0})}function nt(t){n.activeTexture(Vt),n.bindTexture(t.target,t.texture)}function it(){var t=tt[0];t?n.bindTexture(t.target,t.texture):n.bindTexture(gt,null)}function rt(t){var e=t.texture;C(e,"must not double destroy texture");var i=t.unit,r=t.target;i>=0&&(n.activeTexture(Vt+i),n.bindTexture(r,null),tt[i]=null),n.deleteTexture(e),t.texture=null,t.params=null,t.pixels=null,t.refCount=0,delete Q[t.id],a.textureCount--}return e(et.prototype,{bind:function(){var t=this;t.bindCount+=1;var e=t.unit;if(e<0){for(var i=0;i<J;++i){var r=tt[i];if(r){if(r.bindCount>0)continue;r.unit=-1}tt[i]=t,e=i;break}e>=J&&C.raise("insufficient number of texture units"),l.profile&&a.maxTextureUnits<e+1&&(a.maxTextureUnits=e+1),t.unit=e,n.activeTexture(Vt+e),n.bindTexture(t.target,t.texture)}return e},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&rt(this)}}),l.profile&&(a.getTotalTextureSize=function(){var t=0;return Object.keys(Q).forEach((function(e){t+=Q[e].stats.size})),t}),{create2D:function(t,e){var i=new et(gt);function o(t,e){var n=i.texInfo;G.call(n);var s=Z();return"number"==typeof t?N(s,0|t,"number"==typeof e?0|e:0|t):t?(C.type(t,"object","invalid arguments to regl.texture"),K(n,t),j(s,t)):N(s,1,1),n.genMipmaps&&(s.mipmask=(s.width<<1)-1),i.mipmask=s.mipmask,A(i,s),C.texture2D(n,s,r),i.internalformat=s.internalformat,o.width=s.width,o.height=s.height,nt(i),U(s,gt),X(n,gt),it(),q(s),l.profile&&(i.stats.size=he(i.internalformat,i.type,s.width,s.height,n.genMipmaps,!1)),o.format=b[i.internalformat],o.type=y[i.type],o.mag=w[n.magFilter],o.min=x[n.minFilter],o.wrapS=k[n.wrapS],o.wrapT=k[n.wrapT],o}return Q[i.id]=i,a.textureCount++,o(t,e),o.subimage=function(t,e,n,r){C(!!t,"must specify image data");var s=0|e,a=0|n,l=0|r,c=O();return A(c,i),c.width=0,c.height=0,P(c,t),c.width=c.width||(i.width>>l)-s,c.height=c.height||(i.height>>l)-a,C(i.type===c.type&&i.format===c.format&&i.internalformat===c.internalformat,"incompatible format for texture.subimage"),C(s>=0&&a>=0&&s+c.width<=i.width&&a+c.height<=i.height,"texture.subimage write out of bounds"),C(i.mipmask&1<<l,"missing mipmap data"),C(c.data||c.element||c.needsCopy,"missing image data"),nt(i),R(c,gt,s,a,l),it(),z(c),o},o.resize=function(t,e){var r=0|t,s=0|e||r;if(r===i.width&&s===i.height)return o;o.width=i.width=r,o.height=i.height=s,nt(i);for(var a=0;i.mipmask>>a;++a){var c=r>>a,u=s>>a;if(!c||!u)break;n.texImage2D(gt,a,i.format,c,u,0,i.format,i.type,null)}return it(),l.profile&&(i.stats.size=he(i.internalformat,i.type,r,s,!1,!1)),o},o._reglType="texture2d",o._texture=i,l.profile&&(o.stats=i.stats),o.destroy=function(){i.decRef()},o},createCube:function(t,e,i,o,s,c){var u=new et(mt);Q[u.id]=u,a.cubeCount++;var h=new Array(6);function d(t,e,n,i,o,s){var a,c=u.texInfo;for(G.call(c),a=0;a<6;++a)h[a]=Z();if("number"!=typeof t&&t)if("object"==typeof t)if(e)j(h[0],t),j(h[1],e),j(h[2],n),j(h[3],i),j(h[4],o),j(h[5],s);else if(K(c,t),T(u,t),"faces"in t){var f=t.faces;for(C(Array.isArray(f)&&6===f.length,"cube faces must be a length 6 array"),a=0;a<6;++a)C("object"==typeof f[a]&&!!f[a],"invalid input for cube map face"),A(h[a],u),j(h[a],f[a])}else for(a=0;a<6;++a)j(h[a],t);else C.raise("invalid arguments to cube map");else{var p=0|t||1;for(a=0;a<6;++a)N(h[a],p,p)}for(A(u,h[0]),C.optional((function(){r.npotTextureCube||C(pt(u.width)&&pt(u.height),"your browser does not support non power or two texture dimensions")})),c.genMipmaps?u.mipmask=(h[0].width<<1)-1:u.mipmask=h[0].mipmask,C.textureCube(u,c,h,r),u.internalformat=h[0].internalformat,d.width=h[0].width,d.height=h[0].height,nt(u),a=0;a<6;++a)U(h[a],_t+a);for(X(c,mt),it(),l.profile&&(u.stats.size=he(u.internalformat,u.type,d.width,d.height,c.genMipmaps,!0)),d.format=b[u.internalformat],d.type=y[u.type],d.mag=w[c.magFilter],d.min=x[c.minFilter],d.wrapS=k[c.wrapS],d.wrapT=k[c.wrapT],a=0;a<6;++a)q(h[a]);return d}return d(t,e,i,o,s,c),d.subimage=function(t,e,n,i,r){C(!!e,"must specify image data"),C("number"==typeof t&&t===(0|t)&&t>=0&&t<6,"invalid face");var o=0|n,s=0|i,a=0|r,l=O();return A(l,u),l.width=0,l.height=0,P(l,e),l.width=l.width||(u.width>>a)-o,l.height=l.height||(u.height>>a)-s,C(u.type===l.type&&u.format===l.format&&u.internalformat===l.internalformat,"incompatible format for texture.subimage"),C(o>=0&&s>=0&&o+l.width<=u.width&&s+l.height<=u.height,"texture.subimage write out of bounds"),C(u.mipmask&1<<a,"missing mipmap data"),C(l.data||l.element||l.needsCopy,"missing image data"),nt(u),R(l,_t+t,o,s,a),it(),z(l),d},d.resize=function(t){var e=0|t;if(e!==u.width){d.width=u.width=e,d.height=u.height=e,nt(u);for(var i=0;i<6;++i)for(var r=0;u.mipmask>>r;++r)n.texImage2D(_t+i,r,u.format,e>>r,e>>r,0,u.format,u.type,null);return it(),l.profile&&(u.stats.size=he(u.internalformat,u.type,d.width,d.height,!1,!0)),d}},d._reglType="textureCube",d._texture=u,l.profile&&(d.stats=u.stats),d.destroy=function(){u.decRef()},d},clear:function(){for(var t=0;t<J;++t)n.activeTexture(Vt+t),n.bindTexture(gt,null),tt[t]=null;H(Q).forEach(rt),a.cubeCount=0,a.textureCount=0},getTexture:function(t){return null},restore:function(){for(var t=0;t<J;++t){var e=tt[t];e&&(e.bindCount=0,e.unit=-1,tt[t]=null)}H(Q).forEach((function(t){t.texture=n.createTexture(),n.bindTexture(t.target,t.texture);for(var e=0;e<32;++e)if(0!=(t.mipmask&1<<e))if(t.target===gt)n.texImage2D(gt,e,t.internalformat,t.width>>e,t.height>>e,0,t.internalformat,t.type,null);else for(var i=0;i<6;++i)n.texImage2D(_t+i,e,t.internalformat,t.width>>e,t.height>>e,0,t.internalformat,t.type,null);X(t.texInfo,t.target)}))},refresh:function(){for(var t=0;t<J;++t){var e=tt[t];e&&(e.bindCount=0,e.unit=-1,tt[t]=null),n.activeTexture(Vt+t),n.bindTexture(gt,null),n.bindTexture(mt,null)}}}}ee[32854]=2,ee[32855]=2,ee[36194]=2,ee[34041]=4,ee[33776]=.5,ee[33777]=.5,ee[33778]=1,ee[33779]=1,ee[35986]=.5,ee[35987]=1,ee[34798]=1,ee[35840]=.5,ee[35841]=.25,ee[35842]=.5,ee[35843]=.25,ee[36196]=.5;var fe=36161,pe=32854,ge=[];function me(t,e,n){return ge[t]*e*n}ge[32854]=2,ge[32855]=2,ge[36194]=2,ge[33189]=2,ge[36168]=1,ge[34041]=4,ge[35907]=4,ge[34836]=16,ge[34842]=8,ge[34843]=6;var _e=36160,ve=36161,be=3553,ye=34069,we=[6407,6408],xe=[];xe[6408]=4,xe[6407]=3;var Ce=[];Ce[5121]=1,Ce[5126]=4,Ce[36193]=2;var ke=[32854,32855,36194,35907,34842,34843,34836],Ee={};Ee[36053]="complete",Ee[36054]="incomplete attachment",Ee[36057]="incomplete dimensions",Ee[36055]="incomplete, missing attachment",Ee[36061]="unsupported";var Se=34963,Ae=["attributes","elements","offset","count","primitive","instances"];function Te(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=5126,this.offset=0,this.stride=0,this.divisor=0}var Me=5121,De=5126;function Pe(e,n,i,r,o,s,a){function l(l){var c;null===n.next?(C(o.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),c=Me):(C(null!==n.next.colorAttachments[0].texture,"You cannot read from a renderbuffer"),c=n.next.colorAttachments[0].texture._texture.type,C.optional((function(){s.oes_texture_float?(C(c===Me||c===De,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),c===De&&C(a.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):C(c===Me,"Reading from a framebuffer is only allowed for the type 'uint8'")})));var u=0,h=0,d=r.framebufferWidth,f=r.framebufferHeight,p=null;t(l)?p=l:l&&(C.type(l,"object","invalid arguments to regl.read()"),u=0|l.x,h=0|l.y,C(u>=0&&u<r.framebufferWidth,"invalid x offset for regl.read"),C(h>=0&&h<r.framebufferHeight,"invalid y offset for regl.read"),d=0|(l.width||r.framebufferWidth-u),f=0|(l.height||r.framebufferHeight-h),p=l.data||null),p&&(c===Me?C(p instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):c===De&&C(p instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),C(d>0&&d+u<=r.framebufferWidth,"invalid width for read pixels"),C(f>0&&f+h<=r.framebufferHeight,"invalid height for read pixels"),i();var g=d*f*4;return p||(c===Me?p=new Uint8Array(g):c===De&&(p=p||new Float32Array(g))),C.isTypedArray(p,"data buffer for regl.read() must be a typedarray"),C(p.byteLength>=g,"data buffer for regl.read() too small"),e.pixelStorei(3333,4),e.readPixels(u,h,d,f,6408,c,p),p}return function(t){return t&&"framebuffer"in t?function(t){var e;return n.setFBO({framebuffer:t.framebuffer},(function(){e=l(t)})),e}(t):l(t)}}function Le(t){return Array.prototype.slice.call(t)}function Re(t){return Le(t).join("")}var Ie="xyzw".split(""),Oe="dither",ze="blend.enable",Fe="blend.color",Be="blend.equation",Ne="blend.func",je="depth.enable",Ue="depth.func",Ve="depth.range",We="depth.mask",He="colorMask",$e="cull.enable",Ze="cull.face",qe="frontFace",Ge="lineWidth",Ke="polygonOffset.enable",Xe="polygonOffset.offset",Ye="sample.alpha",Qe="sample.enable",Je="sample.coverage",tn="stencil.enable",en="stencil.mask",nn="stencil.func",rn="stencil.opFront",on="stencil.opBack",sn="scissor.enable",an="scissor.box",ln="viewport",cn="profile",un="framebuffer",hn="vert",dn="frag",fn="elements",pn="primitive",gn="count",mn="offset",_n="instances",vn="vao",bn="Width",yn="Height",wn=un+bn,xn=un+yn,Cn="drawingBufferWidth",kn="drawingBufferHeight",En=[Ne,Be,nn,rn,on,Je,ln,an,Xe],Sn=34962,An=34963,Tn=5126,Mn=35664,Dn=35665,Pn=35666,Ln=5124,Rn=35667,In=35668,On=35669,zn=35670,Fn=35671,Bn=35672,Nn=35673,jn=35674,Un=35675,Vn=35676,Wn=35678,Hn=35680,$n=1028,Zn=1029,qn=2305,Gn=7680,Kn={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},Xn=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],Yn={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},Qn={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},Jn={frag:35632,vert:35633},ti={cw:2304,ccw:qn};function ei(e){return Array.isArray(e)||t(e)||W(e)}function ni(t){return t.sort((function(t,e){return t===ln?-1:e===ln?1:t<e?-1:1}))}function ii(t,e,n,i){this.thisDep=t,this.contextDep=e,this.propDep=n,this.append=i}function ri(t){return t&&!(t.thisDep||t.contextDep||t.propDep)}function oi(t){return new ii(!1,!1,!1,t)}function si(t,e){var n=t.type;if(0===n){var i=t.data.length;return new ii(!0,i>=1,i>=2,e)}if(4===n){var r=t.data;return new ii(r.thisDep,r.contextDep,r.propDep,e)}if(5===n)return new ii(!1,!1,!1,e);if(6===n){for(var o=!1,s=!1,a=!1,l=0;l<t.data.length;++l){var c=t.data[l];if(1===c.type)a=!0;else if(2===c.type)s=!0;else if(3===c.type)o=!0;else if(0===c.type){o=!0;var u=c.data;u>=1&&(s=!0),u>=2&&(a=!0)}else 4===c.type&&(o=o||c.data.thisDep,s=s||c.data.contextDep,a=a||c.data.propDep)}return new ii(o,s,a,e)}return new ii(3===n,2===n,1===n,e)}var ai=new ii(!1,!1,!1,(function(){}));function li(t,n,i,r,o,s,a,l,c,u,h,d,f,p,g){var m=u.Record,_={add:32774,subtract:32778,"reverse subtract":32779};i.ext_blend_minmax&&(_.min=32775,_.max=32776);var v=i.angle_instanced_arrays,b=i.webgl_draw_buffers,y=i.oes_vertex_array_object,w={dirty:!0,profile:g.profile},x={},k=[],E={},S={};function A(t){return t.replace(".","_")}function T(t,e,n){var i=A(t);k.push(t),x[i]=w[i]=!!n,E[i]=e}function D(t,e,n){var i=A(t);k.push(t),Array.isArray(n)?(w[i]=n.slice(),x[i]=n.slice()):w[i]=x[i]=n,S[i]=e}T(Oe,3024),T(ze,3042),D(Fe,"blendColor",[0,0,0,0]),D(Be,"blendEquationSeparate",[32774,32774]),D(Ne,"blendFuncSeparate",[1,0,1,0]),T(je,2929,!0),D(Ue,"depthFunc",513),D(Ve,"depthRange",[0,1]),D(We,"depthMask",!0),D(He,He,[!0,!0,!0,!0]),T($e,2884),D(Ze,"cullFace",Zn),D(qe,qe,qn),D(Ge,Ge,1),T(Ke,32823),D(Xe,"polygonOffset",[0,0]),T(Ye,32926),T(Qe,32928),D(Je,"sampleCoverage",[1,!1]),T(tn,2960),D(en,"stencilMask",-1),D(nn,"stencilFunc",[519,0,-1]),D(rn,"stencilOpSeparate",[$n,Gn,Gn,Gn]),D(on,"stencilOpSeparate",[Zn,Gn,Gn,Gn]),T(sn,3089),D(an,"scissor",[0,0,t.drawingBufferWidth,t.drawingBufferHeight]),D(ln,ln,[0,0,t.drawingBufferWidth,t.drawingBufferHeight]);var P={gl:t,context:f,strings:n,next:x,current:w,draw:d,elements:s,buffer:o,shader:h,attributes:u.state,vao:u,uniforms:c,framebuffer:l,extensions:i,timer:p,isBufferArgs:ei},L={primTypes:ot,compareFuncs:Yn,blendFuncs:Kn,blendEquations:_,stencilOps:Qn,glTypes:K,orientationType:ti};C.optional((function(){P.isArrayLike=ft})),b&&(L.backBuffer=[Zn],L.drawBuffer=O(r.maxDrawbuffers,(function(t){return 0===t?[0]:O(t,(function(t){return 36064+t}))})));var R=0;function I(){var t=function(){var t=0,n=[],i=[];function r(){var n=[],i=[];return e((function(){n.push.apply(n,Le(arguments))}),{def:function(){var e="v"+t++;return i.push(e),arguments.length>0&&(n.push(e,"="),n.push.apply(n,Le(arguments)),n.push(";")),e},toString:function(){return Re([i.length>0?"var "+i.join(",")+";":"",Re(n)])}})}function o(){var t=r(),n=r(),i=t.toString,o=n.toString;function s(e,i){n(e,i,"=",t.def(e,i),";")}return e((function(){t.apply(t,Le(arguments))}),{def:t.def,entry:t,exit:n,save:s,set:function(e,n,i){s(e,n),t(e,n,"=",i,";")},toString:function(){return i()+o()}})}var s=r(),a={};return{global:s,link:function(e){for(var r=0;r<i.length;++r)if(i[r]===e)return n[r];var o="g"+t++;return n.push(o),i.push(e),o},block:r,proc:function(t,n){var i=[];function r(){var t="a"+i.length;return i.push(t),t}n=n||0;for(var s=0;s<n;++s)r();var l=o(),c=l.toString;return a[t]=e(l,{arg:r,toString:function(){return Re(["function(",i.join(),"){",c(),"}"])}})},scope:o,cond:function(){var t=Re(arguments),n=o(),i=o(),r=n.toString,s=i.toString;return e(n,{then:function(){return n.apply(n,Le(arguments)),this},else:function(){return i.apply(i,Le(arguments)),this},toString:function(){var e=s();return e&&(e="else{"+e+"}"),Re(["if(",t,"){",r(),"}",e])}})},compile:function(){var t=['"use strict";',s,"return {"];Object.keys(a).forEach((function(e){t.push('"',e,'":',a[e].toString(),",")})),t.push("}");var e=Re(t).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return Function.apply(null,n.concat(e)).apply(null,i)}}}(),i=t.link,r=t.global;t.id=R++,t.batchId="0";var o=i(P),s=t.shared={props:"a0"};Object.keys(P).forEach((function(t){s[t]=r.def(o,".",t)})),C.optional((function(){t.CHECK=i(C),t.commandStr=C.guessCommand(),t.command=i(t.commandStr),t.assert=function(t,e,n){t("if(!(",e,"))",this.CHECK,".commandRaise(",i(n),",",this.command,");")},L.invalidBlendCombinations=Xn}));var a=t.next={},l=t.current={};Object.keys(S).forEach((function(t){Array.isArray(w[t])&&(a[t]=r.def(s.next,".",t),l[t]=r.def(s.current,".",t))}));var c=t.constants={};Object.keys(L).forEach((function(t){c[t]=r.def(JSON.stringify(L[t]))})),t.invoke=function(e,n){switch(n.type){case 0:var r=["this",s.context,s.props,t.batchId];return e.def(i(n.data),".call(",r.slice(0,Math.max(n.data.length+1,4)),")");case 1:return e.def(s.props,n.data);case 2:return e.def(s.context,n.data);case 3:return e.def("this",n.data);case 4:return n.data.append(t,e),n.data.ref;case 5:return n.data.toString();case 6:return n.data.map((function(n){return t.invoke(e,n)}))}},t.attribCache={};var h={};return t.scopeAttrib=function(t){var e=n.id(t);if(e in h)return h[e];var r=u.scope[e];return r||(r=u.scope[e]=new m),h[e]=i(r)},t}function z(t,e,a,c,d){var f=t.static,p=t.dynamic;C.optional((function(){var t=[un,hn,dn,fn,pn,mn,gn,_n,cn,vn].concat(k);function e(e){Object.keys(e).forEach((function(e){C.command(t.indexOf(e)>=0,'unknown parameter "'+e+'"',d.commandStr)}))}e(f),e(p)}));var g=function(t,e){var n=t.static;if("string"==typeof n[dn]&&"string"==typeof n[hn]){if(Object.keys(e.dynamic).length>0)return null;var i=e.static,r=Object.keys(i);if(r.length>0&&"number"==typeof i[r[0]]){for(var o=[],s=0;s<r.length;++s)C("number"==typeof i[r[s]],"must specify all vertex attribute locations when using vaos"),o.push([0|i[r[s]],r[s]]);return o}}return null}(t,e),b=function(t,e){var n=t.static,i=t.dynamic;if(un in n){var r=n[un];return r?(r=l.getFramebuffer(r),C.command(r,"invalid framebuffer object"),oi((function(t,e){var n=t.link(r),i=t.shared;e.set(i.framebuffer,".next",n);var o=i.context;return e.set(o,"."+wn,n+".width"),e.set(o,"."+xn,n+".height"),n}))):oi((function(t,e){var n=t.shared;e.set(n.framebuffer,".next","null");var i=n.context;return e.set(i,"."+wn,i+"."+Cn),e.set(i,"."+xn,i+"."+kn),"null"}))}if(un in i){var o=i[un];return si(o,(function(t,e){var n=t.invoke(e,o),i=t.shared,r=i.framebuffer,s=e.def(r,".getFramebuffer(",n,")");C.optional((function(){t.assert(e,"!"+n+"||"+s,"invalid framebuffer object")})),e.set(r,".next",s);var a=i.context;return e.set(a,"."+wn,s+"?"+s+".width:"+a+"."+Cn),e.set(a,"."+xn,s+"?"+s+".height:"+a+"."+kn),s}))}return null}(t),y=function(t,e,n){var i=t.static,r=t.dynamic;function o(t){if(t in i){var o=i[t];C.commandType(o,"object","invalid "+t,n.commandStr);var s,a,l=!0,c=0|o.x,u=0|o.y;return"width"in o?(s=0|o.width,C.command(s>=0,"invalid "+t,n.commandStr)):l=!1,"height"in o?(a=0|o.height,C.command(a>=0,"invalid "+t,n.commandStr)):l=!1,new ii(!l&&e&&e.thisDep,!l&&e&&e.contextDep,!l&&e&&e.propDep,(function(t,e){var n=t.shared.context,i=s;"width"in o||(i=e.def(n,".",wn,"-",c));var r=a;return"height"in o||(r=e.def(n,".",xn,"-",u)),[c,u,i,r]}))}if(t in r){var h=r[t],d=si(h,(function(e,n){var i=e.invoke(n,h);C.optional((function(){e.assert(n,i+"&&typeof "+i+'==="object"',"invalid "+t)}));var r=e.shared.context,o=n.def(i,".x|0"),s=n.def(i,".y|0"),a=n.def('"width" in ',i,"?",i,".width|0:","(",r,".",wn,"-",o,")"),l=n.def('"height" in ',i,"?",i,".height|0:","(",r,".",xn,"-",s,")");return C.optional((function(){e.assert(n,a+">=0&&"+l+">=0","invalid "+t)})),[o,s,a,l]}));return e&&(d.thisDep=d.thisDep||e.thisDep,d.contextDep=d.contextDep||e.contextDep,d.propDep=d.propDep||e.propDep),d}return e?new ii(e.thisDep,e.contextDep,e.propDep,(function(t,e){var n=t.shared.context;return[0,0,e.def(n,".",wn),e.def(n,".",xn)]})):null}var s=o(ln);if(s){var a=s;s=new ii(s.thisDep,s.contextDep,s.propDep,(function(t,e){var n=a.append(t,e),i=t.shared.context;return e.set(i,".viewportWidth",n[2]),e.set(i,".viewportHeight",n[3]),n}))}return{viewport:s,scissor_box:o(an)}}(t,b,d),w=function(t,e){var n=t.static,i=t.dynamic,r={},o=!1,a=function(){if(vn in n){var t=n[vn];return null!==t&&null===u.getVAO(t)&&(t=u.createVAO(t)),o=!0,r.vao=t,oi((function(e){var n=u.getVAO(t);return n?e.link(n):"null"}))}if(vn in i){o=!0;var e=i[vn];return si(e,(function(t,n){var i=t.invoke(n,e);return n.def(t.shared.vao+".getVAO("+i+")")}))}return null}(),l=!1,c=function(){if(fn in n){var t=n[fn];if(r.elements=t,ei(t)){var c=r.elements=s.create(t,!0);t=s.getElements(c),l=!0}else t&&(t=s.getElements(t),l=!0,C.command(t,"invalid elements",e.commandStr));var u=oi((function(e,n){if(t){var i=e.link(t);return e.ELEMENTS=i,i}return e.ELEMENTS=null,null}));return u.value=t,u}if(fn in i){l=!0;var h=i[fn];return si(h,(function(t,e){var n=t.shared,i=n.isBufferArgs,r=n.elements,o=t.invoke(e,h),s=e.def("null"),a=e.def(i,"(",o,")"),l=t.cond(a).then(s,"=",r,".createStream(",o,");").else(s,"=",r,".getElements(",o,");");return C.optional((function(){t.assert(l.else,"!"+o+"||"+s,"invalid elements")})),e.entry(l),e.exit(t.cond(a).then(r,".destroyStream(",s,");")),t.ELEMENTS=s,s}))}return o?new ii(a.thisDep,a.contextDep,a.propDep,(function(t,e){return e.def(t.shared.vao+".currentVAO?"+t.shared.elements+".getElements("+t.shared.vao+".currentVAO.elements):null")})):null}();function h(t,s){if(t in n){var c=0|n[t];return s?r.offset=c:r.instances=c,C.command(!s||c>=0,"invalid "+t,e.commandStr),oi((function(t,e){return s&&(t.OFFSET=c),c}))}if(t in i){var u=i[t];return si(u,(function(e,n){var i=e.invoke(n,u);return s&&(e.OFFSET=i,C.optional((function(){e.assert(n,i+">=0","invalid "+t)}))),i}))}if(s){if(l)return oi((function(t,e){return t.OFFSET=0,0}));if(o)return new ii(a.thisDep,a.contextDep,a.propDep,(function(t,e){return e.def(t.shared.vao+".currentVAO?"+t.shared.vao+".currentVAO.offset:0")}))}else if(o)return new ii(a.thisDep,a.contextDep,a.propDep,(function(t,e){return e.def(t.shared.vao+".currentVAO?"+t.shared.vao+".currentVAO.instances:-1")}));return null}var d=h(mn,!0),f=function(){if(pn in n){var t=n[pn];return r.primitive=t,C.commandParameter(t,ot,"invalid primitve",e.commandStr),oi((function(e,n){return ot[t]}))}if(pn in i){var s=i[pn];return si(s,(function(t,e){var n=t.constants.primTypes,i=t.invoke(e,s);return C.optional((function(){t.assert(e,i+" in "+n,"invalid primitive, must be one of "+Object.keys(ot))})),e.def(n,"[",i,"]")}))}return l?ri(c)?c.value?oi((function(t,e){return e.def(t.ELEMENTS,".primType")})):oi((function(){return 4})):new ii(c.thisDep,c.contextDep,c.propDep,(function(t,e){var n=t.ELEMENTS;return e.def(n,"?",n,".primType:",4)})):o?new ii(a.thisDep,a.contextDep,a.propDep,(function(t,e){return e.def(t.shared.vao+".currentVAO?"+t.shared.vao+".currentVAO.primitive:4")})):null}(),p=function(){if(gn in n){var t=0|n[gn];return r.count=t,C.command("number"==typeof t&&t>=0,"invalid vertex count",e.commandStr),oi((function(){return t}))}if(gn in i){var s=i[gn];return si(s,(function(t,e){var n=t.invoke(e,s);return C.optional((function(){t.assert(e,"typeof "+n+'==="number"&&'+n+">=0&&"+n+"===("+n+"|0)","invalid vertex count")})),n}))}if(l){if(ri(c)){if(c)return d?new ii(d.thisDep,d.contextDep,d.propDep,(function(t,e){var n=e.def(t.ELEMENTS,".vertCount-",t.OFFSET);return C.optional((function(){t.assert(e,n+">=0","invalid vertex offset/element buffer too small")})),n})):oi((function(t,e){return e.def(t.ELEMENTS,".vertCount")}));var u=oi((function(){return-1}));return C.optional((function(){u.MISSING=!0})),u}var h=new ii(c.thisDep||d.thisDep,c.contextDep||d.contextDep,c.propDep||d.propDep,(function(t,e){var n=t.ELEMENTS;return t.OFFSET?e.def(n,"?",n,".vertCount-",t.OFFSET,":-1"):e.def(n,"?",n,".vertCount:-1")}));return C.optional((function(){h.DYNAMIC=!0})),h}if(o){var f=new ii(a.thisDep,a.contextDep,a.propDep,(function(t,e){return e.def(t.shared.vao,".currentVAO?",t.shared.vao,".currentVAO.count:-1")}));return f}return null}(),g=h(_n,!1);return{elements:c,primitive:f,count:p,instances:g,offset:d,vao:a,vaoActive:o,elementsActive:l,static:r}}(t,d),x=function(t,e){var n=t.static,i=t.dynamic,o={};return k.forEach((function(t){var s=A(t);function a(e,r){if(t in n){var a=e(n[t]);o[s]=oi((function(){return a}))}else if(t in i){var l=i[t];o[s]=si(l,(function(t,e){return r(t,e,t.invoke(e,l))}))}}switch(t){case $e:case ze:case Oe:case tn:case je:case sn:case Ke:case Ye:case Qe:case We:return a((function(n){return C.commandType(n,"boolean",t,e.commandStr),n}),(function(e,n,i){return C.optional((function(){e.assert(n,"typeof "+i+'==="boolean"',"invalid flag "+t,e.commandStr)})),i}));case Ue:return a((function(n){return C.commandParameter(n,Yn,"invalid "+t,e.commandStr),Yn[n]}),(function(e,n,i){var r=e.constants.compareFuncs;return C.optional((function(){e.assert(n,i+" in "+r,"invalid "+t+", must be one of "+Object.keys(Yn))})),n.def(r,"[",i,"]")}));case Ve:return a((function(t){return C.command(ft(t)&&2===t.length&&"number"==typeof t[0]&&"number"==typeof t[1]&&t[0]<=t[1],"depth range is 2d array",e.commandStr),t}),(function(t,e,n){return C.optional((function(){t.assert(e,t.shared.isArrayLike+"("+n+")&&"+n+".length===2&&typeof "+n+'[0]==="number"&&typeof '+n+'[1]==="number"&&'+n+"[0]<="+n+"[1]","depth range must be a 2d array")})),[e.def("+",n,"[0]"),e.def("+",n,"[1]")]}));case Ne:return a((function(t){C.commandType(t,"object","blend.func",e.commandStr);var n="srcRGB"in t?t.srcRGB:t.src,i="srcAlpha"in t?t.srcAlpha:t.src,r="dstRGB"in t?t.dstRGB:t.dst,o="dstAlpha"in t?t.dstAlpha:t.dst;return C.commandParameter(n,Kn,s+".srcRGB",e.commandStr),C.commandParameter(i,Kn,s+".srcAlpha",e.commandStr),C.commandParameter(r,Kn,s+".dstRGB",e.commandStr),C.commandParameter(o,Kn,s+".dstAlpha",e.commandStr),C.command(-1===Xn.indexOf(n+", "+r),"unallowed blending combination (srcRGB, dstRGB) = ("+n+", "+r+")",e.commandStr),[Kn[n],Kn[r],Kn[i],Kn[o]]}),(function(e,n,i){var r=e.constants.blendFuncs;function o(o,s){var a=n.def('"',o,s,'" in ',i,"?",i,".",o,s,":",i,".",o);return C.optional((function(){e.assert(n,a+" in "+r,"invalid "+t+"."+o+s+", must be one of "+Object.keys(Kn))})),a}C.optional((function(){e.assert(n,i+"&&typeof "+i+'==="object"',"invalid blend func, must be an object")}));var s=o("src","RGB"),a=o("dst","RGB");C.optional((function(){var t=e.constants.invalidBlendCombinations;e.assert(n,t+".indexOf("+s+'+", "+'+a+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")}));var l=n.def(r,"[",s,"]"),c=n.def(r,"[",o("src","Alpha"),"]");return[l,n.def(r,"[",a,"]"),c,n.def(r,"[",o("dst","Alpha"),"]")]}));case Be:return a((function(n){return"string"==typeof n?(C.commandParameter(n,_,"invalid "+t,e.commandStr),[_[n],_[n]]):"object"==typeof n?(C.commandParameter(n.rgb,_,t+".rgb",e.commandStr),C.commandParameter(n.alpha,_,t+".alpha",e.commandStr),[_[n.rgb],_[n.alpha]]):void C.commandRaise("invalid blend.equation",e.commandStr)}),(function(e,n,i){var r=e.constants.blendEquations,o=n.def(),s=n.def(),a=e.cond("typeof ",i,'==="string"');return C.optional((function(){function n(t,n,i){e.assert(t,i+" in "+r,"invalid "+n+", must be one of "+Object.keys(_))}n(a.then,t,i),e.assert(a.else,i+"&&typeof "+i+'==="object"',"invalid "+t),n(a.else,t+".rgb",i+".rgb"),n(a.else,t+".alpha",i+".alpha")})),a.then(o,"=",s,"=",r,"[",i,"];"),a.else(o,"=",r,"[",i,".rgb];",s,"=",r,"[",i,".alpha];"),n(a),[o,s]}));case Fe:return a((function(t){return C.command(ft(t)&&4===t.length,"blend.color must be a 4d array",e.commandStr),O(4,(function(e){return+t[e]}))}),(function(t,e,n){return C.optional((function(){t.assert(e,t.shared.isArrayLike+"("+n+")&&"+n+".length===4","blend.color must be a 4d array")})),O(4,(function(t){return e.def("+",n,"[",t,"]")}))}));case en:return a((function(t){return C.commandType(t,"number",s,e.commandStr),0|t}),(function(t,e,n){return C.optional((function(){t.assert(e,"typeof "+n+'==="number"',"invalid stencil.mask")})),e.def(n,"|0")}));case nn:return a((function(n){C.commandType(n,"object",s,e.commandStr);var i=n.cmp||"keep",r=n.ref||0,o="mask"in n?n.mask:-1;return C.commandParameter(i,Yn,t+".cmp",e.commandStr),C.commandType(r,"number",t+".ref",e.commandStr),C.commandType(o,"number",t+".mask",e.commandStr),[Yn[i],r,o]}),(function(t,e,n){var i=t.constants.compareFuncs;return C.optional((function(){function r(){t.assert(e,Array.prototype.join.call(arguments,""),"invalid stencil.func")}r(n+"&&typeof ",n,'==="object"'),r('!("cmp" in ',n,")||(",n,".cmp in ",i,")")})),[e.def('"cmp" in ',n,"?",i,"[",n,".cmp]",":",Gn),e.def(n,".ref|0"),e.def('"mask" in ',n,"?",n,".mask|0:-1")]}));case rn:case on:return a((function(n){C.commandType(n,"object",s,e.commandStr);var i=n.fail||"keep",r=n.zfail||"keep",o=n.zpass||"keep";return C.commandParameter(i,Qn,t+".fail",e.commandStr),C.commandParameter(r,Qn,t+".zfail",e.commandStr),C.commandParameter(o,Qn,t+".zpass",e.commandStr),[t===on?Zn:$n,Qn[i],Qn[r],Qn[o]]}),(function(e,n,i){var r=e.constants.stencilOps;function o(o){return C.optional((function(){e.assert(n,'!("'+o+'" in '+i+")||("+i+"."+o+" in "+r+")","invalid "+t+"."+o+", must be one of "+Object.keys(Qn))})),n.def('"',o,'" in ',i,"?",r,"[",i,".",o,"]:",Gn)}return C.optional((function(){e.assert(n,i+"&&typeof "+i+'==="object"',"invalid "+t)})),[t===on?Zn:$n,o("fail"),o("zfail"),o("zpass")]}));case Xe:return a((function(t){C.commandType(t,"object",s,e.commandStr);var n=0|t.factor,i=0|t.units;return C.commandType(n,"number",s+".factor",e.commandStr),C.commandType(i,"number",s+".units",e.commandStr),[n,i]}),(function(e,n,i){return C.optional((function(){e.assert(n,i+"&&typeof "+i+'==="object"',"invalid "+t)})),[n.def(i,".factor|0"),n.def(i,".units|0")]}));case Ze:return a((function(t){var n=0;return"front"===t?n=$n:"back"===t&&(n=Zn),C.command(!!n,s,e.commandStr),n}),(function(t,e,n){return C.optional((function(){t.assert(e,n+'==="front"||'+n+'==="back"',"invalid cull.face")})),e.def(n,'==="front"?',$n,":",Zn)}));case Ge:return a((function(t){return C.command("number"==typeof t&&t>=r.lineWidthDims[0]&&t<=r.lineWidthDims[1],"invalid line width, must be a positive number between "+r.lineWidthDims[0]+" and "+r.lineWidthDims[1],e.commandStr),t}),(function(t,e,n){return C.optional((function(){t.assert(e,"typeof "+n+'==="number"&&'+n+">="+r.lineWidthDims[0]+"&&"+n+"<="+r.lineWidthDims[1],"invalid line width")})),n}));case qe:return a((function(t){return C.commandParameter(t,ti,s,e.commandStr),ti[t]}),(function(t,e,n){return C.optional((function(){t.assert(e,n+'==="cw"||'+n+'==="ccw"',"invalid frontFace, must be one of cw,ccw")})),e.def(n+'==="cw"?2304:'+qn)}));case He:return a((function(t){return C.command(ft(t)&&4===t.length,"color.mask must be length 4 array",e.commandStr),t.map((function(t){return!!t}))}),(function(t,e,n){return C.optional((function(){t.assert(e,t.shared.isArrayLike+"("+n+")&&"+n+".length===4","invalid color.mask")})),O(4,(function(t){return"!!"+n+"["+t+"]"}))}));case Je:return a((function(t){C.command("object"==typeof t&&t,s,e.commandStr);var n="value"in t?t.value:1,i=!!t.invert;return C.command("number"==typeof n&&n>=0&&n<=1,"sample.coverage.value must be a number between 0 and 1",e.commandStr),[n,i]}),(function(t,e,n){return C.optional((function(){t.assert(e,n+"&&typeof "+n+'==="object"',"invalid sample.coverage")})),[e.def('"value" in ',n,"?+",n,".value:1"),e.def("!!",n,".invert")]}))}})),o}(t,d),E=function(t,e,i){var r=t.static,o=t.dynamic;function s(t){if(t in r){var e=n.id(r[t]);C.optional((function(){h.shader(Jn[t],e,C.guessCommand())}));var i=oi((function(){return e}));return i.id=e,i}if(t in o){var s=o[t];return si(s,(function(e,n){var i=e.invoke(n,s),r=n.def(e.shared.strings,".id(",i,")");return C.optional((function(){n(e.shared.shader,".shader(",Jn[t],",",r,",",e.command,");")})),r}))}return null}var a,l=s(dn),c=s(hn),u=null;return ri(l)&&ri(c)?(u=h.program(c.id,l.id,null,i),a=oi((function(t,e){return t.link(u)}))):a=new ii(l&&l.thisDep||c&&c.thisDep,l&&l.contextDep||c&&c.contextDep,l&&l.propDep||c&&c.propDep,(function(t,e){var n,i=t.shared.shader;n=l?l.append(t,e):e.def(i,".",dn);var r=i+".program("+(c?c.append(t,e):e.def(i,".",hn))+","+n;return C.optional((function(){r+=","+t.command})),e.def(r+")")})),{frag:l,vert:c,progVar:a,program:u}}(t,0,g);function S(t){var e=y[t];e&&(x[t]=e)}S(ln),S(A(an));var T=Object.keys(x).length>0,M={framebuffer:b,draw:w,shader:E,state:x,dirty:T,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(M.profile=function(t){var e,n=t.static,i=t.dynamic;if(cn in n){var r=!!n[cn];(e=oi((function(t,e){return r}))).enable=r}else if(cn in i){var o=i[cn];e=si(o,(function(t,e){return t.invoke(e,o)}))}return e}(t),M.uniforms=function(t,e){var n=t.static,i=t.dynamic,r={};return Object.keys(n).forEach((function(t){var i,o=n[t];if("number"==typeof o||"boolean"==typeof o)i=oi((function(){return o}));else if("function"==typeof o){var s=o._reglType;"texture2d"===s||"textureCube"===s?i=oi((function(t){return t.link(o)})):"framebuffer"===s||"framebufferCube"===s?(C.command(o.color.length>0,'missing color attachment for framebuffer sent to uniform "'+t+'"',e.commandStr),i=oi((function(t){return t.link(o.color[0])}))):C.commandRaise('invalid data for uniform "'+t+'"',e.commandStr)}else ft(o)?i=oi((function(e){return e.global.def("[",O(o.length,(function(n){return C.command("number"==typeof o[n]||"boolean"==typeof o[n],"invalid uniform "+t,e.commandStr),o[n]})),"]")})):C.commandRaise('invalid or missing data for uniform "'+t+'"',e.commandStr);i.value=o,r[t]=i})),Object.keys(i).forEach((function(t){var e=i[t];r[t]=si(e,(function(t,n){return t.invoke(n,e)}))})),r}(a,d),M.drawVAO=M.scopeVAO=w.vao,!M.drawVAO&&E.program&&!g&&i.angle_instanced_arrays&&w.static.elements){var D=!0,P=E.program.attributes.map((function(t){var n=e.static[t];return D=D&&!!n,n}));if(D&&P.length>0){var L=u.getVAO(u.createVAO({attributes:P,elements:w.static.elements}));M.drawVAO=new ii(null,null,null,(function(t,e){return t.link(L)})),M.useVAO=!0}}return g?M.useVAO=!0:M.attributes=function(t,e){var i=t.static,r=t.dynamic,s={};return Object.keys(i).forEach((function(t){var r=i[t],a=n.id(t),l=new m;if(ei(r))l.state=1,l.buffer=o.getBuffer(o.create(r,Sn,!1,!0)),l.type=0;else{var c=o.getBuffer(r);if(c)l.state=1,l.buffer=c,l.type=0;else if(C.command("object"==typeof r&&r,"invalid data for attribute "+t,e.commandStr),"constant"in r){var u=r.constant;l.buffer="null",l.state=2,"number"==typeof u?l.x=u:(C.command(ft(u)&&u.length>0&&u.length<=4,"invalid constant for attribute "+t,e.commandStr),Ie.forEach((function(t,e){e<u.length&&(l[t]=u[e])})))}else{c=ei(r.buffer)?o.getBuffer(o.create(r.buffer,Sn,!1,!0)):o.getBuffer(r.buffer),C.command(!!c,'missing buffer for attribute "'+t+'"',e.commandStr);var h=0|r.offset;C.command(h>=0,'invalid offset for attribute "'+t+'"',e.commandStr);var d=0|r.stride;C.command(d>=0&&d<256,'invalid stride for attribute "'+t+'", must be integer betweeen [0, 255]',e.commandStr);var f=0|r.size;C.command(!("size"in r)||f>0&&f<=4,'invalid size for attribute "'+t+'", must be 1,2,3,4',e.commandStr);var p=!!r.normalized,g=0;"type"in r&&(C.commandParameter(r.type,K,"invalid type for attribute "+t,e.commandStr),g=K[r.type]);var _=0|r.divisor;C.optional((function(){"divisor"in r&&(C.command(0===_||v,'cannot specify divisor for attribute "'+t+'", instancing not supported',e.commandStr),C.command(_>=0,'invalid divisor for attribute "'+t+'"',e.commandStr));var n=e.commandStr,i=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(r).forEach((function(e){C.command(i.indexOf(e)>=0,'unknown parameter "'+e+'" for attribute pointer "'+t+'" (valid parameters are '+i+")",n)}))})),l.buffer=c,l.state=1,l.size=f,l.normalized=p,l.type=g||c.dtype,l.offset=h,l.stride=d,l.divisor=_}}s[t]=oi((function(t,e){var n=t.attribCache;if(a in n)return n[a];var i={isStream:!1};return Object.keys(l).forEach((function(t){i[t]=l[t]})),l.buffer&&(i.buffer=t.link(l.buffer),i.type=i.type||i.buffer+".dtype"),n[a]=i,i}))})),Object.keys(r).forEach((function(t){var e=r[t];s[t]=si(e,(function(n,i){var r=n.invoke(i,e),o=n.shared,s=n.constants,a=o.isBufferArgs,l=o.buffer;C.optional((function(){n.assert(i,r+"&&(typeof "+r+'==="object"||typeof '+r+'==="function")&&('+a+"("+r+")||"+l+".getBuffer("+r+")||"+l+".getBuffer("+r+".buffer)||"+a+"("+r+'.buffer)||("constant" in '+r+"&&(typeof "+r+'.constant==="number"||'+o.isArrayLike+"("+r+".constant))))",'invalid dynamic attribute "'+t+'"')}));var c={isStream:i.def(!1)},u=new m;u.state=1,Object.keys(u).forEach((function(t){c[t]=i.def(""+u[t])}));var h=c.buffer,d=c.type;function f(t){i(c[t],"=",r,".",t,"|0;")}return i("if(",a,"(",r,")){",c.isStream,"=true;",h,"=",l,".createStream(",Sn,",",r,");",d,"=",h,".dtype;","}else{",h,"=",l,".getBuffer(",r,");","if(",h,"){",d,"=",h,".dtype;",'}else if("constant" in ',r,"){",c.state,"=",2,";","if(typeof "+r+'.constant === "number"){',c[Ie[0]],"=",r,".constant;",Ie.slice(1).map((function(t){return c[t]})).join("="),"=0;","}else{",Ie.map((function(t,e){return c[t]+"="+r+".constant.length>"+e+"?"+r+".constant["+e+"]:0;"})).join(""),"}}else{","if(",a,"(",r,".buffer)){",h,"=",l,".createStream(",Sn,",",r,".buffer);","}else{",h,"=",l,".getBuffer(",r,".buffer);","}",d,'="type" in ',r,"?",s.glTypes,"[",r,".type]:",h,".dtype;",c.normalized,"=!!",r,".normalized;"),f("size"),f("offset"),f("stride"),f("divisor"),i("}}"),i.exit("if(",c.isStream,"){",l,".destroyStream(",h,");","}"),c}))})),s}(e,d),M.context=function(t){var e=t.static,n=t.dynamic,i={};return Object.keys(e).forEach((function(t){var n=e[t];i[t]=oi((function(t,e){return"number"==typeof n||"boolean"==typeof n?""+n:t.link(n)}))})),Object.keys(n).forEach((function(t){var e=n[t];i[t]=si(e,(function(t,n){return t.invoke(n,e)}))})),i}(c),M}function F(t,e,n){var i=t.shared.context,r=t.scope();Object.keys(n).forEach((function(o){e.save(i,"."+o);var s=n[o].append(t,e);Array.isArray(s)?r(i,".",o,"=[",s.join(),"];"):r(i,".",o,"=",s,";")})),e(r)}function B(t,e,n,i){var r,o=t.shared,s=o.gl,a=o.framebuffer;b&&(r=e.def(o.extensions,".webgl_draw_buffers"));var l,c=t.constants,u=c.drawBuffer,h=c.backBuffer;l=n?n.append(t,e):e.def(a,".next"),i||e("if(",l,"!==",a,".cur){"),e("if(",l,"){",s,".bindFramebuffer(",36160,",",l,".framebuffer);"),b&&e(r,".drawBuffersWEBGL(",u,"[",l,".colorAttachments.length]);"),e("}else{",s,".bindFramebuffer(",36160,",null);"),b&&e(r,".drawBuffersWEBGL(",h,");"),e("}",a,".cur=",l,";"),i||e("}")}function N(t,e,n){var i=t.shared,r=i.gl,o=t.current,s=t.next,a=i.current,l=i.next,c=t.cond(a,".dirty");k.forEach((function(e){var i,u,h=A(e);if(!(h in n.state))if(h in s){i=s[h],u=o[h];var d=O(w[h].length,(function(t){return c.def(i,"[",t,"]")}));c(t.cond(d.map((function(t,e){return t+"!=="+u+"["+e+"]"})).join("||")).then(r,".",S[h],"(",d,");",d.map((function(t,e){return u+"["+e+"]="+t})).join(";"),";"))}else{i=c.def(l,".",h);var f=t.cond(i,"!==",a,".",h);c(f),h in E?f(t.cond(i).then(r,".enable(",E[h],");").else(r,".disable(",E[h],");"),a,".",h,"=",i,";"):f(r,".",S[h],"(",i,");",a,".",h,"=",i,";")}})),0===Object.keys(n.state).length&&c(a,".dirty=false;"),e(c)}function j(t,e,n,i){var r=t.shared,o=t.current,s=r.current,a=r.gl;ni(Object.keys(n)).forEach((function(r){var l=n[r];if(!i||i(l)){var c=l.append(t,e);if(E[r]){var u=E[r];ri(l)?e(a,c?".enable(":".disable(",u,");"):e(t.cond(c).then(a,".enable(",u,");").else(a,".disable(",u,");")),e(s,".",r,"=",c,";")}else if(ft(c)){var h=o[r];e(a,".",S[r],"(",c,");",c.map((function(t,e){return h+"["+e+"]="+t})).join(";"),";")}else e(a,".",S[r],"(",c,");",s,".",r,"=",c,";")}}))}function U(t,e){v&&(t.instancing=e.def(t.shared.extensions,".angle_instanced_arrays"))}function V(t,e,n,i,r){var o,s,a,l=t.shared,c=t.stats,u=l.current,h=l.timer,d=n.profile;function f(){return"undefined"==typeof performance?"Date.now()":"performance.now()"}function g(t){t(o=e.def(),"=",f(),";"),"string"==typeof r?t(c,".count+=",r,";"):t(c,".count++;"),p&&(i?t(s=e.def(),"=",h,".getNumPendingQueries();"):t(h,".beginQuery(",c,");"))}function m(t){t(c,".cpuTime+=",f(),"-",o,";"),p&&(i?t(h,".pushScopeStats(",s,",",h,".getNumPendingQueries(),",c,");"):t(h,".endQuery();"))}function _(t){var n=e.def(u,".profile");e(u,".profile=",t,";"),e.exit(u,".profile=",n,";")}if(d){if(ri(d))return void(d.enable?(g(e),m(e.exit),_("true")):_("false"));_(a=d.append(t,e))}else a=e.def(u,".profile");var v=t.block();g(v),e("if(",a,"){",v,"}");var b=t.block();m(b),e.exit("if(",a,"){",b,"}")}function W(t,e,n,i,r){var o=t.shared;i.forEach((function(i){var s,a=i.name,l=n.attributes[a];if(l){if(!r(l))return;s=l.append(t,e)}else{if(!r(ai))return;var c=t.scopeAttrib(a);C.optional((function(){t.assert(e,c+".state","missing attribute "+a)})),s={},Object.keys(new m).forEach((function(t){s[t]=e.def(c,".",t)}))}!function(n,i,r){var s=o.gl,a=e.def(n,".location"),l=e.def(o.attributes,"[",a,"]"),c=r.state,u=r.buffer,h=[r.x,r.y,r.z,r.w],d=["buffer","normalized","offset","stride"];function f(){e("if(!",l,".buffer){",s,".enableVertexAttribArray(",a,");}");var n,o=r.type;if(n=r.size?e.def(r.size,"||",i):i,e("if(",l,".type!==",o,"||",l,".size!==",n,"||",d.map((function(t){return l+"."+t+"!=="+r[t]})).join("||"),"){",s,".bindBuffer(",Sn,",",u,".buffer);",s,".vertexAttribPointer(",[a,n,o,r.normalized,r.stride,r.offset],");",l,".type=",o,";",l,".size=",n,";",d.map((function(t){return l+"."+t+"="+r[t]+";"})).join(""),"}"),v){var c=r.divisor;e("if(",l,".divisor!==",c,"){",t.instancing,".vertexAttribDivisorANGLE(",[a,c],");",l,".divisor=",c,";}")}}function p(){e("if(",l,".buffer){",s,".disableVertexAttribArray(",a,");",l,".buffer=null;","}if(",Ie.map((function(t,e){return l+"."+t+"!=="+h[e]})).join("||"),"){",s,".vertexAttrib4f(",a,",",h,");",Ie.map((function(t,e){return l+"."+t+"="+h[e]+";"})).join(""),"}")}1===c?f():2===c?p():(e("if(",c,"===",1,"){"),f(),e("}else{"),p(),e("}"))}(t.link(i),function(t){switch(t){case Mn:case Rn:case Fn:return 2;case Dn:case In:case Bn:return 3;case Pn:case On:case Nn:return 4;default:return 1}}(i.info.type),s)}))}function H(t,e,i,r,o,s){for(var a,l=t.shared,c=l.gl,u={},h=0;h<r.length;++h){var d=r[h],f=d.name,p=d.info.type,g=d.info.size,m=i.uniforms[f];if(g>1){if(!m)continue;var _=f.replace("[0]","");if(u[_])continue;u[_]=1}var v,b=t.link(d)+".location";if(m){if(!o(m))continue;if(ri(m)){var y=m.value;if(C.command(null!=y,'missing uniform "'+f+'"',t.commandStr),p===Wn||p===Hn){C.command("function"==typeof y&&(p===Wn&&("texture2d"===y._reglType||"framebuffer"===y._reglType)||p===Hn&&("textureCube"===y._reglType||"framebufferCube"===y._reglType)),"invalid texture for uniform "+f,t.commandStr);var w=t.link(y._texture||y.color[0]._texture);e(c,".uniform1i(",b,",",w+".bind());"),e.exit(w,".unbind();")}else if(p===jn||p===Un||p===Vn){C.optional((function(){C.command(ft(y),"invalid matrix for uniform "+f,t.commandStr),C.command(p===jn&&4===y.length||p===Un&&9===y.length||p===Vn&&16===y.length,"invalid length for matrix uniform "+f,t.commandStr)}));var x=t.global.def("new Float32Array(["+Array.prototype.slice.call(y)+"])"),k=2;p===Un?k=3:p===Vn&&(k=4),e(c,".uniformMatrix",k,"fv(",b,",false,",x,");")}else{switch(p){case Tn:1===g?C.commandType(y,"number","uniform "+f,t.commandStr):C.command(ft(y)&&y.length===g,"uniform "+f,t.commandStr),a="1f";break;case Mn:C.command(ft(y)&&y.length&&y.length%2==0&&y.length<=2*g,"uniform "+f,t.commandStr),a="2f";break;case Dn:C.command(ft(y)&&y.length&&y.length%3==0&&y.length<=3*g,"uniform "+f,t.commandStr),a="3f";break;case Pn:C.command(ft(y)&&y.length&&y.length%4==0&&y.length<=4*g,"uniform "+f,t.commandStr),a="4f";break;case zn:1===g?C.commandType(y,"boolean","uniform "+f,t.commandStr):C.command(ft(y)&&y.length===g,"uniform "+f,t.commandStr),a="1i";break;case Ln:1===g?C.commandType(y,"number","uniform "+f,t.commandStr):C.command(ft(y)&&y.length===g,"uniform "+f,t.commandStr),a="1i";break;case Fn:case Rn:C.command(ft(y)&&y.length&&y.length%2==0&&y.length<=2*g,"uniform "+f,t.commandStr),a="2i";break;case Bn:case In:C.command(ft(y)&&y.length&&y.length%3==0&&y.length<=3*g,"uniform "+f,t.commandStr),a="3i";break;case Nn:case On:C.command(ft(y)&&y.length&&y.length%4==0&&y.length<=4*g,"uniform "+f,t.commandStr),a="4i"}g>1?(a+="v",y=t.global.def("["+Array.prototype.slice.call(y)+"]")):y=ft(y)?Array.prototype.slice.call(y):y,e(c,".uniform",a,"(",b,",",y,");")}continue}v=m.append(t,e)}else{if(!o(ai))continue;v=e.def(l.uniforms,"[",n.id(f),"]")}p===Wn?(C(!Array.isArray(v),"must specify a scalar prop for textures"),e("if(",v,"&&",v,'._reglType==="framebuffer"){',v,"=",v,".color[0];","}")):p===Hn&&(C(!Array.isArray(v),"must specify a scalar prop for cube maps"),e("if(",v,"&&",v,'._reglType==="framebufferCube"){',v,"=",v,".color[0];","}")),C.optional((function(){function n(n,i){t.assert(e,n,'bad data or missing for uniform "'+f+'".  '+i)}function i(t,e){1===e&&C(!Array.isArray(v),"must not specify an array type for uniform"),n("Array.isArray("+v+") && typeof "+v+'[0]===" '+t+'" || typeof '+v+'==="'+t+'"',"invalid type, expected "+t)}function r(e,i,r){Array.isArray(v)?C(v.length&&v.length%e==0&&v.length<=e*r,"must have length of "+(1===r?"":"n * ")+e):n(l.isArrayLike+"("+v+")&&"+v+".length && "+v+".length % "+e+" === 0 && "+v+".length<="+e*r,"invalid vector, should have length of "+(1===r?"":"n * ")+e,t.commandStr)}function o(e){C(!Array.isArray(v),"must not specify a value type"),n("typeof "+v+'==="function"&&'+v+'._reglType==="texture'+(3553===e?"2d":"Cube")+'"',"invalid texture type",t.commandStr)}switch(p){case Ln:i("number",g);break;case Rn:r(2,0,g);break;case In:r(3,0,g);break;case On:r(4,0,g);break;case Tn:i("number",g);break;case Mn:r(2,0,g);break;case Dn:r(3,0,g);break;case Pn:r(4,0,g);break;case zn:i("boolean",g);break;case Fn:r(2,0,g);break;case Bn:r(3,0,g);break;case Nn:case jn:r(4,0,g);break;case Un:r(9,0,g);break;case Vn:r(16,0,g);break;case Wn:o(3553);break;case Hn:o(34067)}}));var E=1;switch(p){case Wn:case Hn:var S=e.def(v,"._texture");e(c,".uniform1i(",b,",",S,".bind());"),e.exit(S,".unbind();");continue;case Ln:case zn:a="1i";break;case Rn:case Fn:a="2i",E=2;break;case In:case Bn:a="3i",E=3;break;case On:case Nn:a="4i",E=4;break;case Tn:a="1f";break;case Mn:a="2f",E=2;break;case Dn:a="3f",E=3;break;case Pn:a="4f",E=4;break;case jn:a="Matrix2fv";break;case Un:a="Matrix3fv";break;case Vn:a="Matrix4fv"}if(-1===a.indexOf("Matrix")&&g>1&&(a+="v",E=1),"M"===a.charAt(0)){e(c,".uniform",a,"(",b,",");var A=Math.pow(p-jn+2,2),T=t.global.def("new Float32Array(",A,")");Array.isArray(v)?e("false,(",O(A,(function(t){return T+"["+t+"]="+v[t]})),",",T,")"):e("false,(Array.isArray(",v,")||",v," instanceof Float32Array)?",v,":(",O(A,(function(t){return T+"["+t+"]="+v+"["+t+"]"})),",",T,")"),e(");")}else if(E>1){for(var M=[],D=[],P=0;P<E;++P)Array.isArray(v)?D.push(v[P]):D.push(e.def(v+"["+P+"]")),s&&M.push(e.def());s&&e("if(!",t.batchId,"||",M.map((function(t,e){return t+"!=="+D[e]})).join("||"),"){",M.map((function(t,e){return t+"="+D[e]+";"})).join("")),e(c,".uniform",a,"(",b,",",D.join(","),");"),s&&e("}")}else{if(C(!Array.isArray(v),"uniform value must not be an array"),s){var L=e.def();e("if(!",t.batchId,"||",L,"!==",v,"){",L,"=",v,";")}e(c,".uniform",a,"(",b,",",v,");"),s&&e("}")}}}function $(t,e,n,i){var r=t.shared,o=r.gl,s=r.draw,a=i.draw;var l=function(){var l,c=a.elements,u=e;return c?((c.contextDep&&i.contextDynamic||c.propDep)&&(u=n),l=c.append(t,u),a.elementsActive&&u("if("+l+")"+o+".bindBuffer("+"34963,"+l+".buffer.buffer);")):(l=u.def(),u(l,"=",s,".",fn,";","if(",l,"){",o,".bindBuffer(",An,",",l,".buffer.buffer);}","else if(",r.vao,".currentVAO){",l,"=",t.shared.elements+".getElements("+r.vao,".currentVAO.elements);",y?"":"if("+l+")"+o+".bindBuffer("+"34963,"+l+".buffer.buffer);","}")),l}();function c(r){var o=a[r];return o?o.contextDep&&i.contextDynamic||o.propDep?o.append(t,n):o.append(t,e):e.def(s,".",r)}var u,h,d=c(pn),f=c(mn),p=function(){var r,o=a.count,l=e;return o?((o.contextDep&&i.contextDynamic||o.propDep)&&(l=n),r=o.append(t,l),C.optional((function(){o.MISSING&&t.assert(e,"false","missing vertex count"),o.DYNAMIC&&t.assert(l,r+">=0","missing vertex count")}))):(r=l.def(s,".",gn),C.optional((function(){t.assert(l,r+">=0","missing vertex count")}))),r}();if("number"==typeof p){if(0===p)return}else n("if(",p,"){"),n.exit("}");v&&(u=c(_n),h=t.instancing);var g=l+".type",m=a.elements&&ri(a.elements)&&!a.vaoActive;function _(){function t(){n(h,".drawElementsInstancedANGLE(",[d,p,g,f+"<<(("+g+"-5121)>>1)",u],");")}function e(){n(h,".drawArraysInstancedANGLE(",[d,f,p,u],");")}l&&"null"!==l?m?t():(n("if(",l,"){"),t(),n("}else{"),e(),n("}")):e()}function b(){function t(){n(o+".drawElements("+[d,p,g,f+"<<(("+g+"-5121)>>1)"]+");")}function e(){n(o+".drawArrays("+[d,f,p]+");")}l&&"null"!==l?m?t():(n("if(",l,"){"),t(),n("}else{"),e(),n("}")):e()}v&&("number"!=typeof u||u>=0)?"string"==typeof u?(n("if(",u,">0){"),_(),n("}else if(",u,"<0){"),b(),n("}")):_():b()}function Z(t,e,n,i,r){var o=I(),s=o.proc("body",r);return C.optional((function(){o.commandStr=e.commandStr,o.command=o.link(e.commandStr)})),v&&(o.instancing=s.def(o.shared.extensions,".angle_instanced_arrays")),t(o,s,n,i),o.compile().body}function q(t,e,n,i){U(t,e),n.useVAO?n.drawVAO?e(t.shared.vao,".setVAO(",n.drawVAO.append(t,e),");"):e(t.shared.vao,".setVAO(",t.shared.vao,".targetVAO);"):(e(t.shared.vao,".setVAO(null);"),W(t,e,n,i.attributes,(function(){return!0}))),H(t,e,n,i.uniforms,(function(){return!0}),!1),$(t,e,e,n)}function G(t,e,n,i){function r(){return!0}t.batchId="a1",U(t,e),W(t,e,n,i.attributes,r),H(t,e,n,i.uniforms,r,!1),$(t,e,e,n)}function X(t,e,n,i){U(t,e);var r=n.contextDep,o=e.def(),s=e.def();t.shared.props=s,t.batchId=o;var a=t.scope(),l=t.scope();function c(t){return t.contextDep&&r||t.propDep}function u(t){return!c(t)}if(e(a.entry,"for(",o,"=0;",o,"<","a1",";++",o,"){",s,"=","a0","[",o,"];",l,"}",a.exit),n.needsContext&&F(t,l,n.context),n.needsFramebuffer&&B(t,l,n.framebuffer),j(t,l,n.state,c),n.profile&&c(n.profile)&&V(t,l,n,!1,!0),i)n.useVAO?n.drawVAO?c(n.drawVAO)?l(t.shared.vao,".setVAO(",n.drawVAO.append(t,l),");"):a(t.shared.vao,".setVAO(",n.drawVAO.append(t,a),");"):a(t.shared.vao,".setVAO(",t.shared.vao,".targetVAO);"):(a(t.shared.vao,".setVAO(null);"),W(t,a,n,i.attributes,u),W(t,l,n,i.attributes,c)),H(t,a,n,i.uniforms,u,!1),H(t,l,n,i.uniforms,c,!0),$(t,a,l,n);else{var h=t.global.def("{}"),d=n.shader.progVar.append(t,l),f=l.def(d,".id"),p=l.def(h,"[",f,"]");l(t.shared.gl,".useProgram(",d,".program);","if(!",p,"){",p,"=",h,"[",f,"]=",t.link((function(e){return Z(G,t,n,e,2)})),"(",d,");}",p,".call(this,a0[",o,"],",o,");")}}function Y(t,e,n){var i=e.static[n];if(i&&function(t){if("object"==typeof t&&!ft(t)){for(var e=Object.keys(t),n=0;n<e.length;++n)if(M.isDynamic(t[e[n]]))return!0;return!1}}(i)){var r=t.global,o=Object.keys(i),s=!1,a=!1,l=!1,c=t.global.def("{}");o.forEach((function(e){var n=i[e];if(M.isDynamic(n)){"function"==typeof n&&(n=i[e]=M.unbox(n));var o=si(n,null);s=s||o.thisDep,l=l||o.propDep,a=a||o.contextDep}else{switch(r(c,".",e,"="),typeof n){case"number":r(n);break;case"string":r('"',n,'"');break;case"object":Array.isArray(n)&&r("[",n.join(),"]");break;default:r(t.link(n))}r(";")}})),e.dynamic[n]=new M.DynamicVariable(4,{thisDep:s,contextDep:a,propDep:l,ref:c,append:function(t,e){o.forEach((function(n){var r=i[n];if(M.isDynamic(r)){var o=t.invoke(e,r);e(c,".",n,"=",o,";")}}))}}),delete e.static[n]}}return{next:x,current:w,procs:function(){var t=I(),e=t.proc("poll"),n=t.proc("refresh"),o=t.block();e(o),n(o);var s,a=t.shared,l=a.gl,c=a.next,u=a.current;o(u,".dirty=false;"),B(t,e),B(t,n,null,!0),v&&(s=t.link(v)),i.oes_vertex_array_object&&n(t.link(i.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var h=0;h<r.maxAttributes;++h){var d=n.def(a.attributes,"[",h,"]"),f=t.cond(d,".buffer");f.then(l,".enableVertexAttribArray(",h,");",l,".bindBuffer(",Sn,",",d,".buffer.buffer);",l,".vertexAttribPointer(",h,",",d,".size,",d,".type,",d,".normalized,",d,".stride,",d,".offset);").else(l,".disableVertexAttribArray(",h,");",l,".vertexAttrib4f(",h,",",d,".x,",d,".y,",d,".z,",d,".w);",d,".buffer=null;"),n(f),v&&n(s,".vertexAttribDivisorANGLE(",h,",",d,".divisor);")}return n(t.shared.vao,".currentVAO=null;",t.shared.vao,".setVAO(",t.shared.vao,".targetVAO);"),Object.keys(E).forEach((function(i){var r=E[i],s=o.def(c,".",i),a=t.block();a("if(",s,"){",l,".enable(",r,")}else{",l,".disable(",r,")}",u,".",i,"=",s,";"),n(a),e("if(",s,"!==",u,".",i,"){",a,"}")})),Object.keys(S).forEach((function(i){var r,s,a=S[i],h=w[i],d=t.block();if(d(l,".",a,"("),ft(h)){var f=h.length;r=t.global.def(c,".",i),s=t.global.def(u,".",i),d(O(f,(function(t){return r+"["+t+"]"})),");",O(f,(function(t){return s+"["+t+"]="+r+"["+t+"];"})).join("")),e("if(",O(f,(function(t){return r+"["+t+"]!=="+s+"["+t+"]"})).join("||"),"){",d,"}")}else r=o.def(c,".",i),s=o.def(u,".",i),d(r,");",u,".",i,"=",r,";"),e("if(",r,"!==",s,"){",d,"}");n(d)})),t.compile()}(),compile:function(t,i,r,o,s){var a=I();a.stats=a.link(s),Object.keys(i.static).forEach((function(t){Y(a,i,t)})),En.forEach((function(e){Y(a,t,e)}));var l=z(t,i,r,o,a);return function(t,e){var n=t.proc("draw",1);U(t,n),F(t,n,e.context),B(t,n,e.framebuffer),N(t,n,e),j(t,n,e.state),V(t,n,e,!1,!0);var i=e.shader.progVar.append(t,n);if(n(t.shared.gl,".useProgram(",i,".program);"),e.shader.program)q(t,n,e,e.shader.program);else{n(t.shared.vao,".setVAO(null);");var r=t.global.def("{}"),o=n.def(i,".id"),s=n.def(r,"[",o,"]");n(t.cond(s).then(s,".call(this,a0);").else(s,"=",r,"[",o,"]=",t.link((function(n){return Z(q,t,e,n,1)})),"(",i,");",s,".call(this,a0);"))}Object.keys(e.state).length>0&&n(t.shared.current,".dirty=true;"),t.shared.vao&&n(t.shared.vao,".setVAO(null);")}(a,l),function(t,e){var i=t.proc("scope",3);t.batchId="a2";var r=t.shared,o=r.current;function s(n){var o=e.shader[n];o&&i.set(r.shader,"."+n,o.append(t,i))}F(t,i,e.context),e.framebuffer&&e.framebuffer.append(t,i),ni(Object.keys(e.state)).forEach((function(n){var o=e.state[n].append(t,i);ft(o)?o.forEach((function(e,r){i.set(t.next[n],"["+r+"]",e)})):i.set(r.next,"."+n,o)})),V(t,i,e,!0,!0),[fn,mn,gn,_n,pn].forEach((function(n){var o=e.draw[n];o&&i.set(r.draw,"."+n,""+o.append(t,i))})),Object.keys(e.uniforms).forEach((function(o){var s=e.uniforms[o].append(t,i);Array.isArray(s)&&(s="["+s.join()+"]"),i.set(r.uniforms,"["+n.id(o)+"]",s)})),Object.keys(e.attributes).forEach((function(n){var r=e.attributes[n].append(t,i),o=t.scopeAttrib(n);Object.keys(new m).forEach((function(t){i.set(o,"."+t,r[t])}))})),e.scopeVAO&&i.set(r.vao,".targetVAO",e.scopeVAO.append(t,i)),s(hn),s(dn),Object.keys(e.state).length>0&&(i(o,".dirty=true;"),i.exit(o,".dirty=true;")),i("a1(",t.shared.context,",a0,",t.batchId,");")}(a,l),function(t,e){var n=t.proc("batch",2);t.batchId="0",U(t,n);var i=!1,r=!0;Object.keys(e.context).forEach((function(t){i=i||e.context[t].propDep})),i||(F(t,n,e.context),r=!1);var o=e.framebuffer,s=!1;function a(t){return t.contextDep&&i||t.propDep}o?(o.propDep?i=s=!0:o.contextDep&&i&&(s=!0),s||B(t,n,o)):B(t,n,null),e.state.viewport&&e.state.viewport.propDep&&(i=!0),N(t,n,e),j(t,n,e.state,(function(t){return!a(t)})),e.profile&&a(e.profile)||V(t,n,e,!1,"a1"),e.contextDep=i,e.needsContext=r,e.needsFramebuffer=s;var l=e.shader.progVar;if(l.contextDep&&i||l.propDep)X(t,n,e,null);else{var c=l.append(t,n);if(n(t.shared.gl,".useProgram(",c,".program);"),e.shader.program)X(t,n,e,e.shader.program);else{n(t.shared.vao,".setVAO(null);");var u=t.global.def("{}"),h=n.def(c,".id"),d=n.def(u,"[",h,"]");n(t.cond(d).then(d,".call(this,a0,a1);").else(d,"=",u,"[",h,"]=",t.link((function(n){return Z(X,t,e,n,2)})),"(",c,");",d,".call(this,a0,a1);"))}}Object.keys(e.state).length>0&&n(t.shared.current,".dirty=true;"),t.shared.vao&&n(t.shared.vao,".setVAO(null);")}(a,l),e(a.compile(),{destroy:function(){l.shader.program.destroy()}})}}}var ci=function(t,e){if(!e.ext_disjoint_timer_query)return null;var n=[];function i(t){n.push(t)}var r=[];function o(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var s=[];function a(t){s.push(t)}var l=[];function c(t,e,n){var i=s.pop()||new o;i.startQueryIndex=t,i.endQueryIndex=e,i.sum=0,i.stats=n,l.push(i)}var u=[],h=[];return{beginQuery:function(t){var i=n.pop()||e.ext_disjoint_timer_query.createQueryEXT();e.ext_disjoint_timer_query.beginQueryEXT(35007,i),r.push(i),c(r.length-1,r.length,t)},endQuery:function(){e.ext_disjoint_timer_query.endQueryEXT(35007)},pushScopeStats:c,update:function(){var t,n,o=r.length;if(0!==o){h.length=Math.max(h.length,o+1),u.length=Math.max(u.length,o+1),u[0]=0,h[0]=0;var s=0;for(t=0,n=0;n<r.length;++n){var c=r[n];e.ext_disjoint_timer_query.getQueryObjectEXT(c,34919)?(s+=e.ext_disjoint_timer_query.getQueryObjectEXT(c,34918),i(c)):r[t++]=c,u[n+1]=s,h[n+1]=t}for(r.length=t,t=0,n=0;n<l.length;++n){var d=l[n],f=d.startQueryIndex,p=d.endQueryIndex;d.sum+=u[p]-u[f];var g=h[f],m=h[p];m===g?(d.stats.gpuTime+=d.sum/1e6,a(d)):(d.startQueryIndex=g,d.endQueryIndex=m,l[t++]=d)}l.length=t}},getNumPendingQueries:function(){return r.length},clear:function(){n.push.apply(n,r);for(var t=0;t<n.length;t++)e.ext_disjoint_timer_query.deleteQueryEXT(n[t]);r.length=0,n.length=0},restore:function(){r.length=0,n.length=0}}},ui="webglcontextlost",hi="webglcontextrestored";function di(t,e){for(var n=0;n<t.length;++n)if(t[n]===e)return n;return-1}return function(n){var i=I(n);if(!i)return null;var r=i.gl,o=r.getContextAttributes(),s=r.isContextLost(),a=function(t,e){var n={};function i(e){C.type(e,"string","extension name must be string");var i,r=e.toLowerCase();try{i=n[r]=t.getExtension(r)}catch(t){}return!!i}for(var r=0;r<e.extensions.length;++r){var o=e.extensions[r];if(!i(o))return e.onDestroy(),e.onDone('"'+o+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return e.optionalExtensions.forEach(i),{extensions:n,restore:function(){Object.keys(n).forEach((function(t){if(n[t]&&!i(t))throw new Error("(regl): error restoring extension "+t)}))}}}(r,i);if(!a)return null;var l,c,u=(l={"":0},c=[""],{id:function(t){var e=l[t];return e||(e=l[t]=c.length,c.push(t),e)},str:function(t){return c[t]}}),h={vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0},d=a.extensions,f=ci(0,d),p=P(),g=r.drawingBufferWidth,m=r.drawingBufferHeight,_={tick:0,time:0,viewportWidth:g,viewportHeight:m,framebufferWidth:g,framebufferHeight:m,drawingBufferWidth:g,drawingBufferHeight:m,pixelRatio:i.pixelRatio},v={elements:null,primitive:4,count:-1,offset:0,instances:-1},b=function(t,e){var n=1;e.ext_texture_filter_anisotropic&&(n=t.getParameter(34047));var i=1,r=1;e.webgl_draw_buffers&&(i=t.getParameter(34852),r=t.getParameter(36063));var o=!!e.oes_texture_float;if(o){var s=t.createTexture();t.bindTexture(N,s),t.texImage2D(N,0,j,1,1,0,j,U,null);var a=t.createFramebuffer();if(t.bindFramebuffer(V,a),t.framebufferTexture2D(V,36064,N,s,0),t.bindTexture(N,null),36053!==t.checkFramebufferStatus(V))o=!1;else{t.viewport(0,0,1,1),t.clearColor(1,0,0,1),t.clear(16384);var l=B.allocType(U,4);t.readPixels(0,0,1,1,j,U,l),t.getError()?o=!1:(t.deleteFramebuffer(a),t.deleteTexture(s),o=1===l[0]),B.freeType(l)}}var c=!0;if("undefined"==typeof navigator||!(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent))){var u=t.createTexture(),h=B.allocType(5121,36);t.activeTexture(33984),t.bindTexture(34067,u),t.texImage2D(34069,0,j,3,3,0,j,5121,h),B.freeType(h),t.bindTexture(34067,null),t.deleteTexture(u),c=!t.getError()}return{colorBits:[t.getParameter(3410),t.getParameter(3411),t.getParameter(3412),t.getParameter(3413)],depthBits:t.getParameter(3414),stencilBits:t.getParameter(3415),subpixelBits:t.getParameter(3408),extensions:Object.keys(e).filter((function(t){return!!e[t]})),maxAnisotropic:n,maxDrawbuffers:i,maxColorAttachments:r,pointSizeDims:t.getParameter(33901),lineWidthDims:t.getParameter(33902),maxViewportDims:t.getParameter(3386),maxCombinedTextureUnits:t.getParameter(35661),maxCubeMapSize:t.getParameter(34076),maxRenderbufferSize:t.getParameter(34024),maxTextureUnits:t.getParameter(34930),maxTextureSize:t.getParameter(3379),maxAttributes:t.getParameter(34921),maxVertexUniforms:t.getParameter(36347),maxVertexTextureUnits:t.getParameter(35660),maxVaryingVectors:t.getParameter(36348),maxFragmentUniforms:t.getParameter(36349),glsl:t.getParameter(35724),renderer:t.getParameter(7937),vendor:t.getParameter(7936),version:t.getParameter(7938),readFloat:o,npotTextureCube:c}}(r,d),y=function(e,n,i,r){var o=0,s={};function a(t){this.id=o++,this.buffer=e.createBuffer(),this.type=t,this.usage=35044,this.byteLength=0,this.dimension=1,this.dtype=J,this.persistentData=null,i.profile&&(this.stats={size:0})}a.prototype.bind=function(){e.bindBuffer(this.type,this.buffer)},a.prototype.destroy=function(){h(this)};var l=[];function c(t,n,i){t.byteLength=n.byteLength,e.bufferData(t.type,n,i)}function u(e,n,i,r,o,s){var a,l;if(e.usage=i,Array.isArray(n)){if(e.dtype=r||tt,n.length>0)if(Array.isArray(n[0])){a=Q(n);for(var u=1,h=1;h<a.length;++h)u*=a[h];e.dimension=u,c(e,l=Y(n,a,e.dtype),i),s?e.persistentData=l:B.freeType(l)}else if("number"==typeof n[0]){e.dimension=o;var d=B.allocType(e.dtype,n.length);it(d,n),c(e,d,i),s?e.persistentData=d:B.freeType(d)}else t(n[0])?(e.dimension=n[0].length,e.dtype=r||nt(n[0])||tt,c(e,l=Y(n,[n.length,n[0].length],e.dtype),i),s?e.persistentData=l:B.freeType(l)):C.raise("invalid buffer data")}else if(t(n))e.dtype=r||nt(n),e.dimension=o,c(e,n,i),s&&(e.persistentData=new Uint8Array(new Uint8Array(n.buffer)));else if(W(n)){a=n.shape;var f=n.stride,p=n.offset,g=0,m=0,_=0,v=0;1===a.length?(g=a[0],m=1,_=f[0],v=0):2===a.length?(g=a[0],m=a[1],_=f[0],v=f[1]):C.raise("invalid shape"),e.dtype=r||nt(n.data)||tt,e.dimension=m;var b=B.allocType(e.dtype,g*m);rt(b,n.data,g,m,_,v,p),c(e,b,i),s?e.persistentData=b:B.freeType(b)}else n instanceof ArrayBuffer?(e.dtype=J,e.dimension=o,c(e,n,i),s&&(e.persistentData=new Uint8Array(new Uint8Array(n)))):C.raise("invalid buffer data")}function h(t){n.bufferCount--,r(t);var i=t.buffer;C(i,"buffer must not be deleted already"),e.deleteBuffer(i),t.buffer=null,delete s[t.id]}return i.profile&&(n.getTotalBufferSize=function(){var t=0;return Object.keys(s).forEach((function(e){t+=s[e].stats.size})),t}),{create:function(r,o,l,c){n.bufferCount++;var d=new a(o);function f(n){var r=35044,o=null,s=0,a=0,l=1;return Array.isArray(n)||t(n)||W(n)||n instanceof ArrayBuffer?o=n:"number"==typeof n?s=0|n:n&&(C.type(n,"object","buffer arguments must be an object, a number or an array"),"data"in n&&(C(null===o||Array.isArray(o)||t(o)||W(o),"invalid data for buffer"),o=n.data),"usage"in n&&(C.parameter(n.usage,X,"invalid buffer usage"),r=X[n.usage]),"type"in n&&(C.parameter(n.type,K,"invalid buffer type"),a=K[n.type]),"dimension"in n&&(C.type(n.dimension,"number","invalid dimension"),l=0|n.dimension),"length"in n&&(C.nni(s,"buffer length must be a nonnegative integer"),s=0|n.length)),d.bind(),o?u(d,o,r,a,l,c):(s&&e.bufferData(d.type,s,r),d.dtype=a||J,d.usage=r,d.dimension=l,d.byteLength=s),i.profile&&(d.stats.size=d.byteLength*et[d.dtype]),f}function p(t,n){C(n+t.byteLength<=d.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+t.byteLength+" starting from offset "+n+" to a buffer of size "+d.byteLength),e.bufferSubData(d.type,n,t)}return s[d.id]=d,l||f(r),f._reglType="buffer",f._buffer=d,f.subdata=function(e,n){var i,r=0|(n||0);if(d.bind(),t(e)||e instanceof ArrayBuffer)p(e,r);else if(Array.isArray(e)){if(e.length>0)if("number"==typeof e[0]){var o=B.allocType(d.dtype,e.length);it(o,e),p(o,r),B.freeType(o)}else if(Array.isArray(e[0])||t(e[0])){i=Q(e);var s=Y(e,i,d.dtype);p(s,r),B.freeType(s)}else C.raise("invalid buffer data")}else if(W(e)){i=e.shape;var a=e.stride,l=0,c=0,u=0,h=0;1===i.length?(l=i[0],c=1,u=a[0],h=0):2===i.length?(l=i[0],c=i[1],u=a[0],h=a[1]):C.raise("invalid shape");var g=Array.isArray(e.data)?d.dtype:nt(e.data),m=B.allocType(g,l*c);rt(m,e.data,l,c,u,h,e.offset),p(m,r),B.freeType(m)}else C.raise("invalid data for buffer subdata");return f},i.profile&&(f.stats=d.stats),f.destroy=function(){h(d)},f},createStream:function(t,e){var n=l.pop();return n||(n=new a(t)),n.bind(),u(n,e,35040,0,1,!1),n},destroyStream:function(t){l.push(t)},clear:function(){H(s).forEach(h),l.forEach(h)},getBuffer:function(t){return t&&t._buffer instanceof a?t._buffer:null},restore:function(){H(s).forEach((function(t){t.buffer=e.createBuffer(),e.bindBuffer(t.type,t.buffer),e.bufferData(t.type,t.persistentData||t.byteLength,t.usage)}))},_initBuffer:u}}(r,h,i,(function(t){return x.destroyBuffer(t)})),w=function(e,n,i,r){var o={},s=0,a={uint8:st,uint16:at};function l(t){this.id=s++,o[this.id]=this,this.buffer=t,this.primType=4,this.vertCount=0,this.type=0}n.oes_element_index_uint&&(a.uint32=lt),l.prototype.bind=function(){this.buffer.bind()};var c=[];function u(r,o,s,a,l,c,u){var h;if(r.buffer.bind(),o){var d=u;u||t(o)&&(!W(o)||t(o.data))||(d=n.oes_element_index_uint?lt:at),i._initBuffer(r.buffer,o,s,d,3)}else e.bufferData(ct,c,s),r.buffer.dtype=h||st,r.buffer.usage=s,r.buffer.dimension=3,r.buffer.byteLength=c;if(h=u,!u){switch(r.buffer.dtype){case st:case 5120:h=st;break;case at:case 5122:h=at;break;case lt:case 5124:h=lt;break;default:C.raise("unsupported type for element array")}r.buffer.dtype=h}r.type=h,C(h!==lt||!!n.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var f=l;f<0&&(f=r.buffer.byteLength,h===at?f>>=1:h===lt&&(f>>=2)),r.vertCount=f;var p=a;if(a<0){p=4;var g=r.buffer.dimension;1===g&&(p=0),2===g&&(p=1),3===g&&(p=4)}r.primType=p}function h(t){r.elementsCount--,C(null!==t.buffer,"must not double destroy elements"),delete o[t.id],t.buffer.destroy(),t.buffer=null}return{create:function(e,n){var o=i.create(null,ct,!0),s=new l(o._buffer);function c(e){if(e)if("number"==typeof e)o(e),s.primType=4,s.vertCount=0|e,s.type=st;else{var n=null,i=35044,r=-1,l=-1,h=0,d=0;Array.isArray(e)||t(e)||W(e)?n=e:(C.type(e,"object","invalid arguments for elements"),"data"in e&&(n=e.data,C(Array.isArray(n)||t(n)||W(n),"invalid data for element buffer")),"usage"in e&&(C.parameter(e.usage,X,"invalid element buffer usage"),i=X[e.usage]),"primitive"in e&&(C.parameter(e.primitive,ot,"invalid element buffer primitive"),r=ot[e.primitive]),"count"in e&&(C("number"==typeof e.count&&e.count>=0,"invalid vertex count for elements"),l=0|e.count),"type"in e&&(C.parameter(e.type,a,"invalid buffer type"),d=a[e.type]),"length"in e?h=0|e.length:(h=l,d===at||5122===d?h*=2:d!==lt&&5124!==d||(h*=4))),u(s,n,i,r,l,h,d)}else o(),s.primType=4,s.vertCount=0,s.type=st;return c}return r.elementsCount++,c(e),c._reglType="elements",c._elements=s,c.subdata=function(t,e){return o.subdata(t,e),c},c.destroy=function(){h(s)},c},createStream:function(t){var e=c.pop();return e||(e=new l(i.create(null,ct,!0,!1)._buffer)),u(e,t,35040,-1,-1,0,0),e},destroyStream:function(t){c.push(t)},getElements:function(t){return"function"==typeof t&&t._elements instanceof l?t._elements:null},clear:function(){H(o).forEach(h)}}}(r,d,y,h),x=function(e,n,i,r,o,s,a){for(var l=i.maxAttributes,c=new Array(l),u=0;u<l;++u)c[u]=new Te;var h=0,d={},f={Record:Te,scope:{},state:c,currentVAO:null,targetVAO:null,restore:p()?function(){p()&&H(d).forEach((function(t){t.refresh()}))}:function(){},createVAO:function(e){var i=new m;function a(e){var r;if(Array.isArray(e))r=e,i.elements&&i.ownsElements&&i.elements.destroy(),i.elements=null,i.ownsElements=!1,i.offset=0,i.count=0,i.instances=-1,i.primitive=4;else{if(C("object"==typeof e,"invalid arguments for create vao"),C("attributes"in e,"must specify attributes for vao"),e.elements){var c=e.elements;i.ownsElements?"function"==typeof c&&"elements"===c._reglType?(i.elements.destroy(),i.ownsElements=!1):(i.elements(c),i.ownsElements=!1):s.getElements(e.elements)?(i.elements=e.elements,i.ownsElements=!1):(i.elements=s.create(e.elements),i.ownsElements=!0)}else i.elements=null,i.ownsElements=!1;r=e.attributes,i.offset=0,i.count=-1,i.instances=-1,i.primitive=4,i.elements&&(i.count=i.elements._elements.vertCount,i.primitive=i.elements._elements.primType),"offset"in e&&(i.offset=0|e.offset),"count"in e&&(i.count=0|e.count),"instances"in e&&(i.instances=0|e.instances),"primitive"in e&&(C(e.primitive in ot,"bad primitive type: "+e.primitive),i.primitive=ot[e.primitive]),C.optional((()=>{for(var t=Object.keys(e),n=0;n<t.length;++n)C(Ae.indexOf(t[n])>=0,'invalid option for vao: "'+t[n]+'" valid options are '+Ae)})),C(Array.isArray(r),"attributes must be an array")}C(r.length<l,"too many attributes"),C(r.length>0,"must specify at least one attribute");var u={},h=i.attributes;h.length=r.length;for(var d=0;d<r.length;++d){var f,p=r[d],g=h[d]=new Te,m=p.data||p;Array.isArray(m)||t(m)||W(m)?(i.buffers[d]&&(f=i.buffers[d],t(m)&&f._buffer.byteLength>=m.byteLength?f.subdata(m):(f.destroy(),i.buffers[d]=null)),i.buffers[d]||(f=i.buffers[d]=o.create(p,34962,!1,!0)),g.buffer=o.getBuffer(f),g.size=0|g.buffer.dimension,g.normalized=!1,g.type=g.buffer.dtype,g.offset=0,g.stride=0,g.divisor=0,g.state=1,u[d]=1):o.getBuffer(p)?(g.buffer=o.getBuffer(p),g.size=0|g.buffer.dimension,g.normalized=!1,g.type=g.buffer.dtype,g.offset=0,g.stride=0,g.divisor=0,g.state=1):o.getBuffer(p.buffer)?(g.buffer=o.getBuffer(p.buffer),g.size=0|(+p.size||g.buffer.dimension),g.normalized=!!p.normalized||!1,"type"in p?(C.parameter(p.type,K,"invalid buffer type"),g.type=K[p.type]):g.type=g.buffer.dtype,g.offset=0|(p.offset||0),g.stride=0|(p.stride||0),g.divisor=0|(p.divisor||0),g.state=1,C(g.size>=1&&g.size<=4,"size must be between 1 and 4"),C(g.offset>=0,"invalid offset"),C(g.stride>=0&&g.stride<=255,"stride must be between 0 and 255"),C(g.divisor>=0,"divisor must be positive"),C(!g.divisor||!!n.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in p?(C(d>0,"first attribute must not be a constant"),g.x=+p.x||0,g.y=+p.y||0,g.z=+p.z||0,g.w=+p.w||0,g.state=2):C(!1,"invalid attribute spec for location "+d)}for(var _=0;_<i.buffers.length;++_)!u[_]&&i.buffers[_]&&(i.buffers[_].destroy(),i.buffers[_]=null);return i.refresh(),a}return r.vaoCount+=1,a.destroy=function(){for(var t=0;t<i.buffers.length;++t)i.buffers[t]&&i.buffers[t].destroy();i.buffers.length=0,i.ownsElements&&(i.elements.destroy(),i.elements=null,i.ownsElements=!1),i.destroy()},a._vao=i,a._reglType="vao",a(e)},getVAO:function(t){return"function"==typeof t&&t._vao?t._vao:null},destroyBuffer:function(t){for(var n=0;n<c.length;++n){var i=c[n];i.buffer===t&&(e.disableVertexAttribArray(n),i.buffer=null)}},setVAO:p()?function(t){if(t!==f.currentVAO){var e=p();t?e.bindVertexArrayOES(t.vao):e.bindVertexArrayOES(null),f.currentVAO=t}}:function(t){if(t!==f.currentVAO){if(t)t.bindAttrs();else{for(var n=g(),i=0;i<c.length;++i){var r=c[i];r.buffer?(e.enableVertexAttribArray(i),r.buffer.bind(),e.vertexAttribPointer(i,r.size,r.type,r.normalized,r.stride,r.offfset),n&&r.divisor&&n.vertexAttribDivisorANGLE(i,r.divisor)):(e.disableVertexAttribArray(i),e.vertexAttrib4f(i,r.x,r.y,r.z,r.w))}a.elements?e.bindBuffer(Se,a.elements.buffer.buffer):e.bindBuffer(Se,null)}f.currentVAO=t}},clear:p()?function(){H(d).forEach((function(t){t.destroy()}))}:function(){}};function p(){return n.oes_vertex_array_object}function g(){return n.angle_instanced_arrays}function m(){this.id=++h,this.attributes=[],this.elements=null,this.ownsElements=!1,this.count=0,this.offset=0,this.instances=-1,this.primitive=4;var t=p();this.vao=t?t.createVertexArrayOES():null,d[this.id]=this,this.buffers=[]}return m.prototype.bindAttrs=function(){for(var t=g(),n=this.attributes,i=0;i<n.length;++i){var r=n[i];r.buffer?(e.enableVertexAttribArray(i),e.bindBuffer(34962,r.buffer.buffer),e.vertexAttribPointer(i,r.size,r.type,r.normalized,r.stride,r.offset),t&&r.divisor&&t.vertexAttribDivisorANGLE(i,r.divisor)):(e.disableVertexAttribArray(i),e.vertexAttrib4f(i,r.x,r.y,r.z,r.w))}for(var o=n.length;o<l;++o)e.disableVertexAttribArray(o);var a=s.getElements(this.elements);a?e.bindBuffer(Se,a.buffer.buffer):e.bindBuffer(Se,null)},m.prototype.refresh=function(){var t=p();t&&(t.bindVertexArrayOES(this.vao),this.bindAttrs(),f.currentVAO=null,t.bindVertexArrayOES(null))},m.prototype.destroy=function(){if(this.vao){var t=p();this===f.currentVAO&&(f.currentVAO=null,t.bindVertexArrayOES(null)),t.deleteVertexArrayOES(this.vao),this.vao=null}this.ownsElements&&(this.elements.destroy(),this.elements=null,this.ownsElements=!1),d[this.id]&&(delete d[this.id],r.vaoCount-=1)},f}(r,d,b,h,y,w,v),k=function(t,n,i,r){var o={},s={};function a(t,e,n,i){this.name=t,this.id=e,this.location=n,this.info=i}function l(t,e){for(var n=0;n<t.length;++n)if(t[n].id===e.id)return void(t[n].location=e.location);t.push(e)}function c(e,i,r){var a=35632===e?o:s,l=a[i];if(!l){var c=n.str(i);l=t.createShader(e),t.shaderSource(l,c),t.compileShader(l),C.shaderError(t,l,c,e,r),a[i]=l}return l}var u={},h=[],d=0;function f(t,e){this.id=d++,this.fragId=t,this.vertId=e,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,r.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function p(e,i,o){var s,u,h=c(35632,e.fragId),d=c(35633,e.vertId),f=e.program=t.createProgram();if(t.attachShader(f,h),t.attachShader(f,d),o)for(s=0;s<o.length;++s){var p=o[s];t.bindAttribLocation(f,p[0],p[1])}t.linkProgram(f),C.linkError(t,f,n.str(e.fragId),n.str(e.vertId),i);var g=t.getProgramParameter(f,35718);r.profile&&(e.stats.uniformsCount=g);var m=e.uniforms;for(s=0;s<g;++s)if(u=t.getActiveUniform(f,s)){if(u.size>1)for(var _=0;_<u.size;++_){var v=u.name.replace("[0]","["+_+"]");l(m,new a(v,n.id(v),t.getUniformLocation(f,v),u))}var b=u.name;u.size>1&&(b=b.replace("[0]","")),l(m,new a(b,n.id(b),t.getUniformLocation(f,b),u))}var y=t.getProgramParameter(f,35721);r.profile&&(e.stats.attributesCount=y);var w=e.attributes;for(s=0;s<y;++s)(u=t.getActiveAttrib(f,s))&&l(w,new a(u.name,n.id(u.name),t.getAttribLocation(f,u.name),u))}return r.profile&&(i.getMaxUniformsCount=function(){var t=0;return h.forEach((function(e){e.stats.uniformsCount>t&&(t=e.stats.uniformsCount)})),t},i.getMaxAttributesCount=function(){var t=0;return h.forEach((function(e){e.stats.attributesCount>t&&(t=e.stats.attributesCount)})),t}),{clear:function(){var e=t.deleteShader.bind(t);H(o).forEach(e),o={},H(s).forEach(e),s={},h.forEach((function(e){t.deleteProgram(e.program)})),h.length=0,u={},i.shaderCount=0},program:function(n,r,a,l){C.command(n>=0,"missing vertex shader",a),C.command(r>=0,"missing fragment shader",a);var c=u[r];c||(c=u[r]={});var d=c[n];if(d&&(d.refCount++,!l))return d;var g=new f(r,n);return i.shaderCount++,p(g,a,l),d||(c[n]=g),h.push(g),e(g,{destroy:function(){if(g.refCount--,g.refCount<=0){t.deleteProgram(g.program);var e=h.indexOf(g);h.splice(e,1),i.shaderCount--}c[g.vertId].refCount<=0&&(t.deleteShader(s[g.vertId]),delete s[g.vertId],delete u[g.fragId][g.vertId]),Object.keys(u[g.fragId]).length||(t.deleteShader(o[g.fragId]),delete o[g.fragId],delete u[g.fragId])}})},restore:function(){o={},s={};for(var t=0;t<h.length;++t)p(h[t],null,h[t].attributes.map((function(t){return[t.location,t.name]})))},shader:c,frag:-1,vert:-1}}(r,u,h,i),E=de(r,d,b,(function(){T.procs.poll()}),_,h,i),S=function(t,e,n,i,r){var o={rgba4:pe,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};e.ext_srgb&&(o.srgba=35907),e.ext_color_buffer_half_float&&(o.rgba16f=34842,o.rgb16f=34843),e.webgl_color_buffer_float&&(o.rgba32f=34836);var s=[];Object.keys(o).forEach((function(t){var e=o[t];s[e]=t}));var a=0,l={};function c(t){this.id=a++,this.refCount=1,this.renderbuffer=t,this.format=pe,this.width=0,this.height=0,r.profile&&(this.stats={size:0})}function u(e){var n=e.renderbuffer;C(n,"must not double destroy renderbuffer"),t.bindRenderbuffer(fe,null),t.deleteRenderbuffer(n),e.renderbuffer=null,e.refCount=0,delete l[e.id],i.renderbufferCount--}return c.prototype.decRef=function(){--this.refCount<=0&&u(this)},r.profile&&(i.getTotalRenderbufferSize=function(){var t=0;return Object.keys(l).forEach((function(e){t+=l[e].stats.size})),t}),{create:function(e,a){var u=new c(t.createRenderbuffer());function h(e,i){var a=0,l=0,c=pe;if("object"==typeof e&&e){var d=e;if("shape"in d){var f=d.shape;C(Array.isArray(f)&&f.length>=2,"invalid renderbuffer shape"),a=0|f[0],l=0|f[1]}else"radius"in d&&(a=l=0|d.radius),"width"in d&&(a=0|d.width),"height"in d&&(l=0|d.height);"format"in d&&(C.parameter(d.format,o,"invalid renderbuffer format"),c=o[d.format])}else"number"==typeof e?(a=0|e,l="number"==typeof i?0|i:a):e?C.raise("invalid arguments to renderbuffer constructor"):a=l=1;if(C(a>0&&l>0&&a<=n.maxRenderbufferSize&&l<=n.maxRenderbufferSize,"invalid renderbuffer size"),a!==u.width||l!==u.height||c!==u.format)return h.width=u.width=a,h.height=u.height=l,u.format=c,t.bindRenderbuffer(fe,u.renderbuffer),t.renderbufferStorage(fe,c,a,l),C(0===t.getError(),"invalid render buffer format"),r.profile&&(u.stats.size=me(u.format,u.width,u.height)),h.format=s[u.format],h}return l[u.id]=u,i.renderbufferCount++,h(e,a),h.resize=function(e,i){var o=0|e,s=0|i||o;return o===u.width&&s===u.height||(C(o>0&&s>0&&o<=n.maxRenderbufferSize&&s<=n.maxRenderbufferSize,"invalid renderbuffer size"),h.width=u.width=o,h.height=u.height=s,t.bindRenderbuffer(fe,u.renderbuffer),t.renderbufferStorage(fe,u.format,o,s),C(0===t.getError(),"invalid render buffer format"),r.profile&&(u.stats.size=me(u.format,u.width,u.height))),h},h._reglType="renderbuffer",h._renderbuffer=u,r.profile&&(h.stats=u.stats),h.destroy=function(){u.decRef()},h},clear:function(){H(l).forEach(u)},restore:function(){H(l).forEach((function(e){e.renderbuffer=t.createRenderbuffer(),t.bindRenderbuffer(fe,e.renderbuffer),t.renderbufferStorage(fe,e.format,e.width,e.height)})),t.bindRenderbuffer(fe,null)}}}(r,d,b,h,i),A=function(t,n,i,r,o,s){var a={cur:null,next:null,dirty:!1,setFBO:null},l=["rgba"],c=["rgba4","rgb565","rgb5 a1"];n.ext_srgb&&c.push("srgba"),n.ext_color_buffer_half_float&&c.push("rgba16f","rgb16f"),n.webgl_color_buffer_float&&c.push("rgba32f");var u=["uint8"];function h(t,e,n){this.target=t,this.texture=e,this.renderbuffer=n;var i=0,r=0;e?(i=e.width,r=e.height):n&&(i=n.width,r=n.height),this.width=i,this.height=r}function d(t){t&&(t.texture&&t.texture._texture.decRef(),t.renderbuffer&&t.renderbuffer._renderbuffer.decRef())}function f(t,e,n){if(t)if(t.texture){var i=t.texture._texture,r=Math.max(1,i.width),o=Math.max(1,i.height);C(r===e&&o===n,"inconsistent width/height for supplied texture"),i.refCount+=1}else{var s=t.renderbuffer._renderbuffer;C(s.width===e&&s.height===n,"inconsistent width/height for renderbuffer"),s.refCount+=1}}function p(e,n){n&&(n.texture?t.framebufferTexture2D(_e,e,n.target,n.texture._texture.texture,0):t.framebufferRenderbuffer(_e,e,ve,n.renderbuffer._renderbuffer.renderbuffer))}function g(t){var e=be,n=null,i=null,r=t;"object"==typeof t&&(r=t.data,"target"in t&&(e=0|t.target)),C.type(r,"function","invalid attachment data");var o=r._reglType;return"texture2d"===o?(n=r,C(e===be)):"textureCube"===o?(n=r,C(e>=ye&&e<34075,"invalid cube map target")):"renderbuffer"===o?(i=r,e=ve):C.raise("invalid regl object for attachment"),new h(e,n,i)}function m(t,e,n,i,s){if(n){var a=r.create2D({width:t,height:e,format:i,type:s});return a._texture.refCount=0,new h(be,a,null)}var l=o.create({width:t,height:e,format:i});return l._renderbuffer.refCount=0,new h(ve,null,l)}function _(t){return t&&(t.texture||t.renderbuffer)}function v(t,e,n){t&&(t.texture?t.texture.resize(e,n):t.renderbuffer&&t.renderbuffer.resize(e,n),t.width=e,t.height=n)}n.oes_texture_half_float&&u.push("half float","float16"),n.oes_texture_float&&u.push("float","float32");var b=0,y={};function w(){this.id=b++,y[this.id]=this,this.framebuffer=t.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function x(t){t.colorAttachments.forEach(d),d(t.depthAttachment),d(t.stencilAttachment),d(t.depthStencilAttachment)}function k(e){var n=e.framebuffer;C(n,"must not double destroy framebuffer"),t.deleteFramebuffer(n),e.framebuffer=null,s.framebufferCount--,delete y[e.id]}function E(e){var n;t.bindFramebuffer(_e,e.framebuffer);var r=e.colorAttachments;for(n=0;n<r.length;++n)p(36064+n,r[n]);for(n=r.length;n<i.maxColorAttachments;++n)t.framebufferTexture2D(_e,36064+n,be,null,0);t.framebufferTexture2D(_e,33306,be,null,0),t.framebufferTexture2D(_e,36096,be,null,0),t.framebufferTexture2D(_e,36128,be,null,0),p(36096,e.depthAttachment),p(36128,e.stencilAttachment),p(33306,e.depthStencilAttachment);var o=t.checkFramebufferStatus(_e);t.isContextLost()||36053===o||C.raise("framebuffer configuration not supported, status = "+Ee[o]),t.bindFramebuffer(_e,a.next?a.next.framebuffer:null),a.cur=a.next,t.getError()}function S(t,r){var o=new w;function h(t,e){var r;C(a.next!==o,"can not update framebuffer which is currently in use");var s=0,d=0,p=!0,v=!0,b=null,y=!0,w="rgba",k="uint8",S=1,A=null,T=null,M=null,D=!1;if("number"==typeof t)s=0|t,d=0|e||s;else if(t){C.type(t,"object","invalid arguments for framebuffer");var P=t;if("shape"in P){var L=P.shape;C(Array.isArray(L)&&L.length>=2,"invalid shape for framebuffer"),s=L[0],d=L[1]}else"radius"in P&&(s=d=P.radius),"width"in P&&(s=P.width),"height"in P&&(d=P.height);("color"in P||"colors"in P)&&(b=P.color||P.colors,Array.isArray(b)&&C(1===b.length||n.webgl_draw_buffers,"multiple render targets not supported")),b||("colorCount"in P&&(S=0|P.colorCount,C(S>0,"invalid color buffer count")),"colorTexture"in P&&(y=!!P.colorTexture,w="rgba4"),"colorType"in P&&(k=P.colorType,y?(C(n.oes_texture_float||!("float"===k||"float32"===k),"you must enable OES_texture_float in order to use floating point framebuffer objects"),C(n.oes_texture_half_float||!("half float"===k||"float16"===k),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):"half float"===k||"float16"===k?(C(n.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),w="rgba16f"):"float"!==k&&"float32"!==k||(C(n.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),w="rgba32f"),C.oneOf(k,u,"invalid color type")),"colorFormat"in P&&(w=P.colorFormat,l.indexOf(w)>=0?y=!0:c.indexOf(w)>=0?y=!1:C.optional((function(){y?C.oneOf(P.colorFormat,l,"invalid color format for texture"):C.oneOf(P.colorFormat,c,"invalid color format for renderbuffer")})))),("depthTexture"in P||"depthStencilTexture"in P)&&(D=!(!P.depthTexture&&!P.depthStencilTexture),C(!D||n.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in P&&("boolean"==typeof P.depth?p=P.depth:(A=P.depth,v=!1)),"stencil"in P&&("boolean"==typeof P.stencil?v=P.stencil:(T=P.stencil,p=!1)),"depthStencil"in P&&("boolean"==typeof P.depthStencil?p=v=P.depthStencil:(M=P.depthStencil,p=!1,v=!1))}else s=d=1;var R=null,I=null,O=null,z=null;if(Array.isArray(b))R=b.map(g);else if(b)R=[g(b)];else for(R=new Array(S),r=0;r<S;++r)R[r]=m(s,d,y,w,k);C(n.webgl_draw_buffers||R.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),C(R.length<=i.maxColorAttachments,"too many color attachments, not supported"),s=s||R[0].width,d=d||R[0].height,A?I=g(A):p&&!v&&(I=m(s,d,D,"depth","uint32")),T?O=g(T):v&&!p&&(O=m(s,d,!1,"stencil","uint8")),M?z=g(M):!A&&!T&&v&&p&&(z=m(s,d,D,"depth stencil","depth stencil")),C(!!A+!!T+!!M<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var F=null;for(r=0;r<R.length;++r)if(f(R[r],s,d),C(!R[r]||R[r].texture&&we.indexOf(R[r].texture._texture.format)>=0||R[r].renderbuffer&&ke.indexOf(R[r].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+r+" is invalid"),R[r]&&R[r].texture){var B=xe[R[r].texture._texture.format]*Ce[R[r].texture._texture.type];null===F?F=B:C(F===B,"all color attachments much have the same number of bits per pixel.")}return f(I,s,d),C(!I||I.texture&&6402===I.texture._texture.format||I.renderbuffer&&33189===I.renderbuffer._renderbuffer.format,"invalid depth attachment for framebuffer object"),f(O,s,d),C(!O||O.renderbuffer&&36168===O.renderbuffer._renderbuffer.format,"invalid stencil attachment for framebuffer object"),f(z,s,d),C(!z||z.texture&&34041===z.texture._texture.format||z.renderbuffer&&34041===z.renderbuffer._renderbuffer.format,"invalid depth-stencil attachment for framebuffer object"),x(o),o.width=s,o.height=d,o.colorAttachments=R,o.depthAttachment=I,o.stencilAttachment=O,o.depthStencilAttachment=z,h.color=R.map(_),h.depth=_(I),h.stencil=_(O),h.depthStencil=_(z),h.width=o.width,h.height=o.height,E(o),h}return s.framebufferCount++,h(t,r),e(h,{resize:function(t,e){C(a.next!==o,"can not resize a framebuffer which is currently in use");var n=Math.max(0|t,1),i=Math.max(0|e||n,1);if(n===o.width&&i===o.height)return h;for(var r=o.colorAttachments,s=0;s<r.length;++s)v(r[s],n,i);return v(o.depthAttachment,n,i),v(o.stencilAttachment,n,i),v(o.depthStencilAttachment,n,i),o.width=h.width=n,o.height=h.height=i,E(o),h},_reglType:"framebuffer",_framebuffer:o,destroy:function(){k(o),x(o)},use:function(t){a.setFBO({framebuffer:h},t)}})}return e(a,{getFramebuffer:function(t){if("function"==typeof t&&"framebuffer"===t._reglType){var e=t._framebuffer;if(e instanceof w)return e}return null},create:S,createCube:function(t){var o=Array(6);function s(t){var i;C(o.indexOf(a.next)<0,"can not update framebuffer which is currently in use");var c,h={color:null},d=0,f=null,p="rgba",g="uint8",m=1;if("number"==typeof t)d=0|t;else if(t){C.type(t,"object","invalid arguments for framebuffer");var _=t;if("shape"in _){var v=_.shape;C(Array.isArray(v)&&v.length>=2,"invalid shape for framebuffer"),C(v[0]===v[1],"cube framebuffer must be square"),d=v[0]}else"radius"in _&&(d=0|_.radius),"width"in _?(d=0|_.width,"height"in _&&C(_.height===d,"must be square")):"height"in _&&(d=0|_.height);("color"in _||"colors"in _)&&(f=_.color||_.colors,Array.isArray(f)&&C(1===f.length||n.webgl_draw_buffers,"multiple render targets not supported")),f||("colorCount"in _&&(m=0|_.colorCount,C(m>0,"invalid color buffer count")),"colorType"in _&&(C.oneOf(_.colorType,u,"invalid color type"),g=_.colorType),"colorFormat"in _&&(p=_.colorFormat,C.oneOf(_.colorFormat,l,"invalid color format for texture"))),"depth"in _&&(h.depth=_.depth),"stencil"in _&&(h.stencil=_.stencil),"depthStencil"in _&&(h.depthStencil=_.depthStencil)}else d=1;if(f)if(Array.isArray(f))for(c=[],i=0;i<f.length;++i)c[i]=f[i];else c=[f];else{c=Array(m);var b={radius:d,format:p,type:g};for(i=0;i<m;++i)c[i]=r.createCube(b)}for(h.color=Array(c.length),i=0;i<c.length;++i){var y=c[i];C("function"==typeof y&&"textureCube"===y._reglType,"invalid cube map"),d=d||y.width,C(y.width===d&&y.height===d,"invalid cube map shape"),h.color[i]={target:ye,data:c[i]}}for(i=0;i<6;++i){for(var w=0;w<c.length;++w)h.color[w].target=ye+i;i>0&&(h.depth=o[0].depth,h.stencil=o[0].stencil,h.depthStencil=o[0].depthStencil),o[i]?o[i](h):o[i]=S(h)}return e(s,{width:d,height:d,color:c})}return s(t),e(s,{faces:o,resize:function(t){var e,n=0|t;if(C(n>0&&n<=i.maxCubeMapSize,"invalid radius for cube fbo"),n===s.width)return s;var r=s.color;for(e=0;e<r.length;++e)r[e].resize(n);for(e=0;e<6;++e)o[e].resize(n);return s.width=s.height=n,s},_reglType:"framebufferCube",destroy:function(){o.forEach((function(t){t.destroy()}))}})},clear:function(){H(y).forEach(k)},restore:function(){a.cur=null,a.next=null,a.dirty=!0,H(y).forEach((function(e){e.framebuffer=t.createFramebuffer(),E(e)}))}})}(r,d,b,E,S,h),T=li(r,u,d,b,y,w,0,A,{},x,k,v,_,f,i),L=Pe(r,A,T.procs.poll,_,o,d,b),R=T.next,O=r.canvas,z=[],F=[],$=[],Z=[i.onDestroy],q=null;function G(){if(0===z.length)return f&&f.update(),void(q=null);q=D.next(G),bt();for(var t=z.length-1;t>=0;--t){var e=z[t];e&&e(_,null,0)}r.flush(),f&&f.update()}function ut(){!q&&z.length>0&&(q=D.next(G))}function ht(){q&&(D.cancel(G),q=null)}function dt(t){t.preventDefault(),s=!0,ht(),F.forEach((function(t){t()}))}function ft(t){r.getError(),s=!1,a.restore(),k.restore(),y.restore(),E.restore(),S.restore(),A.restore(),x.restore(),f&&f.restore(),T.procs.refresh(),ut(),$.forEach((function(t){t()}))}function pt(t){function n(t,e){var n={},i={};return Object.keys(t).forEach((function(r){var o=t[r];if(M.isDynamic(o))i[r]=M.unbox(o,r);else{if(e&&Array.isArray(o))for(var s=0;s<o.length;++s)if(M.isDynamic(o[s]))return void(i[r]=M.unbox(o,r));n[r]=o}})),{dynamic:i,static:n}}C(!!t,"invalid args to regl({...})"),C.type(t,"object","invalid args to regl({...})");var i=n(t.context||{},!0),r=n(t.uniforms||{},!0),o=n(t.attributes||{},!1),a=n(function(t){var n=e({},t);function i(t){if(t in n){var e=n[t];delete n[t],Object.keys(e).forEach((function(i){n[t+"."+i]=e[i]}))}}return delete n.uniforms,delete n.attributes,delete n.context,delete n.vao,"stencil"in n&&n.stencil.op&&(n.stencil.opBack=n.stencil.opFront=n.stencil.op,delete n.stencil.op),i("blend"),i("depth"),i("cull"),i("stencil"),i("polygonOffset"),i("scissor"),i("sample"),"vao"in t&&(n.vao=t.vao),n}(t),!1),l={gpuTime:0,cpuTime:0,count:0},c=T.compile(a,o,r,i,l),u=c.draw,h=c.batch,d=c.scope,f=[];return e((function(t,e){var n;if(s&&C.raise("context lost"),"function"==typeof t)return d.call(this,null,t,0);if("function"==typeof e)if("number"==typeof t)for(n=0;n<t;++n)d.call(this,null,e,n);else{if(!Array.isArray(t))return d.call(this,t,e,0);for(n=0;n<t.length;++n)d.call(this,t[n],e,n)}else if("number"==typeof t){if(t>0)return h.call(this,function(t){for(;f.length<t;)f.push(null);return f}(0|t),0|t)}else{if(!Array.isArray(t))return u.call(this,t);if(t.length)return h.call(this,t,t.length)}}),{stats:l,destroy:function(){c.destroy()}})}O&&(O.addEventListener(ui,dt,!1),O.addEventListener(hi,ft,!1));var gt=A.setFBO=pt({framebuffer:M.define.call(null,1,"framebuffer")});function mt(t,e){var n=0;T.procs.poll();var i=e.color;i&&(r.clearColor(+i[0]||0,+i[1]||0,+i[2]||0,+i[3]||0),n|=16384),"depth"in e&&(r.clearDepth(+e.depth),n|=256),"stencil"in e&&(r.clearStencil(0|e.stencil),n|=1024),C(!!n,"called regl.clear with no buffer specified"),r.clear(n)}function _t(t){return C.type(t,"function","regl.frame() callback must be a function"),z.push(t),ut(),{cancel:function(){var e=di(z,t);C(e>=0,"cannot cancel a frame twice"),z[e]=function t(){var e=di(z,t);z[e]=z[z.length-1],z.length-=1,z.length<=0&&ht()}}}}function vt(){var t=R.viewport,e=R.scissor_box;t[0]=t[1]=e[0]=e[1]=0,_.viewportWidth=_.framebufferWidth=_.drawingBufferWidth=t[2]=e[2]=r.drawingBufferWidth,_.viewportHeight=_.framebufferHeight=_.drawingBufferHeight=t[3]=e[3]=r.drawingBufferHeight}function bt(){_.tick+=1,_.time=wt(),vt(),T.procs.poll()}function yt(){E.refresh(),vt(),T.procs.refresh(),f&&f.update()}function wt(){return(P()-p)/1e3}yt();var xt=e(pt,{clear:function(t){if(C("object"==typeof t&&t,"regl.clear() takes an object as input"),"framebuffer"in t)if(t.framebuffer&&"framebufferCube"===t.framebuffer_reglType)for(var n=0;n<6;++n)gt(e({framebuffer:t.framebuffer.faces[n]},t),mt);else gt(t,mt);else mt(0,t)},prop:M.define.bind(null,1),context:M.define.bind(null,2),this:M.define.bind(null,3),draw:pt({}),buffer:function(t){return y.create(t,34962,!1,!1)},elements:function(t){return w.create(t,!1)},texture:E.create2D,cube:E.createCube,renderbuffer:S.create,framebuffer:A.create,framebufferCube:A.createCube,vao:x.createVAO,attributes:o,frame:_t,on:function(t,e){var n;switch(C.type(e,"function","listener callback must be a function"),t){case"frame":return _t(e);case"lost":n=F;break;case"restore":n=$;break;case"destroy":n=Z;break;default:C.raise("invalid event, must be one of frame,lost,restore,destroy")}return n.push(e),{cancel:function(){for(var t=0;t<n.length;++t)if(n[t]===e)return n[t]=n[n.length-1],void n.pop()}}},limits:b,hasExtension:function(t){return b.extensions.indexOf(t.toLowerCase())>=0},read:L,destroy:function(){z.length=0,ht(),O&&(O.removeEventListener(ui,dt),O.removeEventListener(hi,ft)),k.clear(),A.clear(),S.clear(),x.clear(),E.clear(),w.clear(),y.clear(),f&&f.clear(),Z.forEach((function(t){t()}))},_gl:r,_refresh:yt,poll:function(){bt(),f&&f.update()},now:wt,stats:h});return i.onDone(null,xt),xt}}()},3379:t=>{"use strict";var e=[];function n(t){for(var n=-1,i=0;i<e.length;i++)if(e[i].identifier===t){n=i;break}return n}function i(t,i){for(var o={},s=[],a=0;a<t.length;a++){var l=t[a],c=i.base?l[0]+i.base:l[0],u=o[c]||0,h="".concat(c," ").concat(u);o[c]=u+1;var d=n(h),f={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==d)e[d].references++,e[d].updater(f);else{var p=r(f,i);i.byIndex=a,e.splice(a,0,{identifier:h,updater:p,references:1})}s.push(h)}return s}function r(t,e){var n=e.domAPI(e);return n.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,r){var o=i(t=t||[],r=r||{});return function(t){t=t||[];for(var s=0;s<o.length;s++){var a=n(o[s]);e[a].references--}for(var l=i(t,r),c=0;c<o.length;c++){var u=n(o[c]);0===e[u].references&&(e[u].updater(),e.splice(u,1))}o=l}}},569:t=>{"use strict";var e={};t.exports=function(t,n){var i=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(n)}},9216:t=>{"use strict";t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},3565:(t,e,n)=>{"use strict";t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},7795:t=>{"use strict";t.exports=function(t){var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var i="";n.supports&&(i+="@supports (".concat(n.supports,") {")),n.media&&(i+="@media ".concat(n.media," {"));var r=void 0!==n.layer;r&&(i+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),i+=n.css,r&&(i+="}"),n.media&&(i+="}"),n.supports&&(i+="}");var o=n.sourceMap;o&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),e.styleTagTransform(i,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},4589:t=>{"use strict";t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},5083:function(t,e){"use strict";var n,i,r,o,s,a;window.setImmediate||(window.setImmediate=window.msSetImmediate||window.webkitSetImmediate||window.mozSetImmediate||window.oSetImmediate||function(){if(!window.postMessage||!window.addEventListener)return null;var t=[void 0],e="zero-timeout-message";return window.addEventListener("message",(function(n){if("string"==typeof n.data&&n.data.substr(0,e.length)===e){n.stopImmediatePropagation();var i=parseInt(n.data.substr(e.length),36);t[i]&&(t[i](),t[i]=void 0)}}),!0),window.clearImmediate=function(e){t[e]&&(t[e]=void 0)},function(n){var i=t.length;return t.push(n),window.postMessage(e+i.toString(36),"*"),i}}()||function(t){window.setTimeout(t,0)}),window.clearImmediate||(window.clearImmediate=window.msClearImmediate||window.webkitClearImmediate||window.mozClearImmediate||window.oClearImmediate||function(t){window.clearTimeout(t)}),i=function(){var t=document.createElement("canvas");if(!t||!t.getContext)return!1;var e=t.getContext("2d");return!!(e&&e.getImageData&&e.fillText&&Array.prototype.some&&Array.prototype.push)}(),r=function(){if(i){for(var t,e,n=document.createElement("canvas").getContext("2d"),r=20;r;){if(n.font=r.toString(10)+"px sans-serif",n.measureText("Ｗ").width===t&&n.measureText("m").width===e)return r+1;t=n.measureText("Ｗ").width,e=n.measureText("m").width,r--}return 0}}(),o=function(t){for(var e,n,i=t.length;i;)e=Math.floor(Math.random()*i),n=t[--i],t[i]=t[e],t[e]=n;return t},s={},(a=function(t,e){if(i){var n=Math.floor(Math.random()*Date.now());Array.isArray(t)||(t=[t]),t.forEach((function(e,n){if("string"==typeof e){if(t[n]=document.getElementById(e),!t[n])throw new Error("The element id specified is not found.")}else if(!e.tagName&&!e.appendChild)throw new Error("You must pass valid HTML elements, or ID of the element.")}));var a={list:[],fontFamily:'"Trebuchet MS", "Heiti TC", "微軟正黑體", "Arial Unicode MS", "Droid Fallback Sans", sans-serif',fontWeight:"normal",color:"random-dark",minSize:0,weightFactor:1,clearCanvas:!0,backgroundColor:"#fff",gridSize:8,drawOutOfBound:!1,shrinkToFit:!1,origin:null,drawMask:!1,maskColor:"rgba(255,0,0,0.3)",maskGapWidth:.3,wait:0,abortThreshold:0,abort:function(){},minRotation:-Math.PI/2,maxRotation:Math.PI/2,rotationSteps:0,shuffle:!0,rotateRatio:.1,shape:"circle",ellipticity:.65,classes:null,hover:null,click:null};if(e)for(var l in e)l in a&&(a[l]=e[l]);if("function"!=typeof a.weightFactor){var c=a.weightFactor;a.weightFactor=function(t){return t*c}}if("function"!=typeof a.shape)switch(a.shape){case"circle":default:a.shape="circle";break;case"cardioid":a.shape=function(t){return 1-Math.sin(t)};break;case"diamond":a.shape=function(t){var e=t%(2*Math.PI/4);return 1/(Math.cos(e)+Math.sin(e))};break;case"square":a.shape=function(t){return Math.min(1/Math.abs(Math.cos(t)),1/Math.abs(Math.sin(t)))};break;case"triangle-forward":a.shape=function(t){var e=t%(2*Math.PI/3);return 1/(Math.cos(e)+Math.sqrt(3)*Math.sin(e))};break;case"triangle":case"triangle-upright":a.shape=function(t){var e=(t+3*Math.PI/2)%(2*Math.PI/3);return 1/(Math.cos(e)+Math.sqrt(3)*Math.sin(e))};break;case"pentagon":a.shape=function(t){var e=(t+.955)%(2*Math.PI/5);return 1/(Math.cos(e)+.726543*Math.sin(e))};break;case"star":a.shape=function(t){var e=(t+.955)%(2*Math.PI/10);return(t+.955)%(2*Math.PI/5)-2*Math.PI/10>=0?1/(Math.cos(2*Math.PI/10-e)+3.07768*Math.sin(2*Math.PI/10-e)):1/(Math.cos(e)+3.07768*Math.sin(e))}}a.gridSize=Math.max(Math.floor(a.gridSize),4);var u,h,d,f,p,g,m,_,v=a.gridSize,b=v-a.maskGapWidth,y=Math.abs(a.maxRotation-a.minRotation),w=Math.abs(Math.floor(a.rotationSteps)),x=Math.min(a.maxRotation,a.minRotation);switch(a.color){case"random-dark":m=function(){return z(10,50)};break;case"random-light":m=function(){return z(50,90)};break;default:"function"==typeof a.color&&(m=a.color)}"function"==typeof a.fontWeight&&(_=a.fontWeight);var C=null;"function"==typeof a.classes&&(C=a.classes);var k,E=!1,S=[],A=function(t){var e,n,i=t.currentTarget,r=i.getBoundingClientRect();t.touches?(e=t.touches[0].clientX,n=t.touches[0].clientY):(e=t.clientX,n=t.clientY);var o=e-r.left,s=n-r.top,a=Math.floor(o*(i.width/r.width||1)/v),l=Math.floor(s*(i.height/r.height||1)/v);return S[a][l]},T=function(t){var e=A(t);k!==e&&(k=e,e?a.hover(e.item,e.dimension,t):a.hover(void 0,void 0,t))},M=function(t){var e=A(t);e&&(a.click(e.item,e.dimension,t),t.preventDefault())},D=[],P=function(t){if(D[t])return D[t];var e=8*t,n=e,i=[];for(0===t&&i.push([f[0],f[1],0]);n--;){var r=1;"circle"!==a.shape&&(r=a.shape(n/e*2*Math.PI)),i.push([f[0]+t*r*Math.cos(-n/e*2*Math.PI),f[1]+t*r*Math.sin(-n/e*2*Math.PI)*a.ellipticity,n/e*2*Math.PI])}return D[t]=i,i},L=function(){return a.abortThreshold>0&&(new Date).getTime()-g>a.abortThreshold},R=function(e,n,i,r,o){e>=h||n>=d||e<0||n<0||(u[e][n]=!1,i&&t[0].getContext("2d").fillRect(e*v,n*v,b,b),E&&(S[e][n]={item:o,dimension:r}))},I=function e(n){var i,s,l;Array.isArray(n)?(i=n[0],s=n[1]):(i=n.word,s=n.weight,l=n.attributes);var c=0===a.rotateRatio||Math.random()>a.rotateRatio?0:0===y?x:w>0?x+Math.floor(Math.random()*w)*y/(w-1):x+Math.random()*y,f=function(t){if(Array.isArray(t)){var e=t.slice();return e.splice(0,2),e}return[]}(n),g=function(t,e,n,i){var o=a.weightFactor(e);if(o<=a.minSize)return!1;var s,l=1;o<r&&(l=function(){for(var t=2;t*o<r;)t+=2;return t}()),s=_?_(t,e,o,i):a.fontWeight;var c=document.createElement("canvas"),u=c.getContext("2d",{willReadFrequently:!0});u.font=s+" "+(o*l).toString(10)+"px "+a.fontFamily;var h=u.measureText(t).width/l,d=Math.max(o*l,u.measureText("m").width,u.measureText("Ｗ").width)/l,f=h+2*d,p=3*d,g=Math.ceil(f/v),m=Math.ceil(p/v);f=g*v,p=m*v;var b=-h/2,y=.4*-d,w=Math.ceil((f*Math.abs(Math.sin(n))+p*Math.abs(Math.cos(n)))/v),x=Math.ceil((f*Math.abs(Math.cos(n))+p*Math.abs(Math.sin(n)))/v),C=x*v,k=w*v;c.setAttribute("width",C),c.setAttribute("height",k),u.scale(1/l,1/l),u.translate(C*l/2,k*l/2),u.rotate(-n),u.font=s+" "+(o*l).toString(10)+"px "+a.fontFamily,u.fillStyle="#000",u.textBaseline="middle",u.fillText(t,b*l,(y+.5*o)*l);var E=u.getImageData(0,0,C,k).data;if(L())return!1;for(var S,A,T,M=[],D=x,P=[w/2,x/2,w/2,x/2];D--;)for(S=w;S--;){T=v;t:for(;T--;)for(A=v;A--;)if(E[4*((S*v+T)*C+(D*v+A))+3]){M.push([D,S]),D<P[3]&&(P[3]=D),D>P[1]&&(P[1]=D),S<P[0]&&(P[0]=S),S>P[2]&&(P[2]=S);break t}}return{mu:l,occupied:M,bounds:P,gw:x,gh:w,fillTextOffsetX:b,fillTextOffsetY:y,fillTextWidth:h,fillTextHeight:d,fontSize:o}}(i,s,c,f);if(!g)return!1;if(L())return!1;if(!a.drawOutOfBound&&!a.shrinkToFit){var b=g.bounds;if(b[1]-b[3]+1>h||b[2]-b[0]+1>d)return!1}for(var k=p+1,S=function(e){var r=Math.floor(e[0]-g.gw/2),o=Math.floor(e[1]-g.gh/2);return g.gw,g.gh,!!function(t,e,n,i,r){for(var o=r.length;o--;){var s=t+r[o][0],l=e+r[o][1];if(s>=h||l>=d||s<0||l<0){if(!a.drawOutOfBound)return!1}else if(!u[s][l])return!1}return!0}(r,o,0,0,g.occupied)&&(function(e,n,i,r,o,s,l,c,u,h){var d,f,p,g=i.fontSize;d=m?m(r,o,g,s,l,h):a.color,f=_?_(r,o,g,h):a.fontWeight,p=C?C(r,o,g,h):a.classes,t.forEach((function(t){if(t.getContext){var o=t.getContext("2d"),s=i.mu;o.save(),o.scale(1/s,1/s),o.font=f+" "+(g*s).toString(10)+"px "+a.fontFamily,o.fillStyle=d,o.translate((e+i.gw/2)*v*s,(n+i.gh/2)*v*s),0!==c&&o.rotate(-c),o.textBaseline="middle",o.fillText(r,i.fillTextOffsetX*s,(i.fillTextOffsetY+.5*g)*s),o.restore()}else{var l=document.createElement("span"),h="";h="rotate("+-c/Math.PI*180+"deg) ",1!==i.mu&&(h+="translateX(-"+i.fillTextWidth/4+"px) scale("+1/i.mu+")");var m={position:"absolute",display:"block",font:f+" "+g*i.mu+"px "+a.fontFamily,left:(e+i.gw/2)*v+i.fillTextOffsetX+"px",top:(n+i.gh/2)*v+i.fillTextOffsetY+"px",width:i.fillTextWidth+"px",height:i.fillTextHeight+"px",lineHeight:g+"px",whiteSpace:"nowrap",transform:h,webkitTransform:h,msTransform:h,transformOrigin:"50% 40%",webkitTransformOrigin:"50% 40%",msTransformOrigin:"50% 40%"};for(var _ in d&&(m.color=d),l.textContent=r,m)l.style[_]=m[_];if(u)for(var b in u)l.setAttribute(b,u[b]);p&&(l.className+=p),t.appendChild(l)}}))}(r,o,g,i,s,p-k,e[2],c,l,f),function(e,n,i,r,o,s){var l,c,u=o.occupied,f=a.drawMask;if(f&&((l=t[0].getContext("2d")).save(),l.fillStyle=a.maskColor),E){var p=o.bounds;c={x:(e+p[3])*v,y:(n+p[0])*v,w:(p[1]-p[3]+1)*v,h:(p[2]-p[0]+1)*v}}for(var g=u.length;g--;){var m=e+u[g][0],_=n+u[g][1];m>=h||_>=d||m<0||_<0||R(m,_,f,c,s)}f&&l.restore()}(r,o,0,0,g,n),!0)};k--;){var A=P(p-k);if(a.shuffle&&(A=[].concat(A),o(A)),A.some(S))return!0}return!!a.shrinkToFit&&(Array.isArray(n)?n[1]=3*n[1]/4:n.weight=3*n.weight/4,e(n))},O=function(e,n,i){if(n)return!t.some((function(t){var n=new CustomEvent(e,{detail:i||{}});return!t.dispatchEvent(n)}),this);t.forEach((function(t){var n=new CustomEvent(e,{detail:i||{}});t.dispatchEvent(n)}),this)};!function(){var e=t[0];if(e.getContext)h=Math.ceil(e.width/v),d=Math.ceil(e.height/v);else{var i=e.getBoundingClientRect();h=Math.ceil(i.width/v),d=Math.ceil(i.height/v)}if(O("wordcloudstart",!0)){var r,o,l,c,m;if(f=a.origin?[a.origin[0]/v,a.origin[1]/v]:[h/2,d/2],p=Math.floor(Math.sqrt(h*h+d*d)),u=[],!e.getContext||a.clearCanvas)for(t.forEach((function(t){if(t.getContext){var e=t.getContext("2d");e.fillStyle=a.backgroundColor,e.clearRect(0,0,h*(v+1),d*(v+1)),e.fillRect(0,0,h*(v+1),d*(v+1))}else t.textContent="",t.style.backgroundColor=a.backgroundColor,t.style.position="relative"})),r=h;r--;)for(u[r]=[],o=d;o--;)u[r][o]=!0;else{var _=document.createElement("canvas").getContext("2d");_.fillStyle=a.backgroundColor,_.fillRect(0,0,1,1);var b,y,w=_.getImageData(0,0,1,1).data,x=e.getContext("2d").getImageData(0,0,h*v,d*v).data;for(r=h;r--;)for(u[r]=[],o=d;o--;){y=v;t:for(;y--;)for(b=v;b--;)for(l=4;l--;)if(x[4*((o*v+y)*h*v+(r*v+b))+l]!==w[l]){u[r][o]=!1;break t}!1!==u[r][o]&&(u[r][o]=!0)}x=_=w=void 0}if(a.hover||a.click){for(E=!0,r=h+1;r--;)S[r]=[];a.hover&&e.addEventListener("mousemove",T),a.click&&(e.addEventListener("click",M),e.style.webkitTapHighlightColor="rgba(0, 0, 0, 0)"),e.addEventListener("wordcloudstart",(function t(){e.removeEventListener("wordcloudstart",t),e.removeEventListener("mousemove",T),e.removeEventListener("click",M),k=void 0}))}l=0,0!==a.wait?(c=window.setTimeout,m=window.clearTimeout):(c=window.setImmediate,m=window.clearImmediate);var C=function(e,n){t.forEach((function(t){t.removeEventListener(e,n)}),this)},A=function t(){C("wordcloudstart",t),m(s[n])};!function(e,n){t.forEach((function(t){t.addEventListener("wordcloudstart",n)}),this)}(0,A),s[n]=c((function t(){if(l>=a.list.length)return m(s[n]),O("wordcloudstop",!1),C("wordcloudstart",A),void delete s[n];g=(new Date).getTime();var e=I(a.list[l]),i=!O("wordclouddrawn",!0,{item:a.list[l],drawn:e});if(L()||i)return m(s[n]),a.abort(),O("wordcloudabort",!1),O("wordcloudstop",!1),C("wordcloudstart",A),void delete s[n];l++,s[n]=c(t,a.wait)}),a.wait)}}()}function z(t,e){return"hsl("+(360*Math.random()).toFixed()+","+(30*Math.random()+70).toFixed()+"%,"+(Math.random()*(e-t)+t).toFixed()+"%)"}}).isSupported=i,a.minFontSize=r,a.stop=function(){if(s)for(var t in s)window.clearImmediate(s[t])},this.WordCloud=a,void 0===(n=function(){return a}.apply(e,[]))||(t.exports=n)},4677:(t,e,n)=>{"use strict";n.d(e,{fc:()=>y,ZP:()=>C,$W:()=>b});var i=n(8970);class r extends i.Z{constructor(t){super(t),this.worker=new Worker(new URL(n.p+n.u(295),n.b))}filterCategories(t,e){const n=t,i=this.parent,r=i.columnIndex[e[0]],o=r.data,s=i.filterArray,a=this.filterArray,l=r.values,c=new Set,u=this.parent.size;if("string"==typeof n){const t=l.indexOf(n);if("multitext"===r.datatype){const e=r.stringLength;for(let n=0;n<u;n++){const r=n*e;let l=!1;for(let n=r;n<r+e;n++)if(o[n]===t){l=!0;break}l?(1===a[n]&&0==--s[n]&&i.filterSize++,a[n]=0):(0===a[n]&&1==++s[n]&&i.filterSize--,a[n]=1)}}else for(let e=0;e<u;e++)o[e]===t?(1===a[e]&&0==--s[e]&&i.filterSize++,a[e]=0):(0===a[e]&&1==++s[e]&&i.filterSize--,a[e]=1)}else{for(let t of n)c.add(l.indexOf(t));if("multitext"===r.datatype){const t=r.stringLength;let e="and"===n.operand;for(let r=0;r<u;r++){const l=r*t;let u=!1,h=0;for(let i=l;i<l+t&&65535!==o[i];i++)if(c.has(o[i])){if(!e){u=!0;break}if(h++,h===n.length){u=!0;break}}u?(1===a[r]&&0==--s[r]&&i.filterSize++,a[r]=0):(0===a[r]&&1==++s[r]&&i.filterSize--,a[r]=1)}}else for(let t=0;t<u;t++)c.has(o[t])?(1===a[t]&&0==--s[t]&&i.filterSize++,a[t]=0):(0===a[t]&&1==++s[t]&&i.filterSize--,a[t]=1)}}filterMultipleCategories(t,e){const n=this.parent,i=[],r=[];for(let o=0;o<e.length;o++){const s=n.columnIndex[e[o]];i.push(s.data),r.push(s.values.indexOf(t[o]))}const o=n.filterArray,s=this.filterArray,a=n.size;for(let t=0;t<a;t++){let e=!0;for(let n=0;n<i.length;n++)if(i[n][t]!==r[n]){e=!1;break}e?(1===s[t]&&0==--o[t]&&n.filterSize++,s[t]=0):(0===s[t]&&1==++o[t]&&n.filterSize--,s[t]=1)}}getSankeyData(t,e,n={}){const i=this.parent.columnIndex[e[0]],r=this.parent.columnIndex[e[1]];n.values=i.values,n.values2=r.values,n.method=n.method||"sankey","proportion"===n.method&&(n.cats=null==n.category?null:this.parent.columnIndex[e[2]].buffer);const o=performance.now(),s=e=>{console.log(`calc sankey ${i.name} ${r.name} : ${performance.now()-o}`),t(e.data),this.worker.removeEventListener("message",s)};this.worker.addEventListener("message",s),this.worker.postMessage([this.filterBuffer,this.parent.filterBuffer,i.buffer,n,r.buffer])}getCategories(t,e,n={}){const i=this.parent.columnIndex[e];n.values=i.values,n.datatype=i.datatype,n.stringLength=i.stringLength,performance.now();const r=e=>{t(e.data),this.worker.removeEventListener("message",r)};this.worker.addEventListener("message",r),this.worker.postMessage([this.filterBuffer,this.parent.filterBuffer,i.buffer,n])}destroy(){super.destroy(),this.worker.terminate()}}i.Z.types.category_dimension=r;var o=n(3117);class s extends i.Z{constructor(t){super(t),this.worker=new Worker(new URL(n.p+n.u(864),n.b))}getAverages(t,e,n={}){n.method=n.method||"mean";const i=performance.now(),r=this.parent.columnIndex;this.worker.onmessage=e=>{console.log("calc averages  "+(performance.now()-i)),t(e.data)},n.values=r[e[0]].values,n.columns=e.slice(1);const o=[];for(let t=1;t<e.length;t++)o.push([r[e[t]].buffer,r[e[t]].datatype]);this.worker.postMessage([this.filterBuffer,this.parent.filterBuffer,r[e[0]].buffer,o,n])}destroy(){super.destroy(),this.worker.terminate()}}i.Z.types.catcol_dimension=s;class a extends o.Z{constructor(t,e){super(t,e),this.worker.terminate(),this.worker=new Worker(new URL(n.p+n.u(657),n.b))}getKernalDensity(t,e,n={}){const i=performance.now(),r=this.parent.columnIndex[e[0]],o=this.parent.columnIndex[e[1]];this.parent.getMinMaxForColumn(e[1]),n.type="kernal_density",n.scaletrim&&(n.scaletrim=o.quantiles[n.scaletrim]),n.values=r.values,this.worker.onmessage=e=>{console.log(`calculate violin ${r.name} : ${performance.now()-i}`),t(e.data)},this.worker.postMessage([this.filterBuffer,this.parent.filterBuffer,r.buffer,[o.buffer,o.datatype],n])}getMultiBoxPlotData(t,e,n={}){const i=this.parent.columnIndex,r=performance.now(),o=e.map((t=>[i[t].buffer,c.Index[t].datatype]));n.analysis="multi",n.cat=this.parent.getColumnValues(e[0]).indexOf(n.category),this.worker.onmessage=n=>{console.log(`calculate multiboxplot cols:${e.length} time: ${performance.now()-r}`),t(n.data)},this.worker.postMessage([this.filterBuffer,this.parent.filterBuffer,o.slice(1),o[0],n])}getBoxPlotData(t,e,n={}){const i=performance.now(),r=this.parent.columnIndex[e[0]],o=this.parent.columnIndex[e[1]];n.analysis="boxplot",n.values=r.values,this.worker.onmessage=e=>{console.log(`calculate boxplot ${r.name} : ${performance.now()-i}`),t(e.data)},this.worker.postMessage([this.filterBuffer,this.parent.filterBuffer,r.buffer,[o.buffer,o.datatype],n])}}i.Z.types.catrange_dimension=a,n(8796);var l=n(1031),u=n(1102),h=n(4182);function d(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function f(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function p(t){var e=1,n=t(d(e),f(e));return n.constant=function(n){return arguments.length?t(d(e=+n),f(e)):e},(0,l.Q)(n)}function g(){var t=p((0,u.l4)());return t.copy=function(){return(0,u.JG)(t,g()).constant(t.constant())},h.o.apply(t,arguments)}var m=n(7636),_=n(2921);function v(t,e,n=_.Z){if(i=t.length){if((e=+e)<=0||i<2)return+n(t[0],0,t);if(e>=1)return+n(t[i-1],i-1,t);var i,r=(i-1)*e,o=Math.floor(r),s=+n(t[o],o,t);return s+(+n(t[o+1],o+1,t)-s)*(r-o)}}function b(t){t=t.replace("#","");var e=parseInt(t,16);return[e>>16&255,e>>8&255,255&e]}function y(t){return"#"+t.map((t=>{const e=t.toString(16);return 1===e.length?"0"+e:e})).join("")}const w=["#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999","#1CE6FF","#FF34FF","#FF4A46","#008941","#676FA6","#A30059","#FFDBE5","#7A4900","#0000A6","#63FFAC","#B79762","#004D43","#8FB0FF","#997D87","#5A0007","#809693","#FEFFE6","#1B4400","#4FC601","#3B5DFF","#4A3B53","#FF2F80","#61615A","#BA0900","#6B7900","#00C2A0","#FFAA92","#FF90C9","#B903AA","#D16100","#DDEFFF","#000035","#7B4F4B","#A1C299","#300018","#0AA6D8","#013349","#00846F","#372101","#FFB500","#C2FFED","#A079BF","#CC0744","#C0B9B2","#C2FF99","#001E09","#00489C","#6F0062","#0CBD66","#EEC3FF","#456D75","#B77B68","#7A87A1","#788D66","#885578","#FAD09F","#FF8A9A","#D157A0","#BEC459","#456648","#0086ED","#886F4C","#34362D","#B4A8BD","#00A6AA","#452C2C","#636375","#A3C8C9","#FF913F","#938A81","#575329","#00FECF","#B05B6F","#8CD0FF","#3B9700","#04F757","#C8A1A1","#1E6E00","#7900D7","#A77500","#6367A9","#A05837","#6B002C","#772600","#D790FF","#9B9700","#549E79","#FFF69F","#201625","#72418F","#BC23FF","#99ADC0","#3A2465","#922329","#5B4534","#FDE8DC"],x=["#3288bd","#66c2a5","#abdda4","#e6f598","#fee08b","#fdae61","#f46d43","#d53e4f"],C=class{constructor(t,e={},n=null){if(this.size=t,this.filterSize=t,this.columns=[],this.columnIndex={},this.listeners={},this.indexes={},this.filterBuffer=new SharedArrayBuffer(t),this.filterArray=new Uint8Array(this.filterBuffer),this.dimensions=[],this.name=e.name,this.avivator=e.avivator,this.textDecoder=new TextDecoder,this.columnGroups={},this.subtypeToGroup={},this.interactions=e.interactions,this.deeptools=e.deeptools,this.subgroups={},this.subgroupDataSources=new Set,this.accessOtherDataStore=[],this.syncColumnColors=[],this.linkColumns=[],this.regions=e.regions,e.row_data_loader&&(n?.rowDataLoader?(this.rowDataLoader=n.rowDataLoader,this.rowData=new Map):console.warning(`datasource ${this.name} requires a row data loader but none has been supplied`)),e.binary_data_loader&&(n?.binaryDataLoader?(this.binaryDataLoader=n.binaryDataLoader,this.binaryData=new Map):console.warning(`datasource ${this.name} requires a binary data loader but none has been supplied`)),this.columnsWithData=[],this.dirtyColumns={added:{},removed:{},data_changed:{},colors_changed:{}},this.dirtyMetadata=new Set,e.offsets&&(e.offsets.values=e.offsets.values||{},this.offsets=e.offsets),this.images=e.images,this.genome_browser=e.genome_browser,this.tree_diagram=e.tree_diagram,e.columns)for(let t of e.columns)this.addColumn(t,t.data);if(e.columnGroups)for(let t of e.columnGroups)this.addColumnGroup(t);if(e.large_images&&(this.large_images=e.large_images),e.links){this.links=e.links;for(let t in e.links){const n=e.links[t];if(n.rows_as_columns){const e=n.rows_as_columns.subgroups;this.subgroupDataSources.add(t);for(let i in e)this.subgroups[i]={subgroup:e[i],dataSource:t,name_column:n.rows_as_columns.name_column}}n.access_data&&this.accessOtherDataStore.push({dataSource:t,index:n.index}),n.sync_column_colors&&this.syncColumnColors.push({dataSource:t,columns:n.sync_column_colors}),n.columns&&this.linkColumns.push({dataSource:t,columns:n.columns})}}}isFiltered(){return this.filterSize!==this.size}addListener(t,e){this.listeners[t]=e}removeListener(t){delete this.listeners[t]}_callListeners(t,e){for(let n in this.listeners)this.listeners[n](t,e)}removeAllFilters(){this.filterArray.fill(0);let t=[];for(let e of this.dimensions)if(e.noclear)t.push(e);else if(e.filterArray.fill(0),e.filterMethod=null,e.bgfArray)for(let t=0;t<this.size;t++)0===e.bgfArray[t]&&(e.filterArray[t]=2);this.filterSize=this.size;for(let e of t){const t=e.filterArray;for(let e=0;e<t.length;e++)1===t[e]&&1==++this.filterArray[e]&&this.filterSize--}this._callListeners("filtered","all_removed")}dataChanged(t,e=!0){let n=!1;for(let e of this.dimensions)e.reFilterOnDataChanged(t)&&(n=!0);if(e)for(let e of t)this.setColumnIsDirty(e);n&&this._callListeners("filtered"),this._callListeners("data_changed",{columns:t,hasFiltered:n})}dataHighlighted(t,e){this.highightedData=t,this.loadRowData(t[0]).then((n=>this._callListeners("data_highlighted",{indexes:t,source:e,data:n})))}async loadRowData(t){if(!this.rowDataLoader)return null;if(this.rowData.has(t))return this.rowData.get(t);const e=await this.rowDataLoader(this.name,t);return this.rowData.set(t,e),e}async loadBinaryData(t){if(!this.binaryDataLoader)return null;if(this.binaryData.has(t))return this.binaryData.get(t);const e=await this.binaryDataLoader(this.name,t);return this.binaryData.set(t,e),e}getHighlightedData(){return this.highightedData}triggerFilter(){this._callListeners("filtered")}setColumnIsDirty(t){this.dirtyColumns.added[t]||(this.dirtyColumns.data_changed[t]=!0)}setAllColumnsClean(){this.dirtyColumns.added={},this.dirtyColumns.removed={},this.dirtyColumns.data_changed={},this.dirtyColumns.colors_changed={},this.dirtyMetadata.clear()}getFilter(){return this.filterArray}isRowFiltered(t){return 0===this.filterArray[t]}_calculateCategories(t){let e=t.values,n=t.data,i={};for(let t of e)i[t]=0;for(let t=0;t<n.length;t++)i[e[n[t]]]++}addColumn(t,e=null,n=!1){let i={name:t.name,field:t.field,datatype:t.datatype};i.field||(i.field=t.name),t.colors&&(i.colors=t.colors),t.editable&&(i.editable=!0),t.is_url&&(i.is_url=!0),t.subgroup&&(i.subgroup=t.subgroup,i.sgindex=t.sgindex,i.sgtype=t.sgtype),"text"===t.datatype||"multitext"===t.datatype?(i.stringLength=t.stringLength,i.values=t.values||[`Error: no values for '${i.name}'`]):"double"===t.datatype||"integer"===t.datatype||"int32"===t.datatype?(i.colorLogScale=t.colorLogScale,i.minMax=t.minMax,i.quantiles=t.quantiles):i.stringLength=t.stringLength,this.columns.push(i),this.columnIndex[i.field]=i,e&&this.setColumnData(t.field,e),n&&(this.dirtyColumns.added[t.field]=!0)}getSuggestedValues(t,e,n=10){const i=this.columnIndex[e],r=t.toLowerCase(),o=t.toUpperCase(),s=[];if("unique"===i.datatype){const e=new TextEncoder,a=e.encode(r),l=e.encode(o),c=t.length,u=i.data,h=i.stringLength;for(let t=0;t<u.length-c;t++){let e=!0;for(let n=0;n<c;n++)if(a[n]!=u[t+n]&&l[n]!=u[t+n]){e=!1;break}if(e){const e=Math.floor(t/h),r=this.textDecoder.decode(i.data.slice(e*h,e*h+h)).replaceAll("\0","");if(s.push({value:r,index:e}),s.length>n)break}}}else if("text"===i.datatype||"multitext"===i.datatype){const e=t.length;for(let t=0;t<i.values.length;t++){const a=i.values[t];let l=!0;for(let t=0;t<a.length-e;t++){l=!0;for(let n=0;n<e;n++){if(a[n+t]!==r[n]&&a[n+t]!==o[n]){l=!1;break}console.log("match")}if(l)break;console.log(t)}if(l&&(s.push({value:a,index:t}),s.length>n))break}}return s}addColumnFromField(t){const e=t.split("|");if(3!==e.length)throw new Error(`field ${t} cannot be found in datasource ${this.name}`);let n=this.subtypeToGroup[e[0]],i=null;n?i=n.subgroups[e[0]]:(n=this.subgroups[e[0]],i=n.subgroup),this.columnIndex[t]||this.addColumn({name:e[1],field:t,datatype:"double",subgroup:i.name,sgindex:e[2],sgtype:i.type})}getColumnList(t=null,e=!1){const n=[],i={},r=Object.keys(this.subgroups).map((t=>(i[t]=[],t))),o=Array.isArray(t),s=0!==r.length;for(let e in this.columnIndex){const a=this.columnIndex[e];if(t)if(o){if(-1===t.indexOf(a.datatype))continue}else if("number"===t){if("text"===a.datatype||"unique"===a.datatype||"multitext"===a.datatype)continue}else if("all"!==t&&t!==a.datatype)continue;if(s){let t=!1;for(let e of r)if(a.field.startsWith(`${e}|`)){const n=this.subgroups[e];i[e].push({name:a.name,field:a.field,datatype:a.datatype,subgroup:{dataSource:n.dataSource,name_column:n.name_column}}),t=!0;break}if(t)continue}n.push({name:a.name,field:a.field,datatype:a.datatype})}let a=n.sort(((t,e)=>t.name.localeCompare(e.name)));if(s)for(let t in i)i[t].sort(((t,e)=>t.name.localeCompare(e.name))),a=a.concat(i[t]);return e&&a.push({name:"None",field:"__none__"}),a}getDimension(t){if(!i.Z.types[t])throw`Adding non existent Dimension: ${t}`;const e=new i.Z.types[t](this);return this.dimensions.push(e),e}getRowAsObject(t,e){e||(e=this.columnsWithData);const n={};for(let i of e){const e=this.columnIndex[i];let r=e.data[t];if("text"===e.datatype)r=e.values[r];else if("double"===e.datatype||"integer"===e.datatype||"int32"===e.datatype)isNaN(r)&&(r="missing");else if("multitext"==e.datatype){const n=e.data.slice(t*e.stringLength,t*e.stringLength+e.stringLength);r=Array.from(n.filter((t=>65535!=t))).map((t=>e.values[t])).join(", ")}else r=this.textDecoder.decode(e.data.slice(t*e.stringLength,t*e.stringLength+e.stringLength)),r=r.replaceAll("\0","");n[i]=r}return n.__index__=t,n}getFirstFilteredIndex(){for(let t=0;t<this.size;t++)if(0===this.filterArray[t])return t}getFilteredValues(t){const e=new Array(this.filterSize);let n=0;for(let i=0;i<this.size;i++)0===this.filterArray[i]&&(e[n]=this.getRowText(i,t),n++);return e}getRowText(t,e){return this.getRowAsObject(t,[e])[e]}setColumnOffset(t,e){if(!this.offsets)throw new Error("Attempting to set offsets but none are specified in config");t.filter=t.filter||"all";const n=this.offsets.values;let i=n[t.filter];i||(i={},n[t.filter]=i);let r=i[t.group];r||(r={offsets:[0,0],rotation:0},i[t.group]=r),this.updateColumnOffsets(t,t.rotation,e),this.dirtyMetadata.add("offsets")}_getRotationOrigin(t,e,n){const i=this.offsets,r=this.columnIndex[t],o=r.values.indexOf(e),s=r.data,a=this.columnIndex[i.param[0]],l=this.columnIndex[i.param[1]];let c=null,u=null;i.background_filter&&(u=this.columnIndex[i.background_filter],c=u.values.indexOf(n));let h=[Number.MAX_VALUE,Number.MIN_VALUE],d=[Number.MAX_VALUE,Number.MIN_VALUE];for(let t=0;t<this.size;t++)u&&u.data[t]!==c||s[t]===o&&(h[0]=Math.min(h[0],a.originalData[t]),h[1]=Math.max(h[1],a.originalData[t]),d[0]=Math.min(d[0],l.originalData[t]),d[1]=Math.max(d[1],l.originalData[t]));const f=t=>t[0]+(t[1]-t[0])/2;return[f(h),f(d)]}initiateOffsets(){const t=this.offsets,e=this.columnIndex[t.param[0]],n=this.columnIndex[t.param[1]];e.originalData=new Float32Array(e.data),n.originalData=new Float32Array(n.data)}_getOffsetValues(t,e){const n=this.offsets;let i=null,r=null;if(n.background_filter){const t=this.columnIndex[n.background_filter];i=t.data,r=t.values}const o=this.columnIndex[n.groups],s=[];for(let a in n.values)if(!t||a===t.filter)for(let l in n.values[a]){if(t&&l!==t.group)continue;let c=n.values[a][l];const u={index:o.values.indexOf(l)};if("all"!==a&&(u.filterData=i,u.filterValue=r.indexOf(a)),e&&(c.rotation_center||(c.rotation_center=this._getRotationOrigin(n.groups,l,a)),u.rotation_center=[c.rotation_center[0]+c.offsets[0],c.rotation_center[1]+c.offsets[1]]),t?e?(u.rotation=t.rotation,c.rotation+=t.rotation):(c.offsets[0]+=t.offsets[0],c.offsets[1]+=t.offsets[1],u.offsets=t.offsets):e?u.rotation=c.rotation:u.offsets=c.offsets,e){const t=Math.PI/180*u.rotation;u.cos=Math.cos(t),u.sin=Math.sin(t)}s.push(u)}return s}resetColumnOffsets(t,e,n){t=t||"all";const i=this.offsets;if(!i)throw new Error("Attempting to reset offsets but none are specified in config");delete this.offsets.values[t][e];let r=null,o=null;"all"!==t&&(r=this.columnIndex[this.offsets.background_filter],o=r.values.indexOf(t));const s=this.getColumnValues(i.groups).indexOf(e),a=this.columnIndex[i.groups].data,l=this.columnIndex[i.param[0]],c=this.columnIndex[i.param[1]];for(let t=0;t<this.size;t++)r&&r[t]!==o||a[t]===s&&(c.data[t]=c.originalData[t],l.data[t]=l.originalData[t]);n&&this.dataChanged([i.param[0],i.param[1]],!1),this.dirtyMetadata.add("offsets")}updateColumnOffsets(t,e=!1,n=!1){const i=this.offsets,r=this.columnIndex[i.groups].data,o=this.columnIndex[i.param[0]],s=this.columnIndex[i.param[1]],a=this._getOffsetValues(t,e);for(let t=0;t<this.size;t++)for(let n of a)if((!n.filterData||n.filterData[t]===n.filterValue)&&r[t]===n.index)if(e){let e=n.rotation_center[0],i=n.rotation_center[1],r=n.cos*(o.data[t]-e)+n.sin*(s.data[t]-i)+e,a=n.cos*(s.data[t]-i)-n.sin*(o.data[t]-e)+i;o.data[t]=r,s.data[t]=a}else o.data[t]=o.data[t]+n.offsets[0],s.data[t]=s.data[t]+n.offsets[1];n&&this.dataChanged([i.param[0],i.param[1]],!1)}getColumnIndex(t){if(this.indexes[t])return this.indexes[t];const e=this.columnIndex[t],n={};if("unique"===e.datatype)for(let t=0;t<this.size;t++){let i=this.textDecoder.decode(e.data.slice(t*e.stringLength,t*e.stringLength+e.stringLength)).replaceAll("\0","");i.includes("#")&&(i=i.split("#")[1]),n[i]=t}else for(let t=0;t<this.size;t++)n[e.values[e.data[t]]]=t;return this.indexes[t]=n,n}getDataAsBlob(t,e="all",n="\t",i="\n"){let r=null;"string"!=typeof e&&(r=e);const o=[],s=["index"].concat(t),a=r?r.length:this.size;o.push(s.join(n));for(let i=0;i<a;i++){let s=i;if(r)s=r[i];else if("filtered"===e&&1===this.filterArray[i])continue;const a=this.getRowAsObject(s,t),l=[i].concat(t.map((t=>a[t])));o.push(l.join(n))}return new Blob([o.join(i)],{type:"text/plain"})}setColumnData(t,e){let n=this.columnIndex[t];if(!n)throw`column ${t} is not present in data store`;let i=null;if(i=Array.isArray(e)?this._convertColumn(n,e):e,n.buffer=i,"integer"===n.datatype||"double"==n.datatype||"int32"===n.datatype){const t=n.data="int32"===n.datatype?new Int32Array(i):new Float32Array(i);if(!n.minMax){let e=Number.MAX_VALUE,i=Number.MIN_VALUE;for(let n=0;n<t.length;n++){let r=t[n];isNaN(r)||(e=r<e?r:e,i=r>i?r:i)}n.minMax=[e,i]}if(!n.quantiles){const t=n.data.filter((t=>!isNaN(t))).sort();n.quantiles={};for(let e of[.05,.01,.001])n.quantiles[e]=[v(t,e),v(t,1-e)]}}else"multitext"===n.datatype?n.data=new Uint16Array(i):n.data=new Uint8Array(i);this.columnsWithData.push(t)}appendColumnData(t,e,n){let i=this.columnIndex[t],r=Uint8Array,o=n;"integer"===i.datatype||"double"===i.datatype?(o*=4,r=Float32Array):"int32"===i.datatype?(o*=4,r=Int32Array):"unique"===i.datatype&&(o*=i.stringLength);let s=new SharedArrayBuffer(o),a=new r(s);a.set(i.data),a.set(new r(e),i.data.length),i.data=a,i.buffer=s}addDataToStore(t,e){const n=e+this.size;for(let e of t)this.appendColumnData(e.column,e.data,n);let i=new SharedArrayBuffer(n),r=new Uint8Array(i);r.set(this.filterArray),this.filterBuffer=i,this.filterArray=r,this.size=n,this.filterSize+=e;for(let t of this.dimensions)t.updateSize();this._callListeners("data_added",this.size)}cleanColumnData(t){const e={},n=this.columnIndex[t];for(let t in n.values)e[t]=0;for(let t=0;t<this.size;t++)e[n.data[t]]++;const i=[],r={};for(let t=0;t<n.values.length;t++)0!==e[t]&&(i.push(n.values[t]),r[t]=i.length-1);for(let t=0;t<this.size;t++)n.data[t]=r[n.data[t]];n.values=i,this.setColumnIsDirty(t),this.dataChanged([t])}_convertColumn(t,e){const n=e.length;if("text"===t.datatype){const i=new SharedArrayBuffer(this.size),r={};for(let t=0;t<n;t++){const n=e[t];void 0===r[n]?r[n]=1:r[n]++}const o=[];for(let t in r)o.push([t,r[t]]);t.values=[];const s={};o.sort(((t,e)=>e[1]-t[1]));for(let e=0;e<o.length;e++)t.values.push(o[e][0]),s[o[e][0]]=e;const a=new Uint8Array(i);for(let t=0;t<n;t++)a[t]=s[e[t]];return i}if("integer"===t.datatype||"double"===t.datatype||"int32"===t.datatype){const i=new SharedArrayBuffer(4*this.size),r="int32"===t.datatype?new Int32Array(i):new Float32Array(i);for(let t=0;t<n;t++)r[t]=e[t];return i}if("multitext"===t.datatype){let i=new Set,r=0;for(let t=0;t<n;t++){const n=e[t].split(",");r=Math.max(r,n.length),n.forEach((t=>i.add(t.trim())))}i.delete("");const o=new SharedArrayBuffer(this.size*r*2),s=new Uint16Array(o);s.fill(65535);const a=new Array(i.size),l={};let c=0;for(let t of i)l[t]=c,a[c]=t,c++;for(let t=0;t<n;t++){const n=t*r,i=e[t];if(""===i)continue;const o=i.split(",");o.sort();for(let t=0;t<o.length;t++)s[n+t]=l[o[t].trim()]}return t.values=a,t.stringLength=r,o}{let i=0;for(let t=0;t<n;t++)i=Math.max(i,e[t].length);t.stringLength=i;const r=new TextEncoder,o=new SharedArrayBuffer(this.size*i);for(let t=0;t<n;t++){const n=r.encode(e[t].substring(0,i));new Uint8Array(o,t*i,i).set(n,0)}return o}}getColorFunction(t,e={}){let n=this.columnIndex[t];null==t&&(n=t={datatype:e.datatype},e.useValue=!0);const i=n.data,r=e.overideValues||{};let o=this.getColumnColors(t,e);function s(t){return isNaN(t)||r.fallbackOnZero&&0===t}if("text"===n.datatype)return t=>o[i[t]];if("integer"===n.datatype||"double"===n.datatype||"int32"===n.datatype){const t=null==r.min?n.minMax[0]:r.min,a=null==r.max?n.minMax[1]:r.max,l=e.bins||100,c=(a-t)/l,u=e.asArray?[255,255,255]:"#ffffff";return e.useValue?e=>{if(s(e))return u;let n=Math.floor((e-t)/c);return n<0?n=0:n>=o.length&&(n=o.length-1),o[n]}:e=>{const n=i[e];if(s(n))return u;let r=Math.floor((n-t)/c);return r<0?r=0:r>=o.length&&(r=o.length-1),o[r]}}}getColorForCategory(t,e){const n=this.columnIndex[t].values.indexOf(e);return this.getColumnColors(t)[n]}getColorLegend(t,e={}){const n=this.getColumnColors(t,e),i=this.columnIndex[t],r=e.name||i.name;if("integer"===i.datatype||"double"===i.datatype||"int32"===i.datatype){let t=i.minMaX;if(e.overideValues){const n=e.overideValues;t=[null==n.min?i.minMax[0]:n.min,null==n.max?i.minMax[1]:n.max]}return(0,m.kE)(n,{range:t,label:r})}if("text"===i.datatype)return(0,m.Ee)(n,i.values,{label:r})}getValueToColor(t){const e={},n=this.getColumnColors(t),i=this.getColumnValues(t);for(let t=0;t<i.length;t++)e[i[t]]=n[t];return e}getColumnQuantile(t,e){const n=this.columnIndex[t];return e&&"none"!==e?n.quantiles&&"NA"!==n.quantiles?[n.quantiles[e][0],n.quantiles[e][1]]:void 0:n.minMax}setColumnColors(t,e,n=!1){const i=this.columnIndex[t];if(e.length!==i.values.length)throw new Error(`${t} being set with incorrect number of columns `);i.colors=e.slice(0),this.dirtyColumns.colors_changed[t]=!0,n&&this.dataChanged([t],!1)}getColumnColors(t,e={}){let n=t;"string"==typeof t&&(n=this.columnIndex[t]);const i=e.asArray;if("double"===n.datatype||"integer"===n.datatype||"int32"===n.datatype){const t=e.overideValues||{},o=t.colors||n.colors||x,s=null==t.min?n.minMax[0]:t.min,a=null==t.max?n.minMax[1]:t.max,c=function(t,e,n){for(var i=[],r=(e-t)/(n-1),o=0;o<n-1;)i.push(t+o*r),o++;return i.push(e),i}(s,a,o.length),u=(0,l.Z)().domain(c).range(o).clamp(!0),h=t.bins||100,d=(a-s)/h;let f=new Array(h+1);for(let t=0;t<h+1;t++)f[t]=u(s+t*d),i&&(f[t]=(r=f[t])?(r=r.substring(4,r.length-1).split(", ")).map((t=>parseInt(t))):[255,255,255]);let p=n.colorLogScale;if(null!=t.colorLogScale&&(p=t.colorLogScale),p){const t=g().domain([s,a]).range([0,h]).clamp(!0),e=new Array(h+1);for(let n=0;n<h+1;n++)e[n]=f[Math.floor(t(s+n*d))];f=e}return f}var r;if("text"===n.datatype||"multitext"===n.datatype){let t=n.colors;if(!t){const e=n.values.length,i=w.length;if(e<i)t=w.slice(0,e);else{t=[];const n=Math.floor(e/i);for(let e=0;e<n;e++)t=t.concat(w);t=t.concat(w.slice(0,e%i))}}return i&&(t=t.map((t=>b(t)))),t}}addColumnGroup(t){t.columns||(t.columns=[]),this.columnGroups[t.name]=t}getColumnGroup(t){const e=this.columnGroups[t];return e?e.columns:null}getRawColumn(t){return this.columnIndex[t].data}getMinMaxForColumn(t){return this.columnIndex[t].minMax}getColumnRange(t){const e=this.columnIndex[t];return e.minMax?e.minMax[1]-e.minMax[0]:(console.error("unknown minMax for column "+t),[0,50])}getColumnInfo(t){const e=this.columnIndex[t];return{name:e.name,field:e.field,datatype:e.datatype,stringLength:e.stringLength,subgroup:e.subgroup,sgindex:e.sgindex,sgtype:e.sgtype}}getLoadedColumns(){return this.columns.filter((t=>null!=t.data)).map((t=>t.field))}getAllColumns(){return this.columns.map((t=>t.field))}getColumnValues(t,e=null){const n=this.columnIndex[t].values;return"name_value"===e?Array.from(n,(t=>({name:t,value:t}))).sort(((t,e)=>t.name.localeCompare(e.name))):n}getColumnName(t){const e=this.columnIndex[t];return e?e.name:null}removeColumn(t,e=!1,n=!1){const i=this.columnIndex[t];i.data=null,i.buffer=null,this.columns=this.columns.filter((e=>e.field!==t)),delete this.columnIndex[t];const r=this.columnsWithData.indexOf(t);-1!==r&&this.columnsWithData.splice(r,1),e&&(this.dirtyColumns.added[t]?delete this.dirtyColumns.added[t]:this.dirtyColumns.removed[t]=!0),n&&this._callListeners("column_removed",t)}}},8796:(t,e,n)=>{"use strict";var i=n(3117),r=n(8970);class o extends i.Z{constructor(t){super(t),this.worker.terminate(),this.worker=new Worker(new URL(n.p+n.u(545),n.b))}getDensityContours(t,e,n={}){const i=performance.now(),r=this.parent.columnIndex;this.worker.onmessage=e=>{console.log("calc density contours  "+(performance.now()-i)),t(e.data)},this.worker.postMessage([this.filterBuffer,this.parent.filterBuffer,[r[e[0]].buffer,r[e[0]].datatype],[r[e[1]].buffer,r[e[1]].datatype],r[e[2]].buffer,n])}}r.Z.types.density_dimension=o},8970:(t,e,n)=>{"use strict";n.d(e,{Z:()=>r});class i{constructor(t){this.filterBuffer=new SharedArrayBuffer(t.size),this.parent=t,this.filterArray=new Uint8Array(this.filterBuffer),this.filterArguments=null,this.filterIndexes=null,this.filterMethod=null}removeFilter(t=!0){if(!this.filterMethod)return;const e=this.parent.filterArray,n=this.filterArray,i=this.parent,r=this.parent.size;delete this.filterArguments,delete this.filterColumns,delete this.filterMethod;for(let t=0;t<r;t++)1===n[t]&&(0==--e[t]&&i.filterSize++,n[t]=0);if(this.bgfArray)for(let t=0;t<r;t++)0===this.bgfArray[t]&&(0==--e[t]&&i.filterSize++,n[t]=2);t&&this.parent._callListeners("filtered",this)}getLocalFilter(){return this.filterArray}filterOnIndex(t){const e=this.parent.filterArray,n=this.parent.size,i=this.filterArray,r=this.parent;for(let o=0;o<n;o++)t.has(o)?(1===i[o]&&0==--e[o]&&r.filterSize++,i[o]=0):(0===i[o]&&1==++e[o]&&r.filterSize--,i[o]=1)}filter(t,e,n,i=!0){const r=performance.now();if(this.filterColumns=e,this.filterArguments=n,this.filterMethod=t,this[t](n,e),this.bgfArray){const t=this.parent.filterArray,e=this.parent.size,n=this.filterArray,i=this.parent;for(let r=0;r<e;r++)0===this.bgfArray[r]&&(1==++t[r]&&i.filterSize--,n[r]=2)}i&&this.parent._callListeners("filtered",this),console.log(`method${t}: ${performance.now()-r}`)}reFilterOnDataChanged(t){if(this.filterMethod&&this.filterColumns)for(let e of this.filterColumns)if("string"==typeof e&&-1!==t.indexOf(e))return this.filter(this.filterMethod,this.filterColumns,this.filterArguments,!1),!0;return!1}updateSize(){let t=new SharedArrayBuffer(this.parent.size),e=new Uint8Array(t);e.set(this.filterArray),this.filterBuffer=t,this.filterArray=e,this.bgfArray&&(this.bgfData,this.setBackgroundFilter(b.column.b.cat)),this.filterMethod&&this.filter(this.filterMethod,this.filterColumns,this.filterArguments,!1)}setBackgroundFilter(t,e){const n=this.parent.columnIndex[t],i=n.values.indexOf(e),r=n.data;this.bgfData={column:t,cat:e},this.bgfArray=new Uint8Array(this.parent.size);for(let t=0;t<this.parent.size;t++)r[t]===i?this.bgfArray[t]=1:this.filterArray[t]=2}clearBackGroundFilter(){this.bgfArray=null,this.bgfData=null}destroy(t=!0){this.removeFilter(t),this.filterBuffer=null,this.localFilter=null,this.parent.dimensions.splice(this.parent.dimensions.indexOf(this),1)}}i.types={base_dimension:i};const r=i},3117:(t,e,n)=>{"use strict";n.d(e,{Z:()=>o});var i=n(8970);class r extends i.Z{constructor(t,e){super(t,e),this.worker=new Worker(new URL(n.p+n.u(220),n.b))}filterSquare(t,e){let n=null;n="string"!=typeof e[0]?e[0]:this.parent.columnIndex[e[0]].data;const i=this.parent.columnIndex[e[1]].data,r=this.parent.filterArray,o=this.parent,s=t.range1,a=t.range2,l=this.filterArray;for(let t=0;t<this.parent.size;t++){const e=n[t],c=i[t];e<s[0]||e>s[1]||c<a[0]||c>a[1]||isNaN(e)||isNaN(c)?(0===l[t]&&1==++r[t]&&o.filterSize--,l[t]=1):(1===l[t]&&0==--r[t]&&o.filterSize++,l[t]=0)}}filterPoly(t,e){const n=t;let i=Number.MAX_VALUE,r=Number.MAX_VALUE,o=Number.MIN_VALUE,s=Number.MIN_VALUE;for(let t of n)i=Math.min(i,t[0]),o=Math.max(o,t[0]),r=Math.min(r,t[1]),s=Math.max(s,t[1]);let a=null;a="string"!=typeof e[0]?e[0]:this.parent.columnIndex[e[0]].data;const l=this.parent.columnIndex[e[1]].data,c=this.parent.filterArray,u=this.parent,h=u.size,d=n,f=this.filterArray;for(let t=0;t<h;t++){let e=a[t],n=l[t],h=!1;if(e<i||e>o||n<r||n>s||isNaN(e)||isNaN(n))0===f[t]&&1==++c[t]&&u.filterSize--,f[t]=1;else{for(let t=0,i=d.length-1;t<d.length;i=t++){let r=d[t][0],o=d[t][1],s=d[i][0],a=d[i][1];o>n!=a>n&&e<(s-r)*(n-o)/(a-o)+r&&(h=!h)}h?(1===f[t]&&0==--c[t]&&u.filterSize++,f[t]=0):(0===f[t]&&1==++c[t]&&u.filterSize--,f[t]=1)}}}filterRange(t,e){const n=t.min,i=t.max,r=this.parent.columnIndex[e[0]].data,o=this.parent.filterArray,s=this.filterArray,a=this.parent;for(let t=0;t<this.parent.size;t++){const e=r[t];e<n||e>i||isNaN(e)?(0===s[t]&&1==++o[t]&&a.filterSize--,s[t]=1):(1===s[t]&&0==--o[t]&&a.filterSize++,s[t]=0)}}getBins(t,e,n={}){const i=this.parent.columnIndex[e];n.bins=void 0===n.bins?10:n.bins,n.min=void 0===n.min?i.minMax[0]:n.min,n.max=void 0===n.max?i.minMax[1]:n.max;const r=performance.now();this.worker.onmessage=e=>{console.log(`calculate bins ${i.name} : ${performance.now()-r}`),t(e.data)},this.worker.postMessage([this.filterBuffer,this.parent.filterBuffer,[i.buffer,i.datatype],n])}destroy(){super.destroy(),this.worker.terminate()}}i.Z.types.range_dimension=r;const o=r},2024:(t,e,n)=>{"use strict";function i(){var t=!1,e=!1;this.stopPropagation=function(){t=!0},this.isPropagationStopped=function(){return t},this.stopImmediatePropagation=function(){e=!0},this.isImmediatePropagationStopped=function(){return e}}function r(){this.__nonDataRow=!0}function o(){this.__group=!0,this.level=0,this.count=0,this.value=null,this.title=null,this.collapsed=!1,this.selectChecked=!1,this.totals=null,this.rows=[],this.groups=null,this.groupingKey=null}function s(){this.__groupTotals=!0,this.group=null,this.initialized=!1}function a(){var t=null;this.isActive=function(e){return e?t===e:null!==t},this.activate=function(e){if(e!==t){if(null!==t)throw new Error("SlickGrid.EditorLock.activate: an editController is still active, can't activate another editController");if(!e.commitCurrentEdit)throw new Error("SlickGrid.EditorLock.activate: editController must implement .commitCurrentEdit()");if(!e.cancelCurrentEdit)throw new Error("SlickGrid.EditorLock.activate: editController must implement .cancelCurrentEdit()");t=e}},this.deactivate=function(e){if(t){if(t!==e)throw new Error("SlickGrid.EditorLock.deactivate: specified editController is not the currently active one");t=null}},this.commitCurrentEdit=function(){return!t||t.commitCurrentEdit()},this.cancelCurrentEdit=function(){return!t||t.cancelCurrentEdit()}}n.d(e,{v:()=>l}),o.prototype=new r,o.prototype.equals=function(t){return this.value===t.value&&this.count===t.count&&this.collapsed===t.collapsed&&this.title===t.title},s.prototype=new r;const l={Event:function(){var t=[];this.subscribe=function(e){t.push(e)},this.unsubscribe=function(e){for(var n=t.length-1;n>=0;n--)t[n]===e&&t.splice(n,1)},this.notify=function(e,n,r){var o;n=n||new i,r=r||this;for(var s=0;s<t.length&&!n.isPropagationStopped()&&!n.isImmediatePropagationStopped();s++)o=t[s].call(r,n,e);return o}},EventData:i,EventHandler:function(){var t=[];this.subscribe=function(e,n){return t.push({event:e,handler:n}),e.subscribe(n),this},this.unsubscribe=function(e,n){for(var i=t.length;i--;)if(t[i].event===e&&t[i].handler===n)return t.splice(i,1),void e.unsubscribe(n);return this},this.unsubscribeAll=function(){for(var e=t.length;e--;)t[e].event.unsubscribe(t[e].handler);return t=[],this}},Range:function(t,e,n,i){void 0===n&&void 0===i&&(n=t,i=e),this.fromRow=Math.min(t,n),this.fromCell=Math.min(e,i),this.toRow=Math.max(t,n),this.toCell=Math.max(e,i),this.isSingleRow=function(){return this.fromRow==this.toRow},this.isSingleCell=function(){return this.fromRow==this.toRow&&this.fromCell==this.toCell},this.contains=function(t,e){return t>=this.fromRow&&t<=this.toRow&&e>=this.fromCell&&e<=this.toCell},this.toString=function(){return this.isSingleCell()?"("+this.fromRow+":"+this.fromCell+")":"("+this.fromRow+":"+this.fromCell+" - "+this.toRow+":"+this.toCell+")"}},Map:"Map"in window?window.Map:function(){var t={};this.get=function(e){return t[e]},this.set=function(e,n){t[e]=n},this.has=function(e){return e in t},this.delete=function(e){delete t[e]}},NonDataRow:r,Group:o,GroupTotals:s,EditorLock:a,GlobalEditorLock:new a,TreeColumns:function(t){var e={};function n(t,e){return t.filter((function(t){var i=e.call(t);return i&&t.columns&&(t.columns=n(t.columns,e)),i&&(!t.columns||t.columns.length)}))}function i(t,e){t.sort((function(t,n){return r(e.getColumnIndex(t.id))-r(e.getColumnIndex(n.id))})).forEach((function(t){t.columns&&i(t.columns,e)}))}function r(t){return void 0===t?-1:t}function o(t){if(!t.length)return t.columns?1+o(t.columns):1;for(var e in t)return o(t[e])}function s(t,e,n){var i=[];if(e==(n=n||0))return t.length&&t.forEach((function(t){t.columns&&(t.extractColumns=function(){return a(t)})})),t;for(var r in t)t[r].columns&&(i=i.concat(s(t[r].columns,e,n+1)));return i}function a(t){var e=[];if(t.hasOwnProperty("length"))for(var n=0;n<t.length;n++)e=e.concat(a(t[n]));else{if(!t.hasOwnProperty("columns"))return t;e=e.concat(a(t.columns))}return e}function l(){return JSON.parse(JSON.stringify(nodesArray))}(function t(n){n.forEach((function(n){e[n.id]=n,n.columns&&t(n.columns)}))})(t),this.hasDepth=function(){for(var e in t)if(t[e].hasOwnProperty("columns"))return!0;return!1},this.getTreeColumns=function(){return t},this.extractColumns=function(){return this.hasDepth()?a(t):t},this.getDepth=function(){return o(t)},this.getColumnsInDepth=function(e){return s(t,e)},this.getColumnsInGroup=function(t){return a(t)},this.visibleColumns=function(){return n(l(),(function(){return this.visible}))},this.filter=function(t){return n(l(),t)},this.reOrder=function(e){return i(t,e)},this.getById=function(t){return e[t]},this.getInIds=function(t){return t.map((function(t){return e[t]}))}},keyCode:{SPACE:8,BACKSPACE:8,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,RIGHT:39,TAB:9,UP:38,A:65},preClickClassName:"slick-edit-preclick",GridAutosizeColsMode:{None:"NOA",LegacyOff:"LOF",LegacyForceFit:"LFF",IgnoreViewport:"IGV",FitColsToViewport:"FCV",FitViewportToCols:"FVC"},ColAutosizeMode:{Locked:"LCK",Guide:"GUI",Content:"CON",ContentIntelligent:"CTI"},RowSelectionMode:{FirstRow:"FS1",FirstNRows:"FSN",AllRows:"ALL",LastRow:"LS1"},ValueFilterMode:{None:"NONE",DeDuplicate:"DEDP",GetGreatestAndSub:"GR8T",GetLongestTextAndSub:"LNSB",GetLongestText:"LNSC"},WidthEvalMode:{CanvasTextSize:"CANV",HTML:"HTML"}}},626:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A5:()=>Overlays,H4:()=>TextEditor,zn:()=>SlickGrid});var _Slick_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2024),jquery__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(9755),jquery__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(jquery__WEBPACK_IMPORTED_MODULE_1__);const jQuery=jquery__WEBPACK_IMPORTED_MODULE_1___default();var scrollbarDimensions,maxSupportedCssHeight;function SlickGrid(container,data,columns,options){var defaults={alwaysShowVerticalScroll:!1,alwaysAllowHorizontalScroll:!1,explicitInitialization:!1,rowHeight:25,defaultColumnWidth:80,enableAddRow:!1,leaveSpaceForNewRows:!1,editable:!1,autoEdit:!0,suppressActiveCellChangeOnEdit:!1,enableCellNavigation:!0,enableColumnReorder:!0,asyncEditorLoading:!1,asyncEditorLoadDelay:100,forceFitColumns:!1,enableAsyncPostRender:!1,asyncPostRenderDelay:50,enableAsyncPostRenderCleanup:!1,asyncPostRenderCleanupDelay:40,autoHeight:!1,editorLock:_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.GlobalEditorLock,showColumnHeader:!0,showHeaderRow:!1,headerRowHeight:25,createFooterRow:!1,showFooterRow:!1,footerRowHeight:25,createPreHeaderPanel:!1,showPreHeaderPanel:!1,preHeaderPanelHeight:25,showTopPanel:!1,topPanelHeight:25,formatterFactory:null,editorFactory:null,cellFlashingCssClass:"flashing",selectedCellCssClass:"selected",multiSelect:!0,enableTextSelectionOnCells:!1,dataItemColumnValueExtractor:null,frozenBottom:!1,frozenColumn:-1,frozenRow:-1,frozenRightViewportMinWidth:100,fullWidthRows:!1,multiColumnSort:!1,numberedMultiColumnSort:!1,tristateMultiColumnSort:!1,sortColNumberInSeparateSpan:!1,defaultFormatter,forceSyncScrolling:!1,addNewRowCssClass:"new-row",preserveCopiedSelectionOnPaste:!1,showCellSelection:!0,viewportClass:null,minRowBuffer:3,emulatePagingWhenScrolling:!0,editorCellNavOnLRKeys:!1,enableMouseWheelScrollHandler:!0,doPaging:!0,autosizeColsMode:_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.GridAutosizeColsMode.LegacyOff,autosizeColPaddingPx:4,autosizeTextAvgToMWidthRatio:.75,viewportSwitchToScrollModeWidthPercent:void 0,viewportMinWidthPx:void 0,viewportMaxWidthPx:void 0,suppressCssChangesOnHiddenInit:!1},columnDefaults={name:"",resizable:!0,sortable:!1,minWidth:30,maxWidth:void 0,rerenderOnResize:!1,headerCssClass:null,defaultSortAsc:!0,focusable:!0,selectable:!0},columnAutosizeDefaults={ignoreHeaderText:!1,colValueArray:void 0,allowAddlPercent:void 0,formatterOverride:void 0,autosizeMode:_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.ColAutosizeMode.ContentIntelligent,rowSelectionModeOnInit:void 0,rowSelectionMode:_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.RowSelectionMode.FirstNRows,rowSelectionCount:100,valueFilterMode:_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.ValueFilterMode.None,widthEvalMode:_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.WidthEvalMode.CanvasTextSize,sizeToRemaining:void 0,widthPx:void 0,colDataTypeOf:void 0},th,h,ph,n,cj,page=0,offset=0,vScrollDir=1,initialized=!1,$container,uid="slickgrid_"+Math.round(1e6*Math.random()),self=this,$focusSink,$focusSink2,$groupHeaders=jquery__WEBPACK_IMPORTED_MODULE_1___default()(),$headerScroller,$headers,$headerRow,$headerRowScroller,$headerRowSpacerL,$headerRowSpacerR,$footerRow,$footerRowScroller,$footerRowSpacerL,$footerRowSpacerR,$preHeaderPanel,$preHeaderPanelScroller,$preHeaderPanelSpacer,$preHeaderPanelR,$preHeaderPanelScrollerR,$preHeaderPanelSpacerR,$topPanelScroller,$topPanel,$viewport,$canvas,$style,$boundAncestors,treeColumns,stylesheet,columnCssRulesL,columnCssRulesR,viewportH,viewportW,canvasWidth,canvasWidthL,canvasWidthR,headersWidth,headersWidthL,headersWidthR,viewportHasHScroll,viewportHasVScroll,headerColumnWidthDiff=0,headerColumnHeightDiff=0,cellWidthDiff=0,cellHeightDiff=0,jQueryNewWidthBehaviour=!1,absoluteColumnMinWidth,hasFrozenRows=!1,frozenRowsHeight=0,actualFrozenRow=-1,paneTopH=0,paneBottomH=0,viewportTopH=0,viewportBottomH=0,topPanelH=0,headerRowH=0,footerRowH=0,tabbingDirection=1,$activeCanvasNode,$activeViewportNode,activePosX,activeRow,activeCell,activeCellNode=null,currentEditor=null,serializedEditorValue,editController,rowsCache={},renderedRows=0,numVisibleRows=0,prevScrollTop=0,scrollTop=0,lastRenderedScrollTop=0,lastRenderedScrollLeft=0,prevScrollLeft=0,scrollLeft=0,selectionModel,selectedRows=[],plugins=[],cellCssClasses={},columnsById={},sortColumns=[],columnPosLeft=[],columnPosRight=[],pagingActive=!1,pagingIsLastPage=!1,scrollThrottle=ActionThrottle(render,50),h_editorLoader=null,h_render=null,h_postrender=null,h_postrenderCleanup=null,postProcessedRows={},postProcessToRow=null,postProcessFromRow=null,postProcessedCleanupQueue=[],postProcessgroupId=0,counter_rows_rendered=0,counter_rows_removed=0,rowNodeFromLastMouseWheelEvent,zombieRowNodeFromLastMouseWheelEvent,zombieRowCacheFromLastMouseWheelEvent,zombieRowPostProcessedFromLastMouseWheelEvent,$paneHeaderL,$paneHeaderR,$paneTopL,$paneTopR,$paneBottomL,$paneBottomR,$headerScrollerL,$headerScrollerR,$headerL,$headerR,$groupHeadersL,$groupHeadersR,$headerRowScrollerL,$headerRowScrollerR,$footerRowScrollerL,$footerRowScrollerR,$headerRowL,$headerRowR,$footerRowL,$footerRowR,$topPanelScrollerL,$topPanelScrollerR,$topPanelL,$topPanelR,$viewportTopL,$viewportTopR,$viewportBottomL,$viewportBottomR,$canvasTopL,$canvasTopR,$canvasBottomL,$canvasBottomR,$viewportScrollContainerX,$viewportScrollContainerY,$headerScrollContainer,$headerRowScrollContainer,$footerRowScrollContainer,cssShow={position:"absolute",visibility:"hidden",display:"block"},$hiddenParents,oldProps=[],columnResizeDragging=!1,__doc__=document;function init(){if(($container=container instanceof jquery__WEBPACK_IMPORTED_MODULE_1___default()?container:jquery__WEBPACK_IMPORTED_MODULE_1___default()(container)).length<1)throw new Error("SlickGrid requires a valid container, "+container+" does not exist in the DOM.");if(options.suppressCssChangesOnHiddenInit||cacheCssForHiddenInit(),maxSupportedCssHeight=maxSupportedCssHeight||getMaxSupportedCssHeight(),options=jquery__WEBPACK_IMPORTED_MODULE_1___default().extend({},defaults,options),validateAndEnforceOptions(),columnDefaults.width=options.defaultColumnWidth,treeColumns=new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.TreeColumns(columns),columns=treeColumns.extractColumns(),updateColumnProps(),options.enableColumnReorder&&!jquery__WEBPACK_IMPORTED_MODULE_1___default().fn.sortable)throw new Error("SlickGrid's 'enableColumnReorder = true' option requires jquery-ui.sortable module to be loaded");if(editController={commitCurrentEdit,cancelCurrentEdit},$container.empty().css("overflow","hidden").css("outline",0).addClass(uid).addClass("ui-widget"),/relative|absolute|fixed/.test($container.css("position"))||$container.css("position","relative"),$focusSink=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div tabIndex='0' hideFocus style='position:fixed;width:0;height:0;top:0;left:0;outline:0;'></div>").appendTo($container),$paneHeaderL=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='slick-pane slick-pane-header slick-pane-left' tabIndex='0' />").appendTo($container),$paneHeaderR=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='slick-pane slick-pane-header slick-pane-right' tabIndex='0' />").appendTo($container),$paneTopL=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='slick-pane slick-pane-top slick-pane-left' tabIndex='0' />").appendTo($container),$paneTopR=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='slick-pane slick-pane-top slick-pane-right' tabIndex='0' />").appendTo($container),$paneBottomL=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='slick-pane slick-pane-bottom slick-pane-left' tabIndex='0' />").appendTo($container),$paneBottomR=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='slick-pane slick-pane-bottom slick-pane-right' tabIndex='0' />").appendTo($container),options.createPreHeaderPanel&&($preHeaderPanelScroller=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='slick-preheader-panel ui-state-default' style='overflow:hidden;position:relative;' />").appendTo($paneHeaderL),$preHeaderPanel=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div />").appendTo($preHeaderPanelScroller),$preHeaderPanelSpacer=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div style='display:block;height:1px;position:absolute;top:0;left:0;'></div>").appendTo($preHeaderPanelScroller),$preHeaderPanelScrollerR=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='slick-preheader-panel ui-state-default' style='overflow:hidden;position:relative;' />").appendTo($paneHeaderR),$preHeaderPanelR=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div />").appendTo($preHeaderPanelScrollerR),$preHeaderPanelSpacerR=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div style='display:block;height:1px;position:absolute;top:0;left:0;'></div>").appendTo($preHeaderPanelScrollerR),options.showPreHeaderPanel||($preHeaderPanelScroller.hide(),$preHeaderPanelScrollerR.hide())),$headerScrollerL=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='slick-header ui-state-default slick-header-left' />").appendTo($paneHeaderL),$headerScrollerR=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='slick-header ui-state-default slick-header-right' />").appendTo($paneHeaderR),$headerScroller=jquery__WEBPACK_IMPORTED_MODULE_1___default()().add($headerScrollerL).add($headerScrollerR),treeColumns.hasDepth()){$groupHeadersL=[],$groupHeadersR=[];for(var t=0;t<treeColumns.getDepth()-1;t++)$groupHeadersL[t]=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='slick-group-header-columns slick-group-header-columns-left' style='left:-1000px' />").appendTo($headerScrollerL),$groupHeadersR[t]=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='slick-group-header-columns slick-group-header-columns-right' style='left:-1000px' />").appendTo($headerScrollerR);$groupHeaders=jquery__WEBPACK_IMPORTED_MODULE_1___default()().add($groupHeadersL).add($groupHeadersR)}$headerL=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='slick-header-columns slick-header-columns-left' style='left:-1000px' />").data("__doc__",__doc__).appendTo($headerScrollerL),$headerR=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='slick-header-columns slick-header-columns-right' style='left:-1000px' />").appendTo($headerScrollerR),$headers=jquery__WEBPACK_IMPORTED_MODULE_1___default()().add($headerL).add($headerR),$headerRowScrollerL=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='slick-headerrow ui-state-default' />").appendTo($paneTopL),$headerRowScrollerR=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='slick-headerrow ui-state-default' />").appendTo($paneTopR),$headerRowScroller=jquery__WEBPACK_IMPORTED_MODULE_1___default()().add($headerRowScrollerL).add($headerRowScrollerR),$headerRowSpacerL=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div style='display:block;height:1px;position:absolute;top:0;left:0;'></div>").appendTo($headerRowScrollerL),$headerRowSpacerR=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div style='display:block;height:1px;position:absolute;top:0;left:0;'></div>").appendTo($headerRowScrollerR),$headerRowL=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='slick-headerrow-columns slick-headerrow-columns-left' />").appendTo($headerRowScrollerL),$headerRowR=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='slick-headerrow-columns slick-headerrow-columns-right' />").appendTo($headerRowScrollerR),$headerRow=jquery__WEBPACK_IMPORTED_MODULE_1___default()().add($headerRowL).add($headerRowR),$topPanelScrollerL=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='slick-top-panel-scroller ui-state-default' />").appendTo($paneTopL),$topPanelScrollerR=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='slick-top-panel-scroller ui-state-default' />").appendTo($paneTopR),$topPanelScroller=jquery__WEBPACK_IMPORTED_MODULE_1___default()().add($topPanelScrollerL).add($topPanelScrollerR),$topPanelL=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='slick-top-panel' style='width:10000px' />").appendTo($topPanelScrollerL),$topPanelR=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='slick-top-panel' style='width:10000px' />").appendTo($topPanelScrollerR),$topPanel=jquery__WEBPACK_IMPORTED_MODULE_1___default()().add($topPanelL).add($topPanelR),options.showColumnHeader||$headerScroller.hide(),options.showTopPanel||$topPanelScroller.hide(),options.showHeaderRow||$headerRowScroller.hide(),$viewportTopL=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='slick-viewport slick-viewport-top slick-viewport-left' tabIndex='0' hideFocus />").appendTo($paneTopL),$viewportTopR=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='slick-viewport slick-viewport-top slick-viewport-right' tabIndex='0' hideFocus />").appendTo($paneTopR),$viewportBottomL=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='slick-viewport slick-viewport-bottom slick-viewport-left' tabIndex='0' hideFocus />").appendTo($paneBottomL),$viewportBottomR=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='slick-viewport slick-viewport-bottom slick-viewport-right' tabIndex='0' hideFocus />").appendTo($paneBottomR),$viewport=jquery__WEBPACK_IMPORTED_MODULE_1___default()().add($viewportTopL).add($viewportTopR).add($viewportBottomL).add($viewportBottomR),$activeViewportNode=$viewportTopL,$canvasTopL=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='grid-canvas grid-canvas-top grid-canvas-left' tabIndex='0' hideFocus />").appendTo($viewportTopL),$canvasTopR=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='grid-canvas grid-canvas-top grid-canvas-right' tabIndex='0' hideFocus />").appendTo($viewportTopR),$canvasBottomL=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='grid-canvas grid-canvas-bottom grid-canvas-left' tabIndex='0' hideFocus />").appendTo($viewportBottomL),$canvasBottomR=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='grid-canvas grid-canvas-bottom grid-canvas-right' tabIndex='0' hideFocus />").appendTo($viewportBottomR),options.viewportClass&&$viewport.toggleClass(options.viewportClass,!0),$canvas=jquery__WEBPACK_IMPORTED_MODULE_1___default()().add($canvasTopL).add($canvasTopR).add($canvasBottomL).add($canvasBottomR),scrollbarDimensions=scrollbarDimensions||measureScrollbar(),$activeCanvasNode=$canvasTopL,$preHeaderPanelSpacer&&$preHeaderPanelSpacer.css("width",getCanvasWidth()+scrollbarDimensions.width+"px"),$headers.width(getHeadersWidth()),$headerRowSpacerL.css("width",getCanvasWidth()+scrollbarDimensions.width+"px"),$headerRowSpacerR.css("width",getCanvasWidth()+scrollbarDimensions.width+"px"),options.createFooterRow&&($footerRowScrollerR=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='slick-footerrow ui-state-default' />").appendTo($paneTopR),$footerRowScrollerL=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='slick-footerrow ui-state-default' />").appendTo($paneTopL),$footerRowScroller=jquery__WEBPACK_IMPORTED_MODULE_1___default()().add($footerRowScrollerL).add($footerRowScrollerR),$footerRowSpacerL=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div style='display:block;height:1px;position:absolute;top:0;left:0;'></div>").css("width",getCanvasWidth()+scrollbarDimensions.width+"px").appendTo($footerRowScrollerL),$footerRowSpacerR=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div style='display:block;height:1px;position:absolute;top:0;left:0;'></div>").css("width",getCanvasWidth()+scrollbarDimensions.width+"px").appendTo($footerRowScrollerR),$footerRowL=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='slick-footerrow-columns slick-footerrow-columns-left' />").appendTo($footerRowScrollerL),$footerRowR=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='slick-footerrow-columns slick-footerrow-columns-right' />").appendTo($footerRowScrollerR),$footerRow=jquery__WEBPACK_IMPORTED_MODULE_1___default()().add($footerRowL).add($footerRowR),options.showFooterRow||$footerRowScroller.hide()),$focusSink2=$focusSink.clone().appendTo($container),options.explicitInitialization||finishInitialization()}function finishInitialization(){initialized||(initialized=!0,getViewportWidth(),getViewportHeight(),measureCellPaddingAndBorder(),disableSelection($headers),options.enableTextSelectionOnCells||$viewport.on("selectstart.ui",(function(t){return jquery__WEBPACK_IMPORTED_MODULE_1___default()(t.target).is("input,textarea")})),setFrozenOptions(),setPaneVisibility(),setScroller(),setOverflow(),updateColumnCaches(),createColumnHeaders(),createColumnGroupHeaders(),createColumnFooter(),setupColumnSort(),createCssRules(),resizeCanvas(),bindAncestorScrollEvents(),$container.on("resize.slickgrid",resizeCanvas),$viewport.on("scroll",handleScroll),jQuery.fn.mousewheel&&options.enableMouseWheelScrollHandler&&$viewport.on("mousewheel",handleMouseWheel),$headerScroller.on("contextmenu",handleHeaderContextMenu).on("click",handleHeaderClick).on("mouseenter",".slick-header-column",handleHeaderMouseEnter).on("mouseleave",".slick-header-column",handleHeaderMouseLeave),$headerRowScroller.on("scroll",handleHeaderRowScroll),options.createFooterRow&&($footerRow.on("contextmenu",handleFooterContextMenu).on("click",handleFooterClick),$footerRowScroller.on("scroll",handleFooterRowScroll)),options.createPreHeaderPanel&&$preHeaderPanelScroller.on("scroll",handlePreHeaderPanelScroll),$focusSink.add($focusSink2).on("keydown",handleKeyDown),$canvas.on("keydown",handleKeyDown).on("click",handleClick).on("dblclick",handleDblClick).on("contextmenu",handleContextMenu).on("draginit",handleDragInit).on("dragstart",{distance:3},handleDragStart).on("drag",handleDrag).on("dragend",handleDragEnd).on("mouseenter",".slick-cell",handleMouseEnter).on("mouseleave",".slick-cell",handleMouseLeave),options.suppressCssChangesOnHiddenInit||restoreCssFromHiddenInit())}function cacheCssForHiddenInit(){($hiddenParents=$container.parents().addBack().not(":visible")).each((function(){var t={};for(var e in cssShow)t[e]=this.style[e],this.style[e]=cssShow[e];oldProps.push(t)}))}function restoreCssFromHiddenInit(){$hiddenParents.each((function(t){var e=oldProps[t];for(var n in cssShow)this.style[n]=e[n]}))}function hasFrozenColumns(){return options.frozenColumn>-1}function registerPlugin(t){plugins.unshift(t),t.init(self)}function unregisterPlugin(t){for(var e=plugins.length;e>=0;e--)if(plugins[e]===t){plugins[e].destroy&&plugins[e].destroy(),plugins.splice(e,1);break}}function getPluginByName(t){for(var e=plugins.length-1;e>=0;e--)if(plugins[e].pluginName===t)return plugins[e]}function setSelectionModel(t){selectionModel&&(selectionModel.onSelectedRangesChanged.unsubscribe(handleSelectedRangesChanged),selectionModel.destroy&&selectionModel.destroy()),(selectionModel=t)&&(selectionModel.init(self),selectionModel.onSelectedRangesChanged.subscribe(handleSelectedRangesChanged))}function getSelectionModel(){return selectionModel}function getCanvasNode(t,e){return _getContainerElement(getCanvases(),t,e)}function getActiveCanvasNode(t){return setActiveCanvasNode(t),$activeCanvasNode[0]}function getCanvases(){return $canvas}function setActiveCanvasNode(t){t&&($activeCanvasNode=jquery__WEBPACK_IMPORTED_MODULE_1___default()(t.target).closest(".grid-canvas"))}function getViewportNode(t,e){return _getContainerElement(getViewports(),t,e)}function getViewports(){return $viewport}function getActiveViewportNode(t){return setActiveViewportNode(t),$activeViewportNode[0]}function setActiveViewportNode(t){t&&($activeViewportNode=jquery__WEBPACK_IMPORTED_MODULE_1___default()(t.target).closest(".slick-viewport"))}function _getContainerElement(t,e,n){if(t){e||(e=0),n||(n=0);var i="number"==typeof e?e:getColumnIndex(e);return t[(hasFrozenRows&&n>=actualFrozenRow+(options.frozenBottom?0:1)?2:0)+(hasFrozenColumns()&&i>options.frozenColumn?1:0)]}}function measureScrollbar(){var t=jquery__WEBPACK_IMPORTED_MODULE_1___default()('<div class="'+$viewport.className+'" style="position:absolute; top:-10000px; left:-10000px; overflow:auto; width:100px; height:100px;"></div>').appendTo("body"),e=jquery__WEBPACK_IMPORTED_MODULE_1___default()('<div style="width:200px; height:200px; overflow:auto;"></div>').appendTo(t),n={width:t[0].offsetWidth-t[0].clientWidth,height:t[0].offsetHeight-t[0].clientHeight};return e.remove(),t.remove(),n}function getHeadersWidth(){headersWidth=headersWidthL=headersWidthR=0;for(var t=!options.autoHeight,e=0,n=columns.length;e<n;e++){var i=columns[e].width;options.frozenColumn>-1&&e>options.frozenColumn?headersWidthR+=i:headersWidthL+=i}return t&&(options.frozenColumn>-1&&e>options.frozenColumn?headersWidthR+=scrollbarDimensions.width:headersWidthL+=scrollbarDimensions.width),hasFrozenColumns()?(headersWidthL+=1e3,headersWidthR=Math.max(headersWidthR,viewportW)+headersWidthL,headersWidthR+=scrollbarDimensions.width):(headersWidthL+=scrollbarDimensions.width,headersWidthL=Math.max(headersWidthL,viewportW)+1e3),headersWidth=headersWidthL+headersWidthR,Math.max(headersWidth,viewportW)+1e3}function getHeadersWidthL(){return headersWidthL=0,columns.forEach((function(t,e){options.frozenColumn>-1&&e>options.frozenColumn||(headersWidthL+=t.width)})),hasFrozenColumns()?headersWidthL+=1e3:(headersWidthL+=scrollbarDimensions.width,headersWidthL=Math.max(headersWidthL,viewportW)+1e3),headersWidthL}function getHeadersWidthR(){return headersWidthR=0,columns.forEach((function(t,e){options.frozenColumn>-1&&e>options.frozenColumn&&(headersWidthR+=t.width)})),hasFrozenColumns()&&(headersWidthR=Math.max(headersWidthR,viewportW)+getHeadersWidthL(),headersWidthR+=scrollbarDimensions.width),headersWidthR}function getCanvasWidth(){var t=viewportHasVScroll?viewportW-scrollbarDimensions.width:viewportW,e=columns.length;for(canvasWidthL=canvasWidthR=0;e--;)hasFrozenColumns()&&e>options.frozenColumn?canvasWidthR+=columns[e].width:canvasWidthL+=columns[e].width;var n=canvasWidthL+canvasWidthR;return options.fullWidthRows?Math.max(n,t):n}function updateCanvasWidth(t){var e,n=canvasWidth,i=canvasWidthL,r=canvasWidthR;((e=(canvasWidth=getCanvasWidth())!==n||canvasWidthL!==i||canvasWidthR!==r)||hasFrozenColumns()||hasFrozenRows)&&($canvasTopL.width(canvasWidthL),getHeadersWidth(),$headerL.width(headersWidthL),$headerR.width(headersWidthR),hasFrozenColumns()?($canvasTopR.width(canvasWidthR),$paneHeaderL.width(canvasWidthL),$paneHeaderR.css("left",canvasWidthL),$paneHeaderR.css("width",viewportW-canvasWidthL),$paneTopL.width(canvasWidthL),$paneTopR.css("left",canvasWidthL),$paneTopR.css("width",viewportW-canvasWidthL),$headerRowScrollerL.width(canvasWidthL),$headerRowScrollerR.width(viewportW-canvasWidthL),$headerRowL.width(canvasWidthL),$headerRowR.width(canvasWidthR),options.createFooterRow&&($footerRowScrollerL.width(canvasWidthL),$footerRowScrollerR.width(viewportW-canvasWidthL),$footerRowL.width(canvasWidthL),$footerRowR.width(canvasWidthR)),options.createPreHeaderPanel&&$preHeaderPanel.width(canvasWidth),$viewportTopL.width(canvasWidthL),$viewportTopR.width(viewportW-canvasWidthL),hasFrozenRows&&($paneBottomL.width(canvasWidthL),$paneBottomR.css("left",canvasWidthL),$viewportBottomL.width(canvasWidthL),$viewportBottomR.width(viewportW-canvasWidthL),$canvasBottomL.width(canvasWidthL),$canvasBottomR.width(canvasWidthR))):($paneHeaderL.width("100%"),$paneTopL.width("100%"),$headerRowScrollerL.width("100%"),$headerRowL.width(canvasWidth),options.createFooterRow&&($footerRowScrollerL.width("100%"),$footerRowL.width(canvasWidth)),options.createPreHeaderPanel&&($preHeaderPanel.width("100%"),$preHeaderPanel.width(canvasWidth)),$viewportTopL.width("100%"),hasFrozenRows&&($viewportBottomL.width("100%"),$canvasBottomL.width(canvasWidthL))),viewportHasHScroll=canvasWidth>=viewportW-scrollbarDimensions.width),$headerRowSpacerL.width(canvasWidth+(viewportHasVScroll?scrollbarDimensions.width:0)),$headerRowSpacerR.width(canvasWidth+(viewportHasVScroll?scrollbarDimensions.width:0)),options.createFooterRow&&($footerRowSpacerL.width(canvasWidth+(viewportHasVScroll?scrollbarDimensions.width:0)),$footerRowSpacerR.width(canvasWidth+(viewportHasVScroll?scrollbarDimensions.width:0))),(e||t)&&applyColumnWidths()}function disableSelection(t){t&&t.jquery&&t.attr("unselectable","on").css("MozUserSelect","none").on("selectstart.ui",(function(){return!1}))}function getMaxSupportedCssHeight(){for(var t=1e6,e=navigator.userAgent.toLowerCase().match(/firefox/)?6e6:1e9,n=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div style='display:none' />").appendTo(__doc__.body);;){var i=2*t;if(n.css("height",i),i>e||n.height()!==i)break;t=i}return n.remove(),t}function getUID(){return uid}function getHeaderColumnWidthDiff(){return headerColumnWidthDiff}function getScrollbarDimensions(){return scrollbarDimensions}function bindAncestorScrollEvents(){for(var t=hasFrozenRows&&!options.frozenBottom?$canvasBottomL[0]:$canvasTopL[0];(t=t.parentNode)!=__doc__.body&&null!=t;)if(t==$viewportTopL[0]||t.scrollWidth!=t.clientWidth||t.scrollHeight!=t.clientHeight){var e=jquery__WEBPACK_IMPORTED_MODULE_1___default()(t);$boundAncestors=$boundAncestors?$boundAncestors.add(e):e,e.on("scroll."+uid,handleActiveCellPositionChange)}}function unbindAncestorScrollEvents(){$boundAncestors&&($boundAncestors.off("scroll."+uid),$boundAncestors=null)}function updateColumnHeader(t,e,n){if(initialized){var i=getColumnIndex(t);if(null!=i){var r=columns[i],o=$headers.children().eq(i);o&&(void 0!==e&&(columns[i].name=e),void 0!==n&&(columns[i].toolTip=n),trigger(self.onBeforeHeaderCellDestroy,{node:o[0],column:r,grid:self}),o.attr("title",n||"").children().eq(0).html(e),trigger(self.onHeaderCellRendered,{node:o[0],column:r,grid:self}))}}}function getHeader(t){if(!t)return hasFrozenColumns()?$headers:$headerL;var e=getColumnIndex(t.id);return hasFrozenColumns()?e<=options.frozenColumn?$headerL:$headerR:$headerL}function getHeaderColumn(t){var e="number"==typeof t?t:getColumnIndex(t),n=hasFrozenColumns()?e<=options.frozenColumn?$headerL:$headerR:$headerL,i=hasFrozenColumns()?e<=options.frozenColumn?e:e-options.frozenColumn-1:e,r=n.children().eq(i);return r&&r[0]}function getHeaderRow(){return hasFrozenColumns()?$headerRow:$headerRow[0]}function getFooterRow(){return hasFrozenColumns()?$footerRow:$footerRow[0]}function getPreHeaderPanel(){return $preHeaderPanel[0]}function getPreHeaderPanelRight(){return $preHeaderPanelR[0]}function getHeaderRowColumn(t){var e,n="number"==typeof t?t:getColumnIndex(t);hasFrozenColumns()?n<=options.frozenColumn?e=$headerRowL:(e=$headerRowR,n-=options.frozenColumn+1):e=$headerRowL;var i=e.children().eq(n);return i&&i[0]}function getFooterRowColumn(t){var e,n="number"==typeof t?t:getColumnIndex(t);hasFrozenColumns()?n<=options.frozenColumn?e=$footerRowL:(e=$footerRowR,n-=options.frozenColumn+1):e=$footerRowL;var i=e&&e.children().eq(n);return i&&i[0]}function createColumnFooter(){if(options.createFooterRow){$footerRow.find(".slick-footerrow-column").each((function(){var t=jquery__WEBPACK_IMPORTED_MODULE_1___default()(this).data("column");t&&trigger(self.onBeforeFooterRowCellDestroy,{node:this,column:t,grid:self})})),$footerRowL.empty(),$footerRowR.empty();for(var t=0;t<columns.length;t++){var e=columns[t],n=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='ui-state-default slick-footerrow-column l"+t+" r"+t+"'></div>").data("column",e).addClass(hasFrozenColumns()&&t<=options.frozenColumn?"frozen":"").appendTo(hasFrozenColumns()&&t>options.frozenColumn?$footerRowR:$footerRowL);trigger(self.onFooterRowCellRendered,{node:n[0],column:e,grid:self})}}}function createColumnGroupHeaders(){var t=0,e=!1;if(treeColumns.hasDepth()){for(var n=0;n<$groupHeadersL.length;n++){$groupHeadersL[n].empty(),$groupHeadersR[n].empty();var i=treeColumns.getColumnsInDepth(n);for(var r in i){var o=i[r];t+=o.extractColumns().length,hasFrozenColumns()&&0===n&&t-1===options.frozenColumn&&(e=!0),jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='ui-state-default slick-group-header-column' />").html("<span class='slick-column-name'>"+o.name+"</span>").attr("id",""+uid+o.id).attr("title",o.toolTip||"").data("column",o).addClass(o.headerCssClass||"").addClass(hasFrozenColumns()&&t-1>options.frozenColumn?"frozen":"").appendTo(hasFrozenColumns()&&t-1>options.frozenColumn?$groupHeadersR[n]:$groupHeadersL[n])}if(hasFrozenColumns()&&0===n&&!e){$groupHeadersL[n].empty(),$groupHeadersR[n].empty(),alert("All columns of group should to be grouped!");break}}applyColumnGroupHeaderWidths()}}function createColumnHeaders(){function t(){jquery__WEBPACK_IMPORTED_MODULE_1___default()(this).addClass("ui-state-hover")}function e(){jquery__WEBPACK_IMPORTED_MODULE_1___default()(this).removeClass("ui-state-hover")}$headers.find(".slick-header-column").each((function(){var t=jquery__WEBPACK_IMPORTED_MODULE_1___default()(this).data("column");t&&trigger(self.onBeforeHeaderCellDestroy,{node:this,column:t,grid:self})})),$headerL.empty(),$headerR.empty(),getHeadersWidth(),$headerL.width(headersWidthL),$headerR.width(headersWidthR),$headerRow.find(".slick-headerrow-column").each((function(){var t=jquery__WEBPACK_IMPORTED_MODULE_1___default()(this).data("column");t&&trigger(self.onBeforeHeaderRowCellDestroy,{node:this,column:t,grid:self})})),$headerRowL.empty(),$headerRowR.empty(),options.createFooterRow&&($footerRowL.find(".slick-footerrow-column").each((function(){var t=jquery__WEBPACK_IMPORTED_MODULE_1___default()(this).data("column");t&&trigger(self.onBeforeFooterRowCellDestroy,{node:this,column:t,grid:self})})),$footerRowL.empty(),hasFrozenColumns()&&($footerRowR.find(".slick-footerrow-column").each((function(){var t=jquery__WEBPACK_IMPORTED_MODULE_1___default()(this).data("column");t&&trigger(self.onBeforeFooterRowCellDestroy,{node:this,column:t,grid:self})})),$footerRowR.empty()));for(var n=0;n<columns.length;n++){var i=columns[n],r=hasFrozenColumns()?n<=options.frozenColumn?$headerL:$headerR:$headerL,o=hasFrozenColumns()?n<=options.frozenColumn?$headerRowL:$headerRowR:$headerRowL,s=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='ui-state-default slick-header-column' />").html("<span class='slick-column-name'>"+i.name+"</span>").width(i.width-headerColumnWidthDiff).attr("id",""+uid+i.id).attr("title",i.toolTip||"").data("column",i).data("__doc__",__doc__).addClass(i.headerCssClass||"").addClass(hasFrozenColumns()&&n<=options.frozenColumn?"frozen":"").appendTo(r);if((options.enableColumnReorder||i.sortable)&&s.on("mouseenter",t).on("mouseleave",e),s.on("dragstart",((t,e)=>{e.target.style.zIndex=1,e.target.style.opacity=.6})).on("drag",((t,e)=>{e.target.style.left=e.offsetX-e.originalX+1e3+"px"})).on("dragend",((t,e)=>{if(Math.abs(e.deltaX)<5)return e.target.style.opacity=1,void(e.target.style.zIndex="");const n=jquery__WEBPACK_IMPORTED_MODULE_1___default()(e.target).data("column");let i=0;const r=[];let o=0;for(let t of columns)r.push(o),t===n&&(i=o),o+=t.width;r.push(o+1e3);const s=[];let a=i+e.deltaX;a<0&&s.push(n);for(let t=0;t<columns.length;t++)columns[t]!==n&&s.push(columns[t]),a>r[t]&&a<r[t+1]&&(s.push(n),a=-1e3);setColumns(columns=s)})),i.hasOwnProperty("headerCellAttrs")&&i.headerCellAttrs instanceof Object)for(var a in i.headerCellAttrs)i.headerCellAttrs.hasOwnProperty(a)&&s.attr(a,i.headerCellAttrs[a]);if(i.sortable&&(s.addClass("slick-header-sortable"),s.append("<span class='slick-sort-indicator"+(options.numberedMultiColumnSort&&!options.sortColNumberInSeparateSpan?" slick-sort-indicator-numbered":"")+"' />"),options.numberedMultiColumnSort&&options.sortColNumberInSeparateSpan&&s.append("<span class='slick-sort-indicator-numbered' />")),trigger(self.onHeaderCellRendered,{node:s[0],column:i,grid:self}),options.showHeaderRow){var l=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='ui-state-default slick-headerrow-column l"+n+" r"+n+"'></div>").data("column",i).addClass(hasFrozenColumns()&&n<=options.frozenColumn?"frozen":"").appendTo(o);trigger(self.onHeaderRowCellRendered,{node:l[0],column:i,grid:self})}if(options.createFooterRow&&options.showFooterRow){var c=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='ui-state-default slick-footerrow-column l"+n+" r"+n+"'></div>").data("column",i).appendTo($footerRow);trigger(self.onFooterRowCellRendered,{node:c[0],column:i,grid:self})}}setSortColumns(sortColumns),setupColumnResize(),options.enableColumnReorder&&("function"==typeof options.enableColumnReorder?options.enableColumnReorder(self,$headers,headerColumnWidthDiff,setColumns,setupColumnResize,columns,getColumnIndex,uid,trigger):setupColumnReorder())}function setupColumnSort(){$headers.click((function(t){if(!columnResizeDragging&&(t.metaKey=t.metaKey||t.ctrlKey,!jquery__WEBPACK_IMPORTED_MODULE_1___default()(t.target).hasClass("slick-resizable-handle"))){var e=jquery__WEBPACK_IMPORTED_MODULE_1___default()(t.target).closest(".slick-header-column");if(e.length){var n=e.data("column");if(n.sortable){if(!getEditorLock().commitCurrentEdit())return;for(var i=null,r=0;r<sortColumns.length;r++)if(sortColumns[r].columnId==n.id){(i=sortColumns[r]).sortAsc=!i.sortAsc;break}var o=!!i;options.tristateMultiColumnSort?(i||(i={columnId:n.id,sortAsc:n.defaultSortAsc}),o&&i.sortAsc&&(sortColumns.splice(r,1),i=null),options.multiColumnSort||(sortColumns=[]),!i||o&&options.multiColumnSort||sortColumns.push(i)):t.metaKey&&options.multiColumnSort?i&&sortColumns.splice(r,1):((t.shiftKey||t.metaKey)&&options.multiColumnSort||(sortColumns=[]),i?0===sortColumns.length&&sortColumns.push(i):(i={columnId:n.id,sortAsc:n.defaultSortAsc},sortColumns.push(i))),setSortColumns(sortColumns),options.multiColumnSort?trigger(self.onSort,{multiColumnSort:!0,sortCols:jquery__WEBPACK_IMPORTED_MODULE_1___default().map(sortColumns,(function(t){return{columnId:columns[getColumnIndex(t.columnId)].id,sortCol:columns[getColumnIndex(t.columnId)],sortAsc:t.sortAsc}}))},t):trigger(self.onSort,{multiColumnSort:!1,columnId:sortColumns.length>0?n.id:null,sortCol:sortColumns.length>0?n:null,sortAsc:!(sortColumns.length>0)||sortColumns[0].sortAsc},t)}}}}))}function currentPositionInHeader(t){var e=0;return $headers.find(".slick-header-column").each((function(n){if(this.id==t)return e=n,!1})),e}function limitPositionInGroup(t){var e,n=0,i=0;return treeColumns.getColumnsInDepth($groupHeadersL.length-1).some((function(r){return n=i,i+=r.columns.length,r.columns.some((function(n){return n.id===t&&(e=r),e})),e})),i--,{start:n,end:i,group:e}}function remove(t,e){var n=t.lastIndexOf(e);n>-1&&(t.splice(n,1),remove(t,e))}function columnPositionValidInGroup(t){var e=currentPositionInHeader(t[0].id),n=limitPositionInGroup(t.data("column").id),i=n.start<=e&&e<=n.end;return{limit:n,valid:i,message:i?"":'Column "'.concat(t.text(),'" can be reordered only within the "',n.group.name,'" group!')}}function setupColumnReorder(){$headers.filter(":ui-sortable").sortable("destroy");var t,e=null;function n(){$viewportScrollContainerX[0].scrollLeft=$viewportScrollContainerX[0].scrollLeft+10}function i(){$viewportScrollContainerX[0].scrollLeft=$viewportScrollContainerX[0].scrollLeft-10}$headers.sortable({containment:"parent",distance:3,axis:"x",cursor:"default",tolerance:"intersection",helper:"clone",placeholder:"slick-sortable-placeholder ui-state-default slick-header-column",start:function(e,n){n.placeholder.width(n.helper.outerWidth()-headerColumnWidthDiff),t=!hasFrozenColumns()||n.placeholder.offset().left+n.placeholder.width()>$viewportScrollContainerX.offset().left,jquery__WEBPACK_IMPORTED_MODULE_1___default()(n.helper).addClass("slick-header-column-active")},beforeStop:function(t,e){jquery__WEBPACK_IMPORTED_MODULE_1___default()(e.helper).removeClass("slick-header-column-active")},sort:function(r,o){t&&r.originalEvent.pageX>$container[0].clientWidth?e||(e=setInterval(n,100)):t&&r.originalEvent.pageX<$viewportScrollContainerX.offset().left?e||(e=setInterval(i,100)):(clearInterval(e),e=null)},stop:function(t,n){var i=!1;clearInterval(e),e=null;var r=null;if(treeColumns.hasDepth()){var o=columnPositionValidInGroup(n.item);r=o.limit,(i=!o.valid)&&alert(o.message)}if(!i&&getEditorLock().commitCurrentEdit()){var s=$headerL.sortable("toArray");s=s.concat($headerR.sortable("toArray"));for(var a=[],l=0;l<s.length;l++)a.push(columns[getColumnIndex(s[l].replace(uid,""))]);setColumns(a),trigger(self.onColumnsReordered,{impactedColumns:getImpactedColumns(r)}),t.stopPropagation(),setupColumnResize()}else jquery__WEBPACK_IMPORTED_MODULE_1___default()(this).sortable("cancel")}})}function getImpactedColumns(t){var e=[];if(t)for(var n=t.start;n<=t.end;n++)e.push(columns[n]);else e=columns;return e}function setupColumnResize(){var t,e,n,i,r,o,s,a,l,c=0;(r=$headers.children()).find(".slick-resizable-handle").remove(),r.each((function(t,e){t>=columns.length||columns[t].resizable&&(void 0===a&&(a=t),l=t)})),void 0!==a&&r.each((function(u,h){u>=columns.length||u<a||options.forceFitColumns&&u>=l||(jquery__WEBPACK_IMPORTED_MODULE_1___default()(h),jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='slick-resizable-handle' />").data("__doc__",__doc__).appendTo(h).on("dragstart",(function(e,a){if(!getEditorLock().commitCurrentEdit())return!1;i=e.pageX,c=0,jquery__WEBPACK_IMPORTED_MODULE_1___default()(this).parent().addClass("slick-header-column-active");var l=null,h=null;if(r.each((function(t,e){t>=columns.length||(columns[t].previousWidth=jquery__WEBPACK_IMPORTED_MODULE_1___default()(e).outerWidth())})),options.forceFitColumns)for(l=0,h=0,t=u+1;t<columns.length;t++)(n=columns[t]).resizable&&(null!==h&&(n.maxWidth?h+=n.maxWidth-n.previousWidth:h=null),l+=n.previousWidth-Math.max(n.minWidth||0,absoluteColumnMinWidth));var d=0,f=0;for(t=0;t<=u;t++)(n=columns[t]).resizable&&(null!==f&&(n.maxWidth?f+=n.maxWidth-n.previousWidth:f=null),d+=n.previousWidth-Math.max(n.minWidth||0,absoluteColumnMinWidth));null===l&&(l=1e5),null===d&&(d=1e5),null===h&&(h=1e5),null===f&&(f=1e5),s=i+Math.min(l,f),o=i-Math.min(d,h)})).on("drag",(function(r,a){columnResizeDragging=!0;var l,h,d=Math.min(s,Math.max(o,r.pageX))-i,f=0,p=viewportHasVScroll?viewportW-scrollbarDimensions.width:viewportW;if(d<0){for(h=d,t=u;t>=0;t--)(n=columns[t]).resizable&&(l=Math.max(n.minWidth||0,absoluteColumnMinWidth),h&&n.previousWidth+h<l?(h+=n.previousWidth-l,n.width=l):(n.width=n.previousWidth+h,h=0));for(e=0;e<=u;e++)n=columns[e],hasFrozenColumns()&&e>options.frozenColumn?n.width:f+=n.width;if(options.forceFitColumns)for(h=-d,t=u+1;t<columns.length;t++)(n=columns[t]).resizable&&(h&&n.maxWidth&&n.maxWidth-n.previousWidth<h?(h-=n.maxWidth-n.previousWidth,n.width=n.maxWidth):(n.width=n.previousWidth+h,h=0),hasFrozenColumns()&&t>options.frozenColumn?n.width:f+=n.width);else for(t=u+1;t<columns.length;t++)n=columns[t],hasFrozenColumns()&&t>options.frozenColumn?n.width:f+=n.width;if(options.forceFitColumns)for(h=-d,t=u+1;t<columns.length;t++)(n=columns[t]).resizable&&(h&&n.maxWidth&&n.maxWidth-n.previousWidth<h?(h-=n.maxWidth-n.previousWidth,n.width=n.maxWidth):(n.width=n.previousWidth+h,h=0))}else{for(h=d,f=0,t=u;t>=0;t--)if((n=columns[t]).resizable)if(h&&n.maxWidth&&n.maxWidth-n.previousWidth<h)h-=n.maxWidth-n.previousWidth,n.width=n.maxWidth;else{var g=n.previousWidth+h,m=canvasWidthL+h;hasFrozenColumns()&&t<=options.frozenColumn?(g>c&&m<p-options.frozenRightViewportMinWidth&&(c=g),n.width=m+options.frozenRightViewportMinWidth>p?c:g):n.width=g,h=0}for(e=0;e<=u;e++)n=columns[e],hasFrozenColumns()&&e>options.frozenColumn?n.width:f+=n.width;if(options.forceFitColumns)for(h=-d,t=u+1;t<columns.length;t++)(n=columns[t]).resizable&&(l=Math.max(n.minWidth||0,absoluteColumnMinWidth),h&&n.previousWidth+h<l?(h+=n.previousWidth-l,n.width=l):(n.width=n.previousWidth+h,h=0),hasFrozenColumns()&&t>options.frozenColumn?n.width:f+=n.width);else for(t=u+1;t<columns.length;t++)n=columns[t],hasFrozenColumns()&&t>options.frozenColumn?n.width:f+=n.width}hasFrozenColumns()&&f!=canvasWidthL&&($headerL.width(f+1e3),$paneHeaderR.css("left",f)),applyColumnHeaderWidths(),applyColumnGroupHeaderWidths(),options.syncColumnCellResize&&applyColumnWidths(),trigger(self.onColumnsDrag,{triggeredByColumn:jquery__WEBPACK_IMPORTED_MODULE_1___default()(this).parent().attr("id").replace(uid,""),resizeHandle:jquery__WEBPACK_IMPORTED_MODULE_1___default()(this)})})).on("dragend",(function(e,i){jquery__WEBPACK_IMPORTED_MODULE_1___default()(this).parent().removeClass("slick-header-column-active");var o,s=jquery__WEBPACK_IMPORTED_MODULE_1___default()(this).parent().attr("id").replace(uid,"");for(!0===trigger(self.onBeforeColumnsResize,{triggeredByColumn:s})&&(applyColumnHeaderWidths(),applyColumnGroupHeaderWidths()),t=0;t<columns.length;t++)n=columns[t],o=jquery__WEBPACK_IMPORTED_MODULE_1___default()(r[t]).outerWidth(),n.previousWidth!==o&&n.rerenderOnResize&&invalidateAllRows();updateCanvasWidth(!0),render(),trigger(self.onColumnsResized,{triggeredByColumn:s}),setTimeout((function(){columnResizeDragging=!1}),300)})).on("dblclick",(function(){var t=jquery__WEBPACK_IMPORTED_MODULE_1___default()(this).parent().attr("id").replace(uid,"");trigger(self.onColumnsResizeDblClick,{triggeredByColumn:t})})))}))}function getVBoxDelta(t){var e=0;return t&&"function"==typeof t.css&&jquery__WEBPACK_IMPORTED_MODULE_1___default().each(["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],(function(n,i){e+=parseFloat(t.css(i))||0})),e}function setFrozenOptions(){options.frozenColumn=options.frozenColumn>=0&&options.frozenColumn<columns.length?parseInt(options.frozenColumn):-1,options.frozenRow>-1?(hasFrozenRows=!0,frozenRowsHeight=options.frozenRow*options.rowHeight,getDataLength(),actualFrozenRow=options.frozenBottom?dataLength-options.frozenRow:options.frozenRow):hasFrozenRows=!1}function setPaneVisibility(){hasFrozenColumns()?($paneHeaderR.show(),$paneTopR.show(),hasFrozenRows?($paneBottomL.show(),$paneBottomR.show()):($paneBottomR.hide(),$paneBottomL.hide())):($paneHeaderR.hide(),$paneTopR.hide(),$paneBottomR.hide(),hasFrozenRows?$paneBottomL.show():($paneBottomR.hide(),$paneBottomL.hide()))}function setOverflow(){$viewportTopL.css({"overflow-x":hasFrozenColumns()?hasFrozenRows&&!options.alwaysAllowHorizontalScroll?"hidden":"scroll":hasFrozenRows&&!options.alwaysAllowHorizontalScroll?"hidden":"auto","overflow-y":!hasFrozenColumns()&&options.alwaysShowVerticalScroll?"scroll":hasFrozenColumns()?"hidden":hasFrozenRows?"scroll":"auto"}),$viewportTopR.css({"overflow-x":hasFrozenColumns()?hasFrozenRows&&!options.alwaysAllowHorizontalScroll?"hidden":"scroll":hasFrozenRows&&!options.alwaysAllowHorizontalScroll?"hidden":"auto","overflow-y":options.alwaysShowVerticalScroll?"scroll":(hasFrozenColumns(),hasFrozenRows?"scroll":"auto")}),$viewportBottomL.css({"overflow-x":hasFrozenColumns()?hasFrozenRows&&!options.alwaysAllowHorizontalScroll?"scroll":"auto":(hasFrozenRows&&options.alwaysAllowHorizontalScroll,"auto"),"overflow-y":!hasFrozenColumns()&&options.alwaysShowVerticalScroll?"scroll":hasFrozenColumns()?"hidden":hasFrozenRows?"scroll":"auto"}),$viewportBottomR.css({"overflow-x":hasFrozenColumns()?hasFrozenRows&&!options.alwaysAllowHorizontalScroll?"scroll":"auto":(hasFrozenRows&&options.alwaysAllowHorizontalScroll,"auto"),"overflow-y":options.alwaysShowVerticalScroll?"scroll":(hasFrozenColumns(),"auto")}),options.viewportClass&&($viewportTopL.toggleClass(options.viewportClass,!0),$viewportTopR.toggleClass(options.viewportClass,!0),$viewportBottomL.toggleClass(options.viewportClass,!0),$viewportBottomR.toggleClass(options.viewportClass,!0))}function setScroller(){hasFrozenColumns()?($headerScrollContainer=$headerScrollerR,$headerRowScrollContainer=$headerRowScrollerR,$footerRowScrollContainer=$footerRowScrollerR,hasFrozenRows?options.frozenBottom?($viewportScrollContainerX=$viewportBottomR,$viewportScrollContainerY=$viewportTopR):$viewportScrollContainerX=$viewportScrollContainerY=$viewportBottomR:$viewportScrollContainerX=$viewportScrollContainerY=$viewportTopR):($headerScrollContainer=$headerScrollerL,$headerRowScrollContainer=$headerRowScrollerL,$footerRowScrollContainer=$footerRowScrollerL,hasFrozenRows?options.frozenBottom?($viewportScrollContainerX=$viewportBottomL,$viewportScrollContainerY=$viewportTopL):$viewportScrollContainerX=$viewportScrollContainerY=$viewportBottomL:$viewportScrollContainerX=$viewportScrollContainerY=$viewportTopL)}function measureCellPaddingAndBorder(){var t,e=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],n=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],i=jquery__WEBPACK_IMPORTED_MODULE_1___default().fn.jquery.split(".");jQueryNewWidthBehaviour=1==i[0]&&i[1]>=8||i[0]>=2,t=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='ui-state-default slick-header-column' style='visibility:hidden'>-</div>").appendTo($headers),headerColumnWidthDiff=headerColumnHeightDiff=0,"border-box"!=t.css("box-sizing")&&"border-box"!=t.css("-moz-box-sizing")&&"border-box"!=t.css("-webkit-box-sizing")&&(jquery__WEBPACK_IMPORTED_MODULE_1___default().each(e,(function(e,n){headerColumnWidthDiff+=parseFloat(t.css(n))||0})),jquery__WEBPACK_IMPORTED_MODULE_1___default().each(n,(function(e,n){headerColumnHeightDiff+=parseFloat(t.css(n))||0}))),t.remove();var r=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='slick-row' />").appendTo($canvas);t=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='slick-cell' id='' style='visibility:hidden'>-</div>").appendTo(r),cellWidthDiff=cellHeightDiff=0,"border-box"!=t.css("box-sizing")&&"border-box"!=t.css("-moz-box-sizing")&&"border-box"!=t.css("-webkit-box-sizing")&&(jquery__WEBPACK_IMPORTED_MODULE_1___default().each(e,(function(e,n){cellWidthDiff+=parseFloat(t.css(n))||0})),jquery__WEBPACK_IMPORTED_MODULE_1___default().each(n,(function(e,n){cellHeightDiff+=parseFloat(t.css(n))||0}))),r.remove(),absoluteColumnMinWidth=Math.max(headerColumnWidthDiff,cellWidthDiff)}function createCssRules(){$style=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<style type='text/css' rel='stylesheet'/>").appendTo(__doc__.head);for(var t=options.rowHeight-cellHeightDiff,e=["."+uid+" .slick-group-header-column { left: 1000px; }","."+uid+" .slick-header-column { left: 1000px; }","."+uid+" .slick-top-panel { height:"+options.topPanelHeight+"px; }","."+uid+" .slick-preheader-panel { height:"+options.preHeaderPanelHeight+"px; }","."+uid+" .slick-headerrow-columns { height:"+options.headerRowHeight+"px; }","."+uid+" .slick-footerrow-columns { height:"+options.footerRowHeight+"px; }","."+uid+" .slick-cell { height:"+t+"px; }","."+uid+" .slick-row { height:"+options.rowHeight+"px; }"],n=0;n<columns.length;n++)e.push("."+uid+" .l"+n+" { }"),e.push("."+uid+" .r"+n+" { }");$style[0].styleSheet?$style[0].styleSheet.cssText=e.join(" "):$style[0].appendChild(__doc__.createTextNode(e.join(" ")))}function getColumnCssRules(t){var e;if(!stylesheet){var n=__doc__.styleSheets;for(let t=0;t<n.length;t++){if((n[t].ownerNode||n[t].owningElement)==$style[0]){stylesheet=n[t];break}if(n[t].rules[0].selectorText&&n[t].rules[0].selectorText.includes(uid)){stylesheet=n[t];break}}if(!stylesheet)throw new Error("SlickGrid Cannot find stylesheet.");columnCssRulesL=[],columnCssRulesR=[];var i,r,o=stylesheet.cssRules||stylesheet.rules;for(e=0;e<o.length;e++){var s=o[e].selectorText;(i=/\.l\d+/.exec(s))?(r=parseInt(i[0].substr(2,i[0].length-2),10),columnCssRulesL[r]=o[e]):(i=/\.r\d+/.exec(s))&&(r=parseInt(i[0].substr(2,i[0].length-2),10),columnCssRulesR[r]=o[e])}}return{left:columnCssRulesL[t],right:columnCssRulesR[t]}}function removeCssRules(){$style.remove(),stylesheet=null}function destroy(t){getEditorLock().cancelCurrentEdit(),trigger(self.onBeforeDestroy,{});for(var e=plugins.length;e--;)unregisterPlugin(plugins[e]);options.enableColumnReorder&&$headers.filter(":ui-sortable").sortable("destroy"),unbindAncestorScrollEvents(),$container.off(".slickgrid"),removeCssRules(),$canvas.off(),$viewport.off(),$headerScroller.off(),$headerRowScroller.off(),$footerRow&&$footerRow.off(),$footerRowScroller&&$footerRowScroller.off(),$preHeaderPanelScroller&&$preHeaderPanelScroller.off(),$focusSink.off(),jquery__WEBPACK_IMPORTED_MODULE_1___default()(".slick-resizable-handle").off(),jquery__WEBPACK_IMPORTED_MODULE_1___default()(".slick-header-column").off(),$container.empty().removeClass(uid),t&&destroyAllElements()}function destroyAllElements(){$activeCanvasNode=null,$activeViewportNode=null,$boundAncestors=null,$canvas=null,$canvasTopL=null,$canvasTopR=null,$canvasBottomL=null,$canvasBottomR=null,$container=null,$focusSink=null,$focusSink2=null,$groupHeaders=null,$groupHeadersL=null,$groupHeadersR=null,$headerL=null,$headerR=null,$headers=null,$headerRow=null,$headerRowL=null,$headerRowR=null,$headerRowSpacerL=null,$headerRowSpacerR=null,$headerRowScrollContainer=null,$headerRowScroller=null,$headerRowScrollerL=null,$headerRowScrollerR=null,$headerScrollContainer=null,$headerScroller=null,$headerScrollerL=null,$headerScrollerR=null,$hiddenParents=null,$footerRow=null,$footerRowL=null,$footerRowR=null,$footerRowSpacerL=null,$footerRowSpacerR=null,$footerRowScroller=null,$footerRowScrollerL=null,$footerRowScrollerR=null,$footerRowScrollContainer=null,$preHeaderPanel=null,$preHeaderPanelR=null,$preHeaderPanelScroller=null,$preHeaderPanelScrollerR=null,$preHeaderPanelSpacer=null,$preHeaderPanelSpacerR=null,$topPanel=null,$topPanelScroller=null,$style=null,$topPanelScrollerL=null,$topPanelScrollerR=null,$topPanelL=null,$topPanelR=null,$paneHeaderL=null,$paneHeaderR=null,$paneTopL=null,$paneTopR=null,$paneBottomL=null,$paneBottomR=null,$viewport=null,$viewportTopL=null,$viewportTopR=null,$viewportBottomL=null,$viewportBottomR=null,$viewportScrollContainerX=null,$viewportScrollContainerY=null}var canvas=null,canvas_context=null;function autosizeColumn(t,e){var n=t;if("number"==typeof t)n=columns[t];else if("string"==typeof t)for(var i=0;i<columns.length;i++)columns[i].Id===t&&(n=columns[i]);getColAutosizeWidth(n,jquery__WEBPACK_IMPORTED_MODULE_1___default()(getCanvasNode(0,0)),e)}function autosizeColumns(t,e){if((t=t||options.autosizeColsMode)!==_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.GridAutosizeColsMode.LegacyForceFit&&t!==_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.GridAutosizeColsMode.LegacyOff){if(t!==_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.GridAutosizeColsMode.None){(canvas=__doc__.createElement("canvas"))&&canvas.getContext&&(canvas_context=canvas.getContext("2d"));var n,i,r,o,s=jquery__WEBPACK_IMPORTED_MODULE_1___default()(getCanvasNode(0,0)),a=viewportHasVScroll?viewportW-scrollbarDimensions.width:viewportW,l=0,c=0,u=0,h=0,d=0;for(n=0;n<columns.length;n++)getColAutosizeWidth(i=columns[n],s,e),d+=i.autoSize.autosizeMode===_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.ColAutosizeMode.Locked?i.width:0,h+=i.autoSize.autosizeMode===_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.ColAutosizeMode.Locked?i.width:i.minWidth,l+=i.autoSize.widthPx,c+=i.autoSize.sizeToRemaining?0:i.autoSize.widthPx,u+=i.autoSize.sizeToRemaining&&i.minWidth||0;var f=l-c;if(t===_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.GridAutosizeColsMode.FitViewportToCols){var p=l+scrollbarDimensions.width;t=_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.GridAutosizeColsMode.IgnoreViewport,options.viewportMaxWidthPx&&p>options.viewportMaxWidthPx?(p=options.viewportMaxWidthPx,t=_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.GridAutosizeColsMode.FitColsToViewport):options.viewportMinWidthPx&&p<options.viewportMinWidthPx&&(p=options.viewportMinWidthPx,t=_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.GridAutosizeColsMode.FitColsToViewport),$container.width(p)}if(t===_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.GridAutosizeColsMode.FitColsToViewport)if(f>0&&c<a-u)for(n=0;n<columns.length;n++){var g=a-c;r=(i=columns[n]).autoSize.sizeToRemaining?g*i.autoSize.widthPx/f:i.autoSize.widthPx,i.rerenderOnResize&&i.width!=r&&(o=!0),i.width=r}else if(options.viewportSwitchToScrollModeWidthPercent&&c+u>a*options.viewportSwitchToScrollModeWidthPercent/100||h>a)t=_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.GridAutosizeColsMode.IgnoreViewport;else{var m=c-d,_=a-d-u;for(n=0;n<columns.length;n++)r=(i=columns[n]).width,i.autoSize.autosizeMode!==_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.ColAutosizeMode.Locked&&(i.autoSize.sizeToRemaining?r=i.minWidth:((r=_/m*i.autoSize.widthPx)<i.minWidth&&(r=i.minWidth),m-=i.autoSize.widthPx,_-=r)),i.rerenderOnResize&&i.width!=r&&(o=!0),i.width=r}if(t===_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.GridAutosizeColsMode.IgnoreViewport)for(n=0;n<columns.length;n++)r=columns[n].autoSize.widthPx,columns[n].rerenderOnResize&&columns[n].width!=r&&(o=!0),columns[n].width=r;reRenderColumns(o)}}else legacyAutosizeColumns()}function LogColWidths(){for(var t="Col Widths:",e=0;e<columns.length;e++)t+=" "+columns[e].width;console.log(t)}function getColAutosizeWidth(t,e,n){var i=t.autoSize;if(i.widthPx=t.width,i.autosizeMode!==_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.ColAutosizeMode.Locked&&i.autosizeMode!==_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.ColAutosizeMode.Guide){var r=getDataLength();if(i.autosizeMode===_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.ColAutosizeMode.ContentIntelligent){var o,s=i.colDataTypeOf;if(r>0){var a=getDataItem(0);a&&"object"==(s=typeof(o=a[t.field]))&&(o instanceof Date&&(s="date"),"undefined"!=typeof moment&&o instanceof moment&&(s="moment"))}"boolean"===s&&(i.colValueArray=[!0,!1]),"number"===s&&(i.valueFilterMode=_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.ValueFilterMode.GetGreatestAndSub,i.rowSelectionMode=_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.RowSelectionMode.AllRows),"string"===s&&(i.valueFilterMode=_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.ValueFilterMode.GetLongestText,i.rowSelectionMode=_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.RowSelectionMode.AllRows,i.allowAddlPercent=5),"date"===s&&(i.colValueArray=[new Date(2009,8,30,12,20,20)]),"moment"===s&&"undefined"!=typeof moment&&(i.colValueArray=[moment([2009,8,30,12,20,20])])}var l=getColContentSize(t,e,n);l=l*(i.allowAddlPercent?1+i.allowAddlPercent/100:1)+options.autosizeColPaddingPx,t.minWidth&&l<t.minWidth&&(l=t.minWidth),t.maxWidth&&l>t.maxWidth&&(l=t.maxWidth),i.widthPx=l}}function getColContentSize(t,e,n){var i,r=t.autoSize,o=1,s=0,a=0;if(r.ignoreHeaderText||(a=getColHeaderWidth(t)),r.colValueArray)return s=getColWidth(t,e,r.colValueArray),Math.max(a,s);var l=getData();l.getItems&&(l=l.getItems());var c=(n?r.rowSelectionModeOnInit:void 0)||r.rowSelectionMode;if(c===_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.RowSelectionMode.FirstRow&&(l=l.slice(0,1)),c===_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.RowSelectionMode.LastRow&&(l=l.slice(l.length-1,l.length)),c===_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.RowSelectionMode.FirstNRows&&(l=l.slice(0,r.rowSelectionCount)),r.valueFilterMode===_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.ValueFilterMode.DeDuplicate){var u={};for(h=0,i=l.length;h<i;h++)u[l[h][t.field]]=!0;if(Object.keys)l=Object.keys(u);else for(var h in l=[],u)l.push(h)}if(r.valueFilterMode===_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.ValueFilterMode.GetGreatestAndSub){var d,f=0;for(h=0,i=l.length;h<i;h++)g=l[h][t.field],Math.abs(g)>f&&(d=g,f=Math.abs(g));d=""+d,l=[d=+(d=Array(d.length+1).join("9"))]}if(r.valueFilterMode===_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.ValueFilterMode.GetLongestTextAndSub){var p=0;for(h=0,i=l.length;h<i;h++)((g=l[h][t.field])||"").length>p&&(p=g.length);g=Array(p+1).join("m"),o=options.autosizeTextAvgToMWidthRatio,l=[g]}if(r.valueFilterMode===_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.ValueFilterMode.GetLongestText){p=0;var g,m=0;for(h=0,i=l.length;h<i;h++)((g=l[h][t.field])||"").length>p&&(p=g.length,m=h);l=[g=l[m][t.field]]}return s=getColWidth(t,e,l)*o,Math.max(a,s)}function getColWidth(t,e,n){var i=getColumnIndex(t.id),r=jquery__WEBPACK_IMPORTED_MODULE_1___default()('<div class="slick-row ui-widget-content"></div>'),o=jquery__WEBPACK_IMPORTED_MODULE_1___default()('<div class="slick-cell"></div>');o.css({position:"absolute",visibility:"hidden","text-overflow":"initial","white-space":"nowrap"}),r.append(o),e.append(r);var s,a,l,c,u=0;return canvas_context&&t.autoSize.widthEvalMode===_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.WidthEvalMode.CanvasTextSize?(canvas_context.font=o.css("font-size")+" "+o.css("font-family"),jquery__WEBPACK_IMPORTED_MODULE_1___default()(n).each((function(e,n){c=Array.isArray(n)?n[t.field]:n,(s=(a=""+c)?canvas_context.measureText(a).width:0)>u&&(u=s,l=a)})),o.html(l),s=o.outerWidth(),r.remove(),o=null,s):(jquery__WEBPACK_IMPORTED_MODULE_1___default()(n).each((function(e,n){c=Array.isArray(n)?n[t.field]:n,applyFormatResultToCellNode(t.formatterOverride?t.formatterOverride(e,i,c,t,n,self):t.formatter?t.formatter(e,i,c,t,n,self):""+c,o[0]),(s=o.outerWidth())>u&&(u=s)})),r.remove(),o=null,u)}function getColHeaderWidth(t){var e=0,n=getUID()+t.id,i=__doc__.getElementById(n),r=n+"_";if(i){var o=i.cloneNode(!0);o.id=r,o.style.cssText="position: absolute; visibility: hidden;right: auto;text-overflow: initial;white-space: nowrap;",i.parentNode.insertBefore(o,i),e=o.offsetWidth,o.parentNode.removeChild(o)}else{var s=getHeader(t);e=(i=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div class='ui-state-default slick-header-column' />").html("<span class='slick-column-name'>"+t.name+"</span>").attr("id",r).css({position:"absolute",visibility:"hidden",right:"auto","text-overflow:":"initial","white-space":"nowrap"}).addClass(t.headerCssClass||"").appendTo(s))[0].offsetWidth,s[0].removeChild(i[0])}return e}function legacyAutosizeColumns(){var t,e,n,i=[],r=0,o=0,s=viewportHasVScroll?viewportW-scrollbarDimensions.width:viewportW;for(t=0;t<columns.length;t++)e=columns[t],i.push(e.width),o+=e.width,e.resizable&&(r+=e.width-Math.max(e.minWidth,absoluteColumnMinWidth));for(n=o;o>s&&r;){var a=(o-s)/r;for(t=0;t<columns.length&&o>s;t++){e=columns[t];var l=i[t];if(!(!e.resizable||l<=e.minWidth||l<=absoluteColumnMinWidth)){var c=Math.max(e.minWidth,absoluteColumnMinWidth),u=Math.floor(a*(l-c))||1;o-=u=Math.min(u,l-c),r-=u,i[t]-=u}}if(n<=o)break;n=o}for(n=o;o<s;){var h=s/o;for(t=0;t<columns.length&&o<s;t++){e=columns[t];var d,f=i[t];o+=d=!e.resizable||e.maxWidth<=f?0:Math.min(Math.floor(h*f)-f,e.maxWidth-f||1e6)||1,i[t]+=o<=s?d:0}if(n>=o)break;n=o}var p=!1;for(t=0;t<columns.length;t++)columns[t].rerenderOnResize&&columns[t].width!=i[t]&&(p=!0),columns[t].width=i[t];reRenderColumns(p)}function reRenderColumns(t){applyColumnHeaderWidths(),applyColumnGroupHeaderWidths(),updateCanvasWidth(!0),trigger(self.onAutosizeColumns,{columns}),t&&(invalidateAllRows(),render())}function trigger(t,e,n){return n=n||new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.EventData,(e=e||{}).grid=self,t.notify(e,n,self)}function getEditorLock(){return options.editorLock}function getEditController(){return editController}function getColumnIndex(t){return columnsById[t]}function applyColumnGroupHeaderWidths(){if(treeColumns.hasDepth())for(var t=$groupHeadersL.length-1;t>=0;t--)treeColumns.getColumnsInDepth(t),jquery__WEBPACK_IMPORTED_MODULE_1___default()().add($groupHeadersL[t]).add($groupHeadersR[t]).each((function(t){var e=jquery__WEBPACK_IMPORTED_MODULE_1___default()(this),n=0;e.width(0===t?getHeadersWidthL():getHeadersWidthR()),e.children().each((function(){var t=jquery__WEBPACK_IMPORTED_MODULE_1___default()(this),i=jquery__WEBPACK_IMPORTED_MODULE_1___default()(this).data("column");i.width=0,i.columns.forEach((function(){var t=e.next().children(":eq("+n+++")");i.width+=t.outerWidth()})),t.width(i.width-headerColumnWidthDiff)}))}))}function applyColumnHeaderWidths(){if(initialized){for(var t,e=0,n=$headers.children(),i=columns.length;e<i;e++)t=jquery__WEBPACK_IMPORTED_MODULE_1___default()(n[e]),jQueryNewWidthBehaviour?t.outerWidth()!==columns[e].width&&t.outerWidth(columns[e].width):t.width()!==columns[e].width-headerColumnWidthDiff&&t.width(columns[e].width-headerColumnWidthDiff);updateColumnCaches()}}function applyColumnWidths(){for(var t,e,n=0,i=0;i<columns.length;i++)t=columns[i].width,(e=getColumnCssRules(i)).left.style.left=n+"px",e.right.style.right=(-1!=options.frozenColumn&&i>options.frozenColumn?canvasWidthR:canvasWidthL)-n-t+"px",options.frozenColumn==i?n=0:n+=columns[i].width}function setSortColumn(t,e){setSortColumns([{columnId:t,sortAsc:e}])}function setSortColumns(t){sortColumns=t;var e=options.numberedMultiColumnSort&&sortColumns.length>1,n=$headers.children();n.removeClass("slick-header-column-sorted").find(".slick-sort-indicator").removeClass("slick-sort-indicator-asc slick-sort-indicator-desc"),n.find(".slick-sort-indicator-numbered").text(""),jquery__WEBPACK_IMPORTED_MODULE_1___default().each(sortColumns,(function(t,i){null==i.sortAsc&&(i.sortAsc=!0);var r=getColumnIndex(i.columnId);null!=r&&(n.eq(r).addClass("slick-header-column-sorted").find(".slick-sort-indicator").addClass(i.sortAsc?"slick-sort-indicator-asc":"slick-sort-indicator-desc"),e&&n.eq(r).find(".slick-sort-indicator-numbered").text(t+1))}))}function getSortColumns(){return sortColumns}function handleSelectedRangesChanged(t,e){var n=selectedRows.slice(0);selectedRows=[];for(var i={},r=0;r<e.length;r++)for(var o=e[r].fromRow;o<=e[r].toRow;o++){i[o]||(selectedRows.push(o),i[o]={});for(var s=e[r].fromCell;s<=e[r].toCell;s++)canCellBeSelected(o,s)&&(i[o][columns[s].id]=options.selectedCellCssClass)}setCellCssStyles(options.selectedCellCssClass,i),simpleArrayEquals(n,selectedRows)&&trigger(self.onSelectedRowsChanged,{rows:getSelectedRows(),previousSelectedRows:n},t)}function simpleArrayEquals(t,e){return Array.isArray(t)&&Array.isArray(e)&&e.sort().toString()!==t.sort().toString()}function getColumns(){return columns}function updateColumnCaches(){columnPosLeft=[],columnPosRight=[];for(var t=0,e=0,n=columns.length;e<n;e++)columnPosLeft[e]=t,columnPosRight[e]=t+columns[e].width,options.frozenColumn==e?t=0:t+=columns[e].width}function updateColumnProps(){columnsById={};for(var t=0;t<columns.length;t++){columns[t].width&&(columns[t].widthRequest=columns[t].width);var e=columns[t]=jquery__WEBPACK_IMPORTED_MODULE_1___default().extend({},columnDefaults,columns[t]);e.autoSize=jquery__WEBPACK_IMPORTED_MODULE_1___default().extend({},columnAutosizeDefaults,e.autoSize),columnsById[e.id]=t,e.minWidth&&e.width<e.minWidth&&(e.width=e.minWidth),e.maxWidth&&e.width>e.maxWidth&&(e.width=e.maxWidth),e.resizable}}function setColumns(t){var e=new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.TreeColumns(t);columns=e.hasDepth()?(treeColumns=e).extractColumns():t,updateColumnProps(),updateColumnCaches(),initialized&&(setPaneVisibility(),setOverflow(),invalidateAllRows(),createColumnHeaders(),createColumnGroupHeaders(),createColumnFooter(),removeCssRules(),createCssRules(),resizeCanvas(),updateCanvasWidth(),applyColumnHeaderWidths(),applyColumnWidths(),handleScroll())}function getOptions(){return options}function setOptions(t,e,n,i){if(getEditorLock().commitCurrentEdit()){makeActiveCellNormal(),void 0!==t.showColumnHeader&&setColumnHeaderVisibility(t.showColumnHeader),options.enableAddRow!==t.enableAddRow&&invalidateRow(getDataLength());var r=jquery__WEBPACK_IMPORTED_MODULE_1___default().extend(!0,{},options);if(options=jquery__WEBPACK_IMPORTED_MODULE_1___default().extend(options,t),trigger(self.onSetOptions,{optionsBefore:r,optionsAfter:options}),validateAndEnforceOptions(),$viewport.css("overflow-y",options.autoHeight?"hidden":"auto"),e||render(),setFrozenOptions(),setScroller(),i||setOverflow(),zombieRowNodeFromLastMouseWheelEvent=null,n||setColumns(treeColumns.extractColumns()),options.enableMouseWheelScrollHandler&&$viewport&&jQuery.fn.mousewheel){var o=jquery__WEBPACK_IMPORTED_MODULE_1___default()._data($viewport[0],"events");o&&o.mousewheel||$viewport.on("mousewheel",handleMouseWheel)}else!1===options.enableMouseWheelScrollHandler&&$viewport.off("mousewheel")}}function validateAndEnforceOptions(){options.autoHeight&&(options.leaveSpaceForNewRows=!1),options.forceFitColumns&&(options.autosizeColsMode=_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.GridAutosizeColsMode.LegacyForceFit,console.log("forceFitColumns option is deprecated - use autosizeColsMode"))}function setData(t,e){data=t,invalidateAllRows(),updateRowCount(),e&&scrollTo(0)}function getData(){return data}function getDataLength(){return data.getLength?data.getLength():data&&data.length||0}function getDataLengthIncludingAddNew(){return getDataLength()+(!options.enableAddRow||pagingActive&&!pagingIsLastPage?0:1)}function getDataItem(t){return data.getItem?data.getItem(t):data[t]}function getTopPanel(){return $topPanel[0]}function setTopPanelVisibility(t,e){var n=!1!==e;options.showTopPanel!=t&&(options.showTopPanel=t,t?n?$topPanelScroller.slideDown("fast",resizeCanvas):($topPanelScroller.show(),resizeCanvas()):n?$topPanelScroller.slideUp("fast",resizeCanvas):($topPanelScroller.hide(),resizeCanvas()))}function setHeaderRowVisibility(t,e){var n=!1!==e;options.showHeaderRow!=t&&(options.showHeaderRow=t,t?n?$headerRowScroller.slideDown("fast",resizeCanvas):($headerRowScroller.show(),resizeCanvas()):n?$headerRowScroller.slideUp("fast",resizeCanvas):($headerRowScroller.hide(),resizeCanvas()))}function setColumnHeaderVisibility(t,e){options.showColumnHeader!=t&&(options.showColumnHeader=t,t?e?$headerScroller.slideDown("fast",resizeCanvas):($headerScroller.show(),resizeCanvas()):e?$headerScroller.slideUp("fast",resizeCanvas):($headerScroller.hide(),resizeCanvas()))}function setFooterRowVisibility(t,e){var n=!1!==e;options.showFooterRow!=t&&(options.showFooterRow=t,t?n?$footerRowScroller.slideDown("fast",resizeCanvas):($footerRowScroller.show(),resizeCanvas()):n?$footerRowScroller.slideUp("fast",resizeCanvas):($footerRowScroller.hide(),resizeCanvas()))}function setPreHeaderPanelVisibility(t,e){var n=!1!==e;options.showPreHeaderPanel!=t&&(options.showPreHeaderPanel=t,t?n?($preHeaderPanelScroller.slideDown("fast",resizeCanvas),$preHeaderPanelScrollerR.slideDown("fast",resizeCanvas)):($preHeaderPanelScroller.show(),$preHeaderPanelScrollerR.show(),resizeCanvas()):n?($preHeaderPanelScroller.slideUp("fast",resizeCanvas),$preHeaderPanelScrollerR.slideUp("fast",resizeCanvas)):($preHeaderPanelScroller.hide(),$preHeaderPanelScrollerR.hide(),resizeCanvas()))}function getContainerNode(){return $container.get(0)}function getRowTop(t){return options.rowHeight*t-offset}function getRowFromPosition(t){return Math.floor((t+offset)/options.rowHeight)}function scrollTo(t){t=Math.max(t,0),t=Math.min(t,th-$viewportScrollContainerY.height()+(viewportHasHScroll||hasFrozenColumns()?scrollbarDimensions.height:0));var e=offset;page=Math.min(n-1,Math.floor(t/ph));var i=t-(offset=Math.round(page*cj));offset!=e&&(cleanupRows(getVisibleRange(i)),updateRowPositions()),prevScrollTop!=i&&(vScrollDir=prevScrollTop+e<i+offset?1:-1,lastRenderedScrollTop=scrollTop=prevScrollTop=i,hasFrozenColumns()&&($viewportTopL[0].scrollTop=i),hasFrozenRows&&($viewportBottomL[0].scrollTop=$viewportBottomR[0].scrollTop=i),$viewportScrollContainerY[0].scrollTop=i,trigger(self.onViewportChanged,{}))}function defaultFormatter(t,e,n,i,r,o){return null==n?"":(n+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function getFormatter(t,e){var n=data.getItemMetadata&&data.getItemMetadata(t),i=n&&n.columns&&(n.columns[e.id]||n.columns[getColumnIndex(e.id)]);return i&&i.formatter||n&&n.formatter||e.formatter||options.formatterFactory&&options.formatterFactory.getFormatter(e)||options.defaultFormatter}function getEditor(t,e){var n=columns[e],i=data.getItemMetadata&&data.getItemMetadata(t),r=i&&i.columns;return r&&r[n.id]&&void 0!==r[n.id].editor?r[n.id].editor:r&&r[e]&&void 0!==r[e].editor?r[e].editor:n.editor||options.editorFactory&&options.editorFactory.getEditor(n)}function getDataItemValueForColumn(t,e){return options.dataItemColumnValueExtractor?options.dataItemColumnValueExtractor(t,e):t[e.field]}function appendRowHtml(t,e,n,i,r){var o=getDataItem(n),s=n<r&&!o,a="slick-row"+(hasFrozenRows&&n<=options.frozenRow?" frozen":"")+(s?" loading":"")+(n===activeRow&&options.showCellSelection?" active":"")+(n%2==1?" odd":" even");o||(a+=" "+options.addNewRowCssClass);var l=data.getItemMetadata&&data.getItemMetadata(n);l&&l.cssClasses&&(a+=" "+l.cssClasses);var c,u,h=getFrozenRowOffset(n),d="<div class='ui-widget-content "+a+"' style='top:"+(getRowTop(n)-h)+"px'>";t.push(d),hasFrozenColumns()&&e.push(d);for(var f=0,p=columns.length;f<p;f++){if(u=columns[f],c=1,l&&l.columns){var g=l.columns[u.id]||l.columns[f];"*"===(c=g&&g.colspan||1)&&(c=p-f)}if(columnPosRight[Math.min(p-1,f+c-1)]>i.leftPx){if(!u.alwaysRenderColumn&&columnPosLeft[f]>i.rightPx)break;hasFrozenColumns()&&f>options.frozenColumn?appendCellHtml(e,n,f,c,o):appendCellHtml(t,n,f,c,o)}else(u.alwaysRenderColumn||hasFrozenColumns()&&f<=options.frozenColumn)&&appendCellHtml(t,n,f,c,o);c>1&&(f+=c-1)}t.push("</div>"),hasFrozenColumns()&&e.push("</div>")}function appendCellHtml(t,e,n,i,r){var o=columns[n],s="slick-cell l"+n+" r"+Math.min(columns.length-1,n+i-1)+(o.cssClass?" "+o.cssClass:"");for(var a in hasFrozenColumns()&&n<=options.frozenColumn&&(s+=" frozen"),e===activeRow&&n===activeCell&&options.showCellSelection&&(s+=" active"),cellCssClasses)cellCssClasses[a][e]&&cellCssClasses[a][e][o.id]&&(s+=" "+cellCssClasses[a][e][o.id]);var l=null,c="";r&&(l=getDataItemValueForColumn(r,o),null==(c=getFormatter(e,o)(e,n,l,o,r,self))&&(c=""));var u=trigger(self.onBeforeAppendCell,{row:e,cell:n,value:l,dataContext:r})||"";u+=c&&c.addClasses?(u?" ":"")+c.addClasses:"";var h=c&&c.toolTip?"title='"+c.toolTip+"'":"",d="";if(o.hasOwnProperty("cellAttrs")&&o.cellAttrs instanceof Object)for(var a in o.cellAttrs)o.cellAttrs.hasOwnProperty(a)&&(d+=" "+a+'="'+o.cellAttrs[a]+'" ');t.push("<div class='"+s+(u?" "+u:"")+"' "+h+d+">"),r&&t.push("[object Object]"!==Object.prototype.toString.call(c)?c:c.text),t.push("</div>"),rowsCache[e].cellRenderQueue.push(n),rowsCache[e].cellColSpans[n]=i}function cleanupRows(t){for(var e in rowsCache){var n=!0;hasFrozenRows&&(options.frozenBottom&&e>=actualFrozenRow||!options.frozenBottom&&e<=actualFrozenRow)&&(n=!1),(e=parseInt(e,10))!==activeRow&&(e<t.top||e>t.bottom)&&n&&removeRowFromCache(e)}options.enableAsyncPostRenderCleanup&&startPostProcessingCleanup()}function invalidate(){updateRowCount(),invalidateAllRows(),render()}function invalidateAllRows(){for(var t in currentEditor&&makeActiveCellNormal(),rowsCache)removeRowFromCache(t);options.enableAsyncPostRenderCleanup&&startPostProcessingCleanup()}function queuePostProcessedRowForCleanup(t,e,n){for(var i in postProcessgroupId++,e)e.hasOwnProperty(i)&&postProcessedCleanupQueue.push({actionType:"C",groupId:postProcessgroupId,node:t.cellNodesByColumnIdx[0|i],columnIdx:0|i,rowIdx:n});postProcessedCleanupQueue.push({actionType:"R",groupId:postProcessgroupId,node:t.rowNode}),jquery__WEBPACK_IMPORTED_MODULE_1___default()(t.rowNode).detach()}function queuePostProcessedCellForCleanup(t,e,n){postProcessedCleanupQueue.push({actionType:"C",groupId:postProcessgroupId,node:t,columnIdx:e,rowIdx:n}),jquery__WEBPACK_IMPORTED_MODULE_1___default()(t).detach()}function removeRowFromCache(t){var e=rowsCache[t];e&&(rowNodeFromLastMouseWheelEvent==e.rowNode[0]||hasFrozenColumns()&&rowNodeFromLastMouseWheelEvent==e.rowNode[1]?(e.rowNode.hide(),zombieRowNodeFromLastMouseWheelEvent=e.rowNode):e.rowNode.each((function(){this.parentElement.removeChild(this)})),delete rowsCache[t],delete postProcessedRows[t],renderedRows--,counter_rows_removed++)}function invalidateRows(t){var e,n;if(t&&t.length){for(vScrollDir=0,n=t.length,e=0;e<n;e++)currentEditor&&activeRow===t[e]&&makeActiveCellNormal(),rowsCache[t[e]]&&removeRowFromCache(t[e]);options.enableAsyncPostRenderCleanup&&startPostProcessingCleanup()}}function invalidateRow(t){(t||0===t)&&invalidateRows([t])}function applyFormatResultToCellNode(t,e,n){null==t&&(t=""),"[object Object]"===Object.prototype.toString.call(t)?(e.innerHTML=t.text,t.removeClasses&&!n&&jquery__WEBPACK_IMPORTED_MODULE_1___default()(e).removeClass(t.removeClasses),t.addClasses&&jquery__WEBPACK_IMPORTED_MODULE_1___default()(e).addClass(t.addClasses),t.toolTip&&jquery__WEBPACK_IMPORTED_MODULE_1___default()(e).attr("title",t.toolTip)):e.innerHTML=t}function updateCell(t,e){var n=getCellNode(t,e);if(n){var i=columns[e],r=getDataItem(t);currentEditor&&activeRow===t&&activeCell===e?currentEditor.loadValue(r):(applyFormatResultToCellNode(r?getFormatter(t,i)(t,e,getDataItemValueForColumn(r,i),i,r,self):"",n),invalidatePostProcessingResults(t))}}function updateRow(t){var e=rowsCache[t];if(e){ensureCellNodesInRowsCache(t);var n=getDataItem(t);for(var i in e.cellNodesByColumnIdx)if(e.cellNodesByColumnIdx.hasOwnProperty(i)){var r=columns[i|=0],o=e.cellNodesByColumnIdx[i][0];t===activeRow&&i===activeCell&&currentEditor?currentEditor.loadValue(n):n?applyFormatResultToCellNode(getFormatter(t,r)(t,i,getDataItemValueForColumn(n,r),r,n,self),o):o.innerHTML=""}invalidatePostProcessingResults(t)}}function getViewportHeight(){if(options.autoHeight&&-1==options.frozenColumn||(topPanelH=options.showTopPanel?options.topPanelHeight+getVBoxDelta($topPanelScroller):0,headerRowH=options.showHeaderRow?options.headerRowHeight+getVBoxDelta($headerRowScroller):0,footerRowH=options.showFooterRow?options.footerRowHeight+getVBoxDelta($footerRowScroller):0),options.autoHeight){var t=$paneHeaderL.outerHeight();t+=options.showHeaderRow?options.headerRowHeight+getVBoxDelta($headerRowScroller):0,t+=options.showFooterRow?options.footerRowHeight+getVBoxDelta($footerRowScroller):0,t+=getCanvasWidth()>viewportW?scrollbarDimensions.height:0,viewportH=options.rowHeight*getDataLengthIncludingAddNew()+(-1==options.frozenColumn?t:0)}else{var e=options.showColumnHeader?parseFloat(jquery__WEBPACK_IMPORTED_MODULE_1___default().css($headerScroller[0],"height"))+getVBoxDelta($headerScroller):0,n=options.createPreHeaderPanel&&options.showPreHeaderPanel?options.preHeaderPanelHeight+getVBoxDelta($preHeaderPanelScroller):0;viewportH=parseFloat(jquery__WEBPACK_IMPORTED_MODULE_1___default().css($container[0],"height",!0))-parseFloat(jquery__WEBPACK_IMPORTED_MODULE_1___default().css($container[0],"paddingTop",!0))-parseFloat(jquery__WEBPACK_IMPORTED_MODULE_1___default().css($container[0],"paddingBottom",!0))-e-topPanelH-headerRowH-footerRowH-n}return numVisibleRows=Math.ceil(viewportH/options.rowHeight),viewportH}function getViewportWidth(){viewportW=parseFloat($container.width())}function resizeCanvas(){if(initialized){paneTopH=0,paneBottomH=0,viewportTopH=0,viewportBottomH=0,getViewportWidth(),getViewportHeight(),hasFrozenRows?options.frozenBottom?(paneTopH=viewportH-frozenRowsHeight-scrollbarDimensions.height,paneBottomH=frozenRowsHeight+scrollbarDimensions.height):(paneTopH=frozenRowsHeight,paneBottomH=viewportH-frozenRowsHeight):paneTopH=viewportH,paneTopH+=topPanelH+headerRowH+footerRowH,hasFrozenColumns()&&options.autoHeight&&(paneTopH+=scrollbarDimensions.height),viewportTopH=paneTopH-topPanelH-headerRowH-footerRowH,options.autoHeight&&(hasFrozenColumns()&&$container.height(paneTopH+parseFloat(jquery__WEBPACK_IMPORTED_MODULE_1___default().css($headerScrollerL[0],"height"))),$paneTopL.css("position","relative")),$paneTopL.css({top:$paneHeaderL.height()||(options.showHeaderRow?options.headerRowHeight:0)+(options.showPreHeaderPanel?options.preHeaderPanelHeight:0),height:paneTopH});var t=$paneTopL.position().top+paneTopH;options.autoHeight||$viewportTopL.height(viewportTopH),hasFrozenColumns()?($paneTopR.css({top:$paneHeaderL.height(),height:paneTopH}),$viewportTopR.height(viewportTopH),hasFrozenRows&&($paneBottomL.css({top:t,height:paneBottomH}),$paneBottomR.css({top:t,height:paneBottomH}),$viewportBottomR.height(paneBottomH))):hasFrozenRows&&($paneBottomL.css({width:"100%",height:paneBottomH}),$paneBottomL.css("top",t)),hasFrozenRows?($viewportBottomL.height(paneBottomH),options.frozenBottom?($canvasBottomL.height(frozenRowsHeight),hasFrozenColumns()&&$canvasBottomR.height(frozenRowsHeight)):($canvasTopL.height(frozenRowsHeight),hasFrozenColumns()&&$canvasTopR.height(frozenRowsHeight))):$viewportTopR.height(viewportTopH),scrollbarDimensions&&scrollbarDimensions.width||(scrollbarDimensions=measureScrollbar()),options.autosizeColsMode===_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.GridAutosizeColsMode.LegacyForceFit&&autosizeColumns(),updateRowCount(),handleScroll(),lastRenderedScrollLeft=-1,render()}}function updatePagingStatusFromView(t){pagingActive=0!==t.pageSize,pagingIsLastPage=t.pageNum==t.totalPages-1}function updateRowCount(){if(initialized){var t=getDataLength(),e=getDataLengthIncludingAddNew(),i=0,r=hasFrozenRows&&!options.frozenBottom?$canvasBottomL.height():$canvasTopL.height();i=hasFrozenRows?getDataLength()-options.frozenRow:e+(options.leaveSpaceForNewRows?numVisibleRows-1:0);var o=$viewportScrollContainerY.height(),s=viewportHasVScroll;viewportHasVScroll=options.alwaysShowVerticalScroll||!options.autoHeight&&i*options.rowHeight>o,makeActiveCellNormal();var a=t-1;for(var l in rowsCache)l>a&&removeRowFromCache(l);options.enableAsyncPostRenderCleanup&&startPostProcessingCleanup(),activeCellNode&&activeRow>a&&resetActiveCell(),r=h,options.autoHeight?h=options.rowHeight*i:(th=Math.max(options.rowHeight*i,o-scrollbarDimensions.height))<maxSupportedCssHeight?(h=ph=th,n=1,cj=0):(ph=(h=maxSupportedCssHeight)/100,n=Math.floor(th/ph),cj=(th-h)/(n-1)),h!==r&&(hasFrozenRows&&!options.frozenBottom?($canvasBottomL.css("height",h),hasFrozenColumns()&&$canvasBottomR.css("height",h)):($canvasTopL.css("height",h),$canvasTopR.css("height",h)),scrollTop=$viewportScrollContainerY[0].scrollTop);var c=scrollTop+offset<=th-o;0==th||0==scrollTop?page=offset=0:scrollTo(c?scrollTop+offset:th-o),h!=r&&options.autoHeight&&resizeCanvas(),options.autosizeColsMode===_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.GridAutosizeColsMode.LegacyForceFit&&s!=viewportHasVScroll&&autosizeColumns(),updateCanvasWidth(!1)}}function getVisibleRange(t,e){return null==t&&(t=scrollTop),null==e&&(e=scrollLeft),{top:getRowFromPosition(t),bottom:getRowFromPosition(t+viewportH)+1,leftPx:e,rightPx:e+viewportW}}function getRenderedRange(t,e){var n=getVisibleRange(t,e),i=Math.round(viewportH/options.rowHeight),r=options.minRowBuffer;return-1==vScrollDir?(n.top-=i,n.bottom+=r):1==vScrollDir?(n.top-=r,n.bottom+=i):(n.top-=r,n.bottom+=r),n.top=Math.max(0,n.top),n.bottom=Math.min(getDataLengthIncludingAddNew()-1,n.bottom),n.leftPx-=viewportW,n.rightPx+=viewportW,n.leftPx=Math.max(0,n.leftPx),n.rightPx=Math.min(canvasWidth,n.rightPx),n}function ensureCellNodesInRowsCache(t){var e=rowsCache[t];if(e&&e.cellRenderQueue.length)for(var n=e.rowNode.children().last();e.cellRenderQueue.length;){var i=e.cellRenderQueue.pop();e.cellNodesByColumnIdx[i]=n,0===(n=n.prev()).length&&(n=jquery__WEBPACK_IMPORTED_MODULE_1___default()(e.rowNode[0]).children().last())}}function cleanUpCells(t,e){if(!hasFrozenRows||!(options.frozenBottom&&e>actualFrozenRow||e<=actualFrozenRow)){var n,i=rowsCache[e],r=[];for(var o in i.cellNodesByColumnIdx)if(i.cellNodesByColumnIdx.hasOwnProperty(o)&&!((o|=0)<=options.frozenColumn||Array.isArray(columns)&&columns[o]&&columns[o].alwaysRenderColumn)){var s=i.cellColSpans[o];(columnPosLeft[o]>t.rightPx||columnPosRight[Math.min(columns.length-1,o+s-1)]<t.leftPx)&&(e==activeRow&&o==activeCell||r.push(o))}for(;null!=(n=r.pop());)i.cellNodesByColumnIdx[n][0].parentElement.removeChild(i.cellNodesByColumnIdx[n][0]),delete i.cellColSpans[n],delete i.cellNodesByColumnIdx[n],postProcessedRows[e]&&delete postProcessedRows[e][n]}}function cleanUpAndRenderCells(t){for(var e,n,i,r=[],o=[],s=t.top,a=t.bottom;s<=a;s++)if(e=rowsCache[s]){ensureCellNodesInRowsCache(s),cleanUpCells(t,s),n=0;var l=data.getItemMetadata&&data.getItemMetadata(s);l=l&&l.columns;for(var c=getDataItem(s),u=0,h=columns.length;u<h&&!(columnPosLeft[u]>t.rightPx);u++)if(null==(i=e.cellColSpans[u])){if(i=1,l){var d=l[columns[u].id]||l[u];"*"===(i=d&&d.colspan||1)&&(i=h-u)}columnPosRight[Math.min(h-1,u+i-1)]>t.leftPx&&(appendCellHtml(r,s,u,i,c),n++),u+=i>1?i-1:0}else u+=i>1?i-1:0;n&&o.push(s)}if(r.length){var f,p,g=__doc__.createElement("div");for(g.innerHTML=r.join("");null!=(f=o.pop());){var m;for(e=rowsCache[f];null!=(m=e.cellRenderQueue.pop());)p=g.lastChild,hasFrozenColumns()&&m>options.frozenColumn?e.rowNode[1].appendChild(p):e.rowNode[0].appendChild(p),e.cellNodesByColumnIdx[m]=jquery__WEBPACK_IMPORTED_MODULE_1___default()(p)}}}function renderRows(t){for(var e=[],n=[],i=[],r=!1,o=getDataLength(),s=t.top,a=t.bottom;s<=a;s++)rowsCache[s]||hasFrozenRows&&options.frozenBottom&&s==getDataLength()||(renderedRows++,i.push(s),rowsCache[s]={rowNode:null,cellColSpans:[],cellNodesByColumnIdx:[],cellRenderQueue:[]},appendRowHtml(e,n,s,t,o),activeCellNode&&activeRow===s&&(r=!0),counter_rows_rendered++);if(i.length){var l=__doc__.createElement("div"),c=__doc__.createElement("div");for(l.innerHTML=e.join(""),c.innerHTML=n.join(""),s=0,a=i.length;s<a;s++)hasFrozenRows&&i[s]>=actualFrozenRow?hasFrozenColumns()?rowsCache[i[s]].rowNode=jquery__WEBPACK_IMPORTED_MODULE_1___default()().add(jquery__WEBPACK_IMPORTED_MODULE_1___default()(l.firstChild).appendTo($canvasBottomL)).add(jquery__WEBPACK_IMPORTED_MODULE_1___default()(c.firstChild).appendTo($canvasBottomR)):rowsCache[i[s]].rowNode=jquery__WEBPACK_IMPORTED_MODULE_1___default()().add(jquery__WEBPACK_IMPORTED_MODULE_1___default()(l.firstChild).appendTo($canvasBottomL)):hasFrozenColumns()?rowsCache[i[s]].rowNode=jquery__WEBPACK_IMPORTED_MODULE_1___default()().add(jquery__WEBPACK_IMPORTED_MODULE_1___default()(l.firstChild).appendTo($canvasTopL)).add(jquery__WEBPACK_IMPORTED_MODULE_1___default()(c.firstChild).appendTo($canvasTopR)):rowsCache[i[s]].rowNode=jquery__WEBPACK_IMPORTED_MODULE_1___default()().add(jquery__WEBPACK_IMPORTED_MODULE_1___default()(l.firstChild).appendTo($canvasTopL));r&&(activeCellNode=getCellNode(activeRow,activeCell))}}function startPostProcessing(){options.enableAsyncPostRender&&(clearTimeout(h_postrender),h_postrender=setTimeout(asyncPostProcessRows,options.asyncPostRenderDelay))}function startPostProcessingCleanup(){options.enableAsyncPostRenderCleanup&&(clearTimeout(h_postrenderCleanup),h_postrenderCleanup=setTimeout(asyncPostProcessCleanupRows,options.asyncPostRenderCleanupDelay))}function invalidatePostProcessingResults(t){for(var e in postProcessedRows[t])postProcessedRows[t].hasOwnProperty(e)&&(postProcessedRows[t][e]="C");postProcessFromRow=Math.min(postProcessFromRow,t),postProcessToRow=Math.max(postProcessToRow,t),startPostProcessing()}function updateRowPositions(){for(var t in rowsCache){var e=t?parseInt(t):0;rowsCache[e].rowNode[0].style.top=getRowTop(e)+"px"}}function render(){if(initialized){scrollThrottle.dequeue();var t=getVisibleRange(),e=getRenderedRange();if(cleanupRows(e),lastRenderedScrollLeft!=scrollLeft){if(hasFrozenRows){var n=jQuery.extend(!0,{},e);options.frozenBottom?(n.top=actualFrozenRow,n.bottom=getDataLength()):(n.top=0,n.bottom=options.frozenRow),cleanUpAndRenderCells(n)}cleanUpAndRenderCells(e)}renderRows(e),hasFrozenRows&&(options.frozenBottom?renderRows({top:actualFrozenRow,bottom:getDataLength()-1,leftPx:e.leftPx,rightPx:e.rightPx}):renderRows({top:0,bottom:options.frozenRow-1,leftPx:e.leftPx,rightPx:e.rightPx})),postProcessFromRow=t.top,postProcessToRow=Math.min(getDataLengthIncludingAddNew()-1,t.bottom),startPostProcessing(),lastRenderedScrollTop=scrollTop,lastRenderedScrollLeft=scrollLeft,h_render=null,trigger(self.onRendered,{startRow:t.top,endRow:t.bottom,grid:self})}}function handleHeaderScroll(){handleElementScroll($headerScrollContainer[0])}function handleHeaderRowScroll(){var t=$headerRowScrollContainer[0].scrollLeft;t!=$viewportScrollContainerX[0].scrollLeft&&($viewportScrollContainerX[0].scrollLeft=t)}function handleFooterRowScroll(){var t=$footerRowScrollContainer[0].scrollLeft;t!=$viewportScrollContainerX[0].scrollLeft&&($viewportScrollContainerX[0].scrollLeft=t)}function handlePreHeaderPanelScroll(){handleElementScroll($preHeaderPanelScroller[0])}function handleElementScroll(t){var e=t.scrollLeft;e!=$viewportScrollContainerX[0].scrollLeft&&($viewportScrollContainerX[0].scrollLeft=e)}function handleScroll(){return scrollTop=$viewportScrollContainerY[0].scrollTop,scrollLeft=$viewportScrollContainerX[0].scrollLeft,_handleScroll(!1)}function _handleScroll(t){var e=$viewportScrollContainerY[0].scrollHeight-$viewportScrollContainerY[0].clientHeight,i=$viewportScrollContainerY[0].scrollWidth-$viewportScrollContainerY[0].clientWidth;e=Math.max(0,e),i=Math.max(0,i),scrollTop>e&&(scrollTop=e),scrollLeft>i&&(scrollLeft=i);var r=Math.abs(scrollTop-prevScrollTop),o=Math.abs(scrollLeft-prevScrollLeft);if(o&&(prevScrollLeft=scrollLeft,$viewportScrollContainerX[0].scrollLeft=scrollLeft,$headerScrollContainer[0].scrollLeft=scrollLeft,$topPanelScroller[0].scrollLeft=scrollLeft,$headerRowScrollContainer[0].scrollLeft=scrollLeft,options.createFooterRow&&($footerRowScrollContainer[0].scrollLeft=scrollLeft),options.createPreHeaderPanel&&(hasFrozenColumns()?$preHeaderPanelScrollerR[0].scrollLeft=scrollLeft:$preHeaderPanelScroller[0].scrollLeft=scrollLeft),hasFrozenColumns()?hasFrozenRows&&($viewportTopR[0].scrollLeft=scrollLeft):hasFrozenRows&&($viewportTopL[0].scrollLeft=scrollLeft)),r)if(vScrollDir=prevScrollTop<scrollTop?1:-1,prevScrollTop=scrollTop,t&&($viewportScrollContainerY[0].scrollTop=scrollTop),hasFrozenColumns()&&(hasFrozenRows&&!options.frozenBottom?$viewportBottomL[0].scrollTop=scrollTop:$viewportTopL[0].scrollTop=scrollTop),r<viewportH)scrollTo(scrollTop+offset);else{var s=offset;page=h==viewportH?0:Math.min(n-1,Math.floor(scrollTop*((th-viewportH)/(h-viewportH))*(1/ph))),s!=(offset=Math.round(page*cj))&&invalidateAllRows()}if(o||r){var a=Math.abs(lastRenderedScrollLeft-scrollLeft),l=Math.abs(lastRenderedScrollTop-scrollTop);(a>20||l>20)&&(options.forceSyncScrolling||l<viewportH&&a<viewportW?render():scrollThrottle.enqueue(),trigger(self.onViewportChanged,{}))}return trigger(self.onScroll,{scrollLeft,scrollTop}),!(!o&&!r)}function ActionThrottle(t,e){var n=!1,i=!1;function r(){i=!1}function o(){n=!0,setTimeout(s,e),t()}function s(){i?(r(),o()):n=!1}return{enqueue:function(){n?i=!0:o()},dequeue:r}}function asyncPostProcessRows(){for(var t=getDataLength();postProcessFromRow<=postProcessToRow;){var e=vScrollDir>=0?postProcessFromRow++:postProcessToRow--,n=rowsCache[e];if(n&&!(e>=t)){for(var i in postProcessedRows[e]||(postProcessedRows[e]={}),ensureCellNodesInRowsCache(e),n.cellNodesByColumnIdx)if(n.cellNodesByColumnIdx.hasOwnProperty(i)){var r=columns[i|=0],o=postProcessedRows[e][i];if(r.asyncPostRender&&"R"!==o){var s=n.cellNodesByColumnIdx[i];s&&r.asyncPostRender(s,e,getDataItem(e),r,"C"===o),postProcessedRows[e][i]="R"}}return void(h_postrender=setTimeout(asyncPostProcessRows,options.asyncPostRenderDelay))}}}function asyncPostProcessCleanupRows(){if(postProcessedCleanupQueue.length>0){for(var t=postProcessedCleanupQueue[0].groupId;postProcessedCleanupQueue.length>0&&postProcessedCleanupQueue[0].groupId==t;){var e=postProcessedCleanupQueue.shift();if("R"==e.actionType&&jquery__WEBPACK_IMPORTED_MODULE_1___default()(e.node).remove(),"C"==e.actionType){var n=columns[e.columnIdx];n.asyncPostRenderCleanup&&e.node&&n.asyncPostRenderCleanup(e.node,e.rowIdx,n)}}h_postrenderCleanup=setTimeout(asyncPostProcessCleanupRows,options.asyncPostRenderCleanupDelay)}}function updateCellCssStylesOnRenderedRows(t,e){var n,i,r,o;for(var s in rowsCache){if(o=e&&e[s],r=t&&t[s],o)for(i in o)r&&o[i]==r[i]||(n=getCellNode(s,getColumnIndex(i)))&&jquery__WEBPACK_IMPORTED_MODULE_1___default()(n).removeClass(o[i]);if(r)for(i in r)o&&o[i]==r[i]||(n=getCellNode(s,getColumnIndex(i)))&&jquery__WEBPACK_IMPORTED_MODULE_1___default()(n).addClass(r[i])}}function addCellCssStyles(t,e){if(cellCssClasses[t])throw new Error("SlickGrid addCellCssStyles: cell CSS hash with key '"+t+"' already exists.");cellCssClasses[t]=e,updateCellCssStylesOnRenderedRows(e,null),trigger(self.onCellCssStylesChanged,{key:t,hash:e,grid:self})}function removeCellCssStyles(t){cellCssClasses[t]&&(updateCellCssStylesOnRenderedRows(null,cellCssClasses[t]),delete cellCssClasses[t],trigger(self.onCellCssStylesChanged,{key:t,hash:null,grid:self}))}function setCellCssStyles(t,e){var n=cellCssClasses[t];cellCssClasses[t]=e,updateCellCssStylesOnRenderedRows(e,n),trigger(self.onCellCssStylesChanged,{key:t,hash:e,grid:self})}function getCellCssStyles(t){return cellCssClasses[t]}function flashCell(t,e,n){n=n||100,rowsCache[t]&&function t(e,i){i&&setTimeout((function(){e.queue((function(){e.toggleClass(options.cellFlashingCssClass).dequeue(),t(e,i-1)}))}),n)}(jquery__WEBPACK_IMPORTED_MODULE_1___default()(getCellNode(t,e)),4)}function handleMouseWheel(t,e,n,i){var r=jquery__WEBPACK_IMPORTED_MODULE_1___default()(t.target).closest(".slick-row"),o=r[0];if(o!=rowNodeFromLastMouseWheelEvent){var s=r.parents(".grid-canvas").hasClass("grid-canvas-left");if(zombieRowNodeFromLastMouseWheelEvent&&zombieRowNodeFromLastMouseWheelEvent[s?0:1]!=o){var a=zombieRowNodeFromLastMouseWheelEvent[s||1==zombieRowNodeFromLastMouseWheelEvent.length?0:1];a.parentElement.removeChild(a),zombieRowNodeFromLastMouseWheelEvent=null}rowNodeFromLastMouseWheelEvent=o}scrollTop=Math.max(0,$viewportScrollContainerY[0].scrollTop-i*options.rowHeight),scrollLeft=$viewportScrollContainerX[0].scrollLeft+10*n,_handleScroll(!0)&&t.preventDefault()}function handleDragInit(t,e){var n=getCellFromEvent(t);if(!n||!cellExists(n.row,n.cell))return!1;var i=trigger(self.onDragInit,e,t);return!!t.isImmediatePropagationStopped()&&i}function handleDragStart(t,e){var n=getCellFromEvent(t);if(!n||!cellExists(n.row,n.cell))return!1;var i=trigger(self.onDragStart,e,t);return!!t.isImmediatePropagationStopped()&&i}function handleDrag(t,e){return trigger(self.onDrag,e,t)}function handleDragEnd(t,e){trigger(self.onDragEnd,e,t)}function handleKeyDown(t){trigger(self.onKeyDown,{row:activeRow,cell:activeCell},t);var e=t.isImmediatePropagationStopped(),n=_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.keyCode;if(!e&&!t.shiftKey&&!t.altKey){if(options.editable&&currentEditor&&currentEditor.keyCaptureList&&currentEditor.keyCaptureList.indexOf(t.which)>-1)return;t.which==n.HOME?e=t.ctrlKey?navigateTop():navigateRowStart():t.which==n.END&&(e=t.ctrlKey?navigateBottom():navigateRowEnd())}if(!e)if(t.shiftKey||t.altKey||t.ctrlKey)t.which!=n.TAB||!t.shiftKey||t.ctrlKey||t.altKey||(e=navigatePrev());else{if(options.editable&&currentEditor&&currentEditor.keyCaptureList&&currentEditor.keyCaptureList.indexOf(t.which)>-1)return;if(t.which==n.ESCAPE){if(!getEditorLock().isActive())return;cancelEditAndSetFocus()}else t.which==n.PAGE_DOWN?(navigatePageDown(),e=!0):t.which==n.PAGE_UP?(navigatePageUp(),e=!0):t.which==n.LEFT?e=navigateLeft():t.which==n.RIGHT?e=navigateRight():t.which==n.UP?e=navigateUp():t.which==n.DOWN?e=navigateDown():t.which==n.TAB?e=navigateNext():t.which==n.ENTER&&(options.editable&&(currentEditor?activeRow===getDataLength()?navigateDown():commitEditAndSetFocus():getEditorLock().commitCurrentEdit()&&makeActiveCellEditable(void 0,void 0,t)),e=!0)}if(e){t.stopPropagation(),t.preventDefault();try{t.originalEvent.keyCode=0}catch(t){}}}function handleClick(t){currentEditor||(t.target!=__doc__.activeElement||jquery__WEBPACK_IMPORTED_MODULE_1___default()(t.target).hasClass("slick-cell"))&&setFocus();var e=getCellFromEvent(t);if(e&&(null===currentEditor||activeRow!=e.row||activeCell!=e.cell)&&(trigger(self.onClick,{row:e.row,cell:e.cell},t),!t.isImmediatePropagationStopped()&&canCellBeActive(e.row,e.cell)&&(!getEditorLock().isActive()||getEditorLock().commitCurrentEdit()))){scrollRowIntoView(e.row,!1);var n=t.target&&t.target.className===_Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.preClickClassName,i=columns[e.cell],r=!!(options.editable&&i&&i.editor&&options.suppressActiveCellChangeOnEdit);setActiveCellInternal(getCellNode(e.row,e.cell),null,n,r,t)}}function handleContextMenu(t){var e=jquery__WEBPACK_IMPORTED_MODULE_1___default()(t.target).closest(".slick-cell",$canvas);0!==e.length&&(activeCellNode===e[0]&&null!==currentEditor||trigger(self.onContextMenu,{},t))}function handleDblClick(t){var e=getCellFromEvent(t);!e||null!==currentEditor&&activeRow==e.row&&activeCell==e.cell||(trigger(self.onDblClick,{row:e.row,cell:e.cell},t),t.isImmediatePropagationStopped()||options.editable&&gotoCell(e.row,e.cell,!0,t))}function handleHeaderMouseEnter(t){trigger(self.onHeaderMouseEnter,{column:jquery__WEBPACK_IMPORTED_MODULE_1___default()(this).data("column"),grid:self},t)}function handleHeaderMouseLeave(t){trigger(self.onHeaderMouseLeave,{column:jquery__WEBPACK_IMPORTED_MODULE_1___default()(this).data("column"),grid:self},t)}function handleHeaderContextMenu(t){var e=jquery__WEBPACK_IMPORTED_MODULE_1___default()(t.target).closest(".slick-header-column",".slick-header-columns"),n=e&&e.data("column");trigger(self.onHeaderContextMenu,{column:n},t)}function handleHeaderClick(t){if(!columnResizeDragging){var e=jquery__WEBPACK_IMPORTED_MODULE_1___default()(t.target).closest(".slick-header-column",".slick-header-columns"),n=e&&e.data("column");n&&trigger(self.onHeaderClick,{column:n},t)}}function handleFooterContextMenu(t){var e=jquery__WEBPACK_IMPORTED_MODULE_1___default()(t.target).closest(".slick-footerrow-column",".slick-footerrow-columns"),n=e&&e.data("column");trigger(self.onFooterContextMenu,{column:n},t)}function handleFooterClick(t){var e=jquery__WEBPACK_IMPORTED_MODULE_1___default()(t.target).closest(".slick-footerrow-column",".slick-footerrow-columns"),n=e&&e.data("column");trigger(self.onFooterClick,{column:n},t)}function handleMouseEnter(t){trigger(self.onMouseEnter,{},t)}function handleMouseLeave(t){trigger(self.onMouseLeave,{},t)}function cellExists(t,e){return!(t<0||t>=getDataLength()||e<0||e>=columns.length)}function getCellFromPoint(t,e){for(var n=getRowFromPosition(e),i=0,r=0,o=0;o<columns.length&&r<t;o++)r+=columns[o].width,i++;return i<0&&(i=0),{row:n,cell:i-1}}function getCellFromNode(t){var e=/l\d+/.exec(t.className);if(!e)throw new Error("SlickGrid getCellFromNode: cannot get cell - "+t.className);return parseInt(e[0].substr(1,e[0].length-1),10)}function getRowFromNode(t){for(var e in rowsCache)for(var n in rowsCache[e].rowNode)if(rowsCache[e].rowNode[n]===t)return e?parseInt(e):0;return null}function getFrozenRowOffset(t){return hasFrozenRows?options.frozenBottom?t>=actualFrozenRow?h<viewportTopH?actualFrozenRow*options.rowHeight:h:0:t>=actualFrozenRow?frozenRowsHeight:0:0}function getCellFromEvent(t){var e,n,i=jquery__WEBPACK_IMPORTED_MODULE_1___default()(t.target).closest(".slick-cell",$canvas);if(!i.length)return null;if(e=getRowFromNode(i[0].parentNode),hasFrozenRows){var r=i.parents(".grid-canvas").offset(),o=0;i.parents(".grid-canvas-bottom").length&&(o=options.frozenBottom?$canvasTopL.height():frozenRowsHeight),e=getCellFromPoint(t.clientX-r.left,t.clientY-r.top+o+jquery__WEBPACK_IMPORTED_MODULE_1___default()(__doc__).scrollTop()).row}return n=getCellFromNode(i[0]),null==e||null==n?null:{row:e,cell:n}}function getCellNodeBox(t,e){if(!cellExists(t,e))return null;for(var n=getFrozenRowOffset(t),i=getRowTop(t)-n,r=i+options.rowHeight-1,o=0,s=0;s<e;s++)o+=columns[s].width,options.frozenColumn==s&&(o=0);return{top:i,left:o,bottom:r,right:o+columns[e].width}}function resetActiveCell(){setActiveCellInternal(null,!1)}function setFocus(){-1==tabbingDirection?$focusSink[0].focus():$focusSink2[0].focus()}function scrollCellIntoView(t,e,n){if(scrollRowIntoView(t,n),!(e<=options.frozenColumn)){var i=getColspan(t,e);internalScrollColumnIntoView(columnPosLeft[e],columnPosRight[e+(i>1?i-1:0)])}}function internalScrollColumnIntoView(t,e){var n=scrollLeft+$viewportScrollContainerX.width();t<scrollLeft?($viewportScrollContainerX.scrollLeft(t),handleScroll(),render()):e>n&&($viewportScrollContainerX.scrollLeft(Math.min(t,e-$viewportScrollContainerX[0].clientWidth)),handleScroll(),render())}function scrollColumnIntoView(t){internalScrollColumnIntoView(columnPosLeft[t],columnPosRight[t])}function setActiveCellInternal(t,e,n,i,r){if(null!==activeCellNode&&(makeActiveCellNormal(),jquery__WEBPACK_IMPORTED_MODULE_1___default()(activeCellNode).removeClass("active"),rowsCache[activeRow]&&jquery__WEBPACK_IMPORTED_MODULE_1___default()(rowsCache[activeRow].rowNode).removeClass("active")),null!=(activeCellNode=t)){var o=jquery__WEBPACK_IMPORTED_MODULE_1___default()(activeCellNode),s=o.offset(),a=Math.floor(o.parents(".grid-canvas").offset().top),l=o.parents(".grid-canvas-bottom").length;hasFrozenRows&&l&&(a-=options.frozenBottom?$canvasTopL.height():frozenRowsHeight);var c=getCellFromPoint(s.left,Math.ceil(s.top)-a);activeRow=c.row,activeCell=activePosX=activeCell=activePosX=getCellFromNode(activeCellNode),null==e&&(e=activeRow==getDataLength()||options.autoEdit),options.showCellSelection&&(o.addClass("active"),rowsCache[activeRow]&&jquery__WEBPACK_IMPORTED_MODULE_1___default()(rowsCache[activeRow].rowNode).addClass("active")),options.editable&&e&&isCellPotentiallyEditable(activeRow,activeCell)&&(clearTimeout(h_editorLoader),options.asyncEditorLoading?h_editorLoader=setTimeout((function(){makeActiveCellEditable(void 0,n,r)}),options.asyncEditorLoadDelay):makeActiveCellEditable(void 0,n,r))}else activeRow=activeCell=null;i||trigger(self.onActiveCellChanged,getActiveCell())}function clearTextSelection(){if(__doc__.selection&&__doc__.selection.empty)try{__doc__.selection.empty()}catch(t){}else if(window.getSelection){var t=window.getSelection();t&&t.removeAllRanges&&t.removeAllRanges()}}function isCellPotentiallyEditable(t,e){var n=getDataLength();return!(t<n&&!getDataItem(t)||columns[e].cannotTriggerInsert&&t>=n||!getEditor(t,e))}function makeActiveCellNormal(){if(currentEditor){if(trigger(self.onBeforeCellEditorDestroy,{editor:currentEditor}),currentEditor.destroy(),currentEditor=null,activeCellNode){var t=getDataItem(activeRow);if(jquery__WEBPACK_IMPORTED_MODULE_1___default()(activeCellNode).removeClass("editable invalid"),t){var e=columns[activeCell];applyFormatResultToCellNode(getFormatter(activeRow,e)(activeRow,activeCell,getDataItemValueForColumn(t,e),e,t,self),activeCellNode),invalidatePostProcessingResults(activeRow)}}navigator.userAgent.toLowerCase().match(/msie/)&&clearTextSelection(),getEditorLock().deactivate(editController)}}function makeActiveCellEditable(t,e,n){if(activeCellNode){if(!options.editable)throw new Error("SlickGrid makeActiveCellEditable : should never get called when options.editable is false");if(clearTimeout(h_editorLoader),isCellPotentiallyEditable(activeRow,activeCell)){var i=columns[activeCell],r=getDataItem(activeRow);if(!1!==trigger(self.onBeforeEditCell,{row:activeRow,cell:activeCell,item:r,column:i,target:"grid"})){getEditorLock().activate(editController),jquery__WEBPACK_IMPORTED_MODULE_1___default()(activeCellNode).addClass("editable");var o=t||getEditor(activeRow,activeCell);t||o.suppressClearOnEdit||(activeCellNode.innerHTML="");var s=data.getItemMetadata&&data.getItemMetadata(activeRow),a=(s=s&&s.columns)&&(s[i.id]||s[activeCell]);currentEditor=new o({grid:self,gridPosition:absBox($container[0]),position:absBox(activeCellNode),container:activeCellNode,column:i,columnMetaData:a,item:r||{},event:n,commitChanges:commitEditAndSetFocus,cancelChanges:cancelEditAndSetFocus}),r&&(currentEditor.loadValue(r),e&&currentEditor.preClick&&currentEditor.preClick()),serializedEditorValue=currentEditor.serializeValue(),currentEditor.position&&handleActiveCellPositionChange()}else setFocus()}}}function commitEditAndSetFocus(){getEditorLock().commitCurrentEdit()&&(setFocus(),options.autoEdit&&navigateDown())}function cancelEditAndSetFocus(){getEditorLock().cancelCurrentEdit()&&setFocus()}function absBox(t){var e={top:t.offsetTop,left:t.offsetLeft,bottom:0,right:0,width:jquery__WEBPACK_IMPORTED_MODULE_1___default()(t).outerWidth(),height:jquery__WEBPACK_IMPORTED_MODULE_1___default()(t).outerHeight(),visible:!0};e.bottom=e.top+e.height,e.right=e.left+e.width;for(var n=t.offsetParent;(t=t.parentNode)!=__doc__.body&&null!=t;)e.visible&&t.scrollHeight!=t.offsetHeight&&"visible"!=jquery__WEBPACK_IMPORTED_MODULE_1___default()(t).css("overflowY")&&(e.visible=e.bottom>t.scrollTop&&e.top<t.scrollTop+t.clientHeight),e.visible&&t.scrollWidth!=t.offsetWidth&&"visible"!=jquery__WEBPACK_IMPORTED_MODULE_1___default()(t).css("overflowX")&&(e.visible=e.right>t.scrollLeft&&e.left<t.scrollLeft+t.clientWidth),e.left-=t.scrollLeft,e.top-=t.scrollTop,t===n&&(e.left+=t.offsetLeft,e.top+=t.offsetTop,n=t.offsetParent),e.bottom=e.top+e.height,e.right=e.left+e.width;return e}function getActiveCellPosition(){return absBox(activeCellNode)}function getGridPosition(){return absBox($container[0])}function handleActiveCellPositionChange(){if(activeCellNode&&(trigger(self.onActiveCellPositionChanged,{}),currentEditor)){var t=getActiveCellPosition();currentEditor.show&&currentEditor.hide&&(t.visible?currentEditor.show():currentEditor.hide()),currentEditor.position&&currentEditor.position(t)}}function getCellEditor(){return currentEditor}function getActiveCell(){return activeCellNode?{row:activeRow,cell:activeCell}:null}function getActiveCellNode(){return activeCellNode}function scrollRowIntoView(t,e){if(!hasFrozenRows||!options.frozenBottom&&t>actualFrozenRow-1||options.frozenBottom&&t<actualFrozenRow-1){var n=$viewportScrollContainerY.height(),i=hasFrozenRows&&!options.frozenBottom?t-options.frozenRow:t,r=i*options.rowHeight,o=(i+1)*options.rowHeight-n+(viewportHasHScroll?scrollbarDimensions.height:0);(i+1)*options.rowHeight>scrollTop+n+offset?(scrollTo(e?r:o),render()):i*options.rowHeight<scrollTop+offset&&(scrollTo(e?o:r),render())}}function scrollRowToTop(t){scrollTo(t*options.rowHeight),render()}function scrollPage(t){var e=t*numVisibleRows;if(scrollTo((getRowFromPosition(scrollTop+options.rowHeight-1)+e)*options.rowHeight),render(),options.enableCellNavigation&&null!=activeRow){var n=activeRow+e,i=getDataLengthIncludingAddNew();n>=i&&(n=i-1),n<0&&(n=0);for(var r=0,o=null,s=activePosX;r<=activePosX;)canCellBeActive(n,r)&&(o=r),r+=getColspan(n,r);null!==o?(setActiveCellInternal(getCellNode(n,o)),activePosX=s):resetActiveCell()}}function navigatePageDown(){scrollPage(1)}function navigatePageUp(){scrollPage(-1)}function navigateTop(){navigateToRow(0)}function navigateBottom(){navigateToRow(getDataLength()-1)}function navigateToRow(t){var e=getDataLength();if(!e)return!0;if(t<0?t=0:t>=e&&(t=e-1),scrollCellIntoView(t,0,!0),options.enableCellNavigation&&null!=activeRow){for(var n=0,i=null,r=activePosX;n<=activePosX;)canCellBeActive(t,n)&&(i=n),n+=getColspan(t,n);null!==i?(setActiveCellInternal(getCellNode(t,i)),activePosX=r):resetActiveCell()}return!0}function getColspan(t,e){var n=data.getItemMetadata&&data.getItemMetadata(t);if(!n||!n.columns)return 1;var i=n.columns[columns[e].id]||n.columns[e],r=i&&i.colspan;return"*"===r?columns.length-e:r||1}function findFirstFocusableCell(t){for(var e=0;e<columns.length;){if(canCellBeActive(t,e))return e;e+=getColspan(t,e)}return null}function findLastFocusableCell(t){for(var e=0,n=null;e<columns.length;)canCellBeActive(t,e)&&(n=e),e+=getColspan(t,e);return n}function gotoRight(t,e,n){if(e>=columns.length)return null;do{e+=getColspan(t,e)}while(e<columns.length&&!canCellBeActive(t,e));return e<columns.length?{row:t,cell:e,posX:e}:null}function gotoLeft(t,e,n){if(e<=0)return null;var i=findFirstFocusableCell(t);if(null===i||i>=e)return null;for(var r,o={row:t,cell:i,posX:i};;){if(!(r=gotoRight(o.row,o.cell,o.posX)))return null;if(r.cell>=e)return o;o=r}}function gotoDown(t,e,n){for(var i,r=getDataLengthIncludingAddNew();;){if(++t>=r)return null;for(i=e=0;e<=n;)i=e,e+=getColspan(t,e);if(canCellBeActive(t,i))return{row:t,cell:i,posX:n}}}function gotoUp(t,e,n){for(var i;;){if(--t<0)return null;for(i=e=0;e<=n;)i=e,e+=getColspan(t,e);if(canCellBeActive(t,i))return{row:t,cell:i,posX:n}}}function gotoNext(t,e,n){if(null==t&&null==e&&canCellBeActive(t=e=n=0,e))return{row:t,cell:e,posX:e};var i=gotoRight(t,e,n);if(i)return i;var r=null,o=getDataLengthIncludingAddNew();for(t===o-1&&t--;++t<o;)if(null!==(r=findFirstFocusableCell(t)))return{row:t,cell:r,posX:r};return null}function gotoPrev(t,e,n){if(null==t&&null==e&&canCellBeActive(t=getDataLengthIncludingAddNew()-1,e=n=columns.length-1))return{row:t,cell:e,posX:e};for(var i,r;!i&&!(i=gotoLeft(t,e,n));){if(--t<0)return null;e=0,null!==(r=findLastFocusableCell(t))&&(i={row:t,cell:r,posX:r})}return i}function gotoRowStart(t,e,n){var i=findFirstFocusableCell(t);return null===i?null:{row:t,cell:i,posX:i}}function gotoRowEnd(t,e,n){var i=findLastFocusableCell(t);return null===i?null:{row:t,cell:i,posX:i}}function navigateRight(){return navigate("right")}function navigateLeft(){return navigate("left")}function navigateDown(){return navigate("down")}function navigateUp(){return navigate("up")}function navigateNext(){return navigate("next")}function navigatePrev(){return navigate("prev")}function navigateRowStart(){return navigate("home")}function navigateRowEnd(){return navigate("end")}function navigate(t){if(!options.enableCellNavigation)return!1;if(!activeCellNode&&"prev"!=t&&"next"!=t)return!1;if(!getEditorLock().commitCurrentEdit())return!0;setFocus(),tabbingDirection={up:-1,down:1,left:-1,right:1,prev:-1,next:1,home:-1,end:1}[t];var e=(0,{up:gotoUp,down:gotoDown,left:gotoLeft,right:gotoRight,prev:gotoPrev,next:gotoNext,home:gotoRowStart,end:gotoRowEnd}[t])(activeRow,activeCell,activePosX);if(e){if(hasFrozenRows&&options.frozenBottom&e.row==getDataLength())return;var n=e.row==getDataLength();return(!options.frozenBottom&&e.row>=actualFrozenRow||options.frozenBottom&&e.row<actualFrozenRow)&&scrollCellIntoView(e.row,e.cell,!n&&options.emulatePagingWhenScrolling),setActiveCellInternal(getCellNode(e.row,e.cell)),activePosX=e.posX,!0}return setActiveCellInternal(getCellNode(activeRow,activeCell)),!1}function getCellNode(t,e){if(rowsCache[t]){ensureCellNodesInRowsCache(t);try{return rowsCache[t].cellNodesByColumnIdx.length>e?rowsCache[t].cellNodesByColumnIdx[e][0]:null}catch(n){return rowsCache[t].cellNodesByColumnIdx[e]}}return null}function setActiveCell(t,e,n,i,r){initialized&&(t>getDataLength()||t<0||e>=columns.length||e<0||options.enableCellNavigation&&(scrollCellIntoView(t,e,!1),setActiveCellInternal(getCellNode(t,e),n,i,r)))}function setActiveRow(t,e,n){initialized&&(t>getDataLength()||t<0||e>=columns.length||e<0||(activeRow=t,n||scrollCellIntoView(t,e||0,!1)))}function canCellBeActive(t,e){if(!options.enableCellNavigation||t>=getDataLengthIncludingAddNew()||t<0||e>=columns.length||e<0)return!1;var n=data.getItemMetadata&&data.getItemMetadata(t);if(n&&void 0!==n.focusable)return!!n.focusable;var i=n&&n.columns;return i&&i[columns[e].id]&&void 0!==i[columns[e].id].focusable?!!i[columns[e].id].focusable:i&&i[e]&&void 0!==i[e].focusable?!!i[e].focusable:!!columns[e].focusable}function canCellBeSelected(t,e){if(t>=getDataLength()||t<0||e>=columns.length||e<0)return!1;var n=data.getItemMetadata&&data.getItemMetadata(t);if(n&&void 0!==n.selectable)return!!n.selectable;var i=n&&n.columns&&(n.columns[columns[e].id]||n.columns[e]);return i&&void 0!==i.selectable?!!i.selectable:!!columns[e].selectable}function gotoCell(t,e,n,i){if(initialized&&canCellBeActive(t,e)&&getEditorLock().commitCurrentEdit()){scrollCellIntoView(t,e,!1);var r=getCellNode(t,e),o=columns[e],s=!!(options.editable&&o&&o.editor&&options.suppressActiveCellChangeOnEdit);setActiveCellInternal(r,n||t===getDataLength()||options.autoEdit,null,s,i),currentEditor||setFocus()}}function commitCurrentEdit(){var t=getDataItem(activeRow),e=columns[activeCell];if(currentEditor){if(currentEditor.isValueChanged()){var n=currentEditor.validate();if(n.valid){if(activeRow<getDataLength()){var i={row:activeRow,cell:activeCell,editor:currentEditor,serializedValue:currentEditor.serializeValue(),prevSerializedValue:serializedEditorValue,execute:function(){this.editor.applyValue(t,this.serializedValue),updateRow(this.row),trigger(self.onCellChange,{row:this.row,cell:this.cell,item:t,column:e})},undo:function(){this.editor.applyValue(t,this.prevSerializedValue),updateRow(this.row),trigger(self.onCellChange,{row:this.row,cell:this.cell,item:t,column:e})}};options.editCommandHandler?(makeActiveCellNormal(),options.editCommandHandler(t,e,i)):(i.execute(),makeActiveCellNormal())}else{var r={};currentEditor.applyValue(r,currentEditor.serializeValue()),makeActiveCellNormal(),trigger(self.onAddNewRow,{item:r,column:e})}return!getEditorLock().isActive()}return jquery__WEBPACK_IMPORTED_MODULE_1___default()(activeCellNode).removeClass("invalid"),jquery__WEBPACK_IMPORTED_MODULE_1___default()(activeCellNode).width(),jquery__WEBPACK_IMPORTED_MODULE_1___default()(activeCellNode).addClass("invalid"),trigger(self.onValidationError,{editor:currentEditor,cellNode:activeCellNode,validationResults:n,row:activeRow,cell:activeCell,column:e}),currentEditor.focus(),!1}makeActiveCellNormal()}return!0}function cancelCurrentEdit(){return makeActiveCellNormal(),!0}function rowsToRanges(t){for(var e=[],n=columns.length-1,i=0;i<t.length;i++)e.push(new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Range(t[i],0,t[i],n));return e}function getSelectedRows(){if(!selectionModel)throw new Error("SlickGrid Selection model is not set");return selectedRows.slice(0)}function setSelectedRows(t){if(!selectionModel)throw new Error("SlickGrid Selection model is not set");self&&self.getEditorLock&&!self.getEditorLock().isActive()&&selectionModel.setSelectedRanges(rowsToRanges(t))}function getBaseDocument(){return __doc__}function setBaseDocument(t){stylesheet=null;var e=(__doc__=t).styleSheets;for(let t=0;t<e.length;t++)if(e[t].rules[0].selectorText&&e[t].rules[0].selectorText.includes(uid)){stylesheet=e[t];break}$style=jquery__WEBPACK_IMPORTED_MODULE_1___default()(stylesheet.ownerNode),removeCssRules(),createCssRules(),setColumns(columns)}this.debug=function(){var t="";t+="\ncounter_rows_rendered:  "+counter_rows_rendered,t+="\ncounter_rows_removed:  "+counter_rows_removed,t+="\nrenderedRows:  "+renderedRows,t+="\nnumVisibleRows:  "+numVisibleRows,t+="\nmaxSupportedCssHeight:  "+maxSupportedCssHeight,t+="\nn(umber of pages):  "+n,t+="\n(current) page:  "+page,t+="\npage height (ph):  "+ph,t+="\nvScrollDir:  "+vScrollDir,alert(t)},this.eval=function(expr){return eval(expr)},jquery__WEBPACK_IMPORTED_MODULE_1___default().extend(this,{slickGridVersion:"2.4.38",onScroll:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onSort:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onHeaderMouseEnter:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onHeaderMouseLeave:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onHeaderContextMenu:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onHeaderClick:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onHeaderCellRendered:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onBeforeHeaderCellDestroy:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onHeaderRowCellRendered:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onFooterRowCellRendered:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onFooterContextMenu:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onFooterClick:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onBeforeHeaderRowCellDestroy:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onBeforeFooterRowCellDestroy:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onMouseEnter:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onMouseLeave:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onClick:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onDblClick:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onContextMenu:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onKeyDown:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onAddNewRow:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onBeforeAppendCell:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onValidationError:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onViewportChanged:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onColumnsReordered:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onColumnsDrag:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onColumnsResized:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onColumnsResizeDblClick:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onBeforeColumnsResize:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onCellChange:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onCompositeEditorChange:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onBeforeEditCell:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onBeforeCellEditorDestroy:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onBeforeDestroy:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onActiveCellChanged:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onActiveCellPositionChanged:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onDragInit:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onDragStart:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onDrag:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onDragEnd:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onSelectedRowsChanged:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onCellCssStylesChanged:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onAutosizeColumns:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onRendered:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,onSetOptions:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event,registerPlugin,unregisterPlugin,getPluginByName,getColumns,setColumns,getColumnIndex,updateColumnHeader,setSortColumn,setSortColumns,getSortColumns,autosizeColumns,autosizeColumn,getOptions,setOptions,getData,getDataLength,getDataItem,setData,getSelectionModel,setSelectionModel,getSelectedRows,setSelectedRows,getContainerNode,updatePagingStatusFromView,applyFormatResultToCellNode,render,reRenderColumns,invalidate,invalidateRow,invalidateRows,invalidateAllRows,updateCell,updateRow,getViewport:getVisibleRange,getRenderedRange,resizeCanvas,updateRowCount,scrollRowIntoView,scrollRowToTop,scrollCellIntoView,scrollColumnIntoView,getCanvasNode,getUID,getHeaderColumnWidthDiff,getScrollbarDimensions,getHeadersWidth,getCanvasWidth,getCanvases,getActiveCanvasNode,setActiveCanvasNode,getViewportNode,getViewports,getActiveViewportNode,setActiveViewportNode,focus:setFocus,scrollTo,cacheCssForHiddenInit,restoreCssFromHiddenInit,getCellFromPoint,getCellFromEvent,getActiveCell,setActiveCell,setActiveRow,getActiveCellNode,getActiveCellPosition,resetActiveCell,editActiveCell:makeActiveCellEditable,getCellEditor,getCellNode,getCellNodeBox,canCellBeSelected,canCellBeActive,navigatePrev,navigateNext,navigateUp,navigateDown,navigateLeft,navigateRight,navigatePageUp,navigatePageDown,navigateTop,navigateBottom,navigateRowStart,navigateRowEnd,gotoCell,getTopPanel,setTopPanelVisibility,getPreHeaderPanel,getPreHeaderPanelLeft:getPreHeaderPanel,getPreHeaderPanelRight,setPreHeaderPanelVisibility,getHeader,getHeaderColumn,setHeaderRowVisibility,getHeaderRow,getHeaderRowColumn,setFooterRowVisibility,getFooterRow,getFooterRowColumn,getGridPosition,flashCell,addCellCssStyles,setCellCssStyles,removeCellCssStyles,getCellCssStyles,getFrozenRowOffset,setColumnHeaderVisibility,init:finishInitialization,destroy,getEditorLock,getEditController,applyColumnWidths,setBaseDocument,getBaseDocument}),init()}function TextEditor(t){var e,n;this.init=function(){e=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<INPUT type=text class='editor-text' />").appendTo(t.container).on("keyup",(t=>{const n=t.which;37!==n&&39!==n&&8!==n?this.autoCorrect(e.val()):t.stopImmediatePropagation()}))},this.autoCorrect=function(n){const i=t.grid.getData().getValueSuggestion(n,t.column.field);i&&e.val(i)},this.destroy=function(){e.remove()},this.focus=function(){e.focus()},this.getValue=function(){return e.val()},this.setValue=function(t){e.val(t)},this.loadValue=function(i){n=i[t.column.field]||"",e.val(n),e[0].defaultValue=n,e.select()},this.serializeValue=function(){return e.val()},this.applyValue=function(e,n,i=!0){t.grid.getData().updateValue(n,e.__index__,t.column.field,i)},this.isValueChanged=function(){return!(""==e.val()&&null==n)&&e.val()!=n},this.validate=function(){if(t.column.validator){var n=t.column.validator(e.val());if(!n.valid)return n}return{valid:!0,msg:null}},this.init()}function Overlays(t){var e,n,i,r,o,s=this,a=new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.EventHandler,l={buttonCssClass:null,buttonImage:"../images/down.gif",decoratorWidth:2};function c(t,e){o.hide(),d()}function u(t,e){d()}function h(t,e){d()}function d(t,n){var i=r.getActiveCell();if(i){var o=r.getColumns()[i.cell];e.toggle(!0),e.$handle.toggle(void 0!==o.editor);var s=r.getCellNodeBox(i.row,i.cell);s.height=s.bottom-s.top,s.width=s.right-s.left,e.$left.css({left:s.left-2,top:s.top,width:2,height:s.height}),e.$right.css({left:s.left+s.width-1,top:s.top,width:2,height:s.height}),e.$top.css({left:s.left-2,top:s.top-2,width:s.width+3,height:2}),e.$bottom.css({left:s.left-2,top:s.top+s.height-1,width:s.width+3,height:2}),e.$handle.css({left:s.left+s.width-4,top:s.top+s.height-4,width:1,height:1})}else e.toggle(!1)}function f(t,e){var s=r.getActiveCell();if(r.canCellBeSelected(s.row,s.cell)&&(i=!0,t.stopImmediatePropagation()),!i)return null;const a=r.getCellEditor();return a&&a.applyValue(r.getDataItem(s.row),a.getValue(),!1),r.focus(),n=s.row,e.range={start:s,end:{}},jquery__WEBPACK_IMPORTED_MODULE_1___default()(this).css({"background-color":"transparent","border-color":"transparent"}),o.show(new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Range(s.row,s.cell))}function p(t,e){if(!i)return;var n=r.getCanvasNode();t.stopImmediatePropagation();var s=r.getCellFromPoint(t.pageX-jquery__WEBPACK_IMPORTED_MODULE_1___default()(n).offset().left,t.pageY-jquery__WEBPACK_IMPORTED_MODULE_1___default()(n).offset().top);if(!r.canCellBeSelected(s.row,s.cell))return;e.range.end=s,o.show(new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Range(e.range.start.row,e.range.start.cell,s.row,e.range.start.cell));const a=r.getViewport();a.bottom===s.row&&r.scrollRowIntoView(s.row+7),a.top===s.row&&r.scrollRowIntoView(a.top-7)}function g(t,e){if(!i)return;i=!1,jquery__WEBPACK_IMPORTED_MODULE_1___default()(this).css({"background-color":"","border-color":""}),o.hideHandle();const a=o.getSelectedRange(),l=n<a.toRow?"+":"-";s.onFillUpDown.notify({dir:l,grid:r,range:a},t,s),o.hide(),t.preventDefault(),t.stopPropagation()}function m(t,e){var n=(e||"")+"cell-overlay";this.$left=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div>").addClass(n).addClass("left").appendTo(t),this.$right=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div>").addClass(n).addClass("right").appendTo(t),this.$top=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div>").addClass(n).addClass("top").appendTo(t),this.$bottom=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div>").addClass(n).addClass("bottom").appendTo(t),this.$handle=jquery__WEBPACK_IMPORTED_MODULE_1___default()("<div>").addClass("handle-overlay").data("__doc__",r.getBaseDocument()).appendTo(t),this.toggle=function(t){this.$left.toggle(t),this.$right.toggle(t),this.$top.toggle(t),this.$bottom.toggle(t),this.$handle.toggle(t)},this.remove=function(){this.$left.remove(),this.$right.remove(),this.$top.remove(),this.$bottom.remove(),this.$handle.remove()}}function _(e){var n,i;return{hide:function(){n&&(n.toggle(!1),n=null)},hideHandle:function(){n.$handle.hide()},show:function(o){i=o,n||(n=new m(r.getCanvasNode(),"selection-"));var s=e.getCellNodeBox(o.fromRow,o.fromCell),a=e.getCellNodeBox(o.toRow,o.toCell);return n.$left.css({top:s.top-2,left:s.left-2,height:a.bottom-s.top+2,width:t.decoratorWidth}),n.$right.css({top:s.top-2,left:a.right-1,height:a.bottom-s.top+2,width:t.decoratorWidth}),n.$top.css({top:s.top-2,left:a.left-1,height:t.decoratorWidth,width:a.right-s.left+2}),n.$bottom.css({top:a.bottom-1,left:s.left-2,height:t.decoratorWidth,width:a.right-s.left+3}),n.$handle.css({top:a.bottom-3,left:s.right-4,height:1,width:1}),n},getSelectedRange:function(){return i}}}jquery__WEBPACK_IMPORTED_MODULE_1___default().extend(this,{init:function(n){var i;t=jquery__WEBPACK_IMPORTED_MODULE_1___default().extend(!0,{},l,t),o=new _(r=n),(i=new m(r.getCanvasNode())).$handle.bind("dragstart",f).bind("drag",p).bind("dragend",g),e=i,a.subscribe(r.onActiveCellChanged,c).subscribe(r.onColumnsResized,u).subscribe(r.onScroll,h)},destroy:function(){a.unsubscribeAll(),e.$handle.unbind("dragstart",f).unbind("drag",p).unbind("dragend",g),e.remove()},onFillUpDown:new _Slick_js__WEBPACK_IMPORTED_MODULE_0__.v.Event})}!function(t){t.fn.drag=function(e,n,i){var r="string"==typeof e?e:"",o=t.isFunction(e)?e:t.isFunction(n)?n:null;return 0!==r.indexOf("drag")&&(r="drag"+r),i=(e==o?n:i)||{},o?this.on(r,i,o):this.trigger(r)};var e=t.event,n=e.special,i=n.drag={defaults:{which:1,distance:0,not:":input",handle:null,relative:!1,drop:!0,click:!1},datakey:"dragdata",noBubble:!0,add:function(e){var n=t.data(this,i.datakey),r=e.data||{};n.related+=1,t.each(i.defaults,(function(t,e){void 0!==r[t]&&(n[t]=r[t])}))},remove:function(){t.data(this,i.datakey).related-=1},setup:function(){if(!t.data(this,i.datakey)){var n=t.extend({related:0},i.defaults);t.data(this,i.datakey,n),e.add(this,"touchstart mousedown",i.init,n),this.attachEvent&&this.attachEvent("ondragstart",i.dontstart)}},teardown:function(){(t.data(this,i.datakey)||{}).related||(t.removeData(this,i.datakey),e.remove(this,"touchstart mousedown",i.init),i.textselect(!0),this.detachEvent&&this.detachEvent("ondragstart",i.dontstart))},init:function(r,o){if(i.touched)return;var s,a=r.data;if(0!=r.which&&a.which>0&&r.which!=a.which)return;if(t(r.target).is(a.not))return;if(a.handle&&!t(r.target).closest(a.handle,r.currentTarget).length)return;if(i.touched="touchstart"==r.type?this:null,a.propagates=1,a.mousedown=this,a.interactions=[i.interaction(this,a)],a.target=r.target,a.pageX=r.pageX,a.pageY=r.pageY,a.dragging=null,s=i.hijack(r,"draginit",a),!a.propagates)return;(s=i.flatten(s))&&s.length&&(a.interactions=[],t.each(s,(function(){a.interactions.push(i.interaction(this,a))}))),a.propagates=a.interactions.length,!1!==a.drop&&n.drop&&n.drop.handler(r,a),i.textselect(!1);let l=t(r.currentTarget).data("__doc__")||document;return i.touched?e.add(i.touched,"touchmove touchend",i.handler,a):e.add(l,"mousemove mouseup",i.handler,a),!(!i.touched||a.live)&&void 0},interaction:function(e,n){var r=e&&e.ownerDocument&&t(e)[n.relative?"position":"offset"]()||{top:0,left:0};return{drag:e,callback:new i.callback,droppable:[],offset:r}},handler:function(r){var o=r.data;switch(r.type){case!o.dragging&&"touchmove":r.preventDefault();case!o.dragging&&"mousemove":if(Math.pow(r.pageX-o.pageX,2)+Math.pow(r.pageY-o.pageY,2)<Math.pow(o.distance,2))break;r.target=o.target,i.hijack(r,"dragstart",o),o.propagates&&(o.dragging=!0);case"touchmove":r.preventDefault();case"mousemove":if(o.dragging){if(i.hijack(r,"drag",o),o.propagates){!1!==o.drop&&n.drop&&n.drop.handler(r,o);break}r.type="mouseup"}default:let s=t(o.target).data("__doc__")||r.currentTarget||document;i.touched?e.remove(i.touched,"touchmove touchend",i.handler):e.remove(s,"mousemove mouseup",i.handler),o.dragging&&(!1!==o.drop&&n.drop&&n.drop.handler(r,o),i.hijack(r,"dragend",o)),i.textselect(!0),!1===o.click&&o.dragging&&t.data(o.mousedown,"suppress.click",(new Date).getTime()+5),o.dragging=i.touched=!1}},hijack:function(n,r,o,s,a){if(o){var l,c,u,h={event:n.originalEvent,type:n.type},d=r.indexOf("drop")?"drag":"drop",f=s||0,p=isNaN(s)?o.interactions.length:s;n.type=r;var g=function(){};n.originalEvent=new jQuery.Event(h.event,{preventDefault:g,stopPropagation:g,stopImmediatePropagation:g}),o.results=[];do{if(c=o.interactions[f]){if("dragend"!==r&&c.cancelled)continue;u=i.properties(n,o,c),c.results=[],t(a||c[d]||o.droppable).each((function(s,a){if(u.target=a,n.isPropagationStopped=function(){return!1},!1===(l=a?e.dispatch.call(a,n,u):null)?("drag"==d&&(c.cancelled=!0,o.propagates-=1),"drop"==r&&(c[d][s]=null)):"dropinit"==r&&c.droppable.push(i.element(l)||a),"dragstart"==r&&(c.proxy=t(i.element(l)||c.drag)[0]),c.results.push(l),delete n.result,"dropinit"!==r)return l})),o.results[f]=i.flatten(c.results),"dropinit"==r&&(c.droppable=i.flatten(c.droppable)),"dragstart"!=r||c.cancelled||u.update()}}while(++f<p);return n.type=h.type,n.originalEvent=h.event,i.flatten(o.results)}},properties:function(t,e,n){var r=n.callback;return r.drag=n.drag,r.proxy=n.proxy||n.drag,r.startX=e.pageX,r.startY=e.pageY,r.deltaX=t.pageX-e.pageX,r.deltaY=t.pageY-e.pageY,r.originalX=n.offset.left,r.originalY=n.offset.top,r.offsetX=r.originalX+r.deltaX,r.offsetY=r.originalY+r.deltaY,r.drop=i.flatten((n.drop||[]).slice()),r.available=i.flatten((n.droppable||[]).slice()),r},element:function(t){if(t&&(t.jquery||1==t.nodeType))return t},flatten:function(e){return t.map(e,(function(e){return e&&e.jquery?t.makeArray(e):e&&e.length?i.flatten(e):e}))},textselect:function(e){t(document)[e?"off":"on"]("selectstart",i.dontstart).css("MozUserSelect",e?"":"none"),document.unselectable=e?"off":"on"},dontstart:function(){return!1},callback:function(){}};i.callback.prototype={update:function(){n.drop&&this.available.length&&t.each(this.available,(function(t){n.drop.locate(this,t)}))}};var r=e.dispatch;e.dispatch=function(e){if(!(t.data(this,"suppress."+e.type)-(new Date).getTime()>0))return r.apply(this,arguments);t.removeData(this,"suppress."+e.type)},n.draginit=n.dragstart=n.dragend=i}(jquery__WEBPACK_IMPORTED_MODULE_1___default())},7636:(t,e,n)=>{"use strict";n.d(e,{Ee:()=>c,JW:()=>l,kE:()=>u});var i=n(4538),r=n(3838),o=n(1031),s=n(4752),a=n(8503);function l(t,e={}){const n=t.ticks(e.ticks||4);return c(n.map((e=>t(e))),n,e)}function c(t,e,n={}){const o=t.length,s=n.type||"color",a="circle"===s?20:12,l=o*a+2*(o+2),c=(0,i.ut)("div",{styles:{width:"120px",height:(l>215?215:l)+35+"px",position:"absolute",border:"0.5px solid black"},classes:["legend-container"]});(0,i.ut)("div",{styles:{height:"20px",whiteSpace:"nowrap"},classes:["legend-title"],text:n.label},c);const u=(0,i.ut)("div",{styles:{overflowY:"auto",overflowX:"hidden",height:"calc(100% - 10px)",width:"100%"},classes:["legend-body"]},c),h=(0,i.dl)("svg",{height:l,width:180,styles:{position:"relative"}},u),d=(0,i.dl)("g",{},h),f="color"===s?14:"line"===s?20:30;for(let n=0;n<o;n++){"color"===s?(0,i.dl)("rect",{y:2*(n+1)+n*a,x:2,height:"10",width:"10",styles:{fill:t[n]}},d):"line"===s?(0,i.dl)("rect",{y:2*(n+1)+n*a,x:2,height:"10",width:t[n],styles:{fill:"gray"}},d):"circle"===s&&(0,i.dl)("circle",{cy:2*(n+1)+n*a+4,cx:15,r:t[n],styles:{fill:"gray"}},d);const o=(0,i.dl)("text",{y:2*(n+1)+n*a+6+3,x:f,"alignment-baseline":"center",styles:{"font-size":"12px",fill:"currentcolor"},text:""===e[n]?"none":e[n]},d);(0,r.Z)(o).style("fill","currentcolor")}return(0,i.$q)(c,{handle:".legend-body"}),(0,i.n2)(c),c}function u(t,e={}){const n=e,l=t.length,c=t.map(((t,e)=>[Math.floor(e/l*100)+"%",t])),u=n.width||120,h=n.height||45,d=(0,i.dl)("svg",{height:h,width:u,styles:{position:"relative"}}),f=(0,r.Z)(d).append("g"),p=(0,a.zO)();n.label&&f.append("text").text(n.label).attr("x",10).style("fill","currentColor").attr("alignment-baseline","hanging").style("font-size","12px");const g=f.append("defs").append("linearGradient").attr("id",p).attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","0%").attr("spreadMethod","pad");let m=h;if(n.label&&(m-=10),n.range&&(m-=25),f.append("rect").attr("x",n.range?10:0).attr("y",n.label?10:0).attr("width",n.range?u-20:20).attr("height",m).style("fill",`url(#${p})`),c.forEach((t=>{g.append("stop").attr("offset",t[0]).attr("stop-color",t[1]).attr("stop-opacity",1)})),n.range){const t=(0,o.Z)().domain([n.range[0],n.range[1]]).range([0,u-20]),e=(0,s.LL)(t).tickFormat(((t,e)=>t>=1e4?Number.parseFloat(t).toPrecision(2):t)).ticks(Math.ceil(u/20));f.append("g").call(e).attr("transform",`translate(10,${h-25})`).selectAll("text").style("text-anchor","end").attr("dx","-.4em").attr("dy",".4em").attr("transform","rotate(-45)")}const _=(0,i.ut)("div",{height:h,width:u,styles:{position:"absolute"},classes:["legend-container"]});return _.append(d),(0,i.$q)(_),_}},3740:(t,e,n)=>{"use strict";n.d(e,{v:()=>r});var i=n(4538);class r{constructor(t={},e){t.doc=t.doc||document,this.config=t,this.buttons={};const n=t.width?t.width+"px":"",r=t.height?t.height+"px":"";if(this.outer=(0,i.ut)("div",{classes:["ciview-dlg-outer"],styles:{width:n,height:r}}),this.header=(0,i.ut)("div",{classes:["ciview-dlg-header"]},this.outer),(0,i.ut)("span",{classes:["ciview-dlg-header-text"],text:t.title},this.header),(0,i.ut)("i",{classes:["fas","fa-times","ciview-dlg-close-icon"]},this.header).addEventListener("click",(()=>{this.close()})),this.dialog=(0,i.ut)("div",{classes:["ciview-dlg-content"]},this.outer),(0,i.n2)(this.outer,{onresizeend:(t,e)=>{this.onResize(t,e)}}),(0,i.$q)(this.outer,{doc:t.doc,handle:".ciview-dlg-header"}),t.columns&&this._createColumns(t.columns),t.footer&&this._addFooter(),t.buttons){this.footer||this._addFooter();for(let e of t.buttons)this._addButton(e)}this.init(e),t.doc.body.append(this.outer);const o=t.doc.body.getBoundingClientRect(),s=this.outer.getBoundingClientRect();t.maxHeight&&s.height>t.maxHeight&&(s.height=t.maxHeight,this.outer.style.height=t.maxHeight+"px");let a=this.config.position;if(a||(a=[o.width/2-s.width/2,o.height/2-s.height/2]),a[0]+s.width>o.width){let t=o.width-s.width;a[0]=t<0?0:t}if(a[1]+s.height>o.height){let t=o.height-s.height;a[1]=t<0?0:t}this.outer.style.left=a[0]+"px",this.outer.style.top=a[1]+"px"}_addFooter(){this.footer=(0,i.ut)("div",{styles:{flex:"0 0 auto",padding:"5px",justifyContent:"center",display:"flex",gap:"1em"}},this.outer)}_addButton(t){const e=(0,i.ut)("button",{text:t.text,classes:["ciview-button"]},this.footer);e.addEventListener("click",(()=>this[t.method]())),t.id&&(this.buttons[t.id]=e)}disableButton(t,e){e?this.buttons[t].classList.add("ciview-disabled"):this.buttons[t].classList.remove("ciview-disabled")}_createColumns(t){this.dialog.style.display="flex",this.dialog.style.flexDirection="row",this.columns=[];for(let e=0;e<t;e++)this.columns.push((0,i.ut)("div",{styles:{height:"100%",flexBasis:"0",flexGrow:"1",padding:"0px 4px",flexDirection:"column",alignItems:"stretch"}},this.dialog))}close(){this.config.onclose&&this.config.onclose(),this.outer.remove()}init(){}onResize(t,e){}}r.experiment={}},4538:(t,e,n)=>{"use strict";n.d(e,{Vq:()=>A,VU:()=>w,ut:()=>_,t1:()=>x,Eo:()=>y,dl:()=>v,qT:()=>M,$q:()=>T,n2:()=>k,Ng:()=>C,EA:()=>S,P_:()=>E,Ni:()=>b});var i="undefined"!=typeof window?window:null,r=null===i,o=r?void 0:i.document,s="horizontal",a=function(){return!1},l=r?"calc":["","-webkit-","-moz-","-o-"].filter((function(t){var e=o.createElement("div");return e.style.cssText="width:"+t+"calc(9px)",!!e.style.length})).shift()+"calc",c=function(t){return"string"==typeof t||t instanceof String},u=function(t){if(c(t)){var e=o.querySelector(t);if(!e)throw new Error("Selector "+t+" did not match a DOM element");return e}return t},h=function(t,e,n){var i=t[e];return void 0!==i?i:n},d=function(t,e,n,i){if(e){if("end"===i)return 0;if("center"===i)return t/2}else if(n){if("start"===i)return 0;if("center"===i)return t/2}return t},f=function(t,e){var n=o.createElement("div");return n.className="gutter gutter-"+e,n},p=function(t,e,n){var i={};return c(e)?i[t]=e:i[t]=l+"("+e+"% - "+n+"px)",i},g=function(t,e){var n;return(n={})[t]=e+"px",n};const m=function(t,e){if(void 0===e&&(e={}),r)return{};var n,l,c,m,_,v,b=t;Array.from&&(b=Array.from(b));var y=u(b[0]).parentNode,w=getComputedStyle?getComputedStyle(y):null,x=w?w.flexDirection:null,C=h(e,"sizes")||b.map((function(){return 100/b.length})),k=h(e,"minSize",100),E=Array.isArray(k)?k:b.map((function(){return k})),S=h(e,"maxSize",1/0),A=Array.isArray(S)?S:b.map((function(){return S})),T=h(e,"expandToMin",!1),M=h(e,"gutterSize",10),D=h(e,"gutterAlign","center"),P=h(e,"snapOffset",30),L=Array.isArray(P)?P:b.map((function(){return P})),R=h(e,"dragInterval",1),I=h(e,"direction",s),O=h(e,"cursor",I===s?"col-resize":"row-resize"),z=h(e,"gutter",f),F=h(e,"elementStyle",p),B=h(e,"gutterStyle",g);function N(t,e,i,r){var o=F(n,e,i,r);Object.keys(o).forEach((function(e){t.style[e]=o[e]}))}function j(){return v.map((function(t){return t.size}))}function U(t){return"touches"in t?t.touches[0][l]:t[l]}function V(t){var e=v[this.a],n=v[this.b],i=e.size+n.size;e.size=t/this.size*i,n.size=i-t/this.size*i,N(e.element,e.size,this._b,e.i),N(n.element,n.size,this._c,n.i)}function W(t){var n,i=v[this.a],r=v[this.b];this.dragging&&(n=U(t)-this.start+(this._b-this.dragOffset),R>1&&(n=Math.round(n/R)*R),n<=i.minSize+i.snapOffset+this._b?n=i.minSize+this._b:n>=this.size-(r.minSize+r.snapOffset+this._c)&&(n=this.size-(r.minSize+this._c)),n>=i.maxSize-i.snapOffset+this._b?n=i.maxSize+this._b:n<=this.size-(r.maxSize-r.snapOffset+this._c)&&(n=this.size-(r.maxSize+this._c)),V.call(this,n),h(e,"onDrag",a)(j()))}function H(){var t=v[this.a].element,e=v[this.b].element,i=t.getBoundingClientRect(),r=e.getBoundingClientRect();this.size=i[n]+r[n]+this._b+this._c,this.start=i[c],this.end=i[m]}function $(t){var e=function(t){if(!getComputedStyle)return null;var e=getComputedStyle(t);if(!e)return null;var n=t[_];return 0===n?null:n-=I===s?parseFloat(e.paddingLeft)+parseFloat(e.paddingRight):parseFloat(e.paddingTop)+parseFloat(e.paddingBottom)}(y);if(null===e)return t;if(E.reduce((function(t,e){return t+e}),0)>e)return t;var n=0,i=[],r=t.map((function(r,o){var s=e*r/100,a=d(M,0===o,o===t.length-1,D),l=E[o]+a;return s<l?(n+=l-s,i.push(0),l):(i.push(s-l),s)}));return 0===n?t:r.map((function(t,r){var o=t;if(n>0&&i[r]-n>0){var s=Math.min(n,i[r]-n);n-=s,o=t-s}return o/e*100}))}function Z(){var t=this,n=v[t.a].element,r=v[t.b].element;t.dragging&&h(e,"onDragEnd",a)(j()),t.dragging=!1,i.removeEventListener("mouseup",t.stop),i.removeEventListener("touchend",t.stop),i.removeEventListener("touchcancel",t.stop),i.removeEventListener("mousemove",t.move),i.removeEventListener("touchmove",t.move),t.stop=null,t.move=null,n.removeEventListener("selectstart",a),n.removeEventListener("dragstart",a),r.removeEventListener("selectstart",a),r.removeEventListener("dragstart",a),n.style.userSelect="",n.style.webkitUserSelect="",n.style.MozUserSelect="",n.style.pointerEvents="",r.style.userSelect="",r.style.webkitUserSelect="",r.style.MozUserSelect="",r.style.pointerEvents="",t.gutter.style.cursor="",t.parent.style.cursor="",o.body.style.cursor=""}function q(t){if(!("button"in t)||0===t.button){var n=this,r=v[n.a].element,s=v[n.b].element;n.dragging||h(e,"onDragStart",a)(j()),t.preventDefault(),n.dragging=!0,n.move=W.bind(n),n.stop=Z.bind(n),i.addEventListener("mouseup",n.stop),i.addEventListener("touchend",n.stop),i.addEventListener("touchcancel",n.stop),i.addEventListener("mousemove",n.move),i.addEventListener("touchmove",n.move),r.addEventListener("selectstart",a),r.addEventListener("dragstart",a),s.addEventListener("selectstart",a),s.addEventListener("dragstart",a),r.style.userSelect="none",r.style.webkitUserSelect="none",r.style.MozUserSelect="none",r.style.pointerEvents="none",s.style.userSelect="none",s.style.webkitUserSelect="none",s.style.MozUserSelect="none",s.style.pointerEvents="none",n.gutter.style.cursor=O,n.parent.style.cursor=O,o.body.style.cursor=O,H.call(n),n.dragOffset=U(t)-n.end}}I===s?(n="width",l="clientX",c="left",m="right",_="clientWidth"):"vertical"===I&&(n="height",l="clientY",c="top",m="bottom",_="clientHeight"),C=$(C);var G=[];function K(t){var e=t.i===G.length,n=e?G[t.i-1]:G[t.i];H.call(n);var i=e?n.size-t.minSize-n._c:t.minSize+n._b;V.call(n,i)}return(v=b.map((function(t,e){var i,r={element:u(t),size:C[e],minSize:E[e],maxSize:A[e],snapOffset:L[e],i:e};if(e>0&&((i={a:e-1,b:e,dragging:!1,direction:I,parent:y})._b=d(M,e-1==0,!1,D),i._c=d(M,!1,e===b.length-1,D),"row-reverse"===x||"column-reverse"===x)){var o=i.a;i.a=i.b,i.b=o}if(e>0){var s=z(e,I,r.element);!function(t,e,i){var r=B(n,e,i);Object.keys(r).forEach((function(e){t.style[e]=r[e]}))}(s,M,e),i._a=q.bind(i),s.addEventListener("mousedown",i._a),s.addEventListener("touchstart",i._a),y.insertBefore(s,r.element),i.gutter=s}return N(r.element,r.size,d(M,0===e,e===b.length-1,D),e),e>0&&G.push(i),r}))).forEach((function(t){var e=t.element.getBoundingClientRect()[n];e<t.minSize&&(T?K(t):t.minSize=e)})),{setSizes:function(t){var e=$(t);e.forEach((function(t,n){if(n>0){var i=G[n-1],r=v[i.a],o=v[i.b];r.size=e[n-1],o.size=t,N(r.element,r.size,i._b,r.i),N(o.element,o.size,i._c,o.i)}}))},getSizes:j,collapse:function(t){K(v[t])},destroy:function(t,e){G.forEach((function(i){if(!0!==e?i.parent.removeChild(i.gutter):(i.gutter.removeEventListener("mousedown",i._a),i.gutter.removeEventListener("touchstart",i._a)),!0!==t){var r=F(n,i.a.size,i._b);Object.keys(r).forEach((function(t){v[i.a].element.style[t]="",v[i.b].element.style[t]=""}))}}))},parent:y,pairs:G}};function _(t,e,n){const i=document.createElement(t);return e&&w(i,e),n&&n.append(i),i}function v(t,e,n){const i=document.createElementNS("http://www.w3.org/2000/svg",t);if(e)for(var r in e)if("styles"!==r&&"style"!==r||"object"!=typeof e[r])if("text"===r)i.textContent=e[r];else if("classes"===r)for(var o of e[r])i.classList.add(o);else i.setAttributeNS(null,r,e[r]);else for(var s in e[r])i.style[s]=e[r][s];return n&&n.append(i),i}function b(t,e={}){const n=e.direction||"horizontal",i=e.number||2,r=[],o="horizontal"===n?["split-horizontal"]:["split-vertical"];for(let e=0;e<i;e++)r.push(_("div",{classes:o},t));return m(r,{direction:n,gutterSize:5,cursor:"pointer",sizes:e.sizes,onDragEnd:()=>window.dispatchEvent(new Event("resize"))}),r}function y(t,e,n){const i={role:"tooltip"},r=e.tooltip;r&&Object.assign(i,{"aria-label":r.text,"data-microtip-size":r.size||"small","data-microtip-position":r.position||"bottom-left"});const o=_("span",i);return _("i",{classes:["ciview-menu-icon"].concat(t.split(" ")),styles:{fontSize:e.size||"18px"}},o),e.func&&o.addEventListener("click",(t=>e.func(t))),n&&n.append(o),o}function w(t,e){for(var n in e)if("styles"!==n&&"style"!==n||"object"!=typeof e[n])if("text"===n)t.textContent=e[n];else if("classes"===n)for(var i of e[n])t.classList.add(i);else t.setAttribute(n,e[n]);else for(var r in e[n])t.style[r]=e[n][r]}function x(t,e){const n=_("input",{placeholder:"Filter",type:"text",styles:{width:"4em",margin:"0.2em"}},e);return n.oninput=e=>{const n=e.target.value.toLowerCase();for(let e of t.options)-1===e.text.toLowerCase().indexOf(n)?e.style.display="none":e.style.display="block"},n}function C(t,e={}){let n=null,i=!1;function r(t){return this.after(n),t.preventDefault(),!1}function o(r){i=!1,n.classList.remove("mdv-element-dragged"),e.sortEnded&&e.sortEnded(Array.from(t.children).slice(1))}function s(t){i=!e.handle||!!t.target.classList.contains(e.handle)}function a(t){if(!i)return t.preventDefault(),!1;n=this,this.classList.add("mdv-element-dragged"),t.dataTransfer.setDragImage(_("div",{}),0,0)}let l=_("div",{styles:{height:"5px"}});t.prepend(l),l.addEventListener("dragover",r);for(let e=0;e<t.children.length;e++){const n=t.children[e];n.draggable=!0,n.addEventListener("dragover",r),n.addEventListener("dragstart",a),n.addEventListener("dragend",o),n.addEventListener("pointerdown",s)}}function k(t,e={}){if(t.__resizeinfo__)return;const n={resize:t.style.resize,overflow:t.style.overflow};function i(e){t.style.width=n.startWidth+e.clientX-n.startX+"px",t.style.height=n.startHeight+e.clientY-n.startY+"px"}function r(t){document.documentElement.removeEventListener("pointermove",i,!1),document.documentElement.removeEventListener("pointerup",r,!1)}t.style.overflow="hidden",e.onresizeend&&(n.onresize=function(t,n,i){let r=t.getBoundingClientRect(),o=r.width,s=r.height;const a=n=>{let i=t.getBoundingClientRect();var r,a;i.width===o&&i.height===s||(r=i.width,a=i.height,e.onresizeend(r,a)),o=i.width,s=i.height};return i&&t.addEventListener("pointerdown",i),t.addEventListener("pointerup",a),a}(t,0,e.onResizeStart)),_("div",{classes:["resizer-both"]},t).addEventListener("pointerdown",(function(e){n.startX=e.clientX,n.startY=e.clientY,n.startWidth=parseInt(document.defaultView.getComputedStyle(t).width,10),n.startHeight=parseInt(document.defaultView.getComputedStyle(t).height,10),document.documentElement.addEventListener("pointermove",i,!1),document.documentElement.addEventListener("pointerup",r,!1)}),!1),t.__resizeinfo__=n}function E(t){if(!t.__resizeinfo__)return;const e=t.__resizeinfo__;t.style.resize=e.resize,t.style.overflow=e.overflow,e.onresize&&t.removeEventListener("pointerup",e.onresize),delete t.__resizeinfo__}function S(t){const e=t.__draginfo__;e&&(e.handle.style.cursor=e.cursor,t.style.position=e.position,e.handle.onmousedown=null,delete t.__draginfo__)}class A{constructor(t,e){this.el=t,this.max=e.max||100,t.classList.add("mdv-progress-outer"),this.bar=_("div",{classes:["mdv-progress-inner"]},t),this.text=_("div",{classes:["mdv-progress-text"]},t),this.setText(e.text||""),this.setValue(e.value||0)}setText(t){this.text.textContent=t}setValue(t){this.bar.style.width=`${Math.round(t/this.max*100)}%`}}function T(t,e={}){e.doc||(e.doc=document);let n=0,i=0,r=0,o=0,s=e.handle?t.querySelector(e.handle):t,a=null;function l(s){(s=s||window.event).preventDefault(),s.stopPropagation(),n=r-s.clientX,i=o-s.clientY,r=s.clientX,o=s.clientY;let l=t.offsetTop-i,c=t.offsetLeft-n;if(a){if(l<0||l+a.c_bb.height>a.p_bb.height&&"topleft"!==a.dir)return;if(c<0||c+a.c_bb.width>a.p_bb.width&&"topleft"!==a.dir)return}e.y_axis||(t.style.top=l+"px"),t.style.left=c+"px"}function c(){e.ondragend&&e.ondragend(),t.__doc__.onmouseup=null,t.__doc__.onmousemove=null}e.contain&&(a={dir:e.contain}),s.onmousedown=function(n){(n=n||window.event).preventDefault(),r=n.clientX,o=n.clientY,e.ondragstart&&e.ondragstart(t),a&&(a.p_bb=t.parentElement.getBoundingClientRect(),a.c_bb=t.getBoundingClientRect()),t.__doc__.onmouseup=c,t.__doc__.onmousemove=l},t.__draginfo__={handle:s,cursor:s.style.cursor,position:t.style.position},s.style.cursor="move",t.style.position="absolute",t.style.margin="0px 0px 0px 0px",t.__doc__=e.doc}function M(t){var e=t.getBoundingClientRect(),n=window.pageXOffset||document.documentElement.scrollLeft,i=window.pageYOffset||document.documentElement.scrollTop;return{top:e.top+i,left:e.left+n,height:e.height,width:e.width}}},5618:(t,e,n)=>{"use strict";n.d(e,{Z:()=>l});var i=n(3740),r=n(4538),o=n(4211),s=n.n(o);class a extends i.v{constructor(t,e){super(t,e)}init(t){this.controls=[];for(let e of t){let t=(0,r.ut)("div",{styles:{}},this.dialog);"button"!==e.type&&(0,r.ut)("label",{text:e.label},t),e.info&&this.addInfoIcon(e.info,t),this[e.type]?this.controls[e.label]=this[e.type](e,t):console.warn(`SettingsDialog doesn't have a method '${e.type}'`)}}initLilGui(t){const e=new lgui({container:this.dialog});for(let n of t)switch(n.type){case"dropdown":e.add(n,"current_value",n.values[0].map((t=>t[n.values[1]]))).name(n.label).onChange(n.func);break;case"check":void 0===n.current_value&&(n.current_value=!1),e.add(n,"current_value").name(n.label).onChange(n.func);break;case"button":e.add(n,"func").name(n.label);break;case"slider":case"spinner":e.add(n,"current_value",n.min,n.max).name(n.label).onChange(n.func);break;case"radiobuttons":e.add(n,"current_value",n.choices).name(n.label).onChange(n.func);break;default:e.add(n,"current_value").name(n.label).onChange(n.func)}}folder(t,e){}spinner(t,e){let n=(0,r.ut)("input",{type:"number",value:t.current_value,max:t.max||null,min:t.min||0,step:t.step||1},e);n.addEventListener("change",(e=>{t.func(parseInt(n.value))}))}radiobuttons(t,e){const n=(0,r.ut)("div",{classes:["ciview-radio-group"]},e);for(let e of t.choices){(0,r.ut)("span",{text:e[0]},n);const i=(0,r.ut)("input",{type:"radio",name:t.label,value:e[1]},n);i.checked=t.current_value===e[1],i.addEventListener("click",(e=>{t.func(e.currentTarget.value)}))}}button(t,e){e.style.textAlign="center",(0,r.ut)("button",{classes:["ciview-button"],text:t.label},e).addEventListener("click",(e=>{t.func()}))}slider(t,e){const n=(0,r.ut)("div",{},e);s().create(n,{start:[t.current_value||0],range:{min:[t.min||0],max:[t.max||1]},step:t.step||null,tooltips:!0,documentElement:t.doc||this.config.doc});const i=e=>{t.func(parseFloat(e[0]))};return n.noUiSlider.on("end",i),t.continuous&&(console.log("adding update listener for ",t.label),n.noUiSlider.on("update",i)),n}check(t,e){const n=(0,r.ut)("input",{type:"checkbox"},e);n.checked=t.current_value,n.addEventListener("click",(e=>{t.func(n.checked)}))}multidropdown(t,e){const n=(0,r.ut)("div"),i=(0,r.ut)("select",{multiple:!0,styles:{maxWidth:"200px",height:"100px"}},n);(0,r.ut)("br",{},e);for(let e of t.values[0]){const n=e[t.values[2]],o={text:e[t.values[1]],value:n};-1!==t.current_value.indexOf(n)&&(o.selected=!0),(0,r.ut)("option",o,i)}return(0,r.ut)("br",{},e),(0,r.ut)("button",{classes:["ciview-button-sm"],text:"Change"},e).addEventListener("click",(e=>{t.func(Array.from(i.selectedOptions).map((t=>t.value)))})),(0,r.t1)(i,n),e.append(n),i}dropdown(t,e){const n=(0,r.ut)("div"),i=(0,r.ut)("select",{styles:{maxWidth:"200px"}},n);for(let e of t.values[0])(0,r.ut)("option",{text:e[t.values[1]],value:e[t.values[2]]},i);return i.value=t.current_value,i.addEventListener("change",(e=>{t.func(i.value,this.controls),i.title=i.value,t.onchange&&t.onchange(this.controls,i.value)})),(0,r.t1)(i,n),e.append(n),n}doubleslider(t,e){const n=(0,r.ut)("div",{styles:{}},e);s().create(n,{tooltips:!0,start:[t.current_value[0],t.current_value[1]],range:{min:[t.min],max:[t.max]},documentElement:t.doc});const i=e=>{t.func(parseFloat(e[0]),parseFloat(e[1]))};return n.noUiSlider.on("end",i),t.continuous&&n.noUiSlider.on("update",i),n}text(t,e){const n=(0,r.ut)("input",{value:t.current_value,size:10,styles:{flex:1}},e);n.addEventListener("keyup",(e=>{t.only_update_on_enter?"Enter"===e.key&&t.func(n.value):t.func(n.value)}))}textbox(t,e){const n=(0,r.ut)("textarea",{styles:{width:"100%"}},e);n.value=t.current_value,n.addEventListener("input",(e=>{t.func(n.value)})),n.addEventListener("blur",(e=>{t.func(n.value)}))}addInfoIcon(t,e){const n=(0,r.ut)("span",{"aria-label":t.text,role:"tooltip","data-microtip-size":"medium","data-microtip-position":t.position,styles:{marginLeft:"5px"},classes:["ttt"]},e);return(0,r.ut)("i",{classes:["fas","fa-info"]},n),n}}const l=a},8503:(t,e,n)=>{"use strict";function i(t=6,e){t||(t=6);let n="",i=0,r="a"==(e=e&&e.toLowerCase())?10:0,o="n"==e?10:62;for(;i++<t;){let t=Math.random()*(o-r)+r<<0;n+=String.fromCharCode(t+=t>9?t<36?55:61:48)}return n}function r(t,e){let n;return(...i)=>{clearTimeout(n),n=setTimeout((()=>{t.apply(this,i)}),e)}}n.d(e,{Ds:()=>r,zO:()=>i})},9855:t=>{"use strict";t.exports="data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 16 16%27%3e%3cpath fill=%27none%27 stroke=%27dimgray%27 stroke-linecap=%27round%27 stroke-linejoin=%27round%27 stroke-width=%272%27 d=%27M2 5l6 6 6-6%27/%3e%3c/svg%3e"},2810:t=>{"use strict";t.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/Pgo8IS0tIEdlbmVyYXRvcjogQWRvYmUgSWxsdXN0cmF0b3IgMTYuMC4wLCBTVkcgRXhwb3J0IFBsdWctSW4gLiBTVkcgVmVyc2lvbjogNi4wMCBCdWlsZCAwKSAgLS0+CjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+CjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiBpZD0iQ2FwYV8xIiB4PSIwcHgiIHk9IjBweCIgd2lkdGg9IjE2cHgiIGhlaWdodD0iMTZweCIgdmlld0JveD0iMCAwIDUxMS42MjYgNTExLjYyNyIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgNTExLjYyNiA1MTEuNjI3OyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+CjxnPgoJPHBhdGggZD0iTTMyOC45MDYsNDAxLjk5NGgtMzYuNTUzVjEwOS42MzZoMzYuNTUzYzQuOTQ4LDAsOS4yMzYtMS44MDksMTIuODQ3LTUuNDI2YzMuNjEzLTMuNjE1LDUuNDIxLTcuODk4LDUuNDIxLTEyLjg0NSAgIGMwLTQuOTQ5LTEuODAxLTkuMjMxLTUuNDI4LTEyLjg1MWwtNzMuMDg3LTczLjA5QzI2NS4wNDQsMS44MDksMjYwLjc2LDAsMjU1LjgxMywwYy00Ljk0OCwwLTkuMjI5LDEuODA5LTEyLjg0Nyw1LjQyNCAgIGwtNzMuMDg4LDczLjA5Yy0zLjYxOCwzLjYxOS01LjQyNCw3LjkwMi01LjQyNCwxMi44NTFjMCw0Ljk0NiwxLjgwNyw5LjIyOSw1LjQyNCwxMi44NDVjMy42MTksMy42MTcsNy45MDEsNS40MjYsMTIuODUsNS40MjYgICBoMzYuNTQ1djI5Mi4zNThoLTM2LjU0MmMtNC45NTIsMC05LjIzNSwxLjgwOC0xMi44NSw1LjQyMWMtMy42MTcsMy42MjEtNS40MjQsNy45MDUtNS40MjQsMTIuODU0ICAgYzAsNC45NDUsMS44MDcsOS4yMjcsNS40MjQsMTIuODQ3bDczLjA4OSw3My4wODhjMy42MTcsMy42MTcsNy44OTgsNS40MjQsMTIuODQ3LDUuNDI0YzQuOTUsMCw5LjIzNC0xLjgwNywxMi44NDktNS40MjQgICBsNzMuMDg3LTczLjA4OGMzLjYxMy0zLjYyLDUuNDIxLTcuOTAxLDUuNDIxLTEyLjg0N2MwLTQuOTQ4LTEuODA4LTkuMjMyLTUuNDIxLTEyLjg1NCAgIEMzMzguMTQyLDQwMy44MDIsMzMzLjg1Nyw0MDEuOTk0LDMyOC45MDYsNDAxLjk5NHoiIGZpbGw9IiM2NjY2NjYiLz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8L3N2Zz4K"},8260:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2212px%22%20height%3D%2236px%22%3E%3Cpath%20fill%3D%22rgba%2817,%2017,%2017,%200.9%29%22%20transform%3D%22rotate%28-90%2018%2018%29%22%20d%3D%22M2.658,0.000%20C-13.615,0.000%2050.938,0.000%2034.662,0.000%20C28.662,0.000%2023.035,12.002%2018.660,12.002%20C14.285,12.002%208.594,0.000%202.658,0.000%20Z%22/%3E%3C/svg%3E"},8261:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2212px%22%20height%3D%2236px%22%3E%3Cpath%20fill%3D%22rgba%2817,%2017,%2017,%200.9%29%22%20transform%3D%22rotate%2890%206%206%29%22%20d%3D%22M2.658,0.000%20C-13.615,0.000%2050.938,0.000%2034.662,0.000%20C28.662,0.000%2023.035,12.002%2018.660,12.002%20C14.285,12.002%208.594,0.000%202.658,0.000%20Z%22/%3E%3C/svg%3E"},9854:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2236px%22%20height%3D%2212px%22%3E%3Cpath%20fill%3D%22rgba%2817,%2017,%2017,%200.9%29%22%20transform%3D%22rotate%280%29%22%20d%3D%22M2.658,0.000%20C-13.615,0.000%2050.938,0.000%2034.662,0.000%20C28.662,0.000%2023.035,12.002%2018.660,12.002%20C14.285,12.002%208.594,0.000%202.658,0.000%20Z%22/%3E%3C/svg%3E"},1627:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2236px%22%20height%3D%2212px%22%3E%3Cpath%20fill%3D%22rgba%2817,%2017,%2017,%200.9%29%22%20transform%3D%22rotate%28180%2018%206%29%22%20d%3D%22M2.658,0.000%20C-13.615,0.000%2050.938,0.000%2034.662,0.000%20C28.662,0.000%2023.035,12.002%2018.660,12.002%20C14.285,12.002%208.594,0.000%202.658,0.000%20Z%22/%3E%3C/svg%3E"},5258:t=>{"use strict";t.exports="static/img/../img/fa-brands-400.eot"},197:t=>{"use strict";t.exports="static/img/../img/fa-brands-400.svg"},9710:t=>{"use strict";t.exports="static/img/../img/fa-brands-400.ttf"},1293:t=>{"use strict";t.exports="static/img/../img/fa-brands-400.woff"},8073:t=>{"use strict";t.exports="static/img/../img/fa-brands-400.woff2"},848:t=>{"use strict";t.exports="static/img/../img/fa-regular-400.eot"},7094:t=>{"use strict";t.exports="static/img/../img/fa-regular-400.svg"},5860:t=>{"use strict";t.exports="static/img/../img/fa-regular-400.ttf"},4821:t=>{"use strict";t.exports="static/img/../img/fa-regular-400.woff"},6859:t=>{"use strict";t.exports="static/img/../img/fa-regular-400.woff2"},6203:t=>{"use strict";t.exports="static/img/../img/fa-solid-900.eot"},8498:t=>{"use strict";t.exports="static/img/../img/fa-solid-900.svg"},142:t=>{"use strict";t.exports="static/img/../img/fa-solid-900.ttf"},1029:t=>{"use strict";t.exports="static/img/../img/fa-solid-900.woff"},8681:t=>{"use strict";t.exports="static/img/../img/fa-solid-900.woff2"},6710:t=>{"use strict";t.exports="static/img/../img/GrpCheckboxN.png"},1679:t=>{"use strict";t.exports="static/img/../img/GrpCheckboxY.png"},996:t=>{"use strict";t.exports="static/img/../img/collapse.gif"},9513:t=>{"use strict";t.exports="static/img/../img/expand.gif"},8712:t=>{"use strict";t.exports="static/img/../img/header-columns-bg.gif"},6908:t=>{"use strict";t.exports="static/img/../img/header-columns-over-bg.gif"},6912:t=>{"use strict";t.exports="static/img/../img/sort-asc.gif"},4413:t=>{"use strict";t.exports="static/img/../img/sort-desc.gif"},479:()=>{},2249:()=>{},4942:(t,e,n)=>{"use strict";function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}n.d(e,{Z:()=>i})},4752:(t,e,n)=>{"use strict";function i(t){return t}n.d(e,{LL:()=>h,y4:()=>d});var r=1e-6;function o(t){return"translate("+t+",0)"}function s(t){return"translate(0,"+t+")"}function a(t){return e=>+t(e)}function l(t,e){return e=Math.max(0,t.bandwidth()-2*e)/2,t.round()&&(e=Math.round(e)),n=>+t(n)+e}function c(){return!this.__axis}function u(t,e){var n=[],u=null,h=null,d=6,f=6,p=3,g="undefined"!=typeof window&&window.devicePixelRatio>1?0:.5,m=1===t||4===t?-1:1,_=4===t||2===t?"x":"y",v=1===t||3===t?o:s;function b(o){var s=null==u?e.ticks?e.ticks.apply(e,n):e.domain():u,b=null==h?e.tickFormat?e.tickFormat.apply(e,n):i:h,y=Math.max(d,0)+p,w=e.range(),x=+w[0]+g,C=+w[w.length-1]+g,k=(e.bandwidth?l:a)(e.copy(),g),E=o.selection?o.selection():o,S=E.selectAll(".domain").data([null]),A=E.selectAll(".tick").data(s,e).order(),T=A.exit(),M=A.enter().append("g").attr("class","tick"),D=A.select("line"),P=A.select("text");S=S.merge(S.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),A=A.merge(M),D=D.merge(M.append("line").attr("stroke","currentColor").attr(_+"2",m*d)),P=P.merge(M.append("text").attr("fill","currentColor").attr(_,m*y).attr("dy",1===t?"0em":3===t?"0.71em":"0.32em")),o!==E&&(S=S.transition(o),A=A.transition(o),D=D.transition(o),P=P.transition(o),T=T.transition(o).attr("opacity",r).attr("transform",(function(t){return isFinite(t=k(t))?v(t+g):this.getAttribute("transform")})),M.attr("opacity",r).attr("transform",(function(t){var e=this.parentNode.__axis;return v((e&&isFinite(e=e(t))?e:k(t))+g)}))),T.remove(),S.attr("d",4===t||2===t?f?"M"+m*f+","+x+"H"+g+"V"+C+"H"+m*f:"M"+g+","+x+"V"+C:f?"M"+x+","+m*f+"V"+g+"H"+C+"V"+m*f:"M"+x+","+g+"H"+C),A.attr("opacity",1).attr("transform",(function(t){return v(k(t)+g)})),D.attr(_+"2",m*d),P.attr(_,m*y).text(b),E.filter(c).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",2===t?"start":4===t?"end":"middle"),E.each((function(){this.__axis=k}))}return b.scale=function(t){return arguments.length?(e=t,b):e},b.ticks=function(){return n=Array.from(arguments),b},b.tickArguments=function(t){return arguments.length?(n=null==t?[]:Array.from(t),b):n.slice()},b.tickValues=function(t){return arguments.length?(u=null==t?null:Array.from(t),b):u&&u.slice()},b.tickFormat=function(t){return arguments.length?(h=t,b):h},b.tickSize=function(t){return arguments.length?(d=f=+t,b):d},b.tickSizeInner=function(t){return arguments.length?(d=+t,b):d},b.tickSizeOuter=function(t){return arguments.length?(f=+t,b):f},b.tickPadding=function(t){return arguments.length?(p=+t,b):p},b.offset=function(t){return arguments.length?(g=+t,b):g},b}function h(t){return u(3,t)}function d(t){return u(4,t)}},8849:(t,e,n)=>{"use strict";function i(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function r(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function o(){}n.d(e,{ZP:()=>w,B8:()=>E});var s=.7,a=1/s,l="\\s*([+-]?\\d+)\\s*",c="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",u="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",h=/^#([0-9a-f]{3,8})$/,d=new RegExp(`^rgb\\(${l},${l},${l}\\)$`),f=new RegExp(`^rgb\\(${u},${u},${u}\\)$`),p=new RegExp(`^rgba\\(${l},${l},${l},${c}\\)$`),g=new RegExp(`^rgba\\(${u},${u},${u},${c}\\)$`),m=new RegExp(`^hsl\\(${c},${u},${u}\\)$`),_=new RegExp(`^hsla\\(${c},${u},${u},${c}\\)$`),v={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function b(){return this.rgb().formatHex()}function y(){return this.rgb().formatRgb()}function w(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=h.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?x(e):3===n?new S(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?C(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?C(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=d.exec(t))?new S(e[1],e[2],e[3],1):(e=f.exec(t))?new S(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=p.exec(t))?C(e[1],e[2],e[3],e[4]):(e=g.exec(t))?C(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=m.exec(t))?L(e[1],e[2]/100,e[3]/100,1):(e=_.exec(t))?L(e[1],e[2]/100,e[3]/100,e[4]):v.hasOwnProperty(t)?x(v[t]):"transparent"===t?new S(NaN,NaN,NaN,0):null}function x(t){return new S(t>>16&255,t>>8&255,255&t,1)}function C(t,e,n,i){return i<=0&&(t=e=n=NaN),new S(t,e,n,i)}function k(t){return t instanceof o||(t=w(t)),t?new S((t=t.rgb()).r,t.g,t.b,t.opacity):new S}function E(t,e,n,i){return 1===arguments.length?k(t):new S(t,e,n,null==i?1:i)}function S(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}function A(){return`#${P(this.r)}${P(this.g)}${P(this.b)}`}function T(){const t=M(this.opacity);return`${1===t?"rgb(":"rgba("}${D(this.r)}, ${D(this.g)}, ${D(this.b)}${1===t?")":`, ${t})`}`}function M(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function D(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function P(t){return((t=D(t))<16?"0":"")+t.toString(16)}function L(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new I(t,e,n,i)}function R(t){if(t instanceof I)return new I(t.h,t.s,t.l,t.opacity);if(t instanceof o||(t=w(t)),!t)return new I;if(t instanceof I)return t;var e=(t=t.rgb()).r/255,n=t.g/255,i=t.b/255,r=Math.min(e,n,i),s=Math.max(e,n,i),a=NaN,l=s-r,c=(s+r)/2;return l?(a=e===s?(n-i)/l+6*(n<i):n===s?(i-e)/l+2:(e-n)/l+4,l/=c<.5?s+r:2-s-r,a*=60):l=c>0&&c<1?0:a,new I(a,l,c,t.opacity)}function I(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}function O(t){return(t=(t||0)%360)<0?t+360:t}function z(t){return Math.max(0,Math.min(1,t||0))}function F(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}i(o,w,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:b,formatHex:b,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return R(this).formatHsl()},formatRgb:y,toString:y}),i(S,E,r(o,{brighter(t){return t=null==t?a:Math.pow(a,t),new S(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?s:Math.pow(s,t),new S(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new S(D(this.r),D(this.g),D(this.b),M(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:A,formatHex:A,formatHex8:function(){return`#${P(this.r)}${P(this.g)}${P(this.b)}${P(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:T,toString:T})),i(I,(function(t,e,n,i){return 1===arguments.length?R(t):new I(t,e,n,null==i?1:i)}),r(o,{brighter(t){return t=null==t?a:Math.pow(a,t),new I(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?s:Math.pow(s,t),new I(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,r=2*n-i;return new S(F(t>=240?t-240:t+120,r,i),F(t,r,i),F(t<120?t+240:t-120,r,i),this.opacity)},clamp(){return new I(O(this.h),z(this.s),z(this.l),M(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=M(this.opacity);return`${1===t?"hsl(":"hsla("}${O(this.h)}, ${100*z(this.s)}%, ${100*z(this.l)}%${1===t?")":`, ${t})`}`}}))},2954:(t,e,n)=>{"use strict";n.d(e,{Z:()=>i});const i=t=>()=>t},8063:(t,e,n)=>{"use strict";function i(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}n.d(e,{Z:()=>i})},187:(t,e,n)=>{"use strict";n.d(e,{ZP:()=>a,hD:()=>c});var i=n(8849);function r(t,e,n,i,r){var o=t*t,s=o*t;return((1-3*t+3*o-s)*e+(4-6*o+3*s)*n+(1+3*t+3*o-3*s)*i+s*r)/6}var o=n(2954);function s(t,e){var n=e-t;return n?function(t,e){return function(n){return t+n*e}}(t,n):(0,o.Z)(isNaN(t)?e:t)}const a=function t(e){var n=function(t){return 1==(t=+t)?s:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(i){return Math.pow(t+i*e,n)}}(e,n,t):(0,o.Z)(isNaN(e)?n:e)}}(e);function r(t,e){var r=n((t=(0,i.B8)(t)).r,(e=(0,i.B8)(e)).r),o=n(t.g,e.g),a=n(t.b,e.b),l=s(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=o(e),t.b=a(e),t.opacity=l(e),t+""}}return r.gamma=t,r}(1);function l(t){return function(e){var n,r,o=e.length,s=new Array(o),a=new Array(o),l=new Array(o);for(n=0;n<o;++n)r=(0,i.B8)(e[n]),s[n]=r.r||0,a[n]=r.g||0,l[n]=r.b||0;return s=t(s),a=t(a),l=t(l),r.opacity=1,function(t){return r.r=s(t),r.g=a(t),r.b=l(t),r+""}}}var c=l((function(t){var e=t.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),o=t[i],s=t[i+1],a=i>0?t[i-1]:2*o-s,l=i<e-1?t[i+2]:2*s-o;return r((n-i/e)*e,a,o,s,l)}}));l((function(t){var e=t.length;return function(n){var i=Math.floor(((n%=1)<0?++n:n)*e),o=t[(i+e-1)%e],s=t[i%e],a=t[(i+1)%e],l=t[(i+2)%e];return r((n-i/e)*e,o,s,a,l)}}))},6773:(t,e,n)=>{"use strict";n.d(e,{Z:()=>s});var i=n(8063),r=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,o=new RegExp(r.source,"g");function s(t,e){var n,s,a,l=r.lastIndex=o.lastIndex=0,c=-1,u=[],h=[];for(t+="",e+="";(n=r.exec(t))&&(s=o.exec(e));)(a=s.index)>l&&(a=e.slice(l,a),u[c]?u[c]+=a:u[++c]=a),(n=n[0])===(s=s[0])?u[c]?u[c]+=s:u[++c]=s:(u[++c]=null,h.push({i:c,x:(0,i.Z)(n,s)})),l=o.lastIndex;return l<e.length&&(a=e.slice(l),u[c]?u[c]+=a:u[++c]=a),u.length<2?h[0]?function(t){return function(e){return t(e)+""}}(h[0].x):function(t){return function(){return t}}(e):(e=h.length,function(t){for(var n,i=0;i<e;++i)u[(n=h[i]).i]=n.x(t);return u.join("")})}},9487:(t,e,n)=>{"use strict";n.d(e,{Z:()=>d});var i=n(8849),r=n(187);function o(t,e){var n,i=e?e.length:0,r=t?Math.min(i,t.length):0,o=new Array(r),s=new Array(i);for(n=0;n<r;++n)o[n]=d(t[n],e[n]);for(;n<i;++n)s[n]=e[n];return function(t){for(n=0;n<r;++n)s[n]=o[n](t);return s}}function s(t,e){var n=new Date;return t=+t,e=+e,function(i){return n.setTime(t*(1-i)+e*i),n}}var a=n(8063);function l(t,e){var n,i={},r={};for(n in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)n in t?i[n]=d(t[n],e[n]):r[n]=e[n];return function(t){for(n in i)r[n]=i[n](t);return r}}var c=n(6773),u=n(2954);function h(t,e){e||(e=[]);var n,i=t?Math.min(e.length,t.length):0,r=e.slice();return function(o){for(n=0;n<i;++n)r[n]=t[n]*(1-o)+e[n]*o;return r}}function d(t,e){var n,d,f=typeof e;return null==e||"boolean"===f?(0,u.Z)(e):("number"===f?a.Z:"string"===f?(n=(0,i.ZP)(e))?(e=n,r.ZP):c.Z:e instanceof i.ZP?r.ZP:e instanceof Date?s:(d=e,!ArrayBuffer.isView(d)||d instanceof DataView?Array.isArray(e)?o:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?l:a.Z:h))(t,e)}},1102:(t,e,n)=>{"use strict";function i(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function r(t){let e=t,n=t;function r(t,e,i,r){for(null==i&&(i=0),null==r&&(r=t.length);i<r;){const o=i+r>>>1;n(t[o],e)<0?i=o+1:r=o}return i}return 1===t.length&&(e=(e,n)=>t(e)-n,n=function(t){return(e,n)=>i(t(e),n)}(t)),{left:r,center:function(t,n,i,o){null==i&&(i=0),null==o&&(o=t.length);const s=r(t,n,i,o-1);return s>i&&e(t[s-1],n)>-e(t[s],n)?s-1:s},right:function(t,e,i,r){for(null==i&&(i=0),null==r&&(r=t.length);i<r;){const o=i+r>>>1;n(t[o],e)>0?r=o:i=o+1}return i}}}n.d(e,{JG:()=>v,ZP:()=>y,yR:()=>p,l4:()=>b});var o=n(2921);const s=r(i),a=s.right,l=(s.left,r(o.Z).center,a);var c=n(9487),u=n(8063);function h(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}function d(t){return+t}var f=[0,1];function p(t){return t}function g(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:(n=isNaN(e)?NaN:.5,function(){return n});var n}function m(t,e,n){var i=t[0],r=t[1],o=e[0],s=e[1];return r<i?(i=g(r,i),o=n(s,o)):(i=g(i,r),o=n(o,s)),function(t){return o(i(t))}}function _(t,e,n){var i=Math.min(t.length,e.length)-1,r=new Array(i),o=new Array(i),s=-1;for(t[i]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++s<i;)r[s]=g(t[s],t[s+1]),o[s]=n(e[s],e[s+1]);return function(e){var n=l(t,e,1,i)-1;return o[n](r[n](e))}}function v(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function b(){var t,e,n,i,r,o,s=f,a=f,l=c.Z,g=p;function v(){var t=Math.min(s.length,a.length);return g!==p&&(g=function(t,e){var n;return t>e&&(n=t,t=e,e=n),function(n){return Math.max(t,Math.min(e,n))}}(s[0],s[t-1])),i=t>2?_:m,r=o=null,b}function b(e){return null==e||isNaN(e=+e)?n:(r||(r=i(s.map(t),a,l)))(t(g(e)))}return b.invert=function(n){return g(e((o||(o=i(a,s.map(t),u.Z)))(n)))},b.domain=function(t){return arguments.length?(s=Array.from(t,d),v()):s.slice()},b.range=function(t){return arguments.length?(a=Array.from(t),v()):a.slice()},b.rangeRound=function(t){return a=Array.from(t),l=h,v()},b.clamp=function(t){return arguments.length?(g=!!t||p,v()):g!==p},b.interpolate=function(t){return arguments.length?(l=t,v()):l},b.unknown=function(t){return arguments.length?(n=t,b):n},function(n,i){return t=n,e=i,v()}}function y(){return b()(p,p)}},4182:(t,e,n)=>{"use strict";function i(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}n.d(e,{o:()=>i})},1031:(t,e,n)=>{"use strict";n.d(e,{Z:()=>k,Q:()=>C});var i=Math.sqrt(50),r=Math.sqrt(10),o=Math.sqrt(2);function s(t,e,n){var s=(e-t)/Math.max(0,n),a=Math.floor(Math.log(s)/Math.LN10),l=s/Math.pow(10,a);return a>=0?(l>=i?10:l>=r?5:l>=o?2:1)*Math.pow(10,a):-Math.pow(10,-a)/(l>=i?10:l>=r?5:l>=o?2:1)}var a,l=n(1102),c=n(4182),u=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function h(t){if(!(e=u.exec(t)))throw new Error("invalid format: "+t);var e;return new d({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function d(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function f(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,i=t.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+t.slice(n+1)]}function p(t){return(t=f(Math.abs(t)))?t[1]:NaN}function g(t,e){var n=f(t,e);if(!n)return t+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}h.prototype=d.prototype,d.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const m={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>g(100*t,e),r:g,s:function(t,e){var n=f(t,e);if(!n)return t+"";var i=n[0],r=n[1],o=r-(a=3*Math.max(-8,Math.min(8,Math.floor(r/3))))+1,s=i.length;return o===s?i:o>s?i+new Array(o-s+1).join("0"):o>0?i.slice(0,o)+"."+i.slice(o):"0."+new Array(1-o).join("0")+f(t,Math.max(0,e+o-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function _(t){return t}var v,b,y,w=Array.prototype.map,x=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function C(t){var e=t.domain;return t.ticks=function(t){var n=e();return function(t,e,n){var i,r,o,a,l=-1;if(n=+n,(t=+t)==(e=+e)&&n>0)return[t];if((i=e<t)&&(r=t,t=e,e=r),0===(a=s(t,e,n))||!isFinite(a))return[];if(a>0){let n=Math.round(t/a),i=Math.round(e/a);for(n*a<t&&++n,i*a>e&&--i,o=new Array(r=i-n+1);++l<r;)o[l]=(n+l)*a}else{a=-a;let n=Math.round(t*a),i=Math.round(e*a);for(n/a<t&&++n,i/a>e&&--i,o=new Array(r=i-n+1);++l<r;)o[l]=(n+l)/a}return i&&o.reverse(),o}(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var s=e();return function(t,e,n,s){var a,l=function(t,e,n){var s=Math.abs(e-t)/Math.max(0,n),a=Math.pow(10,Math.floor(Math.log(s)/Math.LN10)),l=s/a;return l>=i?a*=10:l>=r?a*=5:l>=o&&(a*=2),e<t?-a:a}(t,e,n);switch((s=h(null==s?",f":s)).type){case"s":var c=Math.max(Math.abs(t),Math.abs(e));return null!=s.precision||isNaN(a=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(p(e)/3)))-p(Math.abs(t)))}(l,c))||(s.precision=a),y(s,c);case"":case"e":case"g":case"p":case"r":null!=s.precision||isNaN(a=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,p(e)-p(t))+1}(l,Math.max(Math.abs(t),Math.abs(e))))||(s.precision=a-("e"===s.type));break;case"f":case"%":null!=s.precision||isNaN(a=function(t){return Math.max(0,-p(Math.abs(t)))}(l))||(s.precision=a-2*("%"===s.type))}return b(s)}(s[0],s[s.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var i,r,o=e(),a=0,l=o.length-1,c=o[a],u=o[l],h=10;for(u<c&&(r=c,c=u,u=r,r=a,a=l,l=r);h-- >0;){if((r=s(c,u,n))===i)return o[a]=c,o[l]=u,e(o);if(r>0)c=Math.floor(c/r)*r,u=Math.ceil(u/r)*r;else{if(!(r<0))break;c=Math.ceil(c*r)/r,u=Math.floor(u*r)/r}i=r}return t},t}function k(){var t=(0,l.ZP)();return t.copy=function(){return(0,l.JG)(t,k())},c.o.apply(t,arguments),C(t)}v=function(t){var e,n,i=void 0===t.grouping||void 0===t.thousands?_:(e=w.call(t.grouping,Number),n=t.thousands+"",function(t,i){for(var r=t.length,o=[],s=0,a=e[0],l=0;r>0&&a>0&&(l+a+1>i&&(a=Math.max(1,i-l)),o.push(t.substring(r-=a,r+a)),!((l+=a+1)>i));)a=e[s=(s+1)%e.length];return o.reverse().join(n)}),r=void 0===t.currency?"":t.currency[0]+"",o=void 0===t.currency?"":t.currency[1]+"",s=void 0===t.decimal?".":t.decimal+"",l=void 0===t.numerals?_:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(w.call(t.numerals,String)),c=void 0===t.percent?"%":t.percent+"",u=void 0===t.minus?"−":t.minus+"",d=void 0===t.nan?"NaN":t.nan+"";function f(t){var e=(t=h(t)).fill,n=t.align,f=t.sign,p=t.symbol,g=t.zero,_=t.width,v=t.comma,b=t.precision,y=t.trim,w=t.type;"n"===w?(v=!0,w="g"):m[w]||(void 0===b&&(b=12),y=!0,w="g"),(g||"0"===e&&"="===n)&&(g=!0,e="0",n="=");var C="$"===p?r:"#"===p&&/[boxX]/.test(w)?"0"+w.toLowerCase():"",k="$"===p?o:/[%p]/.test(w)?c:"",E=m[w],S=/[defgprs%]/.test(w);function A(t){var r,o,c,h=C,p=k;if("c"===w)p=E(t)+p,t="";else{var m=(t=+t)<0||1/t<0;if(t=isNaN(t)?d:E(Math.abs(t),b),y&&(t=function(t){t:for(var e,n=t.length,i=1,r=-1;i<n;++i)switch(t[i]){case".":r=e=i;break;case"0":0===r&&(r=i),e=i;break;default:if(!+t[i])break t;r>0&&(r=0)}return r>0?t.slice(0,r)+t.slice(e+1):t}(t)),m&&0==+t&&"+"!==f&&(m=!1),h=(m?"("===f?f:u:"-"===f||"("===f?"":f)+h,p=("s"===w?x[8+a/3]:"")+p+(m&&"("===f?")":""),S)for(r=-1,o=t.length;++r<o;)if(48>(c=t.charCodeAt(r))||c>57){p=(46===c?s+t.slice(r+1):t.slice(r))+p,t=t.slice(0,r);break}}v&&!g&&(t=i(t,1/0));var A=h.length+t.length+p.length,T=A<_?new Array(_-A+1).join(e):"";switch(v&&g&&(t=i(T+t,T.length?_-p.length:1/0),T=""),n){case"<":t=h+t+p+T;break;case"=":t=h+T+t+p;break;case"^":t=T.slice(0,A=T.length>>1)+h+t+p+T.slice(A);break;default:t=T+h+t+p}return l(t)}return b=void 0===b?6:/[gprs]/.test(w)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b)),A.toString=function(){return t+""},A}return{format:f,formatPrefix:function(t,e){var n=f(((t=h(t)).type="f",t)),i=3*Math.max(-8,Math.min(8,Math.floor(p(e)/3))),r=Math.pow(10,-i),o=x[8+i/3];return function(t){return n(r*t)+o}}}}({thousands:",",grouping:[3],currency:["$",""]}),b=v.format,y=v.formatPrefix},4421:(t,e,n)=>{"use strict";function i(t){return function(){return this.matches(t)}}function r(t){return function(e){return e.matches(t)}}n.d(e,{P:()=>r,Z:()=>i})},1663:(t,e,n)=>{"use strict";n.d(e,{Z:()=>r});var i=n(1226);function r(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),i.Z.hasOwnProperty(e)?{space:i.Z[e],local:t}:t}},1226:(t,e,n)=>{"use strict";n.d(e,{P:()=>i,Z:()=>r});var i="http://www.w3.org/1999/xhtml";const r={svg:"http://www.w3.org/2000/svg",xhtml:i,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"}},3838:(t,e,n)=>{"use strict";n.d(e,{Z:()=>r});var i=n(2533);function r(t){return"string"==typeof t?new i.Y1([[document.querySelector(t)]],[document.documentElement]):new i.Y1([[t]],i.Jz)}},2533:(t,e,n)=>{"use strict";n.d(e,{Y1:()=>lt,ZP:()=>ut,Jz:()=>at});var i=n(3010);function r(t){return null==t?[]:Array.isArray(t)?t:Array.from(t)}var o=n(9701),s=n(4421),a=Array.prototype.find;function l(){return this.firstElementChild}var c=Array.prototype.filter;function u(){return Array.from(this.children)}function h(t){return new Array(t.length)}function d(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function f(t){return function(){return t}}function p(t,e,n,i,r,o){for(var s,a=0,l=e.length,c=o.length;a<c;++a)(s=e[a])?(s.__data__=o[a],i[a]=s):n[a]=new d(t,o[a]);for(;a<l;++a)(s=e[a])&&(r[a]=s)}function g(t,e,n,i,r,o,s){var a,l,c,u=new Map,h=e.length,f=o.length,p=new Array(h);for(a=0;a<h;++a)(l=e[a])&&(p[a]=c=s.call(l,l.__data__,a,e)+"",u.has(c)?r[a]=l:u.set(c,l));for(a=0;a<f;++a)c=s.call(t,o[a],a,o)+"",(l=u.get(c))?(i[a]=l,l.__data__=o[a],u.delete(c)):n[a]=new d(t,o[a]);for(a=0;a<h;++a)(l=e[a])&&u.get(p[a])===l&&(r[a]=l)}function m(t){return t.__data__}function _(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function v(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}d.prototype={constructor:d,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var b=n(1663);function y(t){return function(){this.removeAttribute(t)}}function w(t){return function(){this.removeAttributeNS(t.space,t.local)}}function x(t,e){return function(){this.setAttribute(t,e)}}function C(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function k(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function E(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}var S=n(2627);function A(t){return function(){delete this[t]}}function T(t,e){return function(){this[t]=e}}function M(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function D(t){return t.trim().split(/^|\s+/)}function P(t){return t.classList||new L(t)}function L(t){this._node=t,this._names=D(t.getAttribute("class")||"")}function R(t,e){for(var n=P(t),i=-1,r=e.length;++i<r;)n.add(e[i])}function I(t,e){for(var n=P(t),i=-1,r=e.length;++i<r;)n.remove(e[i])}function O(t){return function(){R(this,t)}}function z(t){return function(){I(this,t)}}function F(t,e){return function(){(e.apply(this,arguments)?R:I)(this,t)}}function B(){this.textContent=""}function N(t){return function(){this.textContent=t}}function j(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function U(){this.innerHTML=""}function V(t){return function(){this.innerHTML=t}}function W(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function H(){this.nextSibling&&this.parentNode.appendChild(this)}function $(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}L.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var Z=n(1226);function q(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===Z.P&&e.documentElement.namespaceURI===Z.P?e.createElement(t):e.createElementNS(n,t)}}function G(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function K(t){var e=(0,b.Z)(t);return(e.local?G:q)(e)}function X(){return null}function Y(){var t=this.parentNode;t&&t.removeChild(this)}function Q(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function J(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function tt(t){return t.trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}))}function et(t){return function(){var e=this.__on;if(e){for(var n,i=0,r=-1,o=e.length;i<o;++i)n=e[i],t.type&&n.type!==t.type||n.name!==t.name?e[++r]=n:this.removeEventListener(n.type,n.listener,n.options);++r?e.length=r:delete this.__on}}}function nt(t,e,n){return function(){var i,r=this.__on,o=function(t){return function(e){t.call(this,e,this.__data__)}}(e);if(r)for(var s=0,a=r.length;s<a;++s)if((i=r[s]).type===t.type&&i.name===t.name)return this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=o,i.options=n),void(i.value=e);this.addEventListener(t.type,o,n),i={type:t.type,name:t.name,value:e,listener:o,options:n},r?r.push(i):this.__on=[i]}}var it=n(9920);function rt(t,e,n){var i=(0,it.Z)(t),r=i.CustomEvent;"function"==typeof r?r=new r(e,n):(r=i.document.createEvent("Event"),n?(r.initEvent(e,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(e,!1,!1)),t.dispatchEvent(r)}function ot(t,e){return function(){return rt(this,t,e)}}function st(t,e){return function(){return rt(this,t,e.apply(this,arguments))}}var at=[null];function lt(t,e){this._groups=t,this._parents=e}function ct(){return new lt([[document.documentElement]],at)}lt.prototype=ct.prototype={constructor:lt,select:function(t){"function"!=typeof t&&(t=(0,i.Z)(t));for(var e=this._groups,n=e.length,r=new Array(n),o=0;o<n;++o)for(var s,a,l=e[o],c=l.length,u=r[o]=new Array(c),h=0;h<c;++h)(s=l[h])&&(a=t.call(s,s.__data__,h,l))&&("__data__"in s&&(a.__data__=s.__data__),u[h]=a);return new lt(r,this._parents)},selectAll:function(t){t="function"==typeof t?function(t){return function(){return r(t.apply(this,arguments))}}(t):(0,o.Z)(t);for(var e=this._groups,n=e.length,i=[],s=[],a=0;a<n;++a)for(var l,c=e[a],u=c.length,h=0;h<u;++h)(l=c[h])&&(i.push(t.call(l,l.__data__,h,c)),s.push(l));return new lt(i,s)},selectChild:function(t){return this.select(null==t?l:function(t){return function(){return a.call(this.children,t)}}("function"==typeof t?t:(0,s.P)(t)))},selectChildren:function(t){return this.selectAll(null==t?u:function(t){return function(){return c.call(this.children,t)}}("function"==typeof t?t:(0,s.P)(t)))},filter:function(t){"function"!=typeof t&&(t=(0,s.Z)(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var o,a=e[r],l=a.length,c=i[r]=[],u=0;u<l;++u)(o=a[u])&&t.call(o,o.__data__,u,a)&&c.push(o);return new lt(i,this._parents)},data:function(t,e){if(!arguments.length)return Array.from(this,m);var n=e?g:p,i=this._parents,r=this._groups;"function"!=typeof t&&(t=f(t));for(var o=r.length,s=new Array(o),a=new Array(o),l=new Array(o),c=0;c<o;++c){var u=i[c],h=r[c],d=h.length,v=_(t.call(u,u&&u.__data__,c,i)),b=v.length,y=a[c]=new Array(b),w=s[c]=new Array(b),x=l[c]=new Array(d);n(u,h,y,w,x,v,e);for(var C,k,E=0,S=0;E<b;++E)if(C=y[E]){for(E>=S&&(S=E+1);!(k=w[S])&&++S<b;);C._next=k||null}}return(s=new lt(s,i))._enter=a,s._exit=l,s},enter:function(){return new lt(this._enter||this._groups.map(h),this._parents)},exit:function(){return new lt(this._exit||this._groups.map(h),this._parents)},join:function(t,e,n){var i=this.enter(),r=this,o=this.exit();return"function"==typeof t?(i=t(i))&&(i=i.selection()):i=i.append(t+""),null!=e&&(r=e(r))&&(r=r.selection()),null==n?o.remove():n(o),i&&r?i.merge(r).order():r},merge:function(t){for(var e=t.selection?t.selection():t,n=this._groups,i=e._groups,r=n.length,o=i.length,s=Math.min(r,o),a=new Array(r),l=0;l<s;++l)for(var c,u=n[l],h=i[l],d=u.length,f=a[l]=new Array(d),p=0;p<d;++p)(c=u[p]||h[p])&&(f[p]=c);for(;l<r;++l)a[l]=n[l];return new lt(a,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var i,r=t[e],o=r.length-1,s=r[o];--o>=0;)(i=r[o])&&(s&&4^i.compareDocumentPosition(s)&&s.parentNode.insertBefore(i,s),s=i);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=v);for(var n=this._groups,i=n.length,r=new Array(i),o=0;o<i;++o){for(var s,a=n[o],l=a.length,c=r[o]=new Array(l),u=0;u<l;++u)(s=a[u])&&(c[u]=s);c.sort(e)}return new lt(r,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],r=0,o=i.length;r<o;++r){var s=i[r];if(s)return s}return null},size:function(){let t=0;for(const e of this)++t;return t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,i=e.length;n<i;++n)for(var r,o=e[n],s=0,a=o.length;s<a;++s)(r=o[s])&&t.call(r,r.__data__,s,o);return this},attr:function(t,e){var n=(0,b.Z)(t);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((null==e?n.local?w:y:"function"==typeof e?n.local?E:k:n.local?C:x)(n,e))},style:S.Z,property:function(t,e){return arguments.length>1?this.each((null==e?A:"function"==typeof e?M:T)(t,e)):this.node()[t]},classed:function(t,e){var n=D(t+"");if(arguments.length<2){for(var i=P(this.node()),r=-1,o=n.length;++r<o;)if(!i.contains(n[r]))return!1;return!0}return this.each(("function"==typeof e?F:e?O:z)(n,e))},text:function(t){return arguments.length?this.each(null==t?B:("function"==typeof t?j:N)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?U:("function"==typeof t?W:V)(t)):this.node().innerHTML},raise:function(){return this.each(H)},lower:function(){return this.each($)},append:function(t){var e="function"==typeof t?t:K(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,e){var n="function"==typeof t?t:K(t),r=null==e?X:"function"==typeof e?e:(0,i.Z)(e);return this.select((function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(Y)},clone:function(t){return this.select(t?J:Q)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var i,r,o=tt(t+""),s=o.length;if(!(arguments.length<2)){for(a=e?nt:et,i=0;i<s;++i)this.each(a(o[i],e,n));return this}var a=this.node().__on;if(a)for(var l,c=0,u=a.length;c<u;++c)for(i=0,l=a[c];i<s;++i)if((r=o[i]).type===l.type&&r.name===l.name)return l.value},dispatch:function(t,e){return this.each(("function"==typeof e?st:ot)(t,e))},[Symbol.iterator]:function*(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i,r=t[e],o=0,s=r.length;o<s;++o)(i=r[o])&&(yield i)}};const ut=ct},2627:(t,e,n)=>{"use strict";n.d(e,{S:()=>l,Z:()=>a});var i=n(9920);function r(t){return function(){this.style.removeProperty(t)}}function o(t,e,n){return function(){this.style.setProperty(t,e,n)}}function s(t,e,n){return function(){var i=e.apply(this,arguments);null==i?this.style.removeProperty(t):this.style.setProperty(t,i,n)}}function a(t,e,n){return arguments.length>1?this.each((null==e?r:"function"==typeof e?s:o)(t,e,null==n?"":n)):l(this.node(),t)}function l(t,e){return t.style.getPropertyValue(e)||(0,i.Z)(t).getComputedStyle(t,null).getPropertyValue(e)}},3010:(t,e,n)=>{"use strict";function i(){}function r(t){return null==t?i:function(){return this.querySelector(t)}}n.d(e,{Z:()=>r})},9701:(t,e,n)=>{"use strict";function i(){return[]}function r(t){return null==t?i:function(){return this.querySelectorAll(t)}}n.d(e,{Z:()=>r})},9920:(t,e,n)=>{"use strict";function i(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}n.d(e,{Z:()=>i})}},__webpack_module_cache__={},inProgress,dataWebpackPrefix;function __webpack_require__(t){var e=__webpack_module_cache__[t];if(void 0!==e)return e.exports;var n=__webpack_module_cache__[t]={id:t,exports:{}};return __webpack_modules__[t].call(n.exports,n,n.exports,__webpack_require__),n.exports}__webpack_require__.m=__webpack_modules__,__webpack_require__.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return __webpack_require__.d(e,{a:e}),e},__webpack_require__.d=(t,e)=>{for(var n in e)__webpack_require__.o(e,n)&&!__webpack_require__.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},__webpack_require__.f={},__webpack_require__.e=t=>Promise.all(Object.keys(__webpack_require__.f).reduce(((e,n)=>(__webpack_require__.f[n](t,e),e)),[])),__webpack_require__.u=t=>t+".mdv.js",__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),__webpack_require__.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),inProgress={},dataWebpackPrefix="ciview2:",__webpack_require__.l=(t,e,n,i)=>{if(inProgress[t])inProgress[t].push(e);else{var r,o;if(void 0!==n)for(var s=document.getElementsByTagName("script"),a=0;a<s.length;a++){var l=s[a];if(l.getAttribute("src")==t||l.getAttribute("data-webpack")==dataWebpackPrefix+n){r=l;break}}r||(o=!0,(r=document.createElement("script")).charset="utf-8",r.timeout=120,__webpack_require__.nc&&r.setAttribute("nonce",__webpack_require__.nc),r.setAttribute("data-webpack",dataWebpackPrefix+n),r.src=t),inProgress[t]=[e];var c=(e,n)=>{r.onerror=r.onload=null,clearTimeout(u);var i=inProgress[t];if(delete inProgress[t],r.parentNode&&r.parentNode.removeChild(r),i&&i.forEach((t=>t(n))),e)return e(n)},u=setTimeout(c.bind(null,void 0,{type:"timeout",target:r}),12e4);r.onerror=c.bind(null,r.onerror),r.onload=c.bind(null,r.onload),o&&document.head.appendChild(r)}},__webpack_require__.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t;__webpack_require__.g.importScripts&&(t=__webpack_require__.g.location+"");var e=__webpack_require__.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var n=e.getElementsByTagName("script");n.length&&(t=n[n.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),__webpack_require__.p=t})(),(()=>{__webpack_require__.b=document.baseURI||self.location.href;var t={179:0};__webpack_require__.f.j=(e,n)=>{var i=__webpack_require__.o(t,e)?t[e]:void 0;if(0!==i)if(i)n.push(i[2]);else{var r=new Promise(((n,r)=>i=t[e]=[n,r]));n.push(i[2]=r);var o=__webpack_require__.p+__webpack_require__.u(e),s=new Error;__webpack_require__.l(o,(n=>{if(__webpack_require__.o(t,e)&&(0!==(i=t[e])&&(t[e]=void 0),i)){var r=n&&("load"===n.type?"missing":n.type),o=n&&n.target&&n.target.src;s.message="Loading chunk "+e+" failed.\n("+r+": "+o+")",s.name="ChunkLoadError",s.type=r,s.request=o,i[1](s)}}),"chunk-"+e,e)}};var e=(e,n)=>{var i,r,[o,s,a]=n,l=0;if(o.some((e=>0!==t[e]))){for(i in s)__webpack_require__.o(s,i)&&(__webpack_require__.m[i]=s[i]);a&&a(__webpack_require__)}for(e&&e(n);l<o.length;l++)r=o[l],__webpack_require__.o(t,r)&&t[r]&&t[r][0](),t[r]=0},n=self.webpackChunkciview2=self.webpackChunkciview2||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))})(),__webpack_require__.nc=void 0;var __webpack_exports__={};(()=>{"use strict";var t=__webpack_require__(3379),e=__webpack_require__.n(t),n=__webpack_require__(7795),i=__webpack_require__.n(n),r=__webpack_require__(569),o=__webpack_require__.n(r),s=__webpack_require__(3565),a=__webpack_require__.n(s),l=__webpack_require__(9216),c=__webpack_require__.n(l),u=__webpack_require__(4589),h=__webpack_require__.n(u),d=__webpack_require__(6499),f={};f.styleTagTransform=h(),f.setAttributes=a(),f.insert=o().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=c(),e()(d.Z,f),d.Z&&d.Z.locals&&d.Z.locals;var p=__webpack_require__(1171),g={};g.styleTagTransform=h(),g.setAttributes=a(),g.insert=o().bind(null,"head"),g.domAPI=i(),g.insertStyleElement=c(),e()(p.Z,g),p.Z&&p.Z.locals&&p.Z.locals;var m=__webpack_require__(7047),_={};_.styleTagTransform=h(),_.setAttributes=a(),_.insert=o().bind(null,"head"),_.domAPI=i(),_.insertStyleElement=c(),e()(m.Z,_),m.Z&&m.Z.locals&&m.Z.locals;var v=__webpack_require__(8520),b={};b.styleTagTransform=h(),b.setAttributes=a(),b.insert=o().bind(null,"head"),b.domAPI=i(),b.insertStyleElement=c(),e()(v.Z,b),v.Z&&v.Z.locals&&v.Z.locals;var y=__webpack_require__(5175),w={};w.styleTagTransform=h(),w.setAttributes=a(),w.insert=o().bind(null,"head"),w.domAPI=i(),w.insertStyleElement=c(),e()(y.Z,w),y.Z&&y.Z.locals&&y.Z.locals;var x=__webpack_require__(9719),C={};C.styleTagTransform=h(),C.setAttributes=a(),C.insert=o().bind(null,"head"),C.domAPI=i(),C.insertStyleElement=c(),e()(x.Z,C),x.Z&&x.Z.locals&&x.Z.locals;var k=__webpack_require__(7745),E={};E.styleTagTransform=h(),E.setAttributes=a(),E.insert=o().bind(null,"head"),E.domAPI=i(),E.insertStyleElement=c(),e()(k.Z,E),k.Z&&k.Z.locals&&k.Z.locals;var S=__webpack_require__(1451),A={};A.styleTagTransform=h(),A.setAttributes=a(),A.insert=o().bind(null,"head"),A.domAPI=i(),A.insertStyleElement=c(),e()(S.Z,A),S.Z&&S.Z.locals&&S.Z.locals;var T=__webpack_require__(4538),M=__webpack_require__(8503);class D{constructor(t){this.setItemFunction=t,this.menus=[]}show(t,e){this.menus.length>0&&this.remove();const n=this.setItemFunction(e);this._addMenu(n,t.pageX,t.pageY),console.log(t.clientY),t.stopPropagation(),this.removeFunc=()=>{this.remove()},this._getDocument().body.addEventListener("click",this.removeFunc)}remove(){for(let t of this.menus)t.remove();this.menus=[],this.removeFunc&&this._getDocument().body.removeEventListener("click",this.removeFunc)}_addMenu(t,e,n){let i=document.createElement("div");const r=this._getDocument();let o=this.menus.length;i.classList.add("ciview-ctm-main");for(let e of t)this._addItem(i,e,o);r.body.append(i);const s=i.getBoundingClientRect();e+s.width>r.body.clientWidth&&(e=r.body.clientWidth-s.width-3),i.style.left=e+"px",i.style.top=n+"px",this.menus.push(i)}_getDocument(){return this.__doc__?this.__doc__:document}_showSubmenu(t,e,n){for(let t=n+1;t<this.menus.length;t++)this.menus[t].remove();this.menus=this.menus.slice(0,n+1);const i=t.getBoundingClientRect();this._addMenu(e,i.left+i.width+1,i.top)}_addItem(t,e,n){const i=document.createElement("div");if(i.classList.add("ciview-ctm-item"),e.ghosted?i.classList.add("ciview-ctm-ghosted"):i.classList.add("ciview-ctm-active"),e.icon){const t=document.createElement("i");for(let n of e.icon.split(" "))t.classList.add(n);t.classList.add("ciview-ctm-left-icon"),i.appendChild(t)}const r=document.createElement("span");if(r.appendChild(document.createTextNode(e.text)),i.append(r),e.subitems){const t=document.createElement("i");t.classList.add("fas","fa-caret-right","ciview-ctm-right-icon"),i.appendChild(t)}i.addEventListener("click",(r=>{if(e.func&&!e.ghosted&&e.func(r),e.subitems){this._showSubmenu(i,e.subitems,n);for(let e of t.children)e.classList.remove("ciview-ctm-selected");i.classList.add("ciview-ctm-selected")}else this.remove();r.stopPropagation()})),t.append(i)}}var P=__webpack_require__(5618);class L{constructor(t,e,n){n.color_by&&n.color_by.column&&(n.color_by=n.color_by.column.field),this.config=JSON.parse(JSON.stringify(n)),this.config.id||(this.config.id=(0,M.zO)()),this.__doc__=document,this.dataStore=t,this.listeners={},this.div="string"==typeof e?document.getElementById(e):e,this.div.classList.add("ciview-chart-panel"),this.titleBar=(0,T.ut)("div",{classes:["ciview-chart-titlebar"]}),this.title=(0,T.ut)("div",{classes:["ciview-chart-title"],text:n.title},this.titleBar),this.menuSpace=(0,T.ut)("div",{classes:["ciview-chart-menuspace"]},this.titleBar),this.contentDiv=(0,T.ut)("div",{classes:["ciview-chart-content"]}),n.title_color&&(this.titleBar.style.backgroundColor=n.title_color),this.resetButton=this.addMenuIcon("fas fa-sync","remove filter"),this.resetButton.style.display="none",this.resetButton.addEventListener("click",(()=>{this.removeFilter(),this.resetButton.style.display="none"})),this.dataStore.addListener(this.config.id,((t,e)=>{"filtered"===t?this.onDataFiltered(e):"data_changed"===t?this.onDataChanged(e):"data_added"===t?this.onDataAdded(e):"data_highlighted"===t&&this.onDataHighlighted&&this.onDataHighlighted(e)})),this.contextMenu=new D((t=>this.getContextMenu(t))),this.addMenuIcon("fas fa-bars","more").addEventListener("click",(t=>this.contextMenu.show(t))),this.addMenuIcon("fas fa-cog","settings").addEventListener("click",(t=>this._openSettingsDialog(t))),this.legendIcon=this.addMenuIcon("fas fa-info",n.legend||"No description",{size:"medium"}),this.div.append(this.titleBar),this.div.append(this.contentDiv),this.listeners={},this._setDimensions()}_getContentDimensions(){return{top:5,left:5,height:this.height,width:this.width-5}}getFilter(){}setFilter(){}addListener(t,e){this.listeners[t]=e}removeListener(t){delete this.listeners[t]}_callListeners(t,e){for(let n in this.listeners)this.listeners[n](t,e)}addMenuIcon(t,e,n={}){const i=(0,T.ut)("span",{"aria-label":e,"data-microtip-color":"red",role:"tooltip","data-microtip-size":n.size||"small","data-microtip-position":n.position||"bottom-left",styles:{margin:"0px 1px"}},this.menuSpace);return(0,T.ut)("i",{classes:["ciview-chart-icon"].concat(t.split(" "))},i),n.func&&i.addEventListener("click",(t=>n.func(t))),i}removeFilter(){}onDataFiltered(t){}onDataChanged(t){const e=t.columns;if(!t.hasFiltered){let t=this.config.param,n=!1;"string"==typeof this.config.param&&(t=[this.config.param]);for(let i of t)if(-1!==e.indexOf(i)){n=!0;break}n&&this.onDataFiltered()}-1!==e.indexOf(this.config.color_by)&&this.colorByColumn(this.config.color_by)}getColorLegend(){const t={overideValues:{colorLogScale:this.config.log_color_scale}};return this._addTrimmedColor(this.config.color_by,t),this.dataStore.getColorLegend(this.config.color_by,t)}getQunatile;_addTrimmedColor(t,e){const n=this.config.trim_color_scale,i=this.dataStore.columnIndex[t];n&&"none"!==n&&i.quantiles&&"NA"!==i.quantiles&&(e.overideValues.min=i.quantiles[n][0],e.overideValues.max=i.quantiles[n][1])}setColorLegend(){if(!this.config.color_legend.display)return void(this.legend&&(this.config.color_legend.pos=[this.legend.offsetLeft,this.legend.offsetTop],this.legend.remove(),delete this.legend));const t=this._getContentDimensions();let e=0,n=0;if(this.legend)n=this.legend.style.left,e=this.legend.style.top,this.legend.remove();else{const i=this.config.color_legend;i.pos||(i.pos=[t.left,t.top]),n=i.pos[0]+"px",e=i.pos[1]+"px"}this.legend=this.getColorLegend(),this.legend?(this.contentDiv.append(this.legend),this.legend.style.left=n,this.legend.style.top=e,this.legend.__doc__=this.__doc__):console.warn("no color legend")}getColorFunction(t,e){this.config.color_by=t;const n={asArray:e,overideValues:{colorLogScale:this.config.log_color_scale,fallbackOnZero:this.config.fallbackOnZero}};this._addTrimmedColor(t,n);const i=this.dataStore.getColorFunction(t,n);return this.config.color_legend||(this.config.color_legend={display:!0}),this.setColorLegend(),i}onColumnRemoved(t){let e=this.config.param,n=!1;"string"==typeof this.config.param&&(e=[this.config.param]);for(let i of e)if(t===i){n=!0;break}return n?(this.remove(!1),!0):(this.colorByColumn&&this.config.color_by===t&&(delete this.config.color_by,this.colorByDefault()),!1)}onDataAdded(t){this.onDataFiltered()}addToolTip(){this._tooltip=(0,T.ut)("div",{classes:["ciview-tooltip"],stlyles:{display:"none",position:"absolute"}},this.__doc__.body)}showToolTip(t,e){this._tooltip.innerHTML=e,this._tooltip.style.display="inline-block",this._tooltip.style.left=3+t.clientX+"px",this._tooltip.style.top=3+t.clientY+"px"}hideToolTip(){this._tooltip.style.display="none"}remove(){this.titleBar.remove(),this.contentDiv.remove(),this.dataStore.removeListener(this.config.id),this._tooltip&&this._tooltip.remove()}getSettings(){const t=this.config;let e=[{type:"text",label:"Chart Name",current_value:t.title,func:t=>{this.setTitle(t)}}];const n=this.getColorOptions();if(n.colorby){const i="all"===n.colorby?["int32","text","integer","double"]:n.colorby,r=this.dataStore.getColumnList(i);r.push({name:"None",field:"_none"}),e.push({label:"Color By",type:"dropdown",values:[r,"name","field"],current_value:t.color_by||"_none",func:e=>{"_none"===e?(delete t.color_by,this.colorByDefault()):(t.color_by=e,this.colorByColumn(e))}}),void 0!==n.color_overlay&&e.push({label:"Color Overlay",type:"slider",current_value:t.color_overlay,func:e=>{t.color_overlay=e,this.colorByColumn(t.color_by)}}),e.push({label:"Show Color Legend",type:"check",current_value:!t.color_legend||t.color_legend.display,func:e=>{t.color_by&&(t.color_legend.display=e,this.setColorLegend())}}),e.push({label:"SymLog Color Scale",type:"check",current_value:t.log_color_scale,func:e=>{t.log_color_scale=e,t.color_by&&this.colorByColumn(t.color_by)}}),e.push({label:"Treat zero as missing",type:"check",current_value:t.fallbackOnZero,func:e=>{t.fallbackOnZero=e,t.color_by&&this.colorByColumn(t.color_by)}}),e.push({type:"radiobuttons",label:"Trim Color Scale to Percentile",current_value:t.trim_color_scale||"none",choices:[["No Trim","none"],["0.001","0.001"],["0.01","0.01"],["0.05","0.05"]],func:e=>{t.trim_color_scale=e,t.color_by&&this.colorByColumn(t.color_by)}})}return e}_addUnpinIcon(){this.unpinIcon=this.addMenuIcon("fas fa-thumbtack","unpin chart"),this.unpinIcon.addEventListener("click",(t=>{this.unpinIcon.remove(),this.unpinChart()}))}_openSettingsDialog(t){this.settingsDialog||(this.settingsDialog=new P.Z({maxHeight:400,doc:this.__doc__||document,width:300,title:"Settings",position:[t.pageX,t.pageY],onclose:()=>this.settingsDialog=null},this.getSettings()))}getContextMenu(t){let e=[];return this.getImage&&(e=e.concat([{text:"create svg image",icon:"far fa-image",func:()=>this.downloadImage("svg")},{text:"create png image",icon:"far fa-image",func:()=>this.downloadImage("png")}])),this.pinChart&&!this.isPinned&&e.push({text:"pin chart",icon:"fas fa-thumbtack",func:()=>{this.pinChart(),this._addUnpinIcon()}}),this.addToContextMenu&&(e=e.concat(this.addToContextMenu())),e}getDiv(){return this.div}changeBaseDocument(t){this.contextMenu.__doc__=t,this.__doc__=t,this.settingsDialog&&this.settingsDialog.close(),this.legend&&(this.legend.__doc__=t),this._tooltip&&(this._tooltip.remove(),this.addToolTip())}_setConfigValue(t,e,n){return void 0===t[e]&&(t[e]=n),t[e]}drawChart(){}getConfig(){return this.legend&&(this.config.color_legend={display:!0,pos:[this.legend.offsetLeft,this.legend.offsetTop]}),JSON.parse(JSON.stringify(this.config))}getColorOptions(){return{}}setSize(t,e){t&&(this.div.style.height=e+"px",this.div.style.width=t+"px"),this._setDimensions()}_setDimensions(){const t=this.div.getBoundingClientRect(),e=Math.round(t.height),n=Math.round(t.width);this.config.size=[n,e];const i=this.contentDiv.getBoundingClientRect();this.height=Math.round(i.height),this.width=n}downloadImage(t){const e=this.contentDiv.style.color;this.contentDiv.style.color="black",this.getImage((n=>{let i=document.createElement("a"),r=this.config.title||"image";if(i.download=r+"."+t,"svg"===t)i.href="data:image/svg+xml,"+encodeURIComponent(n);else{let t=n.toDataURL("image/png");t=t.replace(/^data:image\/png/,"data:application/octet-stream"),i.href=t}i.click(),i.remove(),this.contentDiv.style.color=e}),t)}setTitle(t){this.title.textContent=t,this.config.title=t}getImageFromSVG(t,e){var n=t.cloneNode(!0);R(n,t);var i=document.createElement("canvas");n.style.top="0px",i.width=t.width.baseVal.value,i.height=t.height.baseVal.value;var r=i.getContext("2d");r.clearRect(0,0,i.width,i.height);var o=(new XMLSerializer).serializeToString(n),s=window.URL||window.webkitURL||window,a=new Image,l=new Blob([o],{type:"image/svg+xml;charset=utf-8"}),c=s.createObjectURL(l);a.src=c,a.onload=function(){r.drawImage(a,0,0),e(i,r)}}}function R(t,e){for(var n=["svg","g"],i=0;i<t.childNodes.length;i++){var r=t.childNodes[i];if(-1==n.indexOf(r.tagName)){var o=e.childNodes[i].currentStyle||window.getComputedStyle(e.childNodes[i]);if("undefined"!=o&&null!=o)for(var s=0;s<o.length;s++)r.style.setProperty(o[s],o.getPropertyValue(o[s]))}else R(r,e.childNodes[i])}}L.types={};const I=L;class O{constructor(t,e,n={}){let i=this;const r=document.documentElement.className;let o=URL.createObjectURL(new Blob([],{type:"text/html"}));o=n.url||o;const s=n;this.window=window.open(o,"win"+(new Date).getTime(),`width=${s.width||800},\n            height=${s.height||400},\n            screenX=${s.screenX||200},\n            screenY=${s.screenY||200}\n            ;modal=yes`),this.window.addEventListener("load",(function(){let n=i.window.document;n.documentElement.className=r,this.setTimeout((()=>{n.documentElement.className=r}),1e3),n.write("<head>");let o=document.head.innerHTML;if(n.write(o),s.stylesheets)for(let t of s.stylesheets)n.write(`<link rel="stylesheet" type="text/css" href="${t}">`);n.write("</head>"),n.write("<body><body>"),s.title&&(n.title=s.title),t&&t(n,i.getDimensions()),i.onclose=e,i.window.addEventListener("beforeunload",(function(t){i.closing(n)})),s.stayInFront&&(i.focusListener=()=>{i.window.focus()},document.body.addEventListener("pointerdown",i.focusListener));const a=s.onresize;a&&i.window.addEventListener("resize",(function(t){clearTimeout(i.resizeTO),i.resizeTO=setTimeout((()=>{a(n,i.getDimensions())}),200)}))}))}getDimensions(){const t=this.window;return{width:t.innerWidth-10,height:t.innerHeight-10}}closing(t){this.onclose&&this.onclose(t),this.focusListener&&document.body.removeEventListener("pointerdown",this.focusListener)}close(){this.window.close()}}var z=__webpack_require__(4677),F=__webpack_require__(3740),B=__webpack_require__(4211),N=__webpack_require__.n(B);class j extends F.v{constructor(t){t.buttons&&(t.footer=!0,t._buttons=t.buttons,delete t.buttons),t.width=t.width||300,super(t,t)}init(t){if(this.controlValues={},this.controls={},t._buttons)for(let e of t._buttons)this.addButton(e);if(t.text&&((0,T.ut)("div",{},this.dialog).innerHTML=t.text),t.controls)for(let e of t.controls){e.id||(e.id=e.label);let t=(0,T.ut)("div",{styles:{padding:"5px"}},this.dialog);if("button"!==e.type){const n="checkbox"===e.type?"inline":"block";(0,T.ut)("label",{text:e.label,styles:{fontWeight:"bold",display:n,marginBottom:"3px"}},t)}this[e.type](e,t),e.description&&(0,T.ut)("div",{text:e.description,styles:{fontSize:"12px"}},t)}}radiobuttons(t,e){const n=(0,T.ut)("div",{},e);this.controlValues[t.id]=t.current_value;for(let e of t.choices){(0,T.ut)("span",{text:e[0]},n);const i=(0,T.ut)("input",{type:"radio",name:t.label,value:e[1]},n);i.checked=t.current_value===e[1],i.addEventListener("click",(e=>{const n=e.currentTarget.value;this.controlValues[t.id]=n,t.func&&t.func(n,this)}))}}slider(t,e){const n=(0,T.ut)("div",{},e);N().create(n,{start:[t.current_value],range:{min:[t.min],max:[t.max]},step:t.step||null,tooltips:!0,documentElement:t.doc||document}),this.controlValues[t.id]=t.current_value,n.noUiSlider.on("end",(e=>{const n=parseFloat(e[0]);this.controlValues[t.id]=n,t.func&&t.func(n)}))}changeDropDownContent(t,e){const n=this.controls[t];for(;0!==n.length;)n.remove(0);for(let t of e)(0,T.ut)("option",{text:t.text,value:t.value},n);this.controlValues[t]=n.value}dropdown(t,e){const n=(0,T.ut)("select",{styles:{maxWidth:"200px"}});for(let e of t.items)(0,T.ut)("option",{text:e.text,value:e.value},n);e.append(n),t.current_value&&(n.value=t.current_value),this.controlValues[t.id]=n.value,n.addEventListener("change",(e=>{this.controlValues[t.id]=n.value,t.func&&t.func(n.value,this)})),this.controls[t.id]=n}checkboxgroup(t,e){const n=this,i=(0,T.ut)("div",{},e);function r(e,r){(0,T.ut)("button",{text:e,classes:["ciview-button-sm"]},i).addEventListener("click",(()=>{for(let e of t.checkboxes)n.controls[e.id].checked=r,n.controlValues[e.id]=r}))}r("Check All",!0),r("Uncheck All",!1);const o=(0,T.ut)("div",{},e);for(let e of t.checkboxes){const n=(0,T.ut)("div",{styles:{display:"inline-block",padding:"3px"}},o);(0,T.ut)("span",{styles:{fontSize:"13px"},text:e.label},n),e.id=`${t.id}_${e.id}`,this.checkbox(e,n)}}checkbox(t,e){const n=t.current_value,i=(0,T.ut)("input",{type:"checkbox",classes:["mdv-checkbox"]},e);i.checked=t.current_value,this.controlValues[t.id]=n,i.addEventListener("click",(e=>{this.controlValues[t.id]=i.checked,t.func&&t.func(i.checked)})),this.controls[t.id]=i}text(t,e){const n=t.defaultValue||"",i=(0,T.ut)("input",{value:n},e);this.controlValues[t.id]=n,i.addEventListener("keyup",(()=>{this.controlValues[t.id]=i.value})),this.controls[t.id]=i}buttonClicked(t){"noclose"!==t.method(this.controlValues,this.controls)&&this.close()}addButton(t){(0,T.ut)("button",{text:t.text,classes:["ciview-button"]},this.footer).addEventListener("click",(()=>this.buttonClicked(t)))}}const U=j;var V={},W={};function H(t){return new Function("d","return {"+t.map((function(t,e){return JSON.stringify(t)+": d["+e+'] || ""'})).join(",")+"}")}function $(t){var e=Object.create(null),n=[];return t.forEach((function(t){for(var i in t)i in e||n.push(e[i]=i)})),n}function Z(t,e){var n=t+"",i=n.length;return i<e?new Array(e-i+1).join(0)+n:n}function q(t){var e=new RegExp('["'+t+"\n\r]"),n=t.charCodeAt(0);function i(t,e){var i,r=[],o=t.length,s=0,a=0,l=o<=0,c=!1;function u(){if(l)return W;if(c)return c=!1,V;var e,i,r=s;if(34===t.charCodeAt(r)){for(;s++<o&&34!==t.charCodeAt(s)||34===t.charCodeAt(++s););return(e=s)>=o?l=!0:10===(i=t.charCodeAt(s++))?c=!0:13===i&&(c=!0,10===t.charCodeAt(s)&&++s),t.slice(r+1,e-1).replace(/""/g,'"')}for(;s<o;){if(10===(i=t.charCodeAt(e=s++)))c=!0;else if(13===i)c=!0,10===t.charCodeAt(s)&&++s;else if(i!==n)continue;return t.slice(r,e)}return l=!0,t.slice(r,o)}for(10===t.charCodeAt(o-1)&&--o,13===t.charCodeAt(o-1)&&--o;(i=u())!==W;){for(var h=[];i!==V&&i!==W;)h.push(i),i=u();e&&null==(h=e(h,a++))||r.push(h)}return r}function r(e,n){return e.map((function(e){return n.map((function(t){return s(e[t])})).join(t)}))}function o(e){return e.map(s).join(t)}function s(t){return null==t?"":t instanceof Date?(r=(n=t).getUTCHours(),o=n.getUTCMinutes(),s=n.getUTCSeconds(),a=n.getUTCMilliseconds(),isNaN(n)?"Invalid Date":((i=n.getUTCFullYear())<0?"-"+Z(-i,6):i>9999?"+"+Z(i,6):Z(i,4))+"-"+Z(n.getUTCMonth()+1,2)+"-"+Z(n.getUTCDate(),2)+(a?"T"+Z(r,2)+":"+Z(o,2)+":"+Z(s,2)+"."+Z(a,3)+"Z":s?"T"+Z(r,2)+":"+Z(o,2)+":"+Z(s,2)+"Z":o||r?"T"+Z(r,2)+":"+Z(o,2)+"Z":"")):e.test(t+="")?'"'+t.replace(/"/g,'""')+'"':t;var n,i,r,o,s,a}return{parse:function(t,e){var n,r,o=i(t,(function(t,i){if(n)return n(t,i-1);r=t,n=e?function(t,e){var n=H(t);return function(i,r){return e(n(i),r,t)}}(t,e):H(t)}));return o.columns=r||[],o},parseRows:i,format:function(e,n){return null==n&&(n=$(e)),[n.map(s).join(t)].concat(r(e,n)).join("\n")},formatBody:function(t,e){return null==e&&(e=$(t)),r(t,e).join("\n")},formatRows:function(t){return t.map(o).join("\n")},formatRow:o,formatValue:s}}var G=q(","),K=G.parse,X=(G.parseRows,G.format,G.formatBody,G.formatRows,G.formatRow,G.formatValue,q("\t")),Y=X.parse;function Q(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.text()}function J(t,e){return fetch(t,e).then(Q)}function tt(t){return function(e,n,i){return 2===arguments.length&&"function"==typeof n&&(i=n,n=void 0),J(e,n).then((function(e){return t(e,i)}))}}X.parseRows,X.format,X.formatBody,X.formatRows,X.formatRow,X.formatValue;var et=tt(K),nt=tt(Y);function it(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);if(204!==t.status&&205!==t.status)return t.json()}function rt(t,e){return fetch(t,e).then(it)}class ot extends F.v{constructor(t,e,n,i){super({title:`Add ${n.name}`,footer:!0,columns:2,width:380},{ds:t,ds_to:e,link:n,cm:i})}init(t){this.ds=t.ds,this.ds_to=t.ds_to,this.link=t.link,this.cm=t.cm,this.cm._getColumnsThen(this.ds_to.name,[this.link.name_column],(()=>{const t=(0,T.ut)("div",{classes:["mdv-section"]},this.columns[0]),e=(0,T.ut)("input",{},t);this.ac=new class{constructor(t,e,n={}){this.__doc__=n.doc||document,this.input=t,this.listeners=[],n.minLength=n.minLength||2,this.input.addEventListener("input",(t=>{this.input.value.length<n.minLength||(this.text=this.input.value,e(this.text).then((t=>{this.list=t,this.createDropDown()})))})),this.dli=t=>{t.target.parentElement!==this.listHolder&&this.listHolder&&(this.listHolder.remove(),this.listHolder=null)},this.__doc__.addEventListener("pointerdown",this.dli)}getSelectedItem(){return this.selectedItem}addListener(t){this.listeners.push(t)}destroy(){this.listholder&&this.listholder.remove(),this.__doc__.removeEventListener("click",this.dli)}setSelectedItem(t,e=!0){this.selectedItem=t,this.input.value=t.value,e&&this.listeners.map((e=>e("item_chose",t)))}addItemEventListener(t,e){t.addEventListener("click",(t=>{this.listHolder.remove(),this.listHolder=null,this.setSelectedItem(e)}))}createDropDown(){if(this.listHolder&&this.listHolder.remove(),!this.text)return;const t=(0,T.qT)(this.input);this.listHolder=(0,T.ut)("div",{classes:["autocomplete-items"],styles:{top:t.top+t.height+"px",left:t.left+"px",width:t.width+"px",zIndex:1200}},this.__doc__.body);for(let t=0;t<this.list.length;t++){const e=this.list[t].value;let n=(0,T.ut)("div",{text:e},this.listHolder);this.addItemEventListener(n,this.list[t])}}}(e,(async t=>this.ds_to.dataStore.getSuggestedValues(t,this.link.name_column,8))),this.ac.addListener(((t,e)=>this.addColumn(e))),this.rn=(0,M.zO)();for(let t in this.link.subgroups)(0,T.ut)("label",{text:this.link.subgroups[t].label},this.footer),(0,T.ut)("input",{type:"radio",name:this.rn,value:t,checked:!0},this.footer);this._addOptionsSection(),(0,T.ut)("button",{classes:["ciview-button-sm"],styles:[],text:"Apply"},this.columns[0]).addEventListener("click",(()=>{this.addColumn(this.ac.getSelectedItem())})),this.ta=(0,T.ut)("textarea",{rows:10},this.columns[1]),this.errorDiv=(0,T.ut)("div",{classes:["mdv-section"]},this.columns[1]);let n=(0,T.ut)("div",{classes:["mdv-section"]},this.columns[1]);this.addHeatMapCheck=(0,T.ut)("input",{type:"checkbox"},n),(0,T.ut)("span",{text:"Create Heat Map:",styles:{marginRight:"4px"}},n),this.addDotPlotCheck=(0,T.ut)("input",{type:"checkbox"},n),(0,T.ut)("span",{text:"Create DotPlot:",styles:{marginRight:"4px"}},n),n=(0,T.ut)("div",{classes:["mdv-section"]},this.columns[1]),(0,T.ut)("span",{text:"Categories:",styles:{marginRight:"4px"}},n),this.heatMapSel=(0,T.ut)("select",{styles:{maxWidth:"150px"}},n),this.ds.dataStore.getColumnList("text").forEach((t=>(0,T.ut)("option",{value:t.field,text:t.name},this.heatMapSel))),(0,T.ut)("button",{classes:["ciview-button-sm"],text:"Add All"},this.columns[1]).addEventListener("click",(t=>{this.parseNames()})),this.cm.addListener(this.rn,((t,e,n)=>{switch(t){case"chart_added":this._addColorChartOption(n);break;case"chart_removed":this._addColorChartOption(n,!0);break;case"filtered":console.log("ss");break;case"view_laoded":this.close()}})),this.itemList=[];const i=this.ds_to.dataStore;i.addListener(this.rn,((t,e)=>{if("data_highlighted"===t){const t=e.indexes.length;if(1==t){const t=e.indexes[0],n=i.getRowText(t,this.link.name_column);this.ac.setSelectedItem({value:n,index:t})}else this.ta.value=t<200?e.indexes.map((t=>i.getRowText(t,this.link.name_column))).join("\n"):"Too many items selected"}else"filtered"===t&&(i.filterSize<500&&i.isFiltered()?this.ta.value=i.getFilteredValues(this.link.name_column).join("\n"):this.ta.value="Too many items selected")}))}))}addFilteredItems(){const t=this.ds_to.dataStore;for(let e=0;e<t.size;e++)0===t.filterArray[e]&&(this.itemList.push(e),(0,T.ut)("div",{text:t.getRowText(e,this.link.name_column)},this.columns[1]))}close(){this.cm.removeListener(this.rn),this.ds_to.dataStore.removeListener(this.rn),this.ac.destroy(),super.close()}_addColorChartOption(t,e=!1){const n=t.config;if(t.dataStore===this.ds.dataStore&&t.getColorOptions().colorby){if(e){const t=this.colorChartSelect.querySelector(`[value='${n.id}']`);return t&&t.remove(),void(0===this.colorChartSelect.children.length&&this.colorDiv.classList.add("mdv-disabled"))}(0,T.ut)("option",{value:n.id,text:n.title},this.colorChartSelect),this.colorDiv.classList.remove("mdv-disabled")}}_addOptionsSection(){this.colorDiv=(0,T.ut)("div",{classes:["mdv-section","mdv-disabled"]},this.columns[0]),this.colorCheck=(0,T.ut)("input",{type:"checkbox"},this.colorDiv),(0,T.ut)("span",{text:"Color Chart:",styles:{marginRight:"4px"}},this.colorDiv),(0,T.ut)("br",{},this.colorDiv),this.colorChartSelect=(0,T.ut)("select",{styles:{maxWidth:"150px"}},this.colorDiv);for(let t in this.cm.charts)this._addColorChartOption(this.cm.charts[t].chart);const t=(0,T.ut)("div",{classes:["mdv-section"]},this.columns[0]);this.histoCheck=(0,T.ut)("input",{type:"checkbox"},t),(0,T.ut)("span",{text:"Create Histogram:",styles:{marginRight:"4px"}},t)}parseNames(){let t=this.ta.value.replaceAll('"',"").split(/[,\s]+/);t=t.filter((t=>""!==t));const e=this.ds_to.dataStore.getColumnIndex(this.link.name_column);let n=!1;const i=new Array(t.length);for(let r=0;r<t.length;r++){const o=e[t[r]];void 0!==o?i[r]={value:t[r],index:o}:(n=!0,t[r]=t[r]+"??")}n?(this.errorDiv.textContent="Some Entries were unrecognised",this.ta.value="",this.ta.value=t.join("\n")):(this.errorDiv.textContent="",this.addColumn(i))}addColumn(t){const e=document.querySelector(`input[name='${this.rn}']:checked`).value,n=Array.isArray(t),i=n?t:[t],r=[];for(let t of i){const i=`${e}|${t.value}(${e})|${t.index}`;if(this.ds.dataStore.addColumnFromField(i),r.push(i),!n){if(this.colorCheck.checked){const t=this.colorChartSelect.value;t&&this.cm.getChart(t).colorByColumn(i)}return void(this.histoCheck.checked&&this.cm.addChart(this.ds.name,{type:"bar_chart",param:i}))}}this.addHeatMapCheck.checked&&this.cm.addChart(this.ds.name,{type:"heat_map",param:[this.heatMapSel.value].concat(r)}),this.addDotPlotCheck.checked&&this.cm.addChart(this.ds.name,{type:"dot_plot",param:[this.heatMapSel.value].concat(r)})}}const st=ot;class at extends F.v{constructor(t,e){super({footer:!0,width:500,maxHeight:500,title:"Field Colors For "+e.name,columns:2,buttons:[{text:"Apply",method:"applyColor"}]},{cm:t,ds:e})}init(t){this.cm=t.cm,this.ds=t.ds;const e=this.columns[1];this.columns[0].style.overflowY="auto";const n={whiteSpace:"nowrap",padding:"2px"},i=((0,T.ut)("div",{styles:n},e),(0,T.ut)("div",{styles:n},e));(0,T.ut)("label",{text:"Field:",styles:{width:"70px",display:"inline-block"}},i),this.columnSelect=(0,T.ut)("select",{classes:["mdv-select"],styles:{maxWidth:"150px"}},i);const r=(0,T.ut)("div",{styles:n},e);(0,T.ut)("div",{text:"Color Scheme",styles:{fontWeight:"bold"}},r),(0,T.ut)("span",{classes:["mdv-info-text"],text:"Paste list of colors (hex)"},r);const o=(0,T.ut)("div",{styles:{display:"flex",alignItems:"flex-start",marginTop:"2px"}},e);this.colorList=(0,T.ut)("textarea",{classes:["mdv-select"],styles:{width:"100px",padding:"2px",height:"150px"}},o),this.setDataSource(this.ds.dataStore.name),(0,T.ut)("button",{classes:["ciview-button-sm"],text:"Use Scheme"},o).addEventListener("click",(()=>{this.parseColors(this.colorList.value)}))}parseColors(t){const e=/^#[0-9A-F]{6}$/i;let n=t.replaceAll('"',"").split(/[,\s]+/);n=n.filter((t=>t.match(e)));const i=n.join("\n");this.colorList.value=i;let r=0;if(i.length>0)for(let t=0;t<this.colorChoosers.length;t++)this.colorChoosers[t].value=n[r],r++,r===n.length&&(r=0)}setDataSource(t){this.columnSelect.innerHTML="";const e=this.cm.getDataSource(t);this.dataSource=e,this.dsName=t;const n=e.getColumnList("text");for(let t of n)(0,T.ut)("option",{text:t.name,value:t.field},this.columnSelect);this.columnSelect.addEventListener("change",(()=>{this.setColumn(this.columnSelect.value)})),this.setColumn(n[0].field)}applyColor(){const t=new Array(this.colorChoosers.length);this.colorChoosers.forEach((e=>t[e.__index]=e.value)),this.dataSource.setColumnColors(this.column,t),this.dataSource.dataChanged([this.column],!1,!1);for(let e of this.cm.dataSources){const n=e.dataStore,i=n.syncColumnColors.find((t=>t.dataSource===this.dataSource.name));if(i){const t=i.columns.find((t=>t.link_to===this.column));t&&(this.cm._sync_colors([t],this.dataSource,n),n.dataChanged([t.col],!1,!1))}const r=n.linkColumns.find((t=>t.dataSource===this.dataSource.name));r&&-1!==r.columns.indexOf(this.column)&&(n.setColumnColors(this.column,t),n.dataChanged([this.column],!1,!1))}}setColumn(t){const e=this.columns[0];this.column=t,e.innerHTML="";const n=this.dataSource.getColumnValues(t),i=n.slice(0).sort(),r=this.dataSource.getColumnColors(t),o=r.map(((t,e)=>{const o=n.indexOf(i[e]);return{index:o,color:r[o]}}));this.colorChoosers=[];for(let t=0;t<i.length;t++){const n=(0,T.ut)("div",{styles:{display:"flex",flexWrap:"nowrap"}},e);(0,T.ut)("span",{styles:{display:"inline-block",fontSize:"0.8erm"},classes:["mdv-flex-dynamic"],text:i[t]},n);const r=(0,T.ut)("input",{classes:["mdv-flex-fixed"],styles:{width:"25px",height:"20px",padding:"0px"},type:"color",value:o[t].color},n);r.__index=o[t].index,this.colorChoosers.push(r)}}}const lt=at;var ct=__webpack_require__(9863),ut={};ut.styleTagTransform=h(),ut.setAttributes=a(),ut.insert=o().bind(null,"head"),ut.domAPI=i(),ut.insertStyleElement=c(),e()(ct.Z,ut),ct.Z&&ct.Z.locals&&ct.Z.locals;var ht=__webpack_require__(5929);class dt{cellHeight=150;cellApproxWidth=300;grids;dragHandle=".ciview-chart-title";chartManager;constructor(t){this.grids=new Map,this.chartManager=t}getGrid(t){if(!this.grids.has(t)){const e=t.contentDiv;e.classList.add("grid-stack");const n=e.getBoundingClientRect(),i=Math.round(n.width/this.cellApproxWidth);console.log(i);const r=Math.round(n.height/this.cellHeight);this.cellHeight=n.height/r,console.log("gridstack cellHeight",this.cellHeight);const o=ht.GridStack.init({cellHeight:this.cellHeight,handle:this.dragHandle,float:!0,oneColumnSize:400},e);o.on("resizestop",((t,e)=>{e instanceof HTMLElement&&(e.style.filter="")})),o.on("resizestart",((t,e)=>{e instanceof HTMLElement&&(e.style.filter="blur(1px) opacity(0.5)")}));const s=this.chartManager.addMenuIcon(t.name,"fas fa-compress-arrows-alt","compact layout",(()=>o.compact()));this.grids.set(t,{grid:o,charts:new Set,icon:s})}return this.grids.get(t)}destroy(t){this.grids.has(t)||console.error(`destroying non-existent gridstack - ${t.name}`);const e=this.grids.get(t),n=t.contentDiv,i=new Map;for(let t of e.charts){const e=t.getDiv();i.set(e,[e.offsetWidth,e.offsetHeight,e.offsetLeft,e.offsetTop]),t.removeLayout(),delete t.config.gssize,delete t.config.gsposition}e.grid.destroy(!1);for(let t of e.charts){const e=t.getDiv(),n=i.get(e);e.style.position="absolute",e.style.width=n[0]-5+"px",e.style.height=n[1]-5+"px",e.style.left=n[2]+"px",e.style.top=n[3]+"px",t.config.size=[n[0]-5,n[1]-5],t.config.position=[n[2],n[3]],e.classList.remove("grid-stack-item")}n.classList.remove("grid-stack"),e.icon.remove(),this.grids.delete(t)}getCellDimensions(t){return[this.getGrid(t).grid.cellWidth(),this.cellHeight]}manageChart(t,e,n){const i=this.getGrid(e),r=i.grid;i.charts.add(t);const o=t.getDiv(),s=o.getBoundingClientRect();let a=Math.round(s.width/r.cellWidth()),l=Math.round(s.height/this.cellHeight),c=Math.round(o.offsetLeft/r.cellWidth());c=c>11?11:c;let u=Math.floor(o.offsetTop/this.cellHeight);t.config.gsposition&&([c,u]=t.config.gsposition,[a,l]=t.config.gssize,n=!1),function(t){t.style.position="",t.style.left="",t.style.right="",t.style.top="",t.style.bottom="",t.style.width="",t.style.height=""}(o),o.style.transition="filter 0.5s ease";const h=new ResizeObserver((0,M.Ds)((()=>{try{t.setSize()}catch{}}),20));h.observe(o),r.makeWidget(o),n?r.update(o,{w:a,h:l}):(console.log({w:a,h:l,x:c,y:u}),r.update(o,{w:a,h:l,x:c,y:u}));const d=function(){const{changeBaseDocument:e}=t;return o.gridstackPopoutCallback=()=>{r.removeWidget(o,!0)},t.changeBaseDocument=n=>{e.apply(t,[n]),n===document&&console.error("changeBaseDocument should be restored to normal by the time we get here..."),r.removeWidget(o,!0),f.remove(),t.remove=p,t.changeBaseDocument=d},e}(),f=function(){let e=!1;const n=t.addMenuIcon("fas fa-unlock","lock position"),i=n.children[0];return n.addEventListener("click",(()=>{e=!e,i.classList.toggle("fa-lock",e),i.classList.toggle("fa-unlock",!e),r.update(o,{locked:e}),o.classList.toggle("gridLock",e)})),n}(),p=function(){const{remove:e}=t;return t.remove=()=>{r.removeWidget(o,!0),i.charts.delete(t),e.apply(t)},e}();t.removeLayout=()=>{r.removeWidget(o,!1),f.remove(),delete o.gridstackPopoutCallback,t.remove=p,t.changeBaseDocument=d,h.disconnect()}}}var ft=__webpack_require__(3838);const pt=t=>+t;function gt(t,e,n){t=+t,e=+e,n=(r=arguments.length)<2?(e=t,t=0,1):r<3?1:+n;for(var i=-1,r=0|Math.max(0,Math.ceil((e-t)/n)),o=new Array(r);++i<r;)o[i]=t+i*n;return o}var mt=__webpack_require__(4182);class _t extends Map{constructor(t,e=xt){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:e}}),null!=t)for(const[e,n]of t)this.set(e,n)}get(t){return super.get(bt(this,t))}has(t){return super.has(bt(this,t))}set(t,e){return super.set(yt(this,t),e)}delete(t){return super.delete(wt(this,t))}}class vt extends Set{constructor(t,e=xt){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:e}}),null!=t)for(const e of t)this.add(e)}has(t){return super.has(bt(this,t))}add(t){return super.add(yt(this,t))}delete(t){return super.delete(wt(this,t))}}function bt({_intern:t,_key:e},n){const i=e(n);return t.has(i)?t.get(i):n}function yt({_intern:t,_key:e},n){const i=e(n);return t.has(i)?t.get(i):(t.set(i,n),n)}function wt({_intern:t,_key:e},n){const i=e(n);return t.has(i)&&(n=t.get(n),t.delete(i)),n}function xt(t){return null!==t&&"object"==typeof t?t.valueOf():t}const Ct=Symbol("implicit");function kt(){var t=new _t,e=[],n=[],i=Ct;function r(r){let o=t.get(r);if(void 0===o){if(i!==Ct)return i;t.set(r,o=e.push(r)-1)}return n[o%n.length]}return r.domain=function(n){if(!arguments.length)return e.slice();e=[],t=new _t;for(const i of n)t.has(i)||t.set(i,e.push(i)-1);return r},r.range=function(t){return arguments.length?(n=Array.from(t),r):n.slice()},r.unknown=function(t){return arguments.length?(i=t,r):i},r.copy=function(){return kt(e,n).unknown(i)},mt.o.apply(r,arguments),r}function Et(){var t,e,n=kt().unknown(void 0),i=n.domain,r=n.range,o=0,s=1,a=!1,l=0,c=0,u=.5;function h(){var n=i().length,h=s<o,d=h?s:o,f=h?o:s;t=(f-d)/Math.max(1,n-l+2*c),a&&(t=Math.floor(t)),d+=(f-d-t*(n-l))*u,e=t*(1-l),a&&(d=Math.round(d),e=Math.round(e));var p=gt(n).map((function(e){return d+t*e}));return r(h?p.reverse():p)}return delete n.unknown,n.domain=function(t){return arguments.length?(i(t),h()):i()},n.range=function(t){return arguments.length?([o,s]=t,o=+o,s=+s,h()):[o,s]},n.rangeRound=function(t){return[o,s]=t,o=+o,s=+s,a=!0,h()},n.bandwidth=function(){return e},n.step=function(){return t},n.round=function(t){return arguments.length?(a=!!t,h()):a},n.padding=function(t){return arguments.length?(l=Math.min(1,c=+t),h()):l},n.paddingInner=function(t){return arguments.length?(l=Math.min(1,t),h()):l},n.paddingOuter=function(t){return arguments.length?(c=+t,h()):c},n.align=function(t){return arguments.length?(u=Math.max(0,Math.min(1,t)),h()):u},n.copy=function(){return Et(i(),[o,s]).round(a).paddingInner(l).paddingOuter(c).align(u)},mt.o.apply(h(),arguments)}var St=__webpack_require__(1031),At=__webpack_require__(2533),Tt={value:()=>{}};function Mt(){for(var t,e=0,n=arguments.length,i={};e<n;++e){if(!(t=arguments[e]+"")||t in i||/[\s.]/.test(t))throw new Error("illegal type: "+t);i[t]=[]}return new Dt(i)}function Dt(t){this._=t}function Pt(t,e){return t.trim().split(/^|\s+/).map((function(t){var n="",i=t.indexOf(".");if(i>=0&&(n=t.slice(i+1),t=t.slice(0,i)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}}))}function Lt(t,e){for(var n,i=0,r=t.length;i<r;++i)if((n=t[i]).name===e)return n.value}function Rt(t,e,n){for(var i=0,r=t.length;i<r;++i)if(t[i].name===e){t[i]=Tt,t=t.slice(0,i).concat(t.slice(i+1));break}return null!=n&&t.push({name:e,value:n}),t}Dt.prototype=Mt.prototype={constructor:Dt,on:function(t,e){var n,i=this._,r=Pt(t+"",i),o=-1,s=r.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++o<s;)if(n=(t=r[o]).type)i[n]=Rt(i[n],t.name,e);else if(null==e)for(n in i)i[n]=Rt(i[n],t.name,null);return this}for(;++o<s;)if((n=(t=r[o]).type)&&(n=Lt(i[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Dt(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,i,r=new Array(n),o=0;o<n;++o)r[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=0,n=(i=this._[t]).length;o<n;++o)i[o].value.apply(e,r)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],r=0,o=i.length;r<o;++r)i[r].value.apply(e,n)}};const It=Mt;var Ot,zt,Ft=0,Bt=0,Nt=0,jt=0,Ut=0,Vt=0,Wt="object"==typeof performance&&performance.now?performance:Date,Ht="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function $t(){return Ut||(Ht(Zt),Ut=Wt.now()+Vt)}function Zt(){Ut=0}function qt(){this._call=this._time=this._next=null}function Gt(t,e,n){var i=new qt;return i.restart(t,e,n),i}function Kt(){Ut=(jt=Wt.now())+Vt,Ft=Bt=0;try{!function(){$t(),++Ft;for(var t,e=Ot;e;)(t=Ut-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Ft}()}finally{Ft=0,function(){for(var t,e,n=Ot,i=1/0;n;)n._call?(i>n._time&&(i=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:Ot=e);zt=t,Yt(i)}(),Ut=0}}function Xt(){var t=Wt.now(),e=t-jt;e>1e3&&(Vt-=e,jt=t)}function Yt(t){Ft||(Bt&&(Bt=clearTimeout(Bt)),t-Ut>24?(t<1/0&&(Bt=setTimeout(Kt,t-Wt.now()-Vt)),Nt&&(Nt=clearInterval(Nt))):(Nt||(jt=Wt.now(),Nt=setInterval(Xt,1e3)),Ft=1,Ht(Kt)))}function Qt(t,e,n){var i=new qt;return e=null==e?0:+e,i.restart((n=>{i.stop(),t(n+e)}),e,n),i}qt.prototype=Gt.prototype={constructor:qt,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?$t():+n)+(null==e?0:+e),this._next||zt===this||(zt?zt._next=this:Ot=this,zt=this),this._call=t,this._time=n,Yt()},stop:function(){this._call&&(this._call=null,this._time=1/0,Yt())}};var Jt=It("start","end","cancel","interrupt"),te=[];function ee(t,e,n,i,r,o){var s=t.__transition;if(s){if(n in s)return}else t.__transition={};!function(t,e,n){var i,r=t.__transition;function o(l){var c,u,h,d;if(1!==n.state)return a();for(c in r)if((d=r[c]).name===n.name){if(3===d.state)return Qt(o);4===d.state?(d.state=6,d.timer.stop(),d.on.call("interrupt",t,t.__data__,d.index,d.group),delete r[c]):+c<e&&(d.state=6,d.timer.stop(),d.on.call("cancel",t,t.__data__,d.index,d.group),delete r[c])}if(Qt((function(){3===n.state&&(n.state=4,n.timer.restart(s,n.delay,n.time),s(l))})),n.state=2,n.on.call("start",t,t.__data__,n.index,n.group),2===n.state){for(n.state=3,i=new Array(h=n.tween.length),c=0,u=-1;c<h;++c)(d=n.tween[c].value.call(t,t.__data__,n.index,n.group))&&(i[++u]=d);i.length=u+1}}function s(e){for(var r=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(a),n.state=5,1),o=-1,s=i.length;++o<s;)i[o].call(t,r);5===n.state&&(n.on.call("end",t,t.__data__,n.index,n.group),a())}function a(){for(var i in n.state=6,n.timer.stop(),delete r[e],r)return;delete t.__transition}r[e]=n,n.timer=Gt((function(t){n.state=1,n.timer.restart(o,n.delay,n.time),n.delay<=t&&o(t-n.delay)}),0,n.time)}(t,n,{name:e,index:i,group:r,on:Jt,tween:te,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:0})}function ne(t,e){var n=re(t,e);if(n.state>0)throw new Error("too late; already scheduled");return n}function ie(t,e){var n=re(t,e);if(n.state>3)throw new Error("too late; already running");return n}function re(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function oe(t,e){var n,i,r,o=t.__transition,s=!0;if(o){for(r in e=null==e?null:e+"",o)(n=o[r]).name===e?(i=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(i?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete o[r]):s=!1;s&&delete t.__transition}}var se,ae=__webpack_require__(8063),le=180/Math.PI,ce={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function ue(t,e,n,i,r,o){var s,a,l;return(s=Math.sqrt(t*t+e*e))&&(t/=s,e/=s),(l=t*n+e*i)&&(n-=t*l,i-=e*l),(a=Math.sqrt(n*n+i*i))&&(n/=a,i/=a,l/=a),t*i<e*n&&(t=-t,e=-e,l=-l,s=-s),{translateX:r,translateY:o,rotate:Math.atan2(e,t)*le,skewX:Math.atan(l)*le,scaleX:s,scaleY:a}}function he(t,e,n,i){function r(t){return t.length?t.pop()+" ":""}return function(o,s){var a=[],l=[];return o=t(o),s=t(s),function(t,i,r,o,s,a){if(t!==r||i!==o){var l=s.push("translate(",null,e,null,n);a.push({i:l-4,x:(0,ae.Z)(t,r)},{i:l-2,x:(0,ae.Z)(i,o)})}else(r||o)&&s.push("translate("+r+e+o+n)}(o.translateX,o.translateY,s.translateX,s.translateY,a,l),function(t,e,n,o){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),o.push({i:n.push(r(n)+"rotate(",null,i)-2,x:(0,ae.Z)(t,e)})):e&&n.push(r(n)+"rotate("+e+i)}(o.rotate,s.rotate,a,l),function(t,e,n,o){t!==e?o.push({i:n.push(r(n)+"skewX(",null,i)-2,x:(0,ae.Z)(t,e)}):e&&n.push(r(n)+"skewX("+e+i)}(o.skewX,s.skewX,a,l),function(t,e,n,i,o,s){if(t!==n||e!==i){var a=o.push(r(o)+"scale(",null,",",null,")");s.push({i:a-4,x:(0,ae.Z)(t,n)},{i:a-2,x:(0,ae.Z)(e,i)})}else 1===n&&1===i||o.push(r(o)+"scale("+n+","+i+")")}(o.scaleX,o.scaleY,s.scaleX,s.scaleY,a,l),o=s=null,function(t){for(var e,n=-1,i=l.length;++n<i;)a[(e=l[n]).i]=e.x(t);return a.join("")}}}var de=he((function(t){const e=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?ce:ue(e.a,e.b,e.c,e.d,e.e,e.f)}),"px, ","px)","deg)"),fe=he((function(t){return null==t?ce:(se||(se=document.createElementNS("http://www.w3.org/2000/svg","g")),se.setAttribute("transform",t),(t=se.transform.baseVal.consolidate())?ue((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):ce)}),", ",")",")"),pe=__webpack_require__(1663);function ge(t,e){var n,i;return function(){var r=ie(this,t),o=r.tween;if(o!==n)for(var s=0,a=(i=n=o).length;s<a;++s)if(i[s].name===e){(i=i.slice()).splice(s,1);break}r.tween=i}}function me(t,e,n){var i,r;if("function"!=typeof n)throw new Error;return function(){var o=ie(this,t),s=o.tween;if(s!==i){r=(i=s).slice();for(var a={name:e,value:n},l=0,c=r.length;l<c;++l)if(r[l].name===e){r[l]=a;break}l===c&&r.push(a)}o.tween=r}}function _e(t,e,n){var i=t._id;return t.each((function(){var t=ie(this,i);(t.value||(t.value={}))[e]=n.apply(this,arguments)})),function(t){return re(t,i).value[e]}}var ve=__webpack_require__(8849),be=__webpack_require__(187),ye=__webpack_require__(6773);function we(t,e){var n;return("number"==typeof e?ae.Z:e instanceof ve.ZP?be.ZP:(n=(0,ve.ZP)(e))?(e=n,be.ZP):ye.Z)(t,e)}function xe(t){return function(){this.removeAttribute(t)}}function Ce(t){return function(){this.removeAttributeNS(t.space,t.local)}}function ke(t,e,n){var i,r,o=n+"";return function(){var s=this.getAttribute(t);return s===o?null:s===i?r:r=e(i=s,n)}}function Ee(t,e,n){var i,r,o=n+"";return function(){var s=this.getAttributeNS(t.space,t.local);return s===o?null:s===i?r:r=e(i=s,n)}}function Se(t,e,n){var i,r,o;return function(){var s,a,l=n(this);if(null!=l)return(s=this.getAttribute(t))===(a=l+"")?null:s===i&&a===r?o:(r=a,o=e(i=s,l));this.removeAttribute(t)}}function Ae(t,e,n){var i,r,o;return function(){var s,a,l=n(this);if(null!=l)return(s=this.getAttributeNS(t.space,t.local))===(a=l+"")?null:s===i&&a===r?o:(r=a,o=e(i=s,l));this.removeAttributeNS(t.space,t.local)}}function Te(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function Me(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function De(t,e){var n,i;function r(){var r=e.apply(this,arguments);return r!==i&&(n=(i=r)&&Me(t,r)),n}return r._value=e,r}function Pe(t,e){var n,i;function r(){var r=e.apply(this,arguments);return r!==i&&(n=(i=r)&&Te(t,r)),n}return r._value=e,r}function Le(t,e){return function(){ne(this,t).delay=+e.apply(this,arguments)}}function Re(t,e){return e=+e,function(){ne(this,t).delay=e}}function Ie(t,e){return function(){ie(this,t).duration=+e.apply(this,arguments)}}function Oe(t,e){return e=+e,function(){ie(this,t).duration=e}}function ze(t,e){if("function"!=typeof e)throw new Error;return function(){ie(this,t).ease=e}}var Fe=__webpack_require__(4421);function Be(t,e,n){var i,r,o=function(t){return(t+"").trim().split(/^|\s+/).every((function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t}))}(e)?ne:ie;return function(){var s=o(this,t),a=s.on;a!==i&&(r=(i=a).copy()).on(e,n),s.on=r}}var Ne=__webpack_require__(3010),je=__webpack_require__(9701),Ue=At.ZP.prototype.constructor,Ve=__webpack_require__(2627);function We(t){return function(){this.style.removeProperty(t)}}function He(t,e,n){return function(i){this.style.setProperty(t,e.call(this,i),n)}}function $e(t,e,n){var i,r;function o(){var o=e.apply(this,arguments);return o!==r&&(i=(r=o)&&He(t,o,n)),i}return o._value=e,o}function Ze(t){return function(e){this.textContent=t.call(this,e)}}function qe(t){var e,n;function i(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&Ze(i)),e}return i._value=t,i}var Ge=0;function Ke(t,e,n,i){this._groups=t,this._parents=e,this._name=n,this._id=i}function Xe(){return++Ge}var Ye=At.ZP.prototype;Ke.prototype=function(t){return(0,At.ZP)().transition(t)}.prototype={constructor:Ke,select:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=(0,Ne.Z)(t));for(var i=this._groups,r=i.length,o=new Array(r),s=0;s<r;++s)for(var a,l,c=i[s],u=c.length,h=o[s]=new Array(u),d=0;d<u;++d)(a=c[d])&&(l=t.call(a,a.__data__,d,c))&&("__data__"in a&&(l.__data__=a.__data__),h[d]=l,ee(h[d],e,n,d,h,re(a,n)));return new Ke(o,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=(0,je.Z)(t));for(var i=this._groups,r=i.length,o=[],s=[],a=0;a<r;++a)for(var l,c=i[a],u=c.length,h=0;h<u;++h)if(l=c[h]){for(var d,f=t.call(l,l.__data__,h,c),p=re(l,n),g=0,m=f.length;g<m;++g)(d=f[g])&&ee(d,e,n,g,f,p);o.push(f),s.push(l)}return new Ke(o,s,e,n)},selectChild:Ye.selectChild,selectChildren:Ye.selectChildren,filter:function(t){"function"!=typeof t&&(t=(0,Fe.Z)(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var o,s=e[r],a=s.length,l=i[r]=[],c=0;c<a;++c)(o=s[c])&&t.call(o,o.__data__,c,s)&&l.push(o);return new Ke(i,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,i=e.length,r=n.length,o=Math.min(i,r),s=new Array(i),a=0;a<o;++a)for(var l,c=e[a],u=n[a],h=c.length,d=s[a]=new Array(h),f=0;f<h;++f)(l=c[f]||u[f])&&(d[f]=l);for(;a<i;++a)s[a]=e[a];return new Ke(s,this._parents,this._name,this._id)},selection:function(){return new Ue(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=Xe(),i=this._groups,r=i.length,o=0;o<r;++o)for(var s,a=i[o],l=a.length,c=0;c<l;++c)if(s=a[c]){var u=re(s,e);ee(s,t,n,c,a,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new Ke(i,this._parents,t,n)},call:Ye.call,nodes:Ye.nodes,node:Ye.node,size:Ye.size,empty:Ye.empty,each:Ye.each,on:function(t,e){var n=this._id;return arguments.length<2?re(this.node(),n).on.on(t):this.each(Be(n,t,e))},attr:function(t,e){var n=(0,pe.Z)(t),i="transform"===n?fe:we;return this.attrTween(t,"function"==typeof e?(n.local?Ae:Se)(n,i,_e(this,"attr."+t,e)):null==e?(n.local?Ce:xe)(n):(n.local?Ee:ke)(n,i,e))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;var i=(0,pe.Z)(t);return this.tween(n,(i.local?De:Pe)(i,e))},style:function(t,e,n){var i="transform"==(t+="")?de:we;return null==e?this.styleTween(t,function(t,e){var n,i,r;return function(){var o=(0,Ve.S)(this,t),s=(this.style.removeProperty(t),(0,Ve.S)(this,t));return o===s?null:o===n&&s===i?r:r=e(n=o,i=s)}}(t,i)).on("end.style."+t,We(t)):"function"==typeof e?this.styleTween(t,function(t,e,n){var i,r,o;return function(){var s=(0,Ve.S)(this,t),a=n(this),l=a+"";return null==a&&(this.style.removeProperty(t),l=a=(0,Ve.S)(this,t)),s===l?null:s===i&&l===r?o:(r=l,o=e(i=s,a))}}(t,i,_e(this,"style."+t,e))).each(function(t,e){var n,i,r,o,s="style."+e,a="end."+s;return function(){var l=ie(this,t),c=l.on,u=null==l.value[s]?o||(o=We(e)):void 0;c===n&&r===u||(i=(n=c).copy()).on(a,r=u),l.on=i}}(this._id,t)):this.styleTween(t,function(t,e,n){var i,r,o=n+"";return function(){var s=(0,Ve.S)(this,t);return s===o?null:s===i?r:r=e(i=s,n)}}(t,i,e),n).on("end.style."+t,null)},styleTween:function(t,e,n){var i="style."+(t+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(null==e)return this.tween(i,null);if("function"!=typeof e)throw new Error;return this.tween(i,$e(t,e,null==n?"":n))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(_e(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,qe(t))},remove:function(){return this.on("end.remove",function(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}(this._id))},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var i,r=re(this.node(),n).tween,o=0,s=r.length;o<s;++o)if((i=r[o]).name===t)return i.value;return null}return this.each((null==e?ge:me)(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?Le:Re)(e,t)):re(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?Ie:Oe)(e,t)):re(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(ze(e,t)):re(this.node(),e).ease},easeVarying:function(t){if("function"!=typeof t)throw new Error;return this.each(function(t,e){return function(){var n=e.apply(this,arguments);if("function"!=typeof n)throw new Error;ie(this,t).ease=n}}(this._id,t))},end:function(){var t,e,n=this,i=n._id,r=n.size();return new Promise((function(o,s){var a={value:s},l={value:function(){0==--r&&o()}};n.each((function(){var n=ie(this,i),r=n.on;r!==t&&((e=(t=r).copy())._.cancel.push(a),e._.interrupt.push(a),e._.end.push(l)),n.on=e})),0===r&&o()}))},[Symbol.iterator]:Ye[Symbol.iterator]};var Qe={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function Je(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}At.ZP.prototype.interrupt=function(t){return this.each((function(){oe(this,t)}))},At.ZP.prototype.transition=function(t){var e,n;t instanceof Ke?(e=t._id,t=t._name):(e=Xe(),(n=Qe).time=$t(),t=null==t?null:t+"");for(var i=this._groups,r=i.length,o=0;o<r;++o)for(var s,a=i[o],l=a.length,c=0;c<l;++c)(s=a[c])&&ee(s,t,e,c,a,n||Je(s,e));return new Ke(i,this._parents,t,e)};var tn=__webpack_require__(4752);function en(t,e){return t.parent===e.parent?1:2}function nn(t,e){return t+e.x}function rn(t,e){return Math.max(t,e.y)}function on(){var t=en,e=1,n=1,i=!1;function r(r){var o,s=0;r.eachAfter((function(e){var n=e.children;n?(e.x=function(t){return t.reduce(nn,0)/t.length}(n),e.y=function(t){return 1+t.reduce(rn,0)}(n)):(e.x=o?s+=t(e,o):0,e.y=0,o=e)}));var a=function(t){for(var e;e=t.children;)t=e[0];return t}(r),l=function(t){for(var e;e=t.children;)t=e[e.length-1];return t}(r),c=a.x-t(a,l)/2,u=l.x+t(l,a)/2;return r.eachAfter(i?function(t){t.x=(t.x-r.x)*e,t.y=(r.y-t.y)*n}:function(t){t.x=(t.x-c)/(u-c)*e,t.y=(1-(r.y?t.y/r.y:1))*n})}return r.separation=function(e){return arguments.length?(t=e,r):t},r.size=function(t){return arguments.length?(i=!1,e=+t[0],n=+t[1],r):i?null:[e,n]},r.nodeSize=function(t){return arguments.length?(i=!0,e=+t[0],n=+t[1],r):i?[e,n]:null},r}const sn=class extends I{constructor(t,e,n,i={}){super(t,e,n),this.svg=(0,ft.Z)(this.contentDiv).append("svg").attr("width",this.width).attr("height",this.height),this.config.axis=this.config.axis||{};const r=this.config.axis;function o(t,e,n){null==t[e]&&(t[e]=n)}for(let t of[["x",25],["y",40],["ry",25],["tx",25]]){const e=i[t[0]];if(e){r[t[0]]=r[t[0]]||{};const n=r[t[0]];o(n,"textSize",13),o(n,"label",""),o(n,"size",e.size||t[1]),o(n,"tickfont",10)}}this._setMargins(),this.graph_area=this.svg.append("g").attr("transform",`translate(${this.margins.left},${this.margins.top})`),this.ry_axis_svg=this.svg.append("g"),this.tx_axis_svg=this.svg.append("g"),this.x_axis_svg=this.svg.append("g"),this.y_axis_svg=this.svg.append("g");const s=i.x;s&&(s.custom||(this.x_scale="band"===s.type?Et():(0,St.Z)(),this.x_axis_call=(0,tn.LL)(this.x_scale)),this.x_axis_label=this.x_axis_svg.append("text").style("text-anchor","middle").style("fill","black").attr("alignment-baseline","auto"));const a=i.y;a&&(a.custom||(this.y_scale="band"===a.type?Et():(0,St.Z)(),this.y_axis_call=(0,tn.y4)(this.y_scale)),this.y_axis_label=this.y_axis_svg.append("text").attr("text-anchor","middle").style("fill","black").attr("alignment-baseline","auto"));const l=i.ry;l&&l.label&&(this.ry_axis_label=this.ry_axis_svg.append("text").attr("text-anchor","middle").style("fill","black").attr("alignment-baseline","text-top"))}_setMargins(){const t=this.config.axis;this.margins={top:t.tx?t.tx.size:10,right:t.ry?t.ry.size:10,bottom:t.x?t.x.size:10,left:t.y?t.y.size:10}}_getContentDimensions(){return{top:this.margins.top,left:this.margins.left,height:this.height-this.margins.bottom-this.margins.top,width:this.width-this.margins.left-this.margins.right}}setAxisSize(t,e){switch(t){case"tx":this.margins.top=e;break;case"ry":this.config.axis.ry.size=e,this.margins.right=e;break;case"y":this.config.axis.y.size=e,this.margins.left=e;break;case"x":this.config.axis.x.size=e,this.margins.bottom=e}this.graph_area.attr("transform",`translate(${this.margins.left},${this.margins.top})`)}updateAxis(){const t=this._getContentDimensions(),e=this.config.axis;if(this.ry_axis_svg.attr("transform",`translate(${t.left+t.width},${t.top})`),this.tx_axis_svg.attr("transform",`translate(${t.left},0)`),this.x_axis_svg.attr("transform",`translate(${t.left},${this.height-this.margins.bottom})`),this.y_axis_svg.attr("transform",`translate(${t.left},${t.top})`),e.x&&(this.x_scale&&(this.x_scale.range([0,t.width]),this.x_axis_svg.selectAll(".tick text").attr("font-family","Helvetica"),this.x_axis_svg.transition().call(this.x_axis_call),e.x.rotate_labels?this.x_axis_svg.selectAll(".tick text").style("text-anchor","end").attr("dx","-.8em").attr("dy",".10em").attr("transform","rotate(-45)"):this.x_axis_svg.selectAll(".tick text").style("text-anchor",null).attr("dx",null).attr("dy",".71em").attr("transform",null),this.x_axis_svg.selectAll(".tick text").attr("font-size",e.x.tickfont)),this.x_axis_label.attr("x",t.width/2).attr("y",this.margins.bottom-4).text(this.config.axis.x.label).attr("font-size",this.config.axis.x.textsize+"px").attr("font-family","Helvetica")),e.y){if(this.y_scale){if(this.y_scale.range([0,t.height]),t.height/this.y_scale.domain().length<8){const e=Math.round(this.y_scale.domain().length/(t.height/10));this.y_axis_call.tickFormat(((t,n)=>n%e==0?t:""))}else this.y_axis_call.tickFormat(null);this.y_axis_svg.transition().call(this.y_axis_call),e.y.rotate_labels?this.y_axis_svg.selectAll(".tick text").style("text-anchor","end").attr("dy","1em").attr("transform","rotate(+45)"):this.y_axis_svg.selectAll(".tick text").style("text-anchor",null).attr("dx",null).attr("dy","0.32em").attr("transform",null),this.y_axis_svg.selectAll(".tick text").attr("font-size",e.y.tickfont).attr("font-family","Helvetica")}this.y_axis_label.attr("x",-t.height/2).attr("y",10-t.left).attr("transform","rotate(-90)").text(this.config.axis.y.label).attr("font-size",this.config.axis.y.textsize+"px").attr("font-family","Helvetica")}this.ry_axis_label&&this.ry_axis_label.attr("x",t.height/2).attr("y",15-this.margins.right).attr("transform","rotate(90)").text(this.config.axis.ry.label).attr("font-size",this.config.axis.ry.textsize+"px")}setSize(t,e){super.setSize(t,e),this.svg&&this.svg.attr("width",this.width).attr("height",this.height)}drawXTree(t,e,n,i){(0,ft.Z)(this.contentDiv).transition().duration(400).ease(pt);const r=this._getContentDimensions(),o=on().size([r.width,n])(t).descendants(),s=r.width/e;for(let t of o)t.children||(t.x=s/2+s*t.data.order);for(let t of o)if(!t.children){let e=t.parent;for(;e;)e.x=e.children[0].x+(e.children[1].x-e.children[0].x)/2,e=e.parent}this.tx_axis_svg.selectAll(".tree-link").data(o.slice(1)).join("path").attr("class","tree-link").style("stroke","currentColor").style("fill","none").style("stroke-width","1px").transition("trans").attr("d",(t=>{let e=t.x;return t.children||(e=s/2+s*t.data.order),`M ${e} ${t.y+i} L${e} ${t.parent.y+i} L${t.parent.x} ${t.parent.y+i}`}))}drawYTree(t,e){(0,ft.Z)(this.contentDiv).transition().duration(400).ease(pt);const n=this._getContentDimensions(),i=this.margins.right,r=on().size([n.height,i])(t).descendants(),o=n.height/e;for(let t of r)t.children||(t.x=o/2+o*t.data.order);for(let t of r)if(!t.children){let e=t.parent;for(;e;)e.x=e.children[0].x+(e.children[1].x-e.children[0].x)/2,e=e.parent}this.ry_axis_svg.selectAll(".tree-link").data(r.slice(1)).join("path").attr("class","tree-link").style("stroke","currentColor").style("fill","none").style("stroke-width","1px").transition("trans").attr("d",(t=>{let e=t.x;return t.children||(e=o/2+o*t.data.order),`M ${i-t.y} ${e} L${i-t.parent.y} ${e} L${i-t.parent.y} ${t.parent.x}`}))}getSettings(){const t=super.getSettings(),e=this.config;let n=[];return this.config.axis.y&&(n=n.concat([{type:"check",current_value:e.axis.y.rotate_labels,label:"Rotate Y axis labels",func:t=>{e.axis.y.rotate_labels=t,this.setSize()}},{type:"slider",max:20,min:4,step:1,doc:this.__doc__,current_value:e.axis.y.tickfont,label:"Y axis text size",func:t=>{e.axis.y.tickfont=t,this.setSize()}},{type:"slider",max:200,min:20,step:1,doc:this.__doc__,current_value:e.axis.y.size,label:"Y axis width",func:t=>{this.setAxisSize("y",t),this.setSize()}}])),this.config.axis.x&&(n=n.concat([{type:"check",current_value:e.axis.x.rotate_labels,label:"Rotate X axis labels",func:t=>{e.axis.x.rotate_labels=t,this.updateAxis()}},{type:"slider",max:20,min:4,step:1,doc:this.__doc__,current_value:e.axis.x.tickfont,label:"X axis text size",func:t=>{e.axis.x.tickfont=t,this.setSize()}},{type:"slider",max:200,min:20,step:1,doc:this.__doc__,current_value:e.axis.x.size,label:"X axis Height",func:t=>{this.setAxisSize("x",t),this.setSize()}}]),this.config.axis.ry&&(n=n.concat([{type:"slider",max:200,min:20,step:1,doc:this.__doc__,current_value:e.axis.x.size,label:"Right Y Axis size",func:t=>{this.setAxisSize("ry",t),this.setSize()}}]))),t.concat(n)}_addLegendToSVG(t){const e=this[t];if(!e)return;const n=[e.offsetLeft,e.offsetTop];e._leg=e.querySelector("g"),e._leg_g=(0,ft.Z)(e._leg).attr("transform",`translate(${n[0]},${n[1]})`),this.svg.node().append(e._leg_g.node())}_removeLegendFromSVG(t){const e=this[t];e&&(e._leg_g.attr("transform","translate(0,0)"),this.legend.querySelector("svg").append(e._leg),delete this.legend._leg,delete this.legend._leg_g)}getImage(t,e){this.addToImage&&this.addToImage(),this._addLegendToSVG("legend"),this.extra_legends&&this.extra_legends.forEach((t=>this._addLegendToSVG(t)));const n=(new XMLSerializer).serializeToString(this.svg.node());"png"===e?this.getImageFromSVG(this.svg.node(),(e=>{t(e),this.removeFromImage&&this.removeFromImage(),this._removeLegendFromSVG("legend"),this.extra_legends&&this.extra_legends.forEach((t=>this._removeLegendFromSVG(t)))})):(t(n),this.removeFromImage&&this.removeFromImage(),this._removeLegendFromSVG("legend"),this.extra_legends&&this.extra_legends.forEach((t=>this._removeLegendFromSVG(t))))}},an={passive:!1},ln={capture:!0,passive:!1};function cn(t){t.stopImmediatePropagation()}function un(t){t.preventDefault(),t.stopImmediatePropagation()}function hn(t){var e=t.document.documentElement,n=(0,ft.Z)(t).on("dragstart.drag",un,ln);"onselectstart"in e?n.on("selectstart.drag",un,ln):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function dn(t,e){var n=t.document.documentElement,i=(0,ft.Z)(t).on("dragstart.drag",null);e&&(i.on("click.drag",un,ln),setTimeout((function(){i.on("click.drag",null)}),0)),"onselectstart"in n?i.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}var fn=__webpack_require__(9487);function pn(t,e){if(t=function(t){let e;for(;e=t.sourceEvent;)t=e;return t}(t),void 0===e&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var i=n.createSVGPoint();return i.x=t.clientX,i.y=t.clientY,[(i=i.matrixTransform(e.getScreenCTM().inverse())).x,i.y]}if(e.getBoundingClientRect){var r=e.getBoundingClientRect();return[t.clientX-r.left-e.clientLeft,t.clientY-r.top-e.clientTop]}}return[t.pageX,t.pageY]}const gn=t=>()=>t;function mn(t,{sourceEvent:e,target:n,selection:i,mode:r,dispatch:o}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},selection:{value:i,enumerable:!0,configurable:!0},mode:{value:r,enumerable:!0,configurable:!0},_:{value:o}})}function _n(t){t.stopImmediatePropagation()}function vn(t){t.preventDefault(),t.stopImmediatePropagation()}var bn={name:"drag"},yn={name:"space"},wn={name:"handle"},xn={name:"center"};const{abs:Cn,max:kn,min:En}=Math;function Sn(t){return[+t[0],+t[1]]}function An(t){return[Sn(t[0]),Sn(t[1])]}var Tn={name:"x",handles:["w","e"].map(On),input:function(t,e){return null==t?null:[[+t[0],e[0][1]],[+t[1],e[1][1]]]},output:function(t){return t&&[t[0][0],t[1][0]]}},Mn={name:"y",handles:["n","s"].map(On),input:function(t,e){return null==t?null:[[e[0][0],+t[0]],[e[1][0],+t[1]]]},output:function(t){return t&&[t[0][1],t[1][1]]}},Dn=(["n","w","e","s","nw","ne","sw","se"].map(On),{overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"}),Pn={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},Ln={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},Rn={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},In={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1};function On(t){return{type:t}}function zn(t){return!t.ctrlKey&&!t.button}function Fn(){var t=this.ownerSVGElement||this;return t.hasAttribute("viewBox")?[[(t=t.viewBox.baseVal).x,t.y],[t.x+t.width,t.y+t.height]]:[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]}function Bn(){return navigator.maxTouchPoints||"ontouchstart"in this}function Nn(t){for(;!t.__brush;)if(!(t=t.parentNode))return;return t.__brush}function jn(t){return t[0][0]===t[1][0]||t[0][1]===t[1][1]}I.types.bar_chart={name:"Histogram",class:class extends sn{constructor(t,e,n){Array.isArray(n.param)&&(n.param=n.param[0]);const i=t.getColumnName(n.param);n.axis||(n.axis={x:{size:30,label:i,textsize:13},y:{size:45,label:"frequency",textsize:13}}),n.title||(n.title=i),super(t,e,n,{x:{},y:{}});const r=this.config;r.type="bar_chart";const o=this.dataStore.getMinMaxForColumn(n.param);this._setConfigValue(r,"display_max",o[1]),this._setConfigValue(r,"display_min",o[0]),this._setConfigValue(r,"bin_number",10),this.brush=function(t){var e,n=Fn,i=zn,r=Bn,o=!0,s=It("start","brush","end"),a=6;function l(e){var n=e.property("__brush",g).selectAll(".overlay").data([On("overlay")]);n.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",Dn.overlay).merge(n).each((function(){var t=Nn(this).extent;(0,ft.Z)(this).attr("x",t[0][0]).attr("y",t[0][1]).attr("width",t[1][0]-t[0][0]).attr("height",t[1][1]-t[0][1])})),e.selectAll(".selection").data([On("selection")]).enter().append("rect").attr("class","selection").attr("cursor",Dn.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var i=e.selectAll(".handle").data(t.handles,(function(t){return t.type}));i.exit().remove(),i.enter().append("rect").attr("class",(function(t){return"handle handle--"+t.type})).attr("cursor",(function(t){return Dn[t.type]})),e.each(c).attr("fill","none").attr("pointer-events","all").on("mousedown.brush",d).filter(r).on("touchstart.brush",d).on("touchmove.brush",f).on("touchend.brush touchcancel.brush",p).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function c(){var t=(0,ft.Z)(this),e=Nn(this).selection;e?(t.selectAll(".selection").style("display",null).attr("x",e[0][0]).attr("y",e[0][1]).attr("width",e[1][0]-e[0][0]).attr("height",e[1][1]-e[0][1]),t.selectAll(".handle").style("display",null).attr("x",(function(t){return"e"===t.type[t.type.length-1]?e[1][0]-a/2:e[0][0]-a/2})).attr("y",(function(t){return"s"===t.type[0]?e[1][1]-a/2:e[0][1]-a/2})).attr("width",(function(t){return"n"===t.type||"s"===t.type?e[1][0]-e[0][0]+a:a})).attr("height",(function(t){return"e"===t.type||"w"===t.type?e[1][1]-e[0][1]+a:a}))):t.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function u(t,e,n){var i=t.__brush.emitter;return!i||n&&i.clean?new h(t,e,n):i}function h(t,e,n){this.that=t,this.args=e,this.state=t.__brush,this.active=0,this.clean=n}function d(n){if((!e||n.touches)&&i.apply(this,arguments)){var r,s,a,l,h,d,f,p,g,m,_,v=this,b=n.target.__data__.type,y="selection"===(o&&n.metaKey?b="overlay":b)?bn:o&&n.altKey?xn:wn,w=t===Mn?null:Rn[b],x=t===Tn?null:In[b],C=Nn(v),k=C.extent,E=C.selection,S=k[0][0],A=k[0][1],T=k[1][0],M=k[1][1],D=0,P=0,L=w&&x&&o&&n.shiftKey,R=Array.from(n.touches||[n],(t=>{const e=t.identifier;return(t=pn(t,v)).point0=t.slice(),t.identifier=e,t}));oe(v);var I=u(v,arguments,!0).beforestart();if("overlay"===b){E&&(g=!0);const e=[R[0],R[1]||R[0]];C.selection=E=[[r=t===Mn?S:En(e[0][0],e[1][0]),a=t===Tn?A:En(e[0][1],e[1][1])],[h=t===Mn?T:kn(e[0][0],e[1][0]),f=t===Tn?M:kn(e[0][1],e[1][1])]],R.length>1&&N(n)}else r=E[0][0],a=E[0][1],h=E[1][0],f=E[1][1];s=r,l=a,d=h,p=f;var O=(0,ft.Z)(v).attr("pointer-events","none"),z=O.selectAll(".overlay").attr("cursor",Dn[b]);if(n.touches)I.moved=B,I.ended=j;else{var F=(0,ft.Z)(n.view).on("mousemove.brush",B,!0).on("mouseup.brush",j,!0);o&&F.on("keydown.brush",U,!0).on("keyup.brush",V,!0),hn(n.view)}c.call(v),I.start(n,y.name)}function B(t){for(const e of t.changedTouches||[t])for(const t of R)t.identifier===e.identifier&&(t.cur=pn(e,v));if(L&&!m&&!_&&1===R.length){const t=R[0];Cn(t.cur[0]-t[0])>Cn(t.cur[1]-t[1])?_=!0:m=!0}for(const t of R)t.cur&&(t[0]=t.cur[0],t[1]=t.cur[1]);g=!0,vn(t),N(t)}function N(t){const e=R[0],n=e.point0;var i;switch(D=e[0]-n[0],P=e[1]-n[1],y){case yn:case bn:w&&(D=kn(S-r,En(T-h,D)),s=r+D,d=h+D),x&&(P=kn(A-a,En(M-f,P)),l=a+P,p=f+P);break;case wn:R[1]?(w&&(s=kn(S,En(T,R[0][0])),d=kn(S,En(T,R[1][0])),w=1),x&&(l=kn(A,En(M,R[0][1])),p=kn(A,En(M,R[1][1])),x=1)):(w<0?(D=kn(S-r,En(T-r,D)),s=r+D,d=h):w>0&&(D=kn(S-h,En(T-h,D)),s=r,d=h+D),x<0?(P=kn(A-a,En(M-a,P)),l=a+P,p=f):x>0&&(P=kn(A-f,En(M-f,P)),l=a,p=f+P));break;case xn:w&&(s=kn(S,En(T,r-D*w)),d=kn(S,En(T,h+D*w))),x&&(l=kn(A,En(M,a-P*x)),p=kn(A,En(M,f+P*x)))}d<s&&(w*=-1,i=r,r=h,h=i,i=s,s=d,d=i,b in Pn&&z.attr("cursor",Dn[b=Pn[b]])),p<l&&(x*=-1,i=a,a=f,f=i,i=l,l=p,p=i,b in Ln&&z.attr("cursor",Dn[b=Ln[b]])),C.selection&&(E=C.selection),m&&(s=E[0][0],d=E[1][0]),_&&(l=E[0][1],p=E[1][1]),E[0][0]===s&&E[0][1]===l&&E[1][0]===d&&E[1][1]===p||(C.selection=[[s,l],[d,p]],c.call(v),I.brush(t,y.name))}function j(t){if(_n(t),t.touches){if(t.touches.length)return;e&&clearTimeout(e),e=setTimeout((function(){e=null}),500)}else dn(t.view,g),F.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);O.attr("pointer-events","all"),z.attr("cursor",Dn.overlay),C.selection&&(E=C.selection),jn(E)&&(C.selection=null,c.call(v)),I.end(t,y.name)}function U(t){switch(t.keyCode){case 16:L=w&&x;break;case 18:y===wn&&(w&&(h=d-D*w,r=s+D*w),x&&(f=p-P*x,a=l+P*x),y=xn,N(t));break;case 32:y!==wn&&y!==xn||(w<0?h=d-D:w>0&&(r=s-D),x<0?f=p-P:x>0&&(a=l-P),y=yn,z.attr("cursor",Dn.selection),N(t));break;default:return}vn(t)}function V(t){switch(t.keyCode){case 16:L&&(m=_=L=!1,N(t));break;case 18:y===xn&&(w<0?h=d:w>0&&(r=s),x<0?f=p:x>0&&(a=l),y=wn,N(t));break;case 32:y===yn&&(t.altKey?(w&&(h=d-D*w,r=s+D*w),x&&(f=p-P*x,a=l+P*x),y=xn):(w<0?h=d:w>0&&(r=s),x<0?f=p:x>0&&(a=l),y=wn),z.attr("cursor",Dn[b]),N(t));break;default:return}vn(t)}}function f(t){u(this,arguments).moved(t)}function p(t){u(this,arguments).ended(t)}function g(){var e=this.__brush||{selection:null};return e.extent=An(n.apply(this,arguments)),e.dim=t,e}return l.move=function(e,n,i){e.tween?e.on("start.brush",(function(t){u(this,arguments).beforestart().start(t)})).on("interrupt.brush end.brush",(function(t){u(this,arguments).end(t)})).tween("brush",(function(){var e=this,i=e.__brush,r=u(e,arguments),o=i.selection,s=t.input("function"==typeof n?n.apply(this,arguments):n,i.extent),a=(0,fn.Z)(o,s);function l(t){i.selection=1===t&&null===s?null:a(t),c.call(e),r.brush()}return null!==o&&null!==s?l:l(1)})):e.each((function(){var e=this,r=arguments,o=e.__brush,s=t.input("function"==typeof n?n.apply(e,r):n,o.extent),a=u(e,r).beforestart();oe(e),o.selection=null===s?null:s,c.call(e),a.start(i).brush(i).end(i)}))},l.clear=function(t,e){l.move(t,null,e)},h.prototype={beforestart:function(){return 1==++this.active&&(this.state.emitter=this,this.starting=!0),this},start:function(t,e){return this.starting?(this.starting=!1,this.emit("start",t,e)):this.emit("brush",t),this},brush:function(t,e){return this.emit("brush",t,e),this},end:function(t,e){return 0==--this.active&&(delete this.state.emitter,this.emit("end",t,e)),this},emit:function(e,n,i){var r=(0,ft.Z)(this.that).datum();s.call(e,this.that,new mn(e,{sourceEvent:n,target:l,selection:t.output(this.state.selection),mode:i,dispatch:s}),r)}},l.extent=function(t){return arguments.length?(n="function"==typeof t?t:gn(An(t)),l):n},l.filter=function(t){return arguments.length?(i="function"==typeof t?t:gn(!!t),l):i},l.touchable=function(t){return arguments.length?(r="function"==typeof t?t:gn(!!t),l):r},l.handleSize=function(t){return arguments.length?(a=+t,l):a},l.keyModifiers=function(t){return arguments.length?(o=!!t,l):o},l.on=function(){var t=s.on.apply(s,arguments);return t===s?l:t},l}(Tn).on("end",(t=>{const e=t.selection;if(null==e)return;const n=this.margins.left;this.setRange(this.x_scale.invert(e[0]-n),this.x_scale.invert(e[1]-n))})),this._setBrushExtent(),this.dim=this.dataStore.getDimension("range_dimension"),this.filter=null,this.binFiltered=new Array(this.config.bin_number).fill(!1),this.onDataFiltered(null,!0)}_setBrushExtent(){this.brush.extent([[this.margins.left,0],[this.width-this.margins.right,this.height-this.margins.bottom]]),this.svg.call(this.brush)}setSize(t,e){super.setSize(t,e),this._setBrushExtent(),this.drawChart(),this.svg.call(this.brush.move,null)}remove(t=!0){this.dim.destroy(t),super.remove()}removeFilter(){this.dim.removeFilter(),this.filter=null,this.binFiltered=new Array(this.config.bin_number).fill(!1),this.drawChart(),this.svg.call(this.brush.move,null)}_calculateFilterBins(){const t=this.config,e=t.bin_number;if(this.binFiltered=new Array(e).fill(!1),!this.filter)return;const n=(t.display_max-t.display_min)/t.bin_number;let i=t.display_min;for(let e=0;e<t.bin_number;e++){const t=i+e*n;(t<=this.filter[0]||t>this.filter[1])&&(this.binFiltered[e]=!0)}}setRange(t,e){this.filter=[t,e],this._calculateFilterBins(),this.dim.filter("filterRange",[this.config.param],{min:t,max:e}),this.drawChart(),this.resetButton.style.display="inline"}getFilter(){if(!this.filter)return null;const t={};return t[this.config.param]=this.filter.slice(0),t}onDataFiltered(t){if(this.dim===t||this.isPinned)return;const e=this.config.bin_number,n={bins:this.config.bin_number,max:this.config.display_max,min:this.config.display_min};"all_removed"===t&&(this.filter=null,this.binFiltered.fill(!1),this.svg.call(this.brush.move,null),this.resetButton.style.display="none"),this.dim.getBins((t=>{this.originalBinData=t,this.binData=t.slice(0,e),this.binData[e-1]+=t[e],this.drawChart()}),this.config.param,n)}drawChart(){const t=(0,ft.Z)(this.contentDiv).transition().duration(400).ease(pt),e=this._getContentDimensions(),n=this.config.bin_number,i=(e.width-3*(n+1))/n;let r=Math.max(...this.binData);r=r||1,this.x_scale.domain([this.config.display_min,this.config.display_max]),this.y_scale.domain([r,0]),this.updateAxis();const o=e.height/r,s=this;this.graph_area.selectAll(".bar").data(this.binData).join("rect").transition(t).style("fill",((t,e)=>s.binFiltered[e]?"gray":"blue")).attr("class","bar").attr("x",((t,e)=>3*(e+1)+e*i)).attr("width",i).attr("y",(t=>e.height-t*o)).attr("height",(t=>t*o))}pinChart(){this.isPinned=!0}unpinChart(){this.isPinned=!1,this.onDataFiltered()}getSettings(){const t=super.getSettings(),e=this.config,n=this.dataStore.getMinMaxForColumn(e.param);return t.concat([{type:"doubleslider",min:n[0],max:n[1],doc:this.__doc__||document,current_value:[e.display_min,e.display_max],label:"max min values",info:{text:"Sometimes outliers can skew the histogram to one side.\n                     Setting a min/max value will add all counts less/greater than the \n                     value specified to the first/last bin.",position:"left"},func:(t,n)=>{e.display_min=t,e.display_max=n,this._calculateFilterBins(),this.onDataFiltered()}},{type:"spinner",max:100,min:2,current_value:e.bin_number,label:"Number of bins",func:t=>{e.bin_number=t,this._calculateFilterBins(),this.onDataFiltered()}}])}},params:[{type:"number",name:"Frequency Data"}]};const Un=class extends sn{constructor(t,e,n,i){Array.isArray(n.param)&&(n.param=n.param[0]),n.title=n.title||t.getColumnName(n.param),super(t,e,n,i),this.dim=this.dataStore.getDimension("category_dimension"),this.colors=this.dataStore.getColumnColors(n.param),this.filter=[]}remove(t=!0){this.dim.destroy(t),super.remove()}setSize(t,e){super.setSize(t,e),this.drawChart()}removeFilter(){this.dim.removeFilter(),this.filter=[],this.drawChart()}filterCategories(t,e){if(e)if(-1!==this.filter.indexOf(t))this.filter=this.filter.filter((e=>e!==t));else if(0==this.filter.length){const e=this.dataStore.getColumnValues(this.config.param);this.filter=e.filter((e=>e!==t))}else this.filter.push(t);else this.filter=[t];this.resetButton.style.display="inline",this.drawChart(100),this.dim.filter("filterCategories",[this.config.param],this.filter)}getFilter(){const t={};return this.filter&&0!==this.filter.length?(t[this.config.param]=this.filter.slice(0),t):null}pinChart(){this.isPinned=!0}unpinChart(){this.isPinned=!1,this.onDataFiltered()}updateData(){const t=this.config;if(this.rowData=this.data.slice(0),t.filter_zeros&&(this.rowData=this.rowData.filter((t=>0!==t[0]))),"size"===t.sort&&this.rowData.sort(((t,e)=>e[0]-t[0])),"name"===t.sort){const e=this.dataStore.getColumnValues(t.param);this.rowData.sort(((t,n)=>e[t[1]].localeCompare(e[n[1]])))}this.rowData.length>40&&!t.show_limit&&(t.show_limit=40),t.show_limit&&t.show_limit<this.rowData.length&&this.rowData.splice(t.show_limit)}onDataFiltered(t){this.dim===t||this.isPinned||("all_removed"===t&&(this.filter=[],this.resetButton.style.display="none"),this.dim.getCategories((t=>{this.data=new Array(t.length),this.maxCount=1,this.config;for(let e=0;e<t.length;e++)this.data[e]=[t[e],e],this.maxCount=Math.max(t[e],this.maxCount);this.updateData(),this.drawChart()}),this.config.param,{}))}};var Vn=__webpack_require__(5083),Wn=__webpack_require__.n(Vn);class Hn extends Un{constructor(t,e,n){super(t,e,n,{x:{}}),this.config.type="row_chart",this.onDataFiltered(null),this.labelg=this.graph_area.append("g"),this.wordcloudCanvas=(0,T.ut)("canvas",{styles:{position:"absolute",top:"0px",left:"0px",width:"100%",height:"100%"}},this.contentDiv)}drawWordCloud(t){const e=this.dataStore.getColumnValues(this.config.param),n=this.dataStore.getColumnColors(this.config.param),i=t.map((t=>[e[t[1]],Math.log(t[0])])),r=Math.max(...i.map((t=>t[1]))),o=this.wordcloudCanvas,s=(o.width=this.contentDiv.clientWidth,o.height=this.contentDiv.clientHeight,this.config.wordSize/r),a=Math.PI/2;o.style.display="block",this.graph_area.style.display="none";const l={list:i,color:t=>this.filter.length>0&&-1===this.filter.indexOf(t)?"lightgray":n[e.indexOf(t)],click:(t,e,n)=>this.filterCategories(t[0],n.shiftKey),weightFactor:s,backgroundColor:getComputedStyle(o).getPropertyValue("--main_panel_color"),minRotation:-a,maxRotation:a,rotationSteps:2};console.log("wordcloud options",l),Wn()(o,l)}drawChart(t=400){const e=this.config,n=(0,ft.Z)(this.contentDiv).transition().duration(t).ease(pt),i=this.width-this.margins.left-this.margins.right,r=this.height-this.margins.bottom-this.margins.top,o=this.dataStore.getColumnColors(this.config.param),s=this.dataStore.getColumnValues(this.config.param),a=i/this.maxCount,l=this;let c=this.rowData,u=this.maxCount;if(e.exclude_categories){const t=new Set;for(let n of e.exclude_categories)t.add(s.indexOf(n));c=this.rowData.filter(((e,n)=>!t.has(n))),u=c.reduce(((t,e)=>Math.max(t[0],e[0])))}if(this.config.wordcloud)return void this.drawWordCloud(c);this.wordcloudCanvas.style.display="none",this.graph_area.style.display="block";const h=c.length,d=(r-3*(h+1))/h;let f=Math.round(d);f=f>20?20:f,this.x_scale.domain([0,this.maxCount]),this.updateAxis(),this.labelg.selectAll(".row-bar").data(c,(t=>t[1])).join("rect").attr("class","row-bar").on("click",((t,e)=>{l.filterCategories(s[e[1]],t.shiftKey)})).transition(n).style("fill",(t=>{const e=t[1];return l.filter.length>0&&-1===l.filter.indexOf(s[e])?"lightgray":o[e]})).attr("class","row-bar").attr("x",0).attr("width",(t=>t[0]*a)).attr("y",((t,e)=>3*(e+1)+e*d)).attr("height",d),this.graph_area.selectAll(".row-text").data(c,(t=>t[1])).join("text").on("click",((t,e)=>{l.filterCategories(s[e[1]],t.shiftKey)})).attr("class","row-text").transition(n).text((t=>""===s[t[1]]?"none":s[t[1]])).attr("font-size",f+"px").attr("x",5).style("fill","currentColor").attr("y",((t,e)=>3*(e+1)+e*d+d/2)).attr("dominant-baseline","central")}getSettings(){const t=super.getSettings(),e=this.config;if(e.wordcloud)return this.getWordCloudSettings();const n=Math.max(this.data.length||60);return t.concat([{type:"spinner",label:"Max Rows",current_value:e.show_limit||n,max:n,func:t=>{e.show_limit=t,this.updateData(),this.drawChart()}},{type:"check",label:"Hide zero values",current_value:e.filter_zeros,func:t=>{e.filter_zeros=t,this.updateData(),this.drawChart()}},{type:"radiobuttons",label:"Sort Order",current_value:e.sort||"default",choices:[["Default","default"],["Size","size"],["Name","name"]],func:t=>{e.sort=t,this.updateData(),this.drawChart()}},{type:"check",label:"Display as WordCloud",current_value:e.wordcloud,func:t=>{e.wordcloud=t,this.drawChart()}}])}getWordCloudSettings(){super.getSettings();const t=this.config;return[{type:"slider",label:"Word Size",current_value:t.wordSize||100,min:10,max:100,func:e=>{t.wordSize=e,this.drawChart()}}]}}I.types.row_chart={class:Hn,name:"Row Chart",params:[{type:["text","multitext"],name:"Category"}]},I.types.wordcloud={class:Hn,name:"Word Cloud",params:[{type:["text","multitext"],name:"Category"}],init:(t,e)=>{t.wordcloud=!0,t.wordSize=20}};var $n=__webpack_require__(626),Zn=__webpack_require__(2024);function qn(t){var e,n,i,r=[],o=this,s=new Zn.v.EventHandler,a={selectActiveRow:!0};function l(t){return function(){n||(n=!0,t.apply(this,arguments),n=!1)}}function c(t){for(var e=[],n=0;n<t.length;n++)for(var i=t[n].fromRow;i<=t[n].toRow;i++)e.push(i);return e}function u(t){for(var n=[],i=e.getColumns().length-1,r=0;r<t.length;r++)n.push(new Zn.v.Range(t[r],0,t[r],i));return n}function h(){return c(r)}function d(t){(r&&0!==r.length||t&&0!==t.length)&&(r=t,o.onSelectedRangesChanged.notify(r))}function f(t,n){i.selectActiveRow&&null!=n.row&&d([new Zn.v.Range(n.row,0,n.row,e.getColumns().length-1)])}function p(t){var n=e.getActiveCell();if(e.getOptions().multiSelect&&n&&t.shiftKey&&!t.ctrlKey&&!t.altKey&&!t.metaKey&&(t.which==Zn.v.keyCode.UP||t.which==Zn.v.keyCode.DOWN)){var i=h();i.sort((function(t,e){return t-e})),i.length||(i=[n.row]);var r,o=i[0],s=i[i.length-1];(r=t.which==Zn.v.keyCode.DOWN?n.row<s||o==s?++s:++o:n.row<s?--s:--o)>=0&&r<e.getDataLength()&&(e.scrollRowIntoView(r),d(u(function(t,e){var n,i=[];for(n=t;n<=e;n++)i.push(n);for(n=e;n<t;n++)i.push(n);return i}(o,s)))),t.preventDefault(),t.stopPropagation()}}function g(t){var n=e.getCellFromEvent(t);if(!n||!e.canCellBeActive(n.row,n.cell))return!1;if(!e.getOptions().multiSelect||!t.ctrlKey&&!t.shiftKey&&!t.metaKey)return!1;var i=c(r),o=i.indexOf(n.row);if(-1===o&&(t.ctrlKey||t.metaKey))i.push(n.row),e.setActiveCell(n.row,n.cell);else if(-1!==o&&(t.ctrlKey||t.metaKey))i=i.filter((function(t,e){return t!==n.row})),e.setActiveCell(n.row,n.cell);else if(i.length&&t.shiftKey){var s=i.pop(),a=Math.min(n.row,s),l=Math.max(n.row,s);i=[];for(var h=a;h<=l;h++)h!==s&&i.push(h);i.push(s),e.setActiveCell(n.row,n.cell)}return d(u(i)),t.stopImmediatePropagation(),!0}Object.assign(this,{getSelectedRows:h,setSelectedRows:function(t){d(u(t))},getSelectedRanges:function(){return r},setSelectedRanges:d,init:function(n){i=Object.assign(a,t),e=n,s.subscribe(e.onActiveCellChanged,l(f)),s.subscribe(e.onKeyDown,l(p)),s.subscribe(e.onClick,l(g))},destroy:function(){s.unsubscribeAll()},pluginName:"RowSelectionModel",onSelectedRangesChanged:new Zn.v.Event})}class Gn{constructor(t,e={}){this.dataStore=t,this.data=new Int32Array(0);for(let t=0;t<0;t++)this.data[t]=t;this.size=0,null!=e.autoupdate&&!0!==e.autoupdate||t.addListener("sss",(t=>{"filtered"===t&&this.updateModel()})),this.listeners={}}getLength(){return this.size}addListener(t,e){this.listeners[t]=e}setColumns(t){this.columns=t}sort(t,e){const n=this.dataStore.getRawColumn(t),i=this.dataStore.columnIndex[t];if("unique"===i.datatype){const t={},r=new TextDecoder,o=i.stringLength,s="desc"===e?1:-1;for(let e=0;e<this.data.length;e++){const i=this.data[e];t[i]=r.decode(n.slice(i*o,i*o+o))}this.data.sort(((e,n)=>t[e].localeCompare(t[n])*s))}else"desc"===e?this.data.sort(((t,e)=>{let i=n[t],r=n[e];return i=isNaN(i)?Number.MAX_VALUE:i,r=isNaN(r)?Number.MAX_VALUE:r,i-r})):this.data.sort(((t,e)=>{let i=n[t],r=n[e];return i=isNaN(i)?Number.MIN_VALUE:i,r=isNaN(r)?Number.MIN_VALUE:r,r-i}))}createColumn(t,e){const n={name:t,field:t,datatype:"text",values:[""]},i=new SharedArrayBuffer(this.dataStore.size);if(e){const t=this.dataStore.getRawColumn(e);new Uint8Array(i).set(t),n.values=this.dataStore.getColumnValues(e).slice(0)}this.dataStore.addColumn(n,i,!0)}removeColumn(t){this.dataStore.removeColumn(t,!0,!0)}getDataAsBlob(t="\t",e="\n"){return this.dataStore.getDataAsBlob(this.columns,this.data,t,e)}getValueSuggestion(t,e){const n=this.dataStore.getColumnValues(e);for(let e of n){if(e===t)return e;if(e.startsWith(t))return e}return null}_getValueIndex(t,e){let n=e.values.indexOf(t);if(-1===n){if(e.values.push(t),e.values.length>256)throw new Error(`text column '${e.name}' exceeded 256 values when adding '${t}'`);n=e.values.length-1}return n}updateValue(t,e,n,i=!0){const r=this.dataStore.columnIndex[n];let o=this._getValueIndex(t,r);r.data[e]=o,i&&this.dataStore.dataChanged([n])}updateRange(t,e,n,i){const r=this.dataStore.getRawColumn(t),o="+"===i?r[this.data[e]]:r[this.data[n]];let s="+"===i?e:n,a="+"===i?1:-1,l="+"===i?n+1:e-1;for(;s!==l;s+=a)r[this.data[s]]=o;this.dataStore.dataChanged([t])}replaceValues(t,e,n,i=!0){const r=this.dataStore.columnIndex[n];let o=this._getValueIndex(t,r);if("_all_"===e)for(let t=0;t<this.data.length;t++)r.data[this.data[t]]=o;else if("_blank_"===e){let e=r.values.indexOf(t);if(-1===e)return;for(let t=0;t<this.data.length;t++){const n=this.data[t];r.data[n]===e&&(r.data[this.data[t]]=o)}}else{if("_delete_"==e)return void this.dataStore.cleanColumnData(n);{let t=this._getValueIndex(e,r);for(let e=0;e<this.data.length;e++){const n=this.data[e];r.data[n]===o&&(r.data[this.data[e]]=t)}}}i&&this.dataStore.dataChanged([n])}updateModel(){const t=this.dataStore.filterArray;this.data=new Int32Array(this.dataStore.filterSize);const e=this.data,n=this.dataStore.size;let i=0;for(let r=0;r<n;r++)0===t[r]&&(e[i++]=r);this.size=this.dataStore.filterSize;for(let t in this.listeners)this.listeners[t]()}getId(t){return this.data[t]}getItemField(t,e){return this.dataStore.getRowAsObject(this.data[t],[e])[e]}getItem(t){return this.dataStore.getRowAsObject(this.data[t],this.columns)}}class Kn extends F.v{constructor(t,e,n,i){super({doc:i,columns:2,width:380,maxHeight:500,title:"Bulk Edit "+n},{table:t,column:e})}init(t){this.col=t.column,this.dataModel=t.table.dataModel,this.table=t.table;const e=(0,T.ut)("div",{},this.columns[0]);(0,T.ut)("label",{text:"Value:"},e),this.valInput=(0,T.ut)("input",{},e),this.valInput.addEventListener("keyup",(t=>{const e=t.which;if(37===e||39===e||8===e)return void t.stopImmediatePropagation();const n=this.dataModel.getValueSuggestion(this.valInput.value,this.col);n&&(this.valInput.value=n)}));const n=(0,T.ut)("div",{},this.columns[0]);(0,T.ut)("label",{text:"Replace With:"},n),this.replaceInput=(0,T.ut)("input",{},n),this._createButton("Fill All Cells","_all_"),this._createButton("Fill Empty Cells","_blank_"),this._createButton("Replace Value",null),this._createButton("Delete Unused Values","_delete_"),this._createButton("Remove Column","_delete_column_")}_createButton(t,e){const n=(0,T.ut)("div",{style:{padding:"5px 10px"}},this.columns[1]);(0,T.ut)("button",{classes:["ciview-button"],text:t},n).addEventListener("click",(()=>{const t=e||this.replaceInput.value;"_delete_column_"===t?(this.table._removeColumn(this.col),this.close()):this.dataModel.replaceValues(this.valInput.value,t,this.col)}))}}class Xn extends F.v{constructor(t,e){super({doc:e,footer:!0,buttons:[{text:"Add",method:"addColumn"}],width:300,maxHeight:500,title:"Add Column"},t)}init(t){const e={padding:"5px"};this.table=t;const n=(0,T.ut)("div",{style:e},this.dialog);(0,T.ut)("label",{text:"Column Name"},n),this.name=(0,T.ut)("input",{},n),this.name.addEventListener("keydown",(t=>{"Enter"===t.key&&this.addColumn()}));const i=(0,T.ut)("div",{style:e},this.dialog),r=(0,T.ut)("label",{style:{display:"flex"}},i);this.cloneCheck=(0,T.ut)("input",{type:"checkbox"},r),(0,T.ut)("div",{text:"Copy Existing Column"},r);const o=t.getColumnInfo();this.cloneCol=(0,T.ut)("select",{},i);for(let t of o)(0,T.ut)("option",{text:t.name,value:t.field},this.cloneCol);const s=(0,T.ut)("div",{style:e},this.dialog);(0,T.ut)("label",{text:"Position"},s),this.position=(0,T.ut)("input",{style:{width:"100px"},value:2},s),setTimeout((()=>this.name.focus()),100)}addColumn(){if(!this.name.value)return void this.name.focus();let t=this.cloneCheck.checked?this.cloneCol.value:null,e=parseInt(this.position.value);e=isNaN(e)?null:e,this.table.createColumn(this.name.value,t,e),this.close()}}I.types.table_chart={class:class extends I{constructor(t,e,n){super(t,e,n),this.config.type="table_chart";let i=[];i=[{field:"__index__",id:"__index__",name:"index",datatype:"integer",sortable:!0,width:100}];const r=n.column_widths||{};for(let e of this.config.param){const n=t.columnIndex[e],o={id:n.field,field:n.field,name:n.name,datatype:n.datatype,sortable:!0,width:r[e]?r[e]:100};"multitext"===n.datatype&&(o.datatype="text"),n.editable&&(o.editor=$n.H4),n.is_url&&(o.formatter=(t,e,n,i,r)=>`<a href="${n}" target="_blank">${n}</a>`),i.push(o)}this.options={enableCellNavigation:!0,enableColumnReorder:!1,editable:!1,autoEdit:!0,enableAsyncPostRender:!0,frozenColumn:null},this.dataModel=new Gn(t,{autoupdate:!1}),this.dataModel.setColumns(this.config.param),this.grid=new $n.zn(this.contentDiv,this.dataModel,i,this.options),this.grid.onHeaderCellRendered.subscribe(((t,e)=>{const n=e.column;if(n.editor&&"edit"===this.mode){const t=(0,T.ut)("i",{classes:["far","fa-edit"],style:{cursor:"pointer"}});e.node.prepend(t),t.addEventListener("click",(t=>{t.stopImmediatePropagation(),new Kn(this,n.field,n.name,this.__doc__)}))}})),this.dataModel.addListener(this.config.id,(()=>{this.grid.invalidate()})),this.grid.setColumns(this.grid.getColumns()),this.mode="select",this.grid.setSelectionModel(new qn),this.grid.init(),this.grid.onSort.subscribe(((t,e)=>{this.dataModel.sort(e.columnId,e.sortAsc?"asc":"desc"),this.grid.invalidateAllRows(),this.grid.render()})),this.grid.onSelectedRowsChanged.subscribe(((t,e)=>{"select"===this.mode&&this._rowsSelected(e)})),this.editIcon=this.addMenuIcon("fas fa-edit","Change To Edit Mode",{func:()=>{this.editIcon.firstElementChild.remove(),this.mode="select"===this.mode?"edit":"select";const t="select"===this.mode?["fas","fa-edit"]:["fas","fa-table"];(0,T.ut)("i",{classes:t},this.editIcon),this.editIcon.setAttribute("aria-label","edit"===this.mode?"Change To Selection Mode":"Change To Edit Mode"),this._changeMode()}}),this.addMenuIcon("fas fa-download","Download data",{func:()=>{this.downloadData()}}),this.filter=[],this.themeChanged(),this.onDataFiltered()}onDataHighlighted(t){if(t.source===this)return;const e=this.dataModel.data.indexOf(t.indexes[0]);-1!==e&&(this.grid.scrollRowIntoView(e),this.tempMode=this.mode,this.mode="",this.grid.setSelectedRows([e]),this.mode=this.tempMode)}onColumnRemoved(t){if(-1===this.config.param.indexOf(t))return!1;const e=this.grid.getCellEditor();e&&e.destroy(),this.grid.setActiveCell(null);let n=this.grid.getColumns();return n=n.filter((e=>e.field!==t)),this.config.param=this.config.param.filter((e=>e!==t)),this.dataModel.setColumns(this.config.param),this.grid.setColumns(n),!1}getConfig(){const t=super.getConfig(),e=this.grid.getColumns();t.param=e.filter((t=>"__index__"!==t.field)).map((t=>t.field)),t.column_widths={};for(let n of e)100!==n.width&&(t.column_widths[n.field]=n.width);return t}downloadData(){const t=this.dataModel.getDataAsBlob(),e=(0,T.ut)("a",{download:"data",target:"_blank",href:window.URL.createObjectURL(t)},this.__doc__.body);e.click(),e.remove()}_changeMode(){"select"===this.mode?(this.addColumnIcon&&(this.addColumnIcon.remove(),this.addColumnIcon=null),this.selectionModel=new qn,this.grid.setSelectionModel(this.selectionModel),this.overlay&&(this.grid.unregisterPlugin(this.overlay),this.overlay=null),this.grid.setOptions({editable:!1},!0,!0),this.grid.setColumns(this.grid.getColumns())):(this.grid.setSelectedRows([]),this.selectionModel&&(this.grid.setSelectionModel(null),this.selectionModel=null),this.grid.setOptions({editable:!0},!0,!0),this.grid.setColumns(this.grid.getColumns()),this.addColumnIcon=this.addMenuIcon("fas fa-plus","Add Column",{func:t=>{new Xn(this)}}),this.overlay=new $n.A5({}),this.overlay.onFillUpDown.subscribe(((t,e)=>this._updateOverlay(e))),this.grid.registerPlugin(this.overlay))}onDataChanged(t){this.grid.invalidate()}getColumnInfo(){return this.grid.getColumns().filter((t=>"text"===t.datatype)).map((t=>({name:t.name,field:t.field}))).sort(((t,e)=>t.name.localeCompare(e.name)))}createColumn(t,e=null,n=2){this.dataModel.createColumn(t,e);const i=this.grid.getColumns();(n-=1)<0||n>=i.length&&(n=i.length-1),i.splice(n,0,{name:t,field:t,id:t,datatype:"text",editor:$n.H4,sortable:!0}),this.config.param.push(t),this.grid.setColumns(i),this.grid.invalidate()}_removeColumn(t){this.dataModel.removeColumn(t,!0,!0)}_updateOverlay(t){var e=this.grid.getColumns()[t.range.fromCell];e.editor&&(this.dataModel.updateRange(e.field,t.range.fromRow,t.range.toRow,t.dir),this.grid.invalidate())}_rowsSelected(t){const e=[];for(let n of t.rows)e.push(this.dataModel.data[n]);this.dataStore.dataHighlighted(e,this)}themeChanged(){console.warn("themeChanged() deprecated")}changeBaseDocument(t){super.changeBaseDocument(t),this.grid.setBaseDocument(t),"edit"===this.mode&&(this.grid.unregisterPlugin(this.overlay),this.grid.registerPlugin(this.overlay))}setSize(t,e){super.setSize(t,e),this.grid.resizeCanvas(),this.grid.invalidate()}pinChart(){this.isPinned=!0}unpinChart(){this.isPinned=!1,this.onDataFiltered()}addColumns(){}remove(){this.grid.destroy(),super.remove()}onDataFiltered(){this.isPinned||this.dataModel.updateModel()}},name:"Table",params:[{type:"_multi_column:all",name:"Columns To Display"}]};var Yn=__webpack_require__(1550),Qn=__webpack_require__.n(Yn),Jn=__webpack_require__(5975);function ti(t){var e=.9*t;return Math.abs(e)<.1?0:e}function ei(t,e,n){return Math.min(Math.max(t,e),n)}class ni{constructor(t={}){this.cameraState={view:Jn.yR(new Float32Array(16)),projection:Jn.yR(new Float32Array(16)),center:t.center||[0,0,0],theta:t.theta||0,phi:t.phi||0,distance:Math.log(t.distance||1e3),eye:new Float32Array(3),up:new Float32Array(t.up||[0,1,0])},this.right=new Float32Array([1,0,0]),this.front=new Float32Array([0,0,1]),this.minDistance=Math.log("minDistance"in t?t.minDistance:.5),this.maxDistance=Math.log("maxDistance"in t?t.maxDistance:1e14),this.dtheta=0,this.dphi=0,this.ddistance=0,this.updateCamera()}mouseChange(t,e){var n=Math.max(this.cameraState.distance,.5);this.dtheta+=n*t,this.dphi+=n*e,this.updateCamera()}getProjection(){return{projection:this.cameraState.projection,view:this.cameraState.view,distance:this.cameraState.distance,eye:this.cameraState.eye}}mouseWheel(t,e){this.ddistance+=e/window.innerHeight,this.updateCamera()}updateCamera(){var t=this.cameraState.center,e=this.cameraState.eye,n=this.cameraState.up;this.cameraState.theta+=this.dtheta,this.cameraState.phi=ei(this.cameraState.phi+this.dphi,-Math.PI/2,Math.PI/2),this.cameraState.distance=ei(this.cameraState.distance+this.ddistance,this.minDistance,this.maxDistance),this.dtheta=ti(this.dtheta),this.dphi=ti(this.dphi),this.ddistance=ti(this.ddistance);for(var i=this.cameraState.theta,r=this.cameraState.phi,o=Math.exp(this.cameraState.distance),s=o*Math.sin(i)*Math.cos(r),a=o*Math.cos(i)*Math.cos(r),l=o*Math.sin(r),c=0;c<3;++c)e[c]=t[c]+s*this.front[c]+a*this.right[c]+l*n[c];Math.cos(.01),Math.sin(.01),Jn.zB(this.cameraState.view,e,t,n)}}class ii{constructor(t,e){var n=this;for(var i in e||(e={}),this.config=e,e.offset||(e.offset=[0,0,0,0]),this.mode=e.mode||"2d",this.movingImage=0,this.__doc__=document,this.config.brush=this.config.brush||"default",this.draw_options=e.draw_options?e.draw_options:{depth:{enable:!1},blend:{enable:!0,func:{srcRGB:"src alpha",srcAlpha:"src alpha",dstRGB:"one minus src alpha",dstAlpha:"one minus src alpha"}}},this.regl=null,this.pick_buffer=null,this.hideOnFilter=!0,this.pointOpacity=.8,this.pointRadius=10,this.isFiltered=!1,this.x_scale=1,this.y_scale=1,this.offset=[0,0],this.div_container="string"==typeof t?document.getElementById(t):t,this._setUpDocument(e.width,e.height),this.handlers={object_clicked:{},object_over:{},object_out:{},brush_stopped:{},zoom_stopped:{},panning_stopped:{},pan_or_zoom:{}},this.draw_labels=!1,this.object_types=[],this.pointScale=0,this.circle_properties={x_pos:1,y_pos:1,color:1,pick_color:1,localFilter:1,globalFilter:1},this.circles={},this.circle_properties)this.circles[i]=[];for(var i in this.circles.count=0,this.object_types.push({data:this.circles,properties:this.circle_properties,vertices:1,primitive:"points"}),this.line_properties={position:2,color:2,opacity:2},this.lines={},this.line_properties)this.lines[i]=[];for(var i in this.lines.count=0,this.object_types.push({data:this.lines,properties:this.line_properties,vertices:2,primitive:"lines"}),this.image_properties={position:2,color:2,opacity:2},this.images={},this.image_properties)this.images[i]=[];for(var i in this.images.count=0,this.images.props={x_y:[],w_h:[],text:[]},this.object_types.push({data:this.images,properties:this.image_properties,vertices:6,primitive:"triangles"}),"3d"===this.mode&&(this.circle_properties.z_pos=1,this.camera=new ni({center:e.cameraCenter,distance:e.cameraDistance||500,theta:.75,phi:.5}),this.axisScales=[1,1,1]),this.square_properties={x_pos:1,y_pos:1,color:1,pick_color:1,localFilter:1,globalFilter:1},this.squares={},this.square_properties)this.squares[i]=[];for(var i in this.squares.count=0,this.object_types.push({data:this.squares,properties:this.square_properties,vertices:1,primitive:"points"}),this.rectangle_properties={position:6,color:6,opacity:6},this.rects={},this.rectangle_properties)this.rects[i]=[];this.rects.count=0,this.object_types.push({data:this.rects,properties:this.rectangle_properties,vertices:6,primitive:"triangles"}),this.mouse_position=null,this.object_clicked=null,this.dragging=!1,this.object_mouse_over=null,this.zoom_amount=0,this.draw_order=(this.mode,[2,0,1,3,4]),Qn()({onDone:function(t,e){n.regl=e,e._refresh(),n.pickbuffer=e.framebuffer({colorFormat:"rgba",height:n.height,width:n.width}),n._initDrawMethods(),"3d"===n.mode&&(n.object_types[0].method=n.__draw3DCircles,n.object_types[1].method=n.__draw3DLines),n._addHandlers()},canvas:n.canvas,attributes:{antialias:!1}})}setBackGroundColor(t){t=t||"",this.div_container.style.background=t}_setUpDocument(t,e){if(this.config.brush&&(this.div_container.style.cursor="crosshair"),e)this.height=e,this.width=t,this.div_container.style.height=e+"px",this.div_container.style.width=t+"px";else{const n=this.div_container.getBoundingClientRect();this.height=e=Math.round(n.height),this.width=t=Math.round(n.width)}const n={height:e,width:t,styles:{position:"absolute",left:"0px",top:"0px"}};this.canvas=(0,T.ut)("canvas",n),this.label_canvas=(0,T.ut)("canvas",n),this.label_context=this.label_canvas.getContext("2d"),this.div_container.append(this.canvas),this.div_container.append(this.label_canvas)}colorPoints(t){const e=this.circles.count,n=this.circles.color;for(let i=0;i<e;i++){const e=t(i),r=3*i;n[r]=e[0],n[r+1]=e[1],n[r+2]=e[2]}if(this.highlightPoints){const t=this.highlightPoints;for(let e=0;e<t.length;e++){const n=3*t.indexes[e],i=3*e;t.color[i]=this.circles.color[n],t.color[i+1]=this.circles.color[n+1],t.color[i+2]=this.circles.color[n+2]}}}remove(){this.pickbuffer.destroy(),this.regl.destroy(),this.canvas.remove(),this.label_canvas.remove()}setSize(t,e,n=null){if(this.height===e&&this.width===t)return;let i=this;if(t=Math.round(t),e=Math.round(e),n){const i=n(t,e);this.x_scale=i[0]||this.x_scale,this.y_scale=i[1]||thisy_scale}else{let n=t/this.width,i=e/this.height;this.x_scale=this.x_scale*n,this.y_scale=this.y_scale*i}this.height=e,this.width=t,this.div_container.style.height=e+"px",this.div_container.style.width=t+"px",this.canvas.setAttribute("height",e),this.canvas.setAttribute("width",t),this.label_canvas.setAttribute("height",e),this.label_canvas.setAttribute("width",t),this.pickbuffer.destroy(),this.pickbuffer=this.regl.framebuffer({colorFormat:"rgba",height:e,width:t});let r=this.regl.frame((function(){}));setTimeout((()=>{i.refresh(),r.cancel()}),200)}_getMousePosition(t){var e=this.canvas.getBoundingClientRect();return[t.clientX-e.left,t.clientY-e.top]}_getActualPosition(t){return[t[0]/this.x_scale-this.offset[0],t[1]/this.y_scale-this.offset[1]]}_getCanvasCoords(t){return[(t[0]+this.offset[0])*this.x_scale,(t[1]+this.offset[1])*this.y_scale]}getRange(){let t=this._getActualPosition([0,0]),e=this._getActualPosition([this.width,this.height]);return{x_range:[t[0],e[0]],y_range:[t[1],e[1]],offset:[this.offset[0],this.offset[1]],scale:[this.x_scale,this.y_scale]}}setHighlightPoints(t){if(null==t)return void(this.highlightPoints=null);const e={x_pos:[],y_pos:[],color:[],length:t.length,indexes:t};"3d"===this.mode&&(e.z_pos=[]);for(let n of t){e.x_pos.push(this.circles.x_pos[n]),e.y_pos.push(this.circles.y_pos[n]),"3d"===this.mode&&e.z_pos.push(this.circles.z_pos[n]);const t=3*n;e.color.push(this.circles.color[t]),e.color.push(this.circles.color[t+1]),e.color.push(this.circles.color[t+2])}this.highlightPoints=e}setPointRadius(t){t&&!isNaN(t)||(t=0),this.pointRadius=t}setFilter(t){this.isFiltered=t}setHideOnFilter(t){this.hideOnFilter=t}setPointOpacity(t){t=(t=t>1?1:t)<0?0:t,this.pointOpacity=t}getPointOpacity(){return this.pointOpacity}getPointRadius(){return this.pointRadius}addLine(t,e,n=[0,0,0],i=1){return this.lines.position=this.lines.position.concat(t,e),this.lines.color=this.lines.color.concat(n,n),this.lines.opacity=this.lines.opacity.concat([i,i]),this.lines.count++,this.lines.count-1}removeAllLines(){this.lines.position=[],this.lines.color=[],this.lines.opacity=[],this.lines.count=0}addRectangle(t,e,n,i=[0,0,0],r=1){this.rects.position.push(t),this.rects.position.push([t[0],t[1]+n]),this.rects.position.push([t[0]+e,t[1]+n]),this.rects.position.push([t[0]+e,t[1]+n]),this.rects.position.push([t[0]+e,t[1]]),this.rects.position.push([t[0],t[1]]);for(let t=0;t<6;t++)this.rects.opacity.push(r);const o=[i[0],i[1],i[2]];for(let t=0;t<6;t++)this.rects.color.push(o);return this.rects.count++,this.rects.count-1}changeImage(t,e,n){this.images.props.text[n]=this.regl.texture({data:t,min:"linear"}),this.resizeImage([e.width,e.height],n),this.setImagePosition(e.position[0],e.position[1],n)}changeImageOpacity(t,e){const n=6*t,i=n+6;for(let t=n;t<i;t++)this.images.opacity[t]=e}moveImage(t,e){const n=6*this.movingImage,i=n+6;for(let r=n;r<i;r++){const n=this.images.position[r];n[0]+=t,n[1]+=e}const r=this.images.props.x_y[this.movingImage];r[0]+=t,r[1]+=e}setImagePosition(t,e,n){const i=this.images.position,r=6*n,o=this.images.props.w_h[n][0],s=this.images.props.w_h[n][1];e=-e-s,this.images.props.x_y[n]=[t,e],i[r]=[t,e],i[r+1]=[t,e+s],i[r+2]=[t+o,e+s],i[r+3]=[t+o,e+s],i[r+4]=[t+o,e],i[r+5]=[t,e]}getImageDetails(t){const e=this.images.props.w_h[t],n=this.images.props.x_y[t];return{width:e[0],height:e[1],position:[n[0],n[1]],index:t}}resizeImage(t,e){const n=this.images.props.w_h[e],i=this.images.props.x_y[e];let r,o=null;Array.isArray(t)?(r=t[0],o=t[1],n[0]=r,n[1]=o):(r=n[0]*=t,o=n[1]*=t);const s=i[0],a=i[1];this.images.position[1]=[s,a+o],this.images.position[2]=[s+r,a+o],this.images.position[3]=[s+r,a+o],this.images.position[4]=[s+r,a]}addImage(t,e){const n=e;let i=n.position[0],r=-n.position[1];const o=n.height,s=n.width;r-=o,this.images.position.length,this.images.position.push([i,r]),this.images.position.push([i,r+o]),this.images.position.push([i+s,r+o]),this.images.position.push([i+s,r+o]),this.images.position.push([i+s,r]),this.images.position.push([i,r]),this.image_position=[[-1,1],[-1,0],[0,0],[0,0],[0,1],[-1]];const a=null==n.opacity?1:n.opacity;for(var l=0;l<6;l++)this.images.color.push([1,1,1]),this.images.opacity.push(a);return this.images.count++,this.images.props.x_y.push([i,r]),this.images.props.w_h.push([s,o]),this.images.props.text.push(this.regl.texture({data:t,min:"linear"})),this.images.count-1}removeImages(){this.images.position=[],this.images.color=[],this.images.opacity=[],this.images.props.x_y=[],this.images.props.w_h=[],this.images.props.text=[],this.images.count=0}addSquares(t){this.squares.x_pos=t.x,this.squares.y_pos=t.y;const e=t.x.length;this.squares.localFilter=t.localFilter,this.squares.globalFilter=t.globalFilter,this.squares.pick_color=new Uint8Array(3*e),this.squares.color=t.colors;for(let t=0;t<e;t++){let e=3*t,n=this._getRGBFromIndex(t+1);this.squares.pick_color[e]=n[0],this.squares.pick_color[e+1]=n[1],this.squares.pick_color[e+2]=n[2]}this.squares.count=e}addCircles(t){this.circles.x_pos=t.x,this.circles.y_pos=t.y,"3d"===this.mode&&(this.circles.z_pos=t.z);const e=t.x.length;this.circles.localFilter=t.localFilter,this.circles.globalFilter=t.globalFilter,this.circles.pick_color=new Uint8Array(3*e),this.circles.color=new Uint8Array(3*e);for(let n=0;n<e;n++){let e=3*n;const i=t.colorFunc(n);this.circles.color[e]=i[0],this.circles.color[e+1]=i[1],this.circles.color[e+2]=i[2];let r=this._getRGBFromIndex(n+1);this.circles.pick_color[e]=r[0],this.circles.pick_color[e+1]=r[1],this.circles.pick_color[e+2]=r[2]}this.circles.count=e}updateSize(t,e){this.circles.x_pos=e.x,this.circles.y_pos=e.y,"3d"===this.mode&&(this.circles.z_pos=e.z),this.circles.localFilter=e.localFilter,this.circles.globalFilter=e.globalFilter;let n=new Uint8Array(3*t),i=new Uint8Array(3*t);i.set(this.circles.color),n.set(this.circles.pick_color),this.circles.color=i,this.circles.pick_color=n;for(let n=this.circles.count;n<t;n++){let t=3*n;const i=e.colorFunc(n);this.circles.color[t]=i[0],this.circles.color[t+1]=i[1],this.circles.color[t+2]=i[2];let r=this._getRGBFromIndex(n+1);this.circles.pick_color[t]=r[0],this.circles.pick_color[t+1]=r[1],this.circles.pick_color[t+2]=r[2]}this.circles.count=t}_getRGBFromIndex(t){var e=Math.floor(t/65536),n=t%65536;return[n%256,Math.floor(n/256),e]}_getIndexFromRGB(t){return 65536*t[2]+256*t[1]+t[0]}_drawPickBuffer(){this.regl.clear({color:[0,0,0,0],depth:1,framebuffer:this.pickbuffer}),this._drawObjects(!0)}refresh(){this.regl.clear({color:[0,0,0,0],depth:1}),this._drawObjects(!1),this._drawPickBuffer(),this.label_context.font="30px Arial"}setCamera(t,e,n){if("3d"!==this.mode)return;const i=this.camera.cameraState;i.distance=Math.log(t),i.theta=e,i.phi=n,this.camera.updateCamera()}getCameraSettings(){if("3d"!==this.mode)return;const t=this.camera.cameraState;return{distance:Math.pow(Math.E,t.distance),theta:t.theta,phi:t.phi}}zoom(t){this.x_scale*=t,this.y_scale*=t,this._drawObjects(!1)}setFilterAction(t){this.hideOnFilter="grey"!==t}_drawObjects(t){let e=null;if("3d"===this.mode){const t=this.camera.getProjection();e={cameraProjection:t.projection,cameraView:t.view,cameraDistance:t.distance,axisScales:this.axisScales,cameraEye:t.eye}}else e={x_scale:this.x_scale,y_scale:this.y_scale,offset:this.offset};e.point_scale=this.pointScale?(this.x_scale+this.y_scale)/2/this.pointScale:1,e.point_radius=this.pointRadius,e.is_filtered=this.isFiltered?1:0,e.point_opacity=this.pointOpacity,e.hide_on_filter=this.hideOnFilter?1:0;for(let r of this.draw_order){var n=this.object_types[r];if(n.data.count){if(t){if(!n.properties.pick_color)continue;t=this.pickbuffer}else t=null;if(e.buffer=t,e.count=n.data.count*n.vertices,e.primitive=n.primitive,e.is_buffer=t?1:0,2!==r){for(var i in 3===r&&(this.x_scale>=this.y_scale?(e.side_length=20*this.x_scale,e.bottom_clip=this.y_scale/this.x_scale,e.right_clip=1):(e.side_length=20*this.y_scale,e.right_clip=this.x_scale/this.y_scale,e.bottom_clip=1)),n.properties)if(t){if("pick_color"===i){e.color=n.data[i];continue}if("color"===i)continue;e[i]=n.data[i]}else{if("pick_color"===i)continue;e[i]=n.data[i]}n.method(e)}else for(let t=0;t<n.data.count;t++){for(let i in n.properties)e[i]=n.data[i].slice(6*t,6*t+6);for(let n in this.images.props)e[n]=this.images.props[n][t];n.method(e)}}}this.highlightPoints&&!t&&(e.x_pos=this.highlightPoints.x_pos,e.y_pos=this.highlightPoints.y_pos,e.color=this.highlightPoints.color,e.primitive="points",e.count=this.highlightPoints.length,"3d"===this.mode?(e.z_pos=this.highlightPoints.z_pos,this.__draw3DHighlights(e)):this.__drawHighlights(e))}getObjectsInRange(t,e,n,i){console.log(`${t},${e},${n},${i}`);const r=n*i*4;var o=this.regl.read({x:t,y:this.height-e-i,width:n,height:i,framebuffer:this.pickbuffer});const s=new Set;for(let t=0;t<r;t+=4){const e=this._getIndexFromRGB([o[t],o[t+1],o[t+2]]);null!==e&&s.add(e-1)}return s}_getObjectAtPosition(t){if(!(t[1]<=0||t[0]<=0)){try{var e=this.regl.read({x:t[0],y:this.height-t[1],width:1,height:1,framebuffer:this.pickbuffer})}catch(e){console.log(t)}if(0===e[0]&&0===e[1]&&0===e[2])return null;var n=this._getIndexFromRGB(e);return n>0?n-1:null}}addHandler(t,e,n){var i=this.handlers[t];if(!i)throw"Handler Not Supported";return n||(n=Object.keys(i).length),i[n]=e,n}removeHandler(t,e){var n=this.handlers[t];if(!n)throw"Handler Not Supported";delete n.name}_setUpBrush(t){let e=(0,T.ut)("div",{classes:["wgl2di-brush"],styles:{top:t[1]+"px",left:t[0]+"px"}},this.div_container);(0,T.$q)(e,{contain:!0,ondragstart:()=>this.brush_moving=!0,ondragend:()=>this._brushingStopped(),doc:this.__doc__}),this.brush={origin:t,div:e,resizing:!0}}_setUpPolyBrush(t){this.poly_brush={points:[t],active:!0};let e=this.label_context;e.strokeStyle=getComputedStyle(this.canvas).getPropertyValue("color"),e.beginPath(),e.moveTo(t[0],t[1])}_extendPolyBrush(t,e=15){const n=this.label_context;if(this.poly_brush.points.length){const n=this.poly_brush.points[this.poly_brush.points.length-1],i=n[0]-t[0],r=n[1]-t[1];if(Math.sqrt(i**2+r**2)<e)return}n.lineTo(t[0],t[1]),n.stroke(),this.poly_brush?.points.push(t)}_finishPolyBrush(){if(this.poly_brush.points.length<3)return void this.clearBrush();let t=this.label_context;const e=this.poly_brush.points[0];t.lineTo(e[0],e[1]),t.stroke(),t.closePath(),t.fillStyle="lightgray",t.globalAlpha=.2,t.fill(),t.globalAlpha=1;let n=[];this.poly_brush.active=!1;for(let t of this.poly_brush.points)n.push(this._getActualPosition(t));for(var i in this.handlers.brush_stopped)setTimeout((()=>this.handlers.brush_stopped[i](n,!0)),0)}clearBrush(){this.brush&&(this.brush.div.remove(),this.brush=null),this.poly_brush&&(this.label_context.clearRect(0,0,this.width,this.height),this.poly_brush=null)}_brushingStopped(){if(!this.brush)return;this.brush.resizing=!1;const t=this.brush.div,e=t.offsetTop,n=t.offsetLeft,i=t.offsetWidth,r=t.offsetHeight;if(i<2)this.clearBrush();else if("3d"===this.mode){const t=this.getObjectsInRange(n,e,i,r);for(var o in this.handlers.brush_stopped)this.handlers.brush_stopped[o](t)}else{let t=this._getActualPosition([n,e]),s=this._getActualPosition([n+i,e+r]),a={x_min:t[0],x_max:s[0],y_max:-t[1],y_min:-s[1]};for(var o in this.handlers.brush_stopped)this.handlers.brush_stopped[o](a)}}setGlobalFilter(t){this.circles.globalFilter=t}_addHandlers(){var t=this;this.div_container.addEventListener("pointermove",(function(e){if(t.brush){if(t.brush.resizing){let n=t.brush.origin,i=t._getMousePosition(e),r=Math.round(n[0]<i[0]?n[0]:i[0])+"px",o=Math.round(n[1]<i[1]?n[1]:i[1])+"px",s=Math.abs(n[0]-i[0])+"px",a=Math.abs(n[1]-i[1])+"px";return t.brush.div.style.top=o,t.brush.div.style.left=r,t.brush.div.style.width=s,void(t.brush.div.style.height=a)}if(t.brush.moving)return void(t.dragging=!1)}if(t.poly_brush&&t.poly_brush.active){let n=t._getMousePosition(e);t._extendPolyBrush(n)}if(t.mouse_position&&!t.dragging){var n=e.pageX-t.mouse_position[0],i=e.pageY-t.mouse_position[1];(Math.abs(n)>3||Math.abs(i)>3)&&(t.dragging=!0)}if(t.dragging){const n=e.pageX-t.mouse_position[0],i=e.pageY-t.mouse_position[1];if("3d"===t.mode)t.camera.mouseChange(n/t.width,i/t.height);else{const o=n/t.x_scale,s=i/t.y_scale;if(null!=t.movingImage&&e.ctrlKey&&t.images.count>0)t.moveImage(o,s),t.imageMoved=t.getImageDetails(t.movingImage);else if(t.offsets&&3==e.which)t.alterOffsets(o,s);else for(var r in t.config.lock_x_axis||(t.offset[0]+=o),t.offset[1]+=s,t.handlers.pan_or_zoom)t.handlers.pan_or_zoom[r](t.offset,t.x_scale,t.y_scale)}t.loop||(t.loop=t.regl.frame((()=>{t.regl.clear({color:[0,0,0,0],depth:1}),t._drawObjects(!1)}))),t.mouse_position[1]=e.pageY,t.mouse_position[0]=e.pageX}else{var o=t._getMousePosition(e),s=t._getObjectAtPosition(o);if(null!=s&&null==t.object_mouse_over){for(var r in t.handlers.object_over)t.handlers.object_over[r](e,s);t.object_mouse_over=s}else if(null==s&&t.object_mouse_over){for(var r in t.handlers.object_out)t.handlers.object_out[r](e,t.object_mouse_over);t.object_mouse_over=null}else if(null!=s&&s!==t.object_mouse_over){for(var r in t.handlers.object_over)t.handlers.object_over[r](e,s);t.object_mouse_over=s}}})),this.div_container.addEventListener("mouseleave",(function(e){if(t.object_mouse_over){for(var n in t.handlers.object_out)t.handlers.object_out[n](t.object_mouse_over[2]);t.object_mouse_over=null}t.brush&&t.brush.resizing&&t._brushingStopped()})),this.div_container.addEventListener("pointerup",(function(e){if(t.config.brush&&(t.div_container.style.cursor="crosshair"),t.brush&&t.brush.resizing&&t._brushingStopped(),t.poly_brush&&t.poly_brush.active&&t._finishPolyBrush(),t.dragging||t.brush||t.poly_brush){if(t.object_clicked)t.object_clicked=null,t.refresh(!0);else{let e=t.getRange();for(var n in t.loop&&(t.loop.cancel(),t.loop=null),t.refresh(),e.imageMoved=t.imageMoved,t.imageMoved=null,t.handlers.panning_stopped)t.handlers.panning_stopped[n](e)}t.dragging=!1}else{var i=t._getMousePosition(e),r=t._getObjectAtPosition(i);if(r)for(var n in t.handlers.object_clicked)t.handlers.object_clicked[n](r)}t.object_clicked=null,t.mouse_position=null})),this.div_container.addEventListener("wheel",(function(e){e.preventDefault();var n=t._getActualPosition(t._getMousePosition(e));let i=0;if(e.wheelDelta>0||e.detail<0?(t.zoom_amount+=.01,i=-30):(t.zoom_amount-=.01,i=30),"3d"===t.mode)t.camera.mouseWheel(0,i);else if(null!=t.movingImage&&e.ctrlKey){t.resizeImage(1+t.zoom_amount,t.movingImage);const i=t._getActualPosition(t._getMousePosition(e));t.moveImage(i[0]-n[0],i[1]-n[1]),t.imageMoved=t.getImageDetails(t.movingImage)}else{t.config.lock_x_axis||(t.x_scale*=1+t.zoom_amount),t.config.lock_y_axis||(t.y_scale*=1+t.zoom_amount);const i=t._getActualPosition(t._getMousePosition(e));for(var r in t.offset[0]+=i[0]-n[0],t.offset[1]+=i[1]-n[1],t.handlers.pan_or_zoom)t.handlers.pan_or_zoom[r](t.offset,t.x_scale,t.y_scale)}t.loop||(t.label_context.clearRect(0,0,t.width,t.height),t.loop=t.regl.frame((function(){t.regl.clear({color:[0,0,0,0],depth:1}),t._drawObjects(!1)}))),clearTimeout(t._timer),t._timer=setTimeout((function(){t.zoom_amount=0,t.loop.cancel(),t.loop=null,t._drawPickBuffer(!1),t.brush;let e=t.getRange();e.imageMoved=t.imageMoved,t.imageMoved=null;for(let n in t.handlers.zoom_stopped)t.handlers.zoom_stopped[n](e);t.refresh()}),350)})),this.div_container.addEventListener("pointerdown",(function(e){e.which;let n=e.shiftKey||e.ctrlKey||2==e.which||3==e.which;if(t.config.brush&&!n||!t.config.brush&&n){let n=t._getMousePosition(e);if("default"==t.config.brush){if(e.target.classList.contains("wgl2di-brush"))return;t.brush&&t.clearBrush();let n=t._getMousePosition(e);return void t._setUpBrush(n)}if("poly"===t.config.brush)return t.poly_brush&&t.clearBrush(),void t._setUpPolyBrush(n)}e.otherKey&&(t.div_container.style.cursor="move"),t._getMousePosition(e),t.mouse_position=[e.pageX,e.pageY],t.clearBrush(),e.preventDefault()}))}_initDrawMethods(){var t=this;this.__drawCircles=this.regl({depth:t.draw_options.depth,blend:t.draw_options.blend,frag:"precision mediump float;\n\t\t\tvarying vec3 fragColor;\n\t\t\tvarying float op;\n\t\t\tvarying float has_border;\n\t\t\tvarying float grey_out;\n\t\t\tuniform float is_buffer;\n\t\t\t\n\t\t\tvoid main(){\n\t\t\t\n\t\t\t\tvec2 cxy = 2.0 * gl_PointCoord - 1.0;\n                \n\t\t\t\tfloat r = dot(cxy, cxy);\n\t\t\t\tif (r > 1.0) {\n\t\t\t\t\tdiscard;\n\t\t\t\t}\n\t\t\t\telse{\t\t\t\t\t\n\t\t\t\t\tif(r>0.60 && has_border==-1.0 && is_buffer==0.0 && grey_out==0.0){\n\t\t\t\t\t    gl_FragColor=vec4(0.1,0.1,0.1,1.0);\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tif (grey_out==1.0 && is_buffer==0.0){\n\t\t\t\t\t\t\tgl_FragColor = vec4(0.2,0.2,0.2,0.4);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\tgl_FragColor = vec4(fragColor,is_buffer==1.0?1.0:op);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t}",vert:"attribute float x_pos;\n            attribute float y_pos;\n\t\t\tattribute vec3 color;\n\t\t\tattribute float lFilter;\n\t\t\tattribute float gFilter;\n\t\t\tvarying vec3 fragColor;\n\t\t\tvarying float op;\n\t\t\tvarying float has_border;\n\t\t\tvarying float grey_out;\n\t\t\tuniform float x_scale;\n\t\t\tuniform float y_scale;\n\t\t\tuniform vec2 offset;\n\t\t\tuniform float stage_height;\n\t\t\tuniform float stage_width;\n\t\t\tuniform float point_radius;\n\t\t\tuniform float is_filtered;\n\t\t\tuniform float point_opacity;\n\t\t\tuniform float hide_on_filter;\n\t\t\tuniform float point_scale;\n\t\t\t\n\t\t\tvec2 normalizeCoords(float posX, float posY){\n\t\t\t\tfloat x = (posX+offset[0])*x_scale;\n\t\t\t\tfloat y = (posY+offset[1])*y_scale;\n\t\t\t\treturn vec2(2.0 * ((x / stage_width) - 0.5),-(2.0 * ((y / stage_height) - 0.5)));\n\t\t\t}\n\t\n\t\t\tvoid main() {\n\t\t\t\tfloat dd = 0.0;\n\t\t\t\tgrey_out=0.0;\n\t\t\t\tif (lFilter==2.0){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t    if (gFilter>0.0 && gFilter != lFilter) {\n\t\t\t\t\tif(hide_on_filter==1.0){\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tgrey_out=1.0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\n\t\t\t\tfloat r=point_radius;\n\t\t\t\n\t\t\t\tgl_PointSize = r*point_scale;\n\t\t\t\tvec3 c = vec3(255.0,255.0,255.0);\n\t\t\t\tif (color==c){\n\t\t\t\t\top=0.1;\n\t\t\t\t\tfragColor=vec3(0.1,0.1,0.1);\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\top=point_opacity;\n\t\t\t\t\tfragColor = color/255.0;\n\t\t\t\t}\n\t\t\t\n\t\t\t\t\n\t\t\t\t\n\t\t\t\thas_border=lFilter-is_filtered;\n\t\t\t\n\t\t\t\t\n\t\t\t\tvec2 real_position = normalizeCoords(x_pos,-y_pos);\n\t\t\t\tgl_Position = vec4(real_position, 0.0, 1.0);\n\t\t\t}\n\t\t\t",attributes:{x_pos:t.regl.prop("x_pos"),y_pos:t.regl.prop("y_pos"),color:t.regl.prop("color"),lFilter:t.regl.prop("localFilter"),gFilter:t.regl.prop("globalFilter")},uniforms:{x_scale:t.regl.prop("x_scale"),y_scale:t.regl.prop("y_scale"),stage_width:t.regl.context("viewportWidth"),stage_height:t.regl.context("viewportHeight"),offset:t.regl.prop("offset"),point_radius:t.regl.prop("point_radius"),point_opacity:t.regl.prop("point_opacity"),is_filtered:t.regl.prop("is_filtered"),is_buffer:t.regl.prop("is_buffer"),hide_on_filter:t.regl.prop("hide_on_filter"),point_scale:t.regl.prop("point_scale")},count:t.regl.prop("count"),primitive:t.regl.prop("primitive"),framebuffer:t.regl.prop("buffer")}),this.__drawHighlights=this.regl({depth:t.draw_options.depth,blend:t.draw_options.blend,depth:t.draw_options.depth,blend:t.draw_options.blend,frag:"precision highp float;\n\t\t\tvarying vec3 fragColor;\n\t\t\t\n\t\t\tvoid main(){\n\n\t\t\t\tvec2 cxy = 2.0 * gl_PointCoord - 1.0;\n                \n\t\t\t\tfloat r = dot(cxy, cxy);\n\t\t\t\tif (r > 1.0) {\n\t\t\t\t\tdiscard;\n\t\t\t\t}\n\t\t\t\telse{\t\t\t\t\t\n\t\t\t\t\tif(r>0.50) {\n\t\t\t\t\t    gl_FragColor=vec4(0.1,0.1,0.1,1.0);\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tgl_FragColor = vec4(fragColor,1);\n\t\t\t\t\t}\n\t\t\t\t}\t\n\t\t\t}",vert:"attribute float x_pos;\n            attribute float y_pos;\n\t\t\tattribute vec3 color;\n\t\t\tuniform float point_radius;\n\t\t\t\n\t\t\tvarying vec3 fragColor;\n\t\t\n\t\t\tuniform float x_scale;\n\t\t\tuniform float y_scale;\n\t\t\tuniform vec2 offset;\n\t\t\tuniform float stage_height;\n\t\t\tuniform float stage_width;\n\t\t\tuniform float point_scale;\n\t\t\t\n\t\t\tvec2 normalizeCoords(float posX, float posY){\n\t\t\t\tfloat x = (posX+offset[0])*x_scale;\n\t\t\t\tfloat y = (posY+offset[1])*y_scale;\n\t\t\t\treturn vec2(2.0 * ((x / stage_width) - 0.5),-(2.0 * ((y / stage_height) - 0.5)));\n\t\t\t}\n\t\n\t\t\tvoid main() {\n\t\t\t\n\t\t\t\tfloat pr = point_radius*point_scale;\n\t\t\t\tpr = pr<10.0?10.0:pr;\n\t\t\t\tgl_PointSize = pr;\n\t\t\t\tfragColor = color/255.0;\n\t\t\t\t\t\n\t\t\t\tvec2 real_position = normalizeCoords(x_pos,-y_pos);\n\t\t\t\tgl_Position = vec4(real_position, 0.0, 1.0);\n\t\t\t}\n\t\t\t",attributes:{x_pos:t.regl.prop("x_pos"),y_pos:t.regl.prop("y_pos"),color:t.regl.prop("color")},uniforms:{x_scale:t.regl.prop("x_scale"),y_scale:t.regl.prop("y_scale"),stage_width:t.regl.context("viewportWidth"),stage_height:t.regl.context("viewportHeight"),offset:t.regl.prop("offset"),point_radius:t.regl.prop("point_radius"),point_scale:t.regl.prop("point_scale")},count:t.regl.prop("count"),primitive:t.regl.prop("primitive")}),this.object_types[0].method=this.__drawCircles,this.__drawLines=this.regl({frag:"precision highp float;\n\t\t\t\t\t\tvarying vec3 fragColor;\n\t\t\t\t\t\tvoid main () {\n\t\t\t\t\t\t\t gl_FragColor = vec4(fragColor,1);\n\t\t\t\t\t\t}",vert:"\n\t\t\t\t\t\tattribute vec2 position;\n\t\t\t\t\t\tattribute vec3 color;\n\t\t\t\t\t\tattribute float opacity;\n\t\t\t\t\t\tuniform float x_scale;\n\t\t\t\t\t\tuniform float y_scale;\n\t\t\t\t\t\tuniform vec2 offset;\n\t\t\t\t\t\tuniform float stage_height;\n\t\t\t\t\t\tuniform float stage_width;\n\t\t\t\t\t\tvarying vec3 fragColor;\n\t\t\t\t\t\t//varying float op;\n\t\t\t\t\t\tvec2 normalizeCoords(vec2 position){\t    \n\t\t\t\t\t\t\tfloat x = (position[0]+offset[0])*x_scale;\n\t\t\t\t\t\t\tfloat y = (position[1]+offset[1])*y_scale;\n\t\t\t\t            return vec2(2.0 * ((x / stage_width) - 0.5),-(2.0 * ((y / stage_height) - 0.5)));\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvoid main () {\n\t\t\t\t\t\t\tif (opacity==0.0){\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tfragColor=color/255.0;\n\t\t\t\t\t\t\tvec2 norm_pos =normalizeCoords(position);\n\t\t\t\t\t\t\tgl_Position = vec4(norm_pos, 0.0, 1.0);\n\t\t\t\t\t\t}",attributes:{position:t.regl.prop("position"),color:t.regl.prop("color"),opacity:t.regl.prop("opacity")},uniforms:{x_scale:t.regl.prop("x_scale"),y_scale:t.regl.prop("y_scale"),stage_height:t.regl.context("viewportHeight"),stage_width:t.regl.context("viewportWidth"),offset:t.regl.prop("offset")},primitive:t.regl.prop("primitive"),count:t.regl.prop("count")}),this.object_types[1].method=this.__drawLines,this.object_types[4].method=this.__drawLines,this.__drawImages=this.regl({frag:"\n\t\t\t\tprecision mediump float;\n\t\t\t\tuniform sampler2D text;\n\t\t\t\tvarying vec2 uv;\n\t\t\t\tvarying vec3 fragColor;\n\t\t\t\tvarying float op;\n\t\t\t\tvoid main () {\n\t\t\t\t\tgl_FragColor = vec4(fragColor,op)*texture2D(text, uv);\t\t\t\t\t\t\t\n\t\t\t\t}",vert:"\n\t\t\t\tprecision mediump float;\n\n\t\t\t\tattribute vec2 position;\n\t\t\t\tattribute vec3 color;\n\t\t\t\tattribute float opacity;\n\n\t\t\t\tuniform vec2 x_y;\n\t\t\t\tuniform vec2 w_h;\n\t\t\t\tuniform float stage_height;\n\t\t\t\tuniform float stage_width;\n\t\t\t\tuniform float x_scale;\n\t\t\t\tuniform float y_scale;\n\t\t\t\tuniform vec2 offset;\n\n\t\t\t\tvarying vec2 uv;\n\t\t\t\tvarying vec3 fragColor;\n\t\t\t\tvarying float op;\n\t\t\n\t\t\t\t\n\t\t\t\tvec2 normalizeCoords(vec2 pos){\n\t\t\t\t\tfloat x = (pos[0]+offset[0])*x_scale;\n\t\t\t\t\tfloat y = (pos[1]+offset[1])*y_scale;\n\t\t\t\t\treturn vec2(2.0 * ((x / stage_width) - 0.5),-(2.0 * ((y / stage_height) - 0.5)));\n\t\t\t\t}\n\n\t\t\t\tvoid main () {\n\t\t\t\t\tif (opacity==0.0){\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\top=opacity;\n\t\t\t\t\t\n\t\t\t\t\tvec2 new_pos=normalizeCoords(position);\n\t\t\t\t\tfragColor = color;\n\t\t\t\t\n\t\t\t\t\tfloat x_factor = 1.0/(((w_h[0]*x_scale)/stage_width)*2.0);\n\t\t\t\t\tfloat y_factor = 1.0/(((w_h[1]*y_scale)/stage_height)*2.0);\n\t\t\t\t\t\n\n\t\t\t\t\tfloat x_offset=(((x_y[0]+offset[0])*x_scale)/stage_width)*2.0*x_factor;\n\t\t\t\t\tfloat y_offset=(((x_y[1]+offset[1])*y_scale)/stage_height)*2.0*y_factor;\n\t\t\t\t\tuv = vec2((new_pos[0]*x_factor)+x_factor-x_offset,-(new_pos[1]*y_factor)+y_factor-y_offset);\n\t\t\t\t\tgl_Position = vec4(new_pos, 0.0, 1.0);\n\n\t\t\t\t}",attributes:{position:t.regl.prop("position"),color:t.regl.prop("color"),opacity:t.regl.prop("opacity")},uniforms:{stage_height:t.regl.context("viewportHeight"),stage_width:t.regl.context("viewportWidth"),w_h:t.regl.prop("w_h"),x_y:t.regl.prop("x_y"),text:t.regl.prop("text"),x_scale:t.regl.prop("x_scale"),y_scale:t.regl.prop("y_scale"),offset:t.regl.prop("offset")},count:t.regl.prop("count"),depth:t.draw_options.depth,blend:t.draw_options.blend}),this.object_types[2].method=this.__drawImages,this.__drawSquares=this.regl({frag:"\n\t\t\t\tprecision highp float;\n\t\t\t\tvarying vec3 fragColor;\n\t\t\t\tvarying float r_clip;\n\t\t\t\tvarying float b_clip;\n\t\t\t\tuniform int is_buffer;\n\t\t\t\tvoid main(){\n\t\t\t\t\tif (gl_PointCoord[1]<1.0-b_clip){\n\t\t\t\t\t\tdiscard;\n\t\t\t\t\t}\n\t\t\t\t\tif (gl_PointCoord[0]> r_clip){\n\t\t\t\t\t\tdiscard;\n\t\t\t\t\t}\t\t\t\t\n\t\t\t\t\tgl_FragColor = vec4(fragColor,1);\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\t",vert:" \n\t\t\t\tattribute float x_pos;\n\t\t\t\tattribute float y_pos;\t\t\t\n\t\t\t\tattribute vec3 color;\n\t\t\t\n\t\t\t\tvarying float r_clip;\n\t\t\t\tvarying float b_clip;\n\t\t\t\tvarying vec3 fragColor;\n\n\t\t\t\tuniform float x_scale;\n\t\t\t\tuniform float y_scale;\n\t\t\t\tuniform vec2 offset;\n\t\t\t\tuniform float stage_height;\n\t\t\t\tuniform float stage_width;\n\t\t\t\tuniform float right_clip;\n\t\t\t\tuniform float bottom_clip;\n\t\t\t\tuniform float side_length;\n\t\t\t\t\n\t\t\t\tvec2 normalizeCoords(float posX,float posY){\n\t\t\t\t\tfloat x = (posX+offset[0])*x_scale;\n\t\t\t\t\tfloat y = (posY+offset[1])*y_scale;\n\t\t\t\t\treturn vec2(2.0 * ((x / stage_width) - 0.5),-(2.0 * ((y / stage_height) - 0.5)));\n\t\t\t\t}\n\t\t\t\tvoid main() {\n\t\t\t\t\tgl_PointSize = side_length;\n\t\t\t\t\tfragColor = color/255.0;\n\t\t\t\t\tr_clip=right_clip;\n\t\t\t\t\tb_clip= bottom_clip;\n\t\t\t\t\tfloat y = y_pos;\n\t\t\t\t\tfloat x = x_pos;\n\t\t\t\t\tif (bottom_clip!=1.0){\n\t\t\t\t\t\ty-=10.0*(1.0/b_clip)-10.0;\n\t\t\t\t\t}\n\t\t\t\t\tif (r_clip!=1.0){\n\t\t\t\t\t\tx+=10.0*(1.0/r_clip)-10.0;\n\t\t\t\t\t}\n\n\t\t\t\t\tvec2 real_position = normalizeCoords(x,y);\n\t\t\t\t\n\t\t\t\t\tgl_Position = vec4(real_position, 0.0, 1.0);\n\t\t\t\t}\n\t\t\t",attributes:{x_pos:t.regl.prop("x_pos"),y_pos:t.regl.prop("y_pos"),color:t.regl.prop("color")},uniforms:{x_scale:t.regl.prop("x_scale"),y_scale:t.regl.prop("y_scale"),stage_height:t.regl.context("viewportHeight"),stage_width:t.regl.context("viewportWidth"),offset:t.regl.prop("offset"),is_buffer:t.regl.prop("is_buffer"),right_clip:t.regl.prop("right_clip"),bottom_clip:t.regl.prop("bottom_clip"),side_length:t.regl.prop("side_length")},count:t.regl.prop("count"),primitive:t.regl.prop("primitive"),framebuffer:t.regl.prop("buffer")}),this.object_types[3].method=this.__drawSquares,this.__draw3DCircles=this.regl({frag:"\n            precision highp float;\n            varying vec3 fragColor;\n\t\t\tvarying float op;\n\t\t\tvarying float has_border;\n\t\t\tuniform float is_buffer;\n\t\t\tvarying float grey_out;\n            void main () {\n\t\t\t  float r = length(gl_PointCoord.xy - 0.4) ;\n              if (r> 0.4) {\n                discard;\n              }\n\t\t\t  else{\n\t\t\t\tif(r>0.3 && has_border==-1.0 && is_buffer==0.0 && grey_out==0.0){\n\t\t\t\t\tgl_FragColor=vec4(0.1,0.1,0.1,1.0);\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tif (grey_out==1.0 && is_buffer==0.0){\n\t\t\t\t\t\tgl_FragColor = vec4(0.2,0.2,0.2,0.4);\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tgl_FragColor = vec4(fragColor,is_buffer==1.0?1.0:op);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t}\n\n\t\t\t  }\n             \n            }\n            ",vert:"\n            precision highp float;\n\n            attribute float x_pos;\n            attribute float y_pos;\n            attribute float z_pos;\n            attribute vec3 color;\n            attribute float lFilter;\n            attribute float gFilter;\n\t\t\t\n\t\t\tuniform float time;\n            uniform float cdistance;\n            uniform mat4 view, projection;\n\t\t\tuniform vec3 eye;\n\t\t\tuniform float point_radius;\n\t\t\tuniform float point_opacity;\n\t\t\tuniform float is_buffer;\n\t\t\tuniform float is_filtered;\n\t\t\tuniform float hide_on_filter;\n\t\t\tuniform vec3 axis_scales;\n\n\n            varying vec3 fragColor;\n\t\t\tvarying float op;\n\t\t\tvarying float has_border;\n\t\t\tvarying float grey_out;\n\n            void main () {\n\t\t\t\tgrey_out=0.0; \n\t\t\t    if (gFilter>0.0 && gFilter != lFilter) {\n\t\t\t\t\tif(hide_on_filter==1.0){\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tgrey_out=1.0;\n\t\t\t\t\t}\n\t\t\t\t}\n                vec3 position = vec3(-x_pos *axis_scales.x,y_pos*axis_scales.y,-z_pos*axis_scales.z);\n                fragColor=color/255.0;\n\t\t\t\top = is_buffer==1.0?1.0:point_opacity;\n\t\t\t\thas_border=lFilter-is_filtered;\n               \n\t\t\t\tgl_PointSize = point_radius; //(distance(eye, position.xyz) /30.0);\n                gl_Position = projection * view * vec4(2.0 * position, 1.0);\n            }\n            ",attributes:{x_pos:t.regl.prop("x_pos"),y_pos:t.regl.prop("y_pos"),z_pos:t.regl.prop("z_pos"),color:t.regl.prop("color"),lFilter:t.regl.prop("localFilter"),gFilter:t.regl.prop("globalFilter")},uniforms:{point_radius:t.regl.prop("point_radius"),point_opacity:t.regl.prop("point_opacity"),is_buffer:t.regl.prop("is_buffer"),view:t.regl.prop("cameraView"),cdistance:t.regl.prop("cameraDistance"),eye:t.regl.prop("cameraEye"),is_filtered:t.regl.prop("is_filtered"),hide_on_filter:t.regl.prop("hide_on_filter"),axis_scales:t.regl.prop("axisScales"),projection:(t,e)=>Jn.G3(e.cameraProjection,Math.PI/4,t.viewportWidth/t.viewportHeight,1,1e5)},count:t.regl.prop("count"),framebuffer:t.regl.prop("buffer"),blend:t.draw_options.blend,primitive:"points"}),this.__draw3DHighlights=this.regl({frag:"\n            precision mediump float;\n            varying vec3 fragColor;\n\t\t\n            void main () {\n\t\t\t  float r = length(gl_PointCoord.xy - 0.4) ;\n              if (r> 0.4) {\n                discard;\n              }\n\t\t\t  else{\n\t\t\t\tif(r>0.3){\n\t\t\t\t\tgl_FragColor=vec4(0.1,0.1,0.1,1.0);\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\t\n\t\t\t\t\t\tgl_FragColor = vec4(fragColor,1.0);\n\t\t\t\t}\n\t\t\t\t\t\n\t\t\t  }\n             \n            }\n            ",vert:"\n            precision mediump float;\n\n            attribute float x_pos;\n            attribute float y_pos;\n            attribute float z_pos;\n            attribute vec3 color;\n\t\t\t\n\t\t\tuniform float time;\n    \n            uniform mat4 view, projection;\n\t\t\tuniform vec3 eye;\n\t\t\tuniform float point_radius;\n\t\t\tuniform vec3 axis_scales;\n\t\t\n\n\n            varying vec3 fragColor;\n\t\t\n\n            void main () {\n\t\t\t\n                vec3 position = vec3(-x_pos*axis_scales.x,y_pos*axis_scales.y,-z_pos*axis_scales.z);\n                fragColor=color/255.0;\n               \n\t\t\t\tgl_PointSize = point_radius*2.0; //(distance(eye, position.xyz) /30.0);\n                gl_Position = projection * view * vec4(2.0 * position, 1.0);\n            }\n            ",attributes:{x_pos:t.regl.prop("x_pos"),y_pos:t.regl.prop("y_pos"),z_pos:t.regl.prop("z_pos"),color:t.regl.prop("color")},uniforms:{point_radius:t.regl.prop("point_radius"),view:t.regl.prop("cameraView"),cdistance:t.regl.prop("cameraDistance"),eye:t.regl.prop("cameraEye"),axis_scales:t.regl.prop("axisScales"),projection:(t,e)=>Jn.G3(e.cameraProjection,Math.PI/4,t.viewportWidth/t.viewportHeight,1,1e5)},count:t.regl.prop("count"),blend:t.draw_options.blend,primitive:"points"}),this.__draw3DLines=this.regl({frag:" precision highp float;\n                    varying vec3 fragColor;\n                    void main () {\n                         gl_FragColor = vec4(fragColor,1);\n                    }\n",vert:"\n                    attribute vec3 position;\n                    attribute vec3 color;\n                    uniform mat4 view, projection;\n\t\t\t\t\tuniform vec3 axis_scales;\n    \n                    varying vec3 fragColor;\n                  \n                    \n                    void main () {\n                     \n                        fragColor=color;\n                        gl_Position = projection * view * vec4(2.0 * position*axis_scales*vec3(-1.0,1.0,-1.0), 1.0);\n                       \n                       \n                    }",attributes:{position:t.regl.prop("position"),color:t.regl.prop("color")},uniforms:{view:t.regl.prop("cameraView"),axis_scales:t.regl.prop("axisScales"),projection:(t,e)=>Jn.G3(e.cameraProjection,Math.PI/4,t.viewportWidth/t.viewportHeight,.01,1e5)},primitive:t.regl.prop("primitive"),framebuffer:t.regl.prop("buffer"),count:t.regl.prop("count"),depth:{enable:!1}})}}const ri=class extends sn{constructor(t,e,n,i){super(t,e,n,i);const r=this.config;r.tooltip||(r.tooltip={show:!1}),r.default_color=r.default_color||"#377eb8";const o=this._getContentDimensions();this.graphDiv=(0,T.ut)("div",{styles:{position:"absolute",left:o.left+"px",top:o.top+"px",width:o.width+"px",height:o.height+"px"}},this.contentDiv),this.tooltip=(0,T.ut)("div",{styles:{position:"absolute",zIndex:100,display:"none","background-color":"lightgray"}},this.graphDiv)}onDataHighlighted(t){this.app.setHighlightPoints(t.indexes),this.app.refresh()}afterAppCreation(){const t=this,e=this.config;this.app.addHandler("object_over",(function(n,i){e.tooltip.show&&t.showTooltip(n,i)})),this.app.addHandler("object_out",(function(e,n){t.tooltip.style.display="none"})),e.default_color=e.default_color||"#377eb8",e.on_filter=null==e.on_filter?"hide":e.on_filter,this.app.setFilterAction(e.on_filter);const n=(0,z.$W)(e.default_color);let i=()=>n;if(e.color_by){const t={asArray:!0,overideValues:{colorLogScale:this.config.log_color_scale}};this._addTrimmedColor(e.color_by,t),i=this.dataStore.getColorFunction(e.color_by,t),e.color_legend||(e.color_legend={display:!0}),this.setColorLegend()}return this.app.addHandler("object_clicked",(t=>{this.dataStore.dataHighlighted([t],this)})),i}setToolTipColumn(t){this.config.tooltip.column=t}showTooltip(t,e){var n=this.graphDiv.getBoundingClientRect();const i=this.dataStore.getRowAsObject(e),r=t.clientX-n.left,o=t.clientY-n.top;this.tooltip.style.display="block",this.tooltip.style.left=r+"px",this.tooltip.style.top=o+"px",this.tooltip.textContent=i[this.config.tooltip.column]}getSetupConfig(){const t=this.config,e=(0,z.$W)(t.default_color);let n=()=>e;return t.color_by&&(n=this.dataStore.getColorFunction(t.color_by,{asArray:!0})),{localFilter:this.dim.getLocalFilter(),globalFilter:this.dataStore.getFilter(),colorFunc:n}}setSize(t,e){super.setSize(t,e);const n=this._getContentDimensions();this.app.setSize(n.width,n.height),this.graphDiv.style.left=n.left+"px",this.graphDiv.style.top=n.top+"px",this.updateAxis()}onDataFiltered(t){"all_removed"===t&&(this.app.clearBrush(),this.app.setFilter(!1),this.resetButton.style.display="none"),this.app.setHighlightPoints(null),this.app.refresh()}remove(t=!0){this.dim.destroy(t),this.app.remove(),super.remove()}removeFilter(){null!==this.filter&&(this.dim.removeFilter(),this.app.clearBrush(),this.app.setFilter(!1),this.app.refresh())}colorByColumn(t){this.config.color_by=t;const e=this.getColorFunction(t,!0),n=performance.now();this.app.colorPoints(e),console.log("color time:"+(performance.now()-n)),setTimeout((()=>{this.app.refresh()}),50)}colorByDefault(){this.legend&&this.legend.remove();const t=(0,z.$W)(this.config.default_color);this.app.colorPoints((()=>t)),setTimeout((()=>{this.app.refresh()}),50)}changeBaseDocument(t){this.app.clearBrush(),this.app.__doc__=t,super.changeBaseDocument(t)}getColorOptions(){return{colorby:"all",has_default_color:!0}}pinChart(){this.isPinned=!0,this.pinnedFilter=this.dataStore.getFilter().slice(0),this.app.setGlobalFilter(this.pinnedFilter)}unpinChart(){this.isPinned=!1,this.pinnedFilter=null,this.app.setGlobalFilter(this.dataStore.getFilter()),this.app.refresh()}addToImage(){this.app.refresh();let t=this.app.canvas.toDataURL("image/png");t=t.replace(/^data:image\/png/,"data:application/octet-stream");const e=this._getContentDimensions();this.svg.append("image").attr("xlink:href",t).attr("width",e.width).attr("height",e.height).attr("x",e.left).attr("y",e.top)}removeFromImage(){this.svg.select("image").remove()}getSettings(t){t||(t={pointMax:50,pointMin:1});const e=super.getSettings(),n=this.config,i=this.dataStore.getColumnList();return e.splice(2,0,{type:"slider",max:1,min:0,doc:this.__doc__,current_value:n.opacity,label:"Point Opacity",func:t=>{n.opacity=t,this.app.setPointOpacity(t),this.app.refresh()}},{type:"slider",max:10,min:0,doc:this.__doc__,current_value:n.radius,label:"Point Size",func:t=>{n.radius=t,this.app.setPointRadius(t),this.app.refresh(),console.log(t)}}),e.concat([{type:"check",label:"Show Tooltip",current_value:n.tooltip.show,func:t=>{n.tooltip.show=t;let e=n.tooltip.column||i[0].field;this.setToolTipColumn(e)}},{type:"dropdown",label:"Tooltip value",current_value:n.tooltip.column||i[0].field,values:[i,"name","field"],func:t=>{this.setToolTipColumn(t)}},{type:"button",label:"Centre Plot",func:t=>{this.centerGraph(),this.app.refresh()}},{type:"radiobuttons",label:"Action on Filter",choices:[["Hide Points","hide"],["Gray Out Points","grey"]],current_value:n.on_filter,func:t=>{n.on_filter=t,this.app.setFilterAction(t),this.app.refresh()}}])}};I.types.wgl_3d_scatter_plot={name:"3D Scatter Plot",class:class extends ri{constructor(t,e,n){n.title||(n.title=t.getColumnName(n.param[0])+" x "+t.getColumnName(n.param[1])+" x "+t.getColumnName(n.param[2])),super(t,e,n,{});const i=this.config,r=i.param;this.dim=this.dataStore.getDimension("range_dimension",r);const o=r.map((t=>this.dataStore.getColumnRange(t))),s=Math.max(...o);this.defaultCDistance=4*s,i.brush=i.brush||"default",i.center=i.center||[0,0,0],this.app=new ii(this.graphDiv,{mode:"3d",brush:i.brush,cameraDistance:this.defaultCDistance,cameraCenter:[2*-i.center[0],2*i.center[1],2*-i.center[2]]}),this.app.addHandler("brush_stopped",((t,e)=>{this.resetButton.style.display="inline",this.app.setFilter(!0),e?this._createPolyFilter(range):this._createFilter(t)}));const a=this.afterAppCreation();let l=this.dataStore.columnIndex[r[0]],c=this.dataStore.columnIndex[r[1]],u=this.dataStore.columnIndex[r[2]];this.app.addCircles({x:"int32"===l.datatype?new Float32Array(l.data):l.data,y:"int32"===c.datatype?new Float32Array(c.data):c.data,z:"int32"===u.datatype?new Float32Array(u.data):u.data,localFilter:this.dim.getLocalFilter(),globalFilter:t.getFilter(),colorFunc:a}),i.radius=i.radius||5,i.opacity=i.opacity||.8,this.app.setPointRadius(i.radius),this.app.setPointOpacity(i.opacity),i.axis_scales=i.axis_scales||[1,1,1],this.app.axisScales=i.axis_scales,this.addAxis(),this.centerGraph(i.camera),this.app.refresh()}setAxisScales(t,e){this.config.axis_scales[t]=e,this.app.refresh()}getSettings(){let t=super.getSettings({pointMax:30,pointMin:1});const e=this.config;return t=t.concat([{type:"slider",max:3,min:.5,doc:this.__doc__,current_value:e.axis_scales[0],label:"X Axis Scale",func:t=>{this.setAxisScales(0,t)}},{type:"slider",max:3,min:.5,doc:this.__doc__,current_value:e.axis_scales[1],label:"Y Axis Scale",func:t=>{this.setAxisScales(1,t)}},{type:"slider",max:3,min:.5,doc:this.__doc__,current_value:e.axis_scales[2],label:"Z Axis Scale",func:t=>{this.setAxisScales(2,t)}}]),t}centerGraph(t){t?this.app.setCamera(t.distance,t.theta,t.phi):this.app.setCamera(this.defaultCDistance,-1.038,.261)}getConfig(){const t=super.getConfig();return t.camera=this.app.getCameraSettings(),t}_createFilter(t){this.dim.filter("filterOnIndex",[],t)}onDataAdded(t){const e=this.config.param,n=this.getSetupConfig();n.x=this.dataStore.getRawColumn(e[0]),n.y=this.dataStore.getRawColumn(e[1]),n.z=this.dataStore.getRawColumn(e[2]),this.app.updateSize(t,n),super.onDataAdded(t)}addAxis(){for(let t=0;t<3;t++){let e=this.dataStore.getMinMaxForColumn(this.config.param[t]);const n=this.config.center.map(((t,e)=>t));n[t]=e[0];const i=this.config.center.map(((t,e)=>t));i[t]=e[1];const r=[0,0,0];r[t]=255,this.app.addLine(n,i,r)}}},params:[{type:"number",name:"X axis"},{type:"number",name:"Y axis"},{type:"number",name:"Z axis"}]};class oi extends F.v{constructor(t){super({title:"Alter Position",width:300,doc:t.__doc__},t)}init(t){this.plot=t,this.ds=this.plot.dataStore,(0,T.ut)("div",{text:"Offset"},this.dialog),this.bdiv=(0,T.ut)("div",{styles:{display:"flex",justifyContent:"center",alignItems:"center",position:"relative",height:"60px"}},this.dialog);for(let t of[["top","up"],["bottom","down"],["right","right"],["left","left"]])this._addPButton(t);(0,T.ut)("div",{text:"Rotation"},this.dialog),this.rDiv=(0,T.ut)("div",{styles:{height:"30px",position:"relative"}},this.dialog);for(let t of["left","right"])this._addRButton(t);const e=(0,T.ut)("div",{},this.dialog),n=this.ds.columnIndex[this.ds.offsets.groups].name;(0,T.ut)("div",{text:n},e),this.groupSelect=(0,T.ut)("select",{},e),(0,T.ut)("button",{classes:["ciview-button-sm"],text:"Reset"},e).addEventListener("click",(t=>{this.ds.resetColumnOffsets(this.filter,this.groupSelect.value,!0),this._showOffsets(this.groupSelect.value)}));const i=this.ds.columnIndex[this.ds.offsets.groups].values;for(let t of i)(0,T.ut)("option",{text:t,value:t},this.groupSelect);this.filter=this.plot.config.background_filter?this.plot.config.background_filter.category:null,this.groupSelect.addEventListener("change",(()=>{this._showOffsets(this.groupSelect.value)})),this._addOffsetLabels(),this._showOffsets(i[0])}_alterOffset(t){const e=this.plot.dataStore;let n=0,i=0;const r=parseFloat(this.offsetAm.value);if(isNaN(r))return;n+="right"===t?r:0,n-="left"===t?r:0,i+="up"===t?r:0,i-="down"===t?r:0;const o=this.groupSelect.value;e.setColumnOffset({group:o,offsets:[n,i],filter:this.filter},!0),this._showOffsets(o)}_addOffsetLabels(){const t=(0,T.ut)("div",{styles:{position:"absolute",top:"20px",left:"20px",display:"flex",justifyContent:"center",gap:"5px"}},this.bdiv);this.xoffset=(0,T.ut)("span",{},t),this.yoffset=(0,T.ut)("span",{},t),(0,T.ut)("span",{text:"step:"},t),this.offsetAm=(0,T.ut)("input",{styles:{width:"30px"},value:1},t);const e=(0,T.ut)("div",{styles:{position:"absolute",top:"0px",justifyContent:"center",left:"25px",display:"flex",gap:"5px"}},this.rDiv);this.angle=(0,T.ut)("span",{},e),(0,T.ut)("span",{text:"step:"},e),this.offsetAn=(0,T.ut)("input",{styles:{width:"30px"},value:1},e)}_showOffsets(t){let e=[0,0],n=0;const i=this.ds.offsets.values[this.filter||"all"];i&&i[t]&&(e=i[t].offsets,n=i[t].rotation),this.xoffset.textContent="x:"+e[0].toFixed(1),this.yoffset.textContent="y:"+e[1].toFixed(1),this.angle.textContent="angle:"+n.toFixed(1)}_addPButton(t){const e={position:"absolute",textAlign:"center",cursor:"pointer"};e[t[0]]="0px",(0,T.ut)("i",{classes:["fas",`fa-arrow-${t[1]}`],styles:e},this.bdiv).addEventListener("click",(()=>{this._alterOffset(t[1])}))}_addRButton(t){const e={position:"absolute",textAlign:"center"};e[t]="5px",(0,T.ut)("i",{classes:["fas",`fa-angle-double-${t}`],styles:e,cursor:"pointer"},this.rDiv).addEventListener("click",(e=>{const n=parseFloat(this.offsetAn.value);if(isNaN(n))return;const i="left"===t?-n:n;this.plot.dataStore.setColumnOffset({group:this.groupSelect.value,rotation:i,filter:this.filter},!0),this._showOffsets(this.groupSelect.value)}))}}class si extends ri{constructor(t,e,n){const i=t.getColumnName(n.param[0]),r=t.getColumnName(n.param[1]);n.axis||(n.axis={x:{size:30,label:i,textsize:13},y:{size:45,label:r,textsize:13}}),n.title||(n.title=i+" x "+r),super(t,e,n,{x:{},y:{}}),this.x=this.config.param[0],this.y=this.config.param[1],this.dim=this.getDimension();const o=n.background_filter;o&&this.dim.setBackgroundFilter(o.column,o.category),this.minMaxX=this.dataStore.getMinMaxForColumn(this.x),this.minMaxY=this.dataStore.getMinMaxForColumn(this.y),this.type="wgl_scatter_plot";let s=this;const a=this.config;a.brush=a.brush||"poly";let l={brush:a.brush};this.app=new ii(this.graphDiv,l),this.app.addHandler("zoom_stopped",(t=>this.handlePanZoom(t))),this.app.addHandler("panning_stopped",(t=>this.handlePanZoom(t))),this.centerGraph();const c=this.afterAppCreation();this.app.setBackGroundColor(a.background_color),this.app.addHandler("brush_stopped",(function(t,e){s.resetButton.style.display="inline",s.app.setFilter(!0),e?s._createPolyFilter(t):s._createFilter(t)})),a.background_image&&(a.image_opacity=null==a.image_opacity?1:a.image_opacity,this.addBackgroundImage(a.background_image));let u=this.dataStore.columnIndex[this.x],h=this.dataStore.columnIndex[this.y];this.app.addCircles({x:"int32"===u.datatype?new Float32Array(u.data):u.data,y:"int32"===h.datatype?new Float32Array(h.data):h.data,localFilter:this.dim.getLocalFilter(),globalFilter:this.dataStore.getFilter(),colorFunc:c}),this.defaultRadius=this._calculateRadius(),a.radius=a.radius||2,a.opacity=null==a.opacity?.8:a.opacity,this.app.setPointRadius(this.config.radius),this.app.setPointOpacity(this.config.opacity),this.onDataFiltered()}getDimension(){return this.dataStore.getDimension("range_dimension")}handlePanZoom(t){if(t.imageMoved){const e=t.imageMoved,n=this.config,i=n.background_image.name;if(e.position[1]=-(e.position[1]+e.height),n.background_image.height=e.height,n.background_image.width=e.width,n.background_image.position=e.position,n.image_choices){const t=n.image_choices.find((t=>t[0]===i));t[2]=e.width,t[3]=e.height,t[4]=e.position[0],t[5]=e.position[1]}if(this.dataStore.regions){const t=this.dataStore.regions.all_regions[n.region].images[n.background_image.name];t.position=e.position,t.height=e.height,t.wdith=e.width,this.dataStore.dirtyMetadata.add("regions")}}else this._updateScale(t),this.updateAxis()}onDataAdded(t){const e=this.getSetupConfig();e.x=this.dataStore.getRawColumn(this.x),e.y=this.dataStore.getRawColumn(this.y),this.app.updateSize(t,e),super.onDataAdded(t)}addBackgroundImage(t,e=!1){const n=new Image,i=this.config;i.image_opacity=i.image_opacity||1,n.src=t.url?t.url:this.dataStore.regions.base_url+t.file,n.onload=()=>{e?this.app.changeImage(n,t,0):(this.app.addImage(n,t),this.app.changeImageOpacity(0,i.image_opacity)),this.app.refresh()},n.onerror=()=>{delete this.config.background_image}}linkToOtherChart(t){this.app.addHandler("pan_or_zoom",((e,n,i)=>{t.app.offset=[e[0],e[1]],t.app.x_scale=n,t.app.y_scale=i,t.app.refresh(),t._updateScale(this.app.getRange()),t.updateAxis()}),this.config.id)}highlightDataItem(t){this.app.highlightPoint(t)}getFilter(){if(!this.range||!0===this.range)return null;const t={};return t[this.config.param[0]]=[this.range.x_min,this.range.x_max],t[this.config.param[1]]=[this.range.y_min,this.range.y_max],t}_updateScale(t){this.x_scale.domain([t.x_range[0],t.x_range[1]]),this.y_scale.domain([-t.y_range[0],-t.y_range[1]])}_calculateRadius(){this.width&&this.width;let t=this.config.max_x||0==this.config.max_x?this.config.max_x:this.minMaxX[1],e=this.config.min_x||0==this.config.min_x?this.config.min_x:this.minMaxX[0];this.config.axis.x_log_scale&&(t=this._getLogValue(t),e=this._getLogValue(e));let n=t-e;return Math.pow(n,1.5)/(Math.pow(this.dataStore.size,.8)+n)*5}_createFilter(t){if(this.range=t,null==t)this.dim.removeFilter();else{let e=t.y_max,n=t.y_min,i=t.x_max,r=t.x_min;this.config.axis.y_log_scale&&(e=this._getInverseLogValue(e),n=this._getInverseLogValue(n)),this.config.axis.x_log_scale&&(i=this._getInverseLogValue(i),r=this._getInverseLogValue(r)),this.filter=[[r,i],[n,e]],this.dim.filter("filterSquare",this.config.param,{range1:this.filter[0],range2:this.filter[1]})}}_createPolyFilter(t){this.range=!0;for(let e of t)e[1]=-e[1],this.config.axis.x_log_scale&&(e[0]=this._getInverseLogValue(e[0])),this.config.axis.y_log_scale&&(e[1]=this._getInverseLogValue(e[1]));this.filter=t,this.dim.filter("filterPoly",this.config.param,t)}centerGraph(){const t=this.config,e=t.roi||{};let n=e.max_x||this.minMaxX[1],i=e.max_y||this.minMaxY[1],r=e.min_x||this.minMaxX[0],o=e.min_y||this.minMaxY[0];if(t.center_using_quantiles){const e=this.dataStore.columnIndex[t.param[0]].quantiles,n=this.dataStore.columnIndex[t.param[1]].quantiles;e[t.center_using_quantiles],n[t.center_using_quantiles]}this.config.axis.y_log_scale&&(i=this._getLogValue(i),o=this._getLogValue(o)),this.config.axis.x_log_scale&&(n=this._getLogValue(n),r=this._getLogValue(r));let s=(n-r)/20,a=(i-o)/20,l=n-r+2*s,c=i-o+2*a;const u=this._getContentDimensions();this.app.x_scale=u.width/l,this.app.y_scale=u.height/c,this.app.pointScale=(this.app.x_scale+this.app.y_scale)/2,this.app.offset[0]=-(r-s),this.app.offset[1]=i+a,this._updateScale(this.app.getRange()),this.updateAxis()}getContextMenu(){const t=super.getContextMenu(),e=this.config,n=this.dataStore;if(n.offsets){const i=n.offsets,r=n.getColumnName(i.groups);i.param[0]===e.param[0]&&i.param[1]===e.param[1]&&(i.background_filter&&i.background_filter!==e?.background_filter?.column||t.push({text:`Adjust ${r} position`,icon:"fas fa-arrows-alt",func:()=>{new oi(this)}}))}return t}_addSliderToSettings(t,e,n){t.splice(1,0,{type:"slider",current_value:e.opacity,min:0,max:1,func:t=>{e.opacity=t,this.app.changeImageOpacity(n,t),this.app.refresh()}})}getConfig(){const t=super.getConfig();return t.offsets&&(t.offsets.offsets=this.app.offsets.values.offsets),t}getSettings(){const t=super.getSettings({pointMax:30,pointMin:0}),e=this.config;if(e.image_choices){const n=e.image_choices.slice(0);n.unshift(["None","__none__"]);let i="__none__";e.background_image&&(i=e.background_image.url),t.splice(1,0,{type:"dropdown",current_value:i,values:[n,0,1],label:"Change Image",func:t=>{if("__none__"===t)return delete e.background_image,this.app.removeImages(),void this.app.refresh();let n=!0;e.background_image||(e.background_image={},n=!1),e.background_image.url=t;let i=e.title.split("-")[0];const r=e.image_choices.find((e=>e[1]===t));e.background_image.name=r[0],r[2]&&(e.background_image.width=r[2],e.background_image.height=r[3],e.background_image.position=[r[4],r[5]]),this.setTitle(i+"-"+r[0]),this.addBackgroundImage(e.background_image,n)}})}const n=this.dataStore.regions;if(n&&!e.viv){const i=n.all_regions[e.region].images,r=[["None","__none__"]];for(let t in i)r.push([t,t]);let o=e.background_image?.name||"__none__";t.splice(1,0,{type:"dropdown",current_value:o,values:[r,0,1],label:"Change Image",func:t=>{if("__none__"===t)return delete e.background_image,this.app.removeImages(),void this.app.refresh();const n=!!e.background_image;e.background_image=i[t],this.setTitle(e.region+"-"+t),this.addBackgroundImage(e.background_image,n)}})}return e.background_image&&t.splice(2,0,{label:"Image Opacity",type:"slider",current_value:e.image_opacity,max:1,min:0,func:t=>{e.image_opacity=t,this.app.changeImageOpacity(0,t),this.app.refresh()}}),t.push({type:"radiobuttons",label:"Background Color",choices:[["none","none"],["white","white"],["light gray","lightgray"],["gray","gray"],["black","black"]],current_value:e.background_color||"none",func:t=>{"none"===t?delete e.background_color:e.background_color=t,this.app.setBackGroundColor(e.background_color)}}),t.concat([{type:"radiobuttons",label:"Brush Type",choices:[["Free Draw","poly"],["Rectangle","default"]],current_value:e.brush,func:t=>{this.app.clearBrush(),this.app.config.brush=t,e.brush=t}}])}}I.types.wgl_scatter_plot={name:"2D Scatter Plot",class:si,params:[{type:"number",name:"X axis"},{type:"number",name:"Y axis"}]};const ai=si;function li(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function ci(t){return function(){return t}}function ui(t,e){return e<t?-1:e>t?1:e>=t?0:NaN}function hi(t){return t}Array.prototype.slice;const di=Math.abs,fi=Math.atan2,pi=Math.cos,gi=Math.max,mi=Math.min,_i=Math.sin,vi=Math.sqrt,bi=1e-12,yi=Math.PI,wi=yi/2,xi=2*yi;function Ci(t){return t>1?0:t<-1?yi:Math.acos(t)}function ki(t){return t>=1?wi:t<=-1?-wi:Math.asin(t)}const Ei=Math.PI,Si=2*Ei,Ai=1e-6,Ti=Si-Ai;function Mi(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function Di(){return new Mi}Mi.prototype=Di.prototype={constructor:Mi,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,i){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+i)},bezierCurveTo:function(t,e,n,i,r,o){this._+="C"+ +t+","+ +e+","+ +n+","+ +i+","+(this._x1=+r)+","+(this._y1=+o)},arcTo:function(t,e,n,i,r){t=+t,e=+e,n=+n,i=+i,r=+r;var o=this._x1,s=this._y1,a=n-t,l=i-e,c=o-t,u=s-e,h=c*c+u*u;if(r<0)throw new Error("negative radius: "+r);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(h>Ai)if(Math.abs(u*a-l*c)>Ai&&r){var d=n-o,f=i-s,p=a*a+l*l,g=d*d+f*f,m=Math.sqrt(p),_=Math.sqrt(h),v=r*Math.tan((Ei-Math.acos((p+h-g)/(2*m*_)))/2),b=v/_,y=v/m;Math.abs(b-1)>Ai&&(this._+="L"+(t+b*c)+","+(e+b*u)),this._+="A"+r+","+r+",0,0,"+ +(u*d>c*f)+","+(this._x1=t+y*a)+","+(this._y1=e+y*l)}else this._+="L"+(this._x1=t)+","+(this._y1=e)},arc:function(t,e,n,i,r,o){t=+t,e=+e,o=!!o;var s=(n=+n)*Math.cos(i),a=n*Math.sin(i),l=t+s,c=e+a,u=1^o,h=o?i-r:r-i;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+l+","+c:(Math.abs(this._x1-l)>Ai||Math.abs(this._y1-c)>Ai)&&(this._+="L"+l+","+c),n&&(h<0&&(h=h%Si+Si),h>Ti?this._+="A"+n+","+n+",0,1,"+u+","+(t-s)+","+(e-a)+"A"+n+","+n+",0,1,"+u+","+(this._x1=l)+","+(this._y1=c):h>Ai&&(this._+="A"+n+","+n+",0,"+ +(h>=Ei)+","+u+","+(this._x1=t+n*Math.cos(r))+","+(this._y1=e+n*Math.sin(r))))},rect:function(t,e,n,i){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +i+"h"+-n+"Z"},toString:function(){return this._}};const Pi=Di;function Li(t){return t.innerRadius}function Ri(t){return t.outerRadius}function Ii(t){return t.startAngle}function Oi(t){return t.endAngle}function zi(t){return t&&t.padAngle}function Fi(t,e,n,i,r,o,s,a){var l=n-t,c=i-e,u=s-r,h=a-o,d=h*l-u*c;if(!(d*d<bi))return[t+(d=(u*(e-o)-h*(t-r))/d)*l,e+d*c]}function Bi(t,e,n,i,r,o,s){var a=t-n,l=e-i,c=(s?o:-o)/vi(a*a+l*l),u=c*l,h=-c*a,d=t+u,f=e+h,p=n+u,g=i+h,m=(d+p)/2,_=(f+g)/2,v=p-d,b=g-f,y=v*v+b*b,w=r-o,x=d*g-p*f,C=(b<0?-1:1)*vi(gi(0,w*w*y-x*x)),k=(x*b-v*C)/y,E=(-x*v-b*C)/y,S=(x*b+v*C)/y,A=(-x*v+b*C)/y,T=k-m,M=E-_,D=S-m,P=A-_;return T*T+M*M>D*D+P*P&&(k=S,E=A),{cx:k,cy:E,x01:-u,y01:-h,x11:k*(r/w-1),y11:E*(r/w-1)}}function Ni(){var t=Li,e=Ri,n=ci(0),i=null,r=Ii,o=Oi,s=zi,a=null;function l(){var l,c,u=+t.apply(this,arguments),h=+e.apply(this,arguments),d=r.apply(this,arguments)-wi,f=o.apply(this,arguments)-wi,p=di(f-d),g=f>d;if(a||(a=l=Pi()),h<u&&(c=h,h=u,u=c),h>bi)if(p>xi-bi)a.moveTo(h*pi(d),h*_i(d)),a.arc(0,0,h,d,f,!g),u>bi&&(a.moveTo(u*pi(f),u*_i(f)),a.arc(0,0,u,f,d,g));else{var m,_,v=d,b=f,y=d,w=f,x=p,C=p,k=s.apply(this,arguments)/2,E=k>bi&&(i?+i.apply(this,arguments):vi(u*u+h*h)),S=mi(di(h-u)/2,+n.apply(this,arguments)),A=S,T=S;if(E>bi){var M=ki(E/u*_i(k)),D=ki(E/h*_i(k));(x-=2*M)>bi?(y+=M*=g?1:-1,w-=M):(x=0,y=w=(d+f)/2),(C-=2*D)>bi?(v+=D*=g?1:-1,b-=D):(C=0,v=b=(d+f)/2)}var P=h*pi(v),L=h*_i(v),R=u*pi(w),I=u*_i(w);if(S>bi){var O,z=h*pi(b),F=h*_i(b),B=u*pi(y),N=u*_i(y);if(p<yi&&(O=Fi(P,L,B,N,z,F,R,I))){var j=P-O[0],U=L-O[1],V=z-O[0],W=F-O[1],H=1/_i(Ci((j*V+U*W)/(vi(j*j+U*U)*vi(V*V+W*W)))/2),$=vi(O[0]*O[0]+O[1]*O[1]);A=mi(S,(u-$)/(H-1)),T=mi(S,(h-$)/(H+1))}}C>bi?T>bi?(m=Bi(B,N,P,L,h,T,g),_=Bi(z,F,R,I,h,T,g),a.moveTo(m.cx+m.x01,m.cy+m.y01),T<S?a.arc(m.cx,m.cy,T,fi(m.y01,m.x01),fi(_.y01,_.x01),!g):(a.arc(m.cx,m.cy,T,fi(m.y01,m.x01),fi(m.y11,m.x11),!g),a.arc(0,0,h,fi(m.cy+m.y11,m.cx+m.x11),fi(_.cy+_.y11,_.cx+_.x11),!g),a.arc(_.cx,_.cy,T,fi(_.y11,_.x11),fi(_.y01,_.x01),!g))):(a.moveTo(P,L),a.arc(0,0,h,v,b,!g)):a.moveTo(P,L),u>bi&&x>bi?A>bi?(m=Bi(R,I,z,F,u,-A,g),_=Bi(P,L,B,N,u,-A,g),a.lineTo(m.cx+m.x01,m.cy+m.y01),A<S?a.arc(m.cx,m.cy,A,fi(m.y01,m.x01),fi(_.y01,_.x01),!g):(a.arc(m.cx,m.cy,A,fi(m.y01,m.x01),fi(m.y11,m.x11),!g),a.arc(0,0,u,fi(m.cy+m.y11,m.cx+m.x11),fi(_.cy+_.y11,_.cx+_.x11),g),a.arc(_.cx,_.cy,A,fi(_.y11,_.x11),fi(_.y01,_.x01),!g))):a.arc(0,0,u,w,y,g):a.lineTo(R,I)}else a.moveTo(0,0);if(a.closePath(),l)return a=null,l+""||null}return l.centroid=function(){var n=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,i=(+r.apply(this,arguments)+ +o.apply(this,arguments))/2-yi/2;return[pi(i)*n,_i(i)*n]},l.innerRadius=function(e){return arguments.length?(t="function"==typeof e?e:ci(+e),l):t},l.outerRadius=function(t){return arguments.length?(e="function"==typeof t?t:ci(+t),l):e},l.cornerRadius=function(t){return arguments.length?(n="function"==typeof t?t:ci(+t),l):n},l.padRadius=function(t){return arguments.length?(i=null==t?null:"function"==typeof t?t:ci(+t),l):i},l.startAngle=function(t){return arguments.length?(r="function"==typeof t?t:ci(+t),l):r},l.endAngle=function(t){return arguments.length?(o="function"==typeof t?t:ci(+t),l):o},l.padAngle=function(t){return arguments.length?(s="function"==typeof t?t:ci(+t),l):s},l.context=function(t){return arguments.length?(a=null==t?null:t,l):a},l}I.types.ring_chart={class:class extends Un{constructor(t,e,n){super(t,e,n,{x:{}}),this.config.type="ring_chart",this.pie=function(){var t=hi,e=ui,n=null,i=ci(0),r=ci(xi),o=ci(0);function s(s){var a,l,c,u,h,d=(s=li(s)).length,f=0,p=new Array(d),g=new Array(d),m=+i.apply(this,arguments),_=Math.min(xi,Math.max(-xi,r.apply(this,arguments)-m)),v=Math.min(Math.abs(_)/d,o.apply(this,arguments)),b=v*(_<0?-1:1);for(a=0;a<d;++a)(h=g[p[a]=a]=+t(s[a],a,s))>0&&(f+=h);for(null!=e?p.sort((function(t,n){return e(g[t],g[n])})):null!=n&&p.sort((function(t,e){return n(s[t],s[e])})),a=0,c=f?(_-d*b)/f:0;a<d;++a,m=u)l=p[a],u=m+((h=g[l])>0?h*c:0)+b,g[l]={data:s[l],index:a,value:h,startAngle:m,endAngle:u,padAngle:v};return g}return s.value=function(e){return arguments.length?(t="function"==typeof e?e:ci(+e),s):t},s.sortValues=function(t){return arguments.length?(e=t,n=null,s):e},s.sort=function(t){return arguments.length?(n=t,e=null,s):n},s.startAngle=function(t){return arguments.length?(i="function"==typeof t?t:ci(+t),s):i},s.endAngle=function(t){return arguments.length?(r="function"==typeof t?t:ci(+t),s):r},s.padAngle=function(t){return arguments.length?(o="function"==typeof t?t:ci(+t),s):o},s}().sort(null).value((t=>t[0])),this.arc=Ni(),this.onDataFiltered(null)}drawChart(t=1e3){(0,ft.Z)(this.contentDiv).transition().duration(t).ease(pt);const e=this._getContentDimensions(),n=Math.min(e.width,e.height)/2,i=e.left+e.width/2,r=e.top+e.height/2;this.graph_area.attr("transform",`translate(${i},${r})`),this.arc.innerRadius(.5*n).outerRadius(.9*n);const o=Math.floor(n/8),s=this.dataStore.getColumnValues(this.config.param),a=this.dataStore.getColumnColors(this.config.param),l=this.pie(this.rowData.filter((t=>0!==t[0]))),c=this;this.graph_area.selectAll(".pie-arc").data(l,((t,e)=>{t.data[1]})).join("path").on("click",((t,e)=>{c.filterCategories(s[e.data[1]],t.shiftKey)})).style("fill",((t,e)=>c.filter.length>0&&-1===c.filter.indexOf(s[t.data[1]])?"lightgray":a[t.data[1]])).attr("class","pie-arc").attr("stroke","white").attr("d",this.arc).style("stroke-width","2px"),this.graph_area.selectAll(".pie-text").data(l,((t,e)=>{t.data[1]})).join("text").on("click",((t,e)=>{c.filterCategories(s[e.data[1]],t.shiftKey)})).attr("class","pie-text").text(((t,e)=>t.endAngle-t.startAngle>.4?s[t.data[1]]:"")).attr("x",(t=>c.arc.centroid(t)[0])).attr("font-size",o+"px").attr("y",(t=>c.arc.centroid(t)[1])).attr("text-anchor","middle").attr("dominant-baseline","central")}},name:"Pie Chart",params:[{type:"text",name:"Category"}]};function ji(t){var e=0,n=t.children,i=n&&n.length;if(i)for(;--i>=0;)e+=n[i].value;else e=1;t.value=e}function Ui(t,e){t instanceof Map?(t=[void 0,t],void 0===e&&(e=Wi)):void 0===e&&(e=Vi);for(var n,i,r,o,s,a=new Zi(t),l=[a];n=l.pop();)if((r=e(n.data))&&(s=(r=Array.from(r)).length))for(n.children=r,o=s-1;o>=0;--o)l.push(i=r[o]=new Zi(r[o])),i.parent=n,i.depth=n.depth+1;return a.eachBefore($i)}function Vi(t){return t.children}function Wi(t){return Array.isArray(t)?t[1]:null}function Hi(t){void 0!==t.data.value&&(t.value=t.data.value),t.data=t.data.data}function $i(t){var e=0;do{t.height=e}while((t=t.parent)&&t.height<++e)}function Zi(t){this.data=t,this.depth=this.height=0,this.parent=null}I.types.text_box_chart={class:class extends I{constructor(t,e,n){super(t,e,n);const i=this.config;i.text=i.text||"",this.para=(0,T.ut)("div",{styles:{padding:"5px"}},this.contentDiv),Promise.all([__webpack_require__.e(589),__webpack_require__.e(103)]).then(__webpack_require__.bind(__webpack_require__,6103)).then((({default:t})=>{this.render=t,this.para.innerHTML=this.render(i.text)}))}getSettings(){const t=super.getSettings(),e=this.config;return t.push({label:"Text",type:"textbox",current_value:e.text,func:t=>{e.text=t,this.para.innerHTML=this.render(t)}}),t}},name:"Text Box",params:[],extra_controls:()=>[{type:"textbox",name:"text"}],init:(t,e,n)=>{t.text=n.text}},Zi.prototype=Ui.prototype={constructor:Zi,count:function(){return this.eachAfter(ji)},each:function(t,e){let n=-1;for(const i of this)t.call(e,i,++n,this);return this},eachAfter:function(t,e){for(var n,i,r,o=this,s=[o],a=[],l=-1;o=s.pop();)if(a.push(o),n=o.children)for(i=0,r=n.length;i<r;++i)s.push(n[i]);for(;o=a.pop();)t.call(e,o,++l,this);return this},eachBefore:function(t,e){for(var n,i,r=this,o=[r],s=-1;r=o.pop();)if(t.call(e,r,++s,this),n=r.children)for(i=n.length-1;i>=0;--i)o.push(n[i]);return this},find:function(t,e){let n=-1;for(const i of this)if(t.call(e,i,++n,this))return i},sum:function(t){return this.eachAfter((function(e){for(var n=+t(e.data)||0,i=e.children,r=i&&i.length;--r>=0;)n+=i[r].value;e.value=n}))},sort:function(t){return this.eachBefore((function(e){e.children&&e.children.sort(t)}))},path:function(t){for(var e=this,n=function(t,e){if(t===e)return t;var n=t.ancestors(),i=e.ancestors(),r=null;for(t=n.pop(),e=i.pop();t===e;)r=t,t=n.pop(),e=i.pop();return r}(e,t),i=[e];e!==n;)e=e.parent,i.push(e);for(var r=i.length;t!==n;)i.splice(r,0,t),t=t.parent;return i},ancestors:function(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e},descendants:function(){return Array.from(this)},leaves:function(){var t=[];return this.eachBefore((function(e){e.children||t.push(e)})),t},links:function(){var t=this,e=[];return t.each((function(n){n!==t&&e.push({source:n.parent,target:n})})),e},copy:function(){return Ui(this).eachBefore(Hi)},[Symbol.iterator]:function*(){var t,e,n,i,r=this,o=[r];do{for(t=o.reverse(),o=[];r=t.pop();)if(yield r,e=r.children)for(n=0,i=e.length;n<i;++n)o.push(e[n])}while(o.length)}};const qi={euclidean:function(t,e){for(var n=0,i=0;i<t.length;i++)n+=Math.pow(isNaN(e[i])?0:e[i]-t[i],2);return Math.sqrt(n)},manhattan:function(t,e){for(var n=0,i=0;i<t.length;i++)n+=Math.abs(e[i]-t[i]);return n},max:function(t,e){for(var n=0,i=0;i<t.length;i++)n=Math.max(n,Math.abs(e[i]-t[i]));return n}};class Gi{constructor(t,e,n){this.distance=qi[t],this.distance||(this.distance=qi.euclidean),this.linkage=e||"average",this.threshold=null==n?1/0:n}cluster(t,e,n){this.clusters=[],this.dists=[],this.mins=[],this.index=[];for(var i=0;i<t.length;i++){var r={value:t[i],key:i,index:i,size:1};this.clusters[i]=r,this.index[i]=r,this.dists[i]=[],this.mins[i]=0}for(i=0;i<this.clusters.length;i++)for(var o=0;o<=i;o++){var s=i==o?1/0:this.distance(this.clusters[i].value,this.clusters[o].value);this.dists[i][o]=s,this.dists[o][i]=s,s<this.dists[i][this.mins[i]]&&(this.mins[i]=o)}var a=this.mergeClosest();for(i=0;a;)n&&i++%e==0&&n(this.clusters),a=this.mergeClosest();return this.clusters.forEach((function(t){delete t.key,delete t.index})),this.node_order=[],this.order=0,this.orderClusters(this.clusters[0]),this.clusters}mergeClosest(){for(var t=0,e=1/0,n=0;n<this.clusters.length;n++){var i=this.clusters[n].key;(a=this.dists[i][this.mins[i]])<e&&(t=i,e=a)}if(e>=this.threshold)return!1;var r=this.index[t],o=this.index[this.mins[t]],s={children:[r,o],key:r.key,size:r.size+o.size};for(this.clusters[r.index]=s,this.clusters.splice(o.index,1),this.index[r.key]=s,n=0;n<this.clusters.length;n++){var a,l=this.clusters[n];r.key==l.key?a=1/0:"single"==this.linkage?(a=this.dists[r.key][l.key],this.dists[r.key][l.key]>this.dists[o.key][l.key]&&(a=this.dists[o.key][l.key])):"complete"==this.linkage?(a=this.dists[r.key][l.key],this.dists[r.key][l.key]<this.dists[o.key][l.key]&&(a=this.dists[o.key][l.key])):a="average"==this.linkage?(this.dists[r.key][l.key]*r.size+this.dists[o.key][l.key]*o.size)/(r.size+o.size):this.distance(l.value,r.value),this.dists[r.key][l.key]=this.dists[l.key][r.key]=a}for(n=0;n<this.clusters.length;n++){var c=this.clusters[n].key;if(this.mins[c]==r.key||this.mins[c]==o.key){e=c;for(var u=0;u<this.clusters.length;u++){var h=this.clusters[u].key;this.dists[c][h]<this.dists[c][e]&&(e=h)}this.mins[c]=e}this.clusters[n].index=n}return delete r.key,delete o.key,delete r.index,delete o.index,!0}orderClusters(t){for(let e in t)"children"===e&&(this.orderClusters(t[e][0]),this.orderClusters(t[e][1])),"value"===e&&(t[e]._order=this.order++,this.node_order.push(t[e]._id))}}function Ki(t,e={}){const n=new Gi(e.distance,e.linkage,e.threshold);n.cluster(t);const i=Ui(n.clusters[0]);for(let t of i.descendants()){let e=t.data;delete e.size,e.value&&(e.id=e.value._id,e.order=e.value._order,delete e.value)}return{nodes:i,order:n.node_order}}function Xi(t,e){let n;if(void 0===e)for(const e of t)null!=e&&(n<e||void 0===n&&e>=e)&&(n=e);else{let i=-1;for(let r of t)null!=(r=e(r,++i,t))&&(n<r||void 0===n&&r>=r)&&(n=r)}return n}const Yi=t=>()=>t;function Qi(t,{sourceEvent:e,subject:n,target:i,identifier:r,active:o,x:s,y:a,dx:l,dy:c,dispatch:u}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:i,enumerable:!0,configurable:!0},identifier:{value:r,enumerable:!0,configurable:!0},active:{value:o,enumerable:!0,configurable:!0},x:{value:s,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:c,enumerable:!0,configurable:!0},_:{value:u}})}function Ji(t){return!t.ctrlKey&&!t.button}function tr(){return this.parentNode}function er(t,e){return null==e?{x:t.x,y:t.y}:e}function nr(){return navigator.maxTouchPoints||"ontouchstart"in this}function ir(t,e){var n,i=1;function r(){var r,o,s=n.length,a=0,l=0;for(r=0;r<s;++r)a+=(o=n[r]).x,l+=o.y;for(a=(a/s-t)*i,l=(l/s-e)*i,r=0;r<s;++r)(o=n[r]).x-=a,o.y-=l}return null==t&&(t=0),null==e&&(e=0),r.initialize=function(t){n=t},r.x=function(e){return arguments.length?(t=+e,r):t},r.y=function(t){return arguments.length?(e=+t,r):e},r.strength=function(t){return arguments.length?(i=+t,r):i},r}function rr(t){return function(){return t}}function or(t){return 1e-6*(t()-.5)}function sr(t){return t.index}function ar(t,e){var n=t.get(e);if(!n)throw new Error("node not found: "+e);return n}function lr(t,e,n,i){if(isNaN(e)||isNaN(n))return t;var r,o,s,a,l,c,u,h,d,f=t._root,p={data:i},g=t._x0,m=t._y0,_=t._x1,v=t._y1;if(!f)return t._root=p,t;for(;f.length;)if((c=e>=(o=(g+_)/2))?g=o:_=o,(u=n>=(s=(m+v)/2))?m=s:v=s,r=f,!(f=f[h=u<<1|c]))return r[h]=p,t;if(a=+t._x.call(null,f.data),l=+t._y.call(null,f.data),e===a&&n===l)return p.next=f,r?r[h]=p:t._root=p,t;do{r=r?r[h]=new Array(4):t._root=new Array(4),(c=e>=(o=(g+_)/2))?g=o:_=o,(u=n>=(s=(m+v)/2))?m=s:v=s}while((h=u<<1|c)==(d=(l>=s)<<1|a>=o));return r[d]=f,r[h]=p,t}function cr(t,e,n,i,r){this.node=t,this.x0=e,this.y0=n,this.x1=i,this.y1=r}function ur(t){return t[0]}function hr(t){return t[1]}function dr(t,e,n){var i=new fr(null==e?ur:e,null==n?hr:n,NaN,NaN,NaN,NaN);return null==t?i:i.addAll(t)}function fr(t,e,n,i,r,o){this._x=t,this._y=e,this._x0=n,this._y0=i,this._x1=r,this._y1=o,this._root=void 0}function pr(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}Qi.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};var gr=dr.prototype=fr.prototype;gr.copy=function(){var t,e,n=new fr(this._x,this._y,this._x0,this._y0,this._x1,this._y1),i=this._root;if(!i)return n;if(!i.length)return n._root=pr(i),n;for(t=[{source:i,target:n._root=new Array(4)}];i=t.pop();)for(var r=0;r<4;++r)(e=i.source[r])&&(e.length?t.push({source:e,target:i.target[r]=new Array(4)}):i.target[r]=pr(e));return n},gr.add=function(t){const e=+this._x.call(null,t),n=+this._y.call(null,t);return lr(this.cover(e,n),e,n,t)},gr.addAll=function(t){var e,n,i,r,o=t.length,s=new Array(o),a=new Array(o),l=1/0,c=1/0,u=-1/0,h=-1/0;for(n=0;n<o;++n)isNaN(i=+this._x.call(null,e=t[n]))||isNaN(r=+this._y.call(null,e))||(s[n]=i,a[n]=r,i<l&&(l=i),i>u&&(u=i),r<c&&(c=r),r>h&&(h=r));if(l>u||c>h)return this;for(this.cover(l,c).cover(u,h),n=0;n<o;++n)lr(this,s[n],a[n],t[n]);return this},gr.cover=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,i=this._y0,r=this._x1,o=this._y1;if(isNaN(n))r=(n=Math.floor(t))+1,o=(i=Math.floor(e))+1;else{for(var s,a,l=r-n||1,c=this._root;n>t||t>=r||i>e||e>=o;)switch(a=(e<i)<<1|t<n,(s=new Array(4))[a]=c,c=s,l*=2,a){case 0:r=n+l,o=i+l;break;case 1:n=r-l,o=i+l;break;case 2:r=n+l,i=o-l;break;case 3:n=r-l,i=o-l}this._root&&this._root.length&&(this._root=c)}return this._x0=n,this._y0=i,this._x1=r,this._y1=o,this},gr.data=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},gr.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},gr.find=function(t,e,n){var i,r,o,s,a,l,c,u=this._x0,h=this._y0,d=this._x1,f=this._y1,p=[],g=this._root;for(g&&p.push(new cr(g,u,h,d,f)),null==n?n=1/0:(u=t-n,h=e-n,d=t+n,f=e+n,n*=n);l=p.pop();)if(!(!(g=l.node)||(r=l.x0)>d||(o=l.y0)>f||(s=l.x1)<u||(a=l.y1)<h))if(g.length){var m=(r+s)/2,_=(o+a)/2;p.push(new cr(g[3],m,_,s,a),new cr(g[2],r,_,m,a),new cr(g[1],m,o,s,_),new cr(g[0],r,o,m,_)),(c=(e>=_)<<1|t>=m)&&(l=p[p.length-1],p[p.length-1]=p[p.length-1-c],p[p.length-1-c]=l)}else{var v=t-+this._x.call(null,g.data),b=e-+this._y.call(null,g.data),y=v*v+b*b;if(y<n){var w=Math.sqrt(n=y);u=t-w,h=e-w,d=t+w,f=e+w,i=g.data}}return i},gr.remove=function(t){if(isNaN(o=+this._x.call(null,t))||isNaN(s=+this._y.call(null,t)))return this;var e,n,i,r,o,s,a,l,c,u,h,d,f=this._root,p=this._x0,g=this._y0,m=this._x1,_=this._y1;if(!f)return this;if(f.length)for(;;){if((c=o>=(a=(p+m)/2))?p=a:m=a,(u=s>=(l=(g+_)/2))?g=l:_=l,e=f,!(f=f[h=u<<1|c]))return this;if(!f.length)break;(e[h+1&3]||e[h+2&3]||e[h+3&3])&&(n=e,d=h)}for(;f.data!==t;)if(i=f,!(f=f.next))return this;return(r=f.next)&&delete f.next,i?(r?i.next=r:delete i.next,this):e?(r?e[h]=r:delete e[h],(f=e[0]||e[1]||e[2]||e[3])&&f===(e[3]||e[2]||e[1]||e[0])&&!f.length&&(n?n[d]=f:this._root=f),this):(this._root=r,this)},gr.removeAll=function(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this},gr.root=function(){return this._root},gr.size=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},gr.visit=function(t){var e,n,i,r,o,s,a=[],l=this._root;for(l&&a.push(new cr(l,this._x0,this._y0,this._x1,this._y1));e=a.pop();)if(!t(l=e.node,i=e.x0,r=e.y0,o=e.x1,s=e.y1)&&l.length){var c=(i+o)/2,u=(r+s)/2;(n=l[3])&&a.push(new cr(n,c,u,o,s)),(n=l[2])&&a.push(new cr(n,i,u,c,s)),(n=l[1])&&a.push(new cr(n,c,r,o,u)),(n=l[0])&&a.push(new cr(n,i,r,c,u))}return this},gr.visitAfter=function(t){var e,n=[],i=[];for(this._root&&n.push(new cr(this._root,this._x0,this._y0,this._x1,this._y1));e=n.pop();){var r=e.node;if(r.length){var o,s=e.x0,a=e.y0,l=e.x1,c=e.y1,u=(s+l)/2,h=(a+c)/2;(o=r[0])&&n.push(new cr(o,s,a,u,h)),(o=r[1])&&n.push(new cr(o,u,a,l,h)),(o=r[2])&&n.push(new cr(o,s,h,u,c)),(o=r[3])&&n.push(new cr(o,u,h,l,c))}i.push(e)}for(;e=i.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},gr.x=function(t){return arguments.length?(this._x=t,this):this._x},gr.y=function(t){return arguments.length?(this._y=t,this):this._y};const mr=4294967296;function _r(t){return t.x}function vr(t){return t.y}var br=Math.PI*(3-Math.sqrt(5));function yr(t){return null==t?null:function(t){if("function"!=typeof t)throw new Error;return t}(t)}var wr={depth:-1},xr={},Cr={};function kr(t){return t.id}function Er(t){return t.parentId}function Sr(t){let e=t.length;if(e<2)return"";for(;--e>1&&!Ar(t,e););return t.slice(0,e)}function Ar(t,e){if("/"===t[e]){let n=0;for(;e>0&&"\\"===t[--e];)++n;if(0==(1&n))return!0}return!1}function Tr(t,e){return t.parent===e.parent?1:2}function Mr(t){var e=t.children;return e?e[0]:t.t}function Dr(t){var e=t.children;return e?e[e.length-1]:t.t}function Pr(t,e,n){var i=n/(e.i-t.i);e.c-=i,e.s+=n,t.c+=i,e.z+=n,e.m+=n}function Lr(t,e,n){return t.a.parent===e.parent?t.a:n}function Rr(t,e){this._=t,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=e}Rr.prototype=Object.create(Zi.prototype);var Ir=__webpack_require__(1102);function Or(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function zr(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function Fr(t){return t<0?-t*t:t*t}function Br(t){var e=t(Ir.yR,Ir.yR),n=1;function i(){return 1===n?t(Ir.yR,Ir.yR):.5===n?t(zr,Fr):t(Or(n),Or(1/n))}return e.exponent=function(t){return arguments.length?(n=+t,i()):n},(0,St.Q)(e)}function Nr(){var t=Br((0,Ir.l4)());return t.copy=function(){return(0,Ir.JG)(t,Nr()).exponent(t.exponent())},mt.o.apply(t,arguments),t}function jr(){return Nr.apply(null,arguments).exponent(.5)}var Ur=new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map((function(t){for(var e=t.length/6|0,n=new Array(e),i=0;i<e;)n[i]="#"+t.slice(6*i,6*++i);return n}));function Vr(t,e,n){this.k=t,this.x=e,this.y=n}(t=>{(0,be.hD)(t[t.length-1])})(Ur),Vr.prototype={constructor:Vr,scale:function(t){return 1===t?this:new Vr(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new Vr(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}},new Vr(1,0,0),Vr.prototype;function Wr(t){this._context=t}function Hr(t){return new Wr(t)}function $r(t){return t[0]}function Zr(t){return t[1]}function qr(t,e){var n=ci(!0),i=null,r=Hr,o=null;function s(s){var a,l,c,u=(s=li(s)).length,h=!1;for(null==i&&(o=r(c=Pi())),a=0;a<=u;++a)!(a<u&&n(l=s[a],a,s))===h&&((h=!h)?o.lineStart():o.lineEnd()),h&&o.point(+t(l,a,s),+e(l,a,s));if(c)return o=null,c+""||null}return t="function"==typeof t?t:void 0===t?$r:ci(t),e="function"==typeof e?e:void 0===e?Zr:ci(e),s.x=function(e){return arguments.length?(t="function"==typeof e?e:ci(+e),s):t},s.y=function(t){return arguments.length?(e="function"==typeof t?t:ci(+t),s):e},s.defined=function(t){return arguments.length?(n="function"==typeof t?t:ci(!!t),s):n},s.curve=function(t){return arguments.length?(r=t,null!=i&&(o=r(i)),s):r},s.context=function(t){return arguments.length?(null==t?i=o=null:o=r(i=t),s):i},s}function Gr(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function Kr(t){this._context=t}function Xr(t){return new Kr(t)}I.types.heat_map={name:"Heat Map",class:class extends sn{constructor(t,e,n){n.title=n.title||t.getColumnName(n.param[0]),super(t,e,n,{x:{type:"band"},y:{type:"band"},tx:{custom:!0,size:45}});const i=this.config.param,r=this.dataStore.getColumnValues(i[0]);this.x_scale.domain(r.slice(0));const o=[],s=this.config;s.method=s.method||"mean",s.color_scale=s.color_scale||{log:!1},s.color_legend||(s.color_legend={display:!0}),this.setColorFunction();for(let t=1;t<i.length;t++)o.push(this.dataStore.getColumnName(i[t]));this.cat_scale=(0,St.Z)().range([0,40]),this.cat_axis_svg=this.svg.append("g"),this.cat_axis_call=(0,tn.y4)(this.cat_scale).ticks(3),this.y_scale.domain(o),this.dim=this.dataStore.getDimension("catcol_dimension"),s.cluster_rows&&(this.margins.right=70),this.addToolTip(),this.onDataFiltered()}remove(t=!0){this.dim.destroy(t),super.remove()}setColorFunction(){const t=this.config.param,e={useValue:!0,overideValues:{colorLogScale:this.config.color_scale.log,colors:["#313695","#4575B4","#74ADD1","#ABD9E9","#E0F3F8","#E0F3F8","#FFFFBF","#FEE090","#FDAE61","#F46D43","#D73027","#A50026"],max:1,min:0}};this.colorFunction=this.dataStore.getColorFunction(t[1],e),this.setColorLegend()}getColorLegend(){const t={overideValues:{max:1,min:0,colorLogScale:this.config.color_scale.log,colors:["#313695","#4575B4","#74ADD1","#ABD9E9","#E0F3F8","#E0F3F8","#FFFFBF","#FEE090","#FDAE61","#F46D43","#D73027","#A50026"]},name:"Scale"};return this.dataStore.getColorLegend(this.config.param[1],t)}onDataFiltered(t){if(this.dim===t||this.isPinned)return;"all_removed"===t&&(this.filter=[],this.resetButton.style.display="none");const e={method:this.config.method,scaleVals:[]},n=this.config.param;let i="none"==this.config.color_scale.trim?null:this.config.color_scale.trim;for(let t=1;t<n.length;t++){const r=this.dataStore.columnIndex[n[t]];e.scaleVals.push([i?r.quantiles[i][0]:r.minMax[0],i?r.quantiles[i][1]:r.minMax[1]])}this.dim.getAverages((t=>{this.data=t,this.clusterRows(),this.clusterColumns(),this.drawChart()}),this.config.param,e)}clusterRows(){this.config.cluster_rows?(this.rowClusterNodes=Ki(this.data.averages),this.data.averages.sort(((t,e)=>t._order-e._order)),this.margins.right=70,this.y_scale.domain(this.rowClusterNodes.order.map((t=>this.dataStore.getColumnName(this.config.param[t+1]))))):(delete this.rowClusterNodes,this.y_scale.domain(this.config.param.slice(1).map((t=>this.dataStore.getColumnName(t)))),this.margins.right=10,this.data.averages.sort(((t,e)=>t._id-e._id)),this.ry_axis_svg.selectAll("*").remove())}clusterColumns(){const t=this.dataStore.getColumnValues(this.config.param[0]);this.config.cluster_columns?(this.columnClusterNodes=Ki(this.data.transpose),this.data.transpose.sort(((t,e)=>t._order-e._order)),this.x_scale.domain(this.columnClusterNodes.order.map((e=>t[e]))),this.setAxisSize("tx",85)):(delete this.columnClusterNodes,this.x_scale.domain(this.data.transpose.map((e=>t[e._id]))),this.setAxisSize("tx",45),this.data.transpose.sort(((t,e)=>t._id-e._id)),this.x_scale.domain(this.data.transpose.map((e=>t[e._id]))),this.tx_axis_svg.selectAll("path").remove())}drawChart(t=400){const e=(0,ft.Z)(this.contentDiv).transition().duration(t).ease(pt),n=this.dataStore.getColumnValues(this.config.param[0]),i=this.dataStore.getColumnColors(this.config.param[0]),r=this._getContentDimensions(),o=r.width/this.data.transpose.length,s=o/2,a=Math.max(...this.data.catTotals);this.cat_scale.domain([a,0]);const l=0===a?0:40/a,c=this.data.transpose.map((t=>[this.data.catTotals[t._id],t._id])),u=this,h=r.height/(this.config.param.length-1);this.graph_area.selectAll(".heatmap-row").data(this.data.averages).join("g").attr("transform",((t,e)=>`translate(0,${e*h})`)).attr("class","heatmap-row").selectAll(".heatmap-rect").data((t=>t.map(((e,n)=>{const i=t._id,r=u.data.transpose[n]._id;return{av:u.data.transpose[n][i],row_id:i,col_id:r,miss:!1}})))).join("rect").attr("class","heatmap-rect").attr("x",((t,e)=>e*o)).attr("height",h).attr("width",o).on("click",((t,e)=>{const i=u.config.param[e.row_id+1];this._callListeners("cell_clicked",{row:i,col:n[e.col_id],val:e.av})})).on("mouseover pointermove",((t,e)=>{const i=u.dataStore.columnIndex[u.config.param[e.row_id+1]].name;u.showToolTip(t,`${n[e.col_id]}<br>${i}<br>${e.av.toPrecision(2)}`)})).on("mouseleave",(()=>{u.hideToolTip()})).transition(e).attr("fill",((t,e)=>t.miss?"#DCDCDC":u.colorFunction(t.av)));const d=(0,ft.Z)(this.contentDiv).transition().duration(t).ease(pt);this.tx_axis_svg.selectAll(".heatmap-catsize").data(c,((t,e)=>t[1])).join((t=>t.append("rect").attr("class","heatmap-catsize").attr("height",0).attr("y",45).attr("x",((t,e)=>s/2+e*o)).attr("width",s)),(t=>t),(t=>t.call((t=>t.transition(d).attr("height",0).attr("y",45).remove())))).transition(d).attr("y",(t=>40-t[0]*l+5)).attr("height",(t=>t[0]*l)).attr("fill",((t,e)=>i[t[1]])).attr("width",s).attr("x",((t,e)=>s/2+e*o)),this.cat_axis_svg.attr("transform",`translate(${r.left},5)`),this.cat_axis_svg.transition().call(this.cat_axis_call),this.updateAxis(),this.rowClusterNodes&&this.drawYTree(this.rowClusterNodes.nodes,this.config.param.length-1),this.columnClusterNodes&&this.drawXTree(this.columnClusterNodes.nodes,this.data.transpose.length,40,45)}setSize(t,e){super.setSize(t,e),this.drawChart()}getSettings(){const t=this.config;return super.getSettings().concat([{type:"check",label:"Cluster Rows",current_value:t.cluster_rows,func:e=>{t.cluster_rows=e,this.clusterRows(),this.drawChart()}},{type:"check",label:"Cluster Columns",current_value:t.cluster_columns,func:e=>{t.cluster_columns=e,this.clusterColumns(),this.drawChart()}},{type:"radiobuttons",label:"Averaging Method",current_value:t.method,choices:[["Mean","mean"],["Median","median"]],func:e=>{t.method=e,this.onDataFiltered()}},{type:"radiobuttons",label:"Trim to Percentile",current_value:t.color_scale.trim||"none",choices:[["No Trim","none"],["0.001","0.001"],["0.01","0.01"],["0.05","0.05"]],func:e=>{t.color_scale.trim=e,this.onDataFiltered()}},{label:"Show Color Legend",type:"check",current_value:!t.color_legend||t.color_legend.display,func:e=>{t.color_legend.display=e,this.setColorLegend()}},{type:"check",label:"Log Color Scale",current_value:t.color_scale.log,func:e=>{t.color_scale.log=e,this.setColorFunction(),this.drawChart()}}])}},params:[{type:"text",name:"Categories on x-axis"},{type:"_multi_column:number",name:"Fields on y axis"}]},Wr.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}},Kr.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Gr(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Gr(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};class Yr extends ri{constructor(t,e,n){const i=t.getColumnName(n.param[0]),r=t.getColumnName(n.param[1]);n.axis||(n.axis={x:{size:30,label:i,textsize:13},y:{size:45,label:r,textsize:13}}),n.title||(n.title=i+" x "+r),super(t,e,n,{x:{type:"band"},y:{}}),this.config.type="violin_plot";const o=this.config;o.brush=o.brush||"poly";let s={brush:o.brush};this.app=new ii(this.graphDiv,s);const a=this.afterAppCreation(),l=this.dataStore.size;this.xPosBuff=new SharedArrayBuffer(4*l),this.xPos=new Float32Array(this.xPosBuff),this.values=this.dataStore.getColumnValues(o.param[0]);const c=this.dataStore.getRawColumn(o.param[0]);for(let t=0;t<l;t++)this.xPos[t]=50*c[t]+4+42*Math.random();const u=this.dataStore.getMinMaxForColumn(o.param[1]);this.defaultBandWidth=(u[1]-u[0])/100,o.band_width=o.band_width||this.defaultBandWidth,o.intervals=o.intervals||20,this.dim=this.dataStore.getDimension("catrange_dimension"),this.x_scale.domain(this.values);const h=this.dataStore.columnIndex[o.param[1]];this.app.addCircles({x:this.xPos,y:"int32"===h.datatype?new Float32Array(h.data):h.data,localFilter:this.dim.getLocalFilter(),globalFilter:this.dataStore.getFilter(),colorFunc:a}),this.app.addHandler("brush_stopped",((t,e)=>{this.resetButton.style.display="inline",this.app.setFilter(!0),e?this._createPolyFilter(t):this._createFilter(t)})),o.radius=o.radius||5,o.opacity=o.opacity||.8,this.app.setPointRadius(this.config.radius),this.app.setPointOpacity(this.config.opacity),this.data=[],this.centerGraph(),this.onDataFiltered()}_createFilter(t){if(this.range=t,null==t)this.dim.removeFilter();else{let e=t.y_max,n=t.y_min,i=t.x_max,r=t.x_min;this.filter=[[r,i],[n,e]],this.dim("filterSquare",[this.xPos,this.config.param[1]],{range1:this.filter[0],range2:this.filter[1]},[this.xPos,1]),this.app.refresh()}}onDataFiltered(t){if(!this.isPinned&&t!==this.dim){"all_removed"===t&&(this.app.clearBrush(),this.app.setFilter(!1),this.resetButton.style.display="none");const e=this.config;this.ticks=this.y_scale.ticks(e.intervals),this.dim.getKernalDensity((t=>{this.data=t,this.drawChart()}),e.param,{ticks:this.ticks,bandwidth:e.band_width,intervals:e.intervals,xPos:this.xPosBuff})}}drawChart(){const t=(0,ft.Z)(this.contentDiv).transition().duration(400).ease(pt),e=[],n=this.data.length,i=this._getContentDimensions(),r=i.width/n,o=[];for(let t=0;t<this.data.length;t++)e.push(r/(2*this.data[t].max)*.9),o.push(this.values[this.data[t].id]);this.x_scale.domain(o),this.centerGraph();const s=this.ticks.map((t=>this.y_scale(t))),a=[];for(let t=0;t<this.data.length;t++){const n=t*r+.5*r,o=[];let l=!0;for(let i=0;i<this.data[t].length;i++){const r=this.data[t][i];if(0===r||isNaN(r)){if(!l){if(0==o[o.length-1][2])continue;o.push([s[i],n,0])}}else{if(0===o.length){if(0===i){o.push([0,n,0]);continue}o.push([s[i-1],n,0]),l=!1}o.push([s[i],n,e[t]*r])}}0===o.length?(o.push([0,n,0]),o.push([0,n,0])):0!==o[o.length-1][2]&&o.push([i.height,n,0]),a.push(o),o.id=this.data[t].id}const l=this.dataStore.getColumnColors(this.config.param[0]);this.graph_area.selectAll(".violin-curve").data(a,(t=>"A"+t.id)).join("path").attr("class","violin-curve").transition(t).attr("fill","none").attr("stroke",((t,e)=>l[t.id])).attr("stroke-width",2).attr("stroke-linejoin","round").attr("d",qr().curve(Xr).x((function(t,e){return t[1]+t[2]})).y((function(t,e){return t[0]}))),this.graph_area.selectAll(".violin-curve1").data(a,(t=>"B"+t.id)).join("path").attr("class","violin-curve1").transition(t).attr("fill","none").attr("stroke",((t,e)=>l[t.id])).attr("stroke-width",2).attr("stroke-linejoin","round").attr("d",qr().curve(Xr).x((function(t,e){return t[1]-t[2]})).y((function(t,e){return t[0]}))),this.app.refresh()}unpinChart(){super.unpinChart(),this.onDataFiltered()}onDataAdded(t){const e=this.config.param,n=this.getSetupConfig();let i=new Float32Array(t);i.set(this.xPos),this.values=this.dataStore.getColumnValues(e[0]);const r=this.dataStore.getRawColumn(e[0]);for(let e=this.xPos.length;e<t;e++)i[e]=50*r[e]+4+42*Math.random();this.xPos=i,n.x=i,n.y=this.dataStore.getRawColumn(e[1]),this.dim.filterColumns&&(this.dimFilterColumns[0]=i),this.app.updateSize(t,n),super.onDataAdded(t)}setSize(t,e){super.setSize(t,e),this.drawChart()}centerGraph(){const t=this.dataStore.getMinMaxForColumn(this.config.param[1]);let e=50*this.data.length,n=t[1],i=t[0],r=(n-i)/20,o=e-0,s=n-i+2*r;const a=this._getContentDimensions();this.app.x_scale=a.width/o,this.app.y_scale=a.height/s,this.app.offset[0]=-0,this.app.offset[1]=n+r,this._updateScale(this.app.getRange()),this.updateAxis()}_updateScale(t){this.y_scale.domain([-t.y_range[0],-t.y_range[1]])}getSettings(){const t=super.getSettings(),e=this.config,n=this.dataStore.getMinMaxForColumn(e.param[1]);return t.splice(1,0,{type:"slider",max:n[1]/10,min:n[0]<0?0:n[0],doc:this.__doc__,current_value:e.band_width,label:"Band Width",func:t=>{e.band_width=t,this.onDataFiltered()}},{type:"slider",max:100,min:10,step:1,doc:this.__doc__,current_value:e.intervals,label:"Intervals",func:t=>{e.intervals=t,this.onDataFiltered()}}),t}_createPolyFilter(t){this.range=!0;for(let e of t)e[1]=-e[1],this.config.axis.x_log_scale&&(e[0]=this._getInverseLogValue(e[0])),this.config.axis.y_log_scale&&(e[1]=this._getInverseLogValue(e[1]));this.filter=t,this.dim.filter("filterPoly",[this.xPos,this.config.param[1]],t),this.app.refresh()}}I.types.violin_plot={class:Yr,name:"Violin Plot",params:[{type:"text",name:"Category (X axis)"},{type:"number",name:"Value (Y axis)"}]};const Qr=Yr;function Jr(t,e){let n=0;if(void 0===e)for(let e of t)(e=+e)&&(n+=e);else{let i=-1;for(let r of t)(r=+e(r,++i,t))&&(n+=r)}return n}function to(t,e){let n;if(void 0===e)for(const e of t)null!=e&&(n<e||void 0===n&&e>=e)&&(n=e);else{let i=-1;for(let r of t)null!=(r=e(r,++i,t))&&(n<r||void 0===n&&r>=r)&&(n=r)}return n}function eo(t,e){return t.sourceLinks.length?t.depth:e-1}function no(t){return function(){return t}}function io(t,e){return oo(t.source,e.source)||t.index-e.index}function ro(t,e){return oo(t.target,e.target)||t.index-e.index}function oo(t,e){return t.y0-e.y0}function so(t){return t.value}function ao(t){return t.index}function lo(t){return t.nodes}function co(t){return t.links}function uo(t,e){const n=t.get(e);if(!n)throw new Error("missing: "+e);return n}function ho({nodes:t}){for(const e of t){let t=e.y0,n=t;for(const n of e.sourceLinks)n.y0=t+n.width/2,t+=n.width;for(const t of e.targetLinks)t.y1=n+t.width/2,n+=t.width}}I.types.box_plot={class:class extends Qr{constructor(t,e,n){super(t,e,n),this.config.type="box_plot"}onDataFiltered(t){this.isPinned||t!==this.dim&&("all_removed"===t&&(this.app.clearBrush(),this.app.setFilter(!1),this.resetButton.style.display="none"),this.ticks=this.y_scale.ticks(20),this.dim.getBoxPlotData((t=>{this.data=t,this.drawChart()}),this.config.param,{xPos:this.xPosBuff}))}drawChart(){const t=(0,ft.Z)(this.contentDiv).transition().duration(400).ease(pt),e=this.data.length,n=this.y_scale,i=[];for(let t of this.data)i.push(this.values[t.id]);this.x_scale.domain(i),this.centerGraph();const r=this._getContentDimensions().width/e,o=this.dataStore.getColumnColors(this.config.param[0]);this.graph_area.selectAll(".boxplot-rect").data(this.data,(t=>t.id)).join("rect").attr("class","boxplot-rect").transition(t).attr("x",((t,e)=>e*(r-3)+3*(e+1))).attr("y",(t=>n(t.Q3))).attr("width",r-6).attr("height",(t=>{const e=n(t.Q1)-n(t.Q3);return isNaN(e)?0:e})).attr("fill","none").attr("stroke",((t,e)=>o[t.id])).attr("stroke-width",3),this.graph_area.selectAll(".boxplot-whisker").data(this.data,(t=>t.id)).join("path").attr("class","boxplot-whisker").transition(t).attr("stroke",((t,e)=>o[t.id])).attr("fill","none").attr("stroke-width",3).attr("d",((t,e)=>{if(isNaN(t.med))return"";const i=e*(r-6)+6*(e+1),o=e*(r-3)+3*(e+1),s=e*r+.5*r,a=n(t.max),l=n(t.min);return null==a||null==l?"":`\n             M${i} ${a} L${i+r-12} ${a}\n             M${s} ${a} L${s} ${n(t.Q3)}\n             M${o} ${n(t.med)} L${o+r-6} ${n(t.med)}\n             M${s} ${l} L${s} ${n(t.Q1)}\n             M${i} ${l} L${i+r-12} ${l}`})),this.app.refresh()}},name:"Box Plot",params:[{type:"text",name:"Category (X axis)"},{type:"number",name:"Value (Y axis)"}]};var fo=Math.PI,po=2*fo,go=1e-6,mo=po-go;function _o(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function vo(){return new _o}_o.prototype=vo.prototype={constructor:_o,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,i){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+i)},bezierCurveTo:function(t,e,n,i,r,o){this._+="C"+ +t+","+ +e+","+ +n+","+ +i+","+(this._x1=+r)+","+(this._y1=+o)},arcTo:function(t,e,n,i,r){t=+t,e=+e,n=+n,i=+i,r=+r;var o=this._x1,s=this._y1,a=n-t,l=i-e,c=o-t,u=s-e,h=c*c+u*u;if(r<0)throw new Error("negative radius: "+r);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(h>go)if(Math.abs(u*a-l*c)>go&&r){var d=n-o,f=i-s,p=a*a+l*l,g=d*d+f*f,m=Math.sqrt(p),_=Math.sqrt(h),v=r*Math.tan((fo-Math.acos((p+h-g)/(2*m*_)))/2),b=v/_,y=v/m;Math.abs(b-1)>go&&(this._+="L"+(t+b*c)+","+(e+b*u)),this._+="A"+r+","+r+",0,0,"+ +(u*d>c*f)+","+(this._x1=t+y*a)+","+(this._y1=e+y*l)}else this._+="L"+(this._x1=t)+","+(this._y1=e)},arc:function(t,e,n,i,r,o){t=+t,e=+e,o=!!o;var s=(n=+n)*Math.cos(i),a=n*Math.sin(i),l=t+s,c=e+a,u=1^o,h=o?i-r:r-i;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+l+","+c:(Math.abs(this._x1-l)>go||Math.abs(this._y1-c)>go)&&(this._+="L"+l+","+c),n&&(h<0&&(h=h%po+po),h>mo?this._+="A"+n+","+n+",0,1,"+u+","+(t-s)+","+(e-a)+"A"+n+","+n+",0,1,"+u+","+(this._x1=l)+","+(this._y1=c):h>go&&(this._+="A"+n+","+n+",0,"+ +(h>=fo)+","+u+","+(this._x1=t+n*Math.cos(r))+","+(this._y1=e+n*Math.sin(r))))},rect:function(t,e,n,i){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +i+"h"+-n+"Z"},toString:function(){return this._}};const bo=vo;var yo=Array.prototype.slice;function wo(t){return function(){return t}}function xo(t){return t[0]}function Co(t){return t[1]}function ko(t){return t.source}function Eo(t){return t.target}function So(t,e,n,i,r){t.moveTo(e,n),t.bezierCurveTo(e=(e+i)/2,n,e,r,i,r)}function Ao(t){return[t.source.x1,t.y0]}function To(t){return[t.target.x0,t.y1]}function Mo(){return function(t){var e=ko,n=Eo,i=xo,r=Co,o=null;function s(){var s,a=yo.call(arguments),l=e.apply(this,a),c=n.apply(this,a);if(o||(o=s=bo()),t(o,+i.apply(this,(a[0]=l,a)),+r.apply(this,a),+i.apply(this,(a[0]=c,a)),+r.apply(this,a)),s)return o=null,s+""||null}return s.source=function(t){return arguments.length?(e=t,s):e},s.target=function(t){return arguments.length?(n=t,s):n},s.x=function(t){return arguments.length?(i="function"==typeof t?t:wo(+t),s):i},s.y=function(t){return arguments.length?(r="function"==typeof t?t:wo(+t),s):r},s.context=function(t){return arguments.length?(o=null==t?null:t,s):o},s}(So).source(Ao).target(To)}function Do(t,e,n){var i=null,r=ci(!0),o=null,s=Hr,a=null;function l(l){var c,u,h,d,f,p=(l=li(l)).length,g=!1,m=new Array(p),_=new Array(p);for(null==o&&(a=s(f=Pi())),c=0;c<=p;++c){if(!(c<p&&r(d=l[c],c,l))===g)if(g=!g)u=c,a.areaStart(),a.lineStart();else{for(a.lineEnd(),a.lineStart(),h=c-1;h>=u;--h)a.point(m[h],_[h]);a.lineEnd(),a.areaEnd()}g&&(m[c]=+t(d,c,l),_[c]=+e(d,c,l),a.point(i?+i(d,c,l):m[c],n?+n(d,c,l):_[c]))}if(f)return a=null,f+""||null}function c(){return qr().defined(r).curve(s).context(o)}return t="function"==typeof t?t:void 0===t?$r:ci(+t),e="function"==typeof e?e:ci(void 0===e?0:+e),n="function"==typeof n?n:void 0===n?Zr:ci(+n),l.x=function(e){return arguments.length?(t="function"==typeof e?e:ci(+e),i=null,l):t},l.x0=function(e){return arguments.length?(t="function"==typeof e?e:ci(+e),l):t},l.x1=function(t){return arguments.length?(i=null==t?null:"function"==typeof t?t:ci(+t),l):i},l.y=function(t){return arguments.length?(e="function"==typeof t?t:ci(+t),n=null,l):e},l.y0=function(t){return arguments.length?(e="function"==typeof t?t:ci(+t),l):e},l.y1=function(t){return arguments.length?(n=null==t?null:"function"==typeof t?t:ci(+t),l):n},l.lineX0=l.lineY0=function(){return c().x(t).y(e)},l.lineY1=function(){return c().x(t).y(n)},l.lineX1=function(){return c().x(i).y(e)},l.defined=function(t){return arguments.length?(r="function"==typeof t?t:ci(!!t),l):r},l.curve=function(t){return arguments.length?(s=t,null!=o&&(a=s(o)),l):s},l.context=function(t){return arguments.length?(null==t?o=a=null:a=s(o=t),l):o},l}I.types.sankey_chart={name:"Sankey Diagram",class:class extends sn{constructor(t,e,n){const i=t.getColumnName(n.param[0]),r=t.getColumnName(n.param[1]);n.label||(n.label=`${i} vs. ${r}`),n.axis||(n.axis={}),n.axis.y||(n.axis.y={size:25,textSize:15,label:i}),n.axis.ry||(n.axis.ry={size:25,textSize:15,label:r}),super(t,e,n,{y:{custom:!0},ry:{label:!0}}),this.config.type="sankey_chart",this.dim=this.dataStore.getDimension("category_dimension"),this.filter=[],this.addToolTip(),this.onDataFiltered()}setSize(t,e){super.setSize(t,e),this.drawChart()}remove(t=!0){this.dim.destroy(t),super.remove()}removeFilter(){this.dim.removeFilter(),this.filter=[],this.nodeFilter=null,this.linkFilter=null,this.drawChart()}onDataFiltered(t){this.dim===t||this.isPinned||("all_removed"===t&&(this.filter=[],this.nodeFilter=null,this.linkFilter=null,this.resetButton.style.display="none"),this.dim.getSankeyData((t=>{this.sankeyData=t,this.drawChart()}),this.config.param))}drawChart(){this.updateAxis();const t=(0,ft.Z)(this.contentDiv).transition().duration(400).ease(pt),e=this._getContentDimensions(),n=this.config.param,i=[this.dataStore.getColumnColors(n[0]),this.dataStore.getColumnColors(n[1])],r=this;let o=20-this.sankeyData.minNodes;o=o<1?1:o>10?10:o;const s=function(){let t,e,n,i=0,r=0,o=1,s=1,a=24,l=8,c=ao,u=eo,h=lo,d=co,f=6;function p(){const t={nodes:h.apply(null,arguments),links:d.apply(null,arguments)};return g(t),m(t),_(t),v(t),b(t),ho(t),t}function g({nodes:t,links:e}){for(const[e,n]of t.entries())n.index=e,n.sourceLinks=[],n.targetLinks=[];const i=new Map(t.map(((e,n)=>[c(e,n,t),e])));for(const[t,n]of e.entries()){n.index=t;let{source:e,target:r}=n;"object"!=typeof e&&(e=n.source=uo(i,e)),"object"!=typeof r&&(r=n.target=uo(i,r)),e.sourceLinks.push(n),r.targetLinks.push(n)}if(null!=n)for(const{sourceLinks:e,targetLinks:i}of t)e.sort(n),i.sort(n)}function m({nodes:t}){for(const e of t)e.value=void 0===e.fixedValue?Math.max(Jr(e.sourceLinks,so),Jr(e.targetLinks,so)):e.fixedValue}function _({nodes:t}){const e=t.length;let n=new Set(t),i=new Set,r=0;for(;n.size;){for(const t of n){t.depth=r;for(const{target:e}of t.sourceLinks)i.add(e)}if(++r>e)throw new Error("circular link");n=i,i=new Set}}function v({nodes:t}){const e=t.length;let n=new Set(t),i=new Set,r=0;for(;n.size;){for(const t of n){t.height=r;for(const{source:e}of t.targetLinks)i.add(e)}if(++r>e)throw new Error("circular link");n=i,i=new Set}}function b(n){const c=function({nodes:t}){const n=to(t,(t=>t.depth))+1,r=(o-i-a)/(n-1),s=new Array(n);for(const e of t){const t=Math.max(0,Math.min(n-1,Math.floor(u.call(null,e,n))));e.layer=t,e.x0=i+t*r,e.x1=e.x0+a,s[t]?s[t].push(e):s[t]=[e]}if(e)for(const t of s)t.sort(e);return s}(n);t=Math.min(l,(s-r)/(to(c,(t=>t.length))-1)),function(e){const n=function(t,e){let n;if(void 0===e)for(const e of t)null!=e&&(n>e||void 0===n&&e>=e)&&(n=e);else{let i=-1;for(let r of t)null!=(r=e(r,++i))&&(n>r||void 0===n&&r>=r)&&(n=r)}return n}(e,(e=>(s-r-(e.length-1)*t)/Jr(e,so)));for(const i of e){let e=r;for(const r of i){r.y0=e,r.y1=e+r.value*n,e=r.y1+t;for(const t of r.sourceLinks)t.width=t.value*n}e=(s-e+t)/(i.length+1);for(let t=0;t<i.length;++t){const n=i[t];n.y0+=e*(t+1),n.y1+=e*(t+1)}S(i)}}(c);for(let t=0;t<f;++t){const e=Math.pow(.99,t),n=Math.max(1-e,(t+1)/f);w(c,e,n),y(c,e,n)}}function y(t,n,i){for(let r=1,o=t.length;r<o;++r){const o=t[r];for(const t of o){let e=0,i=0;for(const{source:n,value:r}of t.targetLinks){let o=r*(t.layer-n.layer);e+=A(n,t)*o,i+=o}if(!(i>0))continue;let r=(e/i-t.y0)*n;t.y0+=r,t.y1+=r,E(t)}void 0===e&&o.sort(oo),x(o,i)}}function w(t,n,i){for(let r=t.length-2;r>=0;--r){const o=t[r];for(const t of o){let e=0,i=0;for(const{target:n,value:r}of t.sourceLinks){let o=r*(n.layer-t.layer);e+=T(t,n)*o,i+=o}if(!(i>0))continue;let r=(e/i-t.y0)*n;t.y0+=r,t.y1+=r,E(t)}void 0===e&&o.sort(oo),x(o,i)}}function x(e,n){const i=e.length>>1,o=e[i];k(e,o.y0-t,i-1,n),C(e,o.y1+t,i+1,n),k(e,s,e.length-1,n),C(e,r,0,n)}function C(e,n,i,r){for(;i<e.length;++i){const o=e[i],s=(n-o.y0)*r;s>1e-6&&(o.y0+=s,o.y1+=s),n=o.y1+t}}function k(e,n,i,r){for(;i>=0;--i){const o=e[i],s=(o.y1-n)*r;s>1e-6&&(o.y0-=s,o.y1-=s),n=o.y0-t}}function E({sourceLinks:t,targetLinks:e}){if(void 0===n){for(const{source:{sourceLinks:t}}of e)t.sort(ro);for(const{target:{targetLinks:e}}of t)e.sort(io)}}function S(t){if(void 0===n)for(const{sourceLinks:e,targetLinks:n}of t)e.sort(ro),n.sort(io)}function A(e,n){let i=e.y0-(e.sourceLinks.length-1)*t/2;for(const{target:r,width:o}of e.sourceLinks){if(r===n)break;i+=o+t}for(const{source:t,width:r}of n.targetLinks){if(t===e)break;i-=r}return i}function T(e,n){let i=n.y0-(n.targetLinks.length-1)*t/2;for(const{source:r,width:o}of n.targetLinks){if(r===e)break;i+=o+t}for(const{target:t,width:r}of e.sourceLinks){if(t===n)break;i-=r}return i}return p.update=function(t){return ho(t),t},p.nodeId=function(t){return arguments.length?(c="function"==typeof t?t:no(t),p):c},p.nodeAlign=function(t){return arguments.length?(u="function"==typeof t?t:no(t),p):u},p.nodeSort=function(t){return arguments.length?(e=t,p):e},p.nodeWidth=function(t){return arguments.length?(a=+t,p):a},p.nodePadding=function(e){return arguments.length?(l=t=+e,p):l},p.nodes=function(t){return arguments.length?(h="function"==typeof t?t:no(t),p):h},p.links=function(t){return arguments.length?(d="function"==typeof t?t:no(t),p):d},p.linkSort=function(t){return arguments.length?(n=t,p):n},p.size=function(t){return arguments.length?(i=r=0,o=+t[0],s=+t[1],p):[o-i,s-r]},p.extent=function(t){return arguments.length?(i=+t[0][0],o=+t[1][0],r=+t[0][1],s=+t[1][1],p):[[i,r],[o,s]]},p.iterations=function(t){return arguments.length?(f=+t,p):f},p}().size([e.width,e.height]).nodeId((t=>t.id)).nodeWidth(20).nodePadding(o).nodeAlign(eo)(this.sankeyData);this.graph_area.selectAll(".s-links").data(s.links).join("path").on("click",((t,e)=>{r.filterMultipleCategories(e)})).on("mouseover pointermove",((t,e)=>{const n=e.source,i=r.dataStore.getColumnValues(r.config.param[n.param])[n.ind],o=e.target,s=r.dataStore.getColumnValues(r.config.param[o.param])[o.ind];r.showToolTip(t,`${i}<br>${s}<br>${e.trueValue}`)})).on("mouseleave",(()=>{r.hideToolTip()})).transition(t).attr("class","s-links").attr("d",Mo()).attr("fill","none").attr("stroke","currentColor").attr("stroke-width",(t=>t.width)).attr("stoke-opacity",.5).attr("opacity",(t=>r.linkFilter?t.source.id===r.linkFilter[0]&&t.target.id===r.linkFilter[1]?.8:.2:r.nodeFilter?t.source.id===r.nodeFilter||t.target.id===r.nodeFilter?.8:.2:.5)),this.graph_area.selectAll(".s-nodes").data(s.nodes).join("rect").on("click",((t,e)=>{const i=n[e.param];r.nodeFilter=(0===e.param?"A":"B")+e.ind,r.linkFilter=null;const o=r.dataStore.getColumnValues(i);r.filterCategories(i,o[e.ind])})).on("mouseover pointermove",((t,e)=>{const n=r.dataStore.getColumnValues(r.config.param[e.param])[e.ind];r.showToolTip(t,n)})).on("mouseleave",(()=>{r.hideToolTip()})).attr("class","s-nodes").attr("x",(t=>t.x0)).attr("y",(t=>t.y0)).attr("width",(t=>t.x1-t.x0)).attr("height",(t=>t.y1-t.y0)).attr("fill",(t=>i[t.param][t.ind]))}getFilter(){const t=this.config.param;if(this.linkFilter){const e={};let n=parseInt(this.linkFilter[0].substring(1));return e[t[0]]=[this.dataStore.getColumnValues(t[0])[n]],n=parseInt(this.linkFilter[1].substring(1)),e[t[1]]=[this.dataStore.getColumnValues(t[1])[n]],e}if(this.nodeFilter){const e={},n=this.nodeFilter.startsWith("A")?0:1;let i=parseInt(this.nodeFilter.substring(1));return e[t[n]]=[this.dataStore.getColumnValues(t[n])[i]],e}return null}filterMultipleCategories(t){const e=this.config.param,n=e[t.source.param],i=this.dataStore.getColumnValues(n)[t.source.ind],r=e[t.target.param],o=this.dataStore.getColumnValues(r)[t.target.ind];this.linkFilter=["A"+t.source.ind,"B"+t.target.ind],this.resetButton.style.display="inline",this.drawChart(),this.dim.filter("filterMultipleCategories",[n,r],[i,o])}filterCategories(t,e,n){n?this.filter.push(e):this.filter=[e],this.resetButton.style.display="inline",this.drawChart(),this.dim.filter("filterCategories",[t],this.filter)}pinChart(){this.isPinned=!0}unpinChart(){this.isPinned=!1,this.onDataFiltered()}getSettings(){const t=super.getSettings();return this.config,t}},params:[{type:"text",name:"First Group"},{type:"text",name:"Second Group"}]};I.types.multi_line_chart={class:class extends sn{constructor(t,e,n){const i=t.getColumnName(n.param[0]);n.axis||(n.axis={x:{size:30,label:i,textsize:13},y:{size:45,label:"density",textsize:13}}),n.title||(n.title=i),n.scaletrim&&!n.band_width&&(n.band_width=.1),super(t,e,n,{x:{},y:{type:n.stacked?"band":"linear"}}),this.config.type="multi_line_chart";const r=this.config;r.color_legend||(r.color_legend={display:!r.stacked});let o=this.dataStore.getMinMaxForColumn(r.param[0]),s=o.slice(0);n.scaletrim&&(s=[0,1]),this.x_scale.domain(s),this.defaultBandWidth=(o[1]-o[0])/100,r.band_width=r.band_width||this.defaultBandWidth,r.intervals=r.intervals||40,this.dim=this.dataStore.getDimension("catrange_dimension"),this.data=[],this.addToolTip(),this.setColorLegend(),this.stackLines(r.stacked),this.scaleTrim(r.scaletrim),this.onDataFiltered()}stackLines(t){this.config.stacked=t,t?(this.y_scale=Et(),this.y_axis_call=(0,tn.y4)(this.y_scale),this.config.color_legend.display=!1,this.setColorLegend(),this.y_scale.domain(this.dataStore.getColumnValues(this.config.param[1]))):(this.y_scale=(0,St.Z)(),this.y_axis_call=(0,tn.y4)(this.y_scale),this.y_scale.domain([1,0]))}changeCategories(t,e,n){this.config.param[1]=t,this.onDataFiltered()}scaleTrim(t){const e=this.config;if(t&&"none"!==t)e.scaletrim=t+"",this.x_scale.domain([0,1]),e.band_width=.1;else{delete e.scaletrim;const t=this.dataStore.getMinMaxForColumn(e.param[0]);this.x_scale.domain(t)}}getColorLegend(){return this.dataStore.getColorLegend(this.config.param[1])}onDataFiltered(t){if(!this.isPinned&&t!==this.dim){"all_removed"===t&&(this.resetButton.style.display="none");const e=this.config;this.ticks=this.x_scale.ticks(e.intervals),this.dim.getKernalDensity((t=>{this.data=t,this.drawChart()}),[e.param[1],e.param[0]],{ticks:this.ticks,bandwidth:e.band_width,intervals:e.intervals,scaletrim:e.scaletrim})}}remove(t=!0){this.dim.destroy(t),super.remove()}drawChart(){const t=this.config,e=this.dataStore.getColumnValues(t.param[1]),n=(0,ft.Z)(this.contentDiv).transition().duration(400).ease(pt),i=this._getContentDimensions(),r=[],o=i.height/this.data.length,s=[];for(let n=0;n<this.data.length;n++){const a=t.stacked?o/this.data[n].max:i.height/this.data[n].max,l=t.stacked?this.data[n].map((t=>o*n+o-t*a)):this.data[n].map((t=>i.height-t*a));l.id=this.data[n].id,s.push(e[l.id]),r.push(l)}this.y_scale.domain(s),this.updateAxis();const a=this.ticks.map((t=>this.x_scale(t))),l=this,c=this.dataStore.getColumnColors(this.config.param[1]);this.graph_area.selectAll(".chart-line").data(r).join("path").attr("class","chart-line").on("mouseover pointermove",((t,n)=>{const i=e[n.id];l.showToolTip(t,i)})).on("mouseout",(()=>{l.hideToolTip()})).transition(n).attr("fill","none").attr("stroke",((t,e)=>c[t.id])).attr("stroke-width",2).attr("stroke-linejoin","round").attr("d",qr().x(((t,e)=>a[e])).y(((t,e)=>t))),t.fill?(Do().x((function(t,e){return a[e]})).y0((function(t,e){return t})).y1(((e,n)=>{t.stacked?e.id:i.height})),this.graph_area.selectAll(".chart-area").data(r).join("path").attr("class","chart-area").transition(n).attr("fill",(t=>c[t.id])).style("opacity",.5).attr("d",(function(e,n){return Do().x((function(t,e){return a[e]})).y0((function(t){return t})).y1((e=>t.stacked?o*n+o:i.height))(e)}))):this.graph_area.selectAll(".chart-area").remove()}unpinChart(){super.unpinChart(),this.onDataFiltered()}setSize(t,e){super.setSize(t,e),this.drawChart()}getSettings(){const t=super.getSettings(),e=this.config,n=this.dataStore.getMinMaxForColumn(e.param[0]),i=this.dataStore.getColumnList("text");return t.splice(1,0,{type:"dropdown",current_value:e.param[1],label:"Change Cetegories (y axis)",values:[i,"name","field"],func:t=>{this.changeCategories(t,"val1","val2")}},{type:"check",current_value:e.stacked,label:"Stack Lines",func:t=>{this.stackLines(t),this.drawChart()}},{type:"check",current_value:e.fill,label:"Fill Lines",func:t=>{e.fill=t,this.drawChart()}},{type:"radiobuttons",label:"Scale/Trim to Percentile",current_value:e.scaletrim||"none",choices:[["No Trim","none"],["0.001","0.001"],["0.01","0.01"],["0.05","0.05"]],func:t=>{this.scaleTrim(t),this.onDataFiltered()}},{type:"slider",max:n[1]/10,min:n[0]<0?0:n[0],doc:this.__doc__,current_value:e.band_width,label:"Band Width",func:t=>{e.band_width=t,this.onDataFiltered()}},{type:"slider",max:100,min:10,step:1,doc:this.__doc__,current_value:e.intervals,label:"Intervals",func:t=>{e.intervals=t,this.onDataFiltered()}},{label:"Show Color Legend",type:"check",current_value:!e.color_legend||e.color_legend.display,func:t=>{e.color_legend.display=t,this.setColorLegend()}}),t}},name:"Multi Line Chart",methodsUsingColumns:["changeCategories"],params:[{type:"number",name:"Value (X axis)"},{type:"text",name:"Categories to show"}]};const Po=t=>t;function Lo(t,e){t&&Io.hasOwnProperty(t.type)&&Io[t.type](t,e)}var Ro={Feature:function(t,e){Lo(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,i=-1,r=n.length;++i<r;)Lo(n[i].geometry,e)}},Io={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)t=n[i],e.point(t[0],t[1],t[2])},LineString:function(t,e){Oo(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)Oo(n[i],e,0)},Polygon:function(t,e){zo(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)zo(n[i],e)},GeometryCollection:function(t,e){for(var n=t.geometries,i=-1,r=n.length;++i<r;)Lo(n[i],e)}};function Oo(t,e,n){var i,r=-1,o=t.length-n;for(e.lineStart();++r<o;)i=t[r],e.point(i[0],i[1],i[2]);e.lineEnd()}function zo(t,e){var n=-1,i=t.length;for(e.polygonStart();++n<i;)Oo(t[n],e,1);e.polygonEnd()}function Fo(t,e){t&&Ro.hasOwnProperty(t.type)?Ro[t.type](t,e):Lo(t,e)}class Bo{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const e=this._partials;let n=0;for(let i=0;i<this._n&&i<32;i++){const r=e[i],o=t+r,s=Math.abs(t)<Math.abs(r)?t-(o-r):r-(o-t);s&&(e[n++]=s),t=o}return e[n]=t,this._n=n+1,this}valueOf(){const t=this._partials;let e,n,i,r=this._n,o=0;if(r>0){for(o=t[--r];r>0&&(e=o,n=t[--r],o=e+n,i=n-(o-e),!i););r>0&&(i<0&&t[r-1]<0||i>0&&t[r-1]>0)&&(n=2*i,e=o+n,n==e-o&&(o=e))}return o}}var No=2*Math.PI,jo=Math.abs,Uo=(Math.atan,Math.atan2,Math.cos,Math.ceil,Math.exp,Math.floor,Math.hypot,Math.log,Math.pow,Math.sin,Math.sign,Math.sqrt);function Vo(){}Math.tan;var Wo,Ho,$o,Zo,qo=new Bo,Go=new Bo,Ko={point:Vo,lineStart:Vo,lineEnd:Vo,polygonStart:function(){Ko.lineStart=Xo,Ko.lineEnd=Jo},polygonEnd:function(){Ko.lineStart=Ko.lineEnd=Ko.point=Vo,qo.add(jo(Go)),Go=new Bo},result:function(){var t=qo/2;return qo=new Bo,t}};function Xo(){Ko.point=Yo}function Yo(t,e){Ko.point=Qo,Wo=$o=t,Ho=Zo=e}function Qo(t,e){Go.add(Zo*t-$o*e),$o=t,Zo=e}function Jo(){Qo(Wo,Ho)}const ts=Ko;var es=1/0,ns=es,is=-es,rs=is,os={point:function(t,e){t<es&&(es=t),t>is&&(is=t),e<ns&&(ns=e),e>rs&&(rs=e)},lineStart:Vo,lineEnd:Vo,polygonStart:Vo,polygonEnd:Vo,result:function(){var t=[[es,ns],[is,rs]];return is=rs=-(ns=es=1/0),t}};const ss=os;var as,ls,cs,us,hs=0,ds=0,fs=0,ps=0,gs=0,ms=0,_s=0,vs=0,bs=0,ys={point:ws,lineStart:xs,lineEnd:Es,polygonStart:function(){ys.lineStart=Ss,ys.lineEnd=As},polygonEnd:function(){ys.point=ws,ys.lineStart=xs,ys.lineEnd=Es},result:function(){var t=bs?[_s/bs,vs/bs]:ms?[ps/ms,gs/ms]:fs?[hs/fs,ds/fs]:[NaN,NaN];return hs=ds=fs=ps=gs=ms=_s=vs=bs=0,t}};function ws(t,e){hs+=t,ds+=e,++fs}function xs(){ys.point=Cs}function Cs(t,e){ys.point=ks,ws(cs=t,us=e)}function ks(t,e){var n=t-cs,i=e-us,r=Uo(n*n+i*i);ps+=r*(cs+t)/2,gs+=r*(us+e)/2,ms+=r,ws(cs=t,us=e)}function Es(){ys.point=ws}function Ss(){ys.point=Ts}function As(){Ms(as,ls)}function Ts(t,e){ys.point=Ms,ws(as=cs=t,ls=us=e)}function Ms(t,e){var n=t-cs,i=e-us,r=Uo(n*n+i*i);ps+=r*(cs+t)/2,gs+=r*(us+e)/2,ms+=r,_s+=(r=us*t-cs*e)*(cs+t),vs+=r*(us+e),bs+=3*r,ws(cs=t,us=e)}const Ds=ys;function Ps(t){this._context=t}Ps.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._context.moveTo(t,e),this._point=1;break;case 1:this._context.lineTo(t,e);break;default:this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,No)}},result:Vo};var Ls,Rs,Is,Os,zs,Fs=new Bo,Bs={point:Vo,lineStart:function(){Bs.point=Ns},lineEnd:function(){Ls&&js(Rs,Is),Bs.point=Vo},polygonStart:function(){Ls=!0},polygonEnd:function(){Ls=null},result:function(){var t=+Fs;return Fs=new Bo,t}};function Ns(t,e){Bs.point=js,Rs=Os=t,Is=zs=e}function js(t,e){Os-=t,zs-=e,Fs.add(Uo(Os*Os+zs*zs)),Os=t,zs=e}const Us=Bs;function Vs(){this._string=[]}function Ws(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}Vs.prototype={_radius:4.5,_circle:Ws(4.5),pointRadius:function(t){return(t=+t)!==this._radius&&(this._radius=t,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._string.push("M",t,",",e),this._point=1;break;case 1:this._string.push("L",t,",",e);break;default:null==this._circle&&(this._circle=Ws(this._radius)),this._string.push("M",t,",",e,this._circle)}},result:function(){if(this._string.length){var t=this._string.join("");return this._string=[],t}return null}},__webpack_require__(8796);class Hs extends ai{afterAppCreation(){this.contentDiv.prepend(this.app.div_container),this.svg.style("position","absolute").style("pointer-events","none");const t=this.config;t.contour_bandwidth=t.contour_bandwidth||5,t.contour_intensity=t.contour_intensity||.7,t.contour_opacity=t.contour_opacity||1;const e=t.param,n=this.dataStore.getMinMaxForColumn(e[0]),i=this.dataStore.getMinMaxForColumn(e[1]),r=n[1]-n[0],o=i[1]-i[0];return this.whRatio=r/o,this.catKeys=[-1,-1],this.data=[null,null],this.orig_y_scale=this.y_scale.domain(),this.orig_x_scale=this.x_scale.domain(),this.or_y_scale=[0,400/this.whRatio],this.or_x_scale=[0,400],this.app.addHandler("pan_or_zoom",((t,e,n)=>{this._updateScale(this.app.getRange()),this._rescaleSVG()}),t.id),super.afterAppCreation()}getDimension(){return this.dataStore.getDimension("density_dimension")}onDataFiltered(t){const e=this.config,n=e.param;super.onDataFiltered(t);const i=this.dataStore.getColumnValues(e.param[2]);if(this.catKeys=[i.indexOf(e.category1),i.indexOf(e.category2)],-1===this.catKeys[0]&&-1===this.catKeys[1])return void(this.data=[null,null]);const r={categories:this.catKeys,yscale:[this.orig_y_scale,this.or_y_scale],xscale:[this.orig_x_scale,this.or_x_scale],bandwidth:this.config.contour_bandwidth};this.dim.getDensityContours((t=>{this.data=t,this.drawChart(),this._rescaleSVG()}),n,r)}setSize(t,e){super.setSize(t,e),this._rescaleSVG()}_drawContours(t,e,n){const i=`dp-poly-${n}`,r=this.config;this.graph_area.selectAll("."+i).data(this.data[n]).join("path").attr("class",i).attr("stroke",r.contour_fill?"none":t).style("opacity",r.contour_opacity).attr("stroke-linejoin","round").attr("d",function(t,e){var n,i,r=4.5;function o(t){return t&&("function"==typeof r&&i.pointRadius(+r.apply(this,arguments)),Fo(t,n(i))),i.result()}return o.area=function(t){return Fo(t,n(ts)),ts.result()},o.measure=function(t){return Fo(t,n(Us)),Us.result()},o.bounds=function(t){return Fo(t,n(ss)),ss.result()},o.centroid=function(t){return Fo(t,n(Ds)),Ds.result()},o.projection=function(e){return arguments.length?(n=null==e?(t=null,Po):(t=e).stream,o):t},o.context=function(t){return arguments.length?(i=null==t?(e=null,new Vs):new Ps(e=t),"function"!=typeof r&&i.pointRadius(r),o):e},o.pointRadius=function(t){return arguments.length?(r="function"==typeof t?t:(i.pointRadius(+t),+t),o):r},o.projection(t).context(e)}()).attr("fill",(t=>r.contour_fill?e(t.value):"none"))}removeCategory(t){delete this.config["category"+t],this.data[t-1]=null,this.catKeys[t-1]=-1,this.graph_area.selectAll(".dp-poly-"+(t-1)).remove()}changeContourParameter(t){this.config.param[2]=t,this.removeCategory(1),this.removeCategory(2),this.drawChart()}drawChart(t=400){const e=this.config;for(let t in this.catKeys){let n=this.catKeys[t];if(-1===n)this.graph_area.selectAll(`.dp-poly-${t}`).remove();else{let i=this.dataStore.getColumnColors(e.param[2])[n],r=(0,St.Z)([0,1-e.contour_intensity],["white",i]);this._drawContours(i,r,t)}}}getContextMenu(){let t=super.getContextMenu();return this.dataStore.regions&&!this.config.viv&&t.push({text:"Set as Default Image",icon:"fas fa-file-image",func:()=>{const t=this.config;t.background_image&&(this.dataStore.regions.all_regions[t.region].default_image=t.background_image.name,this.dataStore.dirtyMetadata.add("regions"))}}),t}_rescaleSVG(){const t=this.x_scale.domain(),e=t[1]-t[0],n=this.x_scale.range()[1]/this.or_x_scale[1],i=(this.orig_x_scale[1]-this.orig_x_scale[0])/e*n,r=(0,St.Z)().domain(t).range(this.or_x_scale),o=r(t[0])-r(this.orig_x_scale[0])*n,s=this.y_scale.domain(),a=s[0]-s[1],l=this.y_scale.range()[1]/this.or_y_scale[1],c=(this.orig_y_scale[0]-this.orig_y_scale[1])/a*l,u=(0,St.Z)().domain(s).range(this.or_y_scale),h=u(s[0])-u(this.orig_y_scale[0])*l,d=this.margins.left,f=this.margins.top;this.graph_area.attr("transform",`translate(${d-o},${f-h}) scale(${i},${c})  `)}getSettings(){const t=super.getSettings(),e=this.config,n=this.dataStore.getColumnList("text");let i=this.dataStore.getColumnValues(e.param[2]);return i=i.map((t=>({t}))),i.push({t:"None"}),t.push({type:"dropdown",label:"Contour Parameter",current_value:this.dataStore.getColumnName(e.param[2]),values:[n,"name","field"],func:t=>{this.changeContourParameter(t)},onchange:(t,e)=>{const n=this.dataStore.getColumnValues(e).slice(0);n.push("None");for(let e of["Contour Category 1","Contour Category 2"]){t[e].innerHTML="";for(let i of n)(0,T.ut)("option",{text:i,value:i},t[e]);t[e].value="None"}}},{type:"dropdown",label:"Contour Category 1",current_value:e.category1||"None",values:[i,"t","t"],func:t=>{"None"===t?this.removeCategory(1):e.category1=t,this.onDataFiltered()}},{type:"dropdown",label:"Contour Category 2",current_value:e.category2||"None",values:[i,"t","t"],func:t=>{"None"===t?this.removeCategory(2):e.category2=t,this.onDataFiltered()}},{type:"slider",max:25,min:1,doc:this.__doc__,current_value:e.contour_bandwidth,label:"KDE Bandwidth",func:t=>{e.contour_bandwidth=t,this.onDataFiltered()}},{label:"Fill Contours",type:"check",current_value:e.contour_fill,func:t=>{e.contour_fill=t,this.drawChart()}},{type:"slider",max:1,min:0,doc:this.__doc__,current_value:e.contour_intensity,label:"Fill Intensity",func:t=>{e.contour_intensity=t,this.drawChart()}},{type:"slider",max:1,min:0,doc:this.__doc__,current_value:e.contour_opacity,label:"Contour opacity",func:t=>{e.contour_opacity=t,this.drawChart()}}),t}}I.types.density_scatter_plot={name:"Density Scatter Plot",class:Hs,params:[{type:"number",name:"X axis"},{type:"number",name:"Y axis"},{type:"text",name:"Category Column"}]},I.types.image_scatter_plot={name:"Centroid Plot",class:Hs,required:["regions"],extra_controls:t=>{const e=[];for(let n in t.regions.all_regions)e.push({name:n,value:n});return[{type:"dropdown",name:"region",label:t.getColumnName(t.regions.region_field),values:e}]},init:(t,e,n)=>{const i=e.regions,r=i.all_regions[n.region];t.color_by=i.default_color,t.param=i.position_fields.concat([i.default_color]),t.background_filter={column:i.region_field,category:n.region},t.color_legend={display:!1},t.region=n.region,t.roi=r.roi,t.background_image=r.images[r.default_image],t.title=n.region+(r.default_image?`-${r.default_image}`:"")}};const $s=Hs;I.types.selection_dialog={name:"Selection Dialog",class:class extends I{constructor(t,e,n){super(t,e,n);const i=this.config,r=i.param;this.dims={},this.textFilters={},this.numberFilters={},i.filters=i.filters||{},this.hasFiltred=!1,this.contentDiv.style.overflowY="auto";for(let e of r){const n=t.columnIndex[e],i=(0,T.ut)("div",{styles:{padding:"5px"}},this.contentDiv);i.__fcol__=n.field,(0,T.ut)("div",{text:n.name,classes:["i-title"],styles:{fontWeight:"bold"}},i),"text"===n.datatype||"multitext"===n.datatype?this.addTextFilter(n,i):"integer"!==n.datatype&&"double"!==n.datatype&&"int32"!==n.datatype||this.addNumberFilter(n,i)}(0,T.Ng)(this.contentDiv,{handle:"i-title",sortEnded:t=>{this.config.param=t.map((t=>t.__fcol__))}}),this.hasFiltered&&setTimeout((()=>this.dataStore.triggerFilter()),0)}removeFilter(){const t=this.config.filters;for(let e in this.textFilters)this.textFilters[e].unSelectAll(),t[e].category=[];for(let e in this.numberFilters){const n=this.dataStore.getMinMaxForColumn(e);this.numberFilters[e].noUiSlider.set([n[0],n[1]]),t[e]=null}this.resetButton.style.display="none";for(let t in this.dims)this.dims[t].removeFilter(!1);this.dataStore.triggerFilter()}onDataFiltered(t){}addNumberFilter(t,e){const n=(0,T.ut)("div",{styles:{margin:"10px 10px"}},e),i=(0,T.ut)("div",{styles:{padding:"3px 10px",overflow:"hidden"}},e);(0,T.ut)("span",{text:">",styles:{float:"left",fontWeight:"bold"}},i);const r=(0,T.ut)("input",{styles:{width:"70px",float:"left"}},i);(0,T.ut)("span",{text:"<",styles:{float:"right",fontWeight:"bold"}},i);const o=(0,T.ut)("input",{styles:{width:"70px",float:"right"}},i),s=this.config,a=this.dataStore.getDimension("range_dimension");a.noclear=!0,this.dims[t.field]=a;const l=this.dataStore.getMinMaxForColumn(t.field),c=s.filters[t.field];let u=[l[0],l[1]];c&&(u=[c[0],c[1]]),N().create(n,{start:[u[0],u[1]],range:{min:l[0],max:l[1]},tooltips:!0,documentElement:this.__doc__}),n.noUiSlider.on("set",(e=>{const n=parseFloat(e[0]),i=parseFloat(e[1]);n<=l[0]&&i>=l[1]?s.filters[t.field]=null:s.filters[t.field]=[n,i],o.value=i,r.value=n,this.filterCategories(t.field)})),o.value=u[1],r.value=u[0],r.addEventListener("blur",(t=>{let e=parseFloat(r.value);const i=n.noUiSlider.get();isNaN(e)||e>i[1]||(e=e<l[0]?l[0]:e,n.noUiSlider.set([e,i[1]],!0,!0))})),r.addEventListener("keypress",(t=>{"Enter"===t.key&&r.blur()})),o.addEventListener("blur",(t=>{let e=parseFloat(o.value);const i=n.noUiSlider.get();isNaN(e)||e<i[0]||(e=e>l[1]?l[1]:e,n.noUiSlider.set([i[0],e],!0,!0))})),o.addEventListener("keypress",(t=>{"Enter"===t.key&&o.blur()})),c&&(this.filterCategories(t.field,!1),this.hasFiltered=!0),this.numberFilters[t.field]=n}filterCategories(t,e=!0){const n=this.config.filters[t],i=this.dataStore.columnIndex[t].datatype;if("text"===i)n.category&&0!==n.category.length?(n.category,this.resetButton.style.display="inline",this.dims[t].filter("filterCategories",[t],n.category,e)):this.dims[t].removeFilter();else if("multitext"===i)if(0===n.category.length)this.dims[t].removeFilter();else{this.resetButton.style.display="inline";const i=n.category.slice(0);i.operand=n.operand,this.dims[t].filter("filterCategories",[t],i,e)}else n?(this.resetButton.style.display="inline",this.dims[t].filter("filterRange",[t],{min:n[0],max:n[1]},e)):this.dims[t].removeFilter()}addTextFilter(t,e){const n="multitext"===t.datatype,i=this.config,r=this.dataStore.getDimension("category_dimension");r.noclear=!0,this.dims[t.field]=r;let o=i.filters[t.field];o?("string"==typeof o.category&&("__none__"===o.category?o.category=[]:o.category=[o.category]),o.exclude&&(o.category=this.dataStore.getColumnValues(t.field).filter((t=>t!==o.category[0]))),this.filterCategories(t.field,!1),this.hasFiltered=!0):o=i.filters[t.field]={category:[],operand:n?"or":null};const s=(0,T.ut)("div",{},e);if(n){const e=(0,T.ut)("div",{},s),n=(0,M.zO)();(0,T.ut)("span",{text:"and"},e);const i=(0,T.ut)("input",{type:"radio",name:n,value:"and"},e);i.checked="and"===o.operand,i.addEventListener("click",(e=>{o.operand="and",this.filterCategories(t.field)})),(0,T.ut)("span",{text:"or"},e);const r=(0,T.ut)("input",{type:"radio",name:n,value:"or"},e);r.checked="or"===o.operand,r.addEventListener("click",(e=>{o.operand="or",this.filterCategories(t.field)}))}const a=(0,T.ut)("div",{},e),l=t.values.slice(0).sort(((t,e)=>t.localeCompare(e))).map((t=>({text:t,value:t,selected:-1!==o.category.indexOf(t)}))),c=new class{constructor(t,e,n){this.config={search:!0,height:"15rem",maxShow:4,placeholder:"select",txtSelected:"selected",txtAll:"All",txtRemove:"Remove",txtSearch:"search",doc:document,...n},(0,T.VU)(t,{class:"multiselect-dropdown"}),this.div=t,this.options=new Map,this.div.addEventListener("click",(t=>this._handleClick(t))),this._addDocListener(),e&&e.forEach((t=>this.addOption(t))),this.refresh()}changeDocument(t){this._removeList(),this._addDocListener(),this.config.doc=t}_removeList(){this.listWrap&&(this.listWrap.remove(),this.listWrap=null)}_addDocListener(){const t=this.config.doc;this.docListener&&t.removeEventListener("click",this.docListener),this.docListener=t=>{this.listWrap&&!this.listWrap.contains(t.target)&&(this._removeList(),this._callback())},t.addEventListener("click",this.docListener)}getSelectedValues(){return Array.from(this.options.values()).filter((t=>t.selected)).map((t=>t.value))}unSelectAll(){Array.from(this.options.values()).forEach((t=>t.selected=!1)),this.refresh()}setSelected(t){t.forEach((e=>{const n=this.options.get(e);n.selected=n.value===t})),this.refresh()}refresh(){this.div.querySelectorAll("span.optext, span.placeholder").forEach((t=>this.div.removeChild(t)));const t=Array.from(this.options.values()).filter((t=>t.selected)),e=this.options.size-t.length;if(e<this.config.maxShow&&0!==e&&this.options.size>this.config.maxShow){const t=Array.from(this.options.values()).filter((t=>!t.selected)).map((t=>t.text)).join(",");this.div.appendChild((0,T.ut)("span",{class:["optext"],text:t+" excluded"}))}else t.length>this.config.maxShow?this.div.appendChild((0,T.ut)("span",{class:["optext"],text:t.length+" "+this.config.txtSelected})):t.forEach((t=>{const e=(0,T.ut)("span",{class:"optext",text:t.text});(0,T.ut)("span",{class:"optdel",text:"🗙",title:this.config.txtRemove},e).__rmvalue__=t.value,this.div.appendChild(e)}));0==t.length&&this.div.appendChild((0,T.ut)("span",{class:"placeholder",text:this.config.placeholder})),this.div.querySelectorAll("span.optext, span.placeholder"),this.listWrap&&Array.from(this.list.childNodes).forEach((t=>{const e=this.options.get(t.__value__);e.selected?t.classList.add("cheked"):t.classList.remove("cheked"),t.childNodes[0].checked=e.selected}))}remove(){this._removeList(),this.config.doc.removeEventListener("click",this.docListener)}_handleSearch(){this.list.querySelectorAll(":scope div:not(.multiselect-dropdown-all-selector)").forEach((t=>{const e=t.querySelector("label").innerText.toUpperCase(),n=this.search.value.toUpperCase(),i=e.includes(n)||""==n;i&&console.log(e),t.style.display=i?"block":"none"}))}_bulkChange(t){Array.from(this.options.values()).forEach((e=>e.selected="All"===t||"None"!==t&&!e.selected)),this.refresh()}_callback(){this.config.onchange&&this.config.onchange(this.getSelectedValues())}_handleClick(t){const e=t.target;e.__rmvalue__?(this.options.get(e.__rmvalue__).selected=!1,this._callback(),this.refresh()):this.createDropDown(),t.stopPropagation()}_handleListClick(t){const e=t.target;if("BUTTON"===e.tagName)"OK"===e.textContent?(this._removeList(),this._callback()):this._bulkChange(e.textContent),t.stopPropagation();else if(e.__value__){const n=this.options.get(e.__value__);n.selected=!n.selected,this.refresh(),t.stopPropagation()}}createDropDown(){if(this.listWrap)return;const t=(0,T.qT)(this.div);this.listWrap=(0,T.ut)("div",{classes:["multiselect-dropdown-list-wrapper"],style:{top:t.top+t.height+"px",left:t.left+"px",width:t.width+"px"}},this.config.doc.body),this.list=(0,T.ut)("div",{class:"multiselect-dropdown-list",style:{maxHeight:"300px"}},this.listWrap),Array.from(this.options.values()).forEach((t=>{const e=(0,T.ut)("div",{}),n=(0,T.ut)("input",{type:"checkbox"},e);n.checked=t.selected,e.appendChild(n);const i=(0,T.ut)("label",{text:t.text},e);n.__value__=i.__value__=e.__value__=t.value,this.list.appendChild(e)}));const e=(0,T.ut)("div",{},this.listWrap);this.search=(0,T.ut)("input",{class:["multiselect-dropdown-search"].concat([this.config.searchInput?.class??"form-control"]),style:{width:"95%",display:this.config.search?"block":"none"},placeholder:this.config.txtSearch},e),(0,T.ut)("button",{text:"All",classes:["ciview-button"]},e),(0,T.ut)("button",{text:"None",classes:["ciview-button"]},e),(0,T.ut)("button",{text:"Toggle",classes:["ciview-button"]},e),(0,T.ut)("button",{text:"OK",classes:["ciview-button"]},e),this.listWrap.addEventListener("click",(t=>this._handleListClick(t))),this.search.addEventListener("keyup",(t=>this._handleSearch(t)));const n=(0,T.qT)(this.listWrap),i=window.innerHeight-n.top,r=n.top;if(i>n.height);else if(r>n.height)this.listWrap.style.top=t.top-n.height+"px";else{const t=Math.max(i,r)-60;this.list.style.height=t+"px",r>i&&(this.listWrap.style.top="10px")}}addOption({text:t,value:e,selected:n}){this.options.set(e,{text:t,selected:n,value:e})}removeOption(t){this.options.delete(t);const e=Array.from(this.list.childNodes).find((e=>e.__value__===t));return!!e&&(e.remove(),!0)}}(a,l,{onchange:e=>{o.category=e,this.filterCategories(t.field)}});this.textFilters[t.field]=c}remove(t=!0){for(let t in this.dims)this.dims[t].destroy(!1);Object.values(this.textFilters).forEach((t=>t.remove())),t&&this.dataStore.triggerFilter(),super.remove()}},params:[{type:"_multi_column:all",name:"Columns To filter"}]};I.types.stacked_row_chart={class:class extends sn{constructor(t,e,n){n.color_legend||(n.color_legend={display:!1}),super(t,e,n,{x:{type:"linear"},y:{type:"band"},ry:{}}),this.config.type="stacked_row_chart",this.dim=this.dataStore.getDimension("category_dimension"),this.addToolTip(),this.onDataFiltered(null)}onDataFiltered(t){this.dim===t||this.isPinned||this.dim.getSankeyData((t=>{this.data=t,this.sortData(),this.drawChart()}),this.config.param,{method:"stacked"})}setSize(t,e){super.setSize(t,e),this.drawChart()}sortData(){this.sortedData=this.data.slice(0);const t=this.config.sort;if("size"===t||null===t)this.sortedData.sort(((t,e)=>t.total-e.total));else if("name"===t){const t=this.dataStore.getColumnValues(this.config.param[0]);this.sortedData.sort(((e,n)=>t[e.id].localeCompare(t[n.id])))}else if("composition"===t){const t=Ki(this.data.map((t=>{const e=t.values.map((t=>t.per));return e._id=t.id,e})));this.sortedData=t.order.map((t=>this.data[t]))}}getColorLegend(){return this.dataStore.getColorLegend(this.config.param[1])}getSettings(){const t=super.getSettings(),e=this.config;return t.concat([{label:"Show Color Legend",type:"check",current_value:!e.color_legend||e.color_legend.display,func:t=>{e.color_legend.display=t,this.setColorLegend()}},{type:"radiobuttons",label:"Sort Order",current_value:e.sort||"default",choices:[["Default","default"],["Size","size"],["Name","name"],["Composition","composition"]],func:t=>{e.sort=t,this.sortData(),this.drawChart()}}])}drawChart(t=500){const e=this._getContentDimensions(),n=this.config,i=this.sortedData.length,r=(e.height-4*(i+1))/i,o=this.dataStore.getColumnColors(n.param[1]),s=this.dataStore.getColumnValues(n.param[0]),a=this.dataStore.getColumnValues(n.param[1]),l=this,c=(0,ft.Z)(this.contentDiv).transition().duration(t).ease(pt);this.x_scale.domain([0,1]),this.y_scale.domain(this.sortedData.map((t=>s[t.id]))),this.updateAxis(),this.graph_area.selectAll(".stacked-row").data(this.sortedData,(t=>t.id)).join((t=>t.append("g").attr("transform",((t,e)=>`translate(0,${4*(e+1)+r*e})`)).attr("class","stacked-row")),(t=>t.transition(c).attr("transform",((t,e)=>`translate(0,${4*(e+1)+r*e})`)))).selectAll("rect").data((t=>t.values),(t=>t.id)).join((t=>t.append("rect").attr("x",(t=>t.perpos*e.width)).attr("y",0).attr("width",(t=>t.per*e.width)).attr("height",r).attr("fill",(t=>o[t.id])).on("mouseover pointermove",((t,e)=>{l.showToolTip(t,`${a[e.id]}<br>${e.count}`)})).on("mouseleave",(()=>{l.hideToolTip()}))),(t=>t.transition(c).attr("x",(t=>t.perpos*e.width)).attr("width",(t=>t.per*e.width)).attr("height",r).attr("fill",(t=>o[t.id]))))}},name:"Stacked Row Chart",params:[{type:"text",name:"Category y axis"},{type:"text",name:"Category x axis"}]};I.types.row_summary_box={class:class extends sn{constructor(t,e,n){super(t,e,n,{});const i=this.dataStore.getHighlightedData();i&&this.onDataHighlighted({data:this.dataStore.rowData.get(i[0])})}setBranchLength(t,e,n){t.y=(e+=t.data.length)*n,t.children&&t.children.forEach((t=>this.setBranchLength(t,e,n)))}drawChart(){if(!this.treeData)return;const t=(0,ft.Z)(this.contentDiv).transition().duration(500).ease(pt),e=this._getContentDimensions(),n=on().size([e.height,e.width-50]).separation(((t,e)=>1))(this.treeData);this.setBranchLength(this.treeData,this.treeData.data.length=0,(e.width-50)/function t(e){return e.data.length+(e.children?Xi(e.children,t):0)}(this.treeData));const i=n.descendants();Xi(i,(t=>t.data.length)),this.graph_area.selectAll(".tree-link").data(i.slice(1)).join("path").attr("class","tree-link").style("stroke","currentColor").style("fill","none").style("stroke-width","1px").transition(t).attr("d",(t=>`M ${t.y} ${t.x} L${t.parent.y} ${t.x} L${t.parent.y} ${t.parent.x}`)),this.graph_area.selectAll("text").data(this.treeData.leaves()).join("text").text((t=>t.data.name.replace(/_/g," "))).attr("font-size","9px").attr("alignment-baseline","middle").style("stroke","currentColor").transition(t).attr("x",(t=>t.y+2)).attr("y",(t=>t.x))}setSize(t,e){super.setSize(t,e),this.drawChart()}onDataHighlighted(t){const e=t.data?.nwk_data;e&&(this.treeData=function(t){let e={};for(let r=[],o=t.split(/\s*(;|\(|\)|,|:)\s*/),s=0;s<o.length;s++){let t=o[s];switch(t){case"(":var n={};e.children=[n],r.push(e),e=n;break;case",":n={},r[r.length-1].children.push(n),e=n;break;case")":e=r.pop();break;case":":break;default:var i=o[s-1];")"===i||"("===i||","===i?e.name=t:":"===i&&(e.length=parseFloat(t))}}return Ui(e)}(e),this.drawChart())}getSettings(){return super.getSettings()}},name:"Tree Diagram",required:["tree_diagram"],params:[]};var Zs=__webpack_require__(7636);const qs={"blue yellow":["#115f9a","#1984c5","#22a7f0","#48b5c4","#76c68f","#a6d75b","#c9e52f","#d0ee11","#d0f400"],red:Ur[8].slice(1),"blue yellow red":["blue","yellow","red"]};I.types.cell_network_chart={name:"Spatial Connectivity Map",required:["interactions"],methodsUsingColumns:["changeLinkThicknessParameter","changeLinkLengthParameter","changeLinkColorParameter"],class:class extends sn{constructor(t,e,n){n.title||(n.title=n.category),n.link_strength=n.link_strength||1,n.node_repulsion=n.node_repulsion||-500,super(t,e,n,{});const i=this.config;if(this.linkThicknessScale=(0,St.Z)(),i.scales={},i.link_thickness)this._changeLinkThicknessScale();else{i.link_thickness={show_legend:!0,legend_position:[20,80]};const t=this.dataStore.getColumnQuantile(i.param[4],.01);this._changeLinkThicknessScale(t,[1,10])}if(this.linkLengthScale=(0,St.Z)(),this.forceLink=function(t){var e,n,i,r,o,s,a=sr,l=function(t){return 1/Math.min(r[t.source.index],r[t.target.index])},c=rr(30),u=1;function h(i){for(var r=0,a=t.length;r<u;++r)for(var l,c,h,d,f,p,g,m=0;m<a;++m)c=(l=t[m]).source,d=(h=l.target).x+h.vx-c.x-c.vx||or(s),f=h.y+h.vy-c.y-c.vy||or(s),d*=p=((p=Math.sqrt(d*d+f*f))-n[m])/p*i*e[m],f*=p,h.vx-=d*(g=o[m]),h.vy-=f*g,c.vx+=d*(g=1-g),c.vy+=f*g}function d(){if(i){var s,l,c=i.length,u=t.length,h=new Map(i.map(((t,e)=>[a(t,e,i),t])));for(s=0,r=new Array(c);s<u;++s)(l=t[s]).index=s,"object"!=typeof l.source&&(l.source=ar(h,l.source)),"object"!=typeof l.target&&(l.target=ar(h,l.target)),r[l.source.index]=(r[l.source.index]||0)+1,r[l.target.index]=(r[l.target.index]||0)+1;for(s=0,o=new Array(u);s<u;++s)l=t[s],o[s]=r[l.source.index]/(r[l.source.index]+r[l.target.index]);e=new Array(u),f(),n=new Array(u),p()}}function f(){if(i)for(var n=0,r=t.length;n<r;++n)e[n]=+l(t[n],n,t)}function p(){if(i)for(var e=0,r=t.length;e<r;++e)n[e]=+c(t[e],e,t)}return null==t&&(t=[]),h.initialize=function(t,e){i=t,s=e,d()},h.links=function(e){return arguments.length?(t=e,d(),h):t},h.id=function(t){return arguments.length?(a=t,h):a},h.iterations=function(t){return arguments.length?(u=+t,h):u},h.strength=function(t){return arguments.length?(l="function"==typeof t?t:rr(+t),f(),h):l},h.distance=function(t){return arguments.length?(c="function"==typeof t?t:rr(+t),p(),h):c},h}().id((function(t){return t.id})),i.link_length)this._changeLinkLengthScale();else{i.link_length={};const t=this.dataStore.getColumnQuantile(i.param[3],.01);this._changeLinkLengthScale(t,[1,100])}if(this.nodeScale=jr(),i.node_size)this._changeNodeSizeScale();else{i.node_size={show_legend:!0,legend_position:[20,180]};const t=this.dataStore.getMinMaxForColumn(i.param[6]);this._changeNodeSizeScale(t,[1,15])}if(i.link_color)this._changeLinkColorScale();else{i.link_color={};const t=this.dataStore.getColumnQuantile(i.param[5],.01);this._changeLinkColorScale("red",t)}i.color_legend||(i.color_legend={display:!0}),i.node_color=i.node_color||"cells",i.levels=i.levels||1,i.label_size=i.label_size||13,this.extra_legends=["linkThicknessLegend","nodeColorLegend"],this.forceManyBody=function(){var t,e,n,i,r,o=rr(-30),s=1,a=1/0,l=.81;function c(n){var r,o=t.length,s=dr(t,_r,vr).visitAfter(h);for(i=n,r=0;r<o;++r)e=t[r],s.visit(d)}function u(){if(t){var e,n,i=t.length;for(r=new Array(i),e=0;e<i;++e)n=t[e],r[n.index]=+o(n,e,t)}}function h(t){var e,n,i,o,s,a=0,l=0;if(t.length){for(i=o=s=0;s<4;++s)(e=t[s])&&(n=Math.abs(e.value))&&(a+=e.value,l+=n,i+=n*e.x,o+=n*e.y);t.x=i/l,t.y=o/l}else{(e=t).x=e.data.x,e.y=e.data.y;do{a+=r[e.data.index]}while(e=e.next)}t.value=a}function d(t,o,c,u){if(!t.value)return!0;var h=t.x-e.x,d=t.y-e.y,f=u-o,p=h*h+d*d;if(f*f/l<p)return p<a&&(0===h&&(p+=(h=or(n))*h),0===d&&(p+=(d=or(n))*d),p<s&&(p=Math.sqrt(s*p)),e.vx+=h*t.value*i/p,e.vy+=d*t.value*i/p),!0;if(!(t.length||p>=a)){(t.data!==e||t.next)&&(0===h&&(p+=(h=or(n))*h),0===d&&(p+=(d=or(n))*d),p<s&&(p=Math.sqrt(s*p)));do{t.data!==e&&(f=r[t.data.index]*i/p,e.vx+=h*f,e.vy+=d*f)}while(t=t.next)}}return c.initialize=function(e,i){t=e,n=i,u()},c.strength=function(t){return arguments.length?(o="function"==typeof t?t:rr(+t),u(),c):o},c.distanceMin=function(t){return arguments.length?(s=t*t,c):Math.sqrt(s)},c.distanceMax=function(t){return arguments.length?(a=t*t,c):Math.sqrt(a)},c.theta=function(t){return arguments.length?(l=t*t,c):Math.sqrt(l)},c}().distanceMax(150),this.simulation=function(t){var e,n=1,i=.001,r=1-Math.pow(i,1/300),o=0,s=.6,a=new Map,l=Gt(h),c=It("tick","end"),u=function(){let t=1;return()=>(t=(1664525*t+1013904223)%mr)/mr}();function h(){d(),c.call("tick",e),n<i&&(l.stop(),c.call("end",e))}function d(i){var l,c,u=t.length;void 0===i&&(i=1);for(var h=0;h<i;++h)for(n+=(o-n)*r,a.forEach((function(t){t(n)})),l=0;l<u;++l)null==(c=t[l]).fx?c.x+=c.vx*=s:(c.x=c.fx,c.vx=0),null==c.fy?c.y+=c.vy*=s:(c.y=c.fy,c.vy=0);return e}function f(){for(var e,n=0,i=t.length;n<i;++n){if((e=t[n]).index=n,null!=e.fx&&(e.x=e.fx),null!=e.fy&&(e.y=e.fy),isNaN(e.x)||isNaN(e.y)){var r=10*Math.sqrt(.5+n),o=n*br;e.x=r*Math.cos(o),e.y=r*Math.sin(o)}(isNaN(e.vx)||isNaN(e.vy))&&(e.vx=e.vy=0)}}function p(e){return e.initialize&&e.initialize(t,u),e}return null==t&&(t=[]),f(),e={tick:d,restart:function(){return l.restart(h),e},stop:function(){return l.stop(),e},nodes:function(n){return arguments.length?(t=n,f(),a.forEach(p),e):t},alpha:function(t){return arguments.length?(n=+t,e):n},alphaMin:function(t){return arguments.length?(i=+t,e):i},alphaDecay:function(t){return arguments.length?(r=+t,e):+r},alphaTarget:function(t){return arguments.length?(o=+t,e):o},velocityDecay:function(t){return arguments.length?(s=1-t,e):1-s},randomSource:function(t){return arguments.length?(u=t,a.forEach(p),e):u},force:function(t,n){return arguments.length>1?(null==n?a.delete(t):a.set(t,p(n)),e):a.get(t)},find:function(e,n,i){var r,o,s,a,l,c=0,u=t.length;for(null==i?i=1/0:i*=i,c=0;c<u;++c)(s=(r=e-(a=t[c]).x)*r+(o=n-a.y)*o)<i&&(l=a,i=s);return l},on:function(t,n){return arguments.length>1?(c.on(t,n),e):c.on(t)}}}().force("link",this.forceLink.strength(this.config.link_strength)).force("charge",this.forceManyBody.strength(n.node_repulsion)).force("center",ir(this.width/2,this.height/2)),this.config.base_cell?this.getLinks2():this.getLinks(),this.setColorLegend(),this.reCalculate()}remove(){this.simulation.on("tick",null),super.remove()}drawChart(){const t=this,e=this.config;this.svg.selectAll("*").remove();const n=this.dataStore.getColumnColors(e.param[1]),i=this.dataStore.getColorForCategory(e.param[0],e.category),r=this.dataStore.getRawColumn(e.param[4]),o=this.svg.append("g").attr("class","links").selectAll("line").data(this.linkData).enter();this.link=o.append("line").attr("stroke-width",(e=>t.linkThicknessScale(r[e.d_index]))).style("stroke",(e=>t.linkColorScale?t.linkColorScale(e.d_index):"currentcolor")).style("opacity",.6).on("click",((e,n)=>{t.dataStore.dataHighlighted([n.d_index],t)})),this.arrows=o.append("path").attr("stroke-width",3).attr("fill","none").style("opacity",e.show_directionality?1:0).attr("stroke",(e=>t.linkColorScale?t.linkColorScale(e.d_index):"currentcolor")),this.node=this.svg.append("g").attr("class","nodes").selectAll("g").data(this.nodeData).enter().append("g"),this.circles=this.node.append("circle").attr("r",(e=>t.nodeScale(e.node_size))).attr("fill",(function(t){return"cells"===e.node_color?n[t.d_index]:i})).call(this.setUpDrag()),this.lables=this.node.append("text").text((function(t){return t.id})).style("fill","currentcolor").style("font-size",`${t.config.label_size}px`).attr("x",6).attr("y",3),this.simulation.nodes(this.nodeData).on("tick",(()=>t.ticked())),this.simulation.force("link").links(this.linkData)}_changeLabelSize(t){this.config.label_size=t,this.lables.style("font-size",`${t}px`)}_changeNodeSizeScale(t,e,n){const i=this.config;e&&(i.node_size.range=e),t&&(i.node_size.domain=t);const r=this;this.nodeScale=jr().domain(i.node_size.domain).range(i.node_size.range).clamp(!0);const o=this.nodeColorLegend;if(o&&(i.node_size.legend_position=[o.offsetLeft,o.offsetTop],o.remove()),!i.node_size.show_legend)return void delete this.nodeColorLegend;const s=this.dataStore.columnIndex[i.param[6]].name;let a=i.node_size.legend_position;this.nodeColorLegend=(0,Zs.JW)(this.nodeScale,{label:s,type:"circle"}),this.contentDiv.append(this.nodeColorLegend),this.nodeColorLegend.style.top=a[1]+"px",this.nodeColorLegend.style.left=a[0]+"px",n&&this.circles.attr("r",(t=>r.nodeScale(t.node_size)))}changeLinkThicknessParameter(t,e){this._changeLinkThicknessScale(e,null,!0)}changeLinkLengthParameter(t,e){this._changeLinkLengthScale(e,null,!0)}changeLinkColorParameter(t,e){this._changeLinkColorScale(null,[e[0],e[1]],!0)}_changeLinkThicknessScale(t,e,n){const i=this.config;if(e&&(i.link_thickness.range=e),t&&(i.link_thickness.domain=t),this.linkThicknessScale.domain(i.link_thickness.domain).range(i.link_thickness.range).clamp(!0),n){const t=this,e=this.dataStore.getRawColumn(i.param[4]);this.link.attr("stroke-width",(n=>t.linkThicknessScale(e[n.d_index])))}const r=this.linkThicknessLegend;if(r&&(i.link_thickness.legend_position=[r.offsetLeft,r.offsetTop],r.remove()),!i.link_thickness.show_legend)return void delete this.linkThicknessLegend;let o=i.link_thickness.legend_position;const s=this.dataStore.columnIndex[i.param[4]].name;this.linkThicknessLegend=(0,Zs.JW)(this.linkThicknessScale,{label:s,type:"line"}),this.contentDiv.append(this.linkThicknessLegend),this.linkThicknessLegend.style.top=o[1]+"px",this.linkThicknessLegend.style.left=o[0]+"px"}_changeLinkLengthScale(t,e,n){const i=this.config,r=this;e&&(i.link_length.range=e),t&&(i.link_length.domain=t);const o=[i.link_length.range[0],i.link_length.range[1]];this.linkLengthScale.domain([...i.link_length.domain].reverse()).range(o).clamp(!0);const s=this.dataStore.getRawColumn(i.param[3]),a=this.linkLengthScale.range()[1];this.forceLink.distance((t=>{const e=s[t.d_index];return isNaN(e)?a:r.linkLengthScale(e)})),n&&(this.simulation.alphaTarget(.2).restart(),setTimeout((()=>{this.simulation.alphaTarget(0)}),1e3))}_changeNodeColor(t){const e=this.config;e.node_color=t;const n=this.dataStore.getColumnColors(e.param[1]),i=this.dataStore.getColorForCategory(e.param[0],e.category);this.circles.attr("fill",(function(t){return"cells"===e.node_color?n[t.d_index]:i}))}getConfig(){const t=super.getConfig(),e=this.linkThicknessLegend;e&&(t.link_thickness.legend_position=[e.offsetLeft,e.offsetTop]);const n=this.nodeColorLegend;return n&&(t.node_size.legend_position=[n.offsetLeft,n.offsetTop]),t}_changeLinkColorScale(t,e,n){e&&(this.config.link_color.domain=e),t&&(this.config.link_color.colors=t);const i=this.config.link_color.domain;this.linkColorScale=this.dataStore.getColorFunction(this.config.param[5],{overideValues:{min:i[0],max:i[1],colors:qs[this.config.link_color.colors]}});const r=this;n&&(this.link.style("stroke",(t=>r.linkColorScale?r.linkColorScale(t.d_index):"black")),this.setColorLegend(),this.arrows.attr("stroke",(t=>r.linkColorScale?r.linkColorScale(t.d_index):"black")))}onDataFiltered(t){this.reCalculate()}getColorLegend(){const t=this.config,e=t.link_color.domain;return this.dataStore.getColorLegend(t.param[5],{overideValues:{min:e[0],max:e[1],colors:qs[t.link_color.colors]}})}colorByDefault(){delete this.config.color_by,this.legend&&this.legend.remove(),this.linkColorScale=null,this._changeLinkColor()}ticked(){const t=this;this.lables.attr("text-anchor",(t=>t.x>2*this.width/3?"end":"start")).attr("x",(t=>t.x>2*this.width/3?-6:6)),this.node.attr("transform",(function(e){return e.x=Math.min(e.x,t.width-20),e.x=Math.max(e.x,15),e.y=Math.min(e.y,t.height-20),e.y=Math.max(e.y,15),"translate("+e.x+","+e.y+")"})),this.link.attr("x1",(function(t){return t.source.x})).attr("y1",(function(t){return t.source.y})).attr("x2",(function(t){return t.target.x})).attr("y2",(function(t){return t.target.y})),this.arrows.attr("d",(t=>{let e=Math.sqrt(Math.pow(t.source.y-t.target.y,2)+Math.pow(t.target.x-t.source.x,2));e=0===e?.1:e;const n=(e/2-5)/e,i=(t.target.x-t.source.x)/2+t.source.x,r=(t.target.y-t.source.y)/2+t.source.y,o=(t.target.x-t.source.x)*n+t.source.x,s=(t.target.y-t.source.y)*n+t.source.y,a=5/e*(t.source.y-t.target.y),l=o+a,c=o-a,u=5/e*(t.target.x-t.source.x);return`M ${l} ${s+u} ${i} ${r} ${c} ${s-u}`}))}setUpDrag(){const t=this;return function(){var t,e,n,i,r=Ji,o=tr,s=er,a=nr,l={},c=It("start","drag","end"),u=0,h=0;function d(t){t.on("mousedown.drag",f).filter(a).on("touchstart.drag",m).on("touchmove.drag",_,an).on("touchend.drag touchcancel.drag",v).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function f(s,a){if(!i&&r.call(this,s,a)){var l=b(this,o.call(this,s,a),s,a,"mouse");l&&((0,ft.Z)(s.view).on("mousemove.drag",p,ln).on("mouseup.drag",g,ln),hn(s.view),cn(s),n=!1,t=s.clientX,e=s.clientY,l("start",s))}}function p(i){if(un(i),!n){var r=i.clientX-t,o=i.clientY-e;n=r*r+o*o>h}l.mouse("drag",i)}function g(t){(0,ft.Z)(t.view).on("mousemove.drag mouseup.drag",null),dn(t.view,n),un(t),l.mouse("end",t)}function m(t,e){if(r.call(this,t,e)){var n,i,s=t.changedTouches,a=o.call(this,t,e),l=s.length;for(n=0;n<l;++n)(i=b(this,a,t,e,s[n].identifier,s[n]))&&(cn(t),i("start",t,s[n]))}}function _(t){var e,n,i=t.changedTouches,r=i.length;for(e=0;e<r;++e)(n=l[i[e].identifier])&&(un(t),n("drag",t,i[e]))}function v(t){var e,n,r=t.changedTouches,o=r.length;for(i&&clearTimeout(i),i=setTimeout((function(){i=null}),500),e=0;e<o;++e)(n=l[r[e].identifier])&&(cn(t),n("end",t,r[e]))}function b(t,e,n,i,r,o){var a,h,f,p=c.copy(),g=pn(o||n,e);if(null!=(f=s.call(t,new Qi("beforestart",{sourceEvent:n,target:d,identifier:r,active:u,x:g[0],y:g[1],dx:0,dy:0,dispatch:p}),i)))return a=f.x-g[0]||0,h=f.y-g[1]||0,function n(o,s,c){var m,_=g;switch(o){case"start":l[r]=n,m=u++;break;case"end":delete l[r],--u;case"drag":g=pn(c||s,e),m=u}p.call(o,t,new Qi(o,{sourceEvent:s,subject:f,target:d,identifier:r,active:m,x:g[0]+a,y:g[1]+h,dx:g[0]-_[0],dy:g[1]-_[1],dispatch:p}),i)}}return d.filter=function(t){return arguments.length?(r="function"==typeof t?t:Yi(!!t),d):r},d.container=function(t){return arguments.length?(o="function"==typeof t?t:Yi(t),d):o},d.subject=function(t){return arguments.length?(s="function"==typeof t?t:Yi(t),d):s},d.touchable=function(t){return arguments.length?(a="function"==typeof t?t:Yi(!!t),d):a},d.on=function(){var t=c.on.apply(c,arguments);return t===c?d:t},d.clickDistance=function(t){return arguments.length?(h=(t=+t)*t,d):Math.sqrt(h)},d}().on("start",(function(e){e.active||t.simulation.alphaTarget(.3).restart(),e.subject.fx=e.subject.x,e.subject.fy=e.subject.y})).on("drag",(function(t){t.subject.fx=t.x,t.subject.fy=t.y})).on("end",(function(e){e.active||t.simulation.alphaTarget(0),e.subject.fx=null,e.subject.fy=null}))}reCalculate(){this.config.base_cell?this.getLinks2():this.getLinks(),this.drawChart(),this.simulation.alphaTarget(.2).restart(),setTimeout((()=>{this.simulation.alphaTarget(0)}),1e3)}changeParameter(){const t=this.config;this.forceLink.strength(t.link_strength),this.forceManyBody.strength(t.node_repulsion),this.simulation.alphaTarget(.2).restart(),setTimeout((()=>{this.simulation.alphaTarget(0)}),1e3)}getLinks2(){const t=this.config.param,e=this.dataStore.getColumnValues(t[1]),n=this.dataStore.getColumnValues(t[2]),i=this.dataStore.getColumnValues(t[0]).indexOf(this.config.category),r=this.dataStore.columnIndex,o=r[t[0]].data,s=r[t[1]].data,a=r[t[2]].data,l=r[t[6]].data;this.nodeData=[];let c=new Set;const u=e.indexOf(this.config.base_cell);c.add(u);const h=new Set;let d=new Set;const f=this.config.specific_only;if(f)d=new Set(f[0].map((t=>e.indexOf(t))));else for(let t=0;t<e.length;t++)d.add(t);const p=this.dataStore.filterArray;for(let t=0;t<this.dataStore.size;t++)p[t]>0||o[t]===i&&s[t]==u&&d.has(a[t])&&s[t]!==a[t]&&(h.add(`${s[t]}|${a[t]}`),c.add(a[t]));let g=new Set(c);if(2==this.config.levels)for(let t=0;t<this.dataStore.size;t++)if(!(p[t]>0)&&o[t]===i&&c.has(s[t])&&d.has(a[t])&&s[t]!==a[t]){if(a[t]===u)continue;h.has(`${a[t]}|${s[t]}`)||(h.add(`${s[t]}|${a[t]}`),g.add(a[t]))}for(let t=0;t<e.length;t++)for(let e=0;e<n.length;e++)(!g||g.has(t)&&g.has(e))&&h.add(`${t}|${e}`);this.linkData=[];const m={};for(let t=0;t<this.dataStore.size;t++){if(p[t]>0)continue;m[e[s[t]]]=l[t];const r=`${s[t]}|${a[t]}`;o[t]===i&&h.has(r)&&(h.delete(`${a[t]}|${s[t]}`),this.linkData.push({source:e[s[t]],target:n[a[t]],d_index:t}))}for(let t=0;t<e.length;t++)g&&!g.has(t)||this.nodeData.push({id:e[t],d_index:t,node_size:m[e[t]]})}getLinks(){const t=this.config.param,e=this.dataStore.getColumnValues(t[1]),n=this.dataStore.getColumnValues(t[2]);this.nodeData=[];let i=null;const r=this.config.specific_only;r&&(i=new Set(r[0].map((t=>e.indexOf(t)))));const o=new Set;for(let t=0;t<e.length;t++)for(let e=t+1;e<n.length;e++)(!i||i.has(t)&&i.has(e))&&o.add(`${t}|${e}`);const s=this.dataStore.getColumnValues(t[0]).indexOf(this.config.category),a=this.dataStore.columnIndex,l=a[t[0]].data,c=a[t[1]].data,u=a[t[2]].data,h=a[t[6]].data;this.linkData=[];const d={},f=this.dataStore.filterArray;for(let t=0;t<this.dataStore.size;t++){if(f[t]>0)continue;d[e[c[t]]]=h[t];const i=`${c[t]}|${u[t]}`;l[t]===s&&o.has(i)&&this.linkData.push({source:e[c[t]],target:n[u[t]],d_index:t})}for(let t=0;t<e.length;t++)i&&!i.has(t)||this.nodeData.push({id:e[t],d_index:t,node_size:d[e[t]]})}setSize(t,e){super.setSize(t,e),this.simulation.force("center",ir(this.width/2,this.height/2)),this._changeLinkLengthScale(null,null,!0)}getSettings(){const t=super.getSettings(),e=this.config,n=this.dataStore.getColumnValues(e.param[0]),i=this.dataStore.getColumnValues(e.param[1]).map((t=>({t})));i.unshift({t:"None"}),n.map((t=>({t,v:t}))),t.push({type:"slider",max:20,min:5,doc:this.__doc__,current_value:e.label_size,label:"Label Size",func:t=>{this._changeLabelSize(t)}}),t.push({type:"dropdown",current_value:e.base_cell||"None",values:[i,"t","t"],label:"Center Cell",func:t=>{"None"===t?delete e.base_cell:e.base_cell=t,this.reCalculate()}}),t.push({type:"radiobuttons",label:"Number of Levels",current_value:e.levels,choices:[["1",1],["2",2]],func:t=>{e.levels=parseInt(t),e.base_cell&&this.reCalculate()}});const r=this.dataStore.getColumnList("number");let o=this.dataStore.getColumnQuantile(e.param[5],.01);t.push({label:"Link Color",type:"dropdown",values:[r,"name","field"],current_value:e.param[5],func:t=>{e.param[5]=t},onchange:(t,n)=>{e.param[5]=n;const i=t["Link Color Domain"].noUiSlider,r=this.dataStore.getColumnQuantile(n,.01);i.updateOptions({range:{max:r[1],min:r[0]}}),i.set(r),this.changeLinkColorParameter(n,r)}});const s=[];for(let t in qs)s.push([t,t]);return t.push({type:"radiobuttons",label:"Link Color",current_value:e.link_color.colors,choices:s,func:t=>{this._changeLinkColorScale(t,null,!0)}}),t.push({type:"doubleslider",max:o[1],min:o[0],doc:this.__doc__,current_value:this.config.link_color.domain,label:"Link Color Domain",func:(t,e)=>{this._changeLinkColorScale(null,[t,e],!0)}}),o=this.dataStore.getColumnQuantile(e.param[4],.01),t.push({label:"Link Thickness",type:"dropdown",values:[r,"name","field"],current_value:e.param[4],func:t=>{e.param[4]=t},onchange:(t,n)=>{e.param[4]=n;const i=t["Link Thickness Domain"].noUiSlider,r=this.dataStore.getColumnQuantile(n,.01);i.updateOptions({range:{max:r[1],min:r[0]}}),i.set(r),this.changeLinkThicknessParameter(n,r)}}),t.push({type:"doubleslider",max:20,min:1,doc:this.__doc__,current_value:this.config.link_thickness.range,label:"Link Thickness Range",func:(t,e)=>{this._changeLinkThicknessScale(null,[t,e],!0)}}),t.push({type:"doubleslider",max:o[1],min:o[0],doc:this.__doc__,current_value:this.config.link_thickness.domain,label:"Link Thickness Domain",func:(t,e)=>{this._changeLinkThicknessScale([t,e],null,!0)}}),t.push({type:"check",current_value:e.link_thickness.show_legend,label:"Show Link Thickness Legend",func:t=>{e.link_thickness.show_legend=t,this._changeLinkThicknessScale()}}),o=this.dataStore.getColumnQuantile(e.param[3],.01),t.push({label:"Link Length",type:"dropdown",values:[r,"name","field"],current_value:e.param[3],func:t=>{e.param[3]=t},onchange:(t,n)=>{e.param[3]=n;const i=t["Link Length Domain"].noUiSlider,r=this.dataStore.getColumnQuantile(n,.01);i.updateOptions({range:{max:r[1],min:r[0]}}),i.set(r),this.changeLinkLengthParameter(n,r)}}),t.push({type:"doubleslider",max:200,min:1,doc:this.__doc__,current_value:this.config.link_length.range,label:"Link Length Range",func:(t,e)=>{this._changeLinkLengthScale(null,[t,e],!0)}}),t.push({type:"doubleslider",max:o[1],min:o[0],doc:this.__doc__,current_value:this.config.link_length.domain,label:"Link Length Domain",func:(t,e)=>{this._changeLinkLengthScale([t,e],null,!0)}}),t.push({type:"check",current_value:e.show_directionality,label:"Show Directionality",func:t=>{e.show_directionality=t,this.arrows.style("opacity",t?1:0)}}),t.push({type:"radiobuttons",label:"Node Color",current_value:e.node_color,choices:[["Cells","cells"],["State","state"]],func:t=>{this._changeNodeColor(t)}}),o=this.dataStore.getMinMaxForColumn(e.param[6]),t.push({type:"doubleslider",max:50,min:1,doc:this.__doc__,current_value:this.config.node_size.range,label:"Node Size Range",func:(t,e)=>{this._changeNodeSizeScale(null,[t,e],!0)}}),t.push({type:"doubleslider",max:o[1],min:o[0],doc:this.__doc__,current_value:this.config.node_size.domain,label:"Node Size Domain",func:(t,e)=>{this._changeNodeSizeScale([t,e],null,!0)}}),t.push({type:"check",current_value:e.node_size.show_legend,label:"Show Node Size Legend",func:t=>{e.node_size.show_legend=t,this._changeNodeSizeScale()}}),t.push({type:"slider",max:2,min:0,doc:this.__doc__,current_value:e.link_strength,label:"Link Strength",func:t=>{e.link_strength=t,this.changeParameter()}}),t.push({type:"slider",max:0,min:-1e3,doc:this.__doc__,current_value:e.node_repulsion,label:"Node Repulsion",func:t=>{e.node_repulsion=t,this.changeParameter()}}),t}},init:(t,e,n)=>{const i=e.interactions,r=e.interactions.spatial_connectivity_map;t.param=[i.pivot_column,i.interaction_columns[0],i.interaction_columns[1],r.link_length,r.link_thickness,r.link_color,r.node_size],t.category=n.pivot},extra_controls:t=>{const e=t.interactions.pivot_column;return[{type:"dropdown",name:"pivot",label:t.getColumnName(e),values:t.getColumnValues(e).map((t=>({name:t,value:t})))}]}};I.types.single_heat_map={name:"Interaction Matrix",required:["interactions"],methodsUsingColumns:["changeValues"],init:(t,e,n)=>{const i=e.interactions;t.param=[i.interaction_columns[0],i.interaction_columns[1],n.value,i.pivot_column],i.interaction_matrix?.groups&&(t.param=t.param.concat(i.interaction_matrix.groups)),t.category=n.pivot},extra_controls:t=>{const e=t.interactions.pivot_column,n=t.getColumnList("number");return[{type:"dropdown",name:"pivot",label:t.getColumnName(e),values:t.getColumnValues(e).map((t=>({name:t,value:t})))},{type:"dropdown",name:"value",label:"Value To Display",values:n.map((t=>({name:t.name,value:t.field})))}]},class:class extends sn{constructor(t,e,n){super(t,e,n,{x:{type:"band"},y:{type:"band"}}),n.title||this._setTitle();const i=this.config.param;let r=this.dataStore.getColumnValues(i[0]);this.y_scale.domain(r.slice(0)),r=this.dataStore.getColumnValues(i[1]),this.x_scale.domain(r.slice(0));const o=this.config;o.color_scale=o.color_scale||{log:!1,min_max:t.getColumnQuantile(i[2],.01)},o.color_legend||(o.color_legend={display:!0}),this.setColorFunction(),this.initialSetUp(),this.addToolTip(),this.drawChart()}remove(t=!0){super.remove()}onDataHighlighted(t){const e=t.indexes[0],n=this.graph_area.selectAll("rect");n.attr("stroke","white").style("stroke-width","0px"),n.filter((t=>!(!t||t[3]!==e))).attr("stroke","black").style("stroke-width","4px"),this.highlight=e}_setTitle(){const t=this.config.category,e=this.dataStore.getColumnName(this.config.param[2]);this.setTitle(`${t}-${e}`)}changeCategory(t){this.config.category=t,this.initialSetUp(),this.drawChart(),this._setTitle()}onDataFiltered(t){this.initialSetUp(),this.drawChart()}changeValues(t){this.config.param[2]=t,this.setColorFunction(),this.initialSetUp(),this.drawChart(),this._setTitle()}initialSetUp(){const t=this.config,e=t.param,n=this.dataStore.columnIndex[e[0]],i=n.data,r=this.dataStore.columnIndex[e[1]],o=r.data;let s=null,a=null,l=n.values.length,c=r.values.length;this.y_scale.domain(n.values.slice(0)),this.x_scale.domain(r.values.slice(0));for(let t of this.dataStore.dimensions)if(t.filterColumns&&t.noclear){if(t.filterColumns[0]===e[0]){const e=t.filterArguments;s=e.map((t=>n.values.indexOf(t))),l=e.length,this.y_scale.domain(e.slice(0))}if(t.filterColumns[0]===e[1]){const e=t.filterArguments;a=e.map((t=>r.values.indexOf(t))),c=e.length,this.x_scale.domain(e.slice(0))}}const u=this.dataStore.columnIndex,h=u[e[3]].data,d=u[e[2]].data,f=this.dataStore.size,p=new Array;for(let t=0;t<l;t++)p[t]=new Array(c);const g=this.dataStore.columnIndex[e[3]].values.indexOf(t.category);let m=null,_=null;t.show_group_interactions&&(m=this.dataStore.getRawColumn(e[4]),_=this.dataStore.getRawColumn(e[5]));for(let t=0;t<f;t++)if(h[t]===g){let e=i[t],n=o[t];if(e=s?s.indexOf(e):e,n=a?a.indexOf(n):n,-1===n||-1===e)continue;let r=p[e][n];r?(r[2]+=d[t],r[4]++):(p[e][n]=[i[t],o[t],d[t],t,1],m&&p[e][n].push(`${m[t]}-${_[t]}`))}for(let t=0;t<l;t++)for(let e=0;e<c;e++){const n=p[t][e];n[2]/=n[4]}this.data=p}drawChart(t=300){this.updateAxis();const e=(0,ft.Z)(this.contentDiv).transition().duration(t).ease(pt),n=this.config.param,i=this.dataStore.getColumnValues(this.config.param[0]),r=this.dataStore.getColumnValues(this.config.param[1]),o=this.y_scale.domain().length,s=this.x_scale.domain().length,a=this._getContentDimensions(),l=a.width/s,c=this,u=a.height/o,h=this.dataStore.filterArray,d="#E0E0E0";let f=null,p=null,g=null;if(6==n.length){const t=this.dataStore.getColumnValues(n[4]),e=this.dataStore.getColumnValues(n[5]);p=this.dataStore.getRawColumn(n[4]),g=this.dataStore.getRawColumn(n[5]),f=new Array(t.length);for(let t=0;t<f.length;t++){const n=new Array(e.length);n.fill(0),f[t]=n}}if(this.graph_area.selectAll(".heatmap-row").data(this.data).join("g").attr("transform",((t,e)=>`translate(0,${e*u})`)).attr("class","heatmap-row").selectAll(".heatmap-rect").data((t=>t)).join("rect").attr("class","heatmap-rect").attr("x",((t,e)=>e*l+1)).attr("height",u-2).attr("width",l-2).on("click",((t,e)=>{c.dataStore.dataHighlighted([e[3]],c)})).on("mouseover pointermove",((t,e)=>{const n=r[e[0]],o=i[e[1]];c.showToolTip(t,`${n}<br>${o}<br>${e[2].toPrecision(3)}`)})).on("mouseleave",(()=>{c.hideToolTip()})).transition(e).attr("fill",((t,e)=>t?isNaN(t[2])||h[t[3]]>0?d:(f&&f[p[t[3]]][g[t[1]]]++,c.colorFunction(t[2])):d)),f){const t=this.dataStore.getColumnValues(n[4]),e=this.dataStore.getColumnValues(n[5]),i=[];for(let n=0;n<t.length;n++)for(let r=0;r<e.length;r++)i.push(`${t[n]}-${e[r]}:${f[n][r]}`);this.legendIcon.setAttribute("aria-label",i.join(", "))}this.updateAxis()}setSize(t,e){super.setSize(t,e),this.drawChart()}getColorLegend(){const t={overideValues:{colorLogScale:this.config.color_scale.log,colors:["#313695","#4575B4","#74ADD1","#ABD9E9","#E0F3F8","#E0F3F8","#FFFFBF","#FEE090","#FDAE61","#F46D43","#D73027","#A50026"]},name:"Scale"},e=this.config.color_scale.min_max;return e&&(t.overideValues.min=e[0],t.overideValues.max=e[1]),this.dataStore.getColorLegend(this.config.param[2],t)}getSettings(){const t=super.getSettings(),e=this.config,n=this.dataStore.getColumnValues(e.param[3]).map((t=>({t,v:t}))),i=this.dataStore.getColumnQuantile(e.param[2],.01);t.push({type:"doubleslider",max:i[1],min:i[0],doc:this.__doc__,current_value:e.color_scale.min_max,label:"Color Scale",func:(t,n)=>{e.color_scale.min_max=[t,n],this.setColorFunction(),this.drawChart()}}),t.push({label:"Change Category",type:"dropdown",values:[n,"t","v"],current_value:e.category,func:t=>{this.changeCategory(t)}});const r=this.dataStore.getColumnList("number");return t.push({label:"Change Values",type:"dropdown",values:[r,"name","field"],current_value:e.param[2],func:(t,n)=>{const i=this.dataStore.getColumnQuantile(t,.01);e.color_scale.min_max=i;const r=n["Color Scale"].noUiSlider;r.updateOptions({range:{max:i[1],min:i[0]}}),r.set(i),this.changeValues(t)}}),t}setColorFunction(){const t=this.config.param,e={useValue:!0,overideValues:{colorLogScale:this.config.color_scale.log,colors:["#313695","#4575B4","#74ADD1","#ABD9E9","#E0F3F8","#E0F3F8","#FFFFBF","#FEE090","#FDAE61","#F46D43","#D73027","#A50026"]}},n=this.config.color_scale.min_max;n&&(e.overideValues.min=n[0],e.overideValues.max=n[1]),this.colorFunction=this.dataStore.getColorFunction(t[2],e),this.setColorLegend()}}};class Gs extends F.v{constructor(t,e,n){super({width:500,title:"Channels",doc:e||document},{viv:t,ds:n})}init(t){const e=this.viv=t.viv;this.mainDiv=(0,T.ut)("div",{},this.dialog);const n=this.viv.getSelectedChannels();for(let t of n)this.addSlider(t);const i=(0,T.ut)("div",{styles:{padding:"4px"}},this.dialog),r=(0,T.ut)("select",{},i),o=e.getAllChannels();for(let t=0;t<o.length;t++)(0,T.ut)("option",{text:o[t].Name??o[t].ID,value:t},r);const s=(0,T.ut)("input",{styles:{width:"25px",height:"20px",padding:"0px",margin:"0px 4px"},type:"color",value:"#ff0000"},i);(0,T.ut)("button",{classes:["ciview-button-sm"],text:"Add Channel"},i).addEventListener("click",(()=>{this.viv.addChannel({index:parseInt(r.value),color:s.value}).then((t=>this.addSlider(t)))})),(0,T.ut)("button",{classes:["ciview-button-sm"],text:"Set as Default"},i).addEventListener("click",(()=>{t.ds.regions.avivator.default_channels=this.viv.getSelectedChannelsNice(),t.ds.dirtyMetadata.add("regions")}))}addSlider(t){const e=(0,T.ut)("div",{styles:{display:"flex",padding:"4px",alignItems:"center",width:"100%"}},this.mainDiv);(0,T.ut)("span",{text:t.name||`channel ${t.index}`,classes:["mdv-flex-dynamic"],styles:{flexBasis:"30%"}},e);const n=(0,T.ut)("div",{classes:["mdv-flex-dynamic"],styles:{margin:"0px 10px",flexBasis:"70%",overflow:"visible"}},e),i=t.domains;N().create(n,{start:[t.contrastLimits[0],t.contrastLimits[1]],range:{min:i?i[0]:0,max:i?i[1]:300},step:1,document:this.config.doc,tooltips:!0},e),n.noUiSlider.on("update",(e=>{t.contrastLimits=[parseFloat(e[0]),parseFloat(e[1])],this.viv.setChannel(t)}));const r=(0,T.ut)("input",{classes:["mdv-flex-fixed"],styles:{width:"25px",height:"20px",padding:"0px"},type:"color",value:t.color},e);r.addEventListener("input",(()=>{t.color=r.value,this.viv.setChannel(t)}));const o=(0,T.ut)("input",{classes:["mdv-flex-fixed","mdv-checkbox"],type:"checkbox"},e);o.checked=t.channelsVisible,o.addEventListener("click",(()=>{t.channelsVisible=o.checked,this.viv.setChannel(t)})),(0,T.ut)("i",{classes:["mdv-flex-fixed","fas","fa-times"],styles:{width:"16px",margin:"0px 3px",cursor:"pointer"}},e).addEventListener("click",(()=>{this.viv.removeChannel(t),e.remove()}))}}I.types.viv_scatter_plot={name:"Viv Scatter Plot",required:t=>t.regions?.avivator,extra_controls:t=>{const e=[];for(let n in t.regions.all_regions)t.regions.all_regions[n].viv_image&&e.push({name:n,value:n});return[{type:"dropdown",name:"region",label:t.getColumnName(t.regions.region_field),values:e}]},init:(t,e,n)=>{I.types.image_scatter_plot.init(t,e,n),delete t.background_image,t.radius=.5,t.viv={channels:e.regions.avivator.default_channels}},class:class extends $s{constructor(t,e,n){const i=t.getColumnName(n.param[0]),r=t.getColumnName(n.param[1]);n.axis||(n.axis={x:{size:30,label:i,textsize:13},y:{size:45,label:r,textsize:13}}),super(t,e,n,{x:{},y:{}}),n.viv&&this.addMenuIcon("fas fa-palette","Alter Channels").addEventListener("click",(t=>new Gs(this.viv,this.__doc__,this.dataStore)))}setSize(t,e){if(super.setSize(t,e),this.viv){const t=this._getContentDimensions();this.viv.setSize(t.width,t.height,this.app)}}remove(){this.viv.deck.finalize(),super.remove()}centerGraph(){super.centerGraph(),this.viv&&this.viv.setPanZoom(this.app.offset,this.app.x_scale,this.app.y_scale)}getConfig(){const t=super.getConfig(),e=this.viv.layers[0].props;return t.viv.file?t.viv.channels=this.viv.getSelectedChannelsNice():t.viv.image_properties={selections:e.selections.slice(0),colors:e.colors.slice(0),channelsVisible:e.channelsVisible.slice(0),contrastLimits:e.contrastLimits.slice(0),domains:e.domains?.slice(0)},t}afterAppCreation(){const t=this.config;if(t.viv||(t.viv={url:"https://viv-demo.storage.googleapis.com/LuCa-7color_3x3component_data.ome.tif",image_properties:{contrastLimits:[[0,255]],colors:[[255,255,255]],channelsVisible:[!0],selections:[{c:0,t:0,z:0}]}}),t.viv){const e=this._getContentDimensions();this.vivCanvas=(0,T.ut)("canvas",{height:e.height,width:e.width,styles:{position:"absolute"}}),this.graphDiv.prepend(this.vivCanvas),Promise.all([__webpack_require__.e(176),__webpack_require__.e(213)]).then(__webpack_require__.bind(__webpack_require__,2806)).then((({default:e})=>{const n=this.dataStore.regions;if(n){const e=n.all_regions[t.region].viv_image;t.viv.url=e.url?e.url:n.avivator.base_url+e.file}this.viv=new e(this.vivCanvas,t.viv,this.app),this.app.addHandler("pan_or_zoom",((t,e,n)=>{this.viv.setPanZoom(t,e,n)}),t.id+"_viv")}))}return super.afterAppCreation()}}};I.types.dot_plot={name:"Dot Plot",class:class extends sn{constructor(t,e,n){n.title=n.title||t.getColumnName(n.param[0]),super(t,e,n,{x:{type:"band"},y:{type:"band"},ry:{}});const i=this.config.param,r=[],o=this.config;o.color_scale=o.color_scale||{log:!1},o.color_legend||(o.color_legend={display:!0}),o.fraction_legend||(o.fraction_legend={display:!0}),this.fractionScale=jr().domain([0,100]);for(let t=1;t<i.length;t++)r.push(this.dataStore.getColumnName(i[t]));this.x_scale.domain(r),this.dim=this.dataStore.getDimension("catcol_dimension"),this.addToolTip(),this.onDataFiltered(),this.colorScheme=Ur[8]}remove(t=!0){this.dim.destroy(t),super.remove()}setColorFunction(){const t=this.config.param,e=this.data.mean_range,n={useValue:!0,overideValues:{colorLogScale:this.config.color_scale.log,colors:this.colorScheme,max:e[1],min:e[0]}};this.colorFunction=this.dataStore.getColorFunction(t[1],n),this.setColorLegend()}getColorLegend(){const t=this.config.color_scale,e=this.data.mean_range,n={overideValues:{max:e[1],min:e[0],colorLogScale:t.log,colors:this.colorScheme},name:"Mean Expression"};return this.dataStore.getColorLegend(this.config.param[1],n)}showFractionLegend(){const t=this.fractionLegend,e=this.config;if(t&&(e.fraction_legend.position=[t.offsetLeft,t.offsetTop],t.remove()),!e.fraction_legend.display)return void delete this.nodeFractionLegend;const n=e.fraction_legend.position||[0,0];this.fractionLegend=(0,Zs.JW)(this.fractionScale,{label:"fraction",type:"circle"}),this.contentDiv.append(this.fractionLegend),this.fractionLegend.style.top=n[1]+"px",this.fractionLegend.style.left=n[0]+"px"}getConfig(){const t=super.getConfig(),e=this.linkThicknessLegend;return e&&(t.fraction_legend.position=[e.offsetLeft,e.offsetTop]),t}onDataFiltered(t){if(this.dim===t||this.isPinned)return;"all_removed"===t&&(this.filter=[],this.resetButton.style.display="none");const e={method:"averages_simple",threshold:this.config.threshold_value};this.dim.getAverages((t=>{this.data=t,this.setColorFunction(),this.drawChart()}),this.config.param,e)}drawChart(t=400){(0,ft.Z)(this.contentDiv).transition().duration(t).ease(pt);const e=this._getContentDimensions(),n=e.width/(this.config.param.length-1),i=this;this.setColorFunction();const r=this.dataStore.getColumnValues(this.config.param[0]);let o=["cl01","cl03","cl04"];o=o.map((t=>r.indexOf(t)));const s=this.data.data.filter((t=>0!==t.count));this.y_scale.domain(s.map((t=>r[t.id]))),this.updateAxis();const a=e.height/s.length;let l=(n>a?a:n)/2;l=l>25?25:l,this.fractionScale.range([0,l]),this.showFractionLegend();const c=a/2;this.graph_area.selectAll(".dotplot-row").data(s,(t=>t.id)).join("g").attr("transform",((t,e)=>`translate(0,${e*a})`)).attr("class","dotplot-row").selectAll(".dotplot-circle").data((t=>t.values),(t=>t.id)).join("circle").attr("class","dotplot-circle").attr("stroke","black").attr("cx",((t,e)=>e*n+.5*n)).attr("cy",c).attr("r",(t=>i.fractionScale(t.frac))).attr("fill",((t,e)=>i.colorFunction(t.mean)))}setSize(t,e){super.setSize(t,e),this.drawChart()}getSettings(){const t=this.config;return super.getSettings().concat([{type:"check",label:"Cluster Rows",current_value:t.cluster_rows,func:e=>{t.cluster_rows=e,this.clusterRows(),this.drawChart()}},{type:"check",label:"Cluster Columns",current_value:t.cluster_columns,func:e=>{t.cluster_columns=e,this.clusterColumns(),this.drawChart()}},{type:"radiobuttons",label:"Averaging Method",current_value:t.method,choices:[["Mean","mean"],["Median","median"]],func:e=>{t.method=e,this.onDataFiltered()}},{type:"radiobuttons",label:"Trim to Percentile",current_value:t.color_scale.trim||"none",choices:[["No Trim","none"],["0.001","0.001"],["0.01","0.01"],["0.05","0.05"]],func:e=>{t.color_scale.trim=e,this.onDataFiltered()}},{label:"Show Color Legend",type:"check",current_value:!t.color_legend||t.color_legend.display,func:e=>{t.color_legend.display=e,this.setColorLegend()}},{type:"check",label:"Log Color Scale",current_value:t.color_scale.log,func:e=>{t.color_scale.log=e,this.setColorFunction(),this.drawChart()}}])}},params:[{type:"text",name:"Categories on x-axis"},{type:"_multi_column:number",name:"Fields on y axis"}]};function Ks(t,e){let n=(t-90)/180*Math.PI,i=e;return[i*Math.cos(n),i*Math.sin(n)]}I.types.image_table_chart={class:class extends I{constructor(t,e,n){super(t,e,n),this.dataModel=new Gn(t,{autoupdate:!1}),this.dataModel.setColumns(this.config.param),this.dataModel.updateModel();const i=this.config;i.margins=i.margins||{top_bottom:10,left_right:10};let r=this.dataStore.images;r&&(r=r[i.image_set]),this.grid=new class{constructor(t,e,n){"string"==typeof t&&(t=document.getElementById("#"+t)),n||(n={}),this.domId=this._getRandomString(),this.row_first=0,this.row_last=139,this.tile_height=205,this.tile_width=205;let i=this;this.__doc__=document,this.display_columns=[],this.selection_mode=!0,this.imageFunc=n.imageFunc,this.base_url=n.base_url,this.parent=t,this.selected_tiles={},this.cache_size=5;const r=this.parent.getBoundingClientRect();this.config=n,n.background_color,this.view_port=(0,T.ut)("div",{styles:{height:r.height+"px",width:r.width+"px",overflow:"auto"}},this.parent),this.canvas=(0,T.ut)("div",{styles:{position:"relative"}},this.view_port),this.canvas.addEventListener("click",(t=>{this.imageClicked(t,t.srcElement)})),this.canvas.addEventListener("mouseover",(t=>{this.mouseOver(t,t.srcElement)})),this.canvas.addEventListener("keydown",(t=>{this.keyPressed(t)})),this.data_view=e,this._setCanvasHeight(),this.view_port.addEventListener("scroll",(t=>this._hasScrolled(t))),this.parent.append(this.view_port),this.resize_timeout=null,this.resize_timeout_length=50,this.listeners={image_clicked:new Map,image_over:new Map,image_out:new Map,data_changed:new Map,image_selected:new Map},this.highlightcolors=null,this.tag_color_palletes={},this.image_suffix=n.image_suffix?n.image_suffix:".png",n.columns&&this.setColumns(n.columns);let o=new Image;o.onload=function(t){i.originalDimensions=[o.width,o.height],i.preferred_width=i.img_width=o.width,i.preferred_height=i.img_height=o.height,n.initial_image_width&&(i.preferred_width=n.initial_image_width,i.preferred_height=Math.round(i.preferred_width/i.img_width*i.img_height)),i._resize()};const s=this.config.base_url,a=this.config.image_type,l=this.data_view.getItemField(1,this.config.image_key);o.src=`${s}${l}.${a}`}mouseOver(t,e){if(e.id){let n=e.id.split("-"),i=parseInt(n[1]),r=this.data_view.getItem(i);if(!r)return;if(this.image_over){if(r.id===this.image_over.id)return;this.listeners.image_out.forEach((e=>{e(t,this.image_over[0],self.image_over[1])}))}this.listeners.image_over.forEach((n=>{n(t,r,e)})),this.image_over=e}else this.image_over&&this.listeners.image_out.forEach((e=>{e(t,self.image_over[0],self.image_over[1])})),this.image_over=null}imageClicked(t,e){let n=e.id;if(n||(n=e.parentElement.id),!n)return;let i=n.split("-");if("mlvtile"===i[0]){let n=null,r=parseInt(i[2]);if(t.shiftKey&&null!=self.last_img_clicked){const t=this.last_img_clicked.index;range=[],n=[];let e=t+1,i=r+1;-1==(r-t<0?-1:1)&&(e=r,i=t);for(let t=e;t<i;t++){let e=this.data_view.getId(t);n.push(e)}n.push(this.data_view.getId(t))}const o=this.data_view.getId(r);this.listeners.image_clicked.forEach((n=>{n(t,o,e)})),this.last_index_clicked=r,this.selection_mode&&this.setSelectedTiles([r],t.ctrlKey,!0)}}keyPressed(t){if(39===t.which||40===t.which){if(this.last_index_clicked===this.data_view.getFilteredItems().length-1)return;(this.last_index_clicked||0===this.last_index_clicked)&&(this.last_index_clicked++,this.setSelectedTiles([this.data_view.getItem(this.last_index_clicked).id],!1,!0),this.last_index_clicked>this.getLastTileInView()&&this.show(this.last_index_clicked))}else if(37===t.which||38===t.which){if(0===this.last_index_clicked)return;this.last_index_clicked&&(this.last_index_clicked--,this.setSelectedTiles([this.data_view.getItem(this.last_index_clicked).id],!1,!0),this.last_index_clicked<this.getFirstTileInView()&&this.show(this.last_index_clicked))}}addListener(t,e,n){let i=this.listeners[t];return i?(n||(n=this._getRandomString()),i.set(n,e),n):null}removeListener(t,e){let n=this.listeners[t];return!!n&&n.delete(e)}setImageWidth(t,e){this.setImageDimensions([t,Math.round(t/this.img_width*this.img_height)],e)}setImageLabel(t){this.config.image_label=t;const e=this.getFirstTileInView();this.setImageDimensions(),this.show(e)}setImageTitle(t){this.config.image_title=t;const e=this.getFirstTileInView();this.show(e)}setImageDimensions(t,e){this.lrm=this.config.margins.left_right,this.tbm=this.config.margins.top_bottom;let n=this.getFirstTileInView();t?(this.preferred_width=t[0],this.preferred_height=t[1]):t=[this.preferred_width,this.preferred_height],this.width<this.preferred_width+2*this.lrm&&0!==this.width?(t[0]=this.width-3*this.lrm,this.num_per_row=1):(this.num_per_row=Math.ceil((this.width-this.lrm)/(this.preferred_width+this.lrm)),t[0]=Math.floor((this.width-2*this.lrm)/this.num_per_row)-this.lrm),t[1]=Math.round(t[0]/this.preferred_width*this.preferred_height),this.config.image_label&&(this.label_size=Math.round(t[1]/12),this.label_size=Math.max(this.label_size,12),this.tbm=this.tbm<this.label_size+4?this.label_size+4:this.tbm),this.tile_width=parseInt(t[0])+this.lrm,this.tile_height=parseInt(t[1])+this.tbm,this.t_width=parseInt(t[0]),this.t_height=parseInt(t[1]);let i=Math.floor((this.height+this.cache_size*this.tile_height)/this.tile_height);this.max_difference=i+this.cache_size,e&&this.show(n)}setPixelated(t){this.view_port.style.imageRendering=t?"pixelated":"auto"}resize(){let t=this;clearTimeout(this.resize_timeout),t.resize_timeout=setTimeout((()=>{t._resize()}),t.resize_timeout_length)}getFirstTileInView(){let t=this.view_port.scrollTop;return Math.floor(t/this.tile_height)*this.num_per_row}getLastTileInView(){let t=this.view_port.scrollTop+this.view_port.height();return Math.floor(t/this.tile_height)*this.num_per_row}setColumns(t){this.columns=t}setColorBy(t,e){this.color_by=t,this.color_overlay=e}_setCanvasHeight(){let t=Math.ceil(this.data_view.getLength()/this.num_per_row)*this.tile_height+this.tbm;this.canvas.style.height=t+"px"}_hasScrolled(){clearTimeout(this.scroll_timeout);let t=this.view_port.scrollTop,e=Math.floor((t-this.cache_size*this.tile_height)/this.tile_height),n=Math.floor((t+this.height+this.cache_size*this.tile_height)/this.tile_height);e<0&&(e=0);let i=10;Math.abs(e-this.row_displayed_first)>this.max_difference&&(i=50),this.scroll_timeout=setTimeout((()=>{Math.abs(e-this.row_displayed_first)>this.max_difference?this.render(e,n,!0):this.render(e,n)}),i)}_removeByClass(t){document.querySelectorAll(t).forEach((t=>t.remove()))}render(t,e,n){if(n){this.canvas.innerHTML="";for(let n=t;n<e;n++)this._addRow(n)}else{if(t===this.row_displayed_first&&0!==t)return;if(t<this.row_displayed_first){for(let e=t;e<this.row_displayed_first;e++)this._addRow(e);for(let t=e;t<this.row_displayed_last;t++)this._removeByClass(`.mlv-tile-${this.domId}-${t}`)}else{for(let t=this.row_displayed_last;t<e;t++)this._addRow(t);for(let e=this.row_displayed_first;e<t;e++)this._removeByClass(`.mlv-tile-${this.domId}-${e}`)}if(0==t)for(let t=e;t<this.row_displayed_last;t++)this._removeByClass(`.mlv-tile-${this.domId}-${t}`)}this.row_displayed_first=t,this.row_displayed_last=e}_resize(t){t||(t=this.getFirstTileInView());const e=this.parent.getBoundingClientRect();this.width=Math.round(e.width),this.height=Math.round(e.height),this.view_port.style.height=this.height+"px",this.view_port.style.width=this.width+"px",this.setImageDimensions(),this.show(t)}_calculateTopBottomRow(t){t||(t=0);let e=0;e=t||0===t?Math.floor(t/this.num_per_row)*this.tile_height:this.view_port.scrollTop;let n=this.view_port.getBoundingClientRect().height,i=Math.floor((e-this.cache_size*this.tile_height)/this.tile_height);return i<0&&(i=0),{top:i,bottom:Math.floor((e+n+this.cache_size*this.tile_height)/this.tile_height),scroll_top:e}}setSelectedTiles(t,e,n){if(!e){for(let t in this.selected_tiles){let e=this.__doc__.getElementById(`mlvtile-${this.domId}-${t}`);e&&(e.style.border=this.selected_tiles[t])}this.selected_tiles={}}for(let e of t){let t=this.__doc__.getElementById(`mlvtile-${this.domId}-${e}`);t&&(this.selected_tiles[e]=t.style.border,t.style.border="4px solid goldenrod",console.log(t.style.border))}n&&this.listeners.image_selected.forEach((e=>{e(t)}))}scrollToTile(t,e){const n=this.data_view.data.indexOf(t);let i=this._calculateTopBottomRow(n);Math.abs(i.top-this.row_displayed_first)>this.max_difference?this.render(i.top,i.bottom,!0):this.render(i.top,i.bottom),this.view_port.scrollTop=i.scroll_top,e&&this.setSelectedTiles([n])}_getRandomString(t,e){t||(t=6);let n="",i=0,r="a"==(e=e&&e.toLowerCase())?10:0,o="n"==e?10:62;for(;i++<t;){let t=Math.random()*(o-r)+r<<0;n+=String.fromCharCode(t+=t>9?t<36?55:61:48)}return n}show(t){t||(t=this.getFirstTileInView()),this._setCanvasHeight();let e=this._calculateTopBottomRow(t);this.render(e.top,e.bottom,!0),this.view_port.scrollTop=e.scroll_top}_addRow(t){const e=this.config.image_label;let n=t*this.num_per_row,i=n+this.num_per_row,r=t*this.tile_height+this.tbm,o=0;const s=this.t_width+"px",a=this.t_height+"px",l=this.config.base_url,c=this.config.image_type,u=this.config.image_title||"Gene",h=void 0!==this.data_view.dataStore.columnIndex[u];for(let d=n;d<i;d++){const n=this.data_view.getId(d);if(null==n)return;const i=this.data_view.getItemField(d,this.config.image_key),f=h?`${u} '${this.data_view.getItemField(d,u)}'`:i,p="missing"===i;let g=o*this.tile_width+this.lrm;o++;let m="";if(this.color_by){let e=this.color_by(n);m="4px solid "+e,this.color_overlay&&(0,T.ut)("div",{styles:{height:a,width:s,left:g+"px",top:r+"px",zIndex:1,pointerEvents:"none",backgroundColor:e,opacity:this.color_overlay},classes:["mlv-tile",`mlv-tile-overlay-${this.domId}`,`mlv-tile-${this.domId}-${t}`]},this.canvas)}let _=[];this.selected_tiles[n]&&(m="4px solid goldenrod"),p&&_.push("mlv-tile-missing"),(0,T.ut)("img",{src:`${l}${i}.${c}`,id:`mlvtile-${this.domId}-${d}`,styles:{border:m,height:a,width:s,left:g+"px",top:r+"px"},alt:f,title:f,classes:["mlv-tile",`mlv-tile-${this.domId}`,`mlv-tile-${this.domId}-${t}`].concat(_)},this.canvas),e&&(0,T.ut)("div",{text:this.data_view.getItemField(d,e),classes:["mdv-image-label"],styles:{width:s,fontSize:`${this.label_size}px`,top:r-this.label_size+"px",left:g+"px"}},this.canvas)}}}(this.contentDiv,this.dataModel,{base_url:r?r.base_url:i.images.base_url,image_type:r?r.type:i.images.type,image_key:i.param[0],initial_image_width:i.image_width,image_label:i.image_label,margins:i.margins}),this.grid.addListener("image_clicked",((t,e)=>{this.dataStore.dataHighlighted([e],this)}),i.id),i.sortBy&&this.sortBy(i.sortBy,i.sortOrder),i.color_by&&this.colorByColumn(i.color_by)}setSize(t,e){super.setSize(t,e),this.grid.resize()}onDataFiltered(){this.dataModel.updateModel(),this.grid.show()}getColorOptions(){return{colorby:"all",color_overlay:0}}onDataHighlighted(t){if(t.source===this)return;const e=t.indexes[0];this.grid.scrollToTile(e,!0)}setImageLabel(t){this.config.image_label=t,this.grid.setImageLabel(t)}colorByColumn(t){this.grid.setColorBy(this.getColorFunction(t,!1),this.config.color_overlay);const e=this.grid.getFirstTileInView();this.grid.show(e)}colorByDefault(){this.grid.setColorBy(null);const t=this.grid.getFirstTileInView();this.grid.show(t)}sortBy(t,e=!0){this.config.sortBy=t,this.config.sortOrder=e,this.dataModel.sort(t,e?"asc":"desc");const n=this.grid.getFirstTileInView();this.grid.show(n)}setPixelated(t){this.config.pixelated=t,this.grid.setPixelated(t)}setImageTitle(t){this.config.image_title=t,this.grid.setImageTitle(t)}getSettings(){const t=this.grid.originalDimensions,e=this.config,n=super.getSettings(),i=this.dataStore.getColumnList("all",!0);return n.concat([{type:"slider",max:Math.max(128,4*t[1]),min:10,doc:this.__doc__,label:"Image Size",current_value:e.image_width||t[0],func:t=>{e.image_width=t,this.grid.setImageWidth(t,!0)}},{label:"Pixelated?",type:"check",current_value:e.pixelated||!1,func:t=>{this.setPixelated(t)}},{label:"Label",type:"dropdown",values:[i,"name","field"],current_value:e.image_label||"__none__",func:t=>{this.setImageLabel("__none__"===t?null:t)}},{label:"Tooltip",type:"dropdown",values:[i,"name","field"],current_value:e.image_title||"__none__",func:t=>{this.setImageTitle("__none__"===t?void 0:t)}},{label:"Sort By",type:"dropdown",values:[i,"name","field"],current_value:e.sortBy||"__none__",func:t=>{this.sortBy("__none__"===t?null:t)}},{label:"Sort Ascending?",type:"check",current_value:e.sortOrder||!0,func:t=>{this.sortBy(e.sortBy,t)}}])}changeBaseDocument(t){super.changeBaseDocument(t),this.grid.__doc__=t}},name:"Image Table",required:["images"],methodsUsingColumns:["setImageLabel","sortBy","setImageTitle"],configEntriesUsingColumns:["image_label","sortBy","image_title"],init:(t,e,n)=>{const i=e.images[n.image_set];t.param=[i.key_column],t.images={image_set:n.image_set},t.sortBy="__none__"===n.sort_by?null:n.sort_by,t.image_title="__none__"===n.image_title?null:n.image_title},extra_controls:t=>{const e=[];for(let n in t.images)e.push({name:n,value:n});const n=t.getColumnList().map((t=>({name:t.name,value:t.field})));return n.unshift({name:"None",value:"__none__"}),[{type:"dropdown",name:"image_set",label:"Image Set",values:e},{type:"dropdown",name:"image_title",label:"Tooltip",values:n},{type:"dropdown",name:"sort_by",label:"Sort By",values:n}]}},I.types.cell_radial_chart={name:"Radial Connectivty Map",required:["interactions"],methodsUsingColumns:["setLinkThicknessColumn"],init:(t,e,n)=>{const i=e.interactions,r=e.interactions.cell_radial_chart;t.param=[i.pivot_column,i.interaction_columns[0],i.interaction_columns[1],i.pivot_column,r.link_thickness],Object.assign(t,r.default_parameters)},class:class extends sn{constructor(t,e,n){super(t,e,n,{});const i=this.config;if(i.label_size=i.label_size||12,this.stratify=function(){var t,e=kr,n=Er;function i(i){var r,o,s,a,l,c,u,h,d=Array.from(i),f=e,p=n,g=new Map;if(null!=t){const e=d.map(((e,n)=>function(t){let e=(t=`${t}`).length;return Ar(t,e-1)&&!Ar(t,e-2)&&(t=t.slice(0,-1)),"/"===t[0]?t:`/${t}`}(t(e,n,i)))),n=e.map(Sr),r=new Set(e).add("");for(const t of n)r.has(t)||(r.add(t),e.push(t),n.push(Sr(t)),d.push(Cr));f=(t,n)=>e[n],p=(t,e)=>n[e]}for(s=0,r=d.length;s<r;++s)o=d[s],c=d[s]=new Zi(o),null!=(u=f(o,s,i))&&(u+="")&&(h=c.id=u,g.set(h,g.has(h)?xr:c)),null!=(u=p(o,s,i))&&(u+="")&&(c.parent=u);for(s=0;s<r;++s)if(u=(c=d[s]).parent){if(!(l=g.get(u)))throw new Error("missing: "+u);if(l===xr)throw new Error("ambiguous: "+u);l.children?l.children.push(c):l.children=[c],c.parent=l}else{if(a)throw new Error("multiple roots");a=c}if(!a)throw new Error("no root");if(null!=t){for(;a.data===Cr&&1===a.children.length;)a=a.children[0],--r;for(let t=d.length-1;t>=0&&(c=d[t],c.data===Cr);--t)c.data=null}if(a.parent=wr,a.eachBefore((function(t){t.depth=t.parent.depth+1,--r})).eachBefore($i),a.parent=null,r>0)throw new Error("cycle");return a}return i.id=function(t){return arguments.length?(e=yr(t),i):e},i.parentId=function(t){return arguments.length?(n=yr(t),i):n},i.path=function(e){return arguments.length?(t=yr(e),i):t},i}().id((t=>t[0])).parentId((t=>t[1])),this.linkThicknessScale=(0,St.Z)(),i.scales={},!i.link_thickness){i.link_thickness={type:"constant",width:3};const t=this.dataStore.getColumnQuantile(i.param[4],.01);this._changeLinkThicknessScale(t,[1,10])}i.state_legend=i.state_legend||{show:!0,position:[10,20]},i.outer_cell_color=i.outer_cell_color||"state",this.extra_legends=["state_legend"],i.node_size=i.node_size||{inner:5,outer:5},i.center_cells=i.center_cells||this.dataStore.getColumnValues(i.param[1]).slice(0,2),i.states=i.states||this.dataStore.getColumnValues(i.param[0]).slice(0,2),i.label_size=i.label_size||13,this.makeHierarchy(),this.drawTree(),this.setStateLegend()}onDataFiltered(){this.makeHierarchy(),this.drawTree(),this.setStateLegend()}getConfig(){const t=super.getConfig(),e=this.state_legend;return e&&(t.state_legend.position=[e.offsetLeft,e.offsetTop]),t}setStateLegend(){const t=this.config,e=this.config.state_legend;if(this.state_legend&&this.state_legend.remove(),!e.show)return;const n=this.dataStore.columnIndex[t.param[0]];let i=n.values,r=this.dataStore.getColumnColors(t.param[0]);t.states&&(r=r.filter(((e,n)=>-1!==t.states.indexOf(i[n]))),i=i.filter((e=>-1!==t.states.indexOf(e)))),this.state_legend=(0,Zs.Ee)(r,i,{label:n.name}),this.contentDiv.append(this.state_legend),this.state_legend.style.top=e.position[1]+"px",this.state_legend.style.left=e.position[0]+"px"}_changeNodeSize(){const t=this.config;this.nodes.attr("r",(e=>1===e.depth?t.node_size.inner:3===e.depth?t.node_size.outer:void 0))}_changeLinkThicknessScale(t,e,n){const i=this.config,r=this.dataStore.getRawColumn(i.param[4]);e&&(i.link_thickness.range=e),t&&(i.link_thickness.domain=t),this.linkThicknessScale.domain(i.link_thickness.domain).range(i.link_thickness.range).clamp(!0);const o=this,s="constant"===i.link_thickness.type,a=i.link_thickness.width+"px";n&&this.links.attr("stroke-width",(t=>3===t.depth?s?a:o.linkThicknessScale(r[t.id]):a))}setLinkThicknessColumn(t){this.config.param[4]=t,this._changeLinkThicknessScale(e,null,!0);const e=this.dataStore.getColumnQuantile(t,.01);this._changeLinkThicknessScale(e,null,!0)}getSettings(){const t=super.getSettings(),e=this.config,n=this.dataStore.getColumnValues(e.param[1]),i=this.dataStore.getColumnValues(e.param[0]),r=this.dataStore.getColumnList("number");let o=this.dataStore.getColumnQuantile(e.param[4],.01);return t.concat([{type:"slider",max:20,min:5,doc:this.__doc__,current_value:e.label_size,label:"Label Size",func:t=>{e.label_size=t,this.graph_area.selectAll("text").attr("font-size",t)}},{type:"multidropdown",current_value:e.center_cells,values:[n.map((t=>[t])),0,0],label:"Central Cells",func:t=>{e.center_cells=t,this.makeHierarchy(),this.drawTree()}},{type:"multidropdown",current_value:e.states,values:[i.map((t=>[t])),0,0],label:"Cell states",func:t=>{e.states=t,this.makeHierarchy(),this.drawTree(),this.setStateLegend()}},{type:"slider",label:"Inner Node Size",max:20,min:1,doc:this.__doc__,current_value:e.node_size.inner,func:t=>{e.node_size.inner=t,this.drawTree()}},{type:"check",label:"Show Inner Links",current_value:e.central_links,func:t=>{e.central_links=t,this.drawTree()}},{type:"slider",label:"Outer Node Size",max:20,min:1,doc:this.__doc__,current_value:e.node_size.outer,func:t=>{e.node_size.outer=t,this.drawTree()}},{type:"radiobuttons",label:"Outer Node Color",current_value:e.outer_cell_color,choices:[["state","state"],["Cell color","cell_color"]],func:t=>{e.outer_cell_color=t,this.drawTree()}},{type:"radiobuttons",label:"Link Thickness Type",current_value:e.link_thickness.type,choices:[["constant","constant"],["based on column","column"]],func:t=>{e.link_thickness.type=t,this._changeLinkThicknessScale(null,null,!0)}},{type:"slider",label:"Link Thickness",max:10,min:1,doc:this.__doc__,current_value:this.config.link_thickness.width,func:t=>{e.link_thickness.width=t,this._changeLinkThicknessScale(null,null,!0)}},{label:"Link Thickness Column",type:"dropdown",values:[r,"name","field"],current_value:e.param[4],func:(t,e)=>{const n=e["Link Thickness Domain"].noUiSlider,i=this.dataStore.getColumnQuantile(t,.01);n.updateOptions({range:{max:i[1],min:i[0]}}),n.set(i),this.setLinkThicknessColumn(t)}},{type:"doubleslider",max:20,min:1,doc:this.__doc__,current_value:this.config.link_thickness.range,label:"Link Thickness Range",func:(t,e)=>{this._changeLinkThicknessScale(null,[t,e],!0)}},{type:"doubleslider",max:o[1],min:o[0],doc:this.__doc__,current_value:this.config.link_thickness.domain,label:"Link Thickness Domain",func:(t,e)=>{this._changeLinkThicknessScale([t,e],null,!0)}}])}drawTree(){const t=this._getContentDimensions(),e=this.config,n=this.dataStore.getRawColumn(this.config.param[4]),i=Math.min(t.width,t.height)/2.8;this.graph_area.attr("transform",`translate(${t.left+t.width/2},${t.top+t.height/2})`);const r=this.dataStore.getColumnColors(e.param[0]),o=this.dataStore.getColumnColors(e.param[1]),s=this.dataStore.getColumnColors(e.param[2]),a=this.dataStore.getRawColumn(e.param[0]);var l=function(){var t=Tr,e=1,n=1,i=null;function r(r){var l=function(t){for(var e,n,i,r,o,s=new Rr(t,0),a=[s];e=a.pop();)if(i=e._.children)for(e.children=new Array(o=i.length),r=o-1;r>=0;--r)a.push(n=e.children[r]=new Rr(i[r],r)),n.parent=e;return(s.parent=new Rr(null,0)).children=[s],s}(r);if(l.eachAfter(o),l.parent.m=-l.z,l.eachBefore(s),i)r.eachBefore(a);else{var c=r,u=r,h=r;r.eachBefore((function(t){t.x<c.x&&(c=t),t.x>u.x&&(u=t),t.depth>h.depth&&(h=t)}));var d=c===u?1:t(c,u)/2,f=d-c.x,p=e/(u.x+d+f),g=n/(h.depth||1);r.eachBefore((function(t){t.x=(t.x+f)*p,t.y=t.depth*g}))}return r}function o(e){var n=e.children,i=e.parent.children,r=e.i?i[e.i-1]:null;if(n){!function(t){for(var e,n=0,i=0,r=t.children,o=r.length;--o>=0;)(e=r[o]).z+=n,e.m+=n,n+=e.s+(i+=e.c)}(e);var o=(n[0].z+n[n.length-1].z)/2;r?(e.z=r.z+t(e._,r._),e.m=e.z-o):e.z=o}else r&&(e.z=r.z+t(e._,r._));e.parent.A=function(e,n,i){if(n){for(var r,o=e,s=e,a=n,l=o.parent.children[0],c=o.m,u=s.m,h=a.m,d=l.m;a=Dr(a),o=Mr(o),a&&o;)l=Mr(l),(s=Dr(s)).a=e,(r=a.z+h-o.z-c+t(a._,o._))>0&&(Pr(Lr(a,e,i),e,r),c+=r,u+=r),h+=a.m,c+=o.m,d+=l.m,u+=s.m;a&&!Dr(s)&&(s.t=a,s.m+=h-u),o&&!Mr(l)&&(l.t=o,l.m+=c-d,i=e)}return i}(e,r,e.parent.A||i[0])}function s(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function a(t){t.x*=e,t.y=t.depth*n}return r.separation=function(e){return arguments.length?(t=e,r):t},r.size=function(t){return arguments.length?(i=!1,e=+t[0],n=+t[1],r):i?null:[e,n]},r.nodeSize=function(t){return arguments.length?(i=!0,e=+t[0],n=+t[1],r):i?[e,n]:null},r}().size([360,i]).separation((function(t,e){return(t.parent==e.parent?1:2)/t.depth})),c=l(this.root);const u=this;this.graph_area.selectAll(".link").remove(),this.graph_area.selectAll(".node").remove(),this.graph_area.selectAll(".wedge").remove(),this.graph_area.selectAll(".ring").remove();const h={},d=c.descendants().slice(1),f=i/10;d.forEach((t=>{1===t.depth&&(t.y+=f)}));const p={};for(let t of d){if(3!==t.depth)continue;const e=t.data[1];p[e]?(p[e][0]=Math.min(p[e][0],t.x),p[e][1]=Math.max(p[e][1],t.x)):p[e]=[t.x,t.x,t.data[3]]}const g=[];for(let t in p){const e=p[t],n=t.split("|");g.push({startAngle:(e[0]-2)*Math.PI/180,endAngle:(e[1]+2)*Math.PI/180,cell:n[0],state:n[1],sid:e[2]})}const m=Ni().innerRadius(i*(2/3)).outerRadius(i+5);this.graph_area.selectAll(".wedge").data(g).enter().append("path").attr("class","wedge").attr("d",m).attr("opacity",.8).attr("fill",(t=>r[t.sid])).attr("stroke","gray").attr("stroke-width",1);const _=Ni().startAngle(0).endAngle(2*Math.PI),v=[{outerRadius:i+5,innerRadius:i-5,color:"blue"},{outerRadius:1*i/3+f+5,innerRadius:1*i/3+f-5,color:"green"}];this.graph_area.selectAll(".ring").data(v).enter().append("path").attr("class","ring").attr("d",_).attr("opacity",.4).attr("fill",(t=>t.color)).attr("stroke","gray").attr("stroke-width",1);const b="constant"===e.link_thickness.type;this.links=this.graph_area.selectAll(".link").data(d).enter().filter((t=>!!e.central_links||t.depth>1)).append("path").attr("class","link").attr("fill","none").attr("stroke","currentColor").attr("stroke-width",(t=>3===t.depth?b?e.link_thickness.type:u.linkThicknessScale(n[t.id]):e.link_thickness.type)).attr("d",(function(t){return h[t.depth]=t.y,t.depth>1?"M"+Ks(t.x,t.y)+"C"+Ks(t.x,(t.y+t.parent.y)/2)+" "+Ks(t.parent.x,(t.y+t.parent.y)/2)+" "+Ks(t.parent.x,t.parent.y):"M"+Ks(t.x,t.y)+"L"+Ks(t.parent.x,t.parent.y)}));const y=this.graph_area.selectAll(".node").data(d).enter().append("g").attr("class",(function(t){return"node"+(t.children?" node--internal":" node--leaf")})).attr("transform",(function(t){return"translate("+Ks(t.x,t.y)+")"})).on("click",(function(t){u.nodeClicked(t)}));this.nodes=y.filter((t=>2!==t.depth)).append("circle").style("pointer-events","visible").attr("fill",(t=>1===t.depth?o[t.data[3]]:"state"===e.outer_cell_color?r[a[t.data[0]]]:s[t.data[4]])).attr("stroke","black").attr("stroke-width",1).attr("r",(t=>1===t.depth?e.node_size.inner:3===t.depth?e.node_size.outer:void 0));const w=this.config.label_size+"px";y.append("text").attr("dy",".31em").attr("font-size",w).style("fill","currentColor").attr("font-family","Helvetica").attr("x",(t=>{const n=1==t.depth?e.node_size.inner+1:e.node_size.outer+1;return t.x<180==!t.children?n:-n})).attr("alignment-baseline",(t=>1===t.depth&&e.central_links?"hanging":"baseline")).style("text-anchor",(function(t){return t.children?t.x>180?"start":"end":t.x<180?"start":"end"})).attr("transform",(function(t){return 1!==t.depth||e.central_links?"rotate("+(t.x<180?t.x-90:t.x+90)+")":"rotate(0)"})).text((function(t){return 2==t.depth?"":t.data[2]}))}setSize(t,e){super.setSize(t,e),this.drawTree()}makeHierarchy(){const t=this.config,e=t.param,n=this.dataStore.columnIndex[e[1]],i=this.dataStore.columnIndex[e[2]],r=this.dataStore.columnIndex[e[0]];let o=t.center_cells.map((t=>[t,"root",t,n.values.indexOf(t)]));o.unshift(["root",null]);const s=new Set;for(let e of t.states)for(let n of t.center_cells){const t=`${e}|${n}`;o.push([t,n,e]),s.add(t)}const a=t.center_cells.length+1,l=a+s.size,c=new Set,u=this.dataStore.filterArray;for(let e=0;e<this.dataStore.size;e++){if(u[e]>0)continue;const a=n.values[n.data[e]],l=i.values[i.data[e]],h=`${r.values[r.data[e]]}|${a}`;let d=!1;if(t.exclude_interactions)for(let e of t.exclude_interactions)if(-1!==e.indexOf(a)&&-1!==e.indexOf(l)){d=!0;break}d||s.has(h)&&(c.add(h),o.push([e,h,l,r.data[e],i.data[e]]))}o=o.filter(((t,e)=>e<a||e>=l||c.has(t[0]))),this.root=this.stratify(o)}}};I.types.row_summary_box={class:class extends I{constructor(t,e,n){if(super(t,e,n),n.image){const t=(0,T.ut)("div",{classes:["mdv-image-holder"],style:{height:parseInt(.7*this.width)+"px"}},this.contentDiv);this.imViewer=new class{constructor(t,e,n={}){this.container=t,this.img=new Image,this.img.style.position="absolute",this.img.onload=t=>{this.orig_dim=[this.img.naturalWidth,this.img.naturalHeight,this.img.naturalWidth/this.img.naturalHeight],this.container.append(this.img),this.fit()},(0,T.$q)(this.img),this.container.style.overflow="hidden",this.container.addEventListener("wheel",(t=>{t.preventDefault(),this.zoom(Math.sign(t.deltaY)>0?-1:1,t)})),this.setImage(e)}setImage(t){this.img.src=t}fit(){const t=this.container.getBoundingClientRect();this.img.height=t.height,this.img.width=this.img.height*this.orig_dim[2],this.img.width>t.width?(this.img.width=t.width,this.img.height=this.img.width/this.orig_dim[2],this.img.style.top=(t.height-this.img.height)/2+"px",this.img.style.left="0px"):(this.img.style.top="0px",this.img.style.left=(t.width-this.img.width)/2+"px")}zoom(t,e){t=t>0?1.1:.9;const n=this.container.getBoundingClientRect();let i=this.img.getBoundingClientRect();const r=(e.clientX-n.left-this.img.offsetLeft)*(t-1),o=(e.clientY-n.top-this.img.offsetTop)*(t-1);this.img.width=i.width*t,this.img.height=i.height*t,this.img.style.left=this.img.offsetLeft-r+"px",this.img.style.top=this.img.offsetTop-o+"px"}}(t,this._getImage(0))}this.paramHolders={};const i=(0,T.ut)("div",{},this.contentDiv);for(let t of this.config.param){if(t===this.img_param)continue;const e=this.dataStore.columnIndex[t],n=(0,T.ut)("div",{classes:["mdv-section"]},i);n.__mcol__=e.field,(0,T.ut)("div",{text:e.name,classes:["mdv-section-header"]},n);let r=(0,T.ut)("div",{classes:["mdv-section-value"]},n);e.is_url&&(r=(0,T.ut)("a",{target:"_blank"},r)),this.paramHolders[e.field]=r}(0,T.Ng)(i,{handle:"mdv-section-header",sortEnded:t=>{const e=this.config;let n=[];e.image&&(n=[e.param[e.image.param]],e.image.param=0),e.param=n.concat(t.map((t=>t.__mcol__)))}}),this.setParam(0),this.contentDiv.style.overflowY="auto"}setParam(t){for(let e in this.paramHolders){const n=this.dataStore.getRowText(t,e);this.paramHolders[e].textContent=n,"A"===this.paramHolders[e].nodeName&&(this.paramHolders[e].href=n)}}_getImage(t){const e=this.config,n=e.param[e.image.param];this.img_param=n;const i=this.dataStore.getRowText(t,n);return`${e.image.base_url}${i}.${e.image.type}`}setSize(t,e){super.setSize(t,e),this.imViewer&&(this.imViewer.container.style.height=Math.round(.7*this.width)+"px",this.imViewer.fit())}onDataHighlighted(t){const e=t.indexes[0];this.imViewer&&this.imViewer.setImage(this._getImage(e)),this.setParam(e)}onDataFiltered(){}changeBaseDocument(t){super.changeBaseDocument(t),this.imViewer.img.__doc__=t}getSettings(){return super.getSettings()}},name:"Row Summary Box",init:(t,e,n)=>{const i=n.image_set;if(i&&"__none__"!==i){const n=e.large_images[i];t.param=t.param||[],t.param.push(n.key_column),t.image={base_url:n.base_url,type:n.type,param:t.param.length-1}}},extra_controls:t=>{const e=t.large_images;if(e){let t=[];for(let n in e)t.push({name:n,value:n});return t=[{name:"none",value:"__none__"}].concat(t),[{type:"dropdown",name:"image_set",label:"Image Set",values:t}]}return[]},params:[{type:"_multi_column:all",name:"Values To Display"}]};var Xs=__webpack_require__(5923);class Ys{textures;texturesByIndex;texture;gl;logEl;dataView;onProgress;constructor(t,e,n,i){this.textures=new Map,this.texturesByIndex=new Map,this.dataView=n;const r=e.getContext("webgl2");this.gl=r,this.texture=r.createTexture(),this.logEl=(0,T.ut)("div",{},e.parentElement),this.logEl.style.color="white",this.loadImageColumn(t,r,i)}getImageAspect(t){return this.texturesByIndex.get(t).aspectRatio}getImageIndex(t){return this.texturesByIndex.get(t).zIndex}drawProgress(t=0){this.logEl.textContent=`Loading images: ${Math.round(100*t)}%`,this.onProgress&&this.onProgress(t)}loadImageColumn(t,e,n){const{base_url:i,image_type:r,image_key:o,width:s,height:a}=n,l=t.columnIndex[o],c=this.texture;e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D_ARRAY,c);const u=Math.floor(Math.log2(s));e.texParameteri(e.TEXTURE_2D_ARRAY,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_LINEAR),e.texParameteri(e.TEXTURE_2D_ARRAY,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D_ARRAY,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D_ARRAY,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE);const h="unique"===l.datatype,d=h?l.data.length/l.stringLength:l.values?.length||l.data.length;e.texStorage3D(e.TEXTURE_2D_ARRAY,u,e.RGBA8,s,a,d);const f=s*a*4*d/1024/1024;console.log(`Allocated ${f.toFixed(2)}MB for image array (not accounting for mipmaps)`);let p=0;(function(){if(!h)return void 0===l.values?l.data:[...l.data].map((t=>l.values[t]));const t=new TextDecoder,e=new Array(d);for(let n=0;n<d;n++){const i=n*l.stringLength,r=i+l.stringLength;e[n]=t.decode(l.data.slice(i,r))}return e})().forEach(((t,o)=>{const l=t;if(this.textures.has(l))return this.texturesByIndex.set(o,this.textures.get(l)),void p++;const u=`${i}/${l}.${r}`,h=o,f=new Image,g={zIndex:h,aspectRatio:1,url:u};this.textures.set(l,g),this.texturesByIndex.set(o,g),f.src=u,f.crossOrigin="anonymous",f.onload=()=>{if(n.cancel)return;e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D_ARRAY,c),g.aspectRatio=f.width/f.height;const t=function(t,e,n,i){const r=document.createElement("canvas");return r.width=e,r.height=n,r.getContext("2d").drawImage(t,0,0,e,n),r}(f,s,a);e.texSubImage3D(e.TEXTURE_2D_ARRAY,0,0,0,h,s,a,1,e.RGBA,e.UNSIGNED_BYTE,t);const i=e.getError();i!==e.NO_ERROR&&console.error(`glError ${i} loading image #${h} '${u}'`),e.generateMipmap(e.TEXTURE_2D_ARRAY),this.drawProgress(p++/d)},f.onerror=()=>{console.error(`Error loading image #${h} '${u}'`)}}))}}var Qs=__webpack_require__(3693),Js=__webpack_require__(8569);class ta extends Js.Z{constructor(t){super(t)}getShaders(){const t=super.getShaders();return t.vs="#version 300 es\n"+t.vs,t.fs="#version 300 es\n"+t.fs,t}}class ea extends Qs.Z{static get componentName(){return"ImageArrayExtension"}getShaders(){return{inject:{"vs:#decl":"\n        //---- ImageArrayExtension\n        in float imageIndex;\n        in float imageAspect;\n        out float vImageIndex;\n        out float vImageAspect;\n        ////\n        ","vs:#main-start":"\n        //---- ImageArrayExtension\n        vImageIndex = imageIndex;\n        vImageAspect = imageAspect;\n        ////\n        \n        ","vs:#main-end":"\n        //---- ImageArrayExtension\n        outerRadiusPixels = 1e-3;//HACKACK to make everything 'inCircle' for now\n        // - but it breaks opacity, and generally we can do better...\n        // it would be good to have border lines back, too\n        ////\n        \n        ","fs:#decl":"\n        //---- ImageArrayExtension\n        uniform mediump sampler2DArray imageArray;\n        in float vImageIndex;\n        in float vImageAspect;\n        uniform float opacity;\n        uniform float saturation;\n\n        vec3 rgb2hsv(vec3 c){\n            vec4 K = vec4(0., -1./3., 2./3., -1.);\n            vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));\n            vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));\n            float d = q.x - min(q.w, q.y);\n            float e = 1.0e-10;\n            return vec3(abs(q.z + (q.w - q.y) / (6. * d + e)), d / (q.x + e), q.x);\n        }\n        vec3 hsv2rgb(vec3 c){\n            vec4 K = vec4(1., 2./3., 1./3., 3.);\n            vec3 p = abs(fract(c.xxx + K.xyz) * 6. - K.www);\n            return c.z * mix(K.xxx, clamp(p - K.xxx, 0., 1.), c.y);\n        }\n        \n        ","fs:DECKGL_FILTER_COLOR":"\n        //---- ImageArrayExtension\n        vec2 uv = 0.5 * (geometry.uv + 1.0);\n        uv.y = 1. - uv.y; // flip y\n        // todo fix aspect ratio in vertex shader\n        uv.x /= min(1., vImageAspect);\n        uv.y *= max(1., vImageAspect);\n        if (uv.y > 1. || uv.x > 1.) discard;\n        vec3 uvw = vec3(uv, vImageIndex);\n        vec4 t = texture(imageArray, uvw);\n        vec3 c = rgb2hsv(t.rgb);\n        c.y *= saturation;\n        t.rgb = hsv2rgb(c);\n        color *= t;\n        ///--- opacity may well not be correct gamma etc\n        color.a = t.a * opacity; //HACK so broken inCircle doesn't break opacity\n        // color.r = vImageAspect - 0.5;\n        // vec3 s = vec3(textureSize(imageArray, 0));\n        // uvw.z /= s.z;\n        // color.rgb = uvw;\n        // color.r = vImageIndex / s.z;\n        ////\n\n        "}}}initializeState(t,e){this.getAttributeManager()?.addInstanced({imageIndex:{size:1,accessor:"getImageIndex",defaultValue:0},imageAspect:{size:1,accessor:"getImageAspect",defaultValue:1}})}updateState(t){const{texture:e}=t.props.imageArray,{saturation:n}=t.props;for(const t of this.getModels()){const i=t.gl;i.activeTexture(i.TEXTURE10),i.bindTexture(i.TEXTURE_2D_ARRAY,e),t.setUniforms({imageArray:10,saturation:n})}}}var na=__webpack_require__(6786);let ia=0;function ra(t){return t.denominators?`${t.category} per ${t.denom_unit}`:`% abundance ${t.category}`}I.types.ImageScatterChart={class:class extends I{canvas;imageArray;deck;dataModel;progress=0;billboard=!0;size=13;opacity=255;saturation=1;spaceX=600;spaceY=392;colorBy;id;constructor(t,e,n){super(t,e,n),this.id=ia++;const i=this.canvas=(0,T.ut)("canvas",{},this.contentDiv),{base_url:r,image_key:o,texture_size:s}=n.images;this.dataModel=new Gn(t,{autoUpdate:!1}),this.dataModel.setColumns([...n.param,o,n.image_title]),this.dataModel.updateModel(),this.imageArray=new Ys(t,i,this.dataModel,{base_url:r,image_type:n.images.type,image_key:o,width:s,height:s}),this.imageArray.onProgress=t=>{this.progress=t,this.updateDeck()};const a=this.updateDeck(),l=new na.Z({});this.deck=new Xs.Z({canvas:i,layers:a,views:[l],controller:!0,initialViewState:{target:[0,0,0],zoom:0},getTooltip:t=>{try{const{index:e,picked:n}=t,{param:i}=this.config,{columnIndex:r}=this.dataStore,o=r[i[0]],s=r[i[1]],a=this.config.image_title,l=this.dataModel.getItemField(e,a);return n&&{html:`\n                    <div>${a}: '${l}'</div>\n                    <div>x: '${i[0]}' = '${o.data[e]}'</div>\n                    <div>y: '${i[1]}' = '${s.data[e]}'</div>\n                    `}}catch(t){return console.error(t),`error: ${t}`}}})}updateDeck(){const{param:t}=this.config,{columnIndex:e}=this.dataStore,n=e[t[0]],i=e[t[1]];function r(t,e,n){const{minMax:i}=t;return n*(t.data[e]-i[0])/(i[1]-i[0])-n/2}const{data:o}=this.dataModel,{imageArray:s,billboard:a}=this,l=new ta({id:`scatter-${this.id}`,data:o,billboard:a,pickable:!0,getImageIndex:t=>s.getImageIndex(t),getImageAspect:t=>s.getImageAspect(t),getPosition:(t,{target:e})=>(e[0]=r(n,t,this.spaceX),e[1]=r(i,t,this.spaceY),e[2]=0,e),getRadius:1,radiusScale:this.size,opacity:this.opacity/255,saturation:this.saturation,getFillColor:this.colorBy?t=>this.colorBy(t):[255,255,255],imageArray:s,updateTriggers:{getImageAspect:this.progress,getPosition:[this.spaceX,this.spaceY],getFillColor:[this.colorBy,this.opacity]},extensions:[new ea]});return this.deck&&this.deck.setProps({layers:[l]}),[l]}onDataFiltered(t){this.dataModel.updateModel(),this.updateDeck()}colorByColumn(t){this.colorBy=this.getColorFunction(t,!0),this.updateDeck()}colorByDefault(){this.colorBy=null,this.updateDeck()}getColorOptions(){return{colorby:"all"}}getSettings(){return[...super.getSettings(),{name:"billboard",label:"Billboard",type:"check",current_value:this.billboard,func:t=>{this.billboard=t,this.updateDeck()}},{type:"slider",name:"size",label:"Size",current_value:this.size,min:1,max:20,step:1,continuous:!0,func:t=>{this.size=t,this.updateDeck()}},{type:"slider",name:"opacity",label:"Opacity",current_value:this.opacity,min:0,max:255,step:1,continuous:!0,func:t=>{this.opacity=t,this.updateDeck()}},{type:"slider",name:"spaceX",label:"spaceX",current_value:this.spaceX,min:1,max:800,step:1,continuous:!0,func:t=>{this.spaceX=t,this.updateDeck()}},{type:"slider",name:"spaceY",label:"spaceY",current_value:this.spaceY,min:1,max:800,step:1,continuous:!0,func:t=>{this.spaceY=t,this.updateDeck()}},{type:"slider",name:"saturation",label:"saturation",current_value:this.spaceY,min:0,max:1,continuous:!0,func:t=>{this.saturation=t,this.updateDeck()}}]}},name:"Image Scatter Plot",required:["images"],methodsUsingColumns:["updateDeck"],configEntriesUsingColumns:["image_key","image_title"],init:(t,e,n)=>{const i=e.images[n.image_set];console.log("ImageScatterChart param",t.param),t.images={base_url:i.base_url,type:i.type,image_key:i.key_column,texture_size:n.texture_size},t.image_key=i.key_column},extra_controls:t=>{const e=[];for(let n in t.images)e.push({name:n,value:n});console.log("imageSets",e);return[{type:"dropdown",name:"image_set",label:"Image Set",values:e},{type:"dropdown",name:"image_title",label:"Tooltip",values:t.getLoadedColumns().map((t=>({name:t,value:t})))},{type:"dropdown",name:"texture_size",label:"Texture Size",values:[32,64,128,256,512,1024].map((t=>({name:t,value:t}))),defaultVal:256}]},params:[{type:"number",name:"X axis"},{type:"number",name:"Y axis"}]};class oa extends sn{constructor(t,e,n){n.category||(n.category=t.getColumnValues(n.param[2])[0]),n.axis||(n.axis={y:{label:ra(n)},x:{size:60,rotate_labels:!0}}),n.title=n.title||n.category,super(t,e,n,{x:{type:"band"},y:{}});const i=this.config.param,r=this.dataStore.getColumnValues(i[0]);this.x_scale.domain(r.slice(0)),this.addToolTip(),this.dim=this.dataStore.getDimension("category_dimension"),this.addDenominators(),this.onDataFiltered()}onDataFiltered(){const t=this.config.param;let e=null;3===t.length&&(e=this.dataStore.getColumnValues(this.config.param[2]).indexOf(this.config.category)),this.dim.getSankeyData((t=>{this.data=t,this.drawChart()}),t,{method:"proportion",category:e,denominators:this.denom})}remove(t=!0){this.dim.destroy(t),super.remove()}setSize(t,e){super.setSize(t,e),this.drawChart()}addDenominators(){const t=this.config.denominators;if(this.denom=null,t){this.denom=[];const e=this.dataStore.getColumnValues(this.config.param[1]);for(let n=0;n<e.length;n++)this.denom.push(t[e[n]]||100)}}getSettings(){const t=this.config,e=[{values:[this.dataStore.getColumnValues(t.param[2]).map((t=>({t}))),"t","t"],current_value:t.category,label:"Category",type:"dropdown",func:e=>{t.category=e,t.axis.y.label=ra(t),this.setTitle(e),this.onDataFiltered()}}];return super.getSettings().concat(e)}drawChart(){const t=(0,ft.Z)(this.contentDiv).transition().duration(200).ease(pt),e=this.config.param;this.y_scale.domain([this.data.max+this.data.max/10,0]),this.updateAxis();const n=this.dataStore.getColumnColors(e[0]),i=this.dataStore.getColumnValues(e[0]),r=this.dataStore.getColumnValues(e[1]),o=this._getContentDimensions().width/i.length,s=this,a=o/5,l=o/10,c=o/4,u=o/5;this.graph_area.selectAll(".cbp-col").data(this.data).join("g").attr("transform",((t,e)=>`translate(${e*o},0)`)).attr("class","cbp-col").selectAll(".cbp-circle").data((t=>t)).join("circle").attr("class","cbp-circle").on("mouseover pointermove",((t,e)=>{const n=`${i[e[1]]}<br>${r[e[2]]}`;s.showToolTip(t,n)})).on("mouseleave",(()=>{s.hideToolTip()})).transition(t).attr("cy",((t,e)=>s.y_scale(t[0]))).attr("fill",((t,e)=>n[t[1]])).attr("r",5).attr("cx",(t=>a+l*t[3])),this.graph_area.selectAll(".cbp-rect").data(this.data).join("path").attr("d",((t,e)=>{const n=e*o+o/2,i=s.y_scale(t.av);let r=t.av+t.std;r=s.y_scale(r>t.max?t.max:r);let a=t.av-t.std;return a=s.y_scale(a<t.min?t.min:a),`M${n} ${r} L${n} ${a}\n                    M${n-c} ${i} L${n+c} ${i} \n                    M${n-u} ${r} L${n+u} ${r}     \n                    M${n-u} ${a} L${n+u} ${a}      `})).style("fill","none").style("stroke","currentColor").attr("stroke-width",1).attr("class","cbp-rect")}}I.types.custom_box_plot={name:"Abundance Box Plot",params:[{type:"text",name:"Sample Group"},{type:"text",name:"Sample"},{type:"text",name:"Categories"}],class:oa},I.types.density_box_plot={name:"Density Box Plot",class:oa,required:["regions"],extra_controls:t=>{const e=t.getColumnList("text").map((t=>({name:t.name,value:t.field})));return[{type:"dropdown",name:"group",label:"Group",values:e},{type:"dropdown",name:"cat",label:"Category",values:e}]},init:(t,e,n)=>{t.denominators={},t.denom_unit=e.regions.scale_unit+"2",t.param=[n.group,e.regions.region_field,n.cat];for(let n in e.regions.all_regions){const i=e.regions.all_regions[n],r=(i.roi.max_x-i.roi.min_x)*(i.roi.max_x-i.roi.min_x);t.denominators[n]=r*(e.regions.scale*e.regions.scale)}}};I.types.single_series_chart={name:"Single Interaction Chart",required:t=>t.interactions?.is_single_region,class:class extends sn{constructor(t,e,n){n.axis||(n.axis={x:{label:t.getColumnName(n.param[4])},y:{label:t.getColumnName(n.param[0])}}),super(t,e,n,{x:{type:"band"},y:{}}),n.title||this._setTitle();const i=this.config.param;this.config;let r=this.dataStore.getColumnValues(i[0]);this.x_scale.domain(r.slice(0)),this.config.scale=this.config.scale||this.dataStore.getColumnQuantile(i[4],"0.001"),this.initialSetUp(),this.drawChart(),this.addToolTip()}remove(t=!0){super.remove()}onDataHighlighted(t){const e=t.indexes[0],n=this.graph_area.selectAll("rect");n.attr("stroke","white").style("stroke-width","0px"),n.filter((t=>!(!t||t[3]!==e))).attr("stroke","black").style("stroke-width","4px"),this.highlight=e}_setTitle(){const t=this.config.categories,e=this.dataStore.getColumnName(this.config.param[4]);this.setTitle(`${e} ${t[0]} x ${t[1]}`)}initialSetUp(){const t=this.config.param,e=this.dataStore.columnIndex[t[1]].data,n=this.dataStore.columnIndex[t[2]].data,i=this.dataStore.columnIndex[t[0]].data,r=this.dataStore.columnIndex[t[3]].data,o=this.dataStore.columnIndex[t[0]].values.map((t=>({values:[],totals:0}))),s=this.dataStore.columnIndex[t[4]].data,a=this.dataStore.size,l=[],c=this.dataStore.columnIndex[t[1]].values.indexOf(this.config.categories[0]),u=this.dataStore.columnIndex[t[2]].values.indexOf(this.config.categories[1]);let h=null,d=null;for(let t=0;t<a;t++)if(e[t]===c&&n[t]===u){if(isNaN(s[t]))continue;d=null===d?s[t]:Math.max(s[t],d),h=null==h?s[t]:Math.min(s[t],h),l.push([s[t],i[t],r[t],t,Math.floor(6*Math.random())+1]);const e=o[i[t]];e.values.push(s[t]),e.totals+=s[t]}for(let t of o){t.mean=t.totals/t.values.length;let e=t.values.length-1;e=0===e?1:e,t.std=t.values.reduce(((e,n)=>e+Math.pow(n-t.mean,2)),0),t.std=Math.sqrt(t.std/e),delete t.values}this.errorBars=o;const f=(d-h)/10;this.config.scale=[h-f,d+f],this.data=l}getSettings(){const t=this.config,e=this.dataStore.getColumnQuantile(t.param[4],"0.001"),n=[{type:"doubleslider",max:e[1],min:e[0],doc:this.__doc__,current_value:t.scale,label:"Scale",func:(e,n)=>{t.scale=[e,n],this.drawChart()}},{label:this.dataStore.getColumnName(t.param[1]),type:"dropdown",values:[this.dataStore.getColumnValues(t.param[1],"name_value"),"name","value"],current_value:t.categories[0],func:e=>{t.categories[0]=e,this.initialSetUp(),this.drawChart()}},{label:this.dataStore.getColumnName(t.param[2]),type:"dropdown",values:[this.dataStore.getColumnValues(t.param[2],"name_value"),"name","value"],current_value:t.categories[1],func:e=>{t.categories[1]=e,this.initialSetUp(),this.drawChart()}}];return super.getSettings().concat(n)}drawChart(t=300){const e=this.config.param;this.y_scale.domain([this.config.scale[1],this.config.scale[0]]).clamp(!0),this.updateAxis();const n=(0,ft.Z)(this.contentDiv).transition().duration(t).ease(pt),i=this.dataStore.getColumnValues(e[0]),r=this.dataStore.getColumnValues(e[3]),o=this._getContentDimensions().width/i.length,s=this,a=this.dataStore.getColumnColors(e[0]),l=o/4,c=o/5;this.graph_area.selectAll("circle").data(this.data).join("circle").on("mouseover mousemove",((t,e)=>{const n=i[e[1]],o=r[e[2]];s.showToolTip(t,`${n}<br>${o}<br>${e[0]}`)})).on("mouseleave",(()=>{s.hideToolTip()})).on("click",((t,e)=>{s.dataStore.dataHighlighted([e[3]],s)})).transition(n).attr("cx",(t=>o/8+o*(t[4]/8)+t[1]*o)).attr("cy",(t=>s.y_scale(t[0]))).attr("r",5).attr("fill",(t=>a[t[1]])),this.graph_area.selectAll(".cbp-rect").data(this.errorBars).join("path").attr("d",((t,e)=>{const n=e*o+o/2,i=s.y_scale(t.mean);let r=s.y_scale(t.mean+t.std),a=s.y_scale(t.mean-t.std);return`M${n} ${r} L${n} ${a}\n                        M${n-l} ${i} L${n+l} ${i} \n                        M${n-c} ${r} L${n+c} ${r}     \n                        M${n-c} ${a} L${n+c} ${a}`})).style("fill","none").style("stroke","black").attr("stroke-width",1).attr("class","cbp-rect")}setSize(t,e){super.setSize(t,e),this.drawChart()}},extra_controls:t=>{const e=t.interactions,n=e.interaction_columns[0],i=e.interaction_columns[1],r=new Set([n,i,e.pivot_column]),o=t.getColumnList("text").filter((t=>!r.has(t.field)));return[{type:"dropdown",name:"c1",label:t.getColumnName(n),values:t.getColumnValues(n).map((t=>({name:t,value:t})))},{type:"dropdown",name:"c2",label:t.getColumnName(i),values:t.getColumnValues(i).map((t=>({name:t,value:t})))},{type:"dropdown",name:"data",label:"Data to display",values:t.getColumnList("number").map((t=>({name:t.name,value:t.field})))},{type:"dropdown",name:"group",label:"Grouping",values:o.map((t=>({name:t.name,value:t.field})))}]},init:(t,e,n)=>{const i=e.interactions;e.interactions.cell_radial_chart,t.param=[n.group,i.interaction_columns[0],i.interaction_columns[1],i.pivot_column,n.data],t.categories=[n.c1,n.c2]}};I.types.genome_browser={class:class extends I{constructor(t,e,n){super(t,e,n);const i=this.config;i.view_margins=i.view_margins||{type:"percentage",value:20},this.contentDiv.style.width="100%",this.contentDiv.style.height="100%",i.type="genome_browser";const r=!i.tracks.find((t=>"ruler"===t.format));__webpack_require__.e(791).then(__webpack_require__.bind(__webpack_require__,1791)).then((({default:t})=>{if(this.browser=new t(this.contentDiv,{allow_user_interactions:!0,show_scale:!0,ruler_track:r},i.tracks),this.bamscatrack=this.browser.getTrack("_atac_bam_track"),this.baseTrack=this.browser.getTrack("_base_track"),this.baseTrack.dataStore=this.dataStore,this.addMenuIcon("fa fa-eye-slash",n.legend||"Shoow/Hide Tracks",{func:t=>this.showHideDialog()}),this.locText=(0,T.ut)("input",{styles:{fontSize:"11px"}},this.menuSpace),this.locText.addEventListener("keypress",(t=>{if(13==t.keyCode){const t=this._calculatePosition(this.locText.value);this.browser.update(t.chr,t.start,t.end)}})),this.browser.addListener(this.config.id,((t,e)=>this.onBrowserAction(t,e))),i.feature_label&&this.setLabelFunction(i.feature_label),i.color_by&&this.colorByColumn(i.color_by,!1),i.color_wig_tracks_by){const t=i.color_wig_tracks_by,e=this.dataStore.getValueToColor(t);for(let n in e){const i=this.browser.tracks[`${t}|${n}`];i&&(i.config.color=e[n])}}if(!this.bamscatrack){const t=this.config.genome_location;t?this.browser.update(t.chr,Math.round(t.start),Math.round(t.end),!0):this.onDataHighlighted({indexes:[0]})}}))}onBrowserAction(t,e){switch(t){case"featureclick":if("_base_track"===e.track.config.track_id){const t=e.feature.data[0];this.dataStore.dataHighlighted([parseInt(t)],this)}"_bam"===e.track.config.track_id&&console.log(e.feature);break;case"range_selected":if(this.bamscatrack){const t=this.bamscatrack.getIdsInRange(e);this.cellDim.filter("filterOnIndex",[],t),this.browser.setHighlightedRegion(e,"_filter","blue"),this.resetButton.style.display="inline",this.browser.update()}break;case"view_changed":this.locText.value=`${e.chr}:${e.start}-${e.end}`}}setupLinks(t,e,n){if(this.browser||setTimeout((()=>this.setupLinks(t,e,n)),100),this.dataLink={dataStore:t,index:e,getDataFunction:n},!this.bamscatrack)return;const i=this.config.cluster_reads;t.addListener("gb_"+this.config.id,((t,e)=>{if("filtered"===t)this.filterReads(e);else if("data_changed"===t){const t=this.config.cluster_reads;-1!==e.columns.indexOf(t)&&this.changeClusters(t,!0)}})),n([i],(()=>{const n=t.getColumnIndex(e),r=t.getColumnColors(i),o=t.columnIndex[i];this.bamscatrack.setCategories(i,o.data,o.values,r),this.cellDim=t.getDimension("base_dimension"),this.bamscatrack.addIndex(n),this.config.color_by&&this.colorByColumn(this.config.color_by);const s=this.config.genome_location;s?this.browser.update(s.chr,s.start,s.end,!0):this.onDataHighlighted({indexes:[0]})}))}changeClusters(t,e=!1){this.config.cluster_reads=t;const n=this.dataLink.dataStore;this.dataLink.getDataFunction([t],(()=>{const i=n.getColumnColors(t),r=n.columnIndex[t];this.bamscatrack.setCategories(t,r.data,r.values,i,!0,e),this.browser.update()}))}themeChanged(){this.browser.repaint(!0,!0)}showHideDialog(){const t=this.browser,e=t.track_order.map((e=>{const n=t.tracks[e].config;return{type:"checkbox",id:n.track_id,label:n.short_label,current_value:!n.hide}}));new U({title:"Show/Hide Tracks",controls:e,doc:this.__doc__,buttons:[{text:"Update",method:e=>{for(let n in e)t.tracks[n].config.hide=!e[n];t.update()}}]})}getConfig(){const t=super.getConfig(),e=this.browser;return t.tracks=this.browser.getAllTrackConfigs(),t.genome_location={chr:e.chr,start:e.start,end:e.end},t}filterReads(t){t!==this.cellDim&&("all_removed"===t?(this.bamscatrack.filterReads(null,null),this.resetButton.style.display="none",this.browser.removeHighlightedRegion("_filter")):this.bamscatrack.filterReads(this.dataLink.dataStore.filterArray,this.cellDim.filterArray),this.browser.update())}createColumnLinks(t,e,n){this.dataLink={dataStore:t,columns:e,getDataFunction:n};const i=e[0].col,r=this.dataStore.getValueToColor(i);for(let t in r){const e=this.browser.tracks[`${i}|${t}`];e&&(e.config.color=r[t])}}onDataHighlighted(t){if(t.source===this)return;const e=this.config.param,n=this.config.view_margins,i=this.dataStore.getRowAsObject(t.indexes[0],e);let r=i[e[2]]>i[e[1]]?i[e[1]]:i[e[2]],o=i[e[2]]>i[e[1]]?i[e[2]]:i[e[1]];const s=t.data;if(s&&s.phase_data)for(let t of this.browser.track_order){let e=s.phase_data[t];e?0==e.ratio[0]&&0==e.ratio[1]?this.browser.setTrackAttribute(t,"phase_data",null):this.browser.setTrackAttribute(t,"phase_data",{ratio:e.ratio[0]/(e.ratio[0]+e.ratio[1]),st:r,en:o}):this.browser.setTrackAttribute(t,"phase_data",null)}let a=1e3;"percentage"===n.type?(o=r===o?r+1:o,a=Math.round(o-r)*(n.value/100)):a=n.value;const l=this.config.feature_present_column;if(l){const e=this.dataStore.getRowText(t.indexes[0],l).split(", ");for(let t of e)this.browser.setTrackAttribute(t,"color","#35de26");const n=this.dataStore.getColumnValues(l).slice(0).filter((t=>-1===e.indexOf(t)));for(let t of n)this.browser.setTrackAttribute(t,"color","#939c92");const i=e.concat(n),r=[];let o=0;for(let t of this.browser.track_order)-1!==i.indexOf(t)?(r.push(i[o]),o++):r.push(t);this.browser.track_order=r}if("fixed_length"===n.type){const t=Math.round((o-r)/2)+r;a=Math.round(a/2),this.browser.update(i[e[0]],t-a,t+a)}else this.browser.update(i[e[0]],r-a,o+a)}getImage(t,e){"svg"==e?this.browser.repaint(!0,!1,t):t(this.browser.canvas)}configure_tracks(){this.dataSrore}getColorOptions(){return{colorby:"all",has_default_color:!0}}_calculatePosition(t){let e=(t=t.replace(/,/g,"")).split(":"),n=null,i=null;1===e.length?(n=this.browser.getPosition().chr,i=e[0]):(n=e[0],i=e[1]);let r=i.split("-");return{chr:n,start:parseInt(r[0]),end:parseInt(r[1])}}colorByColumn(t,e=!0){const n=this.getColorFunction(t);this.browser.setTrackColorFunction("_base_track",(t=>n(t.data[0]))),e&&this.browser.update()}setLabelFunction(t){t?(this.config.feature_label=t,this.browser.setTrackLabelFunction("_base_track",(e=>this.dataStore.getRowText(e.data[0],t)))):(this.browser.setTrackLabelFunction("_base_track",null),delete this.config.feature_label)}onDataFiltered(t){this.browser?(this.dataStore.isFiltered()?this.browser.setTrackFeatureFilter("_base_track",(t=>0===this.dataStore.filterArray[t.data[0]])):this.browser.setTrackFeatureFilter("_base_track",null),this.browser.update()):setTimeout((()=>this.onDataFiltered(t)),100)}removeFilter(){this.cellDim.removeFilter(),this.browser.removeHighlightedRegion("_filter"),this.browser.update()}changeBaseDocument(t){this.browser.closeAllDialogs(),super.changeBaseDocument(t),this.browser.__doc__=t}setSize(t,e){super.setSize(t,e),this.browser.setSize(),this.browser.update()}remove(t=!0){this.cellDim&&(this.cellDim.destroy(t),this.dataLink.dataStore.removeListener("gb_"+this.config.id)),super.remove()}getSettings(){const t=super.getSettings(),e=this.dataStore.getColumnList(),n=this.config;if(e.push({name:"None",field:"_none"}),this.bamscatrack){const e=this.dataLink.dataStore.getColumnList("text");t.push({label:"Group By",type:"dropdown",values:[e,"name","field"],current_value:n.cluster_reads,func:t=>{this.changeClusters(t)}})}return t.push({label:"Feature Label",type:"dropdown",values:[e,"name","field"],current_value:n.feature_label||"_none",func:t=>{t="_none"===t?null:t,this.setLabelFunction(t),this.browser.update()}}),t.push({label:"View margin type",type:"radiobuttons",choices:[["% of feature length","percentage"],["absolute (bp)","absolute"],["Fixed Length (bp)","fixed_length"]],current_value:n.view_margins.type,func:t=>{n.view_margins.type=t;const e=this.dataStore.getHighlightedData();e&&this.onDataHighlighted({indexes:[e]})}}),t.push({label:"View margin length",type:"text",current_value:n.view_margins.value,only_update_on_enter:!0,func:t=>{t=parseInt(t),t=isNaN(t)?"percentage"===n.view_margins.type?20:1e3:t,n.view_margins.value=t;const e=this.dataStore.getHighlightedData();e&&this.onDataHighlighted({indexes:[e]})}}),t}},name:"Genome Browser",methodsUsingColumns:["setLabelFunction"],configEntriesUsingColumns:["feature_label","color_wig_tracks_by","feature_present_column"],params:[],required:["genome_browser"],init:(t,e)=>{const n=e.genome_browser;t.param=n.location_fields.slice(0),n.feature_label&&(t.feature_label=n.feature_label),n.default_parameters&&Object.assign(t,n.default_parameters);const i={short_label:n.default_track.label,url:n.default_track.url,track_id:"_base_track",decode_function:"generic",displayMode:"EXPANDED"};if(t.tracks=[i],n.default_track_parameters&&Object.assign(i,n.default_track_parameters),n.atac_bam_track&&(t.cluster_reads=n.atac_bam_track.cluster_reads,t.tracks.push({short_label:"Coverage",height:400,track_id:"_atac_bam_track",url:n.atac_bam_track.url,type:"bam_sca_track"})),t.default_track=n.default_track.url,n.default_tracks)for(let e of n.default_tracks)t.tracks.push(JSON.parse(JSON.stringify(e)))}};const sa=["#313695","#4575B4","#74ADD1","#ABD9E9","#E0F3F8","#E0F3F8","#FFFFBF","#FEE090","#FDAE61","#F46D43","#D73027","#A50026"].reverse();async function aa(t){new URLSearchParams(window.location.search).get("socket");let e=!1;function n(t){window.vuplex&&window.vuplex.postMessage(t)}t.addListener("ipc",((t,i,o)=>{"view_loaded"===t&&(console.log("view_loaded",o,Object.keys(i.charts)),e||(function(){function t(){window.vuplex.postMessage({type:"vuplex_ready"}),window.vuplex.addEventListener("message",(t=>{let e=t.data;"string"==typeof e&&(e=JSON.parse(e)),console.log("vuplex message",JSON.stringify(e,null,2));try{const t=e;"popout"===t.type&&(console.log("chartID: ",t.chartID),r(t.chartID))}catch(t){console.error("Error parsing vuplex message",t),n({type:"error",message:`Error parsing vuplex message: ${t}`})}}))}console.log("setupVuplex..."),window.vuplex?(console.log("vuplex already exists, adding listener"),t()):(console.log("vuplex doesn't exist (yet?), waiting for vuplexready"),window.addEventListener("vuplexready",(()=>{console.log("vuplexready event received"),t()})))}(),e=!0))}));const i=t._popOutChart;function r(e){const i=t.charts[e];i?t._popOutChart(i.chart):(console.error(`Chart ${e} not found`),console.log("current chart keys: ",Object.keys(t.charts).join(", ")),n({type:"error",message:`Popout failed: chart ${e} not found... trying again...`}),setTimeout((()=>r(e)),100))}t._popOutChart=e=>{i.apply(t,[e]),n({type:"popout",chartID:e.config.id})};for(const e of t.dataSources){const t=new Gn(e.dataStore);t.addListener("IPC",(()=>{n({type:"filter",dataSource:e.name,indices:t.data})}))}}I.types.deeptools_heatmap={class:class extends sn{constructor(t,e,n){super(t,e,n,{x:{type:"band"},y:{custom:!0}});const i=this._getContentDimensions();this.graphDiv=(0,T.ut)("div",{styles:{position:"absolute",left:i.left+"px",top:i.top+"px",width:i.width+"px",height:i.height+"px"}},this.contentDiv);const r=this.config;r.color_scale||(r.color_scale={range:[0,255],log:!1}),this.app=new ii(this.graphDiv,{lock_x_axis:!0}),this.app.addHandler("object_clicked",(t=>{const e=this.positions[t],n=Math.floor(e/this.hm_config.cols),i=this.map_index[n];this.dataStore.dataHighlighted([i],this)})),this.hm_config=this.dataStore.deeptools.maps[r.heatmap],this.x_scale.domain(this.hm_config.groups.slice(0)),this.dataStore.loadBinaryData(this.hm_config.data).then((t=>{const e=this.hm_config.rows,n=this.hm_config.cols;this.map_index=new Uint32Array(t,0,e),this.reverse_map=new Map;for(let t=0;t<this.map_index.length;t++)this.reverse_map.set(this.map_index[t],t);this.data=new Uint8Array(t,4*e,e*n);const i=this.data.length;let r=0;for(let t=0;t<this.data.length;t++)0===this.data[t]&&r++;this.colors=new Uint8Array(3*r),this.x=new Float32Array(r),this.y=new Float32Array(r),this.positions=new Float32Array(r);const o=n/this.hm_config.groups.length;let s=0;for(let t=0;t<i;t++){if(0===this.data[t])continue;const e=t%n,i=Math.floor(t/n);this.x[s]=20*e+200*Math.floor(e/o)+10,this.y[s]=20*i+10,this.positions[s]=t,s++}this.setColor();const a=this._getContentDimensions();this.app.x_scale=a.width/(20*n+200*(this.hm_config.groups.length-1)),this.app.y_scale=a.height/(20*e);const l=this.hm_config.groups.length,c=n/l*20;let u=0;const h=this.colorScale(0);for(let t=0;t<l;t++)this.app.addRectangle([u,0],c,20*e,h),u+=c+200;this.app.addSquares({x:this.x,y:this.y,colors:this.colors}),this.app.refresh()}))}setSize(t,e){super.setSize(t,e);const n=this._getContentDimensions();this.app.setSize(n.width,n.height),this.graphDiv.style.left=n.left+"px",this.graphDiv.style.top=n.top+"px",this.updateAxis()}onDataHighlighted(t){this.app.removeAllLines();const e=this.reverse_map.get(t.indexes[0]),n=this.hm_config.cols;e&&(this.app.addLine([0,20*e],[20*n+600,20*e],[255,255,0]),this.app.addLine([0,20*e+20],[20*n+600,20*e+20],[255,255,0])),t.source!==this&&e&&(this.app.offset=[0,20*-e+300],this.app.y_scale=this.app.height/600),this.app.refresh()}setColor(){const t=this.config.color_scale.range,e={datatype:"integer",asArray:!0,overideValues:{colorLogScale:this.config.color_scale.log,colors:sa,min:t[0],max:t[1],bins:200}};this.colorScale=this.dataStore.getColorFunction(null,e);const n=this.colors;for(let t=0;t<this.data.length;t++){const e=this.positions[t],i=this.colorScale(this.data[e]),r=3*t;n[r]=i[0],n[r+1]=i[1],n[r+2]=i[2]}}getSettings(){let t=super.getSettings();const e=this.config.color_scale;return t=t.concat([{type:"doubleslider",max:255,min:0,doc:this.__doc__,current_value:e.range,label:"Color Scale",func:(t,n)=>{e.range=[t,n],this.setColor(),this.app.refresh()}}]),t}},required:["deeptools"],name:"DeepTools HeatMap",extra_controls:t=>[{type:"dropdown",name:"map",label:"Map",values:Object.keys(t.deeptools.maps).map((t=>({name:t,value:t})))}],init:(t,e,n)=>{t.heatmap=n.map}};const la={double:0,integer:0,int32:0,multitext:1,text:2,unique:2},ca={Dark:{title_bar_color:"#222",main_panel_color:"black",text_color:"white",background_color:"#333"},Light:{title_bar_color:"white",main_panel_color:"#f1f1f1",text_color:"black",background_color:"#bababa"}};function ua(){return window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"Dark":"Light"}class ha extends F.v{constructor(t,e,n="all"){super({footer:!0,width:250,maxHeight:500,title:"Select Columns",buttons:[{text:"OK",method:"getColumns"}]},{dataStore:t,callback:e,filter:n})}init(t){this.ds=t.dataStore;const e=(0,T.ut)("div",{styles:{padding:"8px"}}),n=(0,M.zO)();(0,T.ut)("div",{text:"Groups"},this.dialog);const i=Object.keys(this.ds.columnGroups);i.unshift("All");for(let t of i){const i=(0,T.ut)("span",{styles:{display:"inline-block",whiteSpace:"nowrap",marginRight:"5px"}},e);(0,T.ut)("span",{text:t},i),(0,T.ut)("input",{type:"radio",value:t,name:n},i).addEventListener("click",(t=>{this.checkAllInGroup(t.target.value)}))}this.dialog.append(e),(0,T.ut)("div",{text:"Select Individual Columns"},this.dialog);const r=(0,T.ut)("div",{style:{padding:"8px"}}),o=this.ds.getColumnList(t.filter);this.checks=[],this.callback=t.callback;for(let t of o){const e=(0,T.ut)("div",{styles:{whiteSpace:"nowrap"}},r),n=(0,T.ut)("input",{type:"checkbox"},e);this.checks.push([n,t.field]),(0,T.ut)("span",{text:t.name},e)}this.dialog.append(r)}checkAllInGroup(t){if("All"===t)for(let t of this.checks)t[0].checked=!0;else{const e=this.ds.columnGroups[t].columns;for(let t of this.checks)t[0].checked=-1!==e.indexOf(t[1])}}getColumns(){const t=[];for(let e of this.checks)e[0].checked&&t.push(e[1]);this.callback(t),this.close()}}class da extends F.v{constructor(t,e){super({title:"Add Chart",columns:2,footer:!0,width:380},{dataSource:t,callback:e})}init(t){this.extraControls={};const e=[];this.dataSource=t.dataSource,this.dataStore=t.dataSource.dataStore;for(let t in I.types){const n=I.types[t];if(n.required)if("function"==typeof n.required){if(!n.required(this.dataStore))continue}else{let t=!0;for(let e of n.required)this.dataStore[e]||(t=!1);if(!t)continue}!1!==n.allow_user_add&&e.push({name:n.name,type:t})}e.sort(((t,e)=>t.name.localeCompare(e.name))),this.defaultType=e[0].type,(0,T.ut)("div",{text:"Chart Type",classes:["ciview-title-div"]},this.columns[0]),this.chartType=(0,T.ut)("select",{styles:{maxWidth:"200px"}},this.columns[0]);for(let t of e)(0,T.ut)("option",{text:t.name,value:t.type},this.chartType);this.chartType.addEventListener("change",(e=>{this.setParamDiv(this.chartType.value,t.dataStore)})),(0,T.ut)("div",{text:"Title",classes:["ciview-title-div"]},this.columns[0]),this.chartName=(0,T.ut)("input",{},this.columns[0]),(0,T.ut)("div",{text:"Description",classes:["ciview-title-div"]},this.columns[0]),this.chartDescription=(0,T.ut)("textarea",{styles:{height:"100px"}},this.columns[0]),(0,T.ut)("div",{text:"Columns",classes:["ciview-title-div"]},this.columns[1]),this.paramDiv=(0,T.ut)("div",{},this.columns[1]),this.setParamDiv(e[0].type,t.dataStore),(0,T.ut)("button",{text:"Add",classes:["ciview-button"]},this.footer).addEventListener("click",(()=>this.submit(t.callback)))}submit(t){const e={title:this.chartName.value,legend:this.chartDescription.value,type:this.chartType.value,param:this.paramSelects.map((t=>t.value))},n={};for(let t in this.extraControls){const i=this.extraControls[t];n[t]="checkbox"===i.type?"on"===i.value:i.value,e[t]=n[t]}this.multiColumns&&(e.param=e.param.concat(this.multiColumns)),console.log("config from add chart dialog",e);const i=I.types[this.chartType.value];i.init&&i.init(e,this.dataSource.dataStore,n),t(e),this.chartName.value="",this.chartDescription.value="",this.close()}_addMultiColumnSelect(t,e){const n=this.dataStore.getColumnList(e);let i="";n.length>1&&(i=`${n[0].name},... (1)`,this.multiColumns=[n[0].field]);const r=(0,T.ut)("span",{text:i},t);(0,T.ut)("i",{classes:["fas","fa-plus"]},t),t.style.cursor="pointer",t.addEventListener("click",(()=>{new ha(this.dataStore,(t=>{this.multiColumns=t;let e="";if(t.length>0){const n=t.length<3?t.length:3,i=[];for(let e=0;e<n;e++)i.push(this.dataStore.getColumnName(t[e]));e=i.join(","),t.length>3&&(e+=",...."),e+=`(${t.length})`,r.textContent=e}}),e)}))}setParamDiv(t){this.paramDiv.innerHTML="";const e=I.types[t].params;if(this.paramSelects=[],e)for(let t of e){const e=(0,T.ut)("div",{styles:{padding:"4px"}},this.paramDiv),n=((0,T.ut)("div",{text:t.name+":"},e),(0,T.ut)("div",{},this.paramDiv));if(!Array.isArray(t.type)&&t.type.startsWith("_multi"))this._addMultiColumnSelect(n,t.type.split(":")[1]);else{this.multiColumns=null;const e=(0,T.ut)("select",{styles:{maxWidth:"200px"}},n),i=this.dataStore.getColumnList(t.type),r={};for(let t of this.dataStore.subgroupDataSources)r[t]=(0,T.ut)("optgroup",{label:t});for(let t of i){let n=e;t.subgroup&&(n=r[t.subgroup.dataSource]),(0,T.ut)("option",{text:t.name,value:t.field},n)}for(let t of this.dataStore.subgroupDataSources)e.append(r[t]);(0,T.t1)(e,n),this.paramSelects.push(e)}}const n=I.types[this.chartType.value];if(this.extraControls={},n.extra_controls){const t=n.extra_controls(this.dataSource.dataStore),e=this.paramDiv;for(let n of t)if((0,T.ut)("div",{text:n.label,classes:["ciview-title-div"]},e),"dropdown"===n.type){const t=(0,T.ut)("select",{styles:{maxWidth:"200px"}},e);for(let e of n.values){const i=(0,T.ut)("option",{text:e.name,value:e.value},t);e.value===n.defaultVal&&(i.selected=!0)}this.extraControls[n.name]=t}else if("string"===n.type){const t=(0,T.ut)("input",{value:n.defaultVal},e);this.extraControls[n.name]=t}else if("textbox"===n.type){const t=(0,T.ut)("textarea",{value:n.defaultVal,styles:{height:"300px"}},e);this.extraControls[n.name]=t}else if("checkbox"===n.type||"check"===n.type){const t=(0,T.ut)("input",{type:"checkbox"},e);t.checked=n.defaultVal,this.extraControls[n.name]=t}}}}function fa(t,e){const n={};for(let i of t)n[i.name]=new pa(`${e}/${i.name}.gz`,i.size);return async(t,e,i)=>await n[e].getColumnData(t,i)}class pa{constructor(t,e){this.url=t,this.index=null,this.size=e}async getColumnData(t,e){const{default:n}=await __webpack_require__.e(885).then(__webpack_require__.bind(__webpack_require__,7885));if(!this.index){const t=this.url.replace(".gz",".json"),e=await fetch(t);this.index=await e.json()}return await Promise.all(t.map((async t=>{let i=t.field;if(t.subgroup){const e=t.field.split("|");i=e[0]+e[2]}const r=this.index[i];let o=null;const s={headers:{responseType:"arraybuffer",range:`bytes=${r[0]}-${r[1]}`}};try{o=await fetch(this.url,s)}catch(t){o=await fetch(this.url,s)}const a=await o.arrayBuffer(),l=r[1]-r[0]+1;a.byteLength!==l&&console.warn(`Expected ${l} bytes but got ${a.byteLength} for ${t.field}... is the server correctly configured to Accept-Ranges?`);try{const i=n.inflate(a);if("sparse"===t.sgtype){const n=i.buffer,r=new Uint32Array(n,0,1)[0],o=new Uint32Array(n,4,r),s=new Float32Array(n,4*r+4,r),a=new SharedArrayBuffer(4*e),l=new Float32Array(a);l.fill(NaN);for(let t=0;t<o.length;t++)l[o[t]]=s[t];return{data:a,field:t.field}}{const e=new SharedArrayBuffer(i.length);return new Uint8Array(e).set(i,0),{data:e,field:t.field}}}catch(e){console.warn(`Error inflating ${t.field}: ${e}`)}})))}}async function ga(t,e){return await ya("/get_row_data",{datasource:t,index:e})}async function ma(t,e){const n=await fetch(`./rowdata/${t}/${e}.json`);return 200!=n.status?null:await n.json()}async function _a(t){return await ya("/get_view",{view:t})}async function va(t,e){const n=await fetch(`./binarydata/${t}/${e}.b`);return await n.arrayBuffer()}async function ba(t,e){return await ya("/get_binary_data",{datasource:t,name:e},"arraybuffer")}async function ya(t,e,n="json"){const i=await fetch(t,{method:"POST",body:JSON.stringify(e),headers:{Accept:"application/json,text/plain,*/*","Content-Type":"application/json"}});return"json"===n?await i.json():await i.arrayBuffer()}window._mdvInit=function(t){(async function(t){let e={};if(t){let t=await fetch("./datasources.json");e.datasources=await t.json(),t=await fetch("./state.json"),e.state=await t.json(),t=await fetch("./hyperion_config.json"),200==t.status&&(e.hyperion_config=await t.json()),t=await fetch("./views.json"),e.views=await t.json()}else e=await ya("/get_configs");return e})(t).then((e=>{const n=e.state,i=new URLSearchParams(window.location.search).get("view");n.all_views&&i&&-1!==n.all_views.indexOf(i)&&(n.initial_view=i);const r={function:t?fa(e.datasources,"."):(o="/get_data",async(t,e,n)=>{const i=await fetch(o,{method:"POST",body:JSON.stringify({columns:t,data_source:e}),headers:{"Content-Type":"application/json"}});return function(t,e,n){const i=[];let r=0;for(let o of e){let e="int32"===o.datatype?Int32Array:Float32Array,s=n,a=4;if("unique"==o.datatype||"text"==o.datatype?(e=Uint8Array,a=1,"unique"==o.datatype&&(a=o.stringLength,s=n*a)):"multitext"===o.datatype&&(e=Uint16Array,a=2*o.stringLength,s=n*o.stringLength),"sparse"==o.sgtype){const e=new Uint32Array(t,r,1)[0];r+=4;const s=new Uint32Array(t,r,e);r+=4*e;const a=new Float32Array(t,r,e);r+=4*e;const l=new SharedArrayBuffer(4*n),c=new Float32Array(l);c.fill(NaN);for(let t=0;t<s.length;t++)c[s[t]]=a[t];i.push({data:l,field:o.field})}else{const l=n*a;let c=new e(t,r,s);const u=new SharedArrayBuffer(l);new e(u).set(c,0),i.push({data:u,field:o.field}),r+=l}}return i}(await i.arrayBuffer(),t,n)}),viewLoader:t?async t=>e.views[t]:_a,rowDataLoader:t?ma:ga,binaryDataLoader:t?va:ba};var o;console.log(n),new class{constructor(t,e,n,i={},r=null){var o;this.listeners={},this.infoAlerts={},this.progressBars={},this.setTheme(ua()),o=t=>this.setTheme(t),window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",(()=>o(ua()))),this.dataSources=[],this.dsIndex={},this.columnsLoading={};for(const t of e){const e={name:t.name,dataStore:new z.ZP(t.size,t,n),link_to:t.link_to,index_link_to:t.index_link_to,color:t.color||ca[this.theme].background_color,column_link_to:t.column_link_to,links:t.links,custom:t.custom||{}};this.dataSources.push(e),this.dsIndex[t.name]=e,this._addDSListeners(e),this.columnsLoading[t.name]={}}if(r&&this.addListener("_default",r),aa(this),this.transactions={},this.containerDiv="string"==typeof t?document.getElementById(t):t,this.containerDiv.style.display="flex",this.containerDiv.style.flexDirection="column",this.menuBar=(0,T.ut)("div",{classes:["ciview-main-menu-bar"]},this.containerDiv),this.leftMenuBar=(0,T.ut)("span",{},this.menuBar),this.rightMenuBar=(0,T.ut)("span",{styles:{float:"right"}},this.menuBar),(0,T.ut)("span",{classes:["mdv-divider"]},this.menuBar),i.all_views){this.viewSelect=(0,T.ut)("select",{},this.menuBar);for(let t of i.all_views)(0,T.ut)("option",{text:t,value:t},this.viewSelect);this.viewSelect.addEventListener("change",(t=>{this.config.show_save_view_dialog&&"edit"===i.permission?this.showSaveViewDialog((()=>this.changeView(this.viewSelect.value))):this.changeView(this.viewSelect.value)}))}"edit"===i.permission&&(0,T.Eo)("fas fa-save",{tooltip:{text:"Save View",position:"bottom-right"},func:()=>{const t=this.getState();this._callListeners("state_saved",t)}},this.menuBar),"edit"===i.permission&&i.all_views&&((0,T.Eo)("fas fa-plus",{tooltip:{text:"Create New View",position:"bottom-right"},func:()=>{this.showSaveViewDialog((()=>this.showAddViewDialog()))}},this.menuBar),(0,T.Eo)("fas fa-minus",{tooltip:{text:"Delete Current View",position:"bottom-right"},func:()=>{this.showDeleteViewDialog()}},this.menuBar)),(0,T.Eo)("fas fa-adjust",{tooltip:{text:"Change Theme",position:"bottom-left"},func:t=>{this.themeMenu.show(t)}},this.rightMenuBar).style.margin="3px",this._setupThemeContextMenu(),this.contentDiv=(0,T.ut)("div",{styles:{flex:"1 1 auto",position:"relative"}},this.containerDiv),this.contentDiv.classList.add("ciview-contentDiv"),this.gridStack=new dt(this),this.charts={},this.config=i;const s=this.config;if(s.chart_color=s.chart_color||"white",this.dataLoader=n.function,this.viewLoader=n.viewLoader,this.layoutMenus={},n.files){this.filesToLoad=n.files.length;for(let t of n.files)this.loadFile(t,(()=>{this.filesToLoad--,0===this.filesToLoad&&this._loadView(i,n,!0)}))}else this._loadView(i,n,!0);for(let t of this.dataSources){const e=t.dataStore.links;if(e)for(let n in e){if(!this.dsIndex[n])return void console.warn(`datasource ${t.name} has link to non-existent datasource ${n}`);e[n].interactions&&this._addInteractionLinks(t.dataStore,this.dsIndex[n].dataStore,e[n].interactions)}}}_addInteractionLinks(t,e,n){const i=e.getDimension("category_dimension"),r=n.interaction_columns,o=r[0],s=r[1],a=n.pivot_column;t.syncColumnColors.push({dataSource:e.name,columns:[{link_to:r[2],col:r[0]},{link_to:r[2],col:r[1]},{link_to:a,col:a}]}),t.addListener(`${t.name}_interaction`,((l,c)=>{"data_highlighted"===l&&this._getColumnsThen(t.name,[o,s,a],(()=>{const l=t.getRowAsObject(c.indexes[0],[o,s,a]);this._getColumnsThen(e.name,[r[2]],(()=>{if(i.filter("filterCategories",[r[2]],[l[o],l[s]]),n.is_single_region&&e.regions&&this.dsPanes[e.name]&&!this.getAllCharts(e.name).find((t=>t.config.region===l[a]))){const t={type:"image_scatter_plot"};I.types.image_scatter_plot.init(t,e,{region:l[a]}),this.addChart(e.name,t)}}))}))}))}_setUpChangeLayoutMenu(t){this.layoutMenus[t.name]=new D((()=>{const e=this.viewData.dataSources[t.name].layout||"absolute";return[{text:"Absolute",ghosted:"absolute"===e,func:()=>this.changeLayout("absolute",t)},{text:"Grid Stack",ghosted:"gridstack"===e,func:()=>this.changeLayout("gridstack",t)}]}))}changeLayout(t,e){const n=this.viewData.dataSources[e.name],i=n.layout||"absolute";t!==i&&("gridstack"===i?this.gridStack.destroy(e):"absolute"===i&&this.getAllCharts(e.name).forEach((t=>{const e=t.getDiv();(0,T.P_)(e),(0,T.EA)(e)})),n.layout=t,"absolute"===t?this.getAllCharts(e.name).forEach((t=>this._makeChartRD(t,e))):"gridstack"===t&&this.getAllCharts(e.name).forEach((t=>{this.gridStack.manageChart(t,e,this._inInit)})))}_setupThemeContextMenu(){this.themeMenu=new D((()=>{const t=[];for(let e in ca)t.push(this.__getMenuItem(e));return t}))}__getMenuItem(t){return{text:t,ghosted:this.theme===t,func:()=>this.setTheme(t)}}setTheme(t){if(this.theme=t,document.getElementsByTagName("html")[0].className=t,this.charts)for(let t in this.charts){const e=this.charts[t];e.chart.themeChanged&&e.chart.themeChanged()}}_sync_colors(t,e,n){for(let i of t){const t=e.columnIndex[i.link_to],r=n.columnIndex[i.col],o=new Array(r.values),s=e.getColumnColors(i.link_to);for(let e=0;e<t.values.length;e++){const n=t.values[e],i=r.values.indexOf(n);-1!==i&&(o[i]=s[e])}r.colors=o}}_initiateOffsets(t){const e=t.dataStore,n=e.offsets,i=n.param,r=[i[0],i[1],n.groups];n.background_filter&&r.push(n.background_filter),this._getColumnsThen(t.name,r,(()=>{e.initiateOffsets(),e.updateColumnOffsets(),e.updateColumnOffsets(null,!0,!0)}))}_loadView(t,e,n=!1){t.all_views?(this.currentView=t.initial_view||t.all_views[0],this.viewSelect.value=this.currentView,e.viewLoader(this.currentView).then((t=>{this._init(t,n)}))):this._init(t.only_view,n)}getDataSource(t){return this.dsIndex[t].dataStore}async _init(t,e=!1){if(t){if(!t.dataSources){t.dataSources={};for(let e in t.initialCharts)t.dataSources[e]={}}this.viewData=t}else{const t={};for(let e in this.dsIndex)t[e]={layout:"gridstack"};this.viewData={dataSources:t,initialCharts:{}}}for(let t of this.dataSources)delete t.contentDiv,delete t.menuBar;const n=Object.keys(this.viewData.dataSources);let i=[];for(let t of n){let e=this.viewData.dataSources[t].panelWidth;if(!e){i=null;break}i.push(e)}this.dsPanes={};const r=(0,T.Ni)(this.contentDiv,{number:n.length,sizes:i});for(let t=0;t<n.length;t++){const e=r[t];e.style.display="flex",e.style.flexDirection="column";const i=this.dsIndex[n[t]];this.dsPanes[i.name]=e,this.columnsLoading[i.name]={},i.charts=[],i.menuBar=(0,T.ut)("div",{classes:["ciview-menu-bar"]},e);const o=(0,T.ut)("div",{styles:{flex:"1 1 auto",position:"relative",overflow:"auto",height:"100px"}},e);this._setUpMenu(i),i.contentDiv=(0,T.ut)("div",{styles:{position:"relative",height:"100%"}},o),i.contentDiv.classList.add("ciview-contentDiv"),this._setUpChangeLayoutMenu(i)}if(e)for(let t of this.dataSources){const e=t.dataStore;e.offsets&&this._initiateOffsets(t),t.column_link_to&&this._sync_colors(t.column_link_to.columns,this.dsIndex[t.column_link_to.dataSource].dataStore,e);for(let t of e.syncColumnColors)this._sync_colors(t.columns,this.dsIndex[t.dataSource].dataStore,e)}const o=t&&t.initialCharts||{};this._toLoadCharts=new Set;for(let t in o)for(let e of o[t])this._toLoadCharts.add(e);0==this._toLoadCharts.size&&(delete this._toLoadCharts,this._callListeners("view_loaded",this.currentView)),this._inInit=!0;const s=[];for(let t in o)for(let e of o[t])s.push(this.addChart(t,e));await Promise.all(s),this._inInit=!1}_addDSListeners(t){t.dataStore.addListener("l1",((e,n)=>{if("column_removed"===e)this._columnRemoved(t,n);else if("data_highlighted"===e)n.dataStore=t.dataStore,this._callListeners(e,n);else if("filtered"===e){if(!this.progressBars[t.name])return;t.dataStore.size;const i=t.dataStore.filterSize;this.progressBars[t.name].setValue(i),this.progressBars[t.name].setText(i),this._callListeners(e,n)}}))}showAddViewDialog(){const t=[{type:"checkbox",id:"clone-view",label:"Clone current view"},{type:"text",id:"name",label:"name"}];if(this.dataSources.length>1)for(let e of this.dataSources)t.push({type:"checkbox",id:e.name,label:`Include ${e.name}`});new U({title:"Add New View",controls:t,buttons:[{text:"Create New View",method:t=>{if((0,T.ut)("option",{text:t.name,value:t.name},this.viewSelect),this.viewSelect.value=t.name,this.currentView=t.name,t["clone-view"]){const t=this.getState();this._callListeners("state_saved",t)}else{for(let t in this.viewData.dataSources)"gridstack"===this.viewData.dataSources[t].layout&&this.gridStack.destroy(this.dsIndex[t]);this.removeAllCharts(),this.viewData.links=[];const e=this.getState();if(e.view.initialCharts={},e.view.dataSources={},1===this.dataSources.length)e.view.initialCharts[this.dataSources[0].name]=[],e.view.dataSources[this.dataSources[0].name]={};else for(let n in this.dsIndex)t[n]&&(e.view.initialCharts[n]=[],e.view.dataSources[n]={});this._callListeners("state_saved",e),this.contentDiv.innerHTML="",this._init(e.view)}}}]})}showSaveViewDialog(t){new U({title:"Save View",text:"Do you want to save the current view",buttons:[{text:"YES",method:()=>{const e=this.getState();this._callListeners("state_saved",e),t()}},{text:"NO",method:()=>{t()}}]})}showDeleteViewDialog(){new U({title:"Delete View",text:"Do you want to delete the current view?",buttons:[{text:"YES",method:()=>{this.deleteCurrentView()}},{text:"NO",method:()=>{}}]})}changeView(t){for(let t in this.viewData.dataSources)"gridstack"===this.viewData.dataSources[t].layout&&this.gridStack.destroy(this.dsIndex[t]);this.removeAllCharts(),this.contentDiv.innerHTML="",this.currentView=t,this.viewLoader(t).then((t=>{this._init(t)}))}deleteCurrentView(){this.viewSelect.querySelector(`option[value='${this.viewSelect.value}']`).remove();const t=this.getState();t.view=null,this._callListeners("state_saved",t),this.currentView=this.viewSelect.value,this.changeView(this.viewSelect.value)}_columnRemoved(t,e){const n=[];for(let i in this.charts){const r=this.charts[i];if(r.dataSource===t){const t=r.chart,o=t.getDiv();t.onColumnRemoved(e)&&(o.remove(!1),n.push(i),this._removeLinks(t),this._callListeners("chart_removed",t))}}n.length>0&&t.dataStore._callListeners("filtered");for(let t of n)delete this.charts[t]}_getColumnsRequiredForChart(t){const e=new Set,n=t.param;if(n)if("string"==typeof n)e.add(n);else for(let t of n)e.add(t);t.color_by&&(t.color_by.column?e.add(t.color_by.column.field):e.add(t.color_by)),t.tooltip&&t.tooltip.column&&e.add(t.tooltip.column),t.background_filter&&e.add(t.background_filter.column);const i=I.types[t.type];return i.configEntriesUsingColumns&&i.configEntriesUsingColumns.forEach((n=>{let i=t[n];if(i){i=Array.isArray(i)?i:[i];for(let t of i)e.add(t)}})),[...e]}loadFile(t,e){const n={csv:et,json:rt,tsv:nt},i=this.createInfoAlert("loading file",{spinner:!0});n[t.type](t.url).then((n=>{const r={},o=t.dataSource,s=this.dsIndex[o].dataStore,a=s.getAllColumns();for(let t of n.columns)s.columnIndex[t]&&(r[t]=[]);for(let t=0;t<n.length;t++){const e=n[t];t+1===0&&this.updateInfoAlert(i,`processed ${t}/${n.length} rows`);for(let t in r)r[t].push(e[t])}let l=0;for(let t in r)s.setColumnData(t,r[t]),l++,this.updateInfoAlert(i,`processed ${l}/${a.length} columns`);this.updateInfoAlert(i,"complete",{duration:2e3}),e&&e()}))}_getUpdatedColumns(t){const e=t.dirtyColumns,n={columns:[],added:[],removed:[],colors_changed:[]};for(let t in e.added){const e=i(t);n.columns.push(e),n.added.push(t)}for(let t in e.removed)n.removed.push(t);for(let t in e.data_changed)if(!n.columns[t]){const e=i(t);n.columns.push(e)}for(let i in e.colors_changed)n.colors_changed.push({column:i,colors:t.columnIndex[i].colors});return n;function i(e){const n=t.columnIndex[e],i={values:n.values,datatype:n.datatype,name:n.name,editable:!0,field:n.field},r=new Array(n.data.length);for(let t=0;t<n.data.length;t++)r[t]=n.data[t];return{metadata:i,data:r}}}getState(){const t={},e={},n={};this.contentDiv.offsetWidth;for(const i of this.dataSources){if(i.contentDiv){t[i.name]=[];let e=this.dsPanes[i.name].style.width;const n=/calc\((.+)\%.+/;this.viewData.dataSources[i.name].panelWidth=parseFloat(e.match(n)[1])}e[i.name]=this._getUpdatedColumns(i.dataStore);const r=i.dataStore;if(0!==r.dirtyMetadata.size){n[i.name]={};for(let t of r.dirtyMetadata)n[i.name][t]=r[t]}}for(let e in this.charts){const n=this.charts[e],i=n.chart,r=i.getConfig(),o=i.getDiv();"gridstack"===this.viewData.dataSources[n.dataSource.name].layout?(r.gsposition=[parseInt(o.getAttribute("gs-x")),parseInt(o.getAttribute("gs-y"))],r.gssize=[parseInt(o.getAttribute("gs-w")),parseInt(o.getAttribute("gs-h"))]):r.position=[o.offsetLeft,o.offsetTop],t[n.dataSource.name].push(r)}const i=JSON.parse(JSON.stringify(this.viewData));i.initialCharts=t;const r=this.viewSelect?Array.from(this.viewSelect.children,(t=>t.value)):null;return{view:i,currentView:this.currentView,all_views:r,updatedColumns:e,metadata:n}}setAllColumnsClean(){for(let t of this.dataSources)t.dataStore.setAllColumnsClean()}showCustomDialog(t){new U(t)}addMenuIcon(t,e,n,i){const r="_main"===t?"bottom-right":"bottom",o="_main"===t?this.leftMenuBar:this.dsIndex[t].menuBar;return(0,T.Eo)(e,{tooltip:{text:n,position:r},func:i},o)}createInfoAlert(t,e={}){let n=(0,M.zO)();const i=Object.keys(this.infoAlerts).length;e.type=e.type||"info";const r=(0,T.ut)("div",{classes:["ciview-info-alert","ciview-alert-"+e.type],styles:{right:"10px",top:50+40*i+"px"}},this.containerDiv);let o=null;const s=(0,T.ut)("span",{text:t},r);return e.spinner&&(o=(0,T.ut)("i",{classes:["fas","fa-spinner","fa-spin","ciview-info-alert-spin"]},r)),this.infoAlerts[n]={div:r,text:s,spinner:o,type:e.type},e.duration&&this.removeInfoAlert(n,e.duration),n}updateInfoAlert(t,e,n={}){const i=this.infoAlerts[t];n.type&&i.type!==n.type&&(i.div.classList.remove("ciview-alert-"+i.type),i.div.classList.add("ciview-alert-"+n.type),i.type=n.type),i.text.textContent=e,n.duration&&this.removeInfoAlert(t,n.duration)}removeInfoAlert(t,e=2e3){const n=this.infoAlerts[t].spinner;n&&n.remove(),setTimeout((()=>{if(!this.infoAlerts[t])return;this.infoAlerts[t].div.remove(),delete this.infoAlerts[t];let e=50;for(let t in this.infoAlerts)this.infoAlerts[t].div.style.top=e+"px",e+=40}),e)}clearInfoAlerts(){for(const t in this.infoAlerts)this.infoAlerts[t].div.remove();this.infoAlerts={}}loadColumnSet(t,e,n,i=10,r=2){const o=(0,M.zO)(),s=this.config.dataloading||{};i=s.split||10,r=s.threads||2,this.transactions[o]={callback:n,columns:[],totalColumns:t.length,failedColumns:[],nextColumn:0,columnsLoaded:0,id:o};let a=[];const l=this.transactions[o];for(let n of t)this.columnsLoading[e][n]=!0,a.push(n),a.length===i&&(l.columns.push(a),a=[]);0!==a.length&&(l.columns.push(a),a=[]),l.alertID=this.createInfoAlert(`Loading Columns:0/${t.length}`,{spinner:!0});const c=Math.min(l.columns.length,r);for(let t=0;t<c;t++)this._loadColumnData(l,e)}_loadColumnData(t,e){const n=this.dsIndex[e].dataStore,i=t.columns[t.nextColumn++],r=[];for(let t of i)r.push(n.getColumnInfo(t));r.sort(((t,e)=>la[t.datatype]-la[e.datatype])),this.dataLoader(r,e,n.size).then((e=>{for(let t of e)n.setColumnData(t.field,t.data);t.columnsLoaded++})).catch((e=>{console.log(e),t.columnsLoaded++,t.failedColumns.push(r)})).finally((()=>{const n=t.columns.length,r=t.columnsLoaded;let o=r*i.length;for(let t of i)delete this.columnsLoading[e][t];o=o>t.totalColumns?t.totalColumns:o,this.updateInfoAlert(t.alertID,`Loading Columns:${o}/${t.totalColumns}`),r>=n&&(this.updateInfoAlert(t.alertID,`Loaded ${n} column${1===n?"":"s"}`,{duration:2e3}),t.callback(t.failedColumns),delete this.transactions[t.id]),t.nextColumn<n&&this._loadColumnData(t,e)}))}_addLinkIcon(t,e,n){(0,T.Eo)("fas fa-plus-square",{tooltip:{text:`Add ${n.name}`,position:"bottom-right"},func:()=>{new st(t,e,n,this)}},t.menuBar)}_setUpMenu(t){const e=t.dataStore;if((0,T.Eo)("fas fa-chart-bar",{tooltip:{text:"Add Chart",position:"bottom-right"},func:()=>{new da(t,(e=>this.addChart(t.name,e,!0)))}},t.menuBar),(0,T.Eo)("fas fa-sync-alt",{tooltip:{text:"Reset All Filters",position:"bottom-right"},func:()=>{e.removeAllFilters()}},t.menuBar),(0,T.Eo)("fas fa-palette",{tooltip:{text:"Change Color Scheme",position:"bottom-right"},func:()=>{try{new lt(this,t)}catch(t){console.error("error making ColorChooser",t),this.createInfoAlert("Error making color chooser",{type:"warning",duration:2e3})}}},t.menuBar),(0,T.Eo)("fas fa-th",{tooltip:{text:"Change layout",position:"bottom-right"},func:e=>{this.layoutMenus[t.name].show(e)}},t.menuBar),e.links)for(let n in e.links){const i=e.links[n];i.rows_as_columns&&this._addLinkIcon(t,this.dsIndex[n],i.rows_as_columns)}const n=(0,T.ut)("div",{styles:{float:"right",lineHeight:"1.0"}},t.menuBar);(0,T.ut)("span",{text:t.name,styles:{verticalAlign:"top",fontSize:"16px",marginRight:"4px"}},n);const i=t.dataStore.size;t.filterBar=(0,T.ut)("progress",{value:i},t.menBar);const r=(0,T.ut)("div",{styles:{width:"100px",display:"inline-block",marginTop:"2px"}},n),o={max:i,value:i,text:`${i}`};this.progressBars[t.name]=new T.Vq(r,o)}addListener(t,e){this.listeners[t]=e}removeListener(t){delete this.listeners[t]}_callListeners(t,e){for(let n in this.listeners)this.listeners[n](t,this,e)}async addChart(t,e,n=!1){const i=this._getColumnsRequiredForChart(e);if(e.location){const t=e.location,n=5;e.size=[90*t.width+t.width*n-n,40*t.height+t.height*n-n],e.position=[(t.x+1)*n+90*t.x,(t.y+1)*n+40*t.y]}const r=this.dsIndex[t];let o=300,s=300,a=10,l=10;if(e.size&&(o=e.size[0],s=e.size[1]),e.position&&(a=e.position[0],l=e.position[1]),"gridstack"===this.viewData.dataSources[t].layout&&e.gssize){const n=this.gridStack.getCellDimensions(this.dsIndex[t]);o=Math.round(e.gssize[0]*n[0]),s=Math.round(e.gssize[1]*n[1]),a=Math.round(e.gsposition[0]*(n[0]+5)),l=Math.floor(e.gsposition[1]*(n[1]+5))}const c=ca[this.theme],u=(0,T.ut)("div",{styles:{position:"absolute",width:o+"px",height:s+"px",left:a+"px",top:l+"px",background:c.main_panel_color,zIndex:2,display:"flex",alignItems:"center",justifyContent:"center"}},r.contentDiv);return(0,T.ut)("i",{classes:["fas","fa-circle-notch","fa-spin"],styles:{fontSize:"30px",color:c.text_color}},u),(0,T.ut)("div",{styles:{position:"absolute",overflow:"hide",textAlign:"center",top:"3px",color:c.text_color,textOverflow:"ellipsis",wordBreak:"break-all",fontSize:"16px"},text:e.title},u),new Promise(((r,o)=>{const s=()=>{this._addChart(t,e,u,n),r()};try{this._getColumnsThen(t,i,s)}catch(t){this.clearInfoAlerts();const e=this.createInfoAlert(`Error creating chart with columns [${i.join(", ")}]: '${t}'`,{type:"warning"});console.log(t);const n=this.infoAlerts[e].div;n.onclick=()=>n.remove(),u.remove(),o(t)}}))}_getColumnsFromOtherSource(t,e,n,i,r){this._getColumnsThen(e,n.concat(i),(()=>{const o=this.dsIndex[t].dataStore,s=this.dsIndex[e].dataStore,a=s.getColumnIndex(i),l=o.columnIndex[i],c=l.values.map((t=>a[t])),u=n.map((t=>{const e=o.columnIndex[t],n=s.columnIndex[t];n.values&&(e.values=n.values),n.minMax&&(e.minMax=n.minMax),n.quantiles&&(e.quantiles=n.quantiles);const i=new SharedArrayBuffer(o.size*("text"===e.datatype?1:4));return{col:t,data:i,arr:new("text"===e.datatype?Uint8Array:Float32Array)(i),odata:n.data}}));for(let t=0;t<o.size;t++){const e=c[l.data[t]];for(let n of u)n.arr[t]=n.odata[e]}for(let t of u)o.setColumnData(t.col,t.data);r()}))}_getColumnsThen(t,e,n){const i=this.dsIndex[t].dataStore;if(i.links)for(let r in i.links){const o=i.links[r];if(o.columns){const s=[],a=[];for(let t of e)-1===o.columns.indexOf(t)?a.push(t):i.columnIndex[t].data||s.push(t);if(s.length>0)return void this._getColumnsThen(t,[o.index],(()=>{this._getColumnsFromOtherSource(t,r,s,o.index,(()=>{this._getColumnsThen(t,a,n)}))}))}}const r=e.filter((e=>{if(this.columnsLoading[t][e])return!1;const n=i.columnIndex[e];return n?!n.data:(i.addColumnFromField(e),!0)}));0===r.length?this._haveColumnsLoaded(e,t,n):this.loadColumnSet(r,t,(()=>{this._haveColumnsLoaded(e,t,n)}))}_decorateColumnMethod(t,e,n){const i="_"+t;e[i]=e[t],e[t]=t=>{this._getColumnsThen(n,[t],(()=>e[i](t)))}}__decorateColumnMethod(t,e,n){const i="_"+t;e[i]=e[t];const r=this;e[t]=function(){if(null==arguments[0])e[i](...arguments);else{const t=Array.isArray(arguments[0])?arguments[0]:[arguments[0]];r._getColumnsThen(n,t,(()=>e[i](...arguments)))}}}_haveColumnsLoaded(t,e,n){for(let i of t)if(this.columnsLoading[e][i])return void setTimeout((()=>{this._haveColumnsLoaded(t,e,n)}),500);n()}_addChart(t,e,n,i=!1){const r=this.dsIndex[t];n.innerHTML="",n.style.display="",n.style.alignItems="",n.style.justifyContent="";const o=I.types[e.type],s=new o.class(r.dataStore,n,e);if(this.charts[s.config.id]={chart:s,dataSource:r},this._makeChartRD(s,r),s.popoutIcon=s.addMenuIcon("fas fa-external-link-alt","popout",{func:()=>{this._popOutChart(s)}}),s.addMenuIcon("fas fa-times","remove chart").addEventListener("click",(()=>{s.remove(),n.remove(),delete this.charts[s.config.id],this._removeLinks(s),this._callListeners("chart_removed",s)})),s.colorByColumn&&this._decorateColumnMethod("colorByColumn",s,t),s.setToolTipColumn&&this._decorateColumnMethod("setToolTipColumn",s,t),s.setBackgroundFilter&&this._decorateColumnMethod("setBackgroundFilter",s,t),s.changeContourParameter&&this._decorateColumnMethod("changeContourParameter",s,t),o.methodsUsingColumns)for(let e of o.methodsUsingColumns)this.__decorateColumnMethod(e,s,t);if(s.setupLinks){r.index_link_to&&this._giveChartAccess(s,this.dsIndex[r.index_link_to.dataSource].dataStore,r.index_link_to.index);for(let t of r.dataStore.accessOtherDataStore)this._giveChartAccess(s,this.dsIndex[t.dataSource].dataStore,t.index)}const a=r.column_link_to;if(a&&s.createColumnLinks){const t=(t,e)=>{this._getColumnsThen(a.dataSource,t,e)};s.createColumnLinks(this.dsIndex[a.dataSource].dataStore,a.columns,t)}if(i&&this._callListeners("chart_added",s),this._toLoadCharts&&(this._toLoadCharts.delete(e),0===this._toLoadCharts.size)){if(delete this._toLoadCharts,this.viewData.links)for(let t of this.viewData.links)this._setUpLink(t);this._callListeners("view_loaded",this.currentView)}return s}_giveChartAccess(t,e,n){t.setupLinks(e,n,((t,i)=>{t.push(n),this._getColumnsThen(e.name,t,i)}))}_setUpLink(t){if(t.id||(t.id=(0,M.zO)()),"color_by_column"===t.type){const e=this.charts[t.source_chart];e||console.error(`broken link link:${t.id}`),e.chart.addListener(t.id,((e,n)=>{if("cell_clicked"===e)for(let e of t.target_charts)this.getChart(e).colorByColumn(n.row)}))}}_removeLinks(t){const e=[],n=t.config.id,i=this.viewData.links;if(i){for(let t=0;t<i.length;t++){const r=i[t];r.source_chart===n&&e.push(t);const o=r.target_charts.indexOf(n);-1!==o&&(r.target_charts.splice(o,1),0===r.target_charts.length&&e.push(t))}for(let t of e)this.removeLink(t)}}removeLink(t){const e=this.viewData.links[t];"color_by_column"===e.type&&this.charts[e.source_chart].chart.removeListener(e.id),this.viewData.links.splice(t,1)}removeAllCharts(t){const e=[];for(let n in this.charts){const i=this.charts[n];t&&-1===t.indexOf(i.dataSource.name)||e.push([i.chart,i.window])}for(let t of e)t[1]&&t[1].close(),t[0].remove(),t[0].div.remove();this.charts={}}getAllFilters(t){const e=this.getAllCharts(t),n=[];for(let t of e){const e=t.getFilter();e&&n.push(e)}return n}getChart(t){const e=this.charts[t];return e?e.chart:null}getAllCharts(t){const e=[];for(let n in this.charts){const i=this.charts[n];i.dataSource.name===t&&e.push(i.chart)}return e}setChartsAsGrid(t=5,e=[300,300],n=10){let i=n,r=n,o=0;for(let s in this.charts){const a=this.charts[s].chart.getDiv();a.style.left=r+"px",a.style.top=i+"px",r+=e[0]+n,o++,o===t&&(o=0,r=n,i+=e[1]+n)}}addButton(t,e,n){(0,T.ut)("button",{classes:["ciview-button"],text:t,styles:{position:"fixed",bottom:"40px",right:"40px",fontSize:"18px",zIndex:100}},this.contentDiv).addEventListener("click",(()=>e()))}_popOutChart(t){const e=t.getDiv(),n=this.charts[t.config.id],i={dim:[t.config.size[0],t.config.size[1]],pos:[e.style.left,e.style.top]};e.gridstackPopoutCallback&&e.gridstackPopoutCallback(),(0,T.P_)(e),(0,T.EA)(e);const r=new O(((n,i)=>{t.setSize(i.width,i.height),e.style.top="5px",e.style.left="5px",n.body.append(e),t.changeBaseDocument(n),n.body.style.overflow="hidden",t.popoutIcon.style.display="none"}),((r,o)=>{n.dataSource.contentDiv.append(e),t.changeBaseDocument(document),e.style.left=i.pos[0],e.style.top=i.pos[1],t.setSize(i.dim[0],i.dim[1]),this._makeChartRD(t,n.dataSource),t.popoutIcon.style.display="inline",delete n.window}),{onresize:(e,n)=>{t.setSize(n.width,n.height)},url:this.config.popouturl||"/?popout=true"});n.window=r}_sendAllChartsToBack(t){for(let e in this.charts){const n=this.charts[e];t===n.dataSource&&(n.chart.div.style.zIndex="")}}_makeChartRD(t,e){if(e&&this.gridStack&&"gridstack"===this.viewData.dataSources[e.name].layout)return void this.gridStack.manageChart(t,e,this._inInit);const n=t.getDiv();(0,T.$q)(n,{handle:".ciview-chart-title",contain:"topleft",ondragstart:t=>{this._sendAllChartsToBack(e),n.style.zIndex=2}}),(0,T.n2)(n,{onResizeStart:()=>{this._sendAllChartsToBack(e),n.style.zIndex=2},onresizeend:(e,n)=>t.setSize(e,n)})}}("holder",e.datasources,r,n,((t,e,n)=>{switch(t){case"state_saved":ya("/save_state",n).then((t=>{t.success?(e.createInfoAlert("Data Saved",{duration:2e3}),e.setAllColumnsClean()):e.createInfoAlert("UnableToSaveData",{duration:3e3,type:"danger"})}));break;case"view_loaded":!function(t,e){const n=new URL(window.location);n.searchParams.has(t)?n.searchParams.set(t,e):n.searchParams.append(t,e),n.search=n.searchParams,history.pushState({},null,n)}("view",e.currentView)}}))}))}})()})();